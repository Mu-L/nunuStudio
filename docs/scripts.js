!function(n,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.Nunu=o():n.Nunu=o()}(self,()=>(()=>{var __webpack_modules__={872:(n,o,l)=>{"use strict";l(590),l(435),l(806);var x=l(808);o.fG=x.StaticPair},590:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(546),B=l(285);o.Decoder=class{constructor(D=[],G,M={}){this.dict=D,this.progressive=G,this.options=M}decode(D){D instanceof x||(D=x.wrap(D));const G=D.littleEndian;try{const M=this.decodeValue(D.LE());return D.littleEndian=G,M}catch(M){throw D.littleEndian=G,M}}decodeValue(D){let G=D.readUint8();if(G<=B.MAX)return x.zigZagDecode32(G);switch(G){case B.NULL:return null;case B.TRUE:return!0;case B.FALSE:return!1;case B.EOBJECT:return{};case B.EARRAY:return[];case B.ESTRING:return"";case B.OBJECT:G=D.readVarint32();const M={};for(;--G>=0;)M[this.decodeValue(D)]=this.decodeValue(D);return M;case B.ARRAY:G=D.readVarint32();const P=[];for(;--G>=0;)P.push(this.decodeValue(D));return P;case B.INTEGER:return D.readVarint32ZigZag();case B.LONG:const fe=D.readVarint64ZigZag();return fe.lessThanOrEqual(Number.MAX_SAFE_INTEGER)&&fe.greaterThanOrEqual(Number.MIN_SAFE_INTEGER)?fe.toNumber():fe;case B.FLOAT:return D.readFloat32();case B.DOUBLE:return D.readFloat64();case B.STRING:return D.readVString();case B.STRING_ADD:const ye=D.readVString();return this.dict.push(ye),ye;case B.STRING_GET:return this.dict[D.readVarint32()];case B.BINARY:G=D.readVarint32();const ne=D.slice(D.offset,D.offset+G);return D.offset+=G,ne;default:throw new Error(`Illegal type at ${D.offset}: ${G}`)}}}},435:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(546),B=l(285),D=l(734),G=new x(4);G.compact(0,4),o.Encoder=class{constructor(M=[],P,fe){if(this.progressive=P,this.dict=new Map,this.next=0,M)for(;this.next<M.length;)this.dict.set(M[this.next],this.next++)}encode(M,P){let fe=!1;P||(P=new x,fe=!0);const ye=P.littleEndian;try{return this.encodeValue(M,P.LE()),P.littleEndian=ye,fe?P.flip():P}catch(ne){throw P.littleEndian=ye,ne}}encodeValue(M,P){if(null!==M)switch(typeof M){case"function":M=M.toString();case"string":0===M.length?P.writeUint8(B.ESTRING):this.dict.has(M)?(P.writeUint8(B.STRING_GET),P.writeVarint32(this.dict.get(M))):(P.writeUint8(B.STRING),P.writeVString(M));break;case"number":if(M%1==0)if(M<=2147483647&&M>=-2147483648){const ye=x.zigZagEncode32(M);ye<=B.MAX?P.writeUint8(ye):(P.writeUint8(B.INTEGER),P.writeVarint32ZigZag(M))}else P.writeUint8(B.LONG),P.writeVarint64ZigZag(M);else G.writeFloat32(M,0),M===G.readFloat32(0)?(P.writeUint8(B.FLOAT),P.writeFloat32(M)):(P.writeUint8(B.DOUBLE),P.writeFloat64(M));break;case"boolean":P.writeUint8(M?B.TRUE:B.FALSE);break;case"object":let fe;if(Array.isArray(M))if(0===M.length)P.writeUint8(B.EARRAY);else for(P.writeUint8(B.ARRAY),P.writeVarint32(M.length),fe=0;fe<M.length;fe++)this.encodeValue(M[fe],P);else if(M instanceof D)P.writeUint8(B.LONG),P.writeVarint64ZigZag(M);else if(M instanceof Buffer||M instanceof ArrayBuffer||M instanceof Uint8Array||M instanceof x)M=x.wrap(M),P.writeUint8(B.BINARY),P.writeVarint32(M.remaining()),P.append(M);else{const ye=Object.keys(M);let ne=0;for(fe=0;fe<ye.length;fe++)void 0!==M[ye[fe]]&&ne++;if(0===ne)P.writeUint8(B.EOBJECT);else for(P.writeUint8(B.OBJECT),P.writeVarint32(ne),fe=0;fe<ye.length;fe++){const ue=ye[fe];void 0!==M[ue]&&(this.dict.has(ue)?(P.writeUint8(B.STRING_GET),P.writeVarint32(this.dict.get(ue))):(this.progressive?(this.dict.set(ue,this.next++),P.writeUint8(B.STRING_ADD)):P.writeUint8(B.STRING),P.writeVString(ue)),this.encodeValue(M[ue],P))}}break;case"undefined":P.writeUint8(B.NULL)}else P.writeUint8(B.NULL)}}},606:(n,o)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Pair=class{encode(l){return this.encoder.encode(l)}toArrayBuffer(l){return this.encoder.encode(l).toArrayBuffer()}toBuffer(l){return this.encoder.encode(l).toBuffer()}decode(l){return this.decoder.decode(l)}}},806:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(606),B=l(435),D=l(590);o.ProgressivePair=class G extends x.Pair{constructor(P,fe){super(),this.encoder=new B.Encoder(P,!0,fe),this.decoder=new D.Decoder(P,!0,fe)}}},808:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(606),B=l(435),D=l(590);o.StaticPair=class G extends x.Pair{constructor(P,fe){super(),this.encoder=new B.Encoder(P,!1,fe),this.decoder=new D.Decoder(P,!1,fe)}}},285:(n,o)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ZERO=0,o.MAX=239,o.NULL=240,o.TRUE=241,o.FALSE=242,o.EOBJECT=243,o.EARRAY=244,o.ESTRING=245,o.OBJECT=246,o.ARRAY=247,o.INTEGER=248,o.LONG=249,o.FLOAT=250,o.DOUBLE=251,o.STRING=252,o.STRING_ADD=253,o.STRING_GET=254,o.BINARY=255},175:(n,o,l)=>{"use strict";l.r(o),l.d(o,{ACESFilmicToneMapping:()=>Qr,AddEquation:()=>Ne,AddOperation:()=>tr,AdditiveAnimationBlendMode:()=>Wu,AdditiveBlending:()=>z,AlphaFormat:()=>pp,AlwaysDepth:()=>$n,AlwaysStencilFunc:()=>aa,AmbientLight:()=>Ld,AmbientLightProbe:()=>Gm,AnimationClip:()=>Qt,AnimationLoader:()=>Er,AnimationMixer:()=>tf,AnimationObjectGroup:()=>zf,AnimationUtils:()=>Fe,ArcCurve:()=>np,ArrayCamera:()=>Cc,ArrowHelper:()=>A_,Audio:()=>vm,AudioAnalyser:()=>ud,AudioContext:()=>mm,AudioListener:()=>Wm,AudioLoader:()=>lc,AxesHelper:()=>m_,AxisHelper:()=>t,BackSide:()=>W,BasicDepthPacking:()=>q,BasicShadowMap:()=>ye,BinaryTextureLoader:()=>I,Bone:()=>Xa,BooleanKeyframeTrack:()=>$t,BoundingBoxHelper:()=>u,Box2:()=>pd,Box3:()=>Gi,Box3Helper:()=>T_,BoxBufferGeometry:()=>Jl,BoxGeometry:()=>Jl,BoxHelper:()=>d_,BufferAttribute:()=>Fi,BufferGeometry:()=>gr,BufferGeometryLoader:()=>pm,ByteType:()=>zl,Cache:()=>gn,Camera:()=>$l,CameraHelper:()=>E_,CanvasRenderer:()=>Z,CanvasTexture:()=>kp,CatmullRomCurve3:()=>Nn,CineonToneMapping:()=>Nr,CircleBufferGeometry:()=>Fp,CircleGeometry:()=>Fp,ClampToEdgeWrapping:()=>Yr,Clock:()=>gm,Color:()=>Qn,ColorKeyframeTrack:()=>rn,CompressedTexture:()=>rd,CompressedTextureLoader:()=>vi,ConeBufferGeometry:()=>ou,ConeGeometry:()=>ou,CubeCamera:()=>ul,CubeReflectionMapping:()=>Ti,CubeRefractionMapping:()=>$o,CubeTexture:()=>Zl,CubeTextureLoader:()=>fo,CubeUVReflectionMapping:()=>Oi,CubeUVRefractionMapping:()=>Co,CubicBezierCurve:()=>rp,CubicBezierCurve3:()=>Lh,CubicInterpolant:()=>Qe,CullFaceBack:()=>M,CullFaceFront:()=>P,CullFaceFrontBack:()=>fe,CullFaceNone:()=>G,Curve:()=>Ks,CurvePath:()=>Gs,CustomBlending:()=>be,CustomToneMapping:()=>Vr,CylinderBufferGeometry:()=>sh,CylinderGeometry:()=>sh,Cylindrical:()=>Hf,DataTexture:()=>La,DataTexture2DArray:()=>pl,DataTexture3D:()=>da,DataTextureLoader:()=>Vo,DataUtils:()=>C_,DecrementStencilOp:()=>At,DecrementWrapStencilOp:()=>dn,DefaultLoadingManager:()=>sr,DepthFormat:()=>Lo,DepthStencilFormat:()=>qs,DepthTexture:()=>oh,DirectionalLight:()=>Rf,DirectionalLightHelper:()=>p_,DiscreteInterpolant:()=>ct,DodecahedronBufferGeometry:()=>od,DodecahedronGeometry:()=>od,DoubleSide:()=>Q,DstAlphaFactor:()=>on,DstColorFactor:()=>An,DynamicBufferAttribute:()=>z_,DynamicCopyUsage:()=>la,DynamicDrawUsage:()=>Lr,DynamicReadUsage:()=>Xi,EdgesGeometry:()=>Ru,EdgesHelper:()=>m,EllipseCurve:()=>oc,EqualDepth:()=>nr,EqualStencilFunc:()=>wr,EquirectangularReflectionMapping:()=>Hs,EquirectangularRefractionMapping:()=>ia,Euler:()=>_o,EventDispatcher:()=>Os,ExtrudeBufferGeometry:()=>Ul,ExtrudeGeometry:()=>Ul,FaceColors:()=>R_,FileLoader:()=>Kn,FlatShading:()=>A,Float16BufferAttribute:()=>Jr,Float32Attribute:()=>Y_,Float32BufferAttribute:()=>pn,Float64Attribute:()=>J_,Float64BufferAttribute:()=>qc,FloatType:()=>qo,Fog:()=>nh,FogExp2:()=>eu,Font:()=>zm,FontLoader:()=>x_,FrontSide:()=>ie,Frustum:()=>Dr,GLBufferAttribute:()=>vf,GLSL1:()=>ca,GLSL3:()=>ki,GammaEncoding:()=>ql,GreaterDepth:()=>rr,GreaterEqualDepth:()=>lr,GreaterEqualStencilFunc:()=>Qo,GreaterStencilFunc:()=>Tr,GridHelper:()=>Sm,Group:()=>Eh,HalfFloatType:()=>ms,HemisphereLight:()=>Ic,HemisphereLightHelper:()=>h_,HemisphereLightProbe:()=>jm,IcosahedronBufferGeometry:()=>Pc,IcosahedronGeometry:()=>Pc,ImageBitmapLoader:()=>n_,ImageLoader:()=>no,ImageUtils:()=>Ms,ImmediateRenderObject:()=>up,IncrementStencilOp:()=>Et,IncrementWrapStencilOp:()=>Yt,InstancedBufferAttribute:()=>Zi,InstancedBufferGeometry:()=>If,InstancedInterleavedBuffer:()=>na,InstancedMesh:()=>Go,Int16Attribute:()=>V_,Int16BufferAttribute:()=>Ju,Int32Attribute:()=>q_,Int32BufferAttribute:()=>Ea,Int8Attribute:()=>j_,Int8BufferAttribute:()=>Dd,IntType:()=>Hp,InterleavedBuffer:()=>Js,InterleavedBufferAttribute:()=>nc,Interpolant:()=>De,InterpolateDiscrete:()=>Vl,InterpolateLinear:()=>Wl,InterpolateSmooth:()=>Hu,InvertStencilOp:()=>kn,JSONLoader:()=>J,KeepStencilOp:()=>Ve,KeyframeTrack:()=>_t,LOD:()=>Ds,LatheBufferGeometry:()=>Za,LatheGeometry:()=>Za,Layers:()=>Xs,LensFlare:()=>_e,LessDepth:()=>_n,LessEqualDepth:()=>ar,LessEqualStencilFunc:()=>ei,LessStencilFunc:()=>wn,Light:()=>ds,LightProbe:()=>Pf,Line:()=>to,Line3:()=>yf,LineBasicMaterial:()=>wi,LineCurve:()=>Us,LineCurve3:()=>oo,LineDashedMaterial:()=>Pe,LineLoop:()=>df,LinePieces:()=>B_,LineSegments:()=>Qs,LineStrip:()=>L_,LinearEncoding:()=>Ki,LinearFilter:()=>ai,LinearInterpolant:()=>it,LinearMipMapLinearFilter:()=>Gp,LinearMipMapNearestFilter:()=>Ph,LinearMipmapLinearFilter:()=>Ka,LinearMipmapNearestFilter:()=>Fc,LinearToneMapping:()=>mi,Loader:()=>Rn,LoaderUtils:()=>ff,LoadingManager:()=>fr,LogLuvEncoding:()=>Gh,LoopOnce:()=>fu,LoopPingPong:()=>dc,LoopRepeat:()=>Fa,LuminanceAlphaFormat:()=>ku,LuminanceFormat:()=>Uc,MOUSE:()=>B,Material:()=>$s,MaterialLoader:()=>Bd,Math:()=>_u,MathUtils:()=>_u,Matrix3:()=>ot,Matrix4:()=>Kt,MaxEquation:()=>Ke,Mesh:()=>ko,MeshBasicMaterial:()=>sl,MeshDepthMaterial:()=>Sh,MeshDistanceMaterial:()=>Kp,MeshFaceMaterial:()=>I_,MeshLambertMaterial:()=>$e,MeshMatcapMaterial:()=>Re,MeshNormalMaterial:()=>Se,MeshPhongMaterial:()=>ge,MeshPhysicalMaterial:()=>ae,MeshStandardMaterial:()=>le,MeshToonMaterial:()=>we,MinEquation:()=>qe,MirroredRepeatWrapping:()=>os,MixOperation:()=>pi,MultiMaterial:()=>O_,MultiplyBlending:()=>K,MultiplyOperation:()=>Zr,NearestFilter:()=>Or,NearestMipMapLinearFilter:()=>Vs,NearestMipMapNearestFilter:()=>Iu,NearestMipmapLinearFilter:()=>fs,NearestMipmapNearestFilter:()=>Oa,NeverDepth:()=>On,NeverStencilFunc:()=>nn,NoBlending:()=>X,NoColors:()=>N_,NoToneMapping:()=>mr,NormalAnimationBlendMode:()=>Vu,NormalBlending:()=>he,NotEqualDepth:()=>ti,NotEqualStencilFunc:()=>vs,NumberKeyframeTrack:()=>Dt,Object3D:()=>Pr,ObjectLoader:()=>Um,ObjectSpaceNormalMap:()=>Ce,OctahedronBufferGeometry:()=>Rh,OctahedronGeometry:()=>Rh,OneFactor:()=>ht,OneMinusDstAlphaFactor:()=>ft,OneMinusDstColorFactor:()=>Cn,OneMinusSrcAlphaFactor:()=>Ot,OneMinusSrcColorFactor:()=>wt,OrthographicCamera:()=>Ql,PCFShadowMap:()=>ne,PCFSoftShadowMap:()=>ue,PMREMGenerator:()=>Ue,ParametricBufferGeometry:()=>Si,ParametricGeometry:()=>Si,Particle:()=>F_,ParticleBasicMaterial:()=>e_,ParticleSystem:()=>g_,ParticleSystemMaterial:()=>D_,Path:()=>hs,PerspectiveCamera:()=>Fo,Plane:()=>Ta,PlaneBufferGeometry:()=>xu,PlaneGeometry:()=>xu,PlaneHelper:()=>M_,PointCloud:()=>k_,PointCloudMaterial:()=>v_,PointLight:()=>Dm,PointLightHelper:()=>wm,Points:()=>Po,PointsMaterial:()=>br,PolarGridHelper:()=>S_,PolyhedronBufferGeometry:()=>ma,PolyhedronGeometry:()=>ma,PositionalAudio:()=>mf,PropertyBinding:()=>yo,PropertyMixer:()=>Ff,QuadraticBezierCurve:()=>_a,QuadraticBezierCurve3:()=>Ja,Quaternion:()=>Ci,QuaternionKeyframeTrack:()=>Ct,QuaternionLinearInterpolant:()=>Lt,REVISION:()=>x,RGBADepthPacking:()=>pe,RGBAFormat:()=>mo,RGBAIntegerFormat:()=>dh,RGBA_ASTC_10x10_Format:()=>nl,RGBA_ASTC_10x5_Format:()=>zu,RGBA_ASTC_10x6_Format:()=>tl,RGBA_ASTC_10x8_Format:()=>Fh,RGBA_ASTC_12x10_Format:()=>Dh,RGBA_ASTC_12x12_Format:()=>ju,RGBA_ASTC_4x4_Format:()=>Du,RGBA_ASTC_5x4_Format:()=>mp,RGBA_ASTC_5x5_Format:()=>_p,RGBA_ASTC_6x5_Format:()=>zc,RGBA_ASTC_6x6_Format:()=>uc,RGBA_ASTC_8x5_Format:()=>mh,RGBA_ASTC_8x6_Format:()=>gp,RGBA_ASTC_8x8_Format:()=>Uu,RGBA_BPTC_Format:()=>hc,RGBA_ETC2_EAC_Format:()=>Gl,RGBA_PVRTC_2BPPV1_Format:()=>jl,RGBA_PVRTC_4BPPV1_Format:()=>xl,RGBA_S3TC_DXT1_Format:()=>cc,RGBA_S3TC_DXT3_Format:()=>Oh,RGBA_S3TC_DXT5_Format:()=>fh,RGBDEncoding:()=>mu,RGBEEncoding:()=>Hc,RGBEFormat:()=>ph,RGBFormat:()=>Is,RGBIntegerFormat:()=>fp,RGBM16Encoding:()=>qu,RGBM7Encoding:()=>mc,RGB_ETC1_Format:()=>Fu,RGB_ETC2_Format:()=>gs,RGB_PVRTC_2BPPV1_Format:()=>yl,RGB_PVRTC_4BPPV1_Format:()=>kh,RGB_S3TC_DXT1_Format:()=>Ih,RGFormat:()=>pu,RGIntegerFormat:()=>dp,RawShaderMaterial:()=>Su,Ray:()=>mn,Raycaster:()=>Ra,RectAreaLight:()=>ld,RedFormat:()=>Vp,RedIntegerFormat:()=>el,ReinhardToneMapping:()=>xo,RepeatWrapping:()=>wo,ReplaceStencilOp:()=>et,ReverseSubtractEquation:()=>Te,RingBufferGeometry:()=>yr,RingGeometry:()=>yr,SRGB8_ALPHA8_ASTC_10x10_Format:()=>xp,SRGB8_ALPHA8_ASTC_10x5_Format:()=>yp,SRGB8_ALPHA8_ASTC_10x6_Format:()=>Uh,SRGB8_ALPHA8_ASTC_10x8_Format:()=>bp,SRGB8_ALPHA8_ASTC_12x10_Format:()=>zh,SRGB8_ALPHA8_ASTC_12x12_Format:()=>Wp,SRGB8_ALPHA8_ASTC_4x4_Format:()=>pc,SRGB8_ALPHA8_ASTC_5x4_Format:()=>_h,SRGB8_ALPHA8_ASTC_5x5_Format:()=>du,SRGB8_ALPHA8_ASTC_6x5_Format:()=>jc,SRGB8_ALPHA8_ASTC_6x6_Format:()=>vp,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Gc,SRGB8_ALPHA8_ASTC_8x6_Format:()=>Gu,SRGB8_ALPHA8_ASTC_8x8_Format:()=>Hl,Scene:()=>rh,SceneUtils:()=>ee,ShaderChunk:()=>ui,ShaderLib:()=>Bl,ShaderMaterial:()=>Rs,ShadowMaterial:()=>Y,Shape:()=>ps,ShapeBufferGeometry:()=>a,ShapeGeometry:()=>a,ShapePath:()=>r_,ShapeUtils:()=>hi,ShortType:()=>ka,Skeleton:()=>Bu,SkeletonHelper:()=>bf,SkinnedMesh:()=>Ps,SmoothShading:()=>R,Sphere:()=>To,SphereBufferGeometry:()=>r,SphereGeometry:()=>r,Spherical:()=>Gf,SphericalHarmonics3:()=>hm,SplineCurve:()=>uo,SpotLight:()=>Oc,SpotLightHelper:()=>u_,Sprite:()=>Ol,SpriteMaterial:()=>td,SrcAlphaFactor:()=>Ft,SrcAlphaSaturateFactor:()=>fn,SrcColorFactor:()=>Bt,StaticCopyUsage:()=>_c,StaticDrawUsage:()=>yi,StaticReadUsage:()=>Vi,StereoCamera:()=>Hm,StreamCopyUsage:()=>il,StreamDrawUsage:()=>Da,StreamReadUsage:()=>Hh,StringKeyframeTrack:()=>ut,SubtractEquation:()=>je,SubtractiveBlending:()=>Le,TOUCH:()=>D,TangentSpaceNormalMap:()=>Ee,TetrahedronBufferGeometry:()=>h,TetrahedronGeometry:()=>h,TextBufferGeometry:()=>d,TextGeometry:()=>d,Texture:()=>As,TextureLoader:()=>Uo,TorusBufferGeometry:()=>y,TorusGeometry:()=>y,TorusKnotBufferGeometry:()=>b,TorusKnotGeometry:()=>b,Triangle:()=>ro,TriangleFanDrawMode:()=>Sp,TriangleStripDrawMode:()=>wp,TrianglesDrawMode:()=>jh,TubeBufferGeometry:()=>N,TubeGeometry:()=>N,UVMapping:()=>gi,Uint16Attribute:()=>W_,Uint16BufferAttribute:()=>Zu,Uint32Attribute:()=>X_,Uint32BufferAttribute:()=>li,Uint8Attribute:()=>G_,Uint8BufferAttribute:()=>$p,Uint8ClampedAttribute:()=>H_,Uint8ClampedBufferAttribute:()=>Sa,Uniform:()=>nf,UniformsLib:()=>ir,UniformsUtils:()=>Ns,UnsignedByteType:()=>oa,UnsignedInt248Type:()=>Ts,UnsignedIntType:()=>Ws,UnsignedShort4444Type:()=>Ou,UnsignedShort5551Type:()=>uu,UnsignedShort565Type:()=>hu,UnsignedShortType:()=>Dc,VSMShadowMap:()=>me,Vector2:()=>Un,Vector3:()=>at,Vector4:()=>ji,VectorKeyframeTrack:()=>Tt,Vertex:()=>U_,VertexColors:()=>P_,VideoTexture:()=>Ya,WebGL1Renderer:()=>Nf,WebGLCubeRenderTarget:()=>Mc,WebGLMultipleRenderTargets:()=>ni,WebGLMultisampleRenderTarget:()=>Vc,WebGLRenderTarget:()=>lo,WebGLRenderTargetCube:()=>V,WebGLRenderer:()=>Ir,WebGLUtils:()=>ef,WireframeGeometry:()=>k,WireframeHelper:()=>g,WrapAroundEnding:()=>wl,XHRLoader:()=>E,ZeroCurvatureEnding:()=>ba,ZeroFactor:()=>vt,ZeroSlopeEnding:()=>sa,ZeroStencilOp:()=>He,sRGBEncoding:()=>rl});const x="132",B={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},D={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},G=0,M=1,P=2,fe=3,ye=0,ne=1,ue=2,me=3,ie=0,W=1,Q=2,A=1,R=2,X=0,he=1,z=2,Le=3,K=4,be=5,Ne=100,je=101,Te=102,qe=103,Ke=104,vt=200,ht=201,Bt=202,wt=203,Ft=204,Ot=205,on=206,ft=207,An=208,Cn=209,fn=210,On=0,$n=1,_n=2,ar=3,nr=4,lr=5,rr=6,ti=7,Zr=0,pi=1,tr=2,mr=0,mi=1,xo=2,Nr=3,Qr=4,Vr=5,gi=300,Ti=301,$o=302,Hs=303,ia=304,Oi=306,Co=307,wo=1e3,Yr=1001,os=1002,Or=1003,Oa=1004,Iu=1004,fs=1005,Vs=1005,ai=1006,Fc=1007,Ph=1007,Ka=1008,Gp=1008,oa=1009,zl=1010,ka=1011,Dc=1012,Hp=1013,Ws=1014,qo=1015,ms=1016,Ou=1017,uu=1018,hu=1019,Ts=1020,pp=1021,Is=1022,mo=1023,Uc=1024,ku=1025,ph=mo,Lo=1026,qs=1027,Vp=1028,el=1029,pu=1030,dp=1031,fp=1032,dh=1033,Ih=33776,cc=33777,Oh=33778,fh=33779,kh=35840,yl=35841,xl=35842,jl=35843,Fu=36196,gs=37492,Gl=37496,Du=37808,mp=37809,_p=37810,zc=37811,uc=37812,mh=37813,gp=37814,Uu=37815,zu=37816,tl=37817,Fh=37818,nl=37819,Dh=37820,ju=37821,hc=36492,pc=37840,_h=37841,du=37842,jc=37843,vp=37844,Gc=37845,Gu=37846,Hl=37847,yp=37848,Uh=37849,bp=37850,xp=37851,zh=37852,Wp=37853,fu=2200,Fa=2201,dc=2202,Vl=2300,Wl=2301,Hu=2302,ba=2400,sa=2401,wl=2402,Vu=2500,Wu=2501,jh=0,wp=1,Sp=2,Ki=3e3,rl=3001,ql=3007,Hc=3002,Gh=3003,mc=3004,qu=3005,mu=3006,q=3200,pe=3201,Ee=0,Ce=1,He=0,Ve=7680,et=7681,Et=7682,At=7683,Yt=34055,dn=34056,kn=5386,nn=512,wn=513,wr=514,ei=515,Tr=516,vs=517,Qo=518,aa=519,yi=35044,Lr=35048,Da=35040,Vi=35045,Xi=35049,Hh=35041,_c=35046,la=35050,il=35042,ca="100",ki="300 es";class Os{addEventListener(e,c){void 0===this._listeners&&(this._listeners={});const p=this._listeners;void 0===p[e]&&(p[e]=[]),-1===p[e].indexOf(c)&&p[e].push(c)}hasEventListener(e,c){if(void 0===this._listeners)return!1;const p=this._listeners;return void 0!==p[e]&&-1!==p[e].indexOf(c)}removeEventListener(e,c){if(void 0===this._listeners)return;const p=this._listeners[e];if(void 0!==p){const _=p.indexOf(c);-1!==_&&p.splice(_,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const c=this._listeners[e.type];if(void 0!==c){e.target=this;const p=c.slice(0);for(let _=0,w=p.length;_<w;_++)p[_].call(this,e);e.target=null}}}const er=[];for(let S=0;S<256;S++)er[S]=(S<16?"0":"")+S.toString(16);let Sn=1234567;const jo=Math.PI/180,ss=180/Math.PI;function eo(){const S=4294967295*Math.random()|0,e=4294967295*Math.random()|0,c=4294967295*Math.random()|0,p=4294967295*Math.random()|0;return(er[255&S]+er[S>>8&255]+er[S>>16&255]+er[S>>24&255]+"-"+er[255&e]+er[e>>8&255]+"-"+er[e>>16&15|64]+er[e>>24&255]+"-"+er[63&c|128]+er[c>>8&255]+"-"+er[c>>16&255]+er[c>>24&255]+er[255&p]+er[p>>8&255]+er[p>>16&255]+er[p>>24&255]).toUpperCase()}function Gr(S,e,c){return Math.max(e,Math.min(c,S))}function di(S,e){return(S%e+e)%e}function bi(S,e,c){return(1-c)*S+c*e}function ks(S){return!(S&S-1)&&0!==S}function Vh(S){return Math.pow(2,Math.ceil(Math.log(S)/Math.LN2))}function So(S){return Math.pow(2,Math.floor(Math.log(S)/Math.LN2))}var _u=Object.freeze({__proto__:null,DEG2RAD:jo,RAD2DEG:ss,generateUUID:eo,clamp:Gr,euclideanModulo:di,mapLinear:function(S,e,c,p,_){return p+(S-e)*(_-p)/(c-e)},inverseLerp:function(S,e,c){return S!==e?(c-S)/(e-S):0},lerp:bi,damp:function(S,e,c,p){return bi(S,e,1-Math.exp(-c*p))},pingpong:function(S,e=1){return e-Math.abs(di(S,2*e)-e)},smoothstep:function(S,e,c){return S<=e?0:S>=c?1:(S=(S-e)/(c-e))*S*(3-2*S)},smootherstep:function(S,e,c){return S<=e?0:S>=c?1:(S=(S-e)/(c-e))*S*S*(S*(6*S-15)+10)},randInt:function(S,e){return S+Math.floor(Math.random()*(e-S+1))},randFloat:function(S,e){return S+Math.random()*(e-S)},randFloatSpread:function(S){return S*(.5-Math.random())},seededRandom:function(S){return void 0!==S&&(Sn=S%2147483647),Sn=16807*Sn%2147483647,(Sn-1)/2147483646},degToRad:function(S){return S*jo},radToDeg:function(S){return S*ss},isPowerOfTwo:ks,ceilPowerOfTwo:Vh,floorPowerOfTwo:So,setQuaternionFromProperEuler:function(S,e,c,p,_){const w=Math.cos,L=Math.sin,O=w(c/2),F=L(c/2),U=w((e+p)/2),te=L((e+p)/2),ce=w((e-p)/2),oe=L((e-p)/2),de=w((p-e)/2),ve=L((p-e)/2);switch(_){case"XYX":S.set(O*te,F*ce,F*oe,O*U);break;case"YZY":S.set(F*oe,O*te,F*ce,O*U);break;case"ZXZ":S.set(F*ce,F*oe,O*te,O*U);break;case"XZX":S.set(O*te,F*ve,F*de,O*U);break;case"YXY":S.set(F*de,O*te,F*ve,O*U);break;case"ZYZ":S.set(F*ve,F*de,O*te,O*U);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+_)}}});class Un{constructor(e=0,c=0){this.x=e,this.y=c}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,c){return this.x=e,this.y=c,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const c=this.x,p=this.y,_=e.elements;return this.x=_[0]*c+_[3]*p+_[6],this.y=_[1]*c+_[4]*p+_[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this}clampLength(e,c){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(e,Math.min(c,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const c=this.x-e.x,p=this.y-e.y;return c*c+p*p}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this}lerpVectors(e,c,p){return this.x=e.x+(c.x-e.x)*p,this.y=e.y+(c.y-e.y)*p,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e}fromBufferAttribute(e,c,p){return void 0!==p&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this}rotateAround(e,c){const p=Math.cos(c),_=Math.sin(c),w=this.x-e.x,L=this.y-e.y;return this.x=w*p-L*_+e.x,this.y=w*_+L*p+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}Un.prototype.isVector2=!0;class ot{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,c,p,_,w,L,O,F,U){const te=this.elements;return te[0]=e,te[1]=_,te[2]=O,te[3]=c,te[4]=w,te[5]=F,te[6]=p,te[7]=L,te[8]=U,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const c=this.elements,p=e.elements;return c[0]=p[0],c[1]=p[1],c[2]=p[2],c[3]=p[3],c[4]=p[4],c[5]=p[5],c[6]=p[6],c[7]=p[7],c[8]=p[8],this}extractBasis(e,c,p){return e.setFromMatrix3Column(this,0),c.setFromMatrix3Column(this,1),p.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const c=e.elements;return this.set(c[0],c[4],c[8],c[1],c[5],c[9],c[2],c[6],c[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,c){const p=e.elements,_=c.elements,w=this.elements,L=p[0],O=p[3],F=p[6],U=p[1],te=p[4],ce=p[7],oe=p[2],de=p[5],ve=p[8],Me=_[0],Be=_[3],Ae=_[6],ke=_[1],Je=_[4],We=_[7],rt=_[2],nt=_[5],gt=_[8];return w[0]=L*Me+O*ke+F*rt,w[3]=L*Be+O*Je+F*nt,w[6]=L*Ae+O*We+F*gt,w[1]=U*Me+te*ke+ce*rt,w[4]=U*Be+te*Je+ce*nt,w[7]=U*Ae+te*We+ce*gt,w[2]=oe*Me+de*ke+ve*rt,w[5]=oe*Be+de*Je+ve*nt,w[8]=oe*Ae+de*We+ve*gt,this}multiplyScalar(e){const c=this.elements;return c[0]*=e,c[3]*=e,c[6]*=e,c[1]*=e,c[4]*=e,c[7]*=e,c[2]*=e,c[5]*=e,c[8]*=e,this}determinant(){const e=this.elements,c=e[0],p=e[1],_=e[2],w=e[3],L=e[4],O=e[5],F=e[6],U=e[7],te=e[8];return c*L*te-c*O*U-p*w*te+p*O*F+_*w*U-_*L*F}invert(){const e=this.elements,c=e[0],p=e[1],_=e[2],w=e[3],L=e[4],O=e[5],F=e[6],U=e[7],te=e[8],ce=te*L-O*U,oe=O*F-te*w,de=U*w-L*F,ve=c*ce+p*oe+_*de;if(0===ve)return this.set(0,0,0,0,0,0,0,0,0);const Me=1/ve;return e[0]=ce*Me,e[1]=(_*U-te*p)*Me,e[2]=(O*p-_*L)*Me,e[3]=oe*Me,e[4]=(te*c-_*F)*Me,e[5]=(_*w-O*c)*Me,e[6]=de*Me,e[7]=(p*F-U*c)*Me,e[8]=(L*c-p*w)*Me,this}transpose(){let e;const c=this.elements;return e=c[1],c[1]=c[3],c[3]=e,e=c[2],c[2]=c[6],c[6]=e,e=c[5],c[5]=c[7],c[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const c=this.elements;return e[0]=c[0],e[1]=c[3],e[2]=c[6],e[3]=c[1],e[4]=c[4],e[5]=c[7],e[6]=c[2],e[7]=c[5],e[8]=c[8],this}setUvTransform(e,c,p,_,w,L,O){const F=Math.cos(w),U=Math.sin(w);return this.set(p*F,p*U,-p*(F*L+U*O)+L+e,-_*U,_*F,-_*(-U*L+F*O)+O+c,0,0,1),this}scale(e,c){const p=this.elements;return p[0]*=e,p[3]*=e,p[6]*=e,p[1]*=c,p[4]*=c,p[7]*=c,this}rotate(e){const c=Math.cos(e),p=Math.sin(e),_=this.elements,w=_[0],L=_[3],O=_[6],F=_[1],U=_[4],te=_[7];return _[0]=c*w+p*F,_[3]=c*L+p*U,_[6]=c*O+p*te,_[1]=-p*w+c*F,_[4]=-p*L+c*U,_[7]=-p*O+c*te,this}translate(e,c){const p=this.elements;return p[0]+=e*p[2],p[3]+=e*p[5],p[6]+=e*p[8],p[1]+=c*p[2],p[4]+=c*p[5],p[7]+=c*p[8],this}equals(e){const c=this.elements,p=e.elements;for(let _=0;_<9;_++)if(c[_]!==p[_])return!1;return!0}fromArray(e,c=0){for(let p=0;p<9;p++)this.elements[p]=e[p+c];return this}toArray(e=[],c=0){const p=this.elements;return e[c]=p[0],e[c+1]=p[1],e[c+2]=p[2],e[c+3]=p[3],e[c+4]=p[4],e[c+5]=p[5],e[c+6]=p[6],e[c+7]=p[7],e[c+8]=p[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}let Sl;ot.prototype.isMatrix3=!0;class Ms{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let c;if(e instanceof HTMLCanvasElement)c=e;else{void 0===Sl&&(Sl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Sl.width=e.width,Sl.height=e.height;const p=Sl.getContext("2d");e instanceof ImageData?p.putImageData(e,0,0):p.drawImage(e,0,0,e.width,e.height),c=Sl}return c.width>2048||c.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}}let Ep=0;class As extends Os{constructor(e=As.DEFAULT_IMAGE,c=As.DEFAULT_MAPPING,p=Yr,_=Yr,w=ai,L=Ka,O=mo,F=oa,U=1,te=Ki){super(),Object.defineProperty(this,"id",{value:Ep++}),this.uuid=eo(),this.name="",this.image=e,this.mipmaps=[],this.mapping=c,this.wrapS=p,this.wrapT=_,this.magFilter=w,this.minFilter=L,this.anisotropy=U,this.format=O,this.internalFormat=null,this.type=F,this.offset=new Un(0,0),this.repeat=new Un(1,1),this.center=new Un(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ot,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=te,this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){const c=void 0===e||"string"==typeof e;if(!c&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const p={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const _=this.image;if(void 0===_.uuid&&(_.uuid=eo()),!c&&void 0===e.images[_.uuid]){let w;if(Array.isArray(_)){w=[];for(let L=0,O=_.length;L<O;L++)w.push(vc(_[L].isDataTexture?_[L].image:_[L]))}else w=vc(_);e.images[_.uuid]={uuid:_.uuid,url:w}}p.image=_.uuid}return c||(e.textures[this.uuid]=p),p}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==gi)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case wo:e.x=e.x-Math.floor(e.x);break;case Yr:e.x=e.x<0?0:1;break;case os:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case wo:e.y=e.y-Math.floor(e.y);break;case Yr:e.y=e.y<0?0:1;break;case os:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function vc(S){return typeof HTMLImageElement<"u"&&S instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&S instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&S instanceof ImageBitmap?Ms.getDataURL(S):S.data?{data:Array.prototype.slice.call(S.data),width:S.width,height:S.height,type:S.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}As.DEFAULT_IMAGE=void 0,As.DEFAULT_MAPPING=gi,As.prototype.isTexture=!0;class ji{constructor(e=0,c=0,p=0,_=1){this.x=e,this.y=c,this.z=p,this.w=_}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,c,p,_){return this.x=e,this.y=c,this.z=p,this.w=_,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this.z=e.z+c.z,this.w=e.w+c.w,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this.z+=e.z*c,this.w+=e.w*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this.z=e.z-c.z,this.w=e.w-c.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const c=this.x,p=this.y,_=this.z,w=this.w,L=e.elements;return this.x=L[0]*c+L[4]*p+L[8]*_+L[12]*w,this.y=L[1]*c+L[5]*p+L[9]*_+L[13]*w,this.z=L[2]*c+L[6]*p+L[10]*_+L[14]*w,this.w=L[3]*c+L[7]*p+L[11]*_+L[15]*w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const c=Math.sqrt(1-e.w*e.w);return c<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/c,this.y=e.y/c,this.z=e.z/c),this}setAxisAngleFromRotationMatrix(e){let c,p,_,w;const F=e.elements,U=F[0],te=F[4],ce=F[8],oe=F[1],de=F[5],ve=F[9],Me=F[2],Be=F[6],Ae=F[10];if(Math.abs(te-oe)<.01&&Math.abs(ce-Me)<.01&&Math.abs(ve-Be)<.01){if(Math.abs(te+oe)<.1&&Math.abs(ce+Me)<.1&&Math.abs(ve+Be)<.1&&Math.abs(U+de+Ae-3)<.1)return this.set(1,0,0,0),this;c=Math.PI;const Je=(U+1)/2,We=(de+1)/2,rt=(Ae+1)/2,nt=(te+oe)/4,gt=(ce+Me)/4,xt=(ve+Be)/4;return Je>We&&Je>rt?Je<.01?(p=0,_=.707106781,w=.707106781):(p=Math.sqrt(Je),_=nt/p,w=gt/p):We>rt?We<.01?(p=.707106781,_=0,w=.707106781):(_=Math.sqrt(We),p=nt/_,w=xt/_):rt<.01?(p=.707106781,_=.707106781,w=0):(w=Math.sqrt(rt),p=gt/w,_=xt/w),this.set(p,_,w,c),this}let ke=Math.sqrt((Be-ve)*(Be-ve)+(ce-Me)*(ce-Me)+(oe-te)*(oe-te));return Math.abs(ke)<.001&&(ke=1),this.x=(Be-ve)/ke,this.y=(ce-Me)/ke,this.z=(oe-te)/ke,this.w=Math.acos((U+de+Ae-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this.z=Math.max(e.z,Math.min(c.z,this.z)),this.w=Math.max(e.w,Math.min(c.w,this.w)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this.z=Math.max(e,Math.min(c,this.z)),this.w=Math.max(e,Math.min(c,this.w)),this}clampLength(e,c){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(e,Math.min(c,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this.z+=(e.z-this.z)*c,this.w+=(e.w-this.w)*c,this}lerpVectors(e,c,p){return this.x=e.x+(c.x-e.x)*p,this.y=e.y+(c.y-e.y)*p,this.z=e.z+(c.z-e.z)*p,this.w=e.w+(c.w-e.w)*p,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this.z=e[c+2],this.w=e[c+3],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e[c+2]=this.z,e[c+3]=this.w,e}fromBufferAttribute(e,c,p){return void 0!==p&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this.z=e.getZ(c),this.w=e.getW(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}ji.prototype.isVector4=!0;class lo extends Os{constructor(e,c,p={}){super(),this.width=e,this.height=c,this.depth=1,this.scissor=new ji(0,0,e,c),this.scissorTest=!1,this.viewport=new ji(0,0,e,c),this.texture=new As(void 0,p.mapping,p.wrapS,p.wrapT,p.magFilter,p.minFilter,p.format,p.type,p.anisotropy,p.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:c,depth:1},this.texture.generateMipmaps=void 0!==p.generateMipmaps&&p.generateMipmaps,this.texture.internalFormat=void 0!==p.internalFormat?p.internalFormat:null,this.texture.minFilter=void 0!==p.minFilter?p.minFilter:ai,this.depthBuffer=void 0===p.depthBuffer||p.depthBuffer,this.stencilBuffer=void 0!==p.stencilBuffer&&p.stencilBuffer,this.depthTexture=void 0!==p.depthTexture?p.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,c,p=1){this.width===e&&this.height===c&&this.depth===p||(this.width=e,this.height=c,this.depth=p,this.texture.image.width=e,this.texture.image.height=c,this.texture.image.depth=p,this.dispose()),this.viewport.set(0,0,e,c),this.scissor.set(0,0,e,c)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}lo.prototype.isWebGLRenderTarget=!0;class ni extends lo{constructor(e,c,p){super(e,c);const _=this.texture;this.texture=[];for(let w=0;w<p;w++)this.texture[w]=_.clone()}setSize(e,c,p=1){if(this.width!==e||this.height!==c||this.depth!==p){this.width=e,this.height=c,this.depth=p;for(let _=0,w=this.texture.length;_<w;_++)this.texture[_].image.width=e,this.texture[_].image.height=c,this.texture[_].image.depth=p;this.dispose()}return this.viewport.set(0,0,e,c),this.scissor.set(0,0,e,c),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let c=0,p=e.texture.length;c<p;c++)this.texture[c]=e.texture[c].clone();return this}}ni.prototype.isWebGLMultipleRenderTargets=!0;class Vc extends lo{constructor(e,c,p){super(e,c,p),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}Vc.prototype.isWebGLMultisampleRenderTarget=!0;class Ci{constructor(e=0,c=0,p=0,_=1){this._x=e,this._y=c,this._z=p,this._w=_}static slerp(e,c,p,_){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),p.slerpQuaternions(e,c,_)}static slerpFlat(e,c,p,_,w,L,O){let F=p[_+0],U=p[_+1],te=p[_+2],ce=p[_+3];const oe=w[L+0],de=w[L+1],ve=w[L+2],Me=w[L+3];if(0===O)return e[c+0]=F,e[c+1]=U,e[c+2]=te,void(e[c+3]=ce);if(1===O)return e[c+0]=oe,e[c+1]=de,e[c+2]=ve,void(e[c+3]=Me);if(ce!==Me||F!==oe||U!==de||te!==ve){let Be=1-O;const Ae=F*oe+U*de+te*ve+ce*Me,ke=Ae>=0?1:-1,Je=1-Ae*Ae;if(Je>Number.EPSILON){const rt=Math.sqrt(Je),nt=Math.atan2(rt,Ae*ke);Be=Math.sin(Be*nt)/rt,O=Math.sin(O*nt)/rt}const We=O*ke;if(F=F*Be+oe*We,U=U*Be+de*We,te=te*Be+ve*We,ce=ce*Be+Me*We,Be===1-O){const rt=1/Math.sqrt(F*F+U*U+te*te+ce*ce);F*=rt,U*=rt,te*=rt,ce*=rt}}e[c]=F,e[c+1]=U,e[c+2]=te,e[c+3]=ce}static multiplyQuaternionsFlat(e,c,p,_,w,L){const O=p[_],F=p[_+1],U=p[_+2],te=p[_+3],ce=w[L],oe=w[L+1],de=w[L+2],ve=w[L+3];return e[c]=O*ve+te*ce+F*de-U*oe,e[c+1]=F*ve+te*oe+U*ce-O*de,e[c+2]=U*ve+te*de+O*oe-F*ce,e[c+3]=te*ve-O*ce-F*oe-U*de,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,c,p,_){return this._x=e,this._y=c,this._z=p,this._w=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,c){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const p=e._x,_=e._y,w=e._z,L=e._order,O=Math.cos,F=Math.sin,U=O(p/2),te=O(_/2),ce=O(w/2),oe=F(p/2),de=F(_/2),ve=F(w/2);switch(L){case"XYZ":this._x=oe*te*ce+U*de*ve,this._y=U*de*ce-oe*te*ve,this._z=U*te*ve+oe*de*ce,this._w=U*te*ce-oe*de*ve;break;case"YXZ":this._x=oe*te*ce+U*de*ve,this._y=U*de*ce-oe*te*ve,this._z=U*te*ve-oe*de*ce,this._w=U*te*ce+oe*de*ve;break;case"ZXY":this._x=oe*te*ce-U*de*ve,this._y=U*de*ce+oe*te*ve,this._z=U*te*ve+oe*de*ce,this._w=U*te*ce-oe*de*ve;break;case"ZYX":this._x=oe*te*ce-U*de*ve,this._y=U*de*ce+oe*te*ve,this._z=U*te*ve-oe*de*ce,this._w=U*te*ce+oe*de*ve;break;case"YZX":this._x=oe*te*ce+U*de*ve,this._y=U*de*ce+oe*te*ve,this._z=U*te*ve-oe*de*ce,this._w=U*te*ce-oe*de*ve;break;case"XZY":this._x=oe*te*ce-U*de*ve,this._y=U*de*ce-oe*te*ve,this._z=U*te*ve+oe*de*ce,this._w=U*te*ce+oe*de*ve;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+L)}return!1!==c&&this._onChangeCallback(),this}setFromAxisAngle(e,c){const p=c/2,_=Math.sin(p);return this._x=e.x*_,this._y=e.y*_,this._z=e.z*_,this._w=Math.cos(p),this._onChangeCallback(),this}setFromRotationMatrix(e){const c=e.elements,p=c[0],_=c[4],w=c[8],L=c[1],O=c[5],F=c[9],U=c[2],te=c[6],ce=c[10],oe=p+O+ce;if(oe>0){const de=.5/Math.sqrt(oe+1);this._w=.25/de,this._x=(te-F)*de,this._y=(w-U)*de,this._z=(L-_)*de}else if(p>O&&p>ce){const de=2*Math.sqrt(1+p-O-ce);this._w=(te-F)/de,this._x=.25*de,this._y=(_+L)/de,this._z=(w+U)/de}else if(O>ce){const de=2*Math.sqrt(1+O-p-ce);this._w=(w-U)/de,this._x=(_+L)/de,this._y=.25*de,this._z=(F+te)/de}else{const de=2*Math.sqrt(1+ce-p-O);this._w=(L-_)/de,this._x=(w+U)/de,this._y=(F+te)/de,this._z=.25*de}return this._onChangeCallback(),this}setFromUnitVectors(e,c){let p=e.dot(c)+1;return p<Number.EPSILON?(p=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=p):(this._x=0,this._y=-e.z,this._z=e.y,this._w=p)):(this._x=e.y*c.z-e.z*c.y,this._y=e.z*c.x-e.x*c.z,this._z=e.x*c.y-e.y*c.x,this._w=p),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Gr(this.dot(e),-1,1)))}rotateTowards(e,c){const p=this.angleTo(e);if(0===p)return this;const _=Math.min(1,c/p);return this.slerp(e,_),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,c){return void 0!==c?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,c)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,c){const p=e._x,_=e._y,w=e._z,L=e._w,O=c._x,F=c._y,U=c._z,te=c._w;return this._x=p*te+L*O+_*U-w*F,this._y=_*te+L*F+w*O-p*U,this._z=w*te+L*U+p*F-_*O,this._w=L*te-p*O-_*F-w*U,this._onChangeCallback(),this}slerp(e,c){if(0===c)return this;if(1===c)return this.copy(e);const p=this._x,_=this._y,w=this._z,L=this._w;let O=L*e._w+p*e._x+_*e._y+w*e._z;if(O<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,O=-O):this.copy(e),O>=1)return this._w=L,this._x=p,this._y=_,this._z=w,this;const F=1-O*O;if(F<=Number.EPSILON){const de=1-c;return this._w=de*L+c*this._w,this._x=de*p+c*this._x,this._y=de*_+c*this._y,this._z=de*w+c*this._z,this.normalize(),this._onChangeCallback(),this}const U=Math.sqrt(F),te=Math.atan2(U,O),ce=Math.sin((1-c)*te)/U,oe=Math.sin(c*te)/U;return this._w=L*ce+this._w*oe,this._x=p*ce+this._x*oe,this._y=_*ce+this._y*oe,this._z=w*ce+this._z*oe,this._onChangeCallback(),this}slerpQuaternions(e,c,p){this.copy(e).slerp(c,p)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,c=0){return this._x=e[c],this._y=e[c+1],this._z=e[c+2],this._w=e[c+3],this._onChangeCallback(),this}toArray(e=[],c=0){return e[c]=this._x,e[c+1]=this._y,e[c+2]=this._z,e[c+3]=this._w,e}fromBufferAttribute(e,c){return this._x=e.getX(c),this._y=e.getY(c),this._z=e.getZ(c),this._w=e.getW(c),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Ci.prototype.isQuaternion=!0;class at{constructor(e=0,c=0,p=0){this.x=e,this.y=c,this.z=p}set(e,c,p){return void 0===p&&(p=this.z),this.x=e,this.y=c,this.z=p,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this.z=e.z+c.z,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this.z+=e.z*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this.z=e.z-c.z,this}multiply(e,c){return void 0!==c?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,c)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,c){return this.x=e.x*c.x,this.y=e.y*c.y,this.z=e.z*c.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Tp.setFromEuler(e))}applyAxisAngle(e,c){return this.applyQuaternion(Tp.setFromAxisAngle(e,c))}applyMatrix3(e){const c=this.x,p=this.y,_=this.z,w=e.elements;return this.x=w[0]*c+w[3]*p+w[6]*_,this.y=w[1]*c+w[4]*p+w[7]*_,this.z=w[2]*c+w[5]*p+w[8]*_,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const c=this.x,p=this.y,_=this.z,w=e.elements,L=1/(w[3]*c+w[7]*p+w[11]*_+w[15]);return this.x=(w[0]*c+w[4]*p+w[8]*_+w[12])*L,this.y=(w[1]*c+w[5]*p+w[9]*_+w[13])*L,this.z=(w[2]*c+w[6]*p+w[10]*_+w[14])*L,this}applyQuaternion(e){const c=this.x,p=this.y,_=this.z,w=e.x,L=e.y,O=e.z,F=e.w,U=F*c+L*_-O*p,te=F*p+O*c-w*_,ce=F*_+w*p-L*c,oe=-w*c-L*p-O*_;return this.x=U*F+oe*-w+te*-O-ce*-L,this.y=te*F+oe*-L+ce*-w-U*-O,this.z=ce*F+oe*-O+U*-L-te*-w,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const c=this.x,p=this.y,_=this.z,w=e.elements;return this.x=w[0]*c+w[4]*p+w[8]*_,this.y=w[1]*c+w[5]*p+w[9]*_,this.z=w[2]*c+w[6]*p+w[10]*_,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this.z=Math.max(e.z,Math.min(c.z,this.z)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this.z=Math.max(e,Math.min(c,this.z)),this}clampLength(e,c){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(e,Math.min(c,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this.z+=(e.z-this.z)*c,this}lerpVectors(e,c,p){return this.x=e.x+(c.x-e.x)*p,this.y=e.y+(c.y-e.y)*p,this.z=e.z+(c.z-e.z)*p,this}cross(e,c){return void 0!==c?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,c)):this.crossVectors(this,e)}crossVectors(e,c){const p=e.x,_=e.y,w=e.z,L=c.x,O=c.y,F=c.z;return this.x=_*F-w*O,this.y=w*L-p*F,this.z=p*O-_*L,this}projectOnVector(e){const c=e.lengthSq();if(0===c)return this.set(0,0,0);const p=e.dot(this)/c;return this.copy(e).multiplyScalar(p)}projectOnPlane(e){return gu.copy(this).projectOnVector(e),this.sub(gu)}reflect(e){return this.sub(gu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const c=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===c)return Math.PI/2;const p=this.dot(e)/c;return Math.acos(Gr(p,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const c=this.x-e.x,p=this.y-e.y,_=this.z-e.z;return c*c+p*p+_*_}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,c,p){const _=Math.sin(c)*e;return this.x=_*Math.sin(p),this.y=Math.cos(c)*e,this.z=_*Math.cos(p),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,c,p){return this.x=e*Math.sin(c),this.y=p,this.z=e*Math.cos(c),this}setFromMatrixPosition(e){const c=e.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}setFromMatrixScale(e){const c=this.setFromMatrixColumn(e,0).length(),p=this.setFromMatrixColumn(e,1).length(),_=this.setFromMatrixColumn(e,2).length();return this.x=c,this.y=p,this.z=_,this}setFromMatrixColumn(e,c){return this.fromArray(e.elements,4*c)}setFromMatrix3Column(e,c){return this.fromArray(e.elements,3*c)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this.z=e[c+2],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e[c+2]=this.z,e}fromBufferAttribute(e,c,p){return void 0!==p&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this.z=e.getZ(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}at.prototype.isVector3=!0;const gu=new at,Tp=new Ci;class Gi{constructor(e=new at(1/0,1/0,1/0),c=new at(-1/0,-1/0,-1/0)){this.min=e,this.max=c}set(e,c){return this.min.copy(e),this.max.copy(c),this}setFromArray(e){let c=1/0,p=1/0,_=1/0,w=-1/0,L=-1/0,O=-1/0;for(let F=0,U=e.length;F<U;F+=3){const te=e[F],ce=e[F+1],oe=e[F+2];te<c&&(c=te),ce<p&&(p=ce),oe<_&&(_=oe),te>w&&(w=te),ce>L&&(L=ce),oe>O&&(O=oe)}return this.min.set(c,p,_),this.max.set(w,L,O),this}setFromBufferAttribute(e){let c=1/0,p=1/0,_=1/0,w=-1/0,L=-1/0,O=-1/0;for(let F=0,U=e.count;F<U;F++){const te=e.getX(F),ce=e.getY(F),oe=e.getZ(F);te<c&&(c=te),ce<p&&(p=ce),oe<_&&(_=oe),te>w&&(w=te),ce>L&&(L=ce),oe>O&&(O=oe)}return this.min.set(c,p,_),this.max.set(w,L,O),this}setFromPoints(e){this.makeEmpty();for(let c=0,p=e.length;c<p;c++)this.expandByPoint(e[c]);return this}setFromCenterAndSize(e,c){const p=Wr.copy(c).multiplyScalar(.5);return this.min.copy(e).sub(p),this.max.copy(e).add(p),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const c=e.geometry;void 0!==c&&(null===c.boundingBox&&c.computeBoundingBox(),Ua.copy(c.boundingBox),Ua.applyMatrix4(e.matrixWorld),this.union(Ua));const p=e.children;for(let _=0,w=p.length;_<w;_++)this.expandByObject(p[_]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,c){return c.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Wr),Wr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let c,p;return e.normal.x>0?(c=e.normal.x*this.min.x,p=e.normal.x*this.max.x):(c=e.normal.x*this.max.x,p=e.normal.x*this.min.x),e.normal.y>0?(c+=e.normal.y*this.min.y,p+=e.normal.y*this.max.y):(c+=e.normal.y*this.max.y,p+=e.normal.y*this.min.y),e.normal.z>0?(c+=e.normal.z*this.min.z,p+=e.normal.z*this.max.z):(c+=e.normal.z*this.max.z,p+=e.normal.z*this.min.z),c<=-e.constant&&p>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(gh),bc.subVectors(this.max,gh),Eo.subVectors(e.a,gh),ua.subVectors(e.b,gh),vu.subVectors(e.c,gh),yc.subVectors(ua,Eo),Wc.subVectors(vu,ua),yu.subVectors(Eo,vu);let c=[0,-yc.z,yc.y,0,-Wc.z,Wc.y,0,-yu.z,yu.y,yc.z,0,-yc.x,Wc.z,0,-Wc.x,yu.z,0,-yu.x,-yc.y,yc.x,0,-Wc.y,Wc.x,0,-yu.y,yu.x,0];return!!za(c,Eo,ua,vu,bc)&&(c=[1,0,0,0,1,0,0,0,1],!!za(c,Eo,ua,vu,bc)&&(Zn.crossVectors(yc,Wc),c=[Zn.x,Zn.y,Zn.z],za(c,Eo,ua,vu,bc)))}clampPoint(e,c){return c.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Wr.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Wr).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(kr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),kr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),kr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),kr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),kr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),kr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),kr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),kr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(kr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Gi.prototype.isBox3=!0;const kr=[new at,new at,new at,new at,new at,new at,new at,new at],Wr=new at,Ua=new Gi,Eo=new at,ua=new at,vu=new at,yc=new at,Wc=new at,yu=new at,gh=new at,bc=new at,Zn=new at,El=new at;function za(S,e,c,p,_){for(let w=0,L=S.length-3;w<=L;w+=3){El.fromArray(S,w);const O=_.x*Math.abs(El.x)+_.y*Math.abs(El.y)+_.z*Math.abs(El.z),F=e.dot(El),U=c.dot(El),te=p.dot(El);if(Math.max(-Math.max(F,U,te),Math.min(F,U,te))>O)return!1}return!0}const xa=new Gi,Xl=new at,bu=new at,wa=new at;class To{constructor(e=new at,c=-1){this.center=e,this.radius=c}set(e,c){return this.center.copy(e),this.radius=c,this}setFromPoints(e,c){const p=this.center;void 0!==c?p.copy(c):xa.setFromPoints(e).getCenter(p);let _=0;for(let w=0,L=e.length;w<L;w++)_=Math.max(_,p.distanceToSquared(e[w]));return this.radius=Math.sqrt(_),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const c=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=c*c}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,c){const p=this.center.distanceToSquared(e);return c.copy(e),p>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){wa.subVectors(e,this.center);const c=wa.lengthSq();if(c>this.radius*this.radius){const p=Math.sqrt(c),_=.5*(p-this.radius);this.center.add(wa.multiplyScalar(_/p)),this.radius+=_}return this}union(e){return bu.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Xl.copy(e.center).add(bu)),this.expandByPoint(Xl.copy(e.center).sub(bu)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Fs=new at,xc=new at,tt=new at,bt=new at,kt=new at,yn=new at,Xt=new at;class mn{constructor(e=new at,c=new at(0,0,-1)){this.origin=e,this.direction=c}set(e,c){return this.origin.copy(e),this.direction.copy(c),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,c){return c.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Fs)),this}closestPointToPoint(e,c){c.subVectors(e,this.origin);const p=c.dot(this.direction);return p<0?c.copy(this.origin):c.copy(this.direction).multiplyScalar(p).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const c=Fs.subVectors(e,this.origin).dot(this.direction);return c<0?this.origin.distanceToSquared(e):(Fs.copy(this.direction).multiplyScalar(c).add(this.origin),Fs.distanceToSquared(e))}distanceSqToSegment(e,c,p,_){xc.copy(e).add(c).multiplyScalar(.5),tt.copy(c).sub(e).normalize(),bt.copy(this.origin).sub(xc);const w=.5*e.distanceTo(c),L=-this.direction.dot(tt),O=bt.dot(this.direction),F=-bt.dot(tt),U=bt.lengthSq(),te=Math.abs(1-L*L);let ce,oe,de,ve;if(te>0)if(ce=L*F-O,oe=L*O-F,ve=w*te,ce>=0)if(oe>=-ve)if(oe<=ve){const Me=1/te;ce*=Me,oe*=Me,de=ce*(ce+L*oe+2*O)+oe*(L*ce+oe+2*F)+U}else oe=w,ce=Math.max(0,-(L*oe+O)),de=-ce*ce+oe*(oe+2*F)+U;else oe=-w,ce=Math.max(0,-(L*oe+O)),de=-ce*ce+oe*(oe+2*F)+U;else oe<=-ve?(ce=Math.max(0,-(-L*w+O)),oe=ce>0?-w:Math.min(Math.max(-w,-F),w),de=-ce*ce+oe*(oe+2*F)+U):oe<=ve?(ce=0,oe=Math.min(Math.max(-w,-F),w),de=oe*(oe+2*F)+U):(ce=Math.max(0,-(L*w+O)),oe=ce>0?w:Math.min(Math.max(-w,-F),w),de=-ce*ce+oe*(oe+2*F)+U);else oe=L>0?-w:w,ce=Math.max(0,-(L*oe+O)),de=-ce*ce+oe*(oe+2*F)+U;return p&&p.copy(this.direction).multiplyScalar(ce).add(this.origin),_&&_.copy(tt).multiplyScalar(oe).add(xc),de}intersectSphere(e,c){Fs.subVectors(e.center,this.origin);const p=Fs.dot(this.direction),_=Fs.dot(Fs)-p*p,w=e.radius*e.radius;if(_>w)return null;const L=Math.sqrt(w-_),O=p-L,F=p+L;return O<0&&F<0?null:this.at(O<0?F:O,c)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const c=e.normal.dot(this.direction);if(0===c)return 0===e.distanceToPoint(this.origin)?0:null;const p=-(this.origin.dot(e.normal)+e.constant)/c;return p>=0?p:null}intersectPlane(e,c){const p=this.distanceToPlane(e);return null===p?null:this.at(p,c)}intersectsPlane(e){const c=e.distanceToPoint(this.origin);return 0===c||e.normal.dot(this.direction)*c<0}intersectBox(e,c){let p,_,w,L,O,F;const U=1/this.direction.x,te=1/this.direction.y,ce=1/this.direction.z,oe=this.origin;return U>=0?(p=(e.min.x-oe.x)*U,_=(e.max.x-oe.x)*U):(p=(e.max.x-oe.x)*U,_=(e.min.x-oe.x)*U),te>=0?(w=(e.min.y-oe.y)*te,L=(e.max.y-oe.y)*te):(w=(e.max.y-oe.y)*te,L=(e.min.y-oe.y)*te),p>L||w>_?null:((w>p||p!=p)&&(p=w),(L<_||_!=_)&&(_=L),ce>=0?(O=(e.min.z-oe.z)*ce,F=(e.max.z-oe.z)*ce):(O=(e.max.z-oe.z)*ce,F=(e.min.z-oe.z)*ce),p>F||O>_?null:((O>p||p!=p)&&(p=O),(F<_||_!=_)&&(_=F),_<0?null:this.at(p>=0?p:_,c)))}intersectsBox(e){return null!==this.intersectBox(e,Fs)}intersectTriangle(e,c,p,_,w){kt.subVectors(c,e),yn.subVectors(p,e),Xt.crossVectors(kt,yn);let L,O=this.direction.dot(Xt);if(O>0){if(_)return null;L=1}else{if(!(O<0))return null;L=-1,O=-O}bt.subVectors(this.origin,e);const F=L*this.direction.dot(yn.crossVectors(bt,yn));if(F<0)return null;const U=L*this.direction.dot(kt.cross(bt));if(U<0||F+U>O)return null;const te=-L*bt.dot(Xt);return te<0?null:this.at(te/O,w)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Kt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,c,p,_,w,L,O,F,U,te,ce,oe,de,ve,Me,Be){const Ae=this.elements;return Ae[0]=e,Ae[4]=c,Ae[8]=p,Ae[12]=_,Ae[1]=w,Ae[5]=L,Ae[9]=O,Ae[13]=F,Ae[2]=U,Ae[6]=te,Ae[10]=ce,Ae[14]=oe,Ae[3]=de,Ae[7]=ve,Ae[11]=Me,Ae[15]=Be,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Kt).fromArray(this.elements)}copy(e){const c=this.elements,p=e.elements;return c[0]=p[0],c[1]=p[1],c[2]=p[2],c[3]=p[3],c[4]=p[4],c[5]=p[5],c[6]=p[6],c[7]=p[7],c[8]=p[8],c[9]=p[9],c[10]=p[10],c[11]=p[11],c[12]=p[12],c[13]=p[13],c[14]=p[14],c[15]=p[15],this}copyPosition(e){const c=this.elements,p=e.elements;return c[12]=p[12],c[13]=p[13],c[14]=p[14],this}setFromMatrix3(e){const c=e.elements;return this.set(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1),this}extractBasis(e,c,p){return e.setFromMatrixColumn(this,0),c.setFromMatrixColumn(this,1),p.setFromMatrixColumn(this,2),this}makeBasis(e,c,p){return this.set(e.x,c.x,p.x,0,e.y,c.y,p.y,0,e.z,c.z,p.z,0,0,0,0,1),this}extractRotation(e){const c=this.elements,p=e.elements,_=1/qn.setFromMatrixColumn(e,0).length(),w=1/qn.setFromMatrixColumn(e,1).length(),L=1/qn.setFromMatrixColumn(e,2).length();return c[0]=p[0]*_,c[1]=p[1]*_,c[2]=p[2]*_,c[3]=0,c[4]=p[4]*w,c[5]=p[5]*w,c[6]=p[6]*w,c[7]=0,c[8]=p[8]*L,c[9]=p[9]*L,c[10]=p[10]*L,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const c=this.elements,p=e.x,_=e.y,w=e.z,L=Math.cos(p),O=Math.sin(p),F=Math.cos(_),U=Math.sin(_),te=Math.cos(w),ce=Math.sin(w);if("XYZ"===e.order){const oe=L*te,de=L*ce,ve=O*te,Me=O*ce;c[0]=F*te,c[4]=-F*ce,c[8]=U,c[1]=de+ve*U,c[5]=oe-Me*U,c[9]=-O*F,c[2]=Me-oe*U,c[6]=ve+de*U,c[10]=L*F}else if("YXZ"===e.order){const oe=F*te,de=F*ce,ve=U*te,Me=U*ce;c[0]=oe+Me*O,c[4]=ve*O-de,c[8]=L*U,c[1]=L*ce,c[5]=L*te,c[9]=-O,c[2]=de*O-ve,c[6]=Me+oe*O,c[10]=L*F}else if("ZXY"===e.order){const oe=F*te,de=F*ce,ve=U*te,Me=U*ce;c[0]=oe-Me*O,c[4]=-L*ce,c[8]=ve+de*O,c[1]=de+ve*O,c[5]=L*te,c[9]=Me-oe*O,c[2]=-L*U,c[6]=O,c[10]=L*F}else if("ZYX"===e.order){const oe=L*te,de=L*ce,ve=O*te,Me=O*ce;c[0]=F*te,c[4]=ve*U-de,c[8]=oe*U+Me,c[1]=F*ce,c[5]=Me*U+oe,c[9]=de*U-ve,c[2]=-U,c[6]=O*F,c[10]=L*F}else if("YZX"===e.order){const oe=L*F,de=L*U,ve=O*F,Me=O*U;c[0]=F*te,c[4]=Me-oe*ce,c[8]=ve*ce+de,c[1]=ce,c[5]=L*te,c[9]=-O*te,c[2]=-U*te,c[6]=de*ce+ve,c[10]=oe-Me*ce}else if("XZY"===e.order){const oe=L*F,de=L*U,ve=O*F,Me=O*U;c[0]=F*te,c[4]=-ce,c[8]=U*te,c[1]=oe*ce+Me,c[5]=L*te,c[9]=de*ce-ve,c[2]=ve*ce-de,c[6]=O*te,c[10]=Me*ce+oe}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromQuaternion(e){return this.compose(xr,e,Mr)}lookAt(e,c,p){const _=this.elements;return fi.subVectors(e,c),0===fi.lengthSq()&&(fi.z=1),fi.normalize(),_r.crossVectors(p,fi),0===_r.lengthSq()&&(1===Math.abs(p.z)?fi.x+=1e-4:fi.z+=1e-4,fi.normalize(),_r.crossVectors(p,fi)),_r.normalize(),qr.crossVectors(fi,_r),_[0]=_r.x,_[4]=qr.x,_[8]=fi.x,_[1]=_r.y,_[5]=qr.y,_[9]=fi.y,_[2]=_r.z,_[6]=qr.z,_[10]=fi.z,this}multiply(e,c){return void 0!==c?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,c)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,c){const p=e.elements,_=c.elements,w=this.elements,L=p[0],O=p[4],F=p[8],U=p[12],te=p[1],ce=p[5],oe=p[9],de=p[13],ve=p[2],Me=p[6],Be=p[10],Ae=p[14],ke=p[3],Je=p[7],We=p[11],rt=p[15],nt=_[0],gt=_[4],xt=_[8],Ut=_[12],Ht=_[1],Ye=_[5],pt=_[9],Vt=_[13],Rt=_[2],lt=_[6],Jt=_[10],St=_[14],jt=_[3],It=_[7],ln=_[11],Ze=_[15];return w[0]=L*nt+O*Ht+F*Rt+U*jt,w[4]=L*gt+O*Ye+F*lt+U*It,w[8]=L*xt+O*pt+F*Jt+U*ln,w[12]=L*Ut+O*Vt+F*St+U*Ze,w[1]=te*nt+ce*Ht+oe*Rt+de*jt,w[5]=te*gt+ce*Ye+oe*lt+de*It,w[9]=te*xt+ce*pt+oe*Jt+de*ln,w[13]=te*Ut+ce*Vt+oe*St+de*Ze,w[2]=ve*nt+Me*Ht+Be*Rt+Ae*jt,w[6]=ve*gt+Me*Ye+Be*lt+Ae*It,w[10]=ve*xt+Me*pt+Be*Jt+Ae*ln,w[14]=ve*Ut+Me*Vt+Be*St+Ae*Ze,w[3]=ke*nt+Je*Ht+We*Rt+rt*jt,w[7]=ke*gt+Je*Ye+We*lt+rt*It,w[11]=ke*xt+Je*pt+We*Jt+rt*ln,w[15]=ke*Ut+Je*Vt+We*St+rt*Ze,this}multiplyScalar(e){const c=this.elements;return c[0]*=e,c[4]*=e,c[8]*=e,c[12]*=e,c[1]*=e,c[5]*=e,c[9]*=e,c[13]*=e,c[2]*=e,c[6]*=e,c[10]*=e,c[14]*=e,c[3]*=e,c[7]*=e,c[11]*=e,c[15]*=e,this}determinant(){const e=this.elements,c=e[0],p=e[4],_=e[8],w=e[12],L=e[1],O=e[5],F=e[9],U=e[13],te=e[2],ce=e[6],oe=e[10],de=e[14];return e[3]*(+w*F*ce-_*U*ce-w*O*oe+p*U*oe+_*O*de-p*F*de)+e[7]*(+c*F*de-c*U*oe+w*L*oe-_*L*de+_*U*te-w*F*te)+e[11]*(+c*U*ce-c*O*de-w*L*ce+p*L*de+w*O*te-p*U*te)+e[15]*(-_*O*te-c*F*ce+c*O*oe+_*L*ce-p*L*oe+p*F*te)}transpose(){const e=this.elements;let c;return c=e[1],e[1]=e[4],e[4]=c,c=e[2],e[2]=e[8],e[8]=c,c=e[6],e[6]=e[9],e[9]=c,c=e[3],e[3]=e[12],e[12]=c,c=e[7],e[7]=e[13],e[13]=c,c=e[11],e[11]=e[14],e[14]=c,this}setPosition(e,c,p){const _=this.elements;return e.isVector3?(_[12]=e.x,_[13]=e.y,_[14]=e.z):(_[12]=e,_[13]=c,_[14]=p),this}invert(){const e=this.elements,c=e[0],p=e[1],_=e[2],w=e[3],L=e[4],O=e[5],F=e[6],U=e[7],te=e[8],ce=e[9],oe=e[10],de=e[11],ve=e[12],Me=e[13],Be=e[14],Ae=e[15],ke=ce*Be*U-Me*oe*U+Me*F*de-O*Be*de-ce*F*Ae+O*oe*Ae,Je=ve*oe*U-te*Be*U-ve*F*de+L*Be*de+te*F*Ae-L*oe*Ae,We=te*Me*U-ve*ce*U+ve*O*de-L*Me*de-te*O*Ae+L*ce*Ae,rt=ve*ce*F-te*Me*F-ve*O*oe+L*Me*oe+te*O*Be-L*ce*Be,nt=c*ke+p*Je+_*We+w*rt;if(0===nt)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const gt=1/nt;return e[0]=ke*gt,e[1]=(Me*oe*w-ce*Be*w-Me*_*de+p*Be*de+ce*_*Ae-p*oe*Ae)*gt,e[2]=(O*Be*w-Me*F*w+Me*_*U-p*Be*U-O*_*Ae+p*F*Ae)*gt,e[3]=(ce*F*w-O*oe*w-ce*_*U+p*oe*U+O*_*de-p*F*de)*gt,e[4]=Je*gt,e[5]=(te*Be*w-ve*oe*w+ve*_*de-c*Be*de-te*_*Ae+c*oe*Ae)*gt,e[6]=(ve*F*w-L*Be*w-ve*_*U+c*Be*U+L*_*Ae-c*F*Ae)*gt,e[7]=(L*oe*w-te*F*w+te*_*U-c*oe*U-L*_*de+c*F*de)*gt,e[8]=We*gt,e[9]=(ve*ce*w-te*Me*w-ve*p*de+c*Me*de+te*p*Ae-c*ce*Ae)*gt,e[10]=(L*Me*w-ve*O*w+ve*p*U-c*Me*U-L*p*Ae+c*O*Ae)*gt,e[11]=(te*O*w-L*ce*w-te*p*U+c*ce*U+L*p*de-c*O*de)*gt,e[12]=rt*gt,e[13]=(te*Me*_-ve*ce*_+ve*p*oe-c*Me*oe-te*p*Be+c*ce*Be)*gt,e[14]=(ve*O*_-L*Me*_-ve*p*F+c*Me*F+L*p*Be-c*O*Be)*gt,e[15]=(L*ce*_-te*O*_+te*p*F-c*ce*F-L*p*oe+c*O*oe)*gt,this}scale(e){const c=this.elements,p=e.x,_=e.y,w=e.z;return c[0]*=p,c[4]*=_,c[8]*=w,c[1]*=p,c[5]*=_,c[9]*=w,c[2]*=p,c[6]*=_,c[10]*=w,c[3]*=p,c[7]*=_,c[11]*=w,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,c,p){return this.set(1,0,0,e,0,1,0,c,0,0,1,p,0,0,0,1),this}makeRotationX(e){const c=Math.cos(e),p=Math.sin(e);return this.set(1,0,0,0,0,c,-p,0,0,p,c,0,0,0,0,1),this}makeRotationY(e){const c=Math.cos(e),p=Math.sin(e);return this.set(c,0,p,0,0,1,0,0,-p,0,c,0,0,0,0,1),this}makeRotationZ(e){const c=Math.cos(e),p=Math.sin(e);return this.set(c,-p,0,0,p,c,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,c){const p=Math.cos(c),_=Math.sin(c),w=1-p,L=e.x,O=e.y,F=e.z,U=w*L,te=w*O;return this.set(U*L+p,U*O-_*F,U*F+_*O,0,U*O+_*F,te*O+p,te*F-_*L,0,U*F-_*O,te*F+_*L,w*F*F+p,0,0,0,0,1),this}makeScale(e,c,p){return this.set(e,0,0,0,0,c,0,0,0,0,p,0,0,0,0,1),this}makeShear(e,c,p,_,w,L){return this.set(1,p,w,0,e,1,L,0,c,_,1,0,0,0,0,1),this}compose(e,c,p){const _=this.elements,w=c._x,L=c._y,O=c._z,F=c._w,U=w+w,te=L+L,ce=O+O,oe=w*U,de=w*te,ve=w*ce,Me=L*te,Be=L*ce,Ae=O*ce,ke=F*U,Je=F*te,We=F*ce,rt=p.x,nt=p.y,gt=p.z;return _[0]=(1-(Me+Ae))*rt,_[1]=(de+We)*rt,_[2]=(ve-Je)*rt,_[3]=0,_[4]=(de-We)*nt,_[5]=(1-(oe+Ae))*nt,_[6]=(Be+ke)*nt,_[7]=0,_[8]=(ve+Je)*gt,_[9]=(Be-ke)*gt,_[10]=(1-(oe+Me))*gt,_[11]=0,_[12]=e.x,_[13]=e.y,_[14]=e.z,_[15]=1,this}decompose(e,c,p){const _=this.elements;let w=qn.set(_[0],_[1],_[2]).length();const L=qn.set(_[4],_[5],_[6]).length(),O=qn.set(_[8],_[9],_[10]).length();this.determinant()<0&&(w=-w),e.x=_[12],e.y=_[13],e.z=_[14],zn.copy(this);const F=1/w,U=1/L,te=1/O;return zn.elements[0]*=F,zn.elements[1]*=F,zn.elements[2]*=F,zn.elements[4]*=U,zn.elements[5]*=U,zn.elements[6]*=U,zn.elements[8]*=te,zn.elements[9]*=te,zn.elements[10]*=te,c.setFromRotationMatrix(zn),p.x=w,p.y=L,p.z=O,this}makePerspective(e,c,p,_,w,L){void 0===L&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const O=this.elements,U=2*w/(p-_),te=(c+e)/(c-e),ce=(p+_)/(p-_),oe=-(L+w)/(L-w),de=-2*L*w/(L-w);return O[0]=2*w/(c-e),O[4]=0,O[8]=te,O[12]=0,O[1]=0,O[5]=U,O[9]=ce,O[13]=0,O[2]=0,O[6]=0,O[10]=oe,O[14]=de,O[3]=0,O[7]=0,O[11]=-1,O[15]=0,this}makeOrthographic(e,c,p,_,w,L){const O=this.elements,F=1/(c-e),U=1/(p-_),te=1/(L-w),ce=(c+e)*F,oe=(p+_)*U,de=(L+w)*te;return O[0]=2*F,O[4]=0,O[8]=0,O[12]=-ce,O[1]=0,O[5]=2*U,O[9]=0,O[13]=-oe,O[2]=0,O[6]=0,O[10]=-2*te,O[14]=-de,O[3]=0,O[7]=0,O[11]=0,O[15]=1,this}equals(e){const c=this.elements,p=e.elements;for(let _=0;_<16;_++)if(c[_]!==p[_])return!1;return!0}fromArray(e,c=0){for(let p=0;p<16;p++)this.elements[p]=e[p+c];return this}toArray(e=[],c=0){const p=this.elements;return e[c]=p[0],e[c+1]=p[1],e[c+2]=p[2],e[c+3]=p[3],e[c+4]=p[4],e[c+5]=p[5],e[c+6]=p[6],e[c+7]=p[7],e[c+8]=p[8],e[c+9]=p[9],e[c+10]=p[10],e[c+11]=p[11],e[c+12]=p[12],e[c+13]=p[13],e[c+14]=p[14],e[c+15]=p[15],e}}Kt.prototype.isMatrix4=!0;const qn=new at,zn=new Kt,xr=new at(0,0,0),Mr=new at(1,1,1),_r=new at,qr=new at,fi=new at,Rr=new Kt,Ko=new Ci;class _o{constructor(e=0,c=0,p=0,_=_o.DefaultOrder){this._x=e,this._y=c,this._z=p,this._order=_}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,c,p,_=this._order){return this._x=e,this._y=c,this._z=p,this._order=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,c=this._order,p=!0){const _=e.elements,w=_[0],L=_[4],O=_[8],F=_[1],U=_[5],te=_[9],ce=_[2],oe=_[6],de=_[10];switch(c){case"XYZ":this._y=Math.asin(Gr(O,-1,1)),Math.abs(O)<.9999999?(this._x=Math.atan2(-te,de),this._z=Math.atan2(-L,w)):(this._x=Math.atan2(oe,U),this._z=0);break;case"YXZ":this._x=Math.asin(-Gr(te,-1,1)),Math.abs(te)<.9999999?(this._y=Math.atan2(O,de),this._z=Math.atan2(F,U)):(this._y=Math.atan2(-ce,w),this._z=0);break;case"ZXY":this._x=Math.asin(Gr(oe,-1,1)),Math.abs(oe)<.9999999?(this._y=Math.atan2(-ce,de),this._z=Math.atan2(-L,U)):(this._y=0,this._z=Math.atan2(F,w));break;case"ZYX":this._y=Math.asin(-Gr(ce,-1,1)),Math.abs(ce)<.9999999?(this._x=Math.atan2(oe,de),this._z=Math.atan2(F,w)):(this._x=0,this._z=Math.atan2(-L,U));break;case"YZX":this._z=Math.asin(Gr(F,-1,1)),Math.abs(F)<.9999999?(this._x=Math.atan2(-te,U),this._y=Math.atan2(-ce,w)):(this._x=0,this._y=Math.atan2(O,de));break;case"XZY":this._z=Math.asin(-Gr(L,-1,1)),Math.abs(L)<.9999999?(this._x=Math.atan2(oe,U),this._y=Math.atan2(O,w)):(this._x=Math.atan2(-te,de),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+c)}return this._order=c,!0===p&&this._onChangeCallback(),this}setFromQuaternion(e,c,p){return Rr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Rr,c,p)}setFromVector3(e,c=this._order){return this.set(e.x,e.y,e.z,c)}reorder(e){return Ko.setFromEuler(this),this.setFromQuaternion(Ko,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],c=0){return e[c]=this._x,e[c+1]=this._y,e[c+2]=this._z,e[c+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new at(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}_o.prototype.isEuler=!0,_o.DefaultOrder="XYZ",_o.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Xs{constructor(){this.mask=1}set(e){this.mask=1<<e}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return!!(this.mask&e.mask)}}let Io=0;const Yl=new at,Xo=new Ci,Yi=new Kt,wc=new at,Wh=new at,Xu=new at,Mp=new Ci,vh=new at(1,0,0),_d=new at(0,1,0),yh=new at(0,0,1),Fd={type:"added"},gd={type:"removed"};class Pr extends Os{constructor(){super(),Object.defineProperty(this,"id",{value:Io++}),this.uuid=eo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Pr.DefaultUp.clone();const e=new at,c=new _o,p=new Ci,_=new at(1,1,1);c._onChange(function(){p.setFromEuler(c,!1)}),p._onChange(function(){c.setFromQuaternion(p,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:c},quaternion:{configurable:!0,enumerable:!0,value:p},scale:{configurable:!0,enumerable:!0,value:_},modelViewMatrix:{value:new Kt},normalMatrix:{value:new ot}}),this.matrix=new Kt,this.matrixWorld=new Kt,this.matrixAutoUpdate=Pr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Xs,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,c){this.quaternion.setFromAxisAngle(e,c)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,c){return Xo.setFromAxisAngle(e,c),this.quaternion.multiply(Xo),this}rotateOnWorldAxis(e,c){return Xo.setFromAxisAngle(e,c),this.quaternion.premultiply(Xo),this}rotateX(e){return this.rotateOnAxis(vh,e)}rotateY(e){return this.rotateOnAxis(_d,e)}rotateZ(e){return this.rotateOnAxis(yh,e)}translateOnAxis(e,c){return Yl.copy(e).applyQuaternion(this.quaternion),this.position.add(Yl.multiplyScalar(c)),this}translateX(e){return this.translateOnAxis(vh,e)}translateY(e){return this.translateOnAxis(_d,e)}translateZ(e){return this.translateOnAxis(yh,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Yi.copy(this.matrixWorld).invert())}lookAt(e,c,p){e.isVector3?wc.copy(e):wc.set(e,c,p);const _=this.parent;this.updateWorldMatrix(!0,!1),Wh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Yi.lookAt(Wh,wc,this.up):Yi.lookAt(wc,Wh,this.up),this.quaternion.setFromRotationMatrix(Yi),_&&(Yi.extractRotation(_.matrixWorld),Xo.setFromRotationMatrix(Yi),this.quaternion.premultiply(Xo.invert()))}add(e){if(arguments.length>1){for(let c=0;c<arguments.length;c++)this.add(arguments[c]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Fd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let p=0;p<arguments.length;p++)this.remove(arguments[p]);return this}const c=this.children.indexOf(e);return-1!==c&&(e.parent=null,this.children.splice(c,1),e.dispatchEvent(gd)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const c=this.children[e];c.parent=null,c.dispatchEvent(gd)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Yi.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Yi.multiply(e.parent.matrixWorld)),e.applyMatrix4(Yi),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,c){if(this[e]===c)return this;for(let p=0,_=this.children.length;p<_;p++){const w=this.children[p].getObjectByProperty(e,c);if(void 0!==w)return w}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wh,e,Xu),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Wh,Mp,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return e.set(c[8],c[9],c[10]).normalize()}raycast(){}traverse(e){e(this);const c=this.children;for(let p=0,_=c.length;p<_;p++)c[p].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const c=this.children;for(let p=0,_=c.length;p<_;p++)c[p].traverseVisible(e)}traverseAncestors(e){const c=this.parent;null!==c&&(e(c),c.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const c=this.children;for(let p=0,_=c.length;p<_;p++)c[p].updateMatrixWorld(e)}updateWorldMatrix(e,c){const p=this.parent;if(!0===e&&null!==p&&p.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===c){const _=this.children;for(let w=0,L=_.length;w<L;w++)_[w].updateWorldMatrix(!1,!0)}}toJSON(e){const c=void 0===e||"string"==typeof e,p={};c&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},p.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const _={};function w(O,F){return void 0===O[F.uuid]&&(O[F.uuid]=F.toJSON(e)),F.uuid}if(_.uuid=this.uuid,_.type=this.type,""!==this.name&&(_.name=this.name),!0===this.castShadow&&(_.castShadow=!0),!0===this.receiveShadow&&(_.receiveShadow=!0),!1===this.visible&&(_.visible=!1),!1===this.frustumCulled&&(_.frustumCulled=!1),0!==this.renderOrder&&(_.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(_.userData=this.userData),_.layers=this.layers.mask,_.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(_.matrixAutoUpdate=!1),this.isInstancedMesh&&(_.type="InstancedMesh",_.count=this.count,_.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(_.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?_.background=this.background.toJSON():this.background.isTexture&&(_.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(_.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){_.geometry=w(e.geometries,this.geometry);const O=this.geometry.parameters;if(void 0!==O&&void 0!==O.shapes){const F=O.shapes;if(Array.isArray(F))for(let U=0,te=F.length;U<te;U++)w(e.shapes,F[U]);else w(e.shapes,F)}}if(this.isSkinnedMesh&&(_.bindMode=this.bindMode,_.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(w(e.skeletons,this.skeleton),_.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const O=[];for(let F=0,U=this.material.length;F<U;F++)O.push(w(e.materials,this.material[F]));_.material=O}else _.material=w(e.materials,this.material);if(this.children.length>0){_.children=[];for(let O=0;O<this.children.length;O++)_.children.push(this.children[O].toJSON(e).object)}if(this.animations.length>0){_.animations=[];for(let O=0;O<this.animations.length;O++)_.animations.push(w(e.animations,this.animations[O]))}if(c){const O=L(e.geometries),F=L(e.materials),U=L(e.textures),te=L(e.images),ce=L(e.shapes),oe=L(e.skeletons),de=L(e.animations);O.length>0&&(p.geometries=O),F.length>0&&(p.materials=F),U.length>0&&(p.textures=U),te.length>0&&(p.images=te),ce.length>0&&(p.shapes=ce),oe.length>0&&(p.skeletons=oe),de.length>0&&(p.animations=de)}return p.object=_,p;function L(O){const F=[];for(const U in O){const te=O[U];delete te.metadata,F.push(te)}return F}}clone(e){return(new this.constructor).copy(this,e)}copy(e,c=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===c)for(let p=0;p<e.children.length;p++)this.add(e.children[p].clone());return this}}Pr.DefaultUp=new at(0,1,0),Pr.DefaultMatrixAutoUpdate=!0,Pr.prototype.isObject3D=!0;const Sc=new at,Ys=new at,Ap=new at,or=new at,Tl=new at,bh=new at,qh=new at,ha=new at,vd=new at,zr=new at;class ro{constructor(e=new at,c=new at,p=new at){this.a=e,this.b=c,this.c=p}static getNormal(e,c,p,_){_.subVectors(p,c),Sc.subVectors(e,c),_.cross(Sc);const w=_.lengthSq();return w>0?_.multiplyScalar(1/Math.sqrt(w)):_.set(0,0,0)}static getBarycoord(e,c,p,_,w){Sc.subVectors(_,c),Ys.subVectors(p,c),Ap.subVectors(e,c);const L=Sc.dot(Sc),O=Sc.dot(Ys),F=Sc.dot(Ap),U=Ys.dot(Ys),te=Ys.dot(Ap),ce=L*U-O*O;if(0===ce)return w.set(-2,-1,-1);const oe=1/ce,de=(U*F-O*te)*oe,ve=(L*te-O*F)*oe;return w.set(1-de-ve,ve,de)}static containsPoint(e,c,p,_){return this.getBarycoord(e,c,p,_,or),or.x>=0&&or.y>=0&&or.x+or.y<=1}static getUV(e,c,p,_,w,L,O,F){return this.getBarycoord(e,c,p,_,or),F.set(0,0),F.addScaledVector(w,or.x),F.addScaledVector(L,or.y),F.addScaledVector(O,or.z),F}static isFrontFacing(e,c,p,_){return Sc.subVectors(p,c),Ys.subVectors(e,c),Sc.cross(Ys).dot(_)<0}set(e,c,p){return this.a.copy(e),this.b.copy(c),this.c.copy(p),this}setFromPointsAndIndices(e,c,p,_){return this.a.copy(e[c]),this.b.copy(e[p]),this.c.copy(e[_]),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Sc.subVectors(this.c,this.b),Ys.subVectors(this.a,this.b),.5*Sc.cross(Ys).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(e){return ro.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,c){return ro.getBarycoord(e,this.a,this.b,this.c,c)}getUV(e,c,p,_,w){return ro.getUV(e,this.a,this.b,this.c,c,p,_,w)}containsPoint(e){return ro.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ro.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,c){const p=this.a,_=this.b,w=this.c;let L,O;Tl.subVectors(_,p),bh.subVectors(w,p),ha.subVectors(e,p);const F=Tl.dot(ha),U=bh.dot(ha);if(F<=0&&U<=0)return c.copy(p);vd.subVectors(e,_);const te=Tl.dot(vd),ce=bh.dot(vd);if(te>=0&&ce<=te)return c.copy(_);const oe=F*ce-te*U;if(oe<=0&&F>=0&&te<=0)return L=F/(F-te),c.copy(p).addScaledVector(Tl,L);zr.subVectors(e,w);const de=Tl.dot(zr),ve=bh.dot(zr);if(ve>=0&&de<=ve)return c.copy(w);const Me=de*U-F*ve;if(Me<=0&&U>=0&&ve<=0)return O=U/(U-ve),c.copy(p).addScaledVector(bh,O);const Be=te*ve-de*ce;if(Be<=0&&ce-te>=0&&de-ve>=0)return qh.subVectors(w,_),O=(ce-te)/(ce-te+(de-ve)),c.copy(_).addScaledVector(qh,O);const Ae=1/(Be+Me+oe);return L=Me*Ae,O=oe*Ae,c.copy(p).addScaledVector(Tl,L).addScaledVector(bh,O)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Oo=0;class $s extends Os{constructor(){super(),Object.defineProperty(this,"id",{value:Oo++}),this.uuid=eo(),this.name="",this.type="Material",this.fog=!0,this.blending=he,this.side=ie,this.vertexColors=!1,this.opacity=1,this.format=mo,this.transparent=!1,this.blendSrc=Ft,this.blendDst=Ot,this.blendEquation=Ne,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ar,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=aa,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ve,this.stencilZFail=Ve,this.stencilZPass=Ve,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const c in e){const p=e[c];if(void 0===p){console.warn("THREE.Material: '"+c+"' parameter is undefined.");continue}if("shading"===c){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=p===A;continue}const _=this[c];void 0!==_?_&&_.isColor?_.set(p):_&&_.isVector3&&p&&p.isVector3?_.copy(p):this[c]=p:console.warn("THREE."+this.type+": '"+c+"' is not a property of this material.")}}toJSON(e){const c=void 0===e||"string"==typeof e;c&&(e={textures:{},images:{}});const p={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function _(w){const L=[];for(const O in w){const F=w[O];delete F.metadata,L.push(F)}return L}if(p.uuid=this.uuid,p.type=this.type,""!==this.name&&(p.name=this.name),this.color&&this.color.isColor&&(p.color=this.color.getHex()),void 0!==this.roughness&&(p.roughness=this.roughness),void 0!==this.metalness&&(p.metalness=this.metalness),this.sheenTint&&this.sheenTint.isColor&&(p.sheenTint=this.sheenTint.getHex()),this.emissive&&this.emissive.isColor&&(p.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(p.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(p.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(p.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(p.specularTint=this.specularTint.getHex()),void 0!==this.shininess&&(p.shininess=this.shininess),void 0!==this.clearcoat&&(p.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(p.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(p.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(p.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(p.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,p.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(p.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(p.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(p.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(p.lightMap=this.lightMap.toJSON(e).uuid,p.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(p.aoMap=this.aoMap.toJSON(e).uuid,p.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(p.bumpMap=this.bumpMap.toJSON(e).uuid,p.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(p.normalMap=this.normalMap.toJSON(e).uuid,p.normalMapType=this.normalMapType,p.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(p.displacementMap=this.displacementMap.toJSON(e).uuid,p.displacementScale=this.displacementScale,p.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(p.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(p.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(p.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(p.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(p.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(p.specularTintMap=this.specularTintMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(p.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(p.combine=this.combine)),void 0!==this.envMapIntensity&&(p.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(p.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(p.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(p.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(p.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(p.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(p.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(p.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(p.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationTint&&(p.attenuationTint=this.attenuationTint.getHex()),void 0!==this.size&&(p.size=this.size),null!==this.shadowSide&&(p.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(p.sizeAttenuation=this.sizeAttenuation),this.blending!==he&&(p.blending=this.blending),this.side!==ie&&(p.side=this.side),this.vertexColors&&(p.vertexColors=!0),this.opacity<1&&(p.opacity=this.opacity),this.format!==mo&&(p.format=this.format),!0===this.transparent&&(p.transparent=this.transparent),p.depthFunc=this.depthFunc,p.depthTest=this.depthTest,p.depthWrite=this.depthWrite,p.colorWrite=this.colorWrite,p.stencilWrite=this.stencilWrite,p.stencilWriteMask=this.stencilWriteMask,p.stencilFunc=this.stencilFunc,p.stencilRef=this.stencilRef,p.stencilFuncMask=this.stencilFuncMask,p.stencilFail=this.stencilFail,p.stencilZFail=this.stencilZFail,p.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(p.rotation=this.rotation),!0===this.polygonOffset&&(p.polygonOffset=!0),0!==this.polygonOffsetFactor&&(p.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(p.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(p.linewidth=this.linewidth),void 0!==this.dashSize&&(p.dashSize=this.dashSize),void 0!==this.gapSize&&(p.gapSize=this.gapSize),void 0!==this.scale&&(p.scale=this.scale),!0===this.dithering&&(p.dithering=!0),this.alphaTest>0&&(p.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(p.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(p.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(p.wireframe=this.wireframe),this.wireframeLinewidth>1&&(p.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(p.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(p.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(p.flatShading=this.flatShading),!1===this.visible&&(p.visible=!1),!1===this.toneMapped&&(p.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(p.userData=this.userData),c){const w=_(e.textures),L=_(e.images);w.length>0&&(p.textures=w),L.length>0&&(p.images=L)}return p}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const c=e.clippingPlanes;let p=null;if(null!==c){const _=c.length;p=new Array(_);for(let w=0;w!==_;++w)p[w]=c[w].clone()}return this.clippingPlanes=p,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}$s.prototype.isMaterial=!0;const Hr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ol={h:0,s:0,l:0},Ec={h:0,s:0,l:0};function Yu(S,e,c){return c<0&&(c+=1),c>1&&(c-=1),c<.16666666666666666?S+6*(e-S)*c:c<.5?e:c<.6666666666666666?S+6*(e-S)*(.6666666666666666-c):S}function Xh(S){return S<.04045?.0773993808*S:Math.pow(.9478672986*S+.0521327014,2.4)}function Ml(S){return S<.0031308?12.92*S:1.055*Math.pow(S,.41666)-.055}class Qn{constructor(e,c,p){return void 0===c&&void 0===p?this.set(e):this.setRGB(e,c,p)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,c,p){return this.r=e,this.g=c,this.b=p,this}setHSL(e,c,p){if(e=di(e,1),c=Gr(c,0,1),p=Gr(p,0,1),0===c)this.r=this.g=this.b=p;else{const _=p<=.5?p*(1+c):p+c-p*c,w=2*p-_;this.r=Yu(w,_,e+.3333333333333333),this.g=Yu(w,_,e),this.b=Yu(w,_,e-.3333333333333333)}return this}setStyle(e){function c(_){void 0!==_&&parseFloat(_)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let p;if(p=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let _;const L=p[2];switch(p[1]){case"rgb":case"rgba":if(_=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(L))return this.r=Math.min(255,parseInt(_[1],10))/255,this.g=Math.min(255,parseInt(_[2],10))/255,this.b=Math.min(255,parseInt(_[3],10))/255,c(_[4]),this;if(_=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(L))return this.r=Math.min(100,parseInt(_[1],10))/100,this.g=Math.min(100,parseInt(_[2],10))/100,this.b=Math.min(100,parseInt(_[3],10))/100,c(_[4]),this;break;case"hsl":case"hsla":if(_=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(L)){const O=parseFloat(_[1])/360,F=parseInt(_[2],10)/100,U=parseInt(_[3],10)/100;return c(_[4]),this.setHSL(O,F,U)}}}else if(p=/^\#([A-Fa-f\d]+)$/.exec(e)){const _=p[1],w=_.length;if(3===w)return this.r=parseInt(_.charAt(0)+_.charAt(0),16)/255,this.g=parseInt(_.charAt(1)+_.charAt(1),16)/255,this.b=parseInt(_.charAt(2)+_.charAt(2),16)/255,this;if(6===w)return this.r=parseInt(_.charAt(0)+_.charAt(1),16)/255,this.g=parseInt(_.charAt(2)+_.charAt(3),16)/255,this.b=parseInt(_.charAt(4)+_.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const c=Hr[e.toLowerCase()];return void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,c=2){return this.r=Math.pow(e.r,c),this.g=Math.pow(e.g,c),this.b=Math.pow(e.b,c),this}copyLinearToGamma(e,c=2){const p=c>0?1/c:1;return this.r=Math.pow(e.r,p),this.g=Math.pow(e.g,p),this.b=Math.pow(e.b,p),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=Xh(e.r),this.g=Xh(e.g),this.b=Xh(e.b),this}copyLinearToSRGB(e){return this.r=Ml(e.r),this.g=Ml(e.g),this.b=Ml(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const c=this.r,p=this.g,_=this.b,w=Math.max(c,p,_),L=Math.min(c,p,_);let O,F;const U=(L+w)/2;if(L===w)O=0,F=0;else{const te=w-L;switch(F=U<=.5?te/(w+L):te/(2-w-L),w){case c:O=(p-_)/te+(p<_?6:0);break;case p:O=(_-c)/te+2;break;case _:O=(c-p)/te+4}O/=6}return e.h=O,e.s=F,e.l=U,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,c,p){return this.getHSL(ol),ol.h+=e,ol.s+=c,ol.l+=p,this.setHSL(ol.h,ol.s,ol.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,c){return this.r=e.r+c.r,this.g=e.g+c.g,this.b=e.b+c.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,c){return this.r+=(e.r-this.r)*c,this.g+=(e.g-this.g)*c,this.b+=(e.b-this.b)*c,this}lerpColors(e,c,p){return this.r=e.r+(c.r-e.r)*p,this.g=e.g+(c.g-e.g)*p,this.b=e.b+(c.b-e.b)*p,this}lerpHSL(e,c){this.getHSL(ol),e.getHSL(Ec);const p=bi(ol.h,Ec.h,c),_=bi(ol.s,Ec.s,c),w=bi(ol.l,Ec.l,c);return this.setHSL(p,_,w),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,c=0){return this.r=e[c],this.g=e[c+1],this.b=e[c+2],this}toArray(e=[],c=0){return e[c]=this.r,e[c+1]=this.g,e[c+2]=this.b,e}fromBufferAttribute(e,c){return this.r=e.getX(c),this.g=e.getY(c),this.b=e.getZ(c),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Qn.NAMES=Hr,Qn.prototype.isColor=!0,Qn.prototype.r=1,Qn.prototype.g=1,Qn.prototype.b=1;class sl extends $s{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Qn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}sl.prototype.isMeshBasicMaterial=!0;const Dn=new at,Al=new Un;class Fi{constructor(e,c,p){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=c,this.count=void 0!==e?e.length/c:0,this.normalized=!0===p,this.usage=yi,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,c,p){e*=this.itemSize,p*=c.itemSize;for(let _=0,w=this.itemSize;_<w;_++)this.array[e+_]=c.array[p+_];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const c=this.array;let p=0;for(let _=0,w=e.length;_<w;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",_),L=new Qn),c[p++]=L.r,c[p++]=L.g,c[p++]=L.b}return this}copyVector2sArray(e){const c=this.array;let p=0;for(let _=0,w=e.length;_<w;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",_),L=new Un),c[p++]=L.x,c[p++]=L.y}return this}copyVector3sArray(e){const c=this.array;let p=0;for(let _=0,w=e.length;_<w;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",_),L=new at),c[p++]=L.x,c[p++]=L.y,c[p++]=L.z}return this}copyVector4sArray(e){const c=this.array;let p=0;for(let _=0,w=e.length;_<w;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",_),L=new ji),c[p++]=L.x,c[p++]=L.y,c[p++]=L.z,c[p++]=L.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let c=0,p=this.count;c<p;c++)Al.fromBufferAttribute(this,c),Al.applyMatrix3(e),this.setXY(c,Al.x,Al.y);else if(3===this.itemSize)for(let c=0,p=this.count;c<p;c++)Dn.fromBufferAttribute(this,c),Dn.applyMatrix3(e),this.setXYZ(c,Dn.x,Dn.y,Dn.z);return this}applyMatrix4(e){for(let c=0,p=this.count;c<p;c++)Dn.x=this.getX(c),Dn.y=this.getY(c),Dn.z=this.getZ(c),Dn.applyMatrix4(e),this.setXYZ(c,Dn.x,Dn.y,Dn.z);return this}applyNormalMatrix(e){for(let c=0,p=this.count;c<p;c++)Dn.x=this.getX(c),Dn.y=this.getY(c),Dn.z=this.getZ(c),Dn.applyNormalMatrix(e),this.setXYZ(c,Dn.x,Dn.y,Dn.z);return this}transformDirection(e){for(let c=0,p=this.count;c<p;c++)Dn.x=this.getX(c),Dn.y=this.getY(c),Dn.z=this.getZ(c),Dn.transformDirection(e),this.setXYZ(c,Dn.x,Dn.y,Dn.z);return this}set(e,c=0){return this.array.set(e,c),this}getX(e){return this.array[e*this.itemSize]}setX(e,c){return this.array[e*this.itemSize]=c,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,c){return this.array[e*this.itemSize+1]=c,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,c){return this.array[e*this.itemSize+2]=c,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,c){return this.array[e*this.itemSize+3]=c,this}setXY(e,c,p){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=p,this}setXYZ(e,c,p,_){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=p,this.array[e+2]=_,this}setXYZW(e,c,p,_,w){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=p,this.array[e+2]=_,this.array[e+3]=w,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==yi&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}Fi.prototype.isBufferAttribute=!0;class Dd extends Fi{constructor(e,c,p){super(new Int8Array(e),c,p)}}class $p extends Fi{constructor(e,c,p){super(new Uint8Array(e),c,p)}}class Sa extends Fi{constructor(e,c,p){super(new Uint8ClampedArray(e),c,p)}}class Ju extends Fi{constructor(e,c,p){super(new Int16Array(e),c,p)}}class Zu extends Fi{constructor(e,c,p){super(new Uint16Array(e),c,p)}}class Ea extends Fi{constructor(e,c,p){super(new Int32Array(e),c,p)}}class li extends Fi{constructor(e,c,p){super(new Uint32Array(e),c,p)}}class Jr extends Fi{constructor(e,c,p){super(new Uint16Array(e),c,p)}}Jr.prototype.isFloat16BufferAttribute=!0;class pn extends Fi{constructor(e,c,p){super(new Float32Array(e),c,p)}}class qc extends Fi{constructor(e,c,p){super(new Float64Array(e),c,p)}}function ci(S){if(0===S.length)return-1/0;let e=S[0];for(let c=1,p=S.length;c<p;++c)S[c]>e&&(e=S[c]);return e}const pa={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ja(S,e){return new pa[S](e)}let Bn=0;const xi=new Kt,ys=new Pr,bs=new at,Cs=new Gi,ri=new Gi,Sr=new at;class gr extends Os{constructor(){super(),Object.defineProperty(this,"id",{value:Bn++}),this.uuid=eo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(ci(e)>65535?li:Zu)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,c){return this.attributes[e]=c,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,c,p=0){this.groups.push({start:e,count:c,materialIndex:p})}clearGroups(){this.groups=[]}setDrawRange(e,c){this.drawRange.start=e,this.drawRange.count=c}applyMatrix4(e){const c=this.attributes.position;void 0!==c&&(c.applyMatrix4(e),c.needsUpdate=!0);const p=this.attributes.normal;if(void 0!==p){const w=(new ot).getNormalMatrix(e);p.applyNormalMatrix(w),p.needsUpdate=!0}const _=this.attributes.tangent;return void 0!==_&&(_.transformDirection(e),_.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return xi.makeRotationFromQuaternion(e),this.applyMatrix4(xi),this}rotateX(e){return xi.makeRotationX(e),this.applyMatrix4(xi),this}rotateY(e){return xi.makeRotationY(e),this.applyMatrix4(xi),this}rotateZ(e){return xi.makeRotationZ(e),this.applyMatrix4(xi),this}translate(e,c,p){return xi.makeTranslation(e,c,p),this.applyMatrix4(xi),this}scale(e,c,p){return xi.makeScale(e,c,p),this.applyMatrix4(xi),this}lookAt(e){return ys.lookAt(e),ys.updateMatrix(),this.applyMatrix4(ys.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(bs).negate(),this.translate(bs.x,bs.y,bs.z),this}setFromPoints(e){const c=[];for(let p=0,_=e.length;p<_;p++){const w=e[p];c.push(w.x,w.y,w.z||0)}return this.setAttribute("position",new pn(c,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Gi);const e=this.attributes.position,c=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new at(-1/0,-1/0,-1/0),new at(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),c)for(let p=0,_=c.length;p<_;p++)Cs.setFromBufferAttribute(c[p]),this.morphTargetsRelative?(Sr.addVectors(this.boundingBox.min,Cs.min),this.boundingBox.expandByPoint(Sr),Sr.addVectors(this.boundingBox.max,Cs.max),this.boundingBox.expandByPoint(Sr)):(this.boundingBox.expandByPoint(Cs.min),this.boundingBox.expandByPoint(Cs.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new To);const e=this.attributes.position,c=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new at,1/0);if(e){const p=this.boundingSphere.center;if(Cs.setFromBufferAttribute(e),c)for(let w=0,L=c.length;w<L;w++)ri.setFromBufferAttribute(c[w]),this.morphTargetsRelative?(Sr.addVectors(Cs.min,ri.min),Cs.expandByPoint(Sr),Sr.addVectors(Cs.max,ri.max),Cs.expandByPoint(Sr)):(Cs.expandByPoint(ri.min),Cs.expandByPoint(ri.max));Cs.getCenter(p);let _=0;for(let w=0,L=e.count;w<L;w++)Sr.fromBufferAttribute(e,w),_=Math.max(_,p.distanceToSquared(Sr));if(c)for(let w=0,L=c.length;w<L;w++){const O=c[w],F=this.morphTargetsRelative;for(let U=0,te=O.count;U<te;U++)Sr.fromBufferAttribute(O,U),F&&(bs.fromBufferAttribute(e,U),Sr.add(bs)),_=Math.max(_,p.distanceToSquared(Sr))}this.boundingSphere.radius=Math.sqrt(_),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,c=this.attributes;if(null===e||void 0===c.position||void 0===c.normal||void 0===c.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const p=e.array,_=c.position.array,w=c.normal.array,L=c.uv.array,O=_.length/3;void 0===c.tangent&&this.setAttribute("tangent",new Fi(new Float32Array(4*O),4));const F=c.tangent.array,U=[],te=[];for(let Ht=0;Ht<O;Ht++)U[Ht]=new at,te[Ht]=new at;const ce=new at,oe=new at,de=new at,ve=new Un,Me=new Un,Be=new Un,Ae=new at,ke=new at;function Je(Ht,Ye,pt){ce.fromArray(_,3*Ht),oe.fromArray(_,3*Ye),de.fromArray(_,3*pt),ve.fromArray(L,2*Ht),Me.fromArray(L,2*Ye),Be.fromArray(L,2*pt),oe.sub(ce),de.sub(ce),Me.sub(ve),Be.sub(ve);const Vt=1/(Me.x*Be.y-Be.x*Me.y);isFinite(Vt)&&(Ae.copy(oe).multiplyScalar(Be.y).addScaledVector(de,-Me.y).multiplyScalar(Vt),ke.copy(de).multiplyScalar(Me.x).addScaledVector(oe,-Be.x).multiplyScalar(Vt),U[Ht].add(Ae),U[Ye].add(Ae),U[pt].add(Ae),te[Ht].add(ke),te[Ye].add(ke),te[pt].add(ke))}let We=this.groups;0===We.length&&(We=[{start:0,count:p.length}]);for(let Ht=0,Ye=We.length;Ht<Ye;++Ht){const pt=We[Ht],Vt=pt.start;for(let Rt=Vt,lt=Vt+pt.count;Rt<lt;Rt+=3)Je(p[Rt+0],p[Rt+1],p[Rt+2])}const rt=new at,nt=new at,gt=new at,xt=new at;function Ut(Ht){gt.fromArray(w,3*Ht),xt.copy(gt);const Ye=U[Ht];rt.copy(Ye),rt.sub(gt.multiplyScalar(gt.dot(Ye))).normalize(),nt.crossVectors(xt,Ye);const pt=nt.dot(te[Ht])<0?-1:1;F[4*Ht]=rt.x,F[4*Ht+1]=rt.y,F[4*Ht+2]=rt.z,F[4*Ht+3]=pt}for(let Ht=0,Ye=We.length;Ht<Ye;++Ht){const pt=We[Ht],Vt=pt.start;for(let Rt=Vt,lt=Vt+pt.count;Rt<lt;Rt+=3)Ut(p[Rt+0]),Ut(p[Rt+1]),Ut(p[Rt+2])}}computeVertexNormals(){const e=this.index,c=this.getAttribute("position");if(void 0!==c){let p=this.getAttribute("normal");if(void 0===p)p=new Fi(new Float32Array(3*c.count),3),this.setAttribute("normal",p);else for(let oe=0,de=p.count;oe<de;oe++)p.setXYZ(oe,0,0,0);const _=new at,w=new at,L=new at,O=new at,F=new at,U=new at,te=new at,ce=new at;if(e)for(let oe=0,de=e.count;oe<de;oe+=3){const ve=e.getX(oe+0),Me=e.getX(oe+1),Be=e.getX(oe+2);_.fromBufferAttribute(c,ve),w.fromBufferAttribute(c,Me),L.fromBufferAttribute(c,Be),te.subVectors(L,w),ce.subVectors(_,w),te.cross(ce),O.fromBufferAttribute(p,ve),F.fromBufferAttribute(p,Me),U.fromBufferAttribute(p,Be),O.add(te),F.add(te),U.add(te),p.setXYZ(ve,O.x,O.y,O.z),p.setXYZ(Me,F.x,F.y,F.z),p.setXYZ(Be,U.x,U.y,U.z)}else for(let oe=0,de=c.count;oe<de;oe+=3)_.fromBufferAttribute(c,oe+0),w.fromBufferAttribute(c,oe+1),L.fromBufferAttribute(c,oe+2),te.subVectors(L,w),ce.subVectors(_,w),te.cross(ce),p.setXYZ(oe+0,te.x,te.y,te.z),p.setXYZ(oe+1,te.x,te.y,te.z),p.setXYZ(oe+2,te.x,te.y,te.z);this.normalizeNormals(),p.needsUpdate=!0}}merge(e,c){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===c&&(c=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const p=this.attributes;for(const _ in p){if(void 0===e.attributes[_])continue;const w=p[_].array,L=e.attributes[_],O=L.array,F=L.itemSize*c,U=Math.min(O.length,w.length-F);for(let te=0,ce=F;te<U;te++,ce++)w[ce]=O[te]}return this}normalizeNormals(){const e=this.attributes.normal;for(let c=0,p=e.count;c<p;c++)Sr.fromBufferAttribute(e,c),Sr.normalize(),e.setXYZ(c,Sr.x,Sr.y,Sr.z)}toNonIndexed(){function e(O,F){const U=O.array,te=O.itemSize,ce=O.normalized,oe=new U.constructor(F.length*te);let de=0,ve=0;for(let Me=0,Be=F.length;Me<Be;Me++){de=O.isInterleavedBufferAttribute?F[Me]*O.data.stride+O.offset:F[Me]*te;for(let Ae=0;Ae<te;Ae++)oe[ve++]=U[de++]}return new Fi(oe,te,ce)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new gr,p=this.index.array,_=this.attributes;for(const O in _){const F=e(_[O],p);c.setAttribute(O,F)}const w=this.morphAttributes;for(const O in w){const F=[],U=w[O];for(let te=0,ce=U.length;te<ce;te++){const oe=e(U[te],p);F.push(oe)}c.morphAttributes[O]=F}c.morphTargetsRelative=this.morphTargetsRelative;const L=this.groups;for(let O=0,F=L.length;O<F;O++){const U=L[O];c.addGroup(U.start,U.count,U.materialIndex)}return c}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const F=this.parameters;for(const U in F)void 0!==F[U]&&(e[U]=F[U]);return e}e.data={attributes:{}};const c=this.index;null!==c&&(e.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});const p=this.attributes;for(const F in p)e.data.attributes[F]=p[F].toJSON(e.data);const _={};let w=!1;for(const F in this.morphAttributes){const U=this.morphAttributes[F],te=[];for(let ce=0,oe=U.length;ce<oe;ce++)te.push(U[ce].toJSON(e.data));te.length>0&&(_[F]=te,w=!0)}w&&(e.data.morphAttributes=_,e.data.morphTargetsRelative=this.morphTargetsRelative);const L=this.groups;L.length>0&&(e.data.groups=JSON.parse(JSON.stringify(L)));const O=this.boundingSphere;return null!==O&&(e.data.boundingSphere={center:O.center.toArray(),radius:O.radius}),e}clone(){return(new gr).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const c={};this.name=e.name;const p=e.index;null!==p&&this.setIndex(p.clone(c));const _=e.attributes;for(const U in _)this.setAttribute(U,_[U].clone(c));const w=e.morphAttributes;for(const U in w){const te=[],ce=w[U];for(let oe=0,de=ce.length;oe<de;oe++)te.push(ce[oe].clone(c));this.morphAttributes[U]=te}this.morphTargetsRelative=e.morphTargetsRelative;const L=e.groups;for(let U=0,te=L.length;U<te;U++){const ce=L[U];this.addGroup(ce.start,ce.count,ce.materialIndex)}const O=e.boundingBox;null!==O&&(this.boundingBox=O.clone());const F=e.boundingSphere;return null!==F&&(this.boundingSphere=F.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}gr.prototype.isBufferGeometry=!0;const ll=new Kt,Tc=new mn,Qu=new To,Ga=new at,es=new at,Li=new at,Yh=new at,xh=new at,Jh=new at,ur=new at,Yo=new at,cl=new at,Fr=new Un,Ls=new Un,Ku=new Un,Xc=new at,Bs=new at;class ko extends Pr{constructor(e=new gr,c=new sl){super(),this.type="Mesh",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,p=Object.keys(c);if(p.length>0){const _=c[p[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let w=0,L=_.length;w<L;w++){const O=_[w].name||String(w);this.morphTargetInfluences.push(0),this.morphTargetDictionary[O]=w}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,c){const p=this.geometry,_=this.material,w=this.matrixWorld;if(void 0===_||(null===p.boundingSphere&&p.computeBoundingSphere(),Qu.copy(p.boundingSphere),Qu.applyMatrix4(w),!1===e.ray.intersectsSphere(Qu))||(ll.copy(w).invert(),Tc.copy(e.ray).applyMatrix4(ll),null!==p.boundingBox&&!1===Tc.intersectsBox(p.boundingBox)))return;let L;if(p.isBufferGeometry){const O=p.index,F=p.attributes.position,U=p.morphAttributes.position,te=p.morphTargetsRelative,ce=p.attributes.uv,oe=p.attributes.uv2,de=p.groups,ve=p.drawRange;if(null!==O)if(Array.isArray(_))for(let Me=0,Be=de.length;Me<Be;Me++){const Ae=de[Me],ke=_[Ae.materialIndex];for(let Je=Math.max(Ae.start,ve.start),We=Math.min(Ae.start+Ae.count,ve.start+ve.count);Je<We;Je+=3){const rt=O.getX(Je),nt=O.getX(Je+1),gt=O.getX(Je+2);L=Zh(this,ke,e,Tc,F,U,te,ce,oe,rt,nt,gt),L&&(L.faceIndex=Math.floor(Je/3),L.face.materialIndex=Ae.materialIndex,c.push(L))}}else for(let Me=Math.max(0,ve.start),Be=Math.min(O.count,ve.start+ve.count);Me<Be;Me+=3){const Ae=O.getX(Me),ke=O.getX(Me+1),Je=O.getX(Me+2);L=Zh(this,_,e,Tc,F,U,te,ce,oe,Ae,ke,Je),L&&(L.faceIndex=Math.floor(Me/3),c.push(L))}else if(void 0!==F)if(Array.isArray(_))for(let Me=0,Be=de.length;Me<Be;Me++){const Ae=de[Me],ke=_[Ae.materialIndex];for(let Je=Math.max(Ae.start,ve.start),We=Math.min(Ae.start+Ae.count,ve.start+ve.count);Je<We;Je+=3)L=Zh(this,ke,e,Tc,F,U,te,ce,oe,Je,Je+1,Je+2),L&&(L.faceIndex=Math.floor(Je/3),L.face.materialIndex=Ae.materialIndex,c.push(L))}else for(let Me=Math.max(0,ve.start),Be=Math.min(F.count,ve.start+ve.count);Me<Be;Me+=3)L=Zh(this,_,e,Tc,F,U,te,ce,oe,Me,Me+1,Me+2),L&&(L.faceIndex=Math.floor(Me/3),c.push(L))}else p.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function Zh(S,e,c,p,_,w,L,O,F,U,te,ce){Ga.fromBufferAttribute(_,U),es.fromBufferAttribute(_,te),Li.fromBufferAttribute(_,ce);const oe=S.morphTargetInfluences;if(w&&oe){ur.set(0,0,0),Yo.set(0,0,0),cl.set(0,0,0);for(let ve=0,Me=w.length;ve<Me;ve++){const Be=oe[ve],Ae=w[ve];0!==Be&&(Yh.fromBufferAttribute(Ae,U),xh.fromBufferAttribute(Ae,te),Jh.fromBufferAttribute(Ae,ce),L?(ur.addScaledVector(Yh,Be),Yo.addScaledVector(xh,Be),cl.addScaledVector(Jh,Be)):(ur.addScaledVector(Yh.sub(Ga),Be),Yo.addScaledVector(xh.sub(es),Be),cl.addScaledVector(Jh.sub(Li),Be)))}Ga.add(ur),es.add(Yo),Li.add(cl)}S.isSkinnedMesh&&(S.boneTransform(U,Ga),S.boneTransform(te,es),S.boneTransform(ce,Li));const de=function(ve,Me,Be,Ae,ke,Je,We,rt){let nt;if(nt=Me.side===W?Ae.intersectTriangle(We,Je,ke,!0,rt):Ae.intersectTriangle(ke,Je,We,Me.side!==Q,rt),null===nt)return null;Bs.copy(rt),Bs.applyMatrix4(ve.matrixWorld);const gt=Be.ray.origin.distanceTo(Bs);return gt<Be.near||gt>Be.far?null:{distance:gt,point:Bs.clone(),object:ve}}(S,e,c,p,Ga,es,Li,Xc);if(de){O&&(Fr.fromBufferAttribute(O,U),Ls.fromBufferAttribute(O,te),Ku.fromBufferAttribute(O,ce),de.uv=ro.getUV(Xc,Ga,es,Li,Fr,Ls,Ku,new Un)),F&&(Fr.fromBufferAttribute(F,U),Ls.fromBufferAttribute(F,te),Ku.fromBufferAttribute(F,ce),de.uv2=ro.getUV(Xc,Ga,es,Li,Fr,Ls,Ku,new Un));const ve={a:U,b:te,c:ce,normal:new at,materialIndex:0};ro.getNormal(Ga,es,Li,ve.normal),de.face=ve}return de}ko.prototype.isMesh=!0;class Jl extends gr{constructor(e=1,c=1,p=1,_=1,w=1,L=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:c,depth:p,widthSegments:_,heightSegments:w,depthSegments:L};const O=this;_=Math.floor(_),w=Math.floor(w),L=Math.floor(L);const F=[],U=[],te=[],ce=[];let oe=0,de=0;function ve(Me,Be,Ae,ke,Je,We,rt,nt,gt,xt,Ut){const Ht=We/gt,Ye=rt/xt,pt=We/2,Vt=rt/2,Rt=nt/2,lt=gt+1,Jt=xt+1;let St=0,jt=0;const It=new at;for(let ln=0;ln<Jt;ln++){const Ze=ln*Ye-Vt;for(let st=0;st<lt;st++)It[Me]=(st*Ht-pt)*ke,It[Be]=Ze*Je,It[Ae]=Rt,U.push(It.x,It.y,It.z),It[Me]=0,It[Be]=0,It[Ae]=nt>0?1:-1,te.push(It.x,It.y,It.z),ce.push(st/gt),ce.push(1-ln/xt),St+=1}for(let ln=0;ln<xt;ln++)for(let Ze=0;Ze<gt;Ze++){const Pt=oe+Ze+lt*(ln+1),Gt=oe+(Ze+1)+lt*(ln+1),tn=oe+(Ze+1)+lt*ln;F.push(oe+Ze+lt*ln,Pt,tn),F.push(Pt,Gt,tn),jt+=6}O.addGroup(de,jt,Ut),de+=jt,oe+=St}ve("z","y","x",-1,-1,p,c,e,L,w,0),ve("z","y","x",1,-1,p,c,-e,L,w,1),ve("x","z","y",1,1,e,p,c,_,L,2),ve("x","z","y",1,-1,e,p,-c,_,L,3),ve("x","y","z",1,-1,e,c,p,_,w,4),ve("x","y","z",-1,-1,e,c,-p,_,w,5),this.setIndex(F),this.setAttribute("position",new pn(U,3)),this.setAttribute("normal",new pn(te,3)),this.setAttribute("uv",new pn(ce,2))}static fromJSON(e){return new Jl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function go(S){const e={};for(const c in S){e[c]={};for(const p in S[c]){const _=S[c][p];e[c][p]=_&&(_.isColor||_.isMatrix3||_.isMatrix4||_.isVector2||_.isVector3||_.isVector4||_.isTexture||_.isQuaternion)?_.clone():Array.isArray(_)?_.slice():_}}return e}function Ai(S){const e={};for(let c=0;c<S.length;c++){const p=go(S[c]);for(const _ in p)e[_]=p[_]}return e}const Ns={clone:go,merge:Ai};class Rs extends $s{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=go(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const c=super.toJSON(e);c.glslVersion=this.glslVersion,c.uniforms={};for(const _ in this.uniforms){const w=this.uniforms[_].value;c.uniforms[_]=w&&w.isTexture?{type:"t",value:w.toJSON(e).uuid}:w&&w.isColor?{type:"c",value:w.getHex()}:w&&w.isVector2?{type:"v2",value:w.toArray()}:w&&w.isVector3?{type:"v3",value:w.toArray()}:w&&w.isVector4?{type:"v4",value:w.toArray()}:w&&w.isMatrix3?{type:"m3",value:w.toArray()}:w&&w.isMatrix4?{type:"m4",value:w.toArray()}:{value:w}}Object.keys(this.defines).length>0&&(c.defines=this.defines),c.vertexShader=this.vertexShader,c.fragmentShader=this.fragmentShader;const p={};for(const _ in this.extensions)!0===this.extensions[_]&&(p[_]=!0);return Object.keys(p).length>0&&(c.extensions=p),c}}Rs.prototype.isShaderMaterial=!0;class $l extends Pr{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Kt,this.projectionMatrix=new Kt,this.projectionMatrixInverse=new Kt}copy(e,c){return super.copy(e,c),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return e.set(-c[8],-c[9],-c[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,c){super.updateWorldMatrix(e,c),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}$l.prototype.isCamera=!0;class Fo extends $l{constructor(e=50,c=1,p=.1,_=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=p,this.far=_,this.focus=10,this.aspect=c,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,c){return super.copy(e,c),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const c=.5*this.getFilmHeight()/e;this.fov=2*ss*Math.atan(c),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*jo*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ss*Math.atan(Math.tan(.5*jo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,c,p,_,w,L){this.aspect=e/c,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=c,this.view.offsetX=p,this.view.offsetY=_,this.view.width=w,this.view.height=L,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let c=e*Math.tan(.5*jo*this.fov)/this.zoom,p=2*c,_=this.aspect*p,w=-.5*_;const L=this.view;if(null!==this.view&&this.view.enabled){const F=L.fullWidth,U=L.fullHeight;w+=L.offsetX*_/F,c-=L.offsetY*p/U,_*=L.width/F,p*=L.height/U}const O=this.filmOffset;0!==O&&(w+=e*O/this.getFilmWidth()),this.projectionMatrix.makePerspective(w,w+_,c,c-p,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const c=super.toJSON(e);return c.object.fov=this.fov,c.object.zoom=this.zoom,c.object.near=this.near,c.object.far=this.far,c.object.focus=this.focus,c.object.aspect=this.aspect,null!==this.view&&(c.object.view=Object.assign({},this.view)),c.object.filmGauge=this.filmGauge,c.object.filmOffset=this.filmOffset,c}}Fo.prototype.isPerspectiveCamera=!0;class ul extends Pr{constructor(e,c,p){if(super(),this.type="CubeCamera",!0!==p.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=p;const _=new Fo(90,1,e,c);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new at(1,0,0)),this.add(_);const w=new Fo(90,1,e,c);w.layers=this.layers,w.up.set(0,-1,0),w.lookAt(new at(-1,0,0)),this.add(w);const L=new Fo(90,1,e,c);L.layers=this.layers,L.up.set(0,0,1),L.lookAt(new at(0,1,0)),this.add(L);const O=new Fo(90,1,e,c);O.layers=this.layers,O.up.set(0,0,-1),O.lookAt(new at(0,-1,0)),this.add(O);const F=new Fo(90,1,e,c);F.layers=this.layers,F.up.set(0,-1,0),F.lookAt(new at(0,0,1)),this.add(F);const U=new Fo(90,1,e,c);U.layers=this.layers,U.up.set(0,-1,0),U.lookAt(new at(0,0,-1)),this.add(U)}update(e,c){null===this.parent&&this.updateMatrixWorld();const p=this.renderTarget,[_,w,L,O,F,U]=this.children,te=e.xr.enabled,ce=e.getRenderTarget();e.xr.enabled=!1;const oe=p.texture.generateMipmaps;p.texture.generateMipmaps=!1,e.setRenderTarget(p,0),e.render(c,_),e.setRenderTarget(p,1),e.render(c,w),e.setRenderTarget(p,2),e.render(c,L),e.setRenderTarget(p,3),e.render(c,O),e.setRenderTarget(p,4),e.render(c,F),p.texture.generateMipmaps=oe,e.setRenderTarget(p,5),e.render(c,U),e.setRenderTarget(ce),e.xr.enabled=te}}class Zl extends As{constructor(e,c,p,_,w,L,O,F,U,te){super(e=void 0!==e?e:[],c=void 0!==c?c:Ti,p,_,w,L,O=void 0!==O?O:Is,F,U,te),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}Zl.prototype.isCubeTexture=!0;class Mc extends lo{constructor(e,c,p){Number.isInteger(c)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),c=p),super(e,e,c),this.texture=new Zl(void 0,(c=c||{}).mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==c.generateMipmaps&&c.generateMipmaps,this.texture.minFilter=void 0!==c.minFilter?c.minFilter:ai,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,c){this.texture.type=c.type,this.texture.format=mo,this.texture.encoding=c.encoding,this.texture.generateMipmaps=c.generateMipmaps,this.texture.minFilter=c.minFilter,this.texture.magFilter=c.magFilter;const L=new Jl(5,5,5),O=new Rs({name:"CubemapFromEquirect",uniforms:go({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:W,blending:X});O.uniforms.tEquirect.value=c;const F=new ko(L,O),U=c.minFilter;return c.minFilter===Ka&&(c.minFilter=ai),new ul(1,10,this).update(e,F),c.minFilter=U,F.geometry.dispose(),F.material.dispose(),this}clear(e,c,p,_){const w=e.getRenderTarget();for(let L=0;L<6;L++)e.setRenderTarget(this,L),e.clear(c,p,_);e.setRenderTarget(w)}}Mc.prototype.isWebGLCubeRenderTarget=!0;const Yc=new at,cr=new at,Cp=new ot;class Ta{constructor(e=new at(1,0,0),c=0){this.normal=e,this.constant=c}set(e,c){return this.normal.copy(e),this.constant=c,this}setComponents(e,c,p,_){return this.normal.set(e,c,p),this.constant=_,this}setFromNormalAndCoplanarPoint(e,c){return this.normal.copy(e),this.constant=-c.dot(this.normal),this}setFromCoplanarPoints(e,c,p){const _=Yc.subVectors(p,c).cross(cr.subVectors(e,c)).normalize();return this.setFromNormalAndCoplanarPoint(_,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,c){return c.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,c){const p=e.delta(Yc),_=this.normal.dot(p);if(0===_)return 0===this.distanceToPoint(e.start)?c.copy(e.start):null;const w=-(e.start.dot(this.normal)+this.constant)/_;return w<0||w>1?null:c.copy(p).multiplyScalar(w).add(e.start)}intersectsLine(e){const c=this.distanceToPoint(e.start),p=this.distanceToPoint(e.end);return c<0&&p>0||p<0&&c>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,c){const p=c||Cp.getNormalMatrix(e),_=this.coplanarPoint(Yc).applyMatrix4(e),w=this.normal.applyMatrix3(p).normalize();return this.constant=-_.dot(w),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Ta.prototype.isPlane=!0;const Ha=new To,Ll=new at;class Dr{constructor(e=new Ta,c=new Ta,p=new Ta,_=new Ta,w=new Ta,L=new Ta){this.planes=[e,c,p,_,w,L]}set(e,c,p,_,w,L){const O=this.planes;return O[0].copy(e),O[1].copy(c),O[2].copy(p),O[3].copy(_),O[4].copy(w),O[5].copy(L),this}copy(e){const c=this.planes;for(let p=0;p<6;p++)c[p].copy(e.planes[p]);return this}setFromProjectionMatrix(e){const c=this.planes,p=e.elements,_=p[0],w=p[1],L=p[2],O=p[3],F=p[4],U=p[5],te=p[6],ce=p[7],oe=p[8],de=p[9],ve=p[10],Me=p[11],Be=p[12],Ae=p[13],ke=p[14],Je=p[15];return c[0].setComponents(O-_,ce-F,Me-oe,Je-Be).normalize(),c[1].setComponents(O+_,ce+F,Me+oe,Je+Be).normalize(),c[2].setComponents(O+w,ce+U,Me+de,Je+Ae).normalize(),c[3].setComponents(O-w,ce-U,Me-de,Je-Ae).normalize(),c[4].setComponents(O-L,ce-te,Me-ve,Je-ke).normalize(),c[5].setComponents(O+L,ce+te,Me+ve,Je+ke).normalize(),this}intersectsObject(e){const c=e.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),Ha.copy(c.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ha)}intersectsSprite(e){return Ha.center.set(0,0,0),Ha.radius=.7071067811865476,Ha.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ha)}intersectsSphere(e){const c=this.planes,p=e.center,_=-e.radius;for(let w=0;w<6;w++)if(c[w].distanceToPoint(p)<_)return!1;return!0}intersectsBox(e){const c=this.planes;for(let p=0;p<6;p++){const _=c[p];if(Ll.x=_.normal.x>0?e.max.x:e.min.x,Ll.y=_.normal.y>0?e.max.y:e.min.y,Ll.z=_.normal.z>0?e.max.z:e.min.z,_.distanceToPoint(Ll)<0)return!1}return!0}containsPoint(e){const c=this.planes;for(let p=0;p<6;p++)if(c[p].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Ac(){let S=null,e=!1,c=null,p=null;function _(w,L){c(w,L),p=S.requestAnimationFrame(_)}return{start:function(){!0!==e&&null!==c&&(p=S.requestAnimationFrame(_),e=!0)},stop:function(){S.cancelAnimationFrame(p),e=!1},setAnimationLoop:function(w){c=w},setContext:function(w){S=w}}}function qp(S,e){const c=e.isWebGL2,p=new WeakMap;return{get:function(_){return _.isInterleavedBufferAttribute&&(_=_.data),p.get(_)},remove:function(_){_.isInterleavedBufferAttribute&&(_=_.data);const w=p.get(_);w&&(S.deleteBuffer(w.buffer),p.delete(_))},update:function(_,w){if(_.isGLBufferAttribute){const O=p.get(_);return void((!O||O.version<_.version)&&p.set(_,{buffer:_.buffer,type:_.type,bytesPerElement:_.elementSize,version:_.version}))}_.isInterleavedBufferAttribute&&(_=_.data);const L=p.get(_);void 0===L?p.set(_,function(O,F){const U=O.array,te=O.usage,ce=S.createBuffer();S.bindBuffer(F,ce),S.bufferData(F,U,te),O.onUploadCallback();let oe=5126;return U instanceof Float32Array?oe=5126:U instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):U instanceof Uint16Array?O.isFloat16BufferAttribute?c?oe=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):oe=5123:U instanceof Int16Array?oe=5122:U instanceof Uint32Array?oe=5125:U instanceof Int32Array?oe=5124:U instanceof Int8Array?oe=5120:(U instanceof Uint8Array||U instanceof Uint8ClampedArray)&&(oe=5121),{buffer:ce,type:oe,bytesPerElement:U.BYTES_PER_ELEMENT,version:O.version}}(_,w)):L.version<_.version&&(function(O,F,U){const te=F.array,ce=F.updateRange;S.bindBuffer(U,O),-1===ce.count?S.bufferSubData(U,0,te):(c?S.bufferSubData(U,ce.offset*te.BYTES_PER_ELEMENT,te,ce.offset,ce.count):S.bufferSubData(U,ce.offset*te.BYTES_PER_ELEMENT,te.subarray(ce.offset,ce.offset+ce.count)),ce.count=-1)}(L.buffer,_,w),L.version=_.version)}}}class xu extends gr{constructor(e=1,c=1,p=1,_=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:c,widthSegments:p,heightSegments:_};const w=e/2,L=c/2,O=Math.floor(p),F=Math.floor(_),U=O+1,te=F+1,ce=e/O,oe=c/F,de=[],ve=[],Me=[],Be=[];for(let Ae=0;Ae<te;Ae++){const ke=Ae*oe-L;for(let Je=0;Je<U;Je++)ve.push(Je*ce-w,-ke,0),Me.push(0,0,1),Be.push(Je/O),Be.push(1-Ae/F)}for(let Ae=0;Ae<F;Ae++)for(let ke=0;ke<O;ke++){const We=ke+U*(Ae+1),rt=ke+1+U*(Ae+1),nt=ke+1+U*Ae;de.push(ke+U*Ae,We,nt),de.push(We,rt,nt)}this.setIndex(de),this.setAttribute("position",new pn(ve,3)),this.setAttribute("normal",new pn(Me,3)),this.setAttribute("uv",new pn(Be,2))}static fromJSON(e){return new xu(e.width,e.height,e.widthSegments,e.heightSegments)}}const ui={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotVH = saturate( dot( geometry.viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float NoH ) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float NoV, float NoL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( NoL + NoV - NoL * NoV ) ) );\n}\nvec3 BRDF_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in GeometricContext geometry ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenTint = sheenTint;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenTint;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( material.roughness, directLight.direction, geometry, material.sheenTint );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = transmission.a;\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenTint;\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},ir={common:{diffuse:{value:new Qn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ot},uv2Transform:{value:new ot},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Un(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Qn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Qn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ot}},sprite:{diffuse:{value:new Qn(16777215)},opacity:{value:1},center:{value:new Un(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ot}}},Bl={basic:{uniforms:Ai([ir.common,ir.specularmap,ir.envmap,ir.aomap,ir.lightmap,ir.fog]),vertexShader:ui.meshbasic_vert,fragmentShader:ui.meshbasic_frag},lambert:{uniforms:Ai([ir.common,ir.specularmap,ir.envmap,ir.aomap,ir.lightmap,ir.emissivemap,ir.fog,ir.lights,{emissive:{value:new Qn(0)}}]),vertexShader:ui.meshlambert_vert,fragmentShader:ui.meshlambert_frag},phong:{uniforms:Ai([ir.common,ir.specularmap,ir.envmap,ir.aomap,ir.lightmap,ir.emissivemap,ir.bumpmap,ir.normalmap,ir.displacementmap,ir.fog,ir.lights,{emissive:{value:new Qn(0)},specular:{value:new Qn(1118481)},shininess:{value:30}}]),vertexShader:ui.meshphong_vert,fragmentShader:ui.meshphong_frag},standard:{uniforms:Ai([ir.common,ir.envmap,ir.aomap,ir.lightmap,ir.emissivemap,ir.bumpmap,ir.normalmap,ir.displacementmap,ir.roughnessmap,ir.metalnessmap,ir.fog,ir.lights,{emissive:{value:new Qn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ui.meshphysical_vert,fragmentShader:ui.meshphysical_frag},toon:{uniforms:Ai([ir.common,ir.aomap,ir.lightmap,ir.emissivemap,ir.bumpmap,ir.normalmap,ir.displacementmap,ir.gradientmap,ir.fog,ir.lights,{emissive:{value:new Qn(0)}}]),vertexShader:ui.meshtoon_vert,fragmentShader:ui.meshtoon_frag},matcap:{uniforms:Ai([ir.common,ir.bumpmap,ir.normalmap,ir.displacementmap,ir.fog,{matcap:{value:null}}]),vertexShader:ui.meshmatcap_vert,fragmentShader:ui.meshmatcap_frag},points:{uniforms:Ai([ir.points,ir.fog]),vertexShader:ui.points_vert,fragmentShader:ui.points_frag},dashed:{uniforms:Ai([ir.common,ir.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ui.linedashed_vert,fragmentShader:ui.linedashed_frag},depth:{uniforms:Ai([ir.common,ir.displacementmap]),vertexShader:ui.depth_vert,fragmentShader:ui.depth_frag},normal:{uniforms:Ai([ir.common,ir.bumpmap,ir.normalmap,ir.displacementmap,{opacity:{value:1}}]),vertexShader:ui.meshnormal_vert,fragmentShader:ui.meshnormal_frag},sprite:{uniforms:Ai([ir.sprite,ir.fog]),vertexShader:ui.sprite_vert,fragmentShader:ui.sprite_frag},background:{uniforms:{uvTransform:{value:new ot},t2D:{value:null}},vertexShader:ui.background_vert,fragmentShader:ui.background_frag},cube:{uniforms:Ai([ir.envmap,{opacity:{value:1}}]),vertexShader:ui.cube_vert,fragmentShader:ui.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ui.equirect_vert,fragmentShader:ui.equirect_frag},distanceRGBA:{uniforms:Ai([ir.common,ir.displacementmap,{referencePosition:{value:new at},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ui.distanceRGBA_vert,fragmentShader:ui.distanceRGBA_frag},shadow:{uniforms:Ai([ir.lights,ir.fog,{color:{value:new Qn(0)},opacity:{value:1}}]),vertexShader:ui.shadow_vert,fragmentShader:ui.shadow_frag}};function Jc(S,e,c,p,_){const w=new Qn(0);let L,O,F=0,U=null,te=0,ce=null;function oe(de,ve){c.buffers.color.setClear(de.r,de.g,de.b,ve,_)}return{getClearColor:function(){return w},setClearColor:function(de,ve=1){w.set(de),F=ve,oe(w,F)},getClearAlpha:function(){return F},setClearAlpha:function(de){F=de,oe(w,F)},render:function(de,ve){let Me=!1,Be=!0===ve.isScene?ve.background:null;Be&&Be.isTexture&&(Be=e.get(Be));const Ae=S.xr,ke=Ae.getSession&&Ae.getSession();ke&&"additive"===ke.environmentBlendMode&&(Be=null),null===Be?oe(w,F):Be&&Be.isColor&&(oe(Be,1),Me=!0),(S.autoClear||Me)&&S.clear(S.autoClearColor,S.autoClearDepth,S.autoClearStencil),Be&&(Be.isCubeTexture||Be.mapping===Oi)?(void 0===O&&(O=new ko(new Jl(1,1,1),new Rs({name:"BackgroundCubeMaterial",uniforms:go(Bl.cube.uniforms),vertexShader:Bl.cube.vertexShader,fragmentShader:Bl.cube.fragmentShader,side:W,depthTest:!1,depthWrite:!1,fog:!1})),O.geometry.deleteAttribute("normal"),O.geometry.deleteAttribute("uv"),O.onBeforeRender=function(Je,We,rt){this.matrixWorld.copyPosition(rt.matrixWorld)},Object.defineProperty(O.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),p.update(O)),O.material.uniforms.envMap.value=Be,O.material.uniforms.flipEnvMap.value=Be.isCubeTexture&&!1===Be.isRenderTargetTexture?-1:1,U===Be&&te===Be.version&&ce===S.toneMapping||(O.material.needsUpdate=!0,U=Be,te=Be.version,ce=S.toneMapping),de.unshift(O,O.geometry,O.material,0,0,null)):Be&&Be.isTexture&&(void 0===L&&(L=new ko(new xu(2,2),new Rs({name:"BackgroundMaterial",uniforms:go(Bl.background.uniforms),vertexShader:Bl.background.vertexShader,fragmentShader:Bl.background.fragmentShader,side:ie,depthTest:!1,depthWrite:!1,fog:!1})),L.geometry.deleteAttribute("normal"),Object.defineProperty(L.material,"map",{get:function(){return this.uniforms.t2D.value}}),p.update(L)),L.material.uniforms.t2D.value=Be,!0===Be.matrixAutoUpdate&&Be.updateMatrix(),L.material.uniforms.uvTransform.value.copy(Be.matrix),U===Be&&te===Be.version&&ce===S.toneMapping||(L.material.needsUpdate=!0,U=Be,te=Be.version,ce=S.toneMapping),de.unshift(L,L.geometry,L.material,0,0,null))}}}function Bo(S,e,c,p){const _=S.getParameter(34921),w=p.isWebGL2?null:e.get("OES_vertex_array_object"),L=p.isWebGL2||null!==w,O={},F=oe(null);let U=F;function te(We){return p.isWebGL2?S.bindVertexArray(We):w.bindVertexArrayOES(We)}function ce(We){return p.isWebGL2?S.deleteVertexArray(We):w.deleteVertexArrayOES(We)}function oe(We){const rt=[],nt=[],gt=[];for(let xt=0;xt<_;xt++)rt[xt]=0,nt[xt]=0,gt[xt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:rt,enabledAttributes:nt,attributeDivisors:gt,object:We,attributes:{},index:null}}function de(){const We=U.newAttributes;for(let rt=0,nt=We.length;rt<nt;rt++)We[rt]=0}function ve(We){Me(We,0)}function Me(We,rt){const gt=U.enabledAttributes,xt=U.attributeDivisors;U.newAttributes[We]=1,0===gt[We]&&(S.enableVertexAttribArray(We),gt[We]=1),xt[We]!==rt&&((p.isWebGL2?S:e.get("ANGLE_instanced_arrays"))[p.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](We,rt),xt[We]=rt)}function Be(){const We=U.newAttributes,rt=U.enabledAttributes;for(let nt=0,gt=rt.length;nt<gt;nt++)rt[nt]!==We[nt]&&(S.disableVertexAttribArray(nt),rt[nt]=0)}function Ae(We,rt,nt,gt,xt,Ut){!0!==p.isWebGL2||5124!==nt&&5125!==nt?S.vertexAttribPointer(We,rt,nt,gt,xt,Ut):S.vertexAttribIPointer(We,rt,nt,xt,Ut)}function ke(){Je(),U!==F&&(U=F,te(U.object))}function Je(){F.geometry=null,F.program=null,F.wireframe=!1}return{setup:function(We,rt,nt,gt,xt){let Ut=!1;if(L){const Ht=function(Ye,pt,Vt){const Rt=!0===Vt.wireframe;let lt=O[Ye.id];void 0===lt&&(lt={},O[Ye.id]=lt);let Jt=lt[pt.id];void 0===Jt&&(Jt={},lt[pt.id]=Jt);let St=Jt[Rt];return void 0===St&&(St=oe(p.isWebGL2?S.createVertexArray():w.createVertexArrayOES()),Jt[Rt]=St),St}(gt,nt,rt);U!==Ht&&(U=Ht,te(U.object)),Ut=function(Ye,pt){const Vt=U.attributes,Rt=Ye.attributes;let lt=0;for(const Jt in Rt){const St=Vt[Jt],jt=Rt[Jt];if(void 0===St||St.attribute!==jt||St.data!==jt.data)return!0;lt++}return U.attributesNum!==lt||U.index!==pt}(gt,xt),Ut&&function(Ye,pt){const Vt={},Rt=Ye.attributes;let lt=0;for(const Jt in Rt){const St=Rt[Jt],jt={};jt.attribute=St,St.data&&(jt.data=St.data),Vt[Jt]=jt,lt++}U.attributes=Vt,U.attributesNum=lt,U.index=pt}(gt,xt)}else{const Ht=!0===rt.wireframe;U.geometry===gt.id&&U.program===nt.id&&U.wireframe===Ht||(U.geometry=gt.id,U.program=nt.id,U.wireframe=Ht,Ut=!0)}!0===We.isInstancedMesh&&(Ut=!0),null!==xt&&c.update(xt,34963),Ut&&(function(Ht,Ye,pt,Vt){if(!1===p.isWebGL2&&(Ht.isInstancedMesh||Vt.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;de();const Rt=Vt.attributes,lt=pt.getAttributes(),Jt=Ye.defaultAttributeValues;for(const St in lt){const jt=lt[St];if(jt.location>=0){let It=Rt[St];if(void 0===It&&("instanceMatrix"===St&&Ht.instanceMatrix&&(It=Ht.instanceMatrix),"instanceColor"===St&&Ht.instanceColor&&(It=Ht.instanceColor)),void 0!==It){const ln=It.normalized,Ze=It.itemSize,st=c.get(It);if(void 0===st)continue;const Pt=st.buffer,Gt=st.type,tn=st.bytesPerElement;if(It.isInterleavedBufferAttribute){const Mn=It.data,Yn=Mn.stride,Vn=It.offset;if(Mn&&Mn.isInstancedInterleavedBuffer){for(let sn=0;sn<jt.locationSize;sn++)Me(jt.location+sn,Mn.meshPerAttribute);!0!==Ht.isInstancedMesh&&void 0===Vt._maxInstanceCount&&(Vt._maxInstanceCount=Mn.meshPerAttribute*Mn.count)}else for(let sn=0;sn<jt.locationSize;sn++)ve(jt.location+sn);S.bindBuffer(34962,Pt);for(let sn=0;sn<jt.locationSize;sn++)Ae(jt.location+sn,Ze/jt.locationSize,Gt,ln,Yn*tn,(Vn+Ze/jt.locationSize*sn)*tn)}else{if(It.isInstancedBufferAttribute){for(let Mn=0;Mn<jt.locationSize;Mn++)Me(jt.location+Mn,It.meshPerAttribute);!0!==Ht.isInstancedMesh&&void 0===Vt._maxInstanceCount&&(Vt._maxInstanceCount=It.meshPerAttribute*It.count)}else for(let Mn=0;Mn<jt.locationSize;Mn++)ve(jt.location+Mn);S.bindBuffer(34962,Pt);for(let Mn=0;Mn<jt.locationSize;Mn++)Ae(jt.location+Mn,Ze/jt.locationSize,Gt,ln,Ze*tn,Ze/jt.locationSize*Mn*tn)}}else if(void 0!==Jt){const ln=Jt[St];if(void 0!==ln)switch(ln.length){case 2:S.vertexAttrib2fv(jt.location,ln);break;case 3:S.vertexAttrib3fv(jt.location,ln);break;case 4:S.vertexAttrib4fv(jt.location,ln);break;default:S.vertexAttrib1fv(jt.location,ln)}}}}Be()}(We,rt,nt,gt),null!==xt&&S.bindBuffer(34963,c.get(xt).buffer))},reset:ke,resetDefaultState:Je,dispose:function(){ke();for(const We in O){const rt=O[We];for(const nt in rt){const gt=rt[nt];for(const xt in gt)ce(gt[xt].object),delete gt[xt];delete rt[nt]}delete O[We]}},releaseStatesOfGeometry:function(We){if(void 0===O[We.id])return;const rt=O[We.id];for(const nt in rt){const gt=rt[nt];for(const xt in gt)ce(gt[xt].object),delete gt[xt];delete rt[nt]}delete O[We.id]},releaseStatesOfProgram:function(We){for(const rt in O){const nt=O[rt];if(void 0===nt[We.id])continue;const gt=nt[We.id];for(const xt in gt)ce(gt[xt].object),delete gt[xt];delete nt[We.id]}},initAttributes:de,enableAttribute:ve,disableUnusedAttributes:Be}}function Wn(S,e,c,p){const _=p.isWebGL2;let w;this.setMode=function(L){w=L},this.render=function(L,O){S.drawArrays(w,L,O),c.update(O,w,1)},this.renderInstances=function(L,O,F){if(0===F)return;let U,te;if(_)U=S,te="drawArraysInstanced";else if(U=e.get("ANGLE_instanced_arrays"),te="drawArraysInstancedANGLE",null===U)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");U[te](w,L,O,F),c.update(O,w,F)}}function Zc(S,e,c){let p;function _(We){if("highp"===We){if(S.getShaderPrecisionFormat(35633,36338).precision>0&&S.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";We="mediump"}return"mediump"===We&&S.getShaderPrecisionFormat(35633,36337).precision>0&&S.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const w=typeof WebGL2RenderingContext<"u"&&S instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&S instanceof WebGL2ComputeRenderingContext;let L=void 0!==c.precision?c.precision:"highp";const O=_(L);O!==L&&(console.warn("THREE.WebGLRenderer:",L,"not supported, using",O,"instead."),L=O);const F=w||e.has("WEBGL_draw_buffers"),U=!0===c.logarithmicDepthBuffer,te=S.getParameter(34930),ce=S.getParameter(35660),oe=S.getParameter(3379),de=S.getParameter(34076),ve=S.getParameter(34921),Me=S.getParameter(36347),Be=S.getParameter(36348),Ae=S.getParameter(36349),ke=ce>0,Je=w||e.has("OES_texture_float");return{isWebGL2:w,drawBuffers:F,getMaxAnisotropy:function(){if(void 0!==p)return p;if(!0===e.has("EXT_texture_filter_anisotropic")){const We=e.get("EXT_texture_filter_anisotropic");p=S.getParameter(We.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else p=0;return p},getMaxPrecision:_,precision:L,logarithmicDepthBuffer:U,maxTextures:te,maxVertexTextures:ce,maxTextureSize:oe,maxCubemapSize:de,maxAttributes:ve,maxVertexUniforms:Me,maxVaryings:Be,maxFragmentUniforms:Ae,vertexTextures:ke,floatFragmentTextures:Je,floatVertexTextures:ke&&Je,maxSamples:w?S.getParameter(36183):0}}function wu(S){const e=this;let c=null,p=0,_=!1,w=!1;const L=new Ta,O=new ot,F={value:null,needsUpdate:!1};function U(){F.value!==c&&(F.value=c,F.needsUpdate=p>0),e.numPlanes=p,e.numIntersection=0}function te(ce,oe,de,ve){const Me=null!==ce?ce.length:0;let Be=null;if(0!==Me){if(Be=F.value,!0!==ve||null===Be){const Ae=de+4*Me,ke=oe.matrixWorldInverse;O.getNormalMatrix(ke),(null===Be||Be.length<Ae)&&(Be=new Float32Array(Ae));for(let Je=0,We=de;Je!==Me;++Je,We+=4)L.copy(ce[Je]).applyMatrix4(ke,O),L.normal.toArray(Be,We),Be[We+3]=L.constant}F.value=Be,F.needsUpdate=!0}return e.numPlanes=Me,e.numIntersection=0,Be}this.uniform=F,this.numPlanes=0,this.numIntersection=0,this.init=function(ce,oe,de){const ve=0!==ce.length||oe||0!==p||_;return _=oe,c=te(ce,de,0),p=ce.length,ve},this.beginShadows=function(){w=!0,te(null)},this.endShadows=function(){w=!1,U()},this.setState=function(ce,oe,de){const ve=ce.clippingPlanes,Me=ce.clipIntersection,Be=ce.clipShadows,Ae=S.get(ce);if(!_||null===ve||0===ve.length||w&&!Be)w?te(null):U();else{const ke=w?0:p,Je=4*ke;let We=Ae.clippingState||null;F.value=We,We=te(ve,oe,Je,de);for(let rt=0;rt!==Je;++rt)We[rt]=c[rt];Ae.clippingState=We,this.numIntersection=Me?this.numPlanes:0,this.numPlanes+=ke}}}function hl(S){let e=new WeakMap;function c(_,w){return w===Hs?_.mapping=Ti:w===ia&&(_.mapping=$o),_}function p(_){const w=_.target;w.removeEventListener("dispose",p);const L=e.get(w);void 0!==L&&(e.delete(w),L.dispose())}return{get:function(_){if(_&&_.isTexture&&!1===_.isRenderTargetTexture){const w=_.mapping;if(w===Hs||w===ia){if(e.has(_))return c(e.get(_).texture,_.mapping);{const L=_.image;if(L&&L.height>0){const O=S.getRenderTarget(),F=new Mc(L.height/2);return F.fromEquirectangularTexture(S,_),e.set(_,F),S.setRenderTarget(O),_.addEventListener("dispose",p),c(F.texture,_.mapping)}return null}}}return _},dispose:function(){e=new WeakMap}}}Bl.physical={uniforms:Ai([Bl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Un(1,1)},clearcoatNormalMap:{value:null},sheenTint:{value:new Qn(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Un},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new Qn(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new Qn(1,1,1)},specularTintMap:{value:null}}]),vertexShader:ui.meshphysical_vert,fragmentShader:ui.meshphysical_frag};class Ql extends $l{constructor(e=-1,c=1,p=1,_=-1,w=.1,L=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=c,this.top=p,this.bottom=_,this.near=w,this.far=L,this.updateProjectionMatrix()}copy(e,c){return super.copy(e,c),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,c,p,_,w,L){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=c,this.view.offsetX=p,this.view.offsetY=_,this.view.width=w,this.view.height=L,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),p=(this.right+this.left)/2,_=(this.top+this.bottom)/2;let w=p-e,L=p+e,O=_+c,F=_-c;if(null!==this.view&&this.view.enabled){const U=(this.right-this.left)/this.view.fullWidth/this.zoom,te=(this.top-this.bottom)/this.view.fullHeight/this.zoom;w+=U*this.view.offsetX,L=w+U*this.view.width,O-=te*this.view.offsetY,F=O-te*this.view.height}this.projectionMatrix.makeOrthographic(w,L,O,F,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const c=super.toJSON(e);return c.object.zoom=this.zoom,c.object.left=this.left,c.object.right=this.right,c.object.top=this.top,c.object.bottom=this.bottom,c.object.near=this.near,c.object.far=this.far,null!==this.view&&(c.object.view=Object.assign({},this.view)),c}}Ql.prototype.isOrthographicCamera=!0;class Su extends Rs{constructor(e){super(e),this.type="RawShaderMaterial"}}Su.prototype.isRawShaderMaterial=!0;const as=Math.pow(2,8),Va=[.125,.215,.35,.446,.526,.582],Eu=5+Va.length,Ma={[Ki]:0,[rl]:1,[Hc]:2,[mc]:3,[qu]:4,[mu]:5,[ql]:6},Xp=new Ql,{_lodPlanes:Lp,_sizeLods:Qh,_sigmas:Qc}=function xe(){const S=[],e=[],c=[];let p=8;for(let _=0;_<Eu;_++){const w=Math.pow(2,p);e.push(w);let L=1/w;_>4?L=Va[_-8+4-1]:0==_&&(L=0),c.push(L);const O=1/(w-1),F=-O/2,U=1+O/2,te=[F,F,U,F,U,U,F,F,U,U,F,U],ce=6,oe=6,de=3,ve=2,Me=1,Be=new Float32Array(de*oe*ce),Ae=new Float32Array(ve*oe*ce),ke=new Float32Array(Me*oe*ce);for(let We=0;We<ce;We++){const rt=We%3*2/3-1,nt=We>2?0:-1;Be.set([rt,nt,0,rt+2/3,nt,0,rt+2/3,nt+1,0,rt,nt,0,rt+2/3,nt+1,0,rt,nt+1,0],de*oe*We),Ae.set(te,ve*oe*We),ke.set([We,We,We,We,We,We],Me*oe*We)}const Je=new gr;Je.setAttribute("position",new Fi(Be,de)),Je.setAttribute("uv",new Fi(Ae,ve)),Je.setAttribute("faceIndex",new Fi(ke,Me)),S.push(Je),p>4&&p--}return{_lodPlanes:S,_sizeLods:e,_sigmas:c}}(),eh=new Qn;let Aa=null;const io=(1+Math.sqrt(5))/2,ts=1/io,Ie=[new at(1,1,1),new at(-1,1,1),new at(1,1,-1),new at(-1,1,-1),new at(0,io,ts),new at(0,io,-ts),new at(ts,0,io),new at(-ts,0,io),new at(io,ts,0),new at(-io,ts,0)];class Ue{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(){const c=new Float32Array(20),p=new at(0,1,0);return new Su({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:c},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:p},inputEncoding:{value:Ma[Ki]},outputEncoding:{value:Ma[Ki]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}(),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,c=0,p=.1,_=100){Aa=this._renderer.getRenderTarget();const w=this._allocateTargets();return this._sceneToCubeUV(e,p,_,w),c>0&&this._blur(w,0,0,c),this._applyPMREM(w),this._cleanup(w),w}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=Nt(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=yt(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<Lp.length;e++)Lp[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Aa),e.scissorTest=!1,Xe(e,0,0,e.width,e.height)}_fromTexture(e){Aa=this._renderer.getRenderTarget();const c=this._allocateTargets(e);return this._textureToCubeUV(e,c),this._applyPMREM(c),this._cleanup(c),c}_allocateTargets(e){const c={magFilter:Or,minFilter:Or,generateMipmaps:!1,type:oa,format:ph,encoding:(S=e,void 0===S||S.type!==oa||S.encoding!==Ki&&S.encoding!==rl&&S.encoding!==ql?Hc:e.encoding),depthBuffer:!1},p=ze(c);var S;return p.depthBuffer=!e,this._pingPongRenderTarget=ze(c),p}_compileMaterial(e){const c=new ko(Lp[0],e);this._renderer.compile(c,Xp)}_sceneToCubeUV(e,c,p,_){const w=new Fo(90,1,c,p),L=[1,-1,1,1,1,1],O=[1,1,1,-1,-1,-1],F=this._renderer,U=F.autoClear,te=F.outputEncoding,ce=F.toneMapping;F.getClearColor(eh),F.toneMapping=mr,F.outputEncoding=Ki,F.autoClear=!1;const oe=new sl({name:"PMREM.Background",side:W,depthWrite:!1,depthTest:!1}),de=new ko(new Jl,oe);let ve=!1;const Me=e.background;Me?Me.isColor&&(oe.color.copy(Me),e.background=null,ve=!0):(oe.color.copy(eh),ve=!0);for(let Be=0;Be<6;Be++){const Ae=Be%3;0==Ae?(w.up.set(0,L[Be],0),w.lookAt(O[Be],0,0)):1==Ae?(w.up.set(0,0,L[Be]),w.lookAt(0,O[Be],0)):(w.up.set(0,L[Be],0),w.lookAt(0,0,O[Be])),Xe(_,Ae*as,Be>2?as:0,as,as),F.setRenderTarget(_),ve&&F.render(de,w),F.render(e,w)}de.geometry.dispose(),de.material.dispose(),F.toneMapping=ce,F.outputEncoding=te,F.autoClear=U,e.background=Me}_textureToCubeUV(e,c){const p=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=Nt()):null==this._equirectShader&&(this._equirectShader=yt());const _=e.isCubeTexture?this._cubemapShader:this._equirectShader,w=new ko(Lp[0],_),L=_.uniforms;L.envMap.value=e,e.isCubeTexture||L.texelSize.value.set(1/e.image.width,1/e.image.height),L.inputEncoding.value=Ma[e.encoding],L.outputEncoding.value=Ma[c.texture.encoding],Xe(c,0,0,3*as,2*as),p.setRenderTarget(c),p.render(w,Xp)}_applyPMREM(e){const c=this._renderer,p=c.autoClear;c.autoClear=!1;for(let _=1;_<Eu;_++){const w=Math.sqrt(Qc[_]*Qc[_]-Qc[_-1]*Qc[_-1]);this._blur(e,_-1,_,w,Ie[(_-1)%Ie.length])}c.autoClear=p}_blur(e,c,p,_,w){const L=this._pingPongRenderTarget;this._halfBlur(e,L,c,p,_,"latitudinal",w),this._halfBlur(L,e,p,p,_,"longitudinal",w)}_halfBlur(e,c,p,_,w,L,O){const F=this._renderer,U=this._blurMaterial;"latitudinal"!==L&&"longitudinal"!==L&&console.error("blur direction must be either latitudinal or longitudinal!");const te=new ko(Lp[_],U),ce=U.uniforms,oe=Qh[p]-1,de=isFinite(w)?Math.PI/(2*oe):2*Math.PI/39,ve=w/de,Me=isFinite(w)?1+Math.floor(3*ve):20;Me>20&&console.warn(`sigmaRadians, ${w}, is too large and will clip, as it requested ${Me} samples when the maximum is set to 20`);const Be=[];let Ae=0;for(let Je=0;Je<20;++Je){const We=Je/ve,rt=Math.exp(-We*We/2);Be.push(rt),0==Je?Ae+=rt:Je<Me&&(Ae+=2*rt)}for(let Je=0;Je<Be.length;Je++)Be[Je]=Be[Je]/Ae;ce.envMap.value=e.texture,ce.samples.value=Me,ce.weights.value=Be,ce.latitudinal.value="latitudinal"===L,O&&(ce.poleAxis.value=O),ce.dTheta.value=de,ce.mipInt.value=8-p,ce.inputEncoding.value=Ma[e.texture.encoding],ce.outputEncoding.value=Ma[e.texture.encoding];const ke=Qh[_];Xe(c,3*Math.max(0,as-2*ke),(0===_?0:2*as)+2*ke*(_>4?_-8+4:0),3*ke,2*ke),F.setRenderTarget(c),F.render(te,Xp)}}function ze(S){const e=new lo(3*as,3*as,S);return e.texture.mapping=Oi,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Xe(S,e,c,p,_){S.viewport.set(e,c,p,_),S.scissor.set(e,c,p,_)}function yt(){const S=new Un(1,1);return new Su({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:S},inputEncoding:{value:Ma[Ki]},outputEncoding:{value:Ma[Ki]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function Nt(){return new Su({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Ma[Ki]},outputEncoding:{value:Ma[Ki]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function qt(S){let e=new WeakMap,c=null;function p(_){const w=_.target;w.removeEventListener("dispose",p);const L=e.get(w);void 0!==L&&(e.delete(w),L.dispose())}return{get:function(_){if(_&&_.isTexture&&!1===_.isRenderTargetTexture){const w=_.mapping,L=w===Hs||w===ia,O=w===Ti||w===$o;if(L||O){if(e.has(_))return e.get(_).texture;{const F=_.image;if(L&&F&&F.height>0||O&&F&&function(U){let te=0;for(let ce=0;ce<6;ce++)void 0!==U[ce]&&te++;return 6===te}(F)){const U=S.getRenderTarget();null===c&&(c=new Ue(S));const te=L?c.fromEquirectangular(_):c.fromCubemap(_);return e.set(_,te),S.setRenderTarget(U),_.addEventListener("dispose",p),te.texture}return null}}}return _},dispose:function(){e=new WeakMap,null!==c&&(c.dispose(),c=null)}}}function Pn(S){const e={};function c(p){if(void 0!==e[p])return e[p];let _;switch(p){case"WEBGL_depth_texture":_=S.getExtension("WEBGL_depth_texture")||S.getExtension("MOZ_WEBGL_depth_texture")||S.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":_=S.getExtension("EXT_texture_filter_anisotropic")||S.getExtension("MOZ_EXT_texture_filter_anisotropic")||S.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":_=S.getExtension("WEBGL_compressed_texture_s3tc")||S.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":_=S.getExtension("WEBGL_compressed_texture_pvrtc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:_=S.getExtension(p)}return e[p]=_,_}return{has:function(p){return null!==c(p)},init:function(p){p.isWebGL2?c("EXT_color_buffer_float"):(c("WEBGL_depth_texture"),c("OES_texture_float"),c("OES_texture_half_float"),c("OES_texture_half_float_linear"),c("OES_standard_derivatives"),c("OES_element_index_uint"),c("OES_vertex_array_object"),c("ANGLE_instanced_arrays")),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float")},get:function(p){const _=c(p);return null===_&&console.warn("THREE.WebGLRenderer: "+p+" extension not supported."),_}}}function En(S,e,c,p){const _={},w=new WeakMap;function L(F){const U=F.target;null!==U.index&&e.remove(U.index);for(const ce in U.attributes)e.remove(U.attributes[ce]);U.removeEventListener("dispose",L),delete _[U.id];const te=w.get(U);te&&(e.remove(te),w.delete(U)),p.releaseStatesOfGeometry(U),!0===U.isInstancedBufferGeometry&&delete U._maxInstanceCount,c.memory.geometries--}function O(F){const U=[],te=F.index,ce=F.attributes.position;let oe=0;if(null!==te){const Me=te.array;oe=te.version;for(let Be=0,Ae=Me.length;Be<Ae;Be+=3){const ke=Me[Be+0],Je=Me[Be+1],We=Me[Be+2];U.push(ke,Je,Je,We,We,ke)}}else{oe=ce.version;for(let Be=0,Ae=ce.array.length/3-1;Be<Ae;Be+=3){const ke=Be+0,Je=Be+1,We=Be+2;U.push(ke,Je,Je,We,We,ke)}}const de=new(ci(U)>65535?li:Zu)(U,1);de.version=oe;const ve=w.get(F);ve&&e.remove(ve),w.set(F,de)}return{get:function(F,U){return!0===_[U.id]||(U.addEventListener("dispose",L),_[U.id]=!0,c.memory.geometries++),U},update:function(F){const U=F.attributes;for(const ce in U)e.update(U[ce],34962);const te=F.morphAttributes;for(const ce in te){const oe=te[ce];for(let de=0,ve=oe.length;de<ve;de++)e.update(oe[de],34962)}},getWireframeAttribute:function(F){const U=w.get(F);if(U){const te=F.index;null!==te&&U.version<te.version&&O(F)}else O(F);return w.get(F)}}}function Gn(S,e,c,p){const _=p.isWebGL2;let w,L,O;this.setMode=function(F){w=F},this.setIndex=function(F){L=F.type,O=F.bytesPerElement},this.render=function(F,U){S.drawElements(w,U,L,F*O),c.update(U,w,1)},this.renderInstances=function(F,U,te){if(0===te)return;let ce,oe;if(_)ce=S,oe="drawElementsInstanced";else if(ce=e.get("ANGLE_instanced_arrays"),oe="drawElementsInstancedANGLE",null===ce)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");ce[oe](w,U,L,F*O,te),c.update(U,w,te)}}function Ar(S){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(c,p,_){switch(e.calls++,p){case 4:e.triangles+=_*(c/3);break;case 1:e.lines+=_*(c/2);break;case 3:e.lines+=_*(c-1);break;case 2:e.lines+=_*c;break;case 0:e.points+=_*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",p)}}}}function Ur(S,e){return S[0]-e[0]}function $r(S,e){return Math.abs(e[1])-Math.abs(S[1])}function Zt(S){const e={},c=new Float32Array(8),p=[];for(let _=0;_<8;_++)p[_]=[_,0];return{update:function(_,w,L,O){const F=_.morphTargetInfluences,U=void 0===F?0:F.length;let te=e[w.id];if(void 0===te||te.length!==U){te=[];for(let Me=0;Me<U;Me++)te[Me]=[Me,0];e[w.id]=te}for(let Me=0;Me<U;Me++){const Be=te[Me];Be[0]=Me,Be[1]=F[Me]}te.sort($r);for(let Me=0;Me<8;Me++)Me<U&&te[Me][1]?(p[Me][0]=te[Me][0],p[Me][1]=te[Me][1]):(p[Me][0]=Number.MAX_SAFE_INTEGER,p[Me][1]=0);p.sort(Ur);const ce=w.morphAttributes.position,oe=w.morphAttributes.normal;let de=0;for(let Me=0;Me<8;Me++){const Be=p[Me],Ae=Be[0],ke=Be[1];Ae!==Number.MAX_SAFE_INTEGER&&ke?(ce&&w.getAttribute("morphTarget"+Me)!==ce[Ae]&&w.setAttribute("morphTarget"+Me,ce[Ae]),oe&&w.getAttribute("morphNormal"+Me)!==oe[Ae]&&w.setAttribute("morphNormal"+Me,oe[Ae]),c[Me]=ke,de+=ke):(ce&&!0===w.hasAttribute("morphTarget"+Me)&&w.deleteAttribute("morphTarget"+Me),oe&&!0===w.hasAttribute("morphNormal"+Me)&&w.deleteAttribute("morphNormal"+Me),c[Me]=0)}const ve=w.morphTargetsRelative?1:1-de;O.getUniforms().setValue(S,"morphTargetBaseInfluence",ve),O.getUniforms().setValue(S,"morphTargetInfluences",c)}}}function No(S,e,c,p){let _=new WeakMap;function w(L){const O=L.target;O.removeEventListener("dispose",w),c.remove(O.instanceMatrix),null!==O.instanceColor&&c.remove(O.instanceColor)}return{update:function(L){const O=p.render.frame,U=e.get(L,L.geometry);return _.get(U)!==O&&(e.update(U),_.set(U,O)),L.isInstancedMesh&&(!1===L.hasEventListener("dispose",w)&&L.addEventListener("dispose",w),c.update(L.instanceMatrix,34962),null!==L.instanceColor&&c.update(L.instanceColor,34962)),U},dispose:function(){_=new WeakMap}}}class pl extends As{constructor(e=null,c=1,p=1,_=1){super(null),this.image={data:e,width:c,height:p,depth:_},this.magFilter=Or,this.minFilter=Or,this.wrapR=Yr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}pl.prototype.isDataTexture2DArray=!0;class da extends As{constructor(e=null,c=1,p=1,_=1){super(null),this.image={data:e,width:c,height:p,depth:_},this.magFilter=Or,this.minFilter=Or,this.wrapR=Yr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}da.prototype.isDataTexture3D=!0;const Kr=new As,Ln=new pl,sf=new da,Xf=new Zl,dr=[],af=[],lf=new Float32Array(16),Sf=new Float32Array(9),Tu=new Float32Array(4);function Yp(S,e,c){const p=S[0];if(p<=0||p>0)return S;const _=e*c;let w=dr[_];if(void 0===w&&(w=new Float32Array(_),dr[_]=w),0!==e){p.toArray(w,0);for(let L=1,O=0;L!==e;++L)O+=c,S[L].toArray(w,O)}return w}function co(S,e){if(S.length!==e.length)return!1;for(let c=0,p=S.length;c<p;c++)if(S[c]!==e[c])return!1;return!0}function ls(S,e){for(let c=0,p=e.length;c<p;c++)S[c]=e[c]}function th(S,e){let c=af[e];void 0===c&&(c=new Int32Array(e),af[e]=c);for(let p=0;p!==e;++p)c[p]=S.allocateTextureUnit();return c}function Ef(S,e){const c=this.cache;c[0]!==e&&(S.uniform1f(this.addr,e),c[0]=e)}function Tf(S,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y||(S.uniform2f(this.addr,e.x,e.y),c[0]=e.x,c[1]=e.y);else{if(co(c,e))return;S.uniform2fv(this.addr,e),ls(c,e)}}function Yf(S,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y&&c[2]===e.z||(S.uniform3f(this.addr,e.x,e.y,e.z),c[0]=e.x,c[1]=e.y,c[2]=e.z);else if(void 0!==e.r)c[0]===e.r&&c[1]===e.g&&c[2]===e.b||(S.uniform3f(this.addr,e.r,e.g,e.b),c[0]=e.r,c[1]=e.g,c[2]=e.b);else{if(co(c,e))return;S.uniform3fv(this.addr,e),ls(c,e)}}function Jf(S,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y&&c[2]===e.z&&c[3]===e.w||(S.uniform4f(this.addr,e.x,e.y,e.z,e.w),c[0]=e.x,c[1]=e.y,c[2]=e.z,c[3]=e.w);else{if(co(c,e))return;S.uniform4fv(this.addr,e),ls(c,e)}}function Mf(S,e){const c=this.cache,p=e.elements;if(void 0===p){if(co(c,e))return;S.uniformMatrix2fv(this.addr,!1,e),ls(c,e)}else{if(co(c,p))return;Tu.set(p),S.uniformMatrix2fv(this.addr,!1,Tu),ls(c,p)}}function Zf(S,e){const c=this.cache,p=e.elements;if(void 0===p){if(co(c,e))return;S.uniformMatrix3fv(this.addr,!1,e),ls(c,e)}else{if(co(c,p))return;Sf.set(p),S.uniformMatrix3fv(this.addr,!1,Sf),ls(c,p)}}function Am(S,e){const c=this.cache,p=e.elements;if(void 0===p){if(co(c,e))return;S.uniformMatrix4fv(this.addr,!1,e),ls(c,e)}else{if(co(c,p))return;lf.set(p),S.uniformMatrix4fv(this.addr,!1,lf),ls(c,p)}}function Bp(S,e){const c=this.cache;c[0]!==e&&(S.uniform1i(this.addr,e),c[0]=e)}function Qf(S,e){const c=this.cache;co(c,e)||(S.uniform2iv(this.addr,e),ls(c,e))}function $m(S,e){const c=this.cache;co(c,e)||(S.uniform3iv(this.addr,e),ls(c,e))}function Kf(S,e){const c=this.cache;co(c,e)||(S.uniform4iv(this.addr,e),ls(c,e))}function em(S,e){const c=this.cache;c[0]!==e&&(S.uniform1ui(this.addr,e),c[0]=e)}function Ud(S,e){const c=this.cache;co(c,e)||(S.uniform2uiv(this.addr,e),ls(c,e))}function Cm(S,e){const c=this.cache;co(c,e)||(S.uniform3uiv(this.addr,e),ls(c,e))}function Lm(S,e){const c=this.cache;co(c,e)||(S.uniform4uiv(this.addr,e),ls(c,e))}function zd(S,e,c){const p=this.cache,_=c.allocateTextureUnit();p[0]!==_&&(S.uniform1i(this.addr,_),p[0]=_),c.safeSetTexture2D(e||Kr,_)}function yd(S,e,c){const p=this.cache,_=c.allocateTextureUnit();p[0]!==_&&(S.uniform1i(this.addr,_),p[0]=_),c.setTexture3D(e||sf,_)}function tm(S,e,c){const p=this.cache,_=c.allocateTextureUnit();p[0]!==_&&(S.uniform1i(this.addr,_),p[0]=_),c.safeSetTextureCube(e||Xf,_)}function jd(S,e,c){const p=this.cache,_=c.allocateTextureUnit();p[0]!==_&&(S.uniform1i(this.addr,_),p[0]=_),c.setTexture2DArray(e||Ln,_)}function Kh(S,e){S.uniform1fv(this.addr,e)}function Bm(S,e){const c=Yp(e,this.size,2);S.uniform2fv(this.addr,c)}function Nm(S,e){const c=Yp(e,this.size,3);S.uniform3fv(this.addr,c)}function Rm(S,e){const c=Yp(e,this.size,4);S.uniform4fv(this.addr,c)}function nm(S,e){const c=Yp(e,this.size,4);S.uniformMatrix2fv(this.addr,!1,c)}function Pm(S,e){const c=Yp(e,this.size,9);S.uniformMatrix3fv(this.addr,!1,c)}function Gd(S,e){const c=Yp(e,this.size,16);S.uniformMatrix4fv(this.addr,!1,c)}function rm(S,e){S.uniform1iv(this.addr,e)}function Im(S,e){S.uniform2iv(this.addr,e)}function $c(S,e){S.uniform3iv(this.addr,e)}function Af(S,e){S.uniform4iv(this.addr,e)}function im(S,e){S.uniform1uiv(this.addr,e)}function om(S,e){S.uniform2uiv(this.addr,e)}function cf(S,e){S.uniform3uiv(this.addr,e)}function Om(S,e){S.uniform4uiv(this.addr,e)}function sm(S,e,c){const p=e.length,_=th(c,p);S.uniform1iv(this.addr,_);for(let w=0;w!==p;++w)c.safeSetTexture2D(e[w]||Kr,_[w])}function km(S,e,c){const p=e.length,_=th(c,p);S.uniform1iv(this.addr,_);for(let w=0;w!==p;++w)c.safeSetTextureCube(e[w]||Xf,_[w])}function $f(S,e,c){this.id=S,this.addr=c,this.cache=[],this.setValue=function(p){switch(p){case 5126:return Ef;case 35664:return Tf;case 35665:return Yf;case 35666:return Jf;case 35674:return Mf;case 35675:return Zf;case 35676:return Am;case 5124:case 35670:return Bp;case 35667:case 35671:return Qf;case 35668:case 35672:return $m;case 35669:case 35673:return Kf;case 5125:return em;case 36294:return Ud;case 36295:return Cm;case 36296:return Lm;case 35678:case 36198:case 36298:case 36306:case 35682:return zd;case 35679:case 36299:case 36307:return yd;case 35680:case 36300:case 36308:case 36293:return tm;case 36289:case 36303:case 36311:case 36292:return jd}}(e.type)}function am(S,e,c){this.id=S,this.addr=c,this.cache=[],this.size=e.size,this.setValue=function(p){switch(p){case 5126:return Kh;case 35664:return Bm;case 35665:return Nm;case 35666:return Rm;case 35674:return nm;case 35675:return Pm;case 35676:return Gd;case 5124:case 35670:return rm;case 35667:case 35671:return Im;case 35668:case 35672:return $c;case 35669:case 35673:return Af;case 5125:return im;case 36294:return om;case 36295:return cf;case 36296:return Om;case 35678:case 36198:case 36298:case 36306:case 35682:return sm;case 35680:case 36300:case 36308:case 36293:return km}}(e.type)}function Hd(S){this.id=S,this.seq=[],this.map={}}am.prototype.updateCache=function(S){const e=this.cache;S instanceof Float32Array&&e.length!==S.length&&(this.cache=new Float32Array(S.length)),ls(e,S)},Hd.prototype.setValue=function(S,e,c){const p=this.seq;for(let _=0,w=p.length;_!==w;++_){const L=p[_];L.setValue(S,e[L.id],c)}};const bd=/(\w+)(\])?(\[|\.)?/g;function ep(S,e){S.seq.push(e),S.map[e.id]=e}function $a(S,e,c){const p=S.name,_=p.length;for(bd.lastIndex=0;;){const w=bd.exec(p);let O=w[1];const U=w[3];if("]"===w[2]&&(O|=0),void 0===U||"["===U&&bd.lastIndex+2===_){ep(c,void 0===U?new $f(O,S,e):new am(O,S,e));break}{let te=c.map[O];void 0===te&&(te=new Hd(O),ep(c,te)),c=te}}}function Nl(S,e){this.seq=[],this.map={};const c=S.getProgramParameter(e,35718);for(let p=0;p<c;++p){const _=S.getActiveUniform(e,p);$a(_,S.getUniformLocation(e,_.name),this)}}function Kl(S,e,c){const p=S.createShader(e);return S.shaderSource(p,c),S.compileShader(p),p}Nl.prototype.setValue=function(S,e,c,p){const _=this.map[e];void 0!==_&&_.setValue(S,c,p)},Nl.prototype.setOptional=function(S,e,c){const p=e[c];void 0!==p&&this.setValue(S,c,p)},Nl.upload=function(S,e,c,p){for(let _=0,w=e.length;_!==w;++_){const L=e[_],O=c[L.id];!1!==O.needsUpdate&&L.setValue(S,O.value,p)}},Nl.seqWithValue=function(S,e){const c=[];for(let p=0,_=S.length;p!==_;++p){const w=S[p];w.id in e&&c.push(w)}return c};let Np=0;function ec(S){switch(S){case Ki:return["Linear","( value )"];case rl:return["sRGB","( value )"];case Hc:return["RGBE","( value )"];case mc:return["RGBM","( value, 7.0 )"];case qu:return["RGBM","( value, 16.0 )"];case mu:return["RGBD","( value, 256.0 )"];case ql:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Gh:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",S),["Linear","( value )"]}}function Jp(S,e,c){const p=S.getShaderParameter(e,35713),_=S.getShaderInfoLog(e).trim();return p&&""===_?"":c.toUpperCase()+"\n\n"+_+"\n\n"+function(w){const L=w.split("\n");for(let O=0;O<L.length;O++)L[O]=O+1+": "+L[O];return L.join("\n")}(S.getShaderSource(e))}function tp(S,e){const c=ec(e);return"vec4 "+S+"( vec4 value ) { return "+c[0]+"ToLinear"+c[1]+"; }"}function Vd(S,e){const c=ec(e);return"vec4 "+S+"( vec4 value ) { return LinearTo"+c[0]+c[1]+"; }"}function tc(S,e){let c;switch(e){case mi:c="Linear";break;case xo:c="Reinhard";break;case Nr:c="OptimizedCineon";break;case Qr:c="ACESFilmic";break;case Vr:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),c="Linear"}return"vec3 "+S+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function Mu(S){return""!==S}function Wd(S,e){return S.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function lm(S,e){return S.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const qd=/^[ \t]*#include +<([\w\d./]+)>/gm;function Xd(S){return S.replace(qd,uf)}function uf(S,e){const c=ui[e];if(void 0===c)throw new Error("Can not resolve #include <"+e+">");return Xd(c)}const Yd=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ca=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Kc(S){return S.replace(Ca,_i).replace(Yd,wh)}function wh(S,e,c,p){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),_i(0,e,c,p)}function _i(S,e,c,p){let _="";for(let w=parseInt(e);w<parseInt(c);w++)_+=p.replace(/\[\s*i\s*\]/g,"[ "+w+" ]").replace(/UNROLLED_LOOP_INDEX/g,w);return _}function Zp(S){let e="precision "+S.precision+" float;\nprecision "+S.precision+" int;";return"highp"===S.precision?e+="\n#define HIGH_PRECISION":"mediump"===S.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===S.precision&&(e+="\n#define LOW_PRECISION"),e}function Jd(S,e,c,p){const _=S.getContext(),w=c.defines;let L=c.vertexShader,O=c.fragmentShader;const F=function(xt){let Ut="SHADOWMAP_TYPE_BASIC";return xt.shadowMapType===ne?Ut="SHADOWMAP_TYPE_PCF":xt.shadowMapType===ue?Ut="SHADOWMAP_TYPE_PCF_SOFT":xt.shadowMapType===me&&(Ut="SHADOWMAP_TYPE_VSM"),Ut}(c),U=function(xt){let Ut="ENVMAP_TYPE_CUBE";if(xt.envMap)switch(xt.envMapMode){case Ti:case $o:Ut="ENVMAP_TYPE_CUBE";break;case Oi:case Co:Ut="ENVMAP_TYPE_CUBE_UV"}return Ut}(c),te=function(xt){let Ut="ENVMAP_MODE_REFLECTION";if(xt.envMap)switch(xt.envMapMode){case $o:case Co:Ut="ENVMAP_MODE_REFRACTION"}return Ut}(c),ce=function(xt){let Ut="ENVMAP_BLENDING_NONE";if(xt.envMap)switch(xt.combine){case Zr:Ut="ENVMAP_BLENDING_MULTIPLY";break;case pi:Ut="ENVMAP_BLENDING_MIX";break;case tr:Ut="ENVMAP_BLENDING_ADD"}return Ut}(c),oe=S.gammaFactor>0?S.gammaFactor:1,de=c.isWebGL2?"":[(xt=c).extensionDerivatives||xt.envMapCubeUV||xt.bumpMap||xt.tangentSpaceNormalMap||xt.clearcoatNormalMap||xt.flatShading||"physical"===xt.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(xt.extensionFragDepth||xt.logarithmicDepthBuffer)&&xt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",xt.extensionDrawBuffers&&xt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(xt.extensionShaderTextureLOD||xt.envMap||xt.transmission)&&xt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Mu).join("\n"),ve=function(xt){const Ut=[];for(const Ht in xt){const Ye=xt[Ht];!1!==Ye&&Ut.push("#define "+Ht+" "+Ye)}return Ut.join("\n")}(w),Me=_.createProgram();var xt;let Be,Ae,ke=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?(Be=[ve].filter(Mu).join("\n"),Be.length>0&&(Be+="\n"),Ae=[de,ve].filter(Mu).join("\n"),Ae.length>0&&(Ae+="\n")):(Be=[Zp(c),"#define SHADER_NAME "+c.shaderName,ve,c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+oe,"#define MAX_BONES "+c.maxBones,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+te:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.displacementMap&&c.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularTintMap?"#define USE_SPECULARTINTMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.useVertexTexture?"#define BONE_TEXTURE":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+F:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Mu).join("\n"),Ae=[de,Zp(c),"#define SHADER_NAME "+c.shaderName,ve,"#define GAMMA_FACTOR "+oe,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+U:"",c.envMap?"#define "+te:"",c.envMap?"#define "+ce:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularTintMap?"#define USE_SPECULARTINTMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.sheenTint?"#define USE_SHEEN":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+F:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(c.extensionShaderTextureLOD||c.envMap)&&c.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",c.toneMapping!==mr?"#define TONE_MAPPING":"",c.toneMapping!==mr?ui.tonemapping_pars_fragment:"",c.toneMapping!==mr?tc("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.format===Is?"#define OPAQUE":"",ui.encodings_pars_fragment,c.map?tp("mapTexelToLinear",c.mapEncoding):"",c.matcap?tp("matcapTexelToLinear",c.matcapEncoding):"",c.envMap?tp("envMapTexelToLinear",c.envMapEncoding):"",c.emissiveMap?tp("emissiveMapTexelToLinear",c.emissiveMapEncoding):"",c.specularTintMap?tp("specularTintMapTexelToLinear",c.specularTintMapEncoding):"",c.lightMap?tp("lightMapTexelToLinear",c.lightMapEncoding):"",Vd("linearToOutputTexel",c.outputEncoding),c.depthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(Mu).join("\n")),L=Xd(L),L=Wd(L,c),L=lm(L,c),O=Xd(O),O=Wd(O,c),O=lm(O,c),L=Kc(L),O=Kc(O),c.isWebGL2&&!0!==c.isRawShaderMaterial&&(ke="#version 300 es\n",Be=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+Be,Ae=["#define varying in",c.glslVersion===ki?"":"out highp vec4 pc_fragColor;",c.glslVersion===ki?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+Ae);const Je=ke+Ae+O,We=Kl(_,35633,ke+Be+L),rt=Kl(_,35632,Je);if(_.attachShader(Me,We),_.attachShader(Me,rt),void 0!==c.index0AttributeName?_.bindAttribLocation(Me,0,c.index0AttributeName):!0===c.morphTargets&&_.bindAttribLocation(Me,0,"position"),_.linkProgram(Me),S.debug.checkShaderErrors){const xt=_.getProgramInfoLog(Me).trim(),Ut=_.getShaderInfoLog(We).trim(),Ht=_.getShaderInfoLog(rt).trim();let Ye=!0,pt=!0;if(!1===_.getProgramParameter(Me,35714)){Ye=!1;const Vt=Jp(_,We,"vertex"),Rt=Jp(_,rt,"fragment");console.error("THREE.WebGLProgram: Shader Error "+_.getError()+" - VALIDATE_STATUS "+_.getProgramParameter(Me,35715)+"\n\nProgram Info Log: "+xt+"\n"+Vt+"\n"+Rt)}else""!==xt?console.warn("THREE.WebGLProgram: Program Info Log:",xt):""!==Ut&&""!==Ht||(pt=!1);pt&&(this.diagnostics={runnable:Ye,programLog:xt,vertexShader:{log:Ut,prefix:Be},fragmentShader:{log:Ht,prefix:Ae}})}let nt,gt;return _.deleteShader(We),_.deleteShader(rt),this.getUniforms=function(){return void 0===nt&&(nt=new Nl(_,Me)),nt},this.getAttributes=function(){return void 0===gt&&(gt=function(xt,Ut){const Ht={},Ye=xt.getProgramParameter(Ut,35721);for(let pt=0;pt<Ye;pt++){const Vt=xt.getActiveAttrib(Ut,pt),Rt=Vt.name;let lt=1;35674===Vt.type&&(lt=2),35675===Vt.type&&(lt=3),35676===Vt.type&&(lt=4),Ht[Rt]={type:Vt.type,location:xt.getAttribLocation(Ut,Rt),locationSize:lt}}return Ht}(_,Me)),gt},this.destroy=function(){p.releaseStatesOfProgram(this),_.deleteProgram(Me),this.program=void 0},this.name=c.shaderName,this.id=Np++,this.cacheKey=e,this.usedTimes=1,this.program=Me,this.vertexShader=We,this.fragmentShader=rt,this}function Qp(S,e,c,p,_,w,L){const O=[],F=_.isWebGL2,U=_.logarithmicDepthBuffer,te=_.floatVertexTextures,ce=_.maxVertexUniforms,oe=_.vertexTextures;let de=_.precision;const ve={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},Me=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheenTint","transmission","transmissionMap","thicknessMap"];function Be(Ae){let ke;return Ae&&Ae.isTexture?ke=Ae.encoding:Ae&&Ae.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),ke=Ae.texture.encoding):ke=Ki,ke}return{getParameters:function(Ae,ke,Je,We,rt){const nt=We.fog,xt=(Ae.isMeshStandardMaterial?c:e).get(Ae.envMap||(Ae.isMeshStandardMaterial?We.environment:null)),Ut=ve[Ae.type],Ht=rt.isSkinnedMesh?function(Jt){const St=Jt.skeleton.bones;if(te)return 1024;{const It=Math.floor((ce-20)/4),ln=Math.min(It,St.length);return ln<St.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+St.length+" bones. This GPU supports "+ln+"."),0):ln}}(rt):0;let Ye,pt;if(null!==Ae.precision&&(de=_.getMaxPrecision(Ae.precision),de!==Ae.precision&&console.warn("THREE.WebGLProgram.getParameters:",Ae.precision,"not supported, using",de,"instead.")),Ut){const Jt=Bl[Ut];Ye=Jt.vertexShader,pt=Jt.fragmentShader}else Ye=Ae.vertexShader,pt=Ae.fragmentShader;const Vt=S.getRenderTarget(),Rt=Ae.alphaTest>0,lt=Ae.clearcoat>0;return{isWebGL2:F,shaderID:Ut,shaderName:Ae.type,vertexShader:Ye,fragmentShader:pt,defines:Ae.defines,isRawShaderMaterial:!0===Ae.isRawShaderMaterial,glslVersion:Ae.glslVersion,precision:de,instancing:!0===rt.isInstancedMesh,instancingColor:!0===rt.isInstancedMesh&&null!==rt.instanceColor,supportsVertexTextures:oe,outputEncoding:null!==Vt?Be(Vt.texture):S.outputEncoding,map:!!Ae.map,mapEncoding:Be(Ae.map),matcap:!!Ae.matcap,matcapEncoding:Be(Ae.matcap),envMap:!!xt,envMapMode:xt&&xt.mapping,envMapEncoding:Be(xt),envMapCubeUV:!!xt&&(xt.mapping===Oi||xt.mapping===Co),lightMap:!!Ae.lightMap,lightMapEncoding:Be(Ae.lightMap),aoMap:!!Ae.aoMap,emissiveMap:!!Ae.emissiveMap,emissiveMapEncoding:Be(Ae.emissiveMap),bumpMap:!!Ae.bumpMap,normalMap:!!Ae.normalMap,objectSpaceNormalMap:Ae.normalMapType===Ce,tangentSpaceNormalMap:Ae.normalMapType===Ee,clearcoat:lt,clearcoatMap:lt&&!!Ae.clearcoatMap,clearcoatRoughnessMap:lt&&!!Ae.clearcoatRoughnessMap,clearcoatNormalMap:lt&&!!Ae.clearcoatNormalMap,displacementMap:!!Ae.displacementMap,roughnessMap:!!Ae.roughnessMap,metalnessMap:!!Ae.metalnessMap,specularMap:!!Ae.specularMap,specularIntensityMap:!!Ae.specularIntensityMap,specularTintMap:!!Ae.specularTintMap,specularTintMapEncoding:Be(Ae.specularTintMap),alphaMap:!!Ae.alphaMap,alphaTest:Rt,gradientMap:!!Ae.gradientMap,sheenTint:!!Ae.sheenTint&&(Ae.sheenTint.r>0||Ae.sheenTint.g>0||Ae.sheenTint.b>0),transmission:Ae.transmission>0,transmissionMap:!!Ae.transmissionMap,thicknessMap:!!Ae.thicknessMap,combine:Ae.combine,vertexTangents:!!Ae.normalMap&&!!rt.geometry&&!!rt.geometry.attributes.tangent,vertexColors:Ae.vertexColors,vertexAlphas:!0===Ae.vertexColors&&!!rt.geometry&&!!rt.geometry.attributes.color&&4===rt.geometry.attributes.color.itemSize,vertexUvs:!!(Ae.map||Ae.bumpMap||Ae.normalMap||Ae.specularMap||Ae.alphaMap||Ae.emissiveMap||Ae.roughnessMap||Ae.metalnessMap||Ae.clearcoatMap||Ae.clearcoatRoughnessMap||Ae.clearcoatNormalMap||Ae.displacementMap||Ae.transmissionMap||Ae.thicknessMap||Ae.specularIntensityMap||Ae.specularTintMap),uvsVertexOnly:!(Ae.map||Ae.bumpMap||Ae.normalMap||Ae.specularMap||Ae.alphaMap||Ae.emissiveMap||Ae.roughnessMap||Ae.metalnessMap||Ae.clearcoatNormalMap||Ae.transmission>0||Ae.transmissionMap||Ae.thicknessMap||Ae.specularIntensityMap||Ae.specularTintMap||!Ae.displacementMap),fog:!!nt,useFog:Ae.fog,fogExp2:nt&&nt.isFogExp2,flatShading:!!Ae.flatShading,sizeAttenuation:Ae.sizeAttenuation,logarithmicDepthBuffer:U,skinning:!0===rt.isSkinnedMesh&&Ht>0,maxBones:Ht,useVertexTexture:te,morphTargets:!!rt.geometry&&!!rt.geometry.morphAttributes.position,morphNormals:!!rt.geometry&&!!rt.geometry.morphAttributes.normal,numDirLights:ke.directional.length,numPointLights:ke.point.length,numSpotLights:ke.spot.length,numRectAreaLights:ke.rectArea.length,numHemiLights:ke.hemi.length,numDirLightShadows:ke.directionalShadowMap.length,numPointLightShadows:ke.pointShadowMap.length,numSpotLightShadows:ke.spotShadowMap.length,numClippingPlanes:L.numPlanes,numClipIntersection:L.numIntersection,format:Ae.format,dithering:Ae.dithering,shadowMapEnabled:S.shadowMap.enabled&&Je.length>0,shadowMapType:S.shadowMap.type,toneMapping:Ae.toneMapped?S.toneMapping:mr,physicallyCorrectLights:S.physicallyCorrectLights,premultipliedAlpha:Ae.premultipliedAlpha,doubleSided:Ae.side===Q,flipSided:Ae.side===W,depthPacking:void 0!==Ae.depthPacking&&Ae.depthPacking,index0AttributeName:Ae.index0AttributeName,extensionDerivatives:Ae.extensions&&Ae.extensions.derivatives,extensionFragDepth:Ae.extensions&&Ae.extensions.fragDepth,extensionDrawBuffers:Ae.extensions&&Ae.extensions.drawBuffers,extensionShaderTextureLOD:Ae.extensions&&Ae.extensions.shaderTextureLOD,rendererExtensionFragDepth:F||p.has("EXT_frag_depth"),rendererExtensionDrawBuffers:F||p.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:F||p.has("EXT_shader_texture_lod"),customProgramCacheKey:Ae.customProgramCacheKey()}},getProgramCacheKey:function(Ae){const ke=[];if(Ae.shaderID?ke.push(Ae.shaderID):(ke.push(Ae.fragmentShader),ke.push(Ae.vertexShader)),void 0!==Ae.defines)for(const Je in Ae.defines)ke.push(Je),ke.push(Ae.defines[Je]);if(!1===Ae.isRawShaderMaterial){for(let Je=0;Je<Me.length;Je++)ke.push(Ae[Me[Je]]);ke.push(S.outputEncoding),ke.push(S.gammaFactor)}return ke.push(Ae.customProgramCacheKey),ke.join()},getUniforms:function(Ae){const ke=ve[Ae.type];let Je;return Je=ke?Ns.clone(Bl[ke].uniforms):Ae.uniforms,Je},acquireProgram:function(Ae,ke){let Je;for(let We=0,rt=O.length;We<rt;We++){const nt=O[We];if(nt.cacheKey===ke){Je=nt,++Je.usedTimes;break}}return void 0===Je&&(Je=new Jd(S,ke,Ae,w),O.push(Je)),Je},releaseProgram:function(Ae){if(0==--Ae.usedTimes){const ke=O.indexOf(Ae);O[ke]=O[O.length-1],O.pop(),Ae.destroy()}},programs:O}}function xd(){let S=new WeakMap;return{get:function(e){let c=S.get(e);return void 0===c&&(c={},S.set(e,c)),c},remove:function(e){S.delete(e)},update:function(e,c,p){S.get(e)[c]=p},dispose:function(){S=new WeakMap}}}function Rp(S,e){return S.groupOrder!==e.groupOrder?S.groupOrder-e.groupOrder:S.renderOrder!==e.renderOrder?S.renderOrder-e.renderOrder:S.program!==e.program?S.program.id-e.program.id:S.material.id!==e.material.id?S.material.id-e.material.id:S.z!==e.z?S.z-e.z:S.id-e.id}function wd(S,e){return S.groupOrder!==e.groupOrder?S.groupOrder-e.groupOrder:S.renderOrder!==e.renderOrder?S.renderOrder-e.renderOrder:S.z!==e.z?e.z-S.z:S.id-e.id}function Rl(S){const e=[];let c=0;const p=[],_=[],w=[],L={id:-1};function O(F,U,te,ce,oe,de){let ve=e[c];const Me=S.get(te);return void 0===ve?(ve={id:F.id,object:F,geometry:U,material:te,program:Me.program||L,groupOrder:ce,renderOrder:F.renderOrder,z:oe,group:de},e[c]=ve):(ve.id=F.id,ve.object=F,ve.geometry=U,ve.material=te,ve.program=Me.program||L,ve.groupOrder=ce,ve.renderOrder=F.renderOrder,ve.z=oe,ve.group=de),c++,ve}return{opaque:p,transmissive:_,transparent:w,init:function(){c=0,p.length=0,_.length=0,w.length=0},push:function(F,U,te,ce,oe,de){const ve=O(F,U,te,ce,oe,de);te.transmission>0?_.push(ve):!0===te.transparent?w.push(ve):p.push(ve)},unshift:function(F,U,te,ce,oe,de){const ve=O(F,U,te,ce,oe,de);te.transmission>0?_.unshift(ve):!0===te.transparent?w.unshift(ve):p.unshift(ve)},finish:function(){for(let F=c,U=e.length;F<U;F++){const te=e[F];if(null===te.id)break;te.id=null,te.object=null,te.geometry=null,te.material=null,te.program=null,te.group=null}},sort:function(F,U){p.length>1&&p.sort(F||Rp),_.length>1&&_.sort(U||wd),w.length>1&&w.sort(U||wd)}}}function hf(S){let e=new WeakMap;return{get:function(c,p){let _;return!1===e.has(c)?(_=new Rl(S),e.set(c,[_])):p>=e.get(c).length?(_=new Rl(S),e.get(c).push(_)):_=e.get(c)[p],_},dispose:function(){e=new WeakMap}}}function Zd(){const S={};return{get:function(e){if(void 0!==S[e.id])return S[e.id];let c;switch(e.type){case"DirectionalLight":c={direction:new at,color:new Qn};break;case"SpotLight":c={position:new at,direction:new at,color:new Qn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new at,color:new Qn,distance:0,decay:0};break;case"HemisphereLight":c={direction:new at,skyColor:new Qn,groundColor:new Qn};break;case"RectAreaLight":c={color:new Qn,position:new at,halfWidth:new at,halfHeight:new at}}return S[e.id]=c,c}}}let pf=0;function Cf(S,e){return(e.castShadow?1:0)-(S.castShadow?1:0)}function Lf(S,e){const c=new Zd,p=function(){const F={};return{get:function(U){if(void 0!==F[U.id])return F[U.id];let te;switch(U.type){case"DirectionalLight":case"SpotLight":te={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Un};break;case"PointLight":te={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Un,shadowCameraNear:1,shadowCameraFar:1e3}}return F[U.id]=te,te}}}(),_={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let F=0;F<9;F++)_.probe.push(new at);const w=new at,L=new Kt,O=new Kt;return{setup:function(F,U){let te=0,ce=0,oe=0;for(let gt=0;gt<9;gt++)_.probe[gt].set(0,0,0);let de=0,ve=0,Me=0,Be=0,Ae=0,ke=0,Je=0,We=0;F.sort(Cf);const rt=!0!==U?Math.PI:1;for(let gt=0,xt=F.length;gt<xt;gt++){const Ut=F[gt],Ht=Ut.color,Ye=Ut.intensity,pt=Ut.distance,Vt=Ut.shadow&&Ut.shadow.map?Ut.shadow.map.texture:null;if(Ut.isAmbientLight)te+=Ht.r*Ye*rt,ce+=Ht.g*Ye*rt,oe+=Ht.b*Ye*rt;else if(Ut.isLightProbe)for(let Rt=0;Rt<9;Rt++)_.probe[Rt].addScaledVector(Ut.sh.coefficients[Rt],Ye);else if(Ut.isDirectionalLight){const Rt=c.get(Ut);if(Rt.color.copy(Ut.color).multiplyScalar(Ut.intensity*rt),Ut.castShadow){const lt=Ut.shadow,Jt=p.get(Ut);Jt.shadowBias=lt.bias,Jt.shadowNormalBias=lt.normalBias,Jt.shadowRadius=lt.radius,Jt.shadowMapSize=lt.mapSize,_.directionalShadow[de]=Jt,_.directionalShadowMap[de]=Vt,_.directionalShadowMatrix[de]=Ut.shadow.matrix,ke++}_.directional[de]=Rt,de++}else if(Ut.isSpotLight){const Rt=c.get(Ut);if(Rt.position.setFromMatrixPosition(Ut.matrixWorld),Rt.color.copy(Ht).multiplyScalar(Ye*rt),Rt.distance=pt,Rt.coneCos=Math.cos(Ut.angle),Rt.penumbraCos=Math.cos(Ut.angle*(1-Ut.penumbra)),Rt.decay=Ut.decay,Ut.castShadow){const lt=Ut.shadow,Jt=p.get(Ut);Jt.shadowBias=lt.bias,Jt.shadowNormalBias=lt.normalBias,Jt.shadowRadius=lt.radius,Jt.shadowMapSize=lt.mapSize,_.spotShadow[Me]=Jt,_.spotShadowMap[Me]=Vt,_.spotShadowMatrix[Me]=Ut.shadow.matrix,We++}_.spot[Me]=Rt,Me++}else if(Ut.isRectAreaLight){const Rt=c.get(Ut);Rt.color.copy(Ht).multiplyScalar(Ye),Rt.halfWidth.set(.5*Ut.width,0,0),Rt.halfHeight.set(0,.5*Ut.height,0),_.rectArea[Be]=Rt,Be++}else if(Ut.isPointLight){const Rt=c.get(Ut);if(Rt.color.copy(Ut.color).multiplyScalar(Ut.intensity*rt),Rt.distance=Ut.distance,Rt.decay=Ut.decay,Ut.castShadow){const lt=Ut.shadow,Jt=p.get(Ut);Jt.shadowBias=lt.bias,Jt.shadowNormalBias=lt.normalBias,Jt.shadowRadius=lt.radius,Jt.shadowMapSize=lt.mapSize,Jt.shadowCameraNear=lt.camera.near,Jt.shadowCameraFar=lt.camera.far,_.pointShadow[ve]=Jt,_.pointShadowMap[ve]=Vt,_.pointShadowMatrix[ve]=Ut.shadow.matrix,Je++}_.point[ve]=Rt,ve++}else if(Ut.isHemisphereLight){const Rt=c.get(Ut);Rt.skyColor.copy(Ut.color).multiplyScalar(Ye*rt),Rt.groundColor.copy(Ut.groundColor).multiplyScalar(Ye*rt),_.hemi[Ae]=Rt,Ae++}}Be>0&&(e.isWebGL2||!0===S.has("OES_texture_float_linear")?(_.rectAreaLTC1=ir.LTC_FLOAT_1,_.rectAreaLTC2=ir.LTC_FLOAT_2):!0===S.has("OES_texture_half_float_linear")?(_.rectAreaLTC1=ir.LTC_HALF_1,_.rectAreaLTC2=ir.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),_.ambient[0]=te,_.ambient[1]=ce,_.ambient[2]=oe;const nt=_.hash;nt.directionalLength===de&&nt.pointLength===ve&&nt.spotLength===Me&&nt.rectAreaLength===Be&&nt.hemiLength===Ae&&nt.numDirectionalShadows===ke&&nt.numPointShadows===Je&&nt.numSpotShadows===We||(_.directional.length=de,_.spot.length=Me,_.rectArea.length=Be,_.point.length=ve,_.hemi.length=Ae,_.directionalShadow.length=ke,_.directionalShadowMap.length=ke,_.pointShadow.length=Je,_.pointShadowMap.length=Je,_.spotShadow.length=We,_.spotShadowMap.length=We,_.directionalShadowMatrix.length=ke,_.pointShadowMatrix.length=Je,_.spotShadowMatrix.length=We,nt.directionalLength=de,nt.pointLength=ve,nt.spotLength=Me,nt.rectAreaLength=Be,nt.hemiLength=Ae,nt.numDirectionalShadows=ke,nt.numPointShadows=Je,nt.numSpotShadows=We,_.version=pf++)},setupView:function(F,U){let te=0,ce=0,oe=0,de=0,ve=0;const Me=U.matrixWorldInverse;for(let Be=0,Ae=F.length;Be<Ae;Be++){const ke=F[Be];if(ke.isDirectionalLight){const Je=_.directional[te];Je.direction.setFromMatrixPosition(ke.matrixWorld),w.setFromMatrixPosition(ke.target.matrixWorld),Je.direction.sub(w),Je.direction.transformDirection(Me),te++}else if(ke.isSpotLight){const Je=_.spot[oe];Je.position.setFromMatrixPosition(ke.matrixWorld),Je.position.applyMatrix4(Me),Je.direction.setFromMatrixPosition(ke.matrixWorld),w.setFromMatrixPosition(ke.target.matrixWorld),Je.direction.sub(w),Je.direction.transformDirection(Me),oe++}else if(ke.isRectAreaLight){const Je=_.rectArea[de];Je.position.setFromMatrixPosition(ke.matrixWorld),Je.position.applyMatrix4(Me),O.identity(),L.copy(ke.matrixWorld),L.premultiply(Me),O.extractRotation(L),Je.halfWidth.set(.5*ke.width,0,0),Je.halfHeight.set(0,.5*ke.height,0),Je.halfWidth.applyMatrix4(O),Je.halfHeight.applyMatrix4(O),de++}else if(ke.isPointLight){const Je=_.point[ce];Je.position.setFromMatrixPosition(ke.matrixWorld),Je.position.applyMatrix4(Me),ce++}else if(ke.isHemisphereLight){const Je=_.hemi[ve];Je.direction.setFromMatrixPosition(ke.matrixWorld),Je.direction.transformDirection(Me),Je.direction.normalize(),ve++}}},state:_}}function Bf(S,e){const c=new Lf(S,e),p=[],_=[];return{init:function(){p.length=0,_.length=0},state:{lightsArray:p,shadowsArray:_,lights:c},setupLights:function(w){c.setup(p,w)},setupLightsView:function(w){c.setupView(p,w)},pushLight:function(w){p.push(w)},pushShadow:function(w){_.push(w)}}}function Wa(S,e){let c=new WeakMap;return{get:function(p,_=0){let w;return!1===c.has(p)?(w=new Bf(S,e),c.set(p,[w])):_>=c.get(p).length?(w=new Bf(S,e),c.get(p).push(w)):w=c.get(p)[_],w},dispose:function(){c=new WeakMap}}}class Sh extends $s{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=q,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Sh.prototype.isMeshDepthMaterial=!0;class Kp extends $s{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new at,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}Kp.prototype.isMeshDistanceMaterial=!0;var cm="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nuniform float samples;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",Qd="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function Kd(S,e,c){let p=new Dr;const _=new Un,w=new Un,L=new ji,O=new Sh({depthPacking:pe}),F=new Kp,U={},te=c.maxTextureSize,ce={0:W,1:ie,2:Q},oe=new Rs({uniforms:{shadow_pass:{value:null},resolution:{value:new Un},radius:{value:4},samples:{value:8}},vertexShader:Qd,fragmentShader:cm}),de=oe.clone();de.defines.HORIZONTAL_PASS=1;const ve=new gr;ve.setAttribute("position",new Fi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Me=new ko(ve,oe),Be=this;function Ae(We,rt){const nt=e.update(Me);oe.uniforms.shadow_pass.value=We.map.texture,oe.uniforms.resolution.value=We.mapSize,oe.uniforms.radius.value=We.radius,oe.uniforms.samples.value=We.blurSamples,S.setRenderTarget(We.mapPass),S.clear(),S.renderBufferDirect(rt,null,nt,oe,Me,null),de.uniforms.shadow_pass.value=We.mapPass.texture,de.uniforms.resolution.value=We.mapSize,de.uniforms.radius.value=We.radius,de.uniforms.samples.value=We.blurSamples,S.setRenderTarget(We.map),S.clear(),S.renderBufferDirect(rt,null,nt,de,Me,null)}function ke(We,rt,nt,gt,xt,Ut,Ht){let Ye=null;const pt=!0===gt.isPointLight?We.customDistanceMaterial:We.customDepthMaterial;if(Ye=void 0!==pt?pt:!0===gt.isPointLight?F:O,S.localClippingEnabled&&!0===nt.clipShadows&&0!==nt.clippingPlanes.length||nt.displacementMap&&0!==nt.displacementScale||nt.alphaMap&&nt.alphaTest>0){const Vt=Ye.uuid,Rt=nt.uuid;let lt=U[Vt];void 0===lt&&(lt={},U[Vt]=lt);let Jt=lt[Rt];void 0===Jt&&(Jt=Ye.clone(),lt[Rt]=Jt),Ye=Jt}return Ye.visible=nt.visible,Ye.wireframe=nt.wireframe,Ye.side=Ht===me?null!==nt.shadowSide?nt.shadowSide:nt.side:null!==nt.shadowSide?nt.shadowSide:ce[nt.side],Ye.alphaMap=nt.alphaMap,Ye.alphaTest=nt.alphaTest,Ye.clipShadows=nt.clipShadows,Ye.clippingPlanes=nt.clippingPlanes,Ye.clipIntersection=nt.clipIntersection,Ye.displacementMap=nt.displacementMap,Ye.displacementScale=nt.displacementScale,Ye.displacementBias=nt.displacementBias,Ye.wireframeLinewidth=nt.wireframeLinewidth,Ye.linewidth=nt.linewidth,!0===gt.isPointLight&&!0===Ye.isMeshDistanceMaterial&&(Ye.referencePosition.setFromMatrixPosition(gt.matrixWorld),Ye.nearDistance=xt,Ye.farDistance=Ut),Ye}function Je(We,rt,nt,gt,xt){if(!1===We.visible)return;if(We.layers.test(rt.layers)&&(We.isMesh||We.isLine||We.isPoints)&&(We.castShadow||We.receiveShadow&&xt===me)&&(!We.frustumCulled||p.intersectsObject(We))){We.modelViewMatrix.multiplyMatrices(nt.matrixWorldInverse,We.matrixWorld);const Ht=e.update(We),Ye=We.material;if(Array.isArray(Ye)){const pt=Ht.groups;for(let Vt=0,Rt=pt.length;Vt<Rt;Vt++){const lt=pt[Vt],Jt=Ye[lt.materialIndex];if(Jt&&Jt.visible){const St=ke(We,0,Jt,gt,nt.near,nt.far,xt);S.renderBufferDirect(nt,null,Ht,St,We,lt)}}}else if(Ye.visible){const pt=ke(We,0,Ye,gt,nt.near,nt.far,xt);S.renderBufferDirect(nt,null,Ht,pt,We,null)}}const Ut=We.children;for(let Ht=0,Ye=Ut.length;Ht<Ye;Ht++)Je(Ut[Ht],rt,nt,gt,xt)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ne,this.render=function(We,rt,nt){if(!1===Be.enabled||!1===Be.autoUpdate&&!1===Be.needsUpdate||0===We.length)return;const gt=S.getRenderTarget(),xt=S.getActiveCubeFace(),Ut=S.getActiveMipmapLevel(),Ht=S.state;Ht.setBlending(X),Ht.buffers.color.setClear(1,1,1,1),Ht.buffers.depth.setTest(!0),Ht.setScissorTest(!1);for(let Ye=0,pt=We.length;Ye<pt;Ye++){const Vt=We[Ye],Rt=Vt.shadow;if(void 0===Rt){console.warn("THREE.WebGLShadowMap:",Vt,"has no shadow.");continue}if(!1===Rt.autoUpdate&&!1===Rt.needsUpdate)continue;_.copy(Rt.mapSize);const lt=Rt.getFrameExtents();if(_.multiply(lt),w.copy(Rt.mapSize),(_.x>te||_.y>te)&&(_.x>te&&(w.x=Math.floor(te/lt.x),_.x=w.x*lt.x,Rt.mapSize.x=w.x),_.y>te&&(w.y=Math.floor(te/lt.y),_.y=w.y*lt.y,Rt.mapSize.y=w.y)),null===Rt.map&&!Rt.isPointLightShadow&&this.type===me){const St={minFilter:ai,magFilter:ai,format:mo};Rt.map=new lo(_.x,_.y,St),Rt.map.texture.name=Vt.name+".shadowMap",Rt.mapPass=new lo(_.x,_.y,St),Rt.camera.updateProjectionMatrix()}null===Rt.map&&(Rt.map=new lo(_.x,_.y,{minFilter:Or,magFilter:Or,format:mo}),Rt.map.texture.name=Vt.name+".shadowMap",Rt.camera.updateProjectionMatrix()),S.setRenderTarget(Rt.map),S.clear();const Jt=Rt.getViewportCount();for(let St=0;St<Jt;St++){const jt=Rt.getViewport(St);L.set(w.x*jt.x,w.y*jt.y,w.x*jt.z,w.y*jt.w),Ht.viewport(L),Rt.updateMatrices(Vt,St),p=Rt.getFrustum(),Je(rt,nt,Rt.camera,Vt,this.type)}Rt.isPointLightShadow||this.type!==me||Ae(Rt,nt),Rt.needsUpdate=!1}Be.needsUpdate=!1,S.setRenderTarget(gt,xt,Ut)}}function um(S,e,c){const p=c.isWebGL2,_=new function(){let dt=!1;const an=new ji;let Tn=null;const un=new ji(0,0,0,0);return{setMask:function(Wt){Tn===Wt||dt||(S.colorMask(Wt,Wt,Wt,Wt),Tn=Wt)},setLocked:function(Wt){dt=Wt},setClear:function(Wt,vr,hr,Br,zi){!0===zi&&(Wt*=Br,vr*=Br,hr*=Br),an.set(Wt,vr,hr,Br),!1===un.equals(an)&&(S.clearColor(Wt,vr,hr,Br),un.copy(an))},reset:function(){dt=!1,Tn=null,un.set(-1,0,0,0)}}},w=new function(){let dt=!1,an=null,Tn=null,un=null;return{setTest:function(Wt){Wt?Ze(2929):st(2929)},setMask:function(Wt){an===Wt||dt||(S.depthMask(Wt),an=Wt)},setFunc:function(Wt){if(Tn!==Wt){if(Wt)switch(Wt){case On:S.depthFunc(512);break;case $n:S.depthFunc(519);break;case _n:S.depthFunc(513);break;case ar:S.depthFunc(515);break;case nr:S.depthFunc(514);break;case lr:S.depthFunc(518);break;case rr:S.depthFunc(516);break;case ti:S.depthFunc(517);break;default:S.depthFunc(515)}else S.depthFunc(515);Tn=Wt}},setLocked:function(Wt){dt=Wt},setClear:function(Wt){un!==Wt&&(S.clearDepth(Wt),un=Wt)},reset:function(){dt=!1,an=null,Tn=null,un=null}}},L=new function(){let dt=!1,an=null,Tn=null,un=null,Wt=null,vr=null,hr=null,Br=null,zi=null;return{setTest:function(bo){dt||(bo?Ze(2960):st(2960))},setMask:function(bo){an===bo||dt||(S.stencilMask(bo),an=bo)},setFunc:function(bo,_l,Wo){Tn===bo&&un===_l&&Wt===Wo||(S.stencilFunc(bo,_l,Wo),Tn=bo,un=_l,Wt=Wo)},setOp:function(bo,_l,Wo){vr===bo&&hr===_l&&Br===Wo||(S.stencilOp(bo,_l,Wo),vr=bo,hr=_l,Br=Wo)},setLocked:function(bo){dt=bo},setClear:function(bo){zi!==bo&&(S.clearStencil(bo),zi=bo)},reset:function(){dt=!1,an=null,Tn=null,un=null,Wt=null,vr=null,hr=null,Br=null,zi=null}}};let O={},F=null,U={},te=null,ce=!1,oe=null,de=null,ve=null,Me=null,Be=null,Ae=null,ke=null,Je=!1,We=null,rt=null,nt=null,gt=null,xt=null;const Ut=S.getParameter(35661);let Ht=!1,Ye=0;const pt=S.getParameter(7938);-1!==pt.indexOf("WebGL")?(Ye=parseFloat(/^WebGL (\d)/.exec(pt)[1]),Ht=Ye>=1):-1!==pt.indexOf("OpenGL ES")&&(Ye=parseFloat(/^OpenGL ES (\d)/.exec(pt)[1]),Ht=Ye>=2);let Vt=null,Rt={};const lt=S.getParameter(3088),Jt=S.getParameter(2978),St=(new ji).fromArray(lt),jt=(new ji).fromArray(Jt);function It(dt,an,Tn){const un=new Uint8Array(4),Wt=S.createTexture();S.bindTexture(dt,Wt),S.texParameteri(dt,10241,9728),S.texParameteri(dt,10240,9728);for(let vr=0;vr<Tn;vr++)S.texImage2D(an+vr,0,6408,1,1,0,6408,5121,un);return Wt}const ln={};function Ze(dt){!0!==O[dt]&&(S.enable(dt),O[dt]=!0)}function st(dt){!1!==O[dt]&&(S.disable(dt),O[dt]=!1)}ln[3553]=It(3553,3553,1),ln[34067]=It(34067,34069,6),_.setClear(0,0,0,1),w.setClear(1),L.setClear(0),Ze(2929),w.setFunc(ar),Mn(!1),Yn(M),Ze(2884),tn(X);const Pt={[Ne]:32774,[je]:32778,[Te]:32779};if(p)Pt[qe]=32775,Pt[Ke]=32776;else{const dt=e.get("EXT_blend_minmax");null!==dt&&(Pt[qe]=dt.MIN_EXT,Pt[Ke]=dt.MAX_EXT)}const Gt={[vt]:0,[ht]:1,[Bt]:768,[Ft]:770,[fn]:776,[An]:774,[on]:772,[wt]:769,[Ot]:771,[Cn]:775,[ft]:773};function tn(dt,an,Tn,un,Wt,vr,hr,Br){if(dt!==X){if(!1===ce&&(Ze(3042),ce=!0),dt===be)Wt=Wt||an,vr=vr||Tn,hr=hr||un,an===de&&Wt===Be||(S.blendEquationSeparate(Pt[an],Pt[Wt]),de=an,Be=Wt),Tn===ve&&un===Me&&vr===Ae&&hr===ke||(S.blendFuncSeparate(Gt[Tn],Gt[un],Gt[vr],Gt[hr]),ve=Tn,Me=un,Ae=vr,ke=hr),oe=dt,Je=null;else if(dt!==oe||Br!==Je){if(de===Ne&&Be===Ne||(S.blendEquation(32774),de=Ne,Be=Ne),Br)switch(dt){case he:S.blendFuncSeparate(1,771,1,771);break;case z:S.blendFunc(1,1);break;case Le:S.blendFuncSeparate(0,0,769,771);break;case K:S.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",dt)}else switch(dt){case he:S.blendFuncSeparate(770,771,1,771);break;case z:S.blendFunc(770,1);break;case Le:S.blendFunc(0,769);break;case K:S.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",dt)}ve=null,Me=null,Ae=null,ke=null,oe=dt,Je=Br}}else!0===ce&&(st(3042),ce=!1)}function Mn(dt){We!==dt&&(S.frontFace(dt?2304:2305),We=dt)}function Yn(dt){dt!==G?(Ze(2884),dt!==rt&&S.cullFace(dt===M?1029:dt===P?1028:1032)):st(2884),rt=dt}function Vn(dt,an,Tn){dt?(Ze(32823),gt===an&&xt===Tn||(S.polygonOffset(an,Tn),gt=an,xt=Tn)):st(32823)}function sn(dt){void 0===dt&&(dt=33984+Ut-1),Vt!==dt&&(S.activeTexture(dt),Vt=dt)}return{buffers:{color:_,depth:w,stencil:L},enable:Ze,disable:st,bindFramebuffer:function(dt,an){return null===an&&null!==F&&(an=F),U[dt]!==an&&(S.bindFramebuffer(dt,an),U[dt]=an,p&&(36009===dt&&(U[36160]=an),36160===dt&&(U[36009]=an)),!0)},bindXRFramebuffer:function(dt){dt!==F&&(S.bindFramebuffer(36160,dt),F=dt)},useProgram:function(dt){return te!==dt&&(S.useProgram(dt),te=dt,!0)},setBlending:tn,setMaterial:function(dt,an){dt.side===Q?st(2884):Ze(2884);let Tn=dt.side===W;an&&(Tn=!Tn),Mn(Tn),dt.blending===he&&!1===dt.transparent?tn(X):tn(dt.blending,dt.blendEquation,dt.blendSrc,dt.blendDst,dt.blendEquationAlpha,dt.blendSrcAlpha,dt.blendDstAlpha,dt.premultipliedAlpha),w.setFunc(dt.depthFunc),w.setTest(dt.depthTest),w.setMask(dt.depthWrite),_.setMask(dt.colorWrite);const un=dt.stencilWrite;L.setTest(un),un&&(L.setMask(dt.stencilWriteMask),L.setFunc(dt.stencilFunc,dt.stencilRef,dt.stencilFuncMask),L.setOp(dt.stencilFail,dt.stencilZFail,dt.stencilZPass)),Vn(dt.polygonOffset,dt.polygonOffsetFactor,dt.polygonOffsetUnits),!0===dt.alphaToCoverage?Ze(32926):st(32926)},setFlipSided:Mn,setCullFace:Yn,setLineWidth:function(dt){dt!==nt&&(Ht&&S.lineWidth(dt),nt=dt)},setPolygonOffset:Vn,setScissorTest:function(dt){dt?Ze(3089):st(3089)},activeTexture:sn,bindTexture:function(dt,an){null===Vt&&sn();let Tn=Rt[Vt];void 0===Tn&&(Tn={type:void 0,texture:void 0},Rt[Vt]=Tn),Tn.type===dt&&Tn.texture===an||(S.bindTexture(dt,an||ln[dt]),Tn.type=dt,Tn.texture=an)},unbindTexture:function(){const dt=Rt[Vt];void 0!==dt&&void 0!==dt.type&&(S.bindTexture(dt.type,null),dt.type=void 0,dt.texture=void 0)},compressedTexImage2D:function(){try{S.compressedTexImage2D.apply(S,arguments)}catch(dt){console.error("THREE.WebGLState:",dt)}},texImage2D:function(){try{S.texImage2D.apply(S,arguments)}catch(dt){console.error("THREE.WebGLState:",dt)}},texImage3D:function(){try{S.texImage3D.apply(S,arguments)}catch(dt){console.error("THREE.WebGLState:",dt)}},scissor:function(dt){!1===St.equals(dt)&&(S.scissor(dt.x,dt.y,dt.z,dt.w),St.copy(dt))},viewport:function(dt){!1===jt.equals(dt)&&(S.viewport(dt.x,dt.y,dt.z,dt.w),jt.copy(dt))},reset:function(){S.disable(3042),S.disable(2884),S.disable(2929),S.disable(32823),S.disable(3089),S.disable(2960),S.disable(32926),S.blendEquation(32774),S.blendFunc(1,0),S.blendFuncSeparate(1,0,1,0),S.colorMask(!0,!0,!0,!0),S.clearColor(0,0,0,0),S.depthMask(!0),S.depthFunc(513),S.clearDepth(1),S.stencilMask(4294967295),S.stencilFunc(519,0,4294967295),S.stencilOp(7680,7680,7680),S.clearStencil(0),S.cullFace(1029),S.frontFace(2305),S.polygonOffset(0,0),S.activeTexture(33984),S.bindFramebuffer(36160,null),!0===p&&(S.bindFramebuffer(36009,null),S.bindFramebuffer(36008,null)),S.useProgram(null),S.lineWidth(1),S.scissor(0,0,S.canvas.width,S.canvas.height),S.viewport(0,0,S.canvas.width,S.canvas.height),O={},Vt=null,Rt={},F=null,U={},te=null,ce=!1,oe=null,de=null,ve=null,Me=null,Be=null,Ae=null,ke=null,Je=!1,We=null,rt=null,nt=null,gt=null,xt=null,St.set(0,0,S.canvas.width,S.canvas.height),jt.set(0,0,S.canvas.width,S.canvas.height),_.reset(),w.reset(),L.reset()}}}function Fm(S,e,c,p,_,w,L){const O=_.isWebGL2,F=_.maxTextures,U=_.maxCubemapSize,te=_.maxTextureSize,ce=_.maxSamples,oe=new WeakMap;let de,ve=!1;try{ve=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function Me(Ze,st){return ve?new OffscreenCanvas(Ze,st):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function Be(Ze,st,Pt,Gt){let tn=1;if((Ze.width>Gt||Ze.height>Gt)&&(tn=Gt/Math.max(Ze.width,Ze.height)),tn<1||!0===st){if(typeof HTMLImageElement<"u"&&Ze instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ze instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ze instanceof ImageBitmap){const Mn=st?So:Math.floor,Yn=Mn(tn*Ze.width),Vn=Mn(tn*Ze.height);void 0===de&&(de=Me(Yn,Vn));const sn=Pt?Me(Yn,Vn):de;return sn.width=Yn,sn.height=Vn,sn.getContext("2d").drawImage(Ze,0,0,Yn,Vn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ze.width+"x"+Ze.height+") to ("+Yn+"x"+Vn+")."),sn}return"data"in Ze&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ze.width+"x"+Ze.height+")."),Ze}return Ze}function Ae(Ze){return ks(Ze.width)&&ks(Ze.height)}function ke(Ze,st){return Ze.generateMipmaps&&st&&Ze.minFilter!==Or&&Ze.minFilter!==ai}function Je(Ze,st,Pt,Gt,tn=1){S.generateMipmap(Ze),p.get(st).__maxMipLevel=Math.log2(Math.max(Pt,Gt,tn))}function We(Ze,st,Pt){if(!1===O)return st;if(null!==Ze){if(void 0!==S[Ze])return S[Ze];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ze+"'")}let Gt=st;return 6403===st&&(5126===Pt&&(Gt=33326),5131===Pt&&(Gt=33325),5121===Pt&&(Gt=33321)),6407===st&&(5126===Pt&&(Gt=34837),5131===Pt&&(Gt=34843),5121===Pt&&(Gt=32849)),6408===st&&(5126===Pt&&(Gt=34836),5131===Pt&&(Gt=34842),5121===Pt&&(Gt=32856)),33325!==Gt&&33326!==Gt&&34842!==Gt&&34836!==Gt||e.get("EXT_color_buffer_float"),Gt}function rt(Ze){return Ze===Or||Ze===Oa||Ze===fs?9728:9729}function nt(Ze){const st=Ze.target;st.removeEventListener("dispose",nt),function(Pt){const Gt=p.get(Pt);void 0!==Gt.__webglInit&&(S.deleteTexture(Gt.__webglTexture),p.remove(Pt))}(st),st.isVideoTexture&&oe.delete(st),L.memory.textures--}function gt(Ze){const st=Ze.target;st.removeEventListener("dispose",gt),function(Pt){const Gt=Pt.texture,tn=p.get(Pt),Mn=p.get(Gt);if(Pt){if(void 0!==Mn.__webglTexture&&(S.deleteTexture(Mn.__webglTexture),L.memory.textures--),Pt.depthTexture&&Pt.depthTexture.dispose(),Pt.isWebGLCubeRenderTarget)for(let Yn=0;Yn<6;Yn++)S.deleteFramebuffer(tn.__webglFramebuffer[Yn]),tn.__webglDepthbuffer&&S.deleteRenderbuffer(tn.__webglDepthbuffer[Yn]);else S.deleteFramebuffer(tn.__webglFramebuffer),tn.__webglDepthbuffer&&S.deleteRenderbuffer(tn.__webglDepthbuffer),tn.__webglMultisampledFramebuffer&&S.deleteFramebuffer(tn.__webglMultisampledFramebuffer),tn.__webglColorRenderbuffer&&S.deleteRenderbuffer(tn.__webglColorRenderbuffer),tn.__webglDepthRenderbuffer&&S.deleteRenderbuffer(tn.__webglDepthRenderbuffer);if(Pt.isWebGLMultipleRenderTargets)for(let Yn=0,Vn=Gt.length;Yn<Vn;Yn++){const sn=p.get(Gt[Yn]);sn.__webglTexture&&(S.deleteTexture(sn.__webglTexture),L.memory.textures--),p.remove(Gt[Yn])}p.remove(Gt),p.remove(Pt)}}(st)}let xt=0;function Ut(Ze,st){const Pt=p.get(Ze);if(Ze.isVideoTexture&&function(Gt){const tn=L.render.frame;oe.get(Gt)!==tn&&(oe.set(Gt,tn),Gt.update())}(Ze),Ze.version>0&&Pt.__version!==Ze.version){const Gt=Ze.image;if(void 0===Gt)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==Gt.complete)return void lt(Pt,Ze,st);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}c.activeTexture(33984+st),c.bindTexture(3553,Pt.__webglTexture)}function Ht(Ze,st){const Pt=p.get(Ze);Ze.version>0&&Pt.__version!==Ze.version?function(Gt,tn,Mn){if(6!==tn.image.length)return;Rt(Gt,tn),c.activeTexture(33984+Mn),c.bindTexture(34067,Gt.__webglTexture),S.pixelStorei(37440,tn.flipY),S.pixelStorei(37441,tn.premultiplyAlpha),S.pixelStorei(3317,tn.unpackAlignment),S.pixelStorei(37443,0);const Yn=tn&&(tn.isCompressedTexture||tn.image[0].isCompressedTexture),Vn=tn.image[0]&&tn.image[0].isDataTexture,sn=[];for(let hr=0;hr<6;hr++)sn[hr]=Yn||Vn?Vn?tn.image[hr].image:tn.image[hr]:Be(tn.image[hr],!1,!0,U);const dt=sn[0],an=Ae(dt)||O,Tn=w.convert(tn.format),un=w.convert(tn.type),Wt=We(tn.internalFormat,Tn,un);let vr;if(Vt(34067,tn,an),Yn){for(let hr=0;hr<6;hr++){vr=sn[hr].mipmaps;for(let Br=0;Br<vr.length;Br++){const zi=vr[Br];tn.format!==mo&&tn.format!==Is?null!==Tn?c.compressedTexImage2D(34069+hr,Br,Wt,zi.width,zi.height,0,zi.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):c.texImage2D(34069+hr,Br,Wt,zi.width,zi.height,0,Tn,un,zi.data)}}Gt.__maxMipLevel=vr.length-1}else{vr=tn.mipmaps;for(let hr=0;hr<6;hr++)if(Vn){c.texImage2D(34069+hr,0,Wt,sn[hr].width,sn[hr].height,0,Tn,un,sn[hr].data);for(let Br=0;Br<vr.length;Br++){const zi=vr[Br].image[hr].image;c.texImage2D(34069+hr,Br+1,Wt,zi.width,zi.height,0,Tn,un,zi.data)}}else{c.texImage2D(34069+hr,0,Wt,Tn,un,sn[hr]);for(let Br=0;Br<vr.length;Br++)c.texImage2D(34069+hr,Br+1,Wt,Tn,un,vr[Br].image[hr])}Gt.__maxMipLevel=vr.length}ke(tn,an)&&Je(34067,tn,dt.width,dt.height),Gt.__version=tn.version,tn.onUpdate&&tn.onUpdate(tn)}(Pt,Ze,st):(c.activeTexture(33984+st),c.bindTexture(34067,Pt.__webglTexture))}const Ye={[wo]:10497,[Yr]:33071,[os]:33648},pt={[Or]:9728,[Oa]:9984,[fs]:9986,[ai]:9729,[Fc]:9985,[Ka]:9987};function Vt(Ze,st,Pt){if(Pt?(S.texParameteri(Ze,10242,Ye[st.wrapS]),S.texParameteri(Ze,10243,Ye[st.wrapT]),32879!==Ze&&35866!==Ze||S.texParameteri(Ze,32882,Ye[st.wrapR]),S.texParameteri(Ze,10240,pt[st.magFilter]),S.texParameteri(Ze,10241,pt[st.minFilter])):(S.texParameteri(Ze,10242,33071),S.texParameteri(Ze,10243,33071),32879!==Ze&&35866!==Ze||S.texParameteri(Ze,32882,33071),st.wrapS===Yr&&st.wrapT===Yr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),S.texParameteri(Ze,10240,rt(st.magFilter)),S.texParameteri(Ze,10241,rt(st.minFilter)),st.minFilter!==Or&&st.minFilter!==ai&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const Gt=e.get("EXT_texture_filter_anisotropic");if(st.type===qo&&!1===e.has("OES_texture_float_linear")||!1===O&&st.type===ms&&!1===e.has("OES_texture_half_float_linear"))return;(st.anisotropy>1||p.get(st).__currentAnisotropy)&&(S.texParameterf(Ze,Gt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(st.anisotropy,_.getMaxAnisotropy())),p.get(st).__currentAnisotropy=st.anisotropy)}}function Rt(Ze,st){void 0===Ze.__webglInit&&(Ze.__webglInit=!0,st.addEventListener("dispose",nt),Ze.__webglTexture=S.createTexture(),L.memory.textures++)}function lt(Ze,st,Pt){let Gt=3553;st.isDataTexture2DArray&&(Gt=35866),st.isDataTexture3D&&(Gt=32879),Rt(Ze,st),c.activeTexture(33984+Pt),c.bindTexture(Gt,Ze.__webglTexture),S.pixelStorei(37440,st.flipY),S.pixelStorei(37441,st.premultiplyAlpha),S.pixelStorei(3317,st.unpackAlignment),S.pixelStorei(37443,0);const tn=(un=st,!O&&(un.wrapS!==Yr||un.wrapT!==Yr||un.minFilter!==Or&&un.minFilter!==ai)&&!1===Ae(st.image)),Mn=Be(st.image,tn,!1,te),Yn=Ae(Mn)||O,Vn=w.convert(st.format);var un;let sn,dt=w.convert(st.type),an=We(st.internalFormat,Vn,dt);Vt(Gt,st,Yn);const Tn=st.mipmaps;if(st.isDepthTexture)an=6402,O?an=st.type===qo?36012:st.type===Ws?33190:st.type===Ts?35056:33189:st.type===qo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),st.format===Lo&&6402===an&&st.type!==Dc&&st.type!==Ws&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),st.type=Dc,dt=w.convert(st.type)),st.format===qs&&6402===an&&(an=34041,st.type!==Ts&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),st.type=Ts,dt=w.convert(st.type))),c.texImage2D(3553,0,an,Mn.width,Mn.height,0,Vn,dt,null);else if(st.isDataTexture)if(Tn.length>0&&Yn){for(let un=0,Wt=Tn.length;un<Wt;un++)sn=Tn[un],c.texImage2D(3553,un,an,sn.width,sn.height,0,Vn,dt,sn.data);st.generateMipmaps=!1,Ze.__maxMipLevel=Tn.length-1}else c.texImage2D(3553,0,an,Mn.width,Mn.height,0,Vn,dt,Mn.data),Ze.__maxMipLevel=0;else if(st.isCompressedTexture){for(let un=0,Wt=Tn.length;un<Wt;un++)sn=Tn[un],st.format!==mo&&st.format!==Is?null!==Vn?c.compressedTexImage2D(3553,un,an,sn.width,sn.height,0,sn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):c.texImage2D(3553,un,an,sn.width,sn.height,0,Vn,dt,sn.data);Ze.__maxMipLevel=Tn.length-1}else if(st.isDataTexture2DArray)c.texImage3D(35866,0,an,Mn.width,Mn.height,Mn.depth,0,Vn,dt,Mn.data),Ze.__maxMipLevel=0;else if(st.isDataTexture3D)c.texImage3D(32879,0,an,Mn.width,Mn.height,Mn.depth,0,Vn,dt,Mn.data),Ze.__maxMipLevel=0;else if(Tn.length>0&&Yn){for(let un=0,Wt=Tn.length;un<Wt;un++)sn=Tn[un],c.texImage2D(3553,un,an,Vn,dt,sn);st.generateMipmaps=!1,Ze.__maxMipLevel=Tn.length-1}else c.texImage2D(3553,0,an,Vn,dt,Mn),Ze.__maxMipLevel=0;ke(st,Yn)&&Je(Gt,st,Mn.width,Mn.height),Ze.__version=st.version,st.onUpdate&&st.onUpdate(st)}function Jt(Ze,st,Pt,Gt,tn){const Mn=w.convert(Pt.format),Yn=w.convert(Pt.type),Vn=We(Pt.internalFormat,Mn,Yn);32879===tn||35866===tn?c.texImage3D(tn,0,Vn,st.width,st.height,st.depth,0,Mn,Yn,null):c.texImage2D(tn,0,Vn,st.width,st.height,0,Mn,Yn,null),c.bindFramebuffer(36160,Ze),S.framebufferTexture2D(36160,Gt,tn,p.get(Pt).__webglTexture,0),c.bindFramebuffer(36160,null)}function St(Ze,st,Pt){if(S.bindRenderbuffer(36161,Ze),st.depthBuffer&&!st.stencilBuffer){let Gt=33189;if(Pt){const tn=st.depthTexture;tn&&tn.isDepthTexture&&(tn.type===qo?Gt=36012:tn.type===Ws&&(Gt=33190));const Mn=jt(st);S.renderbufferStorageMultisample(36161,Mn,Gt,st.width,st.height)}else S.renderbufferStorage(36161,Gt,st.width,st.height);S.framebufferRenderbuffer(36160,36096,36161,Ze)}else if(st.depthBuffer&&st.stencilBuffer){if(Pt){const Gt=jt(st);S.renderbufferStorageMultisample(36161,Gt,35056,st.width,st.height)}else S.renderbufferStorage(36161,34041,st.width,st.height);S.framebufferRenderbuffer(36160,33306,36161,Ze)}else{const Gt=!0===st.isWebGLMultipleRenderTargets?st.texture[0]:st.texture,tn=w.convert(Gt.format),Mn=w.convert(Gt.type),Yn=We(Gt.internalFormat,tn,Mn);if(Pt){const Vn=jt(st);S.renderbufferStorageMultisample(36161,Vn,Yn,st.width,st.height)}else S.renderbufferStorage(36161,Yn,st.width,st.height)}S.bindRenderbuffer(36161,null)}function jt(Ze){return O&&Ze.isWebGLMultisampleRenderTarget?Math.min(ce,Ze.samples):0}let It=!1,ln=!1;this.allocateTextureUnit=function(){const Ze=xt;return Ze>=F&&console.warn("THREE.WebGLTextures: Trying to use "+Ze+" texture units while this GPU supports only "+F),xt+=1,Ze},this.resetTextureUnits=function(){xt=0},this.setTexture2D=Ut,this.setTexture2DArray=function(Ze,st){const Pt=p.get(Ze);Ze.version>0&&Pt.__version!==Ze.version?lt(Pt,Ze,st):(c.activeTexture(33984+st),c.bindTexture(35866,Pt.__webglTexture))},this.setTexture3D=function(Ze,st){const Pt=p.get(Ze);Ze.version>0&&Pt.__version!==Ze.version?lt(Pt,Ze,st):(c.activeTexture(33984+st),c.bindTexture(32879,Pt.__webglTexture))},this.setTextureCube=Ht,this.setupRenderTarget=function(Ze){const st=Ze.texture,Pt=p.get(Ze),Gt=p.get(st);Ze.addEventListener("dispose",gt),!0!==Ze.isWebGLMultipleRenderTargets&&(Gt.__webglTexture=S.createTexture(),Gt.__version=st.version,L.memory.textures++);const tn=!0===Ze.isWebGLCubeRenderTarget,Mn=!0===Ze.isWebGLMultipleRenderTargets,Yn=!0===Ze.isWebGLMultisampleRenderTarget,Vn=st.isDataTexture3D||st.isDataTexture2DArray,sn=Ae(Ze)||O;if(!O||st.format!==Is||st.type!==qo&&st.type!==ms||(st.format=mo,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),tn){Pt.__webglFramebuffer=[];for(let dt=0;dt<6;dt++)Pt.__webglFramebuffer[dt]=S.createFramebuffer()}else if(Pt.__webglFramebuffer=S.createFramebuffer(),Mn)if(_.drawBuffers){const dt=Ze.texture;for(let an=0,Tn=dt.length;an<Tn;an++){const un=p.get(dt[an]);void 0===un.__webglTexture&&(un.__webglTexture=S.createTexture(),L.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Yn)if(O){Pt.__webglMultisampledFramebuffer=S.createFramebuffer(),Pt.__webglColorRenderbuffer=S.createRenderbuffer(),S.bindRenderbuffer(36161,Pt.__webglColorRenderbuffer);const dt=w.convert(st.format),an=w.convert(st.type),Tn=We(st.internalFormat,dt,an),un=jt(Ze);S.renderbufferStorageMultisample(36161,un,Tn,Ze.width,Ze.height),c.bindFramebuffer(36160,Pt.__webglMultisampledFramebuffer),S.framebufferRenderbuffer(36160,36064,36161,Pt.__webglColorRenderbuffer),S.bindRenderbuffer(36161,null),Ze.depthBuffer&&(Pt.__webglDepthRenderbuffer=S.createRenderbuffer(),St(Pt.__webglDepthRenderbuffer,Ze,!0)),c.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(tn){c.bindTexture(34067,Gt.__webglTexture),Vt(34067,st,sn);for(let dt=0;dt<6;dt++)Jt(Pt.__webglFramebuffer[dt],Ze,st,36064,34069+dt);ke(st,sn)&&Je(34067,st,Ze.width,Ze.height),c.unbindTexture()}else if(Mn){const dt=Ze.texture;for(let an=0,Tn=dt.length;an<Tn;an++){const un=dt[an],Wt=p.get(un);c.bindTexture(3553,Wt.__webglTexture),Vt(3553,un,sn),Jt(Pt.__webglFramebuffer,Ze,un,36064+an,3553),ke(un,sn)&&Je(3553,un,Ze.width,Ze.height)}c.unbindTexture()}else{let dt=3553;Vn&&(O?dt=st.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),c.bindTexture(dt,Gt.__webglTexture),Vt(dt,st,sn),Jt(Pt.__webglFramebuffer,Ze,st,36064,dt),ke(st,sn)&&Je(dt,st,Ze.width,Ze.height,Ze.depth),c.unbindTexture()}Ze.depthBuffer&&function(dt){const an=p.get(dt),Tn=!0===dt.isWebGLCubeRenderTarget;if(dt.depthTexture){if(Tn)throw new Error("target.depthTexture not supported in Cube render targets");!function(un,Wt){if(Wt&&Wt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(36160,un),!Wt.depthTexture||!Wt.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");p.get(Wt.depthTexture).__webglTexture&&Wt.depthTexture.image.width===Wt.width&&Wt.depthTexture.image.height===Wt.height||(Wt.depthTexture.image.width=Wt.width,Wt.depthTexture.image.height=Wt.height,Wt.depthTexture.needsUpdate=!0),Ut(Wt.depthTexture,0);const vr=p.get(Wt.depthTexture).__webglTexture;if(Wt.depthTexture.format===Lo)S.framebufferTexture2D(36160,36096,3553,vr,0);else{if(Wt.depthTexture.format!==qs)throw new Error("Unknown depthTexture format");S.framebufferTexture2D(36160,33306,3553,vr,0)}}(an.__webglFramebuffer,dt)}else if(Tn){an.__webglDepthbuffer=[];for(let un=0;un<6;un++)c.bindFramebuffer(36160,an.__webglFramebuffer[un]),an.__webglDepthbuffer[un]=S.createRenderbuffer(),St(an.__webglDepthbuffer[un],dt,!1)}else c.bindFramebuffer(36160,an.__webglFramebuffer),an.__webglDepthbuffer=S.createRenderbuffer(),St(an.__webglDepthbuffer,dt,!1);c.bindFramebuffer(36160,null)}(Ze)},this.updateRenderTargetMipmap=function(Ze){const st=Ae(Ze)||O,Pt=!0===Ze.isWebGLMultipleRenderTargets?Ze.texture:[Ze.texture];for(let Gt=0,tn=Pt.length;Gt<tn;Gt++){const Mn=Pt[Gt];if(ke(Mn,st)){const Yn=Ze.isWebGLCubeRenderTarget?34067:3553,Vn=p.get(Mn).__webglTexture;c.bindTexture(Yn,Vn),Je(Yn,Mn,Ze.width,Ze.height),c.unbindTexture()}}},this.updateMultisampleRenderTarget=function(Ze){if(Ze.isWebGLMultisampleRenderTarget)if(O){const st=Ze.width,Pt=Ze.height;let Gt=16384;Ze.depthBuffer&&(Gt|=256),Ze.stencilBuffer&&(Gt|=1024);const tn=p.get(Ze);c.bindFramebuffer(36008,tn.__webglMultisampledFramebuffer),c.bindFramebuffer(36009,tn.__webglFramebuffer),S.blitFramebuffer(0,0,st,Pt,0,0,st,Pt,Gt,9728),c.bindFramebuffer(36008,null),c.bindFramebuffer(36009,tn.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Ze,st){Ze&&Ze.isWebGLRenderTarget&&(!1===It&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),It=!0),Ze=Ze.texture),Ut(Ze,st)},this.safeSetTextureCube=function(Ze,st){Ze&&Ze.isWebGLCubeRenderTarget&&(!1===ln&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),ln=!0),Ze=Ze.texture),Ht(Ze,st)}}function ef(S,e,c){const p=c.isWebGL2;return{convert:function(_){let w;if(_===oa)return 5121;if(_===Ou)return 32819;if(_===uu)return 32820;if(_===hu)return 33635;if(_===zl)return 5120;if(_===ka)return 5122;if(_===Dc)return 5123;if(_===Hp)return 5124;if(_===Ws)return 5125;if(_===qo)return 5126;if(_===ms)return p?5131:(w=e.get("OES_texture_half_float"),null!==w?w.HALF_FLOAT_OES:null);if(_===pp)return 6406;if(_===Is)return 6407;if(_===mo)return 6408;if(_===Uc)return 6409;if(_===ku)return 6410;if(_===Lo)return 6402;if(_===qs)return 34041;if(_===Vp)return 6403;if(_===el)return 36244;if(_===pu)return 33319;if(_===dp)return 33320;if(_===fp)return 36248;if(_===dh)return 36249;if(_===Ih||_===cc||_===Oh||_===fh){if(w=e.get("WEBGL_compressed_texture_s3tc"),null===w)return null;if(_===Ih)return w.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===cc)return w.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===Oh)return w.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===fh)return w.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(_===kh||_===yl||_===xl||_===jl){if(w=e.get("WEBGL_compressed_texture_pvrtc"),null===w)return null;if(_===kh)return w.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===yl)return w.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===xl)return w.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===jl)return w.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(_===Fu)return w=e.get("WEBGL_compressed_texture_etc1"),null!==w?w.COMPRESSED_RGB_ETC1_WEBGL:null;if((_===gs||_===Gl)&&(w=e.get("WEBGL_compressed_texture_etc"),null!==w)){if(_===gs)return w.COMPRESSED_RGB8_ETC2;if(_===Gl)return w.COMPRESSED_RGBA8_ETC2_EAC}return _===Du||_===mp||_===_p||_===zc||_===uc||_===mh||_===gp||_===Uu||_===zu||_===tl||_===Fh||_===nl||_===Dh||_===ju||_===pc||_===_h||_===du||_===jc||_===vp||_===Gc||_===Gu||_===Hl||_===yp||_===Uh||_===bp||_===xp||_===zh||_===Wp?(w=e.get("WEBGL_compressed_texture_astc"),null!==w?_:null):_===hc?(w=e.get("EXT_texture_compression_bptc"),null!==w?_:null):_===Ts?p?34042:(w=e.get("WEBGL_depth_texture"),null!==w?w.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class Cc extends Fo{constructor(e=[]){super(),this.cameras=e}}Cc.prototype.isArrayCamera=!0;class Eh extends Pr{constructor(){super(),this.type="Group"}}Eh.prototype.isGroup=!0;const Ji={type:"move"};class cn{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Eh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Eh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new at,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new at),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Eh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new at,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new at),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,c,p){let _=null,w=null,L=null;const O=this._targetRay,F=this._grip,U=this._hand;if(e&&"visible-blurred"!==c.session.visibilityState)if(null!==O&&(_=c.getPose(e.targetRaySpace,p),null!==_&&(O.matrix.fromArray(_.transform.matrix),O.matrix.decompose(O.position,O.rotation,O.scale),_.linearVelocity?(O.hasLinearVelocity=!0,O.linearVelocity.copy(_.linearVelocity)):O.hasLinearVelocity=!1,_.angularVelocity?(O.hasAngularVelocity=!0,O.angularVelocity.copy(_.angularVelocity)):O.hasAngularVelocity=!1,this.dispatchEvent(Ji))),U&&e.hand){L=!0;for(const Me of e.hand.values()){const Be=c.getJointPose(Me,p);if(void 0===U.joints[Me.jointName]){const ke=new Eh;ke.matrixAutoUpdate=!1,ke.visible=!1,U.joints[Me.jointName]=ke,U.add(ke)}const Ae=U.joints[Me.jointName];null!==Be&&(Ae.matrix.fromArray(Be.transform.matrix),Ae.matrix.decompose(Ae.position,Ae.rotation,Ae.scale),Ae.jointRadius=Be.radius),Ae.visible=null!==Be}const oe=U.joints["index-finger-tip"].position.distanceTo(U.joints["thumb-tip"].position),de=.02,ve=.005;U.inputState.pinching&&oe>de+ve?(U.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!U.inputState.pinching&&oe<=de-ve&&(U.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==F&&e.gripSpace&&(w=c.getPose(e.gripSpace,p),null!==w&&(F.matrix.fromArray(w.transform.matrix),F.matrix.decompose(F.position,F.rotation,F.scale),w.linearVelocity?(F.hasLinearVelocity=!0,F.linearVelocity.copy(w.linearVelocity)):F.hasLinearVelocity=!1,w.angularVelocity?(F.hasAngularVelocity=!0,F.angularVelocity.copy(w.angularVelocity)):F.hasAngularVelocity=!1));return null!==O&&(O.visible=null!==_),null!==F&&(F.visible=null!==w),null!==U&&(U.visible=null!==L),this}}class ed extends Os{constructor(e,c){super();const p=this,_=e.state;let w=null,L=1,O=null,F="local-floor",U=null,te=null,ce=null,oe=null,de=null,ve=!1,Me=null,Be=null,Ae=null,ke=null,Je=null,We=null;const rt=[],nt=new Map,gt=new Fo;gt.layers.enable(1),gt.viewport=new ji;const xt=new Fo;xt.layers.enable(2),xt.viewport=new ji;const Ut=[gt,xt],Ht=new Cc;Ht.layers.enable(1),Ht.layers.enable(2);let Ye=null,pt=null;function Vt(Ze){const st=nt.get(Ze.inputSource);st&&st.dispatchEvent({type:Ze.type,data:Ze.inputSource})}function Rt(){nt.forEach(function(Ze,st){Ze.disconnect(st)}),nt.clear(),Ye=null,pt=null,_.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),ce&&c.deleteFramebuffer(ce),Me&&c.deleteFramebuffer(Me),Be&&c.deleteRenderbuffer(Be),Ae&&c.deleteRenderbuffer(Ae),ce=null,Me=null,Be=null,Ae=null,de=null,oe=null,te=null,w=null,ln.stop(),p.isPresenting=!1,p.dispatchEvent({type:"sessionend"})}function lt(Ze){const st=w.inputSources;for(let Pt=0;Pt<rt.length;Pt++)nt.set(st[Pt],rt[Pt]);for(let Pt=0;Pt<Ze.removed.length;Pt++){const Gt=Ze.removed[Pt],tn=nt.get(Gt);tn&&(tn.dispatchEvent({type:"disconnected",data:Gt}),nt.delete(Gt))}for(let Pt=0;Pt<Ze.added.length;Pt++){const Gt=Ze.added[Pt],tn=nt.get(Gt);tn&&tn.dispatchEvent({type:"connected",data:Gt})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ze){let st=rt[Ze];return void 0===st&&(st=new cn,rt[Ze]=st),st.getTargetRaySpace()},this.getControllerGrip=function(Ze){let st=rt[Ze];return void 0===st&&(st=new cn,rt[Ze]=st),st.getGripSpace()},this.getHand=function(Ze){let st=rt[Ze];return void 0===st&&(st=new cn,rt[Ze]=st),st.getHandSpace()},this.setFramebufferScaleFactor=function(Ze){L=Ze,!0===p.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ze){F=Ze,!0===p.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return O},this.getBaseLayer=function(){return null!==oe?oe:de},this.getBinding=function(){return te},this.getFrame=function(){return ke},this.getSession=function(){return w},this.setSession=async function(Ze){if(w=Ze,null!==w){w.addEventListener("select",Vt),w.addEventListener("selectstart",Vt),w.addEventListener("selectend",Vt),w.addEventListener("squeeze",Vt),w.addEventListener("squeezestart",Vt),w.addEventListener("squeezeend",Vt),w.addEventListener("end",Rt),w.addEventListener("inputsourceschange",lt);const st=c.getContextAttributes();if(!0!==st.xrCompatible&&await c.makeXRCompatible(),void 0===w.renderState.layers)de=new XRWebGLLayer(w,c,{antialias:st.antialias,alpha:st.alpha,depth:st.depth,stencil:st.stencil,framebufferScaleFactor:L}),w.updateRenderState({baseLayer:de});else if(c instanceof WebGLRenderingContext)de=new XRWebGLLayer(w,c,{antialias:!0,alpha:st.alpha,depth:st.depth,stencil:st.stencil,framebufferScaleFactor:L}),w.updateRenderState({layers:[de]});else{ve=st.antialias;let Pt=null;st.depth&&(We=256,st.stencil&&(We|=1024),Je=st.stencil?33306:36096,Pt=st.stencil?35056:33190);const Gt={colorFormat:st.alpha?32856:32849,depthFormat:Pt,scaleFactor:L};te=new XRWebGLBinding(w,c),oe=te.createProjectionLayer(Gt),ce=c.createFramebuffer(),w.updateRenderState({layers:[oe]}),ve&&(Me=c.createFramebuffer(),Be=c.createRenderbuffer(),c.bindRenderbuffer(36161,Be),c.renderbufferStorageMultisample(36161,4,32856,oe.textureWidth,oe.textureHeight),_.bindFramebuffer(36160,Me),c.framebufferRenderbuffer(36160,36064,36161,Be),c.bindRenderbuffer(36161,null),null!==Pt&&(Ae=c.createRenderbuffer(),c.bindRenderbuffer(36161,Ae),c.renderbufferStorageMultisample(36161,4,Pt,oe.textureWidth,oe.textureHeight),c.framebufferRenderbuffer(36160,Je,36161,Ae),c.bindRenderbuffer(36161,null)),_.bindFramebuffer(36160,null))}O=await w.requestReferenceSpace(F),ln.setContext(w),ln.start(),p.isPresenting=!0,p.dispatchEvent({type:"sessionstart"})}};const Jt=new at,St=new at;function jt(Ze,st){null===st?Ze.matrixWorld.copy(Ze.matrix):Ze.matrixWorld.multiplyMatrices(st.matrixWorld,Ze.matrix),Ze.matrixWorldInverse.copy(Ze.matrixWorld).invert()}this.updateCamera=function(Ze){if(null===w)return;Ht.near=xt.near=gt.near=Ze.near,Ht.far=xt.far=gt.far=Ze.far,Ye===Ht.near&&pt===Ht.far||(w.updateRenderState({depthNear:Ht.near,depthFar:Ht.far}),Ye=Ht.near,pt=Ht.far);const st=Ze.parent,Pt=Ht.cameras;jt(Ht,st);for(let tn=0;tn<Pt.length;tn++)jt(Pt[tn],st);Ht.matrixWorld.decompose(Ht.position,Ht.quaternion,Ht.scale),Ze.position.copy(Ht.position),Ze.quaternion.copy(Ht.quaternion),Ze.scale.copy(Ht.scale),Ze.matrix.copy(Ht.matrix),Ze.matrixWorld.copy(Ht.matrixWorld);const Gt=Ze.children;for(let tn=0,Mn=Gt.length;tn<Mn;tn++)Gt[tn].updateMatrixWorld(!0);2===Pt.length?function(tn,Mn,Yn){Jt.setFromMatrixPosition(Mn.matrixWorld),St.setFromMatrixPosition(Yn.matrixWorld);const Vn=Jt.distanceTo(St),sn=Mn.projectionMatrix.elements,dt=Yn.projectionMatrix.elements,an=sn[14]/(sn[10]-1),Tn=sn[14]/(sn[10]+1),un=(sn[9]+1)/sn[5],Wt=(sn[9]-1)/sn[5],vr=(sn[8]-1)/sn[0],hr=(dt[8]+1)/dt[0],Br=an*vr,zi=an*hr,bo=Vn/(-vr+hr),_l=bo*-vr;Mn.matrixWorld.decompose(tn.position,tn.quaternion,tn.scale),tn.translateX(_l),tn.translateZ(bo),tn.matrixWorld.compose(tn.position,tn.quaternion,tn.scale),tn.matrixWorldInverse.copy(tn.matrixWorld).invert();const Wo=an+bo,gl=Tn+bo;tn.projectionMatrix.makePerspective(Br-_l,zi+(Vn-_l),un*Tn/gl*Wo,Wt*Tn/gl*Wo,Wo,gl)}(Ht,gt,xt):Ht.projectionMatrix.copy(gt.projectionMatrix)},this.getCamera=function(){return Ht},this.getFoveation=function(){return null!==oe?oe.fixedFoveation:null!==de?de.fixedFoveation:void 0},this.setFoveation=function(Ze){null!==oe&&(oe.fixedFoveation=Ze),null!==de&&void 0!==de.fixedFoveation&&(de.fixedFoveation=Ze)};let It=null;const ln=new Ac;ln.setAnimationLoop(function(Ze,st){if(U=st.getViewerPose(O),ke=st,null!==U){const Gt=U.views;null!==de&&_.bindXRFramebuffer(de.framebuffer);let tn=!1;Gt.length!==Ht.cameras.length&&(Ht.cameras.length=0,tn=!0);for(let Mn=0;Mn<Gt.length;Mn++){const Yn=Gt[Mn];let Vn=null;if(null!==de)Vn=de.getViewport(Yn);else{const dt=te.getViewSubImage(oe,Yn);_.bindXRFramebuffer(ce),void 0!==dt.depthStencilTexture&&c.framebufferTexture2D(36160,Je,3553,dt.depthStencilTexture,0),c.framebufferTexture2D(36160,36064,3553,dt.colorTexture,0),Vn=dt.viewport}const sn=Ut[Mn];sn.matrix.fromArray(Yn.transform.matrix),sn.projectionMatrix.fromArray(Yn.projectionMatrix),sn.viewport.set(Vn.x,Vn.y,Vn.width,Vn.height),0===Mn&&Ht.matrix.copy(sn.matrix),!0===tn&&Ht.cameras.push(sn)}ve&&(_.bindXRFramebuffer(Me),null!==We&&c.clear(We))}const Pt=w.inputSources;for(let Gt=0;Gt<rt.length;Gt++)rt[Gt].update(Pt[Gt],st,O);if(It&&It(Ze,st),ve){const Gt=oe.textureWidth,tn=oe.textureHeight;_.bindFramebuffer(36008,Me),_.bindFramebuffer(36009,ce),c.invalidateFramebuffer(36008,[Je]),c.invalidateFramebuffer(36009,[Je]),c.blitFramebuffer(0,0,Gt,tn,0,0,Gt,tn,16384,9728),c.invalidateFramebuffer(36008,[36064]),_.bindFramebuffer(36008,null),_.bindFramebuffer(36009,null),_.bindFramebuffer(36160,Me)}ke=null}),this.setAnimationLoop=function(Ze){It=Ze},this.dispose=function(){}}}function cs(S){function e(p,_){p.opacity.value=_.opacity,_.color&&p.diffuse.value.copy(_.color),_.emissive&&p.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(p.map.value=_.map),_.alphaMap&&(p.alphaMap.value=_.alphaMap),_.specularMap&&(p.specularMap.value=_.specularMap),_.alphaTest>0&&(p.alphaTest.value=_.alphaTest);const w=S.get(_).envMap;if(w){p.envMap.value=w,p.flipEnvMap.value=w.isCubeTexture&&!1===w.isRenderTargetTexture?-1:1,p.reflectivity.value=_.reflectivity,p.ior.value=_.ior,p.refractionRatio.value=_.refractionRatio;const F=S.get(w).__maxMipLevel;void 0!==F&&(p.maxMipLevel.value=F)}let L,O;_.lightMap&&(p.lightMap.value=_.lightMap,p.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(p.aoMap.value=_.aoMap,p.aoMapIntensity.value=_.aoMapIntensity),_.map?L=_.map:_.specularMap?L=_.specularMap:_.displacementMap?L=_.displacementMap:_.normalMap?L=_.normalMap:_.bumpMap?L=_.bumpMap:_.roughnessMap?L=_.roughnessMap:_.metalnessMap?L=_.metalnessMap:_.alphaMap?L=_.alphaMap:_.emissiveMap?L=_.emissiveMap:_.clearcoatMap?L=_.clearcoatMap:_.clearcoatNormalMap?L=_.clearcoatNormalMap:_.clearcoatRoughnessMap?L=_.clearcoatRoughnessMap:_.specularIntensityMap?L=_.specularIntensityMap:_.specularTintMap?L=_.specularTintMap:_.transmissionMap?L=_.transmissionMap:_.thicknessMap&&(L=_.thicknessMap),void 0!==L&&(L.isWebGLRenderTarget&&(L=L.texture),!0===L.matrixAutoUpdate&&L.updateMatrix(),p.uvTransform.value.copy(L.matrix)),_.aoMap?O=_.aoMap:_.lightMap&&(O=_.lightMap),void 0!==O&&(O.isWebGLRenderTarget&&(O=O.texture),!0===O.matrixAutoUpdate&&O.updateMatrix(),p.uv2Transform.value.copy(O.matrix))}function c(p,_){p.roughness.value=_.roughness,p.metalness.value=_.metalness,_.roughnessMap&&(p.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(p.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(p.emissiveMap.value=_.emissiveMap),_.bumpMap&&(p.bumpMap.value=_.bumpMap,p.bumpScale.value=_.bumpScale,_.side===W&&(p.bumpScale.value*=-1)),_.normalMap&&(p.normalMap.value=_.normalMap,p.normalScale.value.copy(_.normalScale),_.side===W&&p.normalScale.value.negate()),_.displacementMap&&(p.displacementMap.value=_.displacementMap,p.displacementScale.value=_.displacementScale,p.displacementBias.value=_.displacementBias),S.get(_).envMap&&(p.envMapIntensity.value=_.envMapIntensity)}return{refreshFogUniforms:function(p,_){p.fogColor.value.copy(_.color),_.isFog?(p.fogNear.value=_.near,p.fogFar.value=_.far):_.isFogExp2&&(p.fogDensity.value=_.density)},refreshMaterialUniforms:function(p,_,w,L,O){var U;_.isMeshBasicMaterial?e(p,_):_.isMeshLambertMaterial?(e(p,_),(U=_).emissiveMap&&(p.emissiveMap.value=U.emissiveMap)):_.isMeshToonMaterial?(e(p,_),function(F,U){U.gradientMap&&(F.gradientMap.value=U.gradientMap),U.emissiveMap&&(F.emissiveMap.value=U.emissiveMap),U.bumpMap&&(F.bumpMap.value=U.bumpMap,F.bumpScale.value=U.bumpScale,U.side===W&&(F.bumpScale.value*=-1)),U.normalMap&&(F.normalMap.value=U.normalMap,F.normalScale.value.copy(U.normalScale),U.side===W&&F.normalScale.value.negate()),U.displacementMap&&(F.displacementMap.value=U.displacementMap,F.displacementScale.value=U.displacementScale,F.displacementBias.value=U.displacementBias)}(p,_)):_.isMeshPhongMaterial?(e(p,_),function(F,U){F.specular.value.copy(U.specular),F.shininess.value=Math.max(U.shininess,1e-4),U.emissiveMap&&(F.emissiveMap.value=U.emissiveMap),U.bumpMap&&(F.bumpMap.value=U.bumpMap,F.bumpScale.value=U.bumpScale,U.side===W&&(F.bumpScale.value*=-1)),U.normalMap&&(F.normalMap.value=U.normalMap,F.normalScale.value.copy(U.normalScale),U.side===W&&F.normalScale.value.negate()),U.displacementMap&&(F.displacementMap.value=U.displacementMap,F.displacementScale.value=U.displacementScale,F.displacementBias.value=U.displacementBias)}(p,_)):_.isMeshStandardMaterial?(e(p,_),_.isMeshPhysicalMaterial?function(F,U,te){c(F,U),F.ior.value=U.ior,U.sheenTint&&F.sheenTint.value.copy(U.sheenTint),U.clearcoat>0&&(F.clearcoat.value=U.clearcoat,F.clearcoatRoughness.value=U.clearcoatRoughness,U.clearcoatMap&&(F.clearcoatMap.value=U.clearcoatMap),U.clearcoatRoughnessMap&&(F.clearcoatRoughnessMap.value=U.clearcoatRoughnessMap),U.clearcoatNormalMap&&(F.clearcoatNormalScale.value.copy(U.clearcoatNormalScale),F.clearcoatNormalMap.value=U.clearcoatNormalMap,U.side===W&&F.clearcoatNormalScale.value.negate())),U.transmission>0&&(F.transmission.value=U.transmission,F.transmissionSamplerMap.value=te.texture,F.transmissionSamplerSize.value.set(te.width,te.height),U.transmissionMap&&(F.transmissionMap.value=U.transmissionMap),F.thickness.value=U.thickness,U.thicknessMap&&(F.thicknessMap.value=U.thicknessMap),F.attenuationDistance.value=U.attenuationDistance,F.attenuationTint.value.copy(U.attenuationTint)),F.specularIntensity.value=U.specularIntensity,F.specularTint.value.copy(U.specularTint),U.specularIntensityMap&&(F.specularIntensityMap.value=U.specularIntensityMap),U.specularTintMap&&(F.specularTintMap.value=U.specularTintMap)}(p,_,O):c(p,_)):_.isMeshMatcapMaterial?(e(p,_),function(F,U){U.matcap&&(F.matcap.value=U.matcap),U.bumpMap&&(F.bumpMap.value=U.bumpMap,F.bumpScale.value=U.bumpScale,U.side===W&&(F.bumpScale.value*=-1)),U.normalMap&&(F.normalMap.value=U.normalMap,F.normalScale.value.copy(U.normalScale),U.side===W&&F.normalScale.value.negate()),U.displacementMap&&(F.displacementMap.value=U.displacementMap,F.displacementScale.value=U.displacementScale,F.displacementBias.value=U.displacementBias)}(p,_)):_.isMeshDepthMaterial?(e(p,_),function(F,U){U.displacementMap&&(F.displacementMap.value=U.displacementMap,F.displacementScale.value=U.displacementScale,F.displacementBias.value=U.displacementBias)}(p,_)):_.isMeshDistanceMaterial?(e(p,_),function(F,U){U.displacementMap&&(F.displacementMap.value=U.displacementMap,F.displacementScale.value=U.displacementScale,F.displacementBias.value=U.displacementBias),F.referencePosition.value.copy(U.referencePosition),F.nearDistance.value=U.nearDistance,F.farDistance.value=U.farDistance}(p,_)):_.isMeshNormalMaterial?(e(p,_),function(F,U){U.bumpMap&&(F.bumpMap.value=U.bumpMap,F.bumpScale.value=U.bumpScale,U.side===W&&(F.bumpScale.value*=-1)),U.normalMap&&(F.normalMap.value=U.normalMap,F.normalScale.value.copy(U.normalScale),U.side===W&&F.normalScale.value.negate()),U.displacementMap&&(F.displacementMap.value=U.displacementMap,F.displacementScale.value=U.displacementScale,F.displacementBias.value=U.displacementBias)}(p,_)):_.isLineBasicMaterial?(function(F,U){F.diffuse.value.copy(U.color),F.opacity.value=U.opacity}(p,_),_.isLineDashedMaterial&&function(F,U){F.dashSize.value=U.dashSize,F.totalSize.value=U.dashSize+U.gapSize,F.scale.value=U.scale}(p,_)):_.isPointsMaterial?function(F,U,te,ce){let oe;F.diffuse.value.copy(U.color),F.opacity.value=U.opacity,F.size.value=U.size*te,F.scale.value=.5*ce,U.map&&(F.map.value=U.map),U.alphaMap&&(F.alphaMap.value=U.alphaMap),U.alphaTest>0&&(F.alphaTest.value=U.alphaTest),U.map?oe=U.map:U.alphaMap&&(oe=U.alphaMap),void 0!==oe&&(!0===oe.matrixAutoUpdate&&oe.updateMatrix(),F.uvTransform.value.copy(oe.matrix))}(p,_,w,L):_.isSpriteMaterial?function(F,U){let te;F.diffuse.value.copy(U.color),F.opacity.value=U.opacity,F.rotation.value=U.rotation,U.map&&(F.map.value=U.map),U.alphaMap&&(F.alphaMap.value=U.alphaMap),U.alphaTest>0&&(F.alphaTest.value=U.alphaTest),U.map?te=U.map:U.alphaMap&&(te=U.alphaMap),void 0!==te&&(!0===te.matrixAutoUpdate&&te.updateMatrix(),F.uvTransform.value.copy(te.matrix))}(p,_):_.isShadowMaterial?(p.color.value.copy(_.color),p.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}}}function Ir(S={}){const e=void 0!==S.canvas?S.canvas:function(){const mt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return mt.style.display="block",mt}(),c=void 0!==S.context?S.context:null,p=void 0!==S.alpha&&S.alpha,_=void 0===S.depth||S.depth,w=void 0===S.stencil||S.stencil,L=void 0!==S.antialias&&S.antialias,O=void 0===S.premultipliedAlpha||S.premultipliedAlpha,F=void 0!==S.preserveDrawingBuffer&&S.preserveDrawingBuffer,U=void 0!==S.powerPreference?S.powerPreference:"default",te=void 0!==S.failIfMajorPerformanceCaveat&&S.failIfMajorPerformanceCaveat;let ce=null,oe=null;const de=[],ve=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ki,this.physicallyCorrectLights=!1,this.toneMapping=mr,this.toneMappingExposure=1;const Me=this;let Be=!1,Ae=0,ke=0,Je=null,We=-1,rt=null;const nt=new ji,gt=new ji;let xt=null,Ut=e.width,Ht=e.height,Ye=1,pt=null,Vt=null;const Rt=new ji(0,0,Ut,Ht),lt=new ji(0,0,Ut,Ht);let Jt=!1;const St=[],jt=new Dr;let It=!1,ln=!1,Ze=null;const st=new Kt,Pt=new at,Gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function tn(){return null===Je?Ye:1}let Mn,Yn,Vn,sn,dt,an,Tn,un,Wt,vr,hr,Br,zi,bo,_l,Wo,gl,lu,hp,Id,Od,hh,vl,Hn=c;function Mt(mt,xn){for(let en=0;en<mt.length;en++){const jn=e.getContext(mt[en],xn);if(null!==jn)return jn}return null}try{const mt={alpha:p,depth:_,stencil:w,antialias:L,premultipliedAlpha:O,preserveDrawingBuffer:F,powerPreference:U,failIfMajorPerformanceCaveat:te};if(e.addEventListener("webglcontextlost",Fn,!1),e.addEventListener("webglcontextrestored",pr,!1),null===Hn){const xn=["webgl2","webgl","experimental-webgl"];if(!0===Me.isWebGL1Renderer&&xn.shift(),Hn=Mt(xn,mt),null===Hn)throw Mt(xn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Hn.getShaderPrecisionFormat&&(Hn.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(mt){throw console.error("THREE.WebGLRenderer: "+mt.message),mt}function In(){Mn=new Pn(Hn),Yn=new Zc(Hn,Mn,S),Mn.init(Yn),hh=new ef(Hn,Mn,Yn),Vn=new um(Hn,Mn,Yn),St[0]=1029,sn=new Ar(Hn),dt=new xd,an=new Fm(Hn,Mn,Vn,dt,Yn,hh,sn),Tn=new hl(Me),un=new qt(Me),Wt=new qp(Hn,Yn),vl=new Bo(Hn,Mn,Wt,Yn),vr=new En(Hn,Wt,sn,vl),hr=new No(Hn,vr,Wt,sn),hp=new Zt(Hn),Wo=new wu(dt),Br=new Qp(Me,Tn,un,Mn,Yn,vl,Wo),zi=new cs(dt),bo=new hf(dt),_l=new Wa(Mn,Yn),lu=new Jc(Me,Tn,Vn,hr,O),gl=new Kd(Me,hr,Yn),Id=new Wn(Hn,Mn,sn,Yn),Od=new Gn(Hn,Mn,sn,Yn),sn.programs=Br.programs,Me.capabilities=Yn,Me.extensions=Mn,Me.properties=dt,Me.renderLists=bo,Me.shadowMap=gl,Me.state=Vn,Me.info=sn}In();const hn=new ed(Me,Hn);function Fn(mt){mt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Be=!0}function pr(){console.log("THREE.WebGLRenderer: Context Restored."),Be=!1;const mt=sn.autoReset,xn=gl.enabled,en=gl.autoUpdate,bn=gl.needsUpdate,jn=gl.type;In(),sn.autoReset=mt,gl.enabled=xn,gl.autoUpdate=en,gl.needsUpdate=bn,gl.type=jn}function Mi(mt){const xn=mt.target;var en;xn.removeEventListener("dispose",Mi),function(bn){const jn=dt.get(bn).programs;void 0!==jn&&jn.forEach(function(Ei){Br.releaseProgram(Ei)})}(en=xn),dt.remove(en)}this.xr=hn,this.getContext=function(){return Hn},this.getContextAttributes=function(){return Hn.getContextAttributes()},this.forceContextLoss=function(){const mt=Mn.get("WEBGL_lose_context");mt&&mt.loseContext()},this.forceContextRestore=function(){const mt=Mn.get("WEBGL_lose_context");mt&&mt.restoreContext()},this.getPixelRatio=function(){return Ye},this.setPixelRatio=function(mt){void 0!==mt&&(Ye=mt,this.setSize(Ut,Ht,!1))},this.getSize=function(mt){return mt.set(Ut,Ht)},this.setSize=function(mt,xn,en){hn.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Ut=mt,Ht=xn,e.width=Math.floor(mt*Ye),e.height=Math.floor(xn*Ye),!1!==en&&(e.style.width=mt+"px",e.style.height=xn+"px"),this.setViewport(0,0,mt,xn))},this.getDrawingBufferSize=function(mt){return mt.set(Ut*Ye,Ht*Ye).floor()},this.setDrawingBufferSize=function(mt,xn,en){Ut=mt,Ht=xn,Ye=en,e.width=Math.floor(mt*en),e.height=Math.floor(xn*en),this.setViewport(0,0,mt,xn)},this.getCurrentViewport=function(mt){return mt.copy(nt)},this.getViewport=function(mt){return mt.copy(Rt)},this.setViewport=function(mt,xn,en,bn){mt.isVector4?Rt.set(mt.x,mt.y,mt.z,mt.w):Rt.set(mt,xn,en,bn),Vn.viewport(nt.copy(Rt).multiplyScalar(Ye).floor())},this.getScissor=function(mt){return mt.copy(lt)},this.setScissor=function(mt,xn,en,bn){mt.isVector4?lt.set(mt.x,mt.y,mt.z,mt.w):lt.set(mt,xn,en,bn),Vn.scissor(gt.copy(lt).multiplyScalar(Ye).floor())},this.getScissorTest=function(){return Jt},this.setScissorTest=function(mt){Vn.setScissorTest(Jt=mt)},this.setOpaqueSort=function(mt){pt=mt},this.setTransparentSort=function(mt){Vt=mt},this.getClearColor=function(mt){return mt.copy(lu.getClearColor())},this.setClearColor=function(){lu.setClearColor.apply(lu,arguments)},this.getClearAlpha=function(){return lu.getClearAlpha()},this.setClearAlpha=function(){lu.setClearAlpha.apply(lu,arguments)},this.clear=function(mt,xn,en){let bn=0;(void 0===mt||mt)&&(bn|=16384),(void 0===xn||xn)&&(bn|=256),(void 0===en||en)&&(bn|=1024),Hn.clear(bn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Fn,!1),e.removeEventListener("webglcontextrestored",pr,!1),bo.dispose(),_l.dispose(),dt.dispose(),Tn.dispose(),un.dispose(),hr.dispose(),vl.dispose(),hn.dispose(),hn.removeEventListener("sessionstart",oi),hn.removeEventListener("sessionend",ws),Ze&&(Ze.dispose(),Ze=null),is.stop()},this.renderBufferImmediate=function(mt,xn){vl.initAttributes();const en=dt.get(mt);mt.hasPositions&&!en.position&&(en.position=Hn.createBuffer()),mt.hasNormals&&!en.normal&&(en.normal=Hn.createBuffer()),mt.hasUvs&&!en.uv&&(en.uv=Hn.createBuffer()),mt.hasColors&&!en.color&&(en.color=Hn.createBuffer());const bn=xn.getAttributes();mt.hasPositions&&(Hn.bindBuffer(34962,en.position),Hn.bufferData(34962,mt.positionArray,35048),vl.enableAttribute(bn.position.location),Hn.vertexAttribPointer(bn.position.location,3,5126,!1,0,0)),mt.hasNormals&&(Hn.bindBuffer(34962,en.normal),Hn.bufferData(34962,mt.normalArray,35048),vl.enableAttribute(bn.normal.location),Hn.vertexAttribPointer(bn.normal.location,3,5126,!1,0,0)),mt.hasUvs&&(Hn.bindBuffer(34962,en.uv),Hn.bufferData(34962,mt.uvArray,35048),vl.enableAttribute(bn.uv.location),Hn.vertexAttribPointer(bn.uv.location,2,5126,!1,0,0)),mt.hasColors&&(Hn.bindBuffer(34962,en.color),Hn.bufferData(34962,mt.colorArray,35048),vl.enableAttribute(bn.color.location),Hn.vertexAttribPointer(bn.color.location,3,5126,!1,0,0)),vl.disableUnusedAttributes(),Hn.drawArrays(4,0,mt.count),mt.count=0},this.renderBufferDirect=function(mt,xn,en,bn,jn,Ei){null===xn&&(xn=Gt);const jr=jn.isMesh&&jn.matrixWorld.determinant()<0,Pi=cu(mt,xn,bn,jn);Vn.setMaterial(bn,jr);let so=en.index;const Es=en.attributes.position;if(null===so){if(void 0===Es||0===Es.count)return}else if(0===so.count)return;let zo,ao=1;!0===bn.wireframe&&(so=vr.getWireframeAttribute(en),ao=2),void 0===en.morphAttributes.position&&void 0===en.morphAttributes.normal||hp.update(jn,en,bn,Pi),vl.setup(jn,bn,Pi,en,so);let Ii=Id;null!==so&&(zo=Wt.get(so),Ii=Od,Ii.setIndex(zo));const Wf=null!==so?so.count:Es.count,Qa=en.drawRange.start*ao,xf=en.drawRange.count*ao,dd=null!==Ei?Ei.start*ao:0,qf=null!==Ei?Ei.count*ao:1/0,wf=Math.max(Qa,dd),kc=Math.min(Wf,Qa+xf,dd+qf)-1,kd=Math.max(0,kc-wf+1);if(0!==kd){if(jn.isMesh)!0===bn.wireframe?(Vn.setLineWidth(bn.wireframeLinewidth*tn()),Ii.setMode(1)):Ii.setMode(4);else if(jn.isLine){let Pu=bn.linewidth;void 0===Pu&&(Pu=1),Vn.setLineWidth(Pu*tn()),Ii.setMode(jn.isLineSegments?1:jn.isLineLoop?2:3)}else jn.isPoints?Ii.setMode(0):jn.isSprite&&Ii.setMode(4);if(jn.isInstancedMesh)Ii.renderInstances(wf,kd,jn.count);else if(en.isInstancedBufferGeometry){const Pu=Math.min(en.instanceCount,en._maxInstanceCount);Ii.renderInstances(wf,kd,Pu)}else Ii.render(wf,kd)}},this.compile=function(mt,xn){oe=_l.get(mt),oe.init(),ve.push(oe),mt.traverseVisible(function(en){en.isLight&&en.layers.test(xn.layers)&&(oe.pushLight(en),en.castShadow&&oe.pushShadow(en))}),oe.setupLights(Me.physicallyCorrectLights),mt.traverse(function(en){const bn=en.material;if(bn)if(Array.isArray(bn))for(let jn=0;jn<bn.length;jn++)Ia(bn[jn],mt,en);else Ia(bn,mt,en)}),ve.pop(),oe=null};let Ni=null;function oi(){is.stop()}function ws(){is.start()}const is=new Ac;function ra(mt,xn,en,bn){if(!1===mt.visible)return;if(mt.layers.test(xn.layers))if(mt.isGroup)en=mt.renderOrder;else if(mt.isLOD)!0===mt.autoUpdate&&mt.update(xn);else if(mt.isLight)oe.pushLight(mt),mt.castShadow&&oe.pushShadow(mt);else if(mt.isSprite){if(!mt.frustumCulled||jt.intersectsSprite(mt)){bn&&Pt.setFromMatrixPosition(mt.matrixWorld).applyMatrix4(st);const Ei=hr.update(mt),jr=mt.material;jr.visible&&ce.push(mt,Ei,jr,en,Pt.z,null)}}else if(mt.isImmediateRenderObject)bn&&Pt.setFromMatrixPosition(mt.matrixWorld).applyMatrix4(st),ce.push(mt,null,mt.material,en,Pt.z,null);else if((mt.isMesh||mt.isLine||mt.isPoints)&&(mt.isSkinnedMesh&&mt.skeleton.frame!==sn.render.frame&&(mt.skeleton.update(),mt.skeleton.frame=sn.render.frame),!mt.frustumCulled||jt.intersectsObject(mt))){bn&&Pt.setFromMatrixPosition(mt.matrixWorld).applyMatrix4(st);const Ei=hr.update(mt),jr=mt.material;if(Array.isArray(jr)){const Pi=Ei.groups;for(let so=0,Es=Pi.length;so<Es;so++){const zo=Pi[so],ao=jr[zo.materialIndex];ao&&ao.visible&&ce.push(mt,Ei,ao,en,Pt.z,zo)}}else jr.visible&&ce.push(mt,Ei,jr,en,Pt.z,null)}const jn=mt.children;for(let Ei=0,jr=jn.length;Ei<jr;Ei++)ra(jn[Ei],xn,en,bn)}function Ss(mt,xn,en,bn){const jn=mt.opaque,Ei=mt.transmissive,jr=mt.transparent;oe.setupLightsView(en),Ei.length>0&&function(Pi,so,Es){null===Ze&&(Ze=new(!0===L&&!0===Yn.isWebGL2?Vc:lo)(1024,1024,{generateMipmaps:!0,type:null!==hh.convert(ms)?ms:oa,minFilter:Ka,magFilter:Or,wrapS:Yr,wrapT:Yr}));const zo=Me.getRenderTarget();Me.setRenderTarget(Ze),Me.clear();const ao=Me.toneMapping;Me.toneMapping=mr,Ri(Pi,so,Es),Me.toneMapping=ao,an.updateMultisampleRenderTarget(Ze),an.updateRenderTargetMipmap(Ze),Me.setRenderTarget(zo)}(jn,xn,en),bn&&Vn.viewport(nt.copy(bn)),jn.length>0&&Ri(jn,xn,en),Ei.length>0&&Ri(Ei,xn,en),jr.length>0&&Ri(jr,xn,en)}function Ri(mt,xn,en){const bn=!0===xn.isScene?xn.overrideMaterial:null;for(let jn=0,Ei=mt.length;jn<Ei;jn++){const jr=mt[jn],Pi=jr.object,so=jr.geometry,Es=null===bn?jr.material:bn,zo=jr.group;Pi.layers.test(en.layers)&&ya(Pi,xn,en,so,Es,zo)}}function ya(mt,xn,en,bn,jn,Ei){if(mt.onBeforeRender(Me,xn,en,bn,jn,Ei),mt.modelViewMatrix.multiplyMatrices(en.matrixWorldInverse,mt.matrixWorld),mt.normalMatrix.getNormalMatrix(mt.modelViewMatrix),mt.isImmediateRenderObject){const jr=cu(en,xn,jn,mt);Vn.setMaterial(jn),vl.reset(),so=jr,mt.render(function(Es){Me.renderBufferImmediate(Es,so)})}else!0===jn.transparent&&jn.side===Q?(jn.side=W,jn.needsUpdate=!0,Me.renderBufferDirect(en,xn,bn,jn,mt,Ei),jn.side=ie,jn.needsUpdate=!0,Me.renderBufferDirect(en,xn,bn,jn,mt,Ei),jn.side=Q):Me.renderBufferDirect(en,xn,bn,jn,mt,Ei);var so;mt.onAfterRender(Me,xn,en,bn,jn,Ei)}function Ia(mt,xn,en){!0!==xn.isScene&&(xn=Gt);const bn=dt.get(mt),jn=oe.state.lights,jr=jn.state.version,Pi=Br.getParameters(mt,jn.state,oe.state.shadowsArray,xn,en),so=Br.getProgramCacheKey(Pi);let Es=bn.programs;bn.environment=mt.isMeshStandardMaterial?xn.environment:null,bn.fog=xn.fog,bn.envMap=(mt.isMeshStandardMaterial?un:Tn).get(mt.envMap||bn.environment),void 0===Es&&(mt.addEventListener("dispose",Mi),Es=new Map,bn.programs=Es);let zo=Es.get(so);if(void 0!==zo){if(bn.currentProgram===zo&&bn.lightsStateVersion===jr)return Zo(mt,Pi),zo}else Pi.uniforms=Br.getUniforms(mt),mt.onBuild(Pi,Me),mt.onBeforeCompile(Pi,Me),zo=Br.acquireProgram(Pi,so),Es.set(so,zo),bn.uniforms=Pi.uniforms;const ao=bn.uniforms;var Qa;(mt.isShaderMaterial||mt.isRawShaderMaterial)&&!0!==mt.clipping||(ao.clippingPlanes=Wo.uniform),Zo(mt,Pi),bn.needsLights=(Qa=mt).isMeshLambertMaterial||Qa.isMeshToonMaterial||Qa.isMeshPhongMaterial||Qa.isMeshStandardMaterial||Qa.isShadowMaterial||Qa.isShaderMaterial&&!0===Qa.lights,bn.lightsStateVersion=jr,bn.needsLights&&(ao.ambientLightColor.value=jn.state.ambient,ao.lightProbe.value=jn.state.probe,ao.directionalLights.value=jn.state.directional,ao.directionalLightShadows.value=jn.state.directionalShadow,ao.spotLights.value=jn.state.spot,ao.spotLightShadows.value=jn.state.spotShadow,ao.rectAreaLights.value=jn.state.rectArea,ao.ltc_1.value=jn.state.rectAreaLTC1,ao.ltc_2.value=jn.state.rectAreaLTC2,ao.pointLights.value=jn.state.point,ao.pointLightShadows.value=jn.state.pointShadow,ao.hemisphereLights.value=jn.state.hemi,ao.directionalShadowMap.value=jn.state.directionalShadowMap,ao.directionalShadowMatrix.value=jn.state.directionalShadowMatrix,ao.spotShadowMap.value=jn.state.spotShadowMap,ao.spotShadowMatrix.value=jn.state.spotShadowMatrix,ao.pointShadowMap.value=jn.state.pointShadowMap,ao.pointShadowMatrix.value=jn.state.pointShadowMatrix);const Ii=zo.getUniforms(),Wf=Nl.seqWithValue(Ii.seq,ao);return bn.currentProgram=zo,bn.uniformsList=Wf,zo}function Zo(mt,xn){const en=dt.get(mt);en.outputEncoding=xn.outputEncoding,en.instancing=xn.instancing,en.skinning=xn.skinning,en.morphTargets=xn.morphTargets,en.morphNormals=xn.morphNormals,en.numClippingPlanes=xn.numClippingPlanes,en.numIntersection=xn.numClipIntersection,en.vertexAlphas=xn.vertexAlphas,en.vertexTangents=xn.vertexTangents}function cu(mt,xn,en,bn){!0!==xn.isScene&&(xn=Gt),an.resetTextureUnits();const jn=xn.fog,jr=null===Je?Me.outputEncoding:Je.texture.encoding,Pi=(en.isMeshStandardMaterial?un:Tn).get(en.envMap||(en.isMeshStandardMaterial?xn.environment:null)),so=!0===en.vertexColors&&!!bn.geometry&&!!bn.geometry.attributes.color&&4===bn.geometry.attributes.color.itemSize,Es=!!bn.geometry&&!!bn.geometry.attributes.tangent,zo=!!bn.geometry&&!!bn.geometry.morphAttributes.position,ao=!!bn.geometry&&!!bn.geometry.morphAttributes.normal,Ii=dt.get(en),Wf=oe.state.lights;!0!==It||!0!==ln&&mt===rt||Wo.setState(en,mt,mt===rt&&en.id===We);let Qa=!1;en.version===Ii.__version?Ii.needsLights&&Ii.lightsStateVersion!==Wf.state.version||Ii.outputEncoding!==jr||bn.isInstancedMesh&&!1===Ii.instancing?Qa=!0:bn.isInstancedMesh||!0!==Ii.instancing?bn.isSkinnedMesh&&!1===Ii.skinning?Qa=!0:bn.isSkinnedMesh||!0!==Ii.skinning?Ii.envMap!==Pi||en.fog&&Ii.fog!==jn?Qa=!0:void 0===Ii.numClippingPlanes||Ii.numClippingPlanes===Wo.numPlanes&&Ii.numIntersection===Wo.numIntersection?(Ii.vertexAlphas!==so||Ii.vertexTangents!==Es||Ii.morphTargets!==zo||Ii.morphNormals!==ao)&&(Qa=!0):Qa=!0:Qa=!0:Qa=!0:(Qa=!0,Ii.__version=en.version);let xf=Ii.currentProgram;!0===Qa&&(xf=Ia(en,xn,bn));let dd=!1,qf=!1,wf=!1;const kc=xf.getUniforms(),kd=Ii.uniforms;if(Vn.useProgram(xf.program)&&(dd=!0,qf=!0,wf=!0),en.id!==We&&(We=en.id,qf=!0),dd||rt!==mt){if(kc.setValue(Hn,"projectionMatrix",mt.projectionMatrix),Yn.logarithmicDepthBuffer&&kc.setValue(Hn,"logDepthBufFC",2/(Math.log(mt.far+1)/Math.LN2)),rt!==mt&&(rt=mt,qf=!0,wf=!0),en.isShaderMaterial||en.isMeshPhongMaterial||en.isMeshToonMaterial||en.isMeshStandardMaterial||en.envMap){const md=kc.map.cameraPosition;void 0!==md&&md.setValue(Hn,Pt.setFromMatrixPosition(mt.matrixWorld))}(en.isMeshPhongMaterial||en.isMeshToonMaterial||en.isMeshLambertMaterial||en.isMeshBasicMaterial||en.isMeshStandardMaterial||en.isShaderMaterial)&&kc.setValue(Hn,"isOrthographic",!0===mt.isOrthographicCamera),(en.isMeshPhongMaterial||en.isMeshToonMaterial||en.isMeshLambertMaterial||en.isMeshBasicMaterial||en.isMeshStandardMaterial||en.isShaderMaterial||en.isShadowMaterial||bn.isSkinnedMesh)&&kc.setValue(Hn,"viewMatrix",mt.matrixWorldInverse)}if(bn.isSkinnedMesh){kc.setOptional(Hn,bn,"bindMatrix"),kc.setOptional(Hn,bn,"bindMatrixInverse");const md=bn.skeleton;md&&(Yn.floatVertexTextures?(null===md.boneTexture&&md.computeBoneTexture(),kc.setValue(Hn,"boneTexture",md.boneTexture,an),kc.setValue(Hn,"boneTextureSize",md.boneTextureSize)):kc.setOptional(Hn,md,"boneMatrices"))}var Pu,fd;return(qf||Ii.receiveShadow!==bn.receiveShadow)&&(Ii.receiveShadow=bn.receiveShadow,kc.setValue(Hn,"receiveShadow",bn.receiveShadow)),qf&&(kc.setValue(Hn,"toneMappingExposure",Me.toneMappingExposure),Ii.needsLights&&((Pu=kd).ambientLightColor.needsUpdate=fd=wf,Pu.lightProbe.needsUpdate=fd,Pu.directionalLights.needsUpdate=fd,Pu.directionalLightShadows.needsUpdate=fd,Pu.pointLights.needsUpdate=fd,Pu.pointLightShadows.needsUpdate=fd,Pu.spotLights.needsUpdate=fd,Pu.spotLightShadows.needsUpdate=fd,Pu.rectAreaLights.needsUpdate=fd,Pu.hemisphereLights.needsUpdate=fd),jn&&en.fog&&zi.refreshFogUniforms(kd,jn),zi.refreshMaterialUniforms(kd,en,Ye,Ht,Ze),Nl.upload(Hn,Ii.uniformsList,kd,an)),en.isShaderMaterial&&!0===en.uniformsNeedUpdate&&(Nl.upload(Hn,Ii.uniformsList,kd,an),en.uniformsNeedUpdate=!1),en.isSpriteMaterial&&kc.setValue(Hn,"center",bn.center),kc.setValue(Hn,"modelViewMatrix",bn.modelViewMatrix),kc.setValue(Hn,"normalMatrix",bn.normalMatrix),kc.setValue(Hn,"modelMatrix",bn.matrixWorld),xf}is.setAnimationLoop(function(mt){Ni&&Ni(mt)}),typeof window<"u"&&is.setContext(window),this.setAnimationLoop=function(mt){Ni=mt,hn.setAnimationLoop(mt),null===mt?is.stop():is.start()},hn.addEventListener("sessionstart",oi),hn.addEventListener("sessionend",ws),this.render=function(mt,xn){if(void 0===xn||!0===xn.isCamera){if(!0!==Be){if(!0===mt.autoUpdate&&mt.updateMatrixWorld(),null===xn.parent&&xn.updateMatrixWorld(),!0===hn.enabled&&!0===hn.isPresenting&&(!0===hn.cameraAutoUpdate&&hn.updateCamera(xn),xn=hn.getCamera()),!0===mt.isScene&&mt.onBeforeRender(Me,mt,xn,Je),oe=_l.get(mt,ve.length),oe.init(),ve.push(oe),st.multiplyMatrices(xn.projectionMatrix,xn.matrixWorldInverse),jt.setFromProjectionMatrix(st),ln=this.localClippingEnabled,It=Wo.init(this.clippingPlanes,ln,xn),ce=bo.get(mt,de.length),ce.init(),de.push(ce),ra(mt,xn,0,Me.sortObjects),ce.finish(),!0===Me.sortObjects&&ce.sort(pt,Vt),!0===It&&Wo.beginShadows(),gl.render(oe.state.shadowsArray,mt,xn),!0===It&&Wo.endShadows(),!0===this.info.autoReset&&this.info.reset(),lu.render(ce,mt),oe.setupLights(Me.physicallyCorrectLights),xn.isArrayCamera){const bn=xn.cameras;for(let jn=0,Ei=bn.length;jn<Ei;jn++){const jr=bn[jn];Ss(ce,mt,jr,jr.viewport)}}else Ss(ce,mt,xn);null!==Je&&(an.updateMultisampleRenderTarget(Je),an.updateRenderTargetMipmap(Je)),!0===mt.isScene&&mt.onAfterRender(Me,mt,xn),Vn.buffers.depth.setTest(!0),Vn.buffers.depth.setMask(!0),Vn.buffers.color.setMask(!0),Vn.setPolygonOffset(!1),vl.resetDefaultState(),We=-1,rt=null,ve.pop(),oe=ve.length>0?ve[ve.length-1]:null,de.pop(),ce=de.length>0?de[de.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return Ae},this.getActiveMipmapLevel=function(){return ke},this.getRenderTarget=function(){return Je},this.setRenderTarget=function(mt,xn=0,en=0){Je=mt,Ae=xn,ke=en,mt&&void 0===dt.get(mt).__webglFramebuffer&&an.setupRenderTarget(mt);let bn=null,jn=!1,Ei=!1;if(mt){const jr=mt.texture;(jr.isDataTexture3D||jr.isDataTexture2DArray)&&(Ei=!0);const Pi=dt.get(mt).__webglFramebuffer;mt.isWebGLCubeRenderTarget?(bn=Pi[xn],jn=!0):bn=mt.isWebGLMultisampleRenderTarget?dt.get(mt).__webglMultisampledFramebuffer:Pi,nt.copy(mt.viewport),gt.copy(mt.scissor),xt=mt.scissorTest}else nt.copy(Rt).multiplyScalar(Ye).floor(),gt.copy(lt).multiplyScalar(Ye).floor(),xt=Jt;if(Vn.bindFramebuffer(36160,bn)&&Yn.drawBuffers){let jr=!1;if(mt)if(mt.isWebGLMultipleRenderTargets){const Pi=mt.texture;if(St.length!==Pi.length||36064!==St[0]){for(let so=0,Es=Pi.length;so<Es;so++)St[so]=36064+so;St.length=Pi.length,jr=!0}}else 1===St.length&&36064===St[0]||(St[0]=36064,St.length=1,jr=!0);else 1===St.length&&1029===St[0]||(St[0]=1029,St.length=1,jr=!0);jr&&(Yn.isWebGL2?Hn.drawBuffers(St):Mn.get("WEBGL_draw_buffers").drawBuffersWEBGL(St))}if(Vn.viewport(nt),Vn.scissor(gt),Vn.setScissorTest(xt),jn){const jr=dt.get(mt.texture);Hn.framebufferTexture2D(36160,36064,34069+xn,jr.__webglTexture,en)}else if(Ei){const jr=dt.get(mt.texture);Hn.framebufferTextureLayer(36160,36064,jr.__webglTexture,en||0,xn||0)}We=-1},this.readRenderTargetPixels=function(mt,xn,en,bn,jn,Ei,jr){if(!mt||!mt.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Pi=dt.get(mt).__webglFramebuffer;if(mt.isWebGLCubeRenderTarget&&void 0!==jr&&(Pi=Pi[jr]),Pi){Vn.bindFramebuffer(36160,Pi);try{const so=mt.texture,Es=so.format,zo=so.type;if(Es!==mo&&hh.convert(Es)!==Hn.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ao=zo===ms&&(Mn.has("EXT_color_buffer_half_float")||Yn.isWebGL2&&Mn.has("EXT_color_buffer_float"));if(!(zo===oa||hh.convert(zo)===Hn.getParameter(35738)||zo===qo&&(Yn.isWebGL2||Mn.has("OES_texture_float")||Mn.has("WEBGL_color_buffer_float"))||ao))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Hn.checkFramebufferStatus(36160)?xn>=0&&xn<=mt.width-bn&&en>=0&&en<=mt.height-jn&&Hn.readPixels(xn,en,bn,jn,hh.convert(Es),hh.convert(zo),Ei):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const so=null!==Je?dt.get(Je).__webglFramebuffer:null;Vn.bindFramebuffer(36160,so)}}},this.copyFramebufferToTexture=function(mt,xn,en=0){const bn=Math.pow(2,-en),jn=Math.floor(xn.image.width*bn),Ei=Math.floor(xn.image.height*bn);let jr=hh.convert(xn.format);Yn.isWebGL2&&(6407===jr&&(jr=32849),6408===jr&&(jr=32856)),an.setTexture2D(xn,0),Hn.copyTexImage2D(3553,en,jr,mt.x,mt.y,jn,Ei,0),Vn.unbindTexture()},this.copyTextureToTexture=function(mt,xn,en,bn=0){const jn=xn.image.width,Ei=xn.image.height,jr=hh.convert(en.format),Pi=hh.convert(en.type);an.setTexture2D(en,0),Hn.pixelStorei(37440,en.flipY),Hn.pixelStorei(37441,en.premultiplyAlpha),Hn.pixelStorei(3317,en.unpackAlignment),xn.isDataTexture?Hn.texSubImage2D(3553,bn,mt.x,mt.y,jn,Ei,jr,Pi,xn.image.data):xn.isCompressedTexture?Hn.compressedTexSubImage2D(3553,bn,mt.x,mt.y,xn.mipmaps[0].width,xn.mipmaps[0].height,jr,xn.mipmaps[0].data):Hn.texSubImage2D(3553,bn,mt.x,mt.y,jr,Pi,xn.image),0===bn&&en.generateMipmaps&&Hn.generateMipmap(3553),Vn.unbindTexture()},this.copyTextureToTexture3D=function(mt,xn,en,bn,jn=0){if(Me.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Ei=mt.max.x-mt.min.x+1,jr=mt.max.y-mt.min.y+1,Pi=mt.max.z-mt.min.z+1,so=hh.convert(bn.format),Es=hh.convert(bn.type);let zo;if(bn.isDataTexture3D)an.setTexture3D(bn,0),zo=32879;else{if(!bn.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");an.setTexture2DArray(bn,0),zo=35866}Hn.pixelStorei(37440,bn.flipY),Hn.pixelStorei(37441,bn.premultiplyAlpha),Hn.pixelStorei(3317,bn.unpackAlignment);const ao=Hn.getParameter(3314),Ii=Hn.getParameter(32878),Wf=Hn.getParameter(3316),Qa=Hn.getParameter(3315),xf=Hn.getParameter(32877),dd=en.isCompressedTexture?en.mipmaps[0]:en.image;Hn.pixelStorei(3314,dd.width),Hn.pixelStorei(32878,dd.height),Hn.pixelStorei(3316,mt.min.x),Hn.pixelStorei(3315,mt.min.y),Hn.pixelStorei(32877,mt.min.z),en.isDataTexture||en.isDataTexture3D?Hn.texSubImage3D(zo,jn,xn.x,xn.y,xn.z,Ei,jr,Pi,so,Es,dd.data):en.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Hn.compressedTexSubImage3D(zo,jn,xn.x,xn.y,xn.z,Ei,jr,Pi,so,dd.data)):Hn.texSubImage3D(zo,jn,xn.x,xn.y,xn.z,Ei,jr,Pi,so,Es,dd),Hn.pixelStorei(3314,ao),Hn.pixelStorei(32878,Ii),Hn.pixelStorei(3316,Wf),Hn.pixelStorei(3315,Qa),Hn.pixelStorei(32877,xf),0===jn&&bn.generateMipmaps&&Hn.generateMipmap(zo),Vn.unbindTexture()},this.initTexture=function(mt){an.setTexture2D(mt,0),Vn.unbindTexture()},this.resetState=function(){Ae=0,ke=0,Je=null,Vn.reset(),vl.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class Nf extends Ir{}Nf.prototype.isWebGL1Renderer=!0;class eu{constructor(e,c=25e-5){this.name="",this.color=new Qn(e),this.density=c}clone(){return new eu(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}eu.prototype.isFogExp2=!0;class nh{constructor(e,c=1,p=1e3){this.name="",this.color=new Qn(e),this.near=c,this.far=p}clone(){return new nh(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}nh.prototype.isFog=!0;class rh extends Pr{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,c){return super.copy(e,c),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const c=super.toJSON(e);return null!==this.fog&&(c.object.fog=this.fog.toJSON()),c}}rh.prototype.isScene=!0;class Js{constructor(e,c){this.array=e,this.stride=c,this.count=void 0!==e?e.length/c:0,this.usage=yi,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=eo()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,c,p){e*=this.stride,p*=c.stride;for(let _=0,w=this.stride;_<w;_++)this.array[e+_]=c.array[p+_];return this}set(e,c=0){return this.array.set(e,c),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=eo()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const c=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),p=new this.constructor(c,this.stride);return p.setUsage(this.usage),p}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=eo()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Js.prototype.isInterleavedBuffer=!0;const Di=new at;class nc{constructor(e,c,p,_=!1){this.name="",this.data=e,this.itemSize=c,this.offset=p,this.normalized=!0===_}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let c=0,p=this.data.count;c<p;c++)Di.x=this.getX(c),Di.y=this.getY(c),Di.z=this.getZ(c),Di.applyMatrix4(e),this.setXYZ(c,Di.x,Di.y,Di.z);return this}applyNormalMatrix(e){for(let c=0,p=this.count;c<p;c++)Di.x=this.getX(c),Di.y=this.getY(c),Di.z=this.getZ(c),Di.applyNormalMatrix(e),this.setXYZ(c,Di.x,Di.y,Di.z);return this}transformDirection(e){for(let c=0,p=this.count;c<p;c++)Di.x=this.getX(c),Di.y=this.getY(c),Di.z=this.getZ(c),Di.transformDirection(e),this.setXYZ(c,Di.x,Di.y,Di.z);return this}setX(e,c){return this.data.array[e*this.data.stride+this.offset]=c,this}setY(e,c){return this.data.array[e*this.data.stride+this.offset+1]=c,this}setZ(e,c){return this.data.array[e*this.data.stride+this.offset+2]=c,this}setW(e,c){return this.data.array[e*this.data.stride+this.offset+3]=c,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,c,p){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=p,this}setXYZ(e,c,p,_){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=p,this.data.array[e+2]=_,this}setXYZW(e,c,p,_,w){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=p,this.data.array[e+2]=_,this.data.array[e+3]=w,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let p=0;p<this.count;p++){const _=p*this.data.stride+this.offset;for(let w=0;w<this.itemSize;w++)c.push(this.data.array[_+w])}return new Fi(new this.array.constructor(c),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new nc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let p=0;p<this.count;p++){const _=p*this.data.stride+this.offset;for(let w=0;w<this.itemSize;w++)c.push(this.data.array[_+w])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:c,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}nc.prototype.isInterleavedBufferAttribute=!0;class td extends $s{constructor(e){super(),this.type="SpriteMaterial",this.color=new Qn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let Wi;td.prototype.isSpriteMaterial=!0;const Pp=new at,Pl=new at,Do=new at,Il=new Un,fa=new Un,rc=new Kt,tu=new at,qa=new at,Sd=new at,Au=new Un,$u=new Un,Cu=new Un;class Ol extends Pr{constructor(e){if(super(),this.type="Sprite",void 0===Wi){Wi=new gr;const c=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),p=new Js(c,5);Wi.setIndex([0,1,2,0,2,3]),Wi.setAttribute("position",new nc(p,3,0,!1)),Wi.setAttribute("uv",new nc(p,2,3,!1))}this.geometry=Wi,this.material=void 0!==e?e:new td,this.center=new Un(.5,.5)}raycast(e,c){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Pl.setFromMatrixScale(this.matrixWorld),rc.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Do.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Pl.multiplyScalar(-Do.z);const p=this.material.rotation;let _,w;0!==p&&(w=Math.cos(p),_=Math.sin(p));const L=this.center;nu(tu.set(-.5,-.5,0),Do,L,Pl,_,w),nu(qa.set(.5,-.5,0),Do,L,Pl,_,w),nu(Sd.set(.5,.5,0),Do,L,Pl,_,w),Au.set(0,0),$u.set(1,0),Cu.set(1,1);let O=e.ray.intersectTriangle(tu,qa,Sd,!1,Pp);if(null===O&&(nu(qa.set(-.5,.5,0),Do,L,Pl,_,w),$u.set(0,1),O=e.ray.intersectTriangle(tu,Sd,qa,!1,Pp),null===O))return;const F=e.ray.origin.distanceTo(Pp);F<e.near||F>e.far||c.push({distance:F,point:Pp.clone(),uv:ro.getUV(Pp,tu,qa,Sd,Au,$u,Cu,new Un),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function nu(S,e,c,p,_,w){Il.subVectors(S,c).addScalar(.5).multiply(p),void 0!==_?(fa.x=w*Il.x-_*Il.y,fa.y=_*Il.x+w*Il.y):fa.copy(Il),S.copy(e),S.x+=fa.x,S.y+=fa.y,S.applyMatrix4(rc)}Ol.prototype.isSprite=!0;const Lc=new at,Th=new at;class Ds extends Pr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const c=e.levels;for(let p=0,_=c.length;p<_;p++){const w=c[p];this.addLevel(w.object.clone(),w.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,c=0){c=Math.abs(c);const p=this.levels;let _;for(_=0;_<p.length&&!(c<p[_].distance);_++);return p.splice(_,0,{distance:c,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const c=this.levels;if(c.length>0){let p,_;for(p=1,_=c.length;p<_&&!(e<c[p].distance);p++);return c[p-1].object}return null}raycast(e,c){if(this.levels.length>0){Lc.setFromMatrixPosition(this.matrixWorld);const p=e.ray.origin.distanceTo(Lc);this.getObjectForDistance(p).raycast(e,c)}}update(e){const c=this.levels;if(c.length>1){Lc.setFromMatrixPosition(e.matrixWorld),Th.setFromMatrixPosition(this.matrixWorld);const p=Lc.distanceTo(Th)/e.zoom;let _,w;for(c[0].object.visible=!0,_=1,w=c.length;_<w&&p>=c[_].distance;_++)c[_-1].object.visible=!1,c[_].object.visible=!0;for(this._currentLevel=_-1;_<w;_++)c[_].object.visible=!1}}toJSON(e){const c=super.toJSON(e);!1===this.autoUpdate&&(c.object.autoUpdate=!1),c.object.levels=[];const p=this.levels;for(let _=0,w=p.length;_<w;_++){const L=p[_];c.object.levels.push({object:L.object.uuid,distance:L.distance})}return c}}const Lu=new at,ih=new ji,Mh=new ji,Zs=new at,kl=new Kt;class Ps extends ko{constructor(e,c){super(e,c),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Kt,this.bindMatrixInverse=new Kt}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,c){this.skeleton=e,void 0===c&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),c=this.matrixWorld),this.bindMatrix.copy(c),this.bindMatrixInverse.copy(c).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new ji,c=this.geometry.attributes.skinWeight;for(let p=0,_=c.count;p<_;p++){e.x=c.getX(p),e.y=c.getY(p),e.z=c.getZ(p),e.w=c.getW(p);const w=1/e.manhattanLength();w!==1/0?e.multiplyScalar(w):e.set(1,0,0,0),c.setXYZW(p,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,c){const p=this.skeleton,_=this.geometry;ih.fromBufferAttribute(_.attributes.skinIndex,e),Mh.fromBufferAttribute(_.attributes.skinWeight,e),Lu.fromBufferAttribute(_.attributes.position,e).applyMatrix4(this.bindMatrix),c.set(0,0,0);for(let w=0;w<4;w++){const L=Mh.getComponent(w);if(0!==L){const O=ih.getComponent(w);kl.multiplyMatrices(p.bones[O].matrixWorld,p.boneInverses[O]),c.addScaledVector(Zs.copy(Lu).applyMatrix4(kl),L)}}return c.applyMatrix4(this.bindMatrixInverse)}}Ps.prototype.isSkinnedMesh=!0;class Xa extends Pr{constructor(){super(),this.type="Bone"}}Xa.prototype.isBone=!0;class La extends As{constructor(e=null,c=1,p=1,_,w,L,O,F,U=Or,te=Or,ce,oe){super(null,L,O,F,U,te,_,w,ce,oe),this.image={data:e,width:c,height:p},this.magFilter=U,this.minFilter=te,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}La.prototype.isDataTexture=!0;const Bc=new Kt,dl=new Kt;class Bu{constructor(e=[],c=[]){this.uuid=eo(),this.bones=e.slice(0),this.boneInverses=c,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,c=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===c.length)this.calculateInverses();else if(e.length!==c.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let p=0,_=this.bones.length;p<_;p++)this.boneInverses.push(new Kt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,c=this.bones.length;e<c;e++){const p=new Kt;this.bones[e]&&p.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(p)}}pose(){for(let e=0,c=this.bones.length;e<c;e++){const p=this.bones[e];p&&p.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,c=this.bones.length;e<c;e++){const p=this.bones[e];p&&(p.parent&&p.parent.isBone?(p.matrix.copy(p.parent.matrixWorld).invert(),p.matrix.multiply(p.matrixWorld)):p.matrix.copy(p.matrixWorld),p.matrix.decompose(p.position,p.quaternion,p.scale))}}update(){const e=this.bones,c=this.boneInverses,p=this.boneMatrices,_=this.boneTexture;for(let w=0,L=e.length;w<L;w++)Bc.multiplyMatrices(e[w]?e[w].matrixWorld:dl,c[w]),Bc.toArray(p,16*w);null!==_&&(_.needsUpdate=!0)}clone(){return new Bu(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Vh(e),e=Math.max(e,4);const c=new Float32Array(e*e*4);c.set(this.boneMatrices);const p=new La(c,e,e,mo,qo);return this.boneMatrices=c,this.boneTexture=p,this.boneTextureSize=e,this}getBoneByName(e){for(let c=0,p=this.bones.length;c<p;c++){const _=this.bones[c];if(_.name===e)return _}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,c){this.uuid=e.uuid;for(let p=0,_=e.bones.length;p<_;p++){const w=e.bones[p];let L=c[w];void 0===L&&(console.warn("THREE.Skeleton: No bone found with UUID:",w),L=new Xa),this.bones.push(L),this.boneInverses.push((new Kt).fromArray(e.boneInverses[p]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const c=this.bones,p=this.boneInverses;for(let _=0,w=c.length;_<w;_++)e.bones.push(c[_].uuid),e.boneInverses.push(p[_].toArray());return e}}class Zi extends Fi{constructor(e,c,p,_=1){"number"==typeof p&&(_=p,p=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,c,p),this.meshPerAttribute=_}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Zi.prototype.isInstancedBufferAttribute=!0;const nd=new Kt,Ip=new Kt,Ed=[],ic=new ko;class Go extends ko{constructor(e,c,p){super(e,c),this.instanceMatrix=new Zi(new Float32Array(16*p),16),this.instanceColor=null,this.count=p,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,c){c.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,c){c.fromArray(this.instanceMatrix.array,16*e)}raycast(e,c){const p=this.matrixWorld,_=this.count;if(ic.geometry=this.geometry,ic.material=this.material,void 0!==ic.material)for(let w=0;w<_;w++){this.getMatrixAt(w,nd),Ip.multiplyMatrices(p,nd),ic.matrixWorld=Ip,ic.raycast(e,Ed);for(let L=0,O=Ed.length;L<O;L++){const F=Ed[L];F.instanceId=w,F.object=this,c.push(F)}Ed.length=0}}setColorAt(e,c){null===this.instanceColor&&(this.instanceColor=new Zi(new Float32Array(3*this.instanceMatrix.count),3)),c.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,c){c.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Go.prototype.isInstancedMesh=!0;class wi extends $s{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Qn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}wi.prototype.isLineBasicMaterial=!0;const ru=new at,zt=new at,Op=new Kt,Ui=new mn,xs=new To;class to extends Pr{constructor(e=new gr,c=new wi){super(),this.type="Line",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const c=e.attributes.position,p=[0];for(let _=1,w=c.count;_<w;_++)ru.fromBufferAttribute(c,_-1),zt.fromBufferAttribute(c,_),p[_]=p[_-1],p[_]+=ru.distanceTo(zt);e.setAttribute("lineDistance",new pn(p,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,c){const p=this.geometry,_=this.matrixWorld,w=e.params.Line.threshold,L=p.drawRange;if(null===p.boundingSphere&&p.computeBoundingSphere(),xs.copy(p.boundingSphere),xs.applyMatrix4(_),xs.radius+=w,!1===e.ray.intersectsSphere(xs))return;Op.copy(_).invert(),Ui.copy(e.ray).applyMatrix4(Op);const O=w/((this.scale.x+this.scale.y+this.scale.z)/3),F=O*O,U=new at,te=new at,ce=new at,oe=new at,de=this.isLineSegments?2:1;if(p.isBufferGeometry){const ve=p.index,Me=p.attributes.position;if(null!==ve)for(let Be=Math.max(0,L.start),Ae=Math.min(ve.count,L.start+L.count)-1;Be<Ae;Be+=de){const ke=ve.getX(Be),Je=ve.getX(Be+1);if(U.fromBufferAttribute(Me,ke),te.fromBufferAttribute(Me,Je),Ui.distanceSqToSegment(U,te,oe,ce)>F)continue;oe.applyMatrix4(this.matrixWorld);const We=e.ray.origin.distanceTo(oe);We<e.near||We>e.far||c.push({distance:We,point:ce.clone().applyMatrix4(this.matrixWorld),index:Be,face:null,faceIndex:null,object:this})}else for(let Be=Math.max(0,L.start),Ae=Math.min(Me.count,L.start+L.count)-1;Be<Ae;Be+=de){if(U.fromBufferAttribute(Me,Be),te.fromBufferAttribute(Me,Be+1),Ui.distanceSqToSegment(U,te,oe,ce)>F)continue;oe.applyMatrix4(this.matrixWorld);const ke=e.ray.origin.distanceTo(oe);ke<e.near||ke>e.far||c.push({distance:ke,point:ce.clone().applyMatrix4(this.matrixWorld),index:Be,face:null,faceIndex:null,object:this})}}else p.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,p=Object.keys(c);if(p.length>0){const _=c[p[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let w=0,L=_.length;w<L;w++){const O=_[w].name||String(w);this.morphTargetInfluences.push(0),this.morphTargetDictionary[O]=w}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}to.prototype.isLine=!0;const Mo=new at,Nu=new at;class Qs extends to{constructor(e,c){super(e,c),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const c=e.attributes.position,p=[];for(let _=0,w=c.count;_<w;_+=2)Mo.fromBufferAttribute(c,_),Nu.fromBufferAttribute(c,_+1),p[_]=0===_?0:p[_-1],p[_+1]=p[_]+Mo.distanceTo(Nu);e.setAttribute("lineDistance",new pn(p,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Qs.prototype.isLineSegments=!0;class df extends to{constructor(e,c){super(e,c),this.type="LineLoop"}}df.prototype.isLineLoop=!0;class br extends $s{constructor(e){super(),this.type="PointsMaterial",this.color=new Qn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}br.prototype.isPointsMaterial=!0;const ns=new Kt,$i=new mn,Ro=new To,ii=new at;class Po extends Pr{constructor(e=new gr,c=new br){super(),this.type="Points",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,c){const p=this.geometry,_=this.matrixWorld,w=e.params.Points.threshold,L=p.drawRange;if(null===p.boundingSphere&&p.computeBoundingSphere(),Ro.copy(p.boundingSphere),Ro.applyMatrix4(_),Ro.radius+=w,!1===e.ray.intersectsSphere(Ro))return;ns.copy(_).invert(),$i.copy(e.ray).applyMatrix4(ns);const O=w/((this.scale.x+this.scale.y+this.scale.z)/3),F=O*O;if(p.isBufferGeometry){const U=p.index,te=p.attributes.position;if(null!==U)for(let ce=Math.max(0,L.start),oe=Math.min(U.count,L.start+L.count);ce<oe;ce++){const de=U.getX(ce);ii.fromBufferAttribute(te,de),iu(ii,de,F,_,e,c,this)}else for(let ce=Math.max(0,L.start),oe=Math.min(te.count,L.start+L.count);ce<oe;ce++)ii.fromBufferAttribute(te,ce),iu(ii,ce,F,_,e,c,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,p=Object.keys(c);if(p.length>0){const _=c[p[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let w=0,L=_.length;w<L;w++){const O=_[w].name||String(w);this.morphTargetInfluences.push(0),this.morphTargetDictionary[O]=w}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function iu(S,e,c,p,_,w,L){const O=$i.distanceSqToPoint(S);if(O<c){const F=new at;$i.closestPointToPoint(S,F),F.applyMatrix4(p);const U=_.ray.origin.distanceTo(F);if(U<_.near||U>_.far)return;w.push({distance:U,distanceToRay:Math.sqrt(O),point:F,index:e,face:null,object:L})}}Po.prototype.isPoints=!0;class Ya extends As{constructor(e,c,p,_,w,L,O,F,U){super(e,c,p,_,w,L,O,F,U),this.format=void 0!==O?O:Is,this.minFilter=void 0!==L?L:ai,this.magFilter=void 0!==w?w:ai,this.generateMipmaps=!1;const te=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function ce(){te.needsUpdate=!0,e.requestVideoFrameCallback(ce)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}Ya.prototype.isVideoTexture=!0;class rd extends As{constructor(e,c,p,_,w,L,O,F,U,te,ce,oe){super(null,L,O,F,U,te,_,w,ce,oe),this.image={width:c,height:p},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}rd.prototype.isCompressedTexture=!0;class kp extends As{constructor(e,c,p,_,w,L,O,F,U){super(e,c,p,_,w,L,O,F,U),this.needsUpdate=!0}}kp.prototype.isCanvasTexture=!0;class oh extends As{constructor(e,c,p,_,w,L,O,F,U,te){if((te=void 0!==te?te:Lo)!==Lo&&te!==qs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===p&&te===Lo&&(p=Dc),void 0===p&&te===qs&&(p=Ts),super(null,_,w,L,O,F,te,p,U),this.image={width:e,height:c},this.magFilter=void 0!==O?O:Or,this.minFilter=void 0!==F?F:Or,this.flipY=!1,this.generateMipmaps=!1}}oh.prototype.isDepthTexture=!0;class Fp extends gr{constructor(e=1,c=8,p=0,_=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:c,thetaStart:p,thetaLength:_},c=Math.max(3,c);const w=[],L=[],O=[],F=[],U=new at,te=new Un;L.push(0,0,0),O.push(0,0,1),F.push(.5,.5);for(let ce=0,oe=3;ce<=c;ce++,oe+=3){const de=p+ce/c*_;U.x=e*Math.cos(de),U.y=e*Math.sin(de),L.push(U.x,U.y,U.z),O.push(0,0,1),te.x=(L[oe]/e+1)/2,te.y=(L[oe+1]/e+1)/2,F.push(te.x,te.y)}for(let ce=1;ce<=c;ce++)w.push(ce,ce+1,0);this.setIndex(w),this.setAttribute("position",new pn(L,3)),this.setAttribute("normal",new pn(O,3)),this.setAttribute("uv",new pn(F,2))}static fromJSON(e){return new Fp(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class sh extends gr{constructor(e=1,c=1,p=1,_=8,w=1,L=!1,O=0,F=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:c,height:p,radialSegments:_,heightSegments:w,openEnded:L,thetaStart:O,thetaLength:F};const U=this;_=Math.floor(_),w=Math.floor(w);const te=[],ce=[],oe=[],de=[];let ve=0;const Me=[],Be=p/2;let Ae=0;function ke(Je){const We=ve,rt=new Un,nt=new at;let gt=0;const xt=!0===Je?e:c,Ut=!0===Je?1:-1;for(let Ye=1;Ye<=_;Ye++)ce.push(0,Be*Ut,0),oe.push(0,Ut,0),de.push(.5,.5),ve++;const Ht=ve;for(let Ye=0;Ye<=_;Ye++){const pt=Ye/_*F+O,Vt=Math.cos(pt),Rt=Math.sin(pt);nt.x=xt*Rt,nt.y=Be*Ut,nt.z=xt*Vt,ce.push(nt.x,nt.y,nt.z),oe.push(0,Ut,0),rt.x=.5*Vt+.5,rt.y=.5*Rt*Ut+.5,de.push(rt.x,rt.y),ve++}for(let Ye=0;Ye<_;Ye++){const pt=We+Ye,Vt=Ht+Ye;!0===Je?te.push(Vt,Vt+1,pt):te.push(Vt+1,Vt,pt),gt+=3}U.addGroup(Ae,gt,!0===Je?1:2),Ae+=gt}(function(){const Je=new at,We=new at;let rt=0;const nt=(c-e)/p;for(let gt=0;gt<=w;gt++){const xt=[],Ut=gt/w,Ht=Ut*(c-e)+e;for(let Ye=0;Ye<=_;Ye++){const pt=Ye/_,Vt=pt*F+O,Rt=Math.sin(Vt),lt=Math.cos(Vt);We.x=Ht*Rt,We.y=-Ut*p+Be,We.z=Ht*lt,ce.push(We.x,We.y,We.z),Je.set(Rt,nt,lt).normalize(),oe.push(Je.x,Je.y,Je.z),de.push(pt,1-Ut),xt.push(ve++)}Me.push(xt)}for(let gt=0;gt<_;gt++)for(let xt=0;xt<w;xt++){const Ht=Me[xt+1][gt],Ye=Me[xt+1][gt+1],pt=Me[xt][gt+1];te.push(Me[xt][gt],Ht,pt),te.push(Ht,Ye,pt),rt+=6}U.addGroup(Ae,rt,0),Ae+=rt})(),!1===L&&(e>0&&ke(!0),c>0&&ke(!1)),this.setIndex(te),this.setAttribute("position",new pn(ce,3)),this.setAttribute("normal",new pn(oe,3)),this.setAttribute("uv",new pn(de,2))}static fromJSON(e){return new sh(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ou extends sh{constructor(e=1,c=1,p=8,_=1,w=!1,L=0,O=2*Math.PI){super(0,e,c,p,_,w,L,O),this.type="ConeGeometry",this.parameters={radius:e,height:c,radialSegments:p,heightSegments:_,openEnded:w,thetaStart:L,thetaLength:O}}static fromJSON(e){return new ou(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ma extends gr{constructor(e,c,p=1,_=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:c,radius:p,detail:_};const w=[],L=[];function O(oe,de,ve,Me){const Be=Me+1,Ae=[];for(let ke=0;ke<=Be;ke++){Ae[ke]=[];const Je=oe.clone().lerp(ve,ke/Be),We=de.clone().lerp(ve,ke/Be),rt=Be-ke;for(let nt=0;nt<=rt;nt++)Ae[ke][nt]=0===nt&&ke===Be?Je:Je.clone().lerp(We,nt/rt)}for(let ke=0;ke<Be;ke++)for(let Je=0;Je<2*(Be-ke)-1;Je++){const We=Math.floor(Je/2);Je%2==0?(F(Ae[ke][We+1]),F(Ae[ke+1][We]),F(Ae[ke][We])):(F(Ae[ke][We+1]),F(Ae[ke+1][We+1]),F(Ae[ke+1][We]))}}function F(oe){w.push(oe.x,oe.y,oe.z)}function U(oe,de){const ve=3*oe;de.x=e[ve+0],de.y=e[ve+1],de.z=e[ve+2]}function te(oe,de,ve,Me){Me<0&&1===oe.x&&(L[de]=oe.x-1),0===ve.x&&0===ve.z&&(L[de]=Me/2/Math.PI+.5)}function ce(oe){return Math.atan2(oe.z,-oe.x)}(function(oe){const de=new at,ve=new at,Me=new at;for(let Be=0;Be<c.length;Be+=3)U(c[Be+0],de),U(c[Be+1],ve),U(c[Be+2],Me),O(de,ve,Me,oe)})(_),function(oe){const de=new at;for(let ve=0;ve<w.length;ve+=3)de.x=w[ve+0],de.y=w[ve+1],de.z=w[ve+2],de.normalize().multiplyScalar(oe),w[ve+0]=de.x,w[ve+1]=de.y,w[ve+2]=de.z}(p),function(){const oe=new at;for(let ve=0;ve<w.length;ve+=3){oe.x=w[ve+0],oe.y=w[ve+1],oe.z=w[ve+2];const Me=ce(oe)/2/Math.PI+.5,Be=(de=oe,Math.atan2(-de.y,Math.sqrt(de.x*de.x+de.z*de.z))/Math.PI+.5);L.push(Me,1-Be)}var de;(function(){const ve=new at,Me=new at,Be=new at,Ae=new at,ke=new Un,Je=new Un,We=new Un;for(let rt=0,nt=0;rt<w.length;rt+=9,nt+=6){ve.set(w[rt+0],w[rt+1],w[rt+2]),Me.set(w[rt+3],w[rt+4],w[rt+5]),Be.set(w[rt+6],w[rt+7],w[rt+8]),ke.set(L[nt+0],L[nt+1]),Je.set(L[nt+2],L[nt+3]),We.set(L[nt+4],L[nt+5]),Ae.copy(ve).add(Me).add(Be).divideScalar(3);const gt=ce(Ae);te(ke,nt+0,ve,gt),te(Je,nt+2,Me,gt),te(We,nt+4,Be,gt)}})(),function(){for(let ve=0;ve<L.length;ve+=6){const Me=L[ve+0],Be=L[ve+2],Ae=L[ve+4],ke=Math.max(Me,Be,Ae),Je=Math.min(Me,Be,Ae);ke>.9&&Je<.1&&(Me<.2&&(L[ve+0]+=1),Be<.2&&(L[ve+2]+=1),Ae<.2&&(L[ve+4]+=1))}}()}(),this.setAttribute("position",new pn(w,3)),this.setAttribute("normal",new pn(w.slice(),3)),this.setAttribute("uv",new pn(L,2)),0===_?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new ma(e.vertices,e.indices,e.radius,e.details)}}class od extends ma{constructor(e=1,c=0){const p=(1+Math.sqrt(5))/2,_=1/p;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-_,-p,0,-_,p,0,_,-p,0,_,p,-_,-p,0,-_,p,0,_,-p,0,_,p,0,-p,0,-_,p,0,-_,-p,0,_,p,0,_],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,c),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new od(e.radius,e.detail)}}const sd=new at,vo=new at,Cr=new at,Xr=new ro;class Ru extends gr{constructor(e,c){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:c},c=void 0!==c?c:1,!0===e.isGeometry)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const p=Math.pow(10,4),_=Math.cos(jo*c),w=e.getIndex(),L=e.getAttribute("position"),O=w?w.count:L.count,F=[0,0,0],U=["a","b","c"],te=new Array(3),ce={},oe=[];for(let de=0;de<O;de+=3){w?(F[0]=w.getX(de),F[1]=w.getX(de+1),F[2]=w.getX(de+2)):(F[0]=de,F[1]=de+1,F[2]=de+2);const{a:ve,b:Me,c:Be}=Xr;if(ve.fromBufferAttribute(L,F[0]),Me.fromBufferAttribute(L,F[1]),Be.fromBufferAttribute(L,F[2]),Xr.getNormal(Cr),te[0]=`${Math.round(ve.x*p)},${Math.round(ve.y*p)},${Math.round(ve.z*p)}`,te[1]=`${Math.round(Me.x*p)},${Math.round(Me.y*p)},${Math.round(Me.z*p)}`,te[2]=`${Math.round(Be.x*p)},${Math.round(Be.y*p)},${Math.round(Be.z*p)}`,te[0]!==te[1]&&te[1]!==te[2]&&te[2]!==te[0])for(let Ae=0;Ae<3;Ae++){const ke=(Ae+1)%3,Je=te[Ae],We=te[ke],rt=Xr[U[Ae]],nt=Xr[U[ke]],gt=`${Je}_${We}`,xt=`${We}_${Je}`;xt in ce&&ce[xt]?(Cr.dot(ce[xt].normal)<=_&&(oe.push(rt.x,rt.y,rt.z),oe.push(nt.x,nt.y,nt.z)),ce[xt]=null):gt in ce||(ce[gt]={index0:F[Ae],index1:F[ke],normal:Cr.clone()})}}for(const de in ce)if(ce[de]){const{index0:ve,index1:Me}=ce[de];sd.fromBufferAttribute(L,ve),vo.fromBufferAttribute(L,Me),oe.push(sd.x,sd.y,sd.z),oe.push(vo.x,vo.y,vo.z)}this.setAttribute("position",new pn(oe,3))}}class Ks{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,c){const p=this.getUtoTmapping(e);return this.getPoint(p,c)}getPoints(e=5){const c=[];for(let p=0;p<=e;p++)c.push(this.getPoint(p/e));return c}getSpacedPoints(e=5){const c=[];for(let p=0;p<=e;p++)c.push(this.getPointAt(p/e));return c}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let p,_=this.getPoint(0),w=0;c.push(0);for(let L=1;L<=e;L++)p=this.getPoint(L/e),w+=p.distanceTo(_),c.push(w),_=p;return this.cacheArcLengths=c,c}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,c){const p=this.getLengths();let _=0;const w=p.length;let L;L=c||e*p[w-1];let O,F=0,U=w-1;for(;F<=U;)if(_=Math.floor(F+(U-F)/2),O=p[_]-L,O<0)F=_+1;else{if(!(O>0)){U=_;break}U=_-1}if(_=U,p[_]===L)return _/(w-1);const te=p[_];return(_+(L-te)/(p[_+1]-te))/(w-1)}getTangent(e,c){let _=e-1e-4,w=e+1e-4;_<0&&(_=0),w>1&&(w=1);const L=this.getPoint(_),O=this.getPoint(w),F=c||(L.isVector2?new Un:new at);return F.copy(O).sub(L).normalize(),F}getTangentAt(e,c){const p=this.getUtoTmapping(e);return this.getTangent(p,c)}computeFrenetFrames(e,c){const p=new at,_=[],w=[],L=[],O=new at,F=new Kt;for(let de=0;de<=e;de++)_[de]=this.getTangentAt(de/e,new at),_[de].normalize();w[0]=new at,L[0]=new at;let U=Number.MAX_VALUE;const te=Math.abs(_[0].x),ce=Math.abs(_[0].y),oe=Math.abs(_[0].z);te<=U&&(U=te,p.set(1,0,0)),ce<=U&&(U=ce,p.set(0,1,0)),oe<=U&&p.set(0,0,1),O.crossVectors(_[0],p).normalize(),w[0].crossVectors(_[0],O),L[0].crossVectors(_[0],w[0]);for(let de=1;de<=e;de++){if(w[de]=w[de-1].clone(),L[de]=L[de-1].clone(),O.crossVectors(_[de-1],_[de]),O.length()>Number.EPSILON){O.normalize();const ve=Math.acos(Gr(_[de-1].dot(_[de]),-1,1));w[de].applyMatrix4(F.makeRotationAxis(O,ve))}L[de].crossVectors(_[de],w[de])}if(!0===c){let de=Math.acos(Gr(w[0].dot(w[e]),-1,1));de/=e,_[0].dot(O.crossVectors(w[0],w[e]))>0&&(de=-de);for(let ve=1;ve<=e;ve++)w[ve].applyMatrix4(F.makeRotationAxis(_[ve],de*ve)),L[ve].crossVectors(_[ve],w[ve])}return{tangents:_,normals:w,binormals:L}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class oc extends Ks{constructor(e=0,c=0,p=1,_=1,w=0,L=2*Math.PI,O=!1,F=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=c,this.xRadius=p,this.yRadius=_,this.aStartAngle=w,this.aEndAngle=L,this.aClockwise=O,this.aRotation=F}getPoint(e,c){const p=c||new Un,_=2*Math.PI;let w=this.aEndAngle-this.aStartAngle;const L=Math.abs(w)<Number.EPSILON;for(;w<0;)w+=_;for(;w>_;)w-=_;w<Number.EPSILON&&(w=L?0:_),!0!==this.aClockwise||L||(w===_?w=-_:w-=_);const O=this.aStartAngle+e*w;let F=this.aX+this.xRadius*Math.cos(O),U=this.aY+this.yRadius*Math.sin(O);if(0!==this.aRotation){const te=Math.cos(this.aRotation),ce=Math.sin(this.aRotation),oe=F-this.aX,de=U-this.aY;F=oe*te-de*ce+this.aX,U=oe*ce+de*te+this.aY}return p.set(F,U)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}oc.prototype.isEllipseCurve=!0;class np extends oc{constructor(e,c,p,_,w,L){super(e,c,p,p,_,w,L),this.type="ArcCurve"}}function Ah(){let S=0,e=0,c=0,p=0;function _(w,L,O,F){S=w,e=O,c=-3*w+3*L-2*O-F,p=2*w-2*L+O+F}return{initCatmullRom:function(w,L,O,F,U){_(L,O,U*(O-w),U*(F-L))},initNonuniformCatmullRom:function(w,L,O,F,U,te,ce){let oe=(L-w)/U-(O-w)/(U+te)+(O-L)/te,de=(O-L)/te-(F-L)/(te+ce)+(F-O)/ce;oe*=te,de*=te,_(L,O,oe,de)},calc:function(w){const L=w*w;return S+e*w+c*L+p*(L*w)}}}np.prototype.isArcCurve=!0;const Nc=new at,Xn=new Ah,Hi=new Ah,$h=new Ah;class Nn extends Ks{constructor(e=[],c=!1,p="centripetal",_=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=c,this.curveType=p,this.tension=_}getPoint(e,c=new at){const p=c,_=this.points,w=_.length,L=(w-(this.closed?0:1))*e;let O,F,U=Math.floor(L),te=L-U;this.closed?U+=U>0?0:(Math.floor(Math.abs(U)/w)+1)*w:0===te&&U===w-1&&(U=w-2,te=1),this.closed||U>0?O=_[(U-1)%w]:(Nc.subVectors(_[0],_[1]).add(_[0]),O=Nc);const ce=_[U%w],oe=_[(U+1)%w];if(this.closed||U+2<w?F=_[(U+2)%w]:(Nc.subVectors(_[w-1],_[w-2]).add(_[w-1]),F=Nc),"centripetal"===this.curveType||"chordal"===this.curveType){const de="chordal"===this.curveType?.5:.25;let ve=Math.pow(O.distanceToSquared(ce),de),Me=Math.pow(ce.distanceToSquared(oe),de),Be=Math.pow(oe.distanceToSquared(F),de);Me<1e-4&&(Me=1),ve<1e-4&&(ve=Me),Be<1e-4&&(Be=Me),Xn.initNonuniformCatmullRom(O.x,ce.x,oe.x,F.x,ve,Me,Be),Hi.initNonuniformCatmullRom(O.y,ce.y,oe.y,F.y,ve,Me,Be),$h.initNonuniformCatmullRom(O.z,ce.z,oe.z,F.z,ve,Me,Be)}else"catmullrom"===this.curveType&&(Xn.initCatmullRom(O.x,ce.x,oe.x,F.x,this.tension),Hi.initCatmullRom(O.y,ce.y,oe.y,F.y,this.tension),$h.initCatmullRom(O.z,ce.z,oe.z,F.z,this.tension));return p.set(Xn.calc(te),Hi.calc(te),$h.calc(te)),p}copy(e){super.copy(e),this.points=[];for(let c=0,p=e.points.length;c<p;c++)this.points.push(e.points[c].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let c=0,p=this.points.length;c<p;c++)e.points.push(this.points[c].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let c=0,p=e.points.length;c<p;c++){const _=e.points[c];this.points.push((new at).fromArray(_))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Ho(S,e,c,p,_){const w=.5*(p-e),L=.5*(_-c),O=S*S;return(2*c-2*p+w+L)*(S*O)+(-3*c+3*p-2*w-L)*O+w*S+c}function Bi(S,e,c,p){return function(_,w){const L=1-_;return L*L*w}(S,e)+2*(1-(_=S))*_*c+function(_,w){return _*_*w}(S,p);var _}function Ch(S,e,c,p,_){return function(w,L){const O=1-w;return O*O*O*L}(S,e)+function(w,L){const O=1-w;return 3*O*O*w*L}(S,c)+3*(1-(w=S))*w*w*p+function(w,L){return w*w*w*L}(S,_);var w}Nn.prototype.isCatmullRomCurve3=!0;class rp extends Ks{constructor(e=new Un,c=new Un,p=new Un,_=new Un){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=c,this.v2=p,this.v3=_}getPoint(e,c=new Un){const p=c,_=this.v0,w=this.v1,L=this.v2,O=this.v3;return p.set(Ch(e,_.x,w.x,L.x,O.x),Ch(e,_.y,w.y,L.y,O.y)),p}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}rp.prototype.isCubicBezierCurve=!0;class Lh extends Ks{constructor(e=new at,c=new at,p=new at,_=new at){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=c,this.v2=p,this.v3=_}getPoint(e,c=new at){const p=c,_=this.v0,w=this.v1,L=this.v2,O=this.v3;return p.set(Ch(e,_.x,w.x,L.x,O.x),Ch(e,_.y,w.y,L.y,O.y),Ch(e,_.z,w.z,L.z,O.z)),p}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Lh.prototype.isCubicBezierCurve3=!0;class Us extends Ks{constructor(e=new Un,c=new Un){super(),this.type="LineCurve",this.v1=e,this.v2=c}getPoint(e,c=new Un){const p=c;return 1===e?p.copy(this.v2):(p.copy(this.v2).sub(this.v1),p.multiplyScalar(e).add(this.v1)),p}getPointAt(e,c){return this.getPoint(e,c)}getTangent(e,c){const p=c||new Un;return p.copy(this.v2).sub(this.v1).normalize(),p}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Us.prototype.isLineCurve=!0;class oo extends Ks{constructor(e=new at,c=new at){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=c}getPoint(e,c=new at){const p=c;return 1===e?p.copy(this.v2):(p.copy(this.v2).sub(this.v1),p.multiplyScalar(e).add(this.v1)),p}getPointAt(e,c){return this.getPoint(e,c)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class _a extends Ks{constructor(e=new Un,c=new Un,p=new Un){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=c,this.v2=p}getPoint(e,c=new Un){const p=c,_=this.v0,w=this.v1,L=this.v2;return p.set(Bi(e,_.x,w.x,L.x),Bi(e,_.y,w.y,L.y)),p}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}_a.prototype.isQuadraticBezierCurve=!0;class Ja extends Ks{constructor(e=new at,c=new at,p=new at){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=c,this.v2=p}getPoint(e,c=new at){const p=c,_=this.v0,w=this.v1,L=this.v2;return p.set(Bi(e,_.x,w.x,L.x),Bi(e,_.y,w.y,L.y),Bi(e,_.z,w.z,L.z)),p}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Ja.prototype.isQuadraticBezierCurve3=!0;class uo extends Ks{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,c=new Un){const p=c,_=this.points,w=(_.length-1)*e,L=Math.floor(w),O=w-L,F=_[0===L?L:L-1],U=_[L],te=_[L>_.length-2?_.length-1:L+1],ce=_[L>_.length-3?_.length-1:L+2];return p.set(Ho(O,F.x,U.x,te.x,ce.x),Ho(O,F.y,U.y,te.y,ce.y)),p}copy(e){super.copy(e),this.points=[];for(let c=0,p=e.points.length;c<p;c++)this.points.push(e.points[c].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let c=0,p=this.points.length;c<p;c++)e.points.push(this.points[c].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let c=0,p=e.points.length;c<p;c++){const _=e.points[c];this.points.push((new Un).fromArray(_))}return this}}uo.prototype.isSplineCurve=!0;var Jo=Object.freeze({__proto__:null,ArcCurve:np,CatmullRomCurve3:Nn,CubicBezierCurve:rp,CubicBezierCurve3:Lh,EllipseCurve:oc,LineCurve:Us,LineCurve3:oo,QuadraticBezierCurve:_a,QuadraticBezierCurve3:Ja,SplineCurve:uo});function zs(S,e,c,p,_){let w,L;if(_===function(O,F,U,te){let ce=0;for(let oe=F,de=U-te;oe<U;oe+=te)ce+=(O[de]-O[oe])*(O[oe+1]+O[de+1]),de=oe;return ce}(S,e,c,p)>0)for(w=e;w<c;w+=p)L=ta(w,S[w],S[w+1],L);else for(w=c-p;w>=e;w-=p)L=ta(w,S[w],S[w+1],L);return L&&sc(L,L.next)&&(Dp(L),L=L.next),L}function qi(S,e){if(!S)return S;e||(e=S);let c,p=S;do{if(c=!1,p.steiner||!sc(p,p.next)&&0!==po(p.prev,p,p.next))p=p.next;else{if(Dp(p),p=e=p.prev,p===p.next)break;c=!0}}while(c||p!==e);return e}function Ao(S,e,c,p,_,w,L){if(!S)return;!L&&w&&function(te,ce,oe,de){let ve=te;do{null===ve.z&&(ve.z=ea(ve.x,ve.y,ce,oe,de)),ve.prevZ=ve.prev,ve.nextZ=ve.next,ve=ve.next}while(ve!==te);ve.prevZ.nextZ=null,ve.prevZ=null,function(Me){let Be,Ae,ke,Je,We,rt,nt,gt,xt=1;do{for(Ae=Me,Me=null,We=null,rt=0;Ae;){for(rt++,ke=Ae,nt=0,Be=0;Be<xt&&(nt++,ke=ke.nextZ,ke);Be++);for(gt=xt;nt>0||gt>0&&ke;)0!==nt&&(0===gt||!ke||Ae.z<=ke.z)?(Je=Ae,Ae=Ae.nextZ,nt--):(Je=ke,ke=ke.nextZ,gt--),We?We.nextZ=Je:Me=Je,Je.prevZ=We,We=Je;Ae=ke}We.nextZ=null,xt*=2}while(rt>1)}(ve)}(S,p,_,w);let O,F,U=S;for(;S.prev!==S.next;)if(O=S.prev,F=S.next,w?Fl(S,p,_,w):Ba(S))e.push(O.i/c),e.push(S.i/c),e.push(F.i/c),Dp(S),S=F.next,U=F.next;else if((S=F)===U){L?1===L?Ao(S=Bh(qi(S),e,c),e,c,p,_,w,2):2===L&&ho(S,e,c,p,_,w):Ao(qi(S),e,c,p,_,w,1);break}}function Ba(S){const e=S.prev,c=S,p=S.next;if(po(e,c,p)>=0)return!1;let _=S.next.next;for(;_!==S.prev;){if(Nh(e.x,e.y,c.x,c.y,p.x,p.y,_.x,_.y)&&po(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function Fl(S,e,c,p){const _=S.prev,w=S,L=S.next;if(po(_,w,L)>=0)return!1;const U=_.x>w.x?_.x>L.x?_.x:L.x:w.x>L.x?w.x:L.x,te=_.y>w.y?_.y>L.y?_.y:L.y:w.y>L.y?w.y:L.y,ce=ea(_.x<w.x?_.x<L.x?_.x:L.x:w.x<L.x?w.x:L.x,_.y<w.y?_.y<L.y?_.y:L.y:w.y<L.y?w.y:L.y,e,c,p),oe=ea(U,te,e,c,p);let de=S.prevZ,ve=S.nextZ;for(;de&&de.z>=ce&&ve&&ve.z<=oe;){if(de!==S.prev&&de!==S.next&&Nh(_.x,_.y,w.x,w.y,L.x,L.y,de.x,de.y)&&po(de.prev,de,de.next)>=0||(de=de.prevZ,ve!==S.prev&&ve!==S.next&&Nh(_.x,_.y,w.x,w.y,L.x,L.y,ve.x,ve.y)&&po(ve.prev,ve,ve.next)>=0))return!1;ve=ve.nextZ}for(;de&&de.z>=ce;){if(de!==S.prev&&de!==S.next&&Nh(_.x,_.y,w.x,w.y,L.x,L.y,de.x,de.y)&&po(de.prev,de,de.next)>=0)return!1;de=de.prevZ}for(;ve&&ve.z<=oe;){if(ve!==S.prev&&ve!==S.next&&Nh(_.x,_.y,w.x,w.y,L.x,L.y,ve.x,ve.y)&&po(ve.prev,ve,ve.next)>=0)return!1;ve=ve.nextZ}return!0}function Bh(S,e,c){let p=S;do{const _=p.prev,w=p.next.next;!sc(_,w)&&ah(_,p,p.next,w)&&rs(_,w)&&rs(w,_)&&(e.push(_.i/c),e.push(p.i/c),e.push(w.i/c),Dp(p),Dp(p.next),p=S=w),p=p.next}while(p!==S);return qi(p)}function ho(S,e,c,p,_,w){let L=S;do{let O=L.next.next;for(;O!==L.prev;){if(L.i!==O.i&&ml(L,O)){let F=Qi(L,O);return L=qi(L,L.next),F=qi(F,F.next),Ao(L,e,c,p,_,w),void Ao(F,e,c,p,_,w)}O=O.next}L=L.next}while(L!==S)}function ga(S,e){return S.x-e.x}function fl(S,e){if(e=function(c,p){let _=p;const w=c.x,L=c.y;let O,F=-1/0;do{if(L<=_.y&&L>=_.next.y&&_.next.y!==_.y){const ve=_.x+(L-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(ve<=w&&ve>F){if(F=ve,ve===w){if(L===_.y)return _;if(L===_.next.y)return _.next}O=_.x<_.next.x?_:_.next}}_=_.next}while(_!==p);if(!O)return null;if(w===F)return O;const U=O,te=O.x,ce=O.y;let oe,de=1/0;_=O;do{w>=_.x&&_.x>=te&&w!==_.x&&Nh(L<ce?w:F,L,te,ce,L<ce?F:w,L,_.x,_.y)&&(oe=Math.abs(L-_.y)/(w-_.x),rs(_,c)&&(oe<de||oe===de&&(_.x>O.x||_.x===O.x&&su(O,_)))&&(O=_,de=oe)),_=_.next}while(_!==U);return O}(S,e)){const c=Qi(e,S);qi(e,e.next),qi(c,c.next)}}function su(S,e){return po(S.prev,S,e.prev)<0&&po(e.next,S,S.next)<0}function ea(S,e,c,p,_){return(S=1431655765&((S=858993459&((S=252645135&((S=16711935&((S=32767*(S-c)*_)|S<<8))|S<<4))|S<<2))|S<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-p)*_)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function us(S){let e=S,c=S;do{(e.x<c.x||e.x===c.x&&e.y<c.y)&&(c=e),e=e.next}while(e!==S);return c}function Nh(S,e,c,p,_,w,L,O){return(_-L)*(e-O)-(S-L)*(w-O)>=0&&(S-L)*(p-O)-(c-L)*(e-O)>=0&&(c-L)*(w-O)-(_-L)*(p-O)>=0}function ml(S,e){return S.next.i!==e.i&&S.prev.i!==e.i&&!function(c,p){let _=c;do{if(_.i!==c.i&&_.next.i!==c.i&&_.i!==p.i&&_.next.i!==p.i&&ah(_,_.next,c,p))return!0;_=_.next}while(_!==c);return!1}(S,e)&&(rs(S,e)&&rs(e,S)&&function(c,p){let _=c,w=!1;const L=(c.x+p.x)/2,O=(c.y+p.y)/2;do{_.y>O!=_.next.y>O&&_.next.y!==_.y&&L<(_.next.x-_.x)*(O-_.y)/(_.next.y-_.y)+_.x&&(w=!w),_=_.next}while(_!==c);return w}(S,e)&&(po(S.prev,S,e.prev)||po(S,e.prev,e))||sc(S,e)&&po(S.prev,S,S.next)>0&&po(e.prev,e,e.next)>0)}function po(S,e,c){return(e.y-S.y)*(c.x-e.x)-(e.x-S.x)*(c.y-e.y)}function sc(S,e){return S.x===e.x&&S.y===e.y}function ah(S,e,c,p){const _=ac(po(S,e,c)),w=ac(po(S,e,p)),L=ac(po(c,p,S)),O=ac(po(c,p,e));return _!==w&&L!==O||!(0!==_||!lh(S,c,e))||!(0!==w||!lh(S,p,e))||!(0!==L||!lh(c,S,p))||!(0!==O||!lh(c,e,p))}function lh(S,e,c){return e.x<=Math.max(S.x,c.x)&&e.x>=Math.min(S.x,c.x)&&e.y<=Math.max(S.y,c.y)&&e.y>=Math.min(S.y,c.y)}function ac(S){return S>0?1:S<0?-1:0}function rs(S,e){return po(S.prev,S,S.next)<0?po(S,e,S.next)>=0&&po(S,S.prev,e)>=0:po(S,e,S.prev)<0||po(S,S.next,e)<0}function Qi(S,e){const c=new Td(S.i,S.x,S.y),p=new Td(e.i,e.x,e.y),_=S.next,w=e.prev;return S.next=e,e.prev=S,c.next=_,_.prev=c,p.next=c,c.prev=p,w.next=p,p.prev=w,p}function ta(S,e,c,p){const _=new Td(S,e,c);return p?(_.next=p.next,_.prev=p,p.next.prev=_,p.next=_):(_.prev=_,_.next=_),_}function Dp(S){S.next.prev=S.prev,S.prev.next=S.next,S.prevZ&&(S.prevZ.nextZ=S.nextZ),S.nextZ&&(S.nextZ.prevZ=S.prevZ)}function Td(S,e,c){this.i=S,this.x=e,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class hi{static area(e){const c=e.length;let p=0;for(let _=c-1,w=0;w<c;_=w++)p+=e[_].x*e[w].y-e[w].x*e[_].y;return.5*p}static isClockWise(e){return hi.area(e)<0}static triangulateShape(e,c){const p=[],_=[],w=[];Rc(e),Dl(p,e);let L=e.length;c.forEach(Rc);for(let F=0;F<c.length;F++)_.push(L),L+=c[F].length,Dl(p,c[F]);const O=function(F,U,te=2){const ce=U&&U.length,oe=ce?U[0]*te:F.length;let de=zs(F,0,oe,te,!0);const ve=[];if(!de||de.next===de.prev)return ve;let Me,Be,Ae,ke,Je,We,rt;if(ce&&(de=function(nt,gt,xt,Ut){const Ht=[];let Ye,pt,Vt,Rt,lt;for(Ye=0,pt=gt.length;Ye<pt;Ye++)Vt=gt[Ye]*Ut,Rt=Ye<pt-1?gt[Ye+1]*Ut:nt.length,lt=zs(nt,Vt,Rt,Ut,!1),lt===lt.next&&(lt.steiner=!0),Ht.push(us(lt));for(Ht.sort(ga),Ye=0;Ye<Ht.length;Ye++)fl(Ht[Ye],xt),xt=qi(xt,xt.next);return xt}(F,U,de,te)),F.length>80*te){Me=Ae=F[0],Be=ke=F[1];for(let nt=te;nt<oe;nt+=te)Je=F[nt],We=F[nt+1],Je<Me&&(Me=Je),We<Be&&(Be=We),Je>Ae&&(Ae=Je),We>ke&&(ke=We);rt=Math.max(Ae-Me,ke-Be),rt=0!==rt?1/rt:0}return Ao(de,ve,te,Me,Be,rt),ve}(p,_);for(let F=0;F<O.length;F+=3)w.push(O.slice(F,F+3));return w}}function Rc(S){const e=S.length;e>2&&S[e-1].equals(S[0])&&S.pop()}function Dl(S,e){for(let c=0;c<e.length;c++)S.push(e[c].x),S.push(e[c].y)}class Ul extends gr{constructor(e,c){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:c},e=Array.isArray(e)?e:[e];const p=this,_=[],w=[];for(let O=0,F=e.length;O<F;O++)L(e[O]);function L(O){const F=[],U=void 0!==c.curveSegments?c.curveSegments:12,te=void 0!==c.steps?c.steps:1;let ce=void 0!==c.depth?c.depth:100,oe=void 0===c.bevelEnabled||c.bevelEnabled,de=void 0!==c.bevelThickness?c.bevelThickness:6,ve=void 0!==c.bevelSize?c.bevelSize:de-2,Me=void 0!==c.bevelOffset?c.bevelOffset:0,Be=void 0!==c.bevelSegments?c.bevelSegments:3;const Ae=c.extrudePath,ke=void 0!==c.UVGenerator?c.UVGenerator:Md;void 0!==c.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),ce=c.amount);let Je,We,rt,nt,gt,xt=!1;Ae&&(Je=Ae.getSpacedPoints(te),xt=!0,oe=!1,We=Ae.computeFrenetFrames(te,!1),rt=new at,nt=new at,gt=new at),oe||(Be=0,de=0,ve=0,Me=0);const Ut=O.extractPoints(U);let Ht=Ut.shape;const Ye=Ut.holes;if(!hi.isClockWise(Ht)){Ht=Ht.reverse();for(let sn=0,dt=Ye.length;sn<dt;sn++){const an=Ye[sn];hi.isClockWise(an)&&(Ye[sn]=an.reverse())}}const pt=hi.triangulateShape(Ht,Ye),Vt=Ht;for(let sn=0,dt=Ye.length;sn<dt;sn++)Ht=Ht.concat(Ye[sn]);function Rt(sn,dt,an){return dt||console.error("THREE.ExtrudeGeometry: vec does not exist"),dt.clone().multiplyScalar(an).add(sn)}const lt=Ht.length,Jt=pt.length;function St(sn,dt,an){let Tn,un,Wt;const vr=sn.x-dt.x,hr=sn.y-dt.y,Br=an.x-sn.x,zi=an.y-sn.y,bo=vr*vr+hr*hr;if(Math.abs(vr*zi-hr*Br)>Number.EPSILON){const Wo=Math.sqrt(bo),gl=Math.sqrt(Br*Br+zi*zi),lu=dt.x-hr/Wo,hp=dt.y+vr/Wo,Id=((an.x-zi/gl-lu)*zi-(an.y+Br/gl-hp)*Br)/(vr*zi-hr*Br);Tn=lu+vr*Id-sn.x,un=hp+hr*Id-sn.y;const Od=Tn*Tn+un*un;if(Od<=2)return new Un(Tn,un);Wt=Math.sqrt(Od/2)}else{let Wo=!1;vr>Number.EPSILON?Br>Number.EPSILON&&(Wo=!0):vr<-Number.EPSILON?Br<-Number.EPSILON&&(Wo=!0):Math.sign(hr)===Math.sign(zi)&&(Wo=!0),Wo?(Tn=-hr,un=vr,Wt=Math.sqrt(bo)):(Tn=vr,un=hr,Wt=Math.sqrt(bo/2))}return new Un(Tn/Wt,un/Wt)}const jt=[];for(let sn=0,dt=Vt.length,an=dt-1,Tn=sn+1;sn<dt;sn++,an++,Tn++)an===dt&&(an=0),Tn===dt&&(Tn=0),jt[sn]=St(Vt[sn],Vt[an],Vt[Tn]);const It=[];let ln,Ze=jt.concat();for(let sn=0,dt=Ye.length;sn<dt;sn++){const an=Ye[sn];ln=[];for(let Tn=0,un=an.length,Wt=un-1,vr=Tn+1;Tn<un;Tn++,Wt++,vr++)Wt===un&&(Wt=0),vr===un&&(vr=0),ln[Tn]=St(an[Tn],an[Wt],an[vr]);It.push(ln),Ze=Ze.concat(ln)}for(let sn=0;sn<Be;sn++){const dt=sn/Be,an=de*Math.cos(dt*Math.PI/2),Tn=ve*Math.sin(dt*Math.PI/2)+Me;for(let un=0,Wt=Vt.length;un<Wt;un++){const vr=Rt(Vt[un],jt[un],Tn);Gt(vr.x,vr.y,-an)}for(let un=0,Wt=Ye.length;un<Wt;un++){const vr=Ye[un];ln=It[un];for(let hr=0,Br=vr.length;hr<Br;hr++){const zi=Rt(vr[hr],ln[hr],Tn);Gt(zi.x,zi.y,-an)}}}const st=ve+Me;for(let sn=0;sn<lt;sn++){const dt=oe?Rt(Ht[sn],Ze[sn],st):Ht[sn];xt?(nt.copy(We.normals[0]).multiplyScalar(dt.x),rt.copy(We.binormals[0]).multiplyScalar(dt.y),gt.copy(Je[0]).add(nt).add(rt),Gt(gt.x,gt.y,gt.z)):Gt(dt.x,dt.y,0)}for(let sn=1;sn<=te;sn++)for(let dt=0;dt<lt;dt++){const an=oe?Rt(Ht[dt],Ze[dt],st):Ht[dt];xt?(nt.copy(We.normals[sn]).multiplyScalar(an.x),rt.copy(We.binormals[sn]).multiplyScalar(an.y),gt.copy(Je[sn]).add(nt).add(rt),Gt(gt.x,gt.y,gt.z)):Gt(an.x,an.y,ce/te*sn)}for(let sn=Be-1;sn>=0;sn--){const dt=sn/Be,an=de*Math.cos(dt*Math.PI/2),Tn=ve*Math.sin(dt*Math.PI/2)+Me;for(let un=0,Wt=Vt.length;un<Wt;un++){const vr=Rt(Vt[un],jt[un],Tn);Gt(vr.x,vr.y,ce+an)}for(let un=0,Wt=Ye.length;un<Wt;un++){const vr=Ye[un];ln=It[un];for(let hr=0,Br=vr.length;hr<Br;hr++){const zi=Rt(vr[hr],ln[hr],Tn);xt?Gt(zi.x,zi.y+Je[te-1].y,Je[te-1].x+an):Gt(zi.x,zi.y,ce+an)}}}function Pt(sn,dt){let an=sn.length;for(;--an>=0;){const Tn=an;let un=an-1;un<0&&(un=sn.length-1);for(let Wt=0,vr=te+2*Be;Wt<vr;Wt++){const hr=lt*Wt,Br=lt*(Wt+1);Mn(dt+Tn+hr,dt+un+hr,dt+un+Br,dt+Tn+Br)}}}function Gt(sn,dt,an){F.push(sn),F.push(dt),F.push(an)}function tn(sn,dt,an){Yn(sn),Yn(dt),Yn(an);const Tn=_.length/3,un=ke.generateTopUV(p,_,Tn-3,Tn-2,Tn-1);Vn(un[0]),Vn(un[1]),Vn(un[2])}function Mn(sn,dt,an,Tn){Yn(sn),Yn(dt),Yn(Tn),Yn(dt),Yn(an),Yn(Tn);const un=_.length/3,Wt=ke.generateSideWallUV(p,_,un-6,un-3,un-2,un-1);Vn(Wt[0]),Vn(Wt[1]),Vn(Wt[3]),Vn(Wt[1]),Vn(Wt[2]),Vn(Wt[3])}function Yn(sn){_.push(F[3*sn+0]),_.push(F[3*sn+1]),_.push(F[3*sn+2])}function Vn(sn){w.push(sn.x),w.push(sn.y)}(function(){const sn=_.length/3;if(oe){let dt=0,an=lt*dt;for(let Tn=0;Tn<Jt;Tn++){const un=pt[Tn];tn(un[2]+an,un[1]+an,un[0]+an)}dt=te+2*Be,an=lt*dt;for(let Tn=0;Tn<Jt;Tn++){const un=pt[Tn];tn(un[0]+an,un[1]+an,un[2]+an)}}else{for(let dt=0;dt<Jt;dt++){const an=pt[dt];tn(an[2],an[1],an[0])}for(let dt=0;dt<Jt;dt++){const an=pt[dt];tn(an[0]+lt*te,an[1]+lt*te,an[2]+lt*te)}}p.addGroup(sn,_.length/3-sn,0)})(),function(){const sn=_.length/3;let dt=0;Pt(Vt,dt),dt+=Vt.length;for(let an=0,Tn=Ye.length;an<Tn;an++){const un=Ye[an];Pt(un,dt),dt+=un.length}p.addGroup(sn,_.length/3-sn,1)}()}this.setAttribute("position",new pn(_,3)),this.setAttribute("uv",new pn(w,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(c,p,_){if(_.shapes=[],Array.isArray(c))for(let w=0,L=c.length;w<L;w++)_.shapes.push(c[w].uuid);else _.shapes.push(c.uuid);return void 0!==p.extrudePath&&(_.options.extrudePath=p.extrudePath.toJSON()),_}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,c){const p=[];for(let w=0,L=e.shapes.length;w<L;w++)p.push(c[e.shapes[w]]);const _=e.options.extrudePath;return void 0!==_&&(e.options.extrudePath=(new Jo[_.type]).fromJSON(_)),new Ul(p,e.options)}}const Md={generateTopUV:function(S,e,c,p,_){const O=e[3*p],F=e[3*p+1],U=e[3*_],te=e[3*_+1];return[new Un(e[3*c],e[3*c+1]),new Un(O,F),new Un(U,te)]},generateSideWallUV:function(S,e,c,p,_,w){const L=e[3*c],O=e[3*c+1],F=e[3*c+2],U=e[3*p],te=e[3*p+1],ce=e[3*p+2],oe=e[3*_],de=e[3*_+1],ve=e[3*_+2],Me=e[3*w],Be=e[3*w+1],Ae=e[3*w+2];return Math.abs(O-te)<Math.abs(L-U)?[new Un(L,1-F),new Un(U,1-ce),new Un(oe,1-ve),new Un(Me,1-Ae)]:[new Un(O,1-F),new Un(te,1-ce),new Un(de,1-ve),new Un(Be,1-Ae)]}};class Pc extends ma{constructor(e=1,c=0){const p=(1+Math.sqrt(5))/2;super([-1,p,0,1,p,0,-1,-p,0,1,-p,0,0,-1,p,0,1,p,0,-1,-p,0,1,-p,p,0,-1,p,0,1,-p,0,-1,-p,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,c),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new Pc(e.radius,e.detail)}}class Za extends gr{constructor(e,c=12,p=0,_=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:c,phiStart:p,phiLength:_},c=Math.floor(c),_=Gr(_,0,2*Math.PI);const w=[],L=[],O=[],F=1/c,U=new at,te=new Un;for(let ce=0;ce<=c;ce++){const oe=p+ce*F*_,de=Math.sin(oe),ve=Math.cos(oe);for(let Me=0;Me<=e.length-1;Me++)U.x=e[Me].x*de,U.y=e[Me].y,U.z=e[Me].x*ve,L.push(U.x,U.y,U.z),te.x=ce/c,te.y=Me/(e.length-1),O.push(te.x,te.y)}for(let ce=0;ce<c;ce++)for(let oe=0;oe<e.length-1;oe++){const de=oe+ce*e.length,Me=de+e.length,Be=de+e.length+1,Ae=de+1;w.push(de,Me,Ae),w.push(Me,Be,Ae)}if(this.setIndex(w),this.setAttribute("position",new pn(L,3)),this.setAttribute("uv",new pn(O,2)),this.computeVertexNormals(),_===2*Math.PI){const ce=this.attributes.normal.array,oe=new at,de=new at,ve=new at,Me=c*e.length*3;for(let Be=0,Ae=0;Be<e.length;Be++,Ae+=3)oe.x=ce[Ae+0],oe.y=ce[Ae+1],oe.z=ce[Ae+2],de.x=ce[Me+Ae+0],de.y=ce[Me+Ae+1],de.z=ce[Me+Ae+2],ve.addVectors(oe,de).normalize(),ce[Ae+0]=ce[Me+Ae+0]=ve.x,ce[Ae+1]=ce[Me+Ae+1]=ve.y,ce[Ae+2]=ce[Me+Ae+2]=ve.z}}static fromJSON(e){return new Za(e.points,e.segments,e.phiStart,e.phiLength)}}class Rh extends ma{constructor(e=1,c=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,c),this.type="OctahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new Rh(e.radius,e.detail)}}class Si extends gr{constructor(e,c,p){super(),this.type="ParametricGeometry",this.parameters={func:e,slices:c,stacks:p};const _=[],w=[],L=[],O=[],F=1e-5,U=new at,te=new at,ce=new at,oe=new at,de=new at;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const ve=c+1;for(let Me=0;Me<=p;Me++){const Be=Me/p;for(let Ae=0;Ae<=c;Ae++){const ke=Ae/c;e(ke,Be,te),w.push(te.x,te.y,te.z),ke-F>=0?(e(ke-F,Be,ce),oe.subVectors(te,ce)):(e(ke+F,Be,ce),oe.subVectors(ce,te)),Be-F>=0?(e(ke,Be-F,ce),de.subVectors(te,ce)):(e(ke,Be+F,ce),de.subVectors(ce,te)),U.crossVectors(oe,de).normalize(),L.push(U.x,U.y,U.z),O.push(ke,Be)}}for(let Me=0;Me<p;Me++)for(let Be=0;Be<c;Be++){const ke=Me*ve+Be+1,Je=(Me+1)*ve+Be+1,We=(Me+1)*ve+Be;_.push(Me*ve+Be,ke,We),_.push(ke,Je,We)}this.setIndex(_),this.setAttribute("position",new pn(w,3)),this.setAttribute("normal",new pn(L,3)),this.setAttribute("uv",new pn(O,2))}}class yr extends gr{constructor(e=.5,c=1,p=8,_=1,w=0,L=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:c,thetaSegments:p,phiSegments:_,thetaStart:w,thetaLength:L},p=Math.max(3,p);const O=[],F=[],U=[],te=[];let ce=e;const oe=(c-e)/(_=Math.max(1,_)),de=new at,ve=new Un;for(let Me=0;Me<=_;Me++){for(let Be=0;Be<=p;Be++){const Ae=w+Be/p*L;de.x=ce*Math.cos(Ae),de.y=ce*Math.sin(Ae),F.push(de.x,de.y,de.z),U.push(0,0,1),ve.x=(de.x/c+1)/2,ve.y=(de.y/c+1)/2,te.push(ve.x,ve.y)}ce+=oe}for(let Me=0;Me<_;Me++){const Be=Me*(p+1);for(let Ae=0;Ae<p;Ae++){const ke=Ae+Be,We=ke+p+1,rt=ke+p+2,nt=ke+1;O.push(ke,We,nt),O.push(We,rt,nt)}}this.setIndex(O),this.setAttribute("position",new pn(F,3)),this.setAttribute("normal",new pn(U,3)),this.setAttribute("uv",new pn(te,2))}static fromJSON(e){return new yr(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class a extends gr{constructor(e,c=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:c};const p=[],_=[],w=[],L=[];let O=0,F=0;if(!1===Array.isArray(e))U(e);else for(let te=0;te<e.length;te++)U(e[te]),this.addGroup(O,F,te),O+=F,F=0;function U(te){const ce=_.length/3,oe=te.extractPoints(c);let de=oe.shape;const ve=oe.holes;!1===hi.isClockWise(de)&&(de=de.reverse());for(let Be=0,Ae=ve.length;Be<Ae;Be++){const ke=ve[Be];!0===hi.isClockWise(ke)&&(ve[Be]=ke.reverse())}const Me=hi.triangulateShape(de,ve);for(let Be=0,Ae=ve.length;Be<Ae;Be++)de=de.concat(ve[Be]);for(let Be=0,Ae=de.length;Be<Ae;Be++){const ke=de[Be];_.push(ke.x,ke.y,0),w.push(0,0,1),L.push(ke.x,ke.y)}for(let Be=0,Ae=Me.length;Be<Ae;Be++){const ke=Me[Be];p.push(ke[0]+ce,ke[1]+ce,ke[2]+ce),F+=3}}this.setIndex(p),this.setAttribute("position",new pn(_,3)),this.setAttribute("normal",new pn(w,3)),this.setAttribute("uv",new pn(L,2))}toJSON(){const e=super.toJSON();return function(c,p){if(p.shapes=[],Array.isArray(c))for(let _=0,w=c.length;_<w;_++)p.shapes.push(c[_].uuid);else p.shapes.push(c.uuid);return p}(this.parameters.shapes,e)}static fromJSON(e,c){const p=[];for(let _=0,w=e.shapes.length;_<w;_++)p.push(c[e.shapes[_]]);return new a(p,e.curveSegments)}}class r extends gr{constructor(e=1,c=32,p=16,_=0,w=2*Math.PI,L=0,O=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:c,heightSegments:p,phiStart:_,phiLength:w,thetaStart:L,thetaLength:O},c=Math.max(3,Math.floor(c)),p=Math.max(2,Math.floor(p));const F=Math.min(L+O,Math.PI);let U=0;const te=[],ce=new at,oe=new at,de=[],ve=[],Me=[],Be=[];for(let Ae=0;Ae<=p;Ae++){const ke=[],Je=Ae/p;let We=0;0==Ae&&0==L?We=.5/c:Ae==p&&F==Math.PI&&(We=-.5/c);for(let rt=0;rt<=c;rt++){const nt=rt/c;ce.x=-e*Math.cos(_+nt*w)*Math.sin(L+Je*O),ce.y=e*Math.cos(L+Je*O),ce.z=e*Math.sin(_+nt*w)*Math.sin(L+Je*O),ve.push(ce.x,ce.y,ce.z),oe.copy(ce).normalize(),Me.push(oe.x,oe.y,oe.z),Be.push(nt+We,1-Je),ke.push(U++)}te.push(ke)}for(let Ae=0;Ae<p;Ae++)for(let ke=0;ke<c;ke++){const We=te[Ae][ke],rt=te[Ae+1][ke],nt=te[Ae+1][ke+1];(0!==Ae||L>0)&&de.push(te[Ae][ke+1],We,nt),(Ae!==p-1||F<Math.PI)&&de.push(We,rt,nt)}this.setIndex(de),this.setAttribute("position",new pn(ve,3)),this.setAttribute("normal",new pn(Me,3)),this.setAttribute("uv",new pn(Be,2))}static fromJSON(e){return new r(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class h extends ma{constructor(e=1,c=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,c),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new h(e.radius,e.detail)}}class d extends Ul{constructor(e,c={}){const p=c.font;if(!p||!p.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new gr;const _=p.generateShapes(e,c.size);c.depth=void 0!==c.height?c.height:50,void 0===c.bevelThickness&&(c.bevelThickness=10),void 0===c.bevelSize&&(c.bevelSize=8),void 0===c.bevelEnabled&&(c.bevelEnabled=!1),super(_,c),this.type="TextGeometry"}}class y extends gr{constructor(e=1,c=.4,p=8,_=6,w=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:c,radialSegments:p,tubularSegments:_,arc:w},p=Math.floor(p),_=Math.floor(_);const L=[],O=[],F=[],U=[],te=new at,ce=new at,oe=new at;for(let de=0;de<=p;de++)for(let ve=0;ve<=_;ve++){const Me=ve/_*w,Be=de/p*Math.PI*2;ce.x=(e+c*Math.cos(Be))*Math.cos(Me),ce.y=(e+c*Math.cos(Be))*Math.sin(Me),ce.z=c*Math.sin(Be),O.push(ce.x,ce.y,ce.z),te.x=e*Math.cos(Me),te.y=e*Math.sin(Me),oe.subVectors(ce,te).normalize(),F.push(oe.x,oe.y,oe.z),U.push(ve/_),U.push(de/p)}for(let de=1;de<=p;de++)for(let ve=1;ve<=_;ve++){const Be=(_+1)*(de-1)+ve-1,Ae=(_+1)*(de-1)+ve,ke=(_+1)*de+ve;L.push((_+1)*de+ve-1,Be,ke),L.push(Be,Ae,ke)}this.setIndex(L),this.setAttribute("position",new pn(O,3)),this.setAttribute("normal",new pn(F,3)),this.setAttribute("uv",new pn(U,2))}static fromJSON(e){return new y(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class b extends gr{constructor(e=1,c=.4,p=64,_=8,w=2,L=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:c,tubularSegments:p,radialSegments:_,p:w,q:L},p=Math.floor(p),_=Math.floor(_);const O=[],F=[],U=[],te=[],ce=new at,oe=new at,de=new at,ve=new at,Me=new at,Be=new at,Ae=new at;for(let Je=0;Je<=p;++Je){const We=Je/p*w*Math.PI*2;ke(We,w,L,e,de),ke(We+.01,w,L,e,ve),Be.subVectors(ve,de),Ae.addVectors(ve,de),Me.crossVectors(Be,Ae),Ae.crossVectors(Me,Be),Me.normalize(),Ae.normalize();for(let rt=0;rt<=_;++rt){const nt=rt/_*Math.PI*2,gt=-c*Math.cos(nt),xt=c*Math.sin(nt);ce.x=de.x+(gt*Ae.x+xt*Me.x),ce.y=de.y+(gt*Ae.y+xt*Me.y),ce.z=de.z+(gt*Ae.z+xt*Me.z),F.push(ce.x,ce.y,ce.z),oe.subVectors(ce,de).normalize(),U.push(oe.x,oe.y,oe.z),te.push(Je/p),te.push(rt/_)}}for(let Je=1;Je<=p;Je++)for(let We=1;We<=_;We++){const nt=(_+1)*Je+(We-1),gt=(_+1)*Je+We,xt=(_+1)*(Je-1)+We;O.push((_+1)*(Je-1)+(We-1),nt,xt),O.push(nt,gt,xt)}function ke(Je,We,rt,nt,gt){const xt=Math.cos(Je),Ut=Math.sin(Je),Ht=rt/We*Je,Ye=Math.cos(Ht);gt.x=nt*(2+Ye)*.5*xt,gt.y=nt*(2+Ye)*Ut*.5,gt.z=nt*Math.sin(Ht)*.5}this.setIndex(O),this.setAttribute("position",new pn(F,3)),this.setAttribute("normal",new pn(U,3)),this.setAttribute("uv",new pn(te,2))}static fromJSON(e){return new b(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class N extends gr{constructor(e,c=64,p=1,_=8,w=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:c,radius:p,radialSegments:_,closed:w};const L=e.computeFrenetFrames(c,w);this.tangents=L.tangents,this.normals=L.normals,this.binormals=L.binormals;const O=new at,F=new at,U=new Un;let te=new at;const ce=[],oe=[],de=[],ve=[];function Me(Be){te=e.getPointAt(Be/c,te);const Ae=L.normals[Be],ke=L.binormals[Be];for(let Je=0;Je<=_;Je++){const We=Je/_*Math.PI*2,rt=Math.sin(We),nt=-Math.cos(We);F.x=nt*Ae.x+rt*ke.x,F.y=nt*Ae.y+rt*ke.y,F.z=nt*Ae.z+rt*ke.z,F.normalize(),oe.push(F.x,F.y,F.z),O.x=te.x+p*F.x,O.y=te.y+p*F.y,O.z=te.z+p*F.z,ce.push(O.x,O.y,O.z)}}(function(){for(let Be=0;Be<c;Be++)Me(Be);Me(!1===w?c:0),function(){for(let Be=0;Be<=c;Be++)for(let Ae=0;Ae<=_;Ae++)U.x=Be/c,U.y=Ae/_,de.push(U.x,U.y)}(),function(){for(let Be=1;Be<=c;Be++)for(let Ae=1;Ae<=_;Ae++){const Je=(_+1)*Be+(Ae-1),We=(_+1)*Be+Ae,rt=(_+1)*(Be-1)+Ae;ve.push((_+1)*(Be-1)+(Ae-1),Je,rt),ve.push(Je,We,rt)}}()})(),this.setIndex(ve),this.setAttribute("position",new pn(ce,3)),this.setAttribute("normal",new pn(oe,3)),this.setAttribute("uv",new pn(de,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new N((new Jo[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class k extends gr{constructor(e){if(super(),this.type="WireframeGeometry",!0===e.isGeometry)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const c=[],p=new Set,_=new at,w=new at;if(null!==e.index){const L=e.attributes.position,O=e.index;let F=e.groups;0===F.length&&(F=[{start:0,count:O.count,materialIndex:0}]);for(let U=0,te=F.length;U<te;++U){const ce=F[U],oe=ce.start;for(let de=oe,ve=oe+ce.count;de<ve;de+=3)for(let Me=0;Me<3;Me++){const Be=O.getX(de+Me),Ae=O.getX(de+(Me+1)%3);_.fromBufferAttribute(L,Be),w.fromBufferAttribute(L,Ae),!0===T(_,w,p)&&(c.push(_.x,_.y,_.z),c.push(w.x,w.y,w.z))}}}else{const L=e.attributes.position;for(let O=0,F=L.count/3;O<F;O++)for(let U=0;U<3;U++){const ce=3*O+(U+1)%3;_.fromBufferAttribute(L,3*O+U),w.fromBufferAttribute(L,ce),!0===T(_,w,p)&&(c.push(_.x,_.y,_.z),c.push(w.x,w.y,w.z))}}this.setAttribute("position",new pn(c,3))}}function T(S,e,c){const p=`${S.x},${S.y},${S.z}-${e.x},${e.y},${e.z}`,_=`${e.x},${e.y},${e.z}-${S.x},${S.y},${S.z}`;return!0!==c.has(p)&&!0!==c.has(_)&&(c.add(p,_),!0)}var H=Object.freeze({__proto__:null,BoxGeometry:Jl,BoxBufferGeometry:Jl,CircleGeometry:Fp,CircleBufferGeometry:Fp,ConeGeometry:ou,ConeBufferGeometry:ou,CylinderGeometry:sh,CylinderBufferGeometry:sh,DodecahedronGeometry:od,DodecahedronBufferGeometry:od,EdgesGeometry:Ru,ExtrudeGeometry:Ul,ExtrudeBufferGeometry:Ul,IcosahedronGeometry:Pc,IcosahedronBufferGeometry:Pc,LatheGeometry:Za,LatheBufferGeometry:Za,OctahedronGeometry:Rh,OctahedronBufferGeometry:Rh,ParametricGeometry:Si,ParametricBufferGeometry:Si,PlaneGeometry:xu,PlaneBufferGeometry:xu,PolyhedronGeometry:ma,PolyhedronBufferGeometry:ma,RingGeometry:yr,RingBufferGeometry:yr,ShapeGeometry:a,ShapeBufferGeometry:a,SphereGeometry:r,SphereBufferGeometry:r,TetrahedronGeometry:h,TetrahedronBufferGeometry:h,TextGeometry:d,TextBufferGeometry:d,TorusGeometry:y,TorusBufferGeometry:y,TorusKnotGeometry:b,TorusKnotBufferGeometry:b,TubeGeometry:N,TubeBufferGeometry:N,WireframeGeometry:k});class Y extends $s{constructor(e){super(),this.type="ShadowMaterial",this.color=new Qn(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}Y.prototype.isShadowMaterial=!0;class le extends $s{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Qn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}le.prototype.isMeshStandardMaterial=!0;class ae extends le{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Un(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Gr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}}),this.sheenTint=new Qn(0),this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationTint=new Qn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularTint=new Qn(1,1,1),this.specularTintMap=null,this._clearcoat=0,this._transmission=0,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheenTint.copy(e.sheenTint),this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationTint.copy(e.attenuationTint),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularTint.copy(e.specularTint),this.specularTintMap=e.specularTintMap,this}}ae.prototype.isMeshPhysicalMaterial=!0;class ge extends $s{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Qn(16777215),this.specular=new Qn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}ge.prototype.isMeshPhongMaterial=!0;class we extends $s{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Qn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}we.prototype.isMeshToonMaterial=!0;class Se extends $s{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}Se.prototype.isMeshNormalMaterial=!0;class $e extends $s{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Qn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}$e.prototype.isMeshLambertMaterial=!0;class Re extends $s{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Qn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}Re.prototype.isMeshMatcapMaterial=!0;class Pe extends wi{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}Pe.prototype.isLineDashedMaterial=!0;var Oe=Object.freeze({__proto__:null,ShadowMaterial:Y,SpriteMaterial:td,RawShaderMaterial:Su,ShaderMaterial:Rs,PointsMaterial:br,MeshPhysicalMaterial:ae,MeshStandardMaterial:le,MeshPhongMaterial:ge,MeshToonMaterial:we,MeshNormalMaterial:Se,MeshLambertMaterial:$e,MeshDepthMaterial:Sh,MeshDistanceMaterial:Kp,MeshBasicMaterial:sl,MeshMatcapMaterial:Re,LineDashedMaterial:Pe,LineBasicMaterial:wi,Material:$s});const Fe={arraySlice:function(S,e,c){return Fe.isTypedArray(S)?new S.constructor(S.subarray(e,void 0!==c?c:S.length)):S.slice(e,c)},convertArray:function(S,e,c){return!S||!c&&S.constructor===e?S:"number"==typeof e.BYTES_PER_ELEMENT?new e(S):Array.prototype.slice.call(S)},isTypedArray:function(S){return ArrayBuffer.isView(S)&&!(S instanceof DataView)},getKeyframeOrder:function(S){const e=S.length,c=new Array(e);for(let p=0;p!==e;++p)c[p]=p;return c.sort(function(p,_){return S[p]-S[_]}),c},sortedArray:function(S,e,c){const p=S.length,_=new S.constructor(p);for(let w=0,L=0;L!==p;++w){const O=c[w]*e;for(let F=0;F!==e;++F)_[L++]=S[O+F]}return _},flattenJSON:function(S,e,c,p){let _=1,w=S[0];for(;void 0!==w&&void 0===w[p];)w=S[_++];if(void 0===w)return;let L=w[p];if(void 0!==L)if(Array.isArray(L))do{L=w[p],void 0!==L&&(e.push(w.time),c.push.apply(c,L)),w=S[_++]}while(void 0!==w);else if(void 0!==L.toArray)do{L=w[p],void 0!==L&&(e.push(w.time),L.toArray(c,c.length)),w=S[_++]}while(void 0!==w);else do{L=w[p],void 0!==L&&(e.push(w.time),c.push(L)),w=S[_++]}while(void 0!==w)},subclip:function(S,e,c,p,_=30){const w=S.clone();w.name=e;const L=[];for(let F=0;F<w.tracks.length;++F){const U=w.tracks[F],te=U.getValueSize(),ce=[],oe=[];for(let de=0;de<U.times.length;++de){const ve=U.times[de]*_;if(!(ve<c||ve>=p)){ce.push(U.times[de]);for(let Me=0;Me<te;++Me)oe.push(U.values[de*te+Me])}}0!==ce.length&&(U.times=Fe.convertArray(ce,U.times.constructor),U.values=Fe.convertArray(oe,U.values.constructor),L.push(U))}w.tracks=L;let O=1/0;for(let F=0;F<w.tracks.length;++F)O>w.tracks[F].times[0]&&(O=w.tracks[F].times[0]);for(let F=0;F<w.tracks.length;++F)w.tracks[F].shift(-1*O);return w.resetDuration(),w},makeClipAdditive:function(S,e=0,c=S,p=30){p<=0&&(p=30);const _=c.tracks.length,w=e/p;for(let L=0;L<_;++L){const O=c.tracks[L],F=O.ValueTypeName;if("bool"===F||"string"===F)continue;const U=S.tracks.find(function(Ae){return Ae.name===O.name&&Ae.ValueTypeName===F});if(void 0===U)continue;let te=0;const ce=O.getValueSize();O.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(te=ce/3);let oe=0;const de=U.getValueSize();U.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(oe=de/3);const ve=O.times.length-1;let Me;if(w<=O.times[0])Me=Fe.arraySlice(O.values,te,ce-te);else if(w>=O.times[ve]){const Ae=ve*ce+te;Me=Fe.arraySlice(O.values,Ae,Ae+ce-te)}else{const Ae=O.createInterpolant(),ke=te,Je=ce-te;Ae.evaluate(w),Me=Fe.arraySlice(Ae.resultBuffer,ke,Je)}"quaternion"===F&&(new Ci).fromArray(Me).normalize().conjugate().toArray(Me);const Be=U.times.length;for(let Ae=0;Ae<Be;++Ae){const ke=Ae*de+oe;if("quaternion"===F)Ci.multiplyQuaternionsFlat(U.values,ke,Me,0,U.values,ke);else{const Je=de-2*oe;for(let We=0;We<Je;++We)U.values[ke+We]-=Me[We]}}}return S.blendMode=Wu,S}};class De{constructor(e,c,p,_){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==_?_:new c.constructor(p),this.sampleValues=c,this.valueSize=p,this.settings=null,this.DefaultSettings_={}}evaluate(e){const c=this.parameterPositions;let p=this._cachedIndex,_=c[p],w=c[p-1];e:{t:{let L;n:{r:if(!(e<_)){for(let O=p+2;;){if(void 0===_){if(e<w)break r;return p=c.length,this._cachedIndex=p,this.afterEnd_(p-1,e,w)}if(p===O)break;if(w=_,_=c[++p],e<_)break t}L=c.length;break n}if(e>=w)break e;{const O=c[1];e<O&&(p=2,w=O);for(let F=p-2;;){if(void 0===w)return this._cachedIndex=0,this.beforeStart_(0,e,_);if(p===F)break;if(_=w,w=c[--p-1],e>=w)break t}L=p,p=0}}for(;p<L;){const O=p+L>>>1;e<c[O]?L=O:p=O+1}if(_=c[p],w=c[p-1],void 0===w)return this._cachedIndex=0,this.beforeStart_(0,e,_);if(void 0===_)return p=c.length,this._cachedIndex=p,this.afterEnd_(p-1,w,e)}this._cachedIndex=p,this.intervalChanged_(p,w,_)}return this.interpolate_(p,w,e,_)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const c=this.resultBuffer,p=this.sampleValues,_=this.valueSize,w=e*_;for(let L=0;L!==_;++L)c[L]=p[w+L];return c}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}De.prototype.beforeStart_=De.prototype.copySampleValue_,De.prototype.afterEnd_=De.prototype.copySampleValue_;class Qe extends De{constructor(e,c,p,_){super(e,c,p,_),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ba,endingEnd:ba}}intervalChanged_(e,c,p){const _=this.parameterPositions;let w=e-2,L=e+1,O=_[w],F=_[L];if(void 0===O)switch(this.getSettings_().endingStart){case sa:w=e,O=2*c-p;break;case wl:w=_.length-2,O=c+_[w]-_[w+1];break;default:w=e,O=p}if(void 0===F)switch(this.getSettings_().endingEnd){case sa:L=e,F=2*p-c;break;case wl:L=1,F=p+_[1]-_[0];break;default:L=e-1,F=c}const U=.5*(p-c),te=this.valueSize;this._weightPrev=U/(c-O),this._weightNext=U/(F-p),this._offsetPrev=w*te,this._offsetNext=L*te}interpolate_(e,c,p,_){const w=this.resultBuffer,L=this.sampleValues,O=this.valueSize,F=e*O,U=F-O,te=this._offsetPrev,ce=this._offsetNext,oe=this._weightPrev,de=this._weightNext,ve=(p-c)/(_-c),Me=ve*ve,Be=Me*ve,Ae=-oe*Be+2*oe*Me-oe*ve,ke=(1+oe)*Be+(-1.5-2*oe)*Me+(-.5+oe)*ve+1,Je=(-1-de)*Be+(1.5+de)*Me+.5*ve,We=de*Be-de*Me;for(let rt=0;rt!==O;++rt)w[rt]=Ae*L[te+rt]+ke*L[U+rt]+Je*L[F+rt]+We*L[ce+rt];return w}}class it extends De{constructor(e,c,p,_){super(e,c,p,_)}interpolate_(e,c,p,_){const w=this.resultBuffer,L=this.sampleValues,O=this.valueSize,F=e*O,U=F-O,te=(p-c)/(_-c),ce=1-te;for(let oe=0;oe!==O;++oe)w[oe]=L[U+oe]*ce+L[F+oe]*te;return w}}class ct extends De{constructor(e,c,p,_){super(e,c,p,_)}interpolate_(e){return this.copySampleValue_(e-1)}}class _t{constructor(e,c,p,_){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===c||0===c.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Fe.convertArray(c,this.TimeBufferType),this.values=Fe.convertArray(p,this.ValueBufferType),this.setInterpolation(_||this.DefaultInterpolation)}static toJSON(e){const c=e.constructor;let p;if(c.toJSON!==this.toJSON)p=c.toJSON(e);else{p={name:e.name,times:Fe.convertArray(e.times,Array),values:Fe.convertArray(e.values,Array)};const _=e.getInterpolation();_!==e.DefaultInterpolation&&(p.interpolation=_)}return p.type=e.ValueTypeName,p}InterpolantFactoryMethodDiscrete(e){return new ct(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new it(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Qe(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let c;switch(e){case Vl:c=this.InterpolantFactoryMethodDiscrete;break;case Wl:c=this.InterpolantFactoryMethodLinear;break;case Hu:c=this.InterpolantFactoryMethodSmooth}if(void 0===c){const p="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(p);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",p),this}return this.createInterpolant=c,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Vl;case this.InterpolantFactoryMethodLinear:return Wl;case this.InterpolantFactoryMethodSmooth:return Hu}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const c=this.times;for(let p=0,_=c.length;p!==_;++p)c[p]+=e}return this}scale(e){if(1!==e){const c=this.times;for(let p=0,_=c.length;p!==_;++p)c[p]*=e}return this}trim(e,c){const p=this.times,_=p.length;let w=0,L=_-1;for(;w!==_&&p[w]<e;)++w;for(;-1!==L&&p[L]>c;)--L;if(++L,0!==w||L!==_){w>=L&&(L=Math.max(L,1),w=L-1);const O=this.getValueSize();this.times=Fe.arraySlice(p,w,L),this.values=Fe.arraySlice(this.values,w*O,L*O)}return this}validate(){let e=!0;const c=this.getValueSize();c-Math.floor(c)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const p=this.times,_=this.values,w=p.length;0===w&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let L=null;for(let O=0;O!==w;O++){const F=p[O];if("number"==typeof F&&isNaN(F)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,O,F),e=!1;break}if(null!==L&&L>F){console.error("THREE.KeyframeTrack: Out of order keys.",this,O,F,L),e=!1;break}L=F}if(void 0!==_&&Fe.isTypedArray(_))for(let O=0,F=_.length;O!==F;++O){const U=_[O];if(isNaN(U)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,O,U),e=!1;break}}return e}optimize(){const e=Fe.arraySlice(this.times),c=Fe.arraySlice(this.values),p=this.getValueSize(),_=this.getInterpolation()===Hu,w=e.length-1;let L=1;for(let O=1;O<w;++O){let F=!1;const U=e[O];if(U!==e[O+1]&&(1!==O||U!==e[0]))if(_)F=!0;else{const te=O*p,ce=te-p,oe=te+p;for(let de=0;de!==p;++de){const ve=c[te+de];if(ve!==c[ce+de]||ve!==c[oe+de]){F=!0;break}}}if(F){if(O!==L){e[L]=e[O];const te=O*p,ce=L*p;for(let oe=0;oe!==p;++oe)c[ce+oe]=c[te+oe]}++L}}if(w>0){e[L]=e[w];for(let O=w*p,F=L*p,U=0;U!==p;++U)c[F+U]=c[O+U];++L}return L!==e.length?(this.times=Fe.arraySlice(e,0,L),this.values=Fe.arraySlice(c,0,L*p)):(this.times=e,this.values=c),this}clone(){const e=Fe.arraySlice(this.times,0),c=Fe.arraySlice(this.values,0),p=new this.constructor(this.name,e,c);return p.createInterpolant=this.createInterpolant,p}}_t.prototype.TimeBufferType=Float32Array,_t.prototype.ValueBufferType=Float32Array,_t.prototype.DefaultInterpolation=Wl;class $t extends _t{}$t.prototype.ValueTypeName="bool",$t.prototype.ValueBufferType=Array,$t.prototype.DefaultInterpolation=Vl,$t.prototype.InterpolantFactoryMethodLinear=void 0,$t.prototype.InterpolantFactoryMethodSmooth=void 0;class rn extends _t{}rn.prototype.ValueTypeName="color";class Dt extends _t{}Dt.prototype.ValueTypeName="number";class Lt extends De{constructor(e,c,p,_){super(e,c,p,_)}interpolate_(e,c,p,_){const w=this.resultBuffer,L=this.sampleValues,O=this.valueSize,F=(p-c)/(_-c);let U=e*O;for(let te=U+O;U!==te;U+=4)Ci.slerpFlat(w,0,L,U-O,L,U,F);return w}}class Ct extends _t{InterpolantFactoryMethodLinear(e){return new Lt(this.times,this.values,this.getValueSize(),e)}}Ct.prototype.ValueTypeName="quaternion",Ct.prototype.DefaultInterpolation=Wl,Ct.prototype.InterpolantFactoryMethodSmooth=void 0;class ut extends _t{}ut.prototype.ValueTypeName="string",ut.prototype.ValueBufferType=Array,ut.prototype.DefaultInterpolation=Vl,ut.prototype.InterpolantFactoryMethodLinear=void 0,ut.prototype.InterpolantFactoryMethodSmooth=void 0;class Tt extends _t{}Tt.prototype.ValueTypeName="vector";class Qt{constructor(e,c=-1,p,_=Vu){this.name=e,this.tracks=p,this.duration=c,this.blendMode=_,this.uuid=eo(),this.duration<0&&this.resetDuration()}static parse(e){const c=[],p=e.tracks,_=1/(e.fps||1);for(let L=0,O=p.length;L!==O;++L)c.push(vn(p[L]).scale(_));const w=new this(e.name,e.duration,c,e.blendMode);return w.uuid=e.uuid,w}static toJSON(e){const c=[],p=e.tracks,_={name:e.name,duration:e.duration,tracks:c,uuid:e.uuid,blendMode:e.blendMode};for(let w=0,L=p.length;w!==L;++w)c.push(_t.toJSON(p[w]));return _}static CreateFromMorphTargetSequence(e,c,p,_){const w=c.length,L=[];for(let O=0;O<w;O++){let F=[],U=[];F.push((O+w-1)%w,O,(O+1)%w),U.push(0,1,0);const te=Fe.getKeyframeOrder(F);F=Fe.sortedArray(F,1,te),U=Fe.sortedArray(U,1,te),_||0!==F[0]||(F.push(w),U.push(U[0])),L.push(new Dt(".morphTargetInfluences["+c[O].name+"]",F,U).scale(1/p))}return new this(e,-1,L)}static findByName(e,c){let p=e;Array.isArray(e)||(p=e.geometry&&e.geometry.animations||e.animations);for(let _=0;_<p.length;_++)if(p[_].name===c)return p[_];return null}static CreateClipsFromMorphTargetSequences(e,c,p){const _={},w=/^([\w-]*?)([\d]+)$/;for(let O=0,F=e.length;O<F;O++){const U=e[O],te=U.name.match(w);if(te&&te.length>1){const ce=te[1];let oe=_[ce];oe||(_[ce]=oe=[]),oe.push(U)}}const L=[];for(const O in _)L.push(this.CreateFromMorphTargetSequence(O,_[O],c,p));return L}static parseAnimation(e,c){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const p=function(te,ce,oe,de,ve){if(0!==oe.length){const Me=[],Be=[];Fe.flattenJSON(oe,Me,Be,de),0!==Me.length&&ve.push(new te(ce,Me,Be))}},_=[],w=e.name||"default",L=e.fps||30,O=e.blendMode;let F=e.length||-1;const U=e.hierarchy||[];for(let te=0;te<U.length;te++){const ce=U[te].keys;if(ce&&0!==ce.length)if(ce[0].morphTargets){const oe={};let de;for(de=0;de<ce.length;de++)if(ce[de].morphTargets)for(let ve=0;ve<ce[de].morphTargets.length;ve++)oe[ce[de].morphTargets[ve]]=-1;for(const ve in oe){const Me=[],Be=[];for(let Ae=0;Ae!==ce[de].morphTargets.length;++Ae){const ke=ce[de];Me.push(ke.time),Be.push(ke.morphTarget===ve?1:0)}_.push(new Dt(".morphTargetInfluence["+ve+"]",Me,Be))}F=oe.length*(L||1)}else{const oe=".bones["+c[te].name+"]";p(Tt,oe+".position",ce,"pos",_),p(Ct,oe+".quaternion",ce,"rot",_),p(Tt,oe+".scale",ce,"scl",_)}}return 0===_.length?null:new this(w,F,_,O)}resetDuration(){let e=0;for(let c=0,p=this.tracks.length;c!==p;++c){const _=this.tracks[c];e=Math.max(e,_.times[_.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let c=0;c<this.tracks.length;c++)e=e&&this.tracks[c].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let c=0;c<this.tracks.length;c++)e.push(this.tracks[c].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function vn(S){if(void 0===S.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(c){switch(c.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Dt;case"vector":case"vector2":case"vector3":case"vector4":return Tt;case"color":return rn;case"quaternion":return Ct;case"bool":case"boolean":return $t;case"string":return ut}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+c)}(S.type);if(void 0===S.times){const c=[],p=[];Fe.flattenJSON(S.keys,c,p,"value"),S.times=c,S.values=p}return void 0!==e.parse?e.parse(S):new e(S.name,S.times,S.values,S.interpolation)}const gn={enabled:!1,files:{},add:function(S,e){!1!==this.enabled&&(this.files[S]=e)},get:function(S){if(!1!==this.enabled)return this.files[S]},remove:function(S){delete this.files[S]},clear:function(){this.files={}}};class fr{constructor(e,c,p){const _=this;let w,L=!1,O=0,F=0;const U=[];this.onStart=void 0,this.onLoad=e,this.onProgress=c,this.onError=p,this.itemStart=function(te){F++,!1===L&&void 0!==_.onStart&&_.onStart(te,O,F),L=!0},this.itemEnd=function(te){O++,void 0!==_.onProgress&&_.onProgress(te,O,F),O===F&&(L=!1,void 0!==_.onLoad&&_.onLoad())},this.itemError=function(te){void 0!==_.onError&&_.onError(te)},this.resolveURL=function(te){return w?w(te):te},this.setURLModifier=function(te){return w=te,this},this.addHandler=function(te,ce){return U.push(te,ce),this},this.removeHandler=function(te){const ce=U.indexOf(te);return-1!==ce&&U.splice(ce,2),this},this.getHandler=function(te){for(let ce=0,oe=U.length;ce<oe;ce+=2){const de=U[ce],ve=U[ce+1];if(de.global&&(de.lastIndex=0),de.test(te))return ve}return null}}}const sr=new fr;class Rn{constructor(e){this.manager=void 0!==e?e:sr,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,c){const p=this;return new Promise(function(_,w){p.load(e,_,c,w)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Jn={};class Kn extends Rn{constructor(e){super(e)}load(e,c,p,_){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const w=this,L=gn.get(e);if(void 0!==L)return w.manager.itemStart(e),setTimeout(function(){c&&c(L),w.manager.itemEnd(e)},0),L;if(void 0!==Jn[e])return void Jn[e].push({onLoad:c,onProgress:p,onError:_});const O=e.match(/^data:(.*?)(;base64)?,(.*)$/);let F;if(O){const U=O[1],te=!!O[2];let ce=O[3];ce=decodeURIComponent(ce),te&&(ce=atob(ce));try{let oe;const de=(this.responseType||"").toLowerCase();switch(de){case"arraybuffer":case"blob":const ve=new Uint8Array(ce.length);for(let Be=0;Be<ce.length;Be++)ve[Be]=ce.charCodeAt(Be);oe="blob"===de?new Blob([ve.buffer],{type:U}):ve.buffer;break;case"document":oe=(new DOMParser).parseFromString(ce,U);break;case"json":oe=JSON.parse(ce);break;default:oe=ce}setTimeout(function(){c&&c(oe),w.manager.itemEnd(e)},0)}catch(oe){setTimeout(function(){_&&_(oe),w.manager.itemError(e),w.manager.itemEnd(e)},0)}}else{Jn[e]=[],Jn[e].push({onLoad:c,onProgress:p,onError:_}),F=new XMLHttpRequest,F.open("GET",e,!0),F.addEventListener("load",function(U){const te=this.response,ce=Jn[e];if(delete Jn[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),gn.add(e,te);for(let oe=0,de=ce.length;oe<de;oe++){const ve=ce[oe];ve.onLoad&&ve.onLoad(te)}w.manager.itemEnd(e)}else{for(let oe=0,de=ce.length;oe<de;oe++){const ve=ce[oe];ve.onError&&ve.onError(U)}w.manager.itemError(e),w.manager.itemEnd(e)}},!1),F.addEventListener("progress",function(U){const te=Jn[e];for(let ce=0,oe=te.length;ce<oe;ce++){const de=te[ce];de.onProgress&&de.onProgress(U)}},!1),F.addEventListener("error",function(U){const te=Jn[e];delete Jn[e];for(let ce=0,oe=te.length;ce<oe;ce++){const de=te[ce];de.onError&&de.onError(U)}w.manager.itemError(e),w.manager.itemEnd(e)},!1),F.addEventListener("abort",function(U){const te=Jn[e];delete Jn[e];for(let ce=0,oe=te.length;ce<oe;ce++){const de=te[ce];de.onError&&de.onError(U)}w.manager.itemError(e),w.manager.itemEnd(e)},!1),void 0!==this.responseType&&(F.responseType=this.responseType),void 0!==this.withCredentials&&(F.withCredentials=this.withCredentials),F.overrideMimeType&&F.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const U in this.requestHeader)F.setRequestHeader(U,this.requestHeader[U]);F.send(null)}return w.manager.itemStart(e),F}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Er extends Rn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new Kn(this.manager);L.setPath(this.path),L.setRequestHeader(this.requestHeader),L.setWithCredentials(this.withCredentials),L.load(e,function(O){try{c(w.parse(JSON.parse(O)))}catch(F){_?_(F):console.error(F),w.manager.itemError(e)}},p,_)}parse(e){const c=[];for(let p=0;p<e.length;p++){const _=Qt.parse(e[p]);c.push(_)}return c}}class vi extends Rn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=[],O=new rd,F=new Kn(this.manager);F.setPath(this.path),F.setResponseType("arraybuffer"),F.setRequestHeader(this.requestHeader),F.setWithCredentials(w.withCredentials);let U=0;function te(ce){F.load(e[ce],function(oe){const de=w.parse(oe,!0);L[ce]={width:de.width,height:de.height,format:de.format,mipmaps:de.mipmaps},U+=1,6===U&&(1===de.mipmapCount&&(O.minFilter=ai),O.image=L,O.format=de.format,O.needsUpdate=!0,c&&c(O))},p,_)}if(Array.isArray(e))for(let ce=0,oe=e.length;ce<oe;++ce)te(ce);else F.load(e,function(ce){const oe=w.parse(ce,!0);if(oe.isCubemap){const de=oe.mipmaps.length/oe.mipmapCount;for(let ve=0;ve<de;ve++){L[ve]={mipmaps:[]};for(let Me=0;Me<oe.mipmapCount;Me++)L[ve].mipmaps.push(oe.mipmaps[ve*oe.mipmapCount+Me]),L[ve].format=oe.format,L[ve].width=oe.width,L[ve].height=oe.height}O.image=L}else O.image.width=oe.width,O.image.height=oe.height,O.mipmaps=oe.mipmaps;1===oe.mipmapCount&&(O.minFilter=ai),O.format=oe.format,O.needsUpdate=!0,c&&c(O)},p,_);return O}}class no extends Rn{constructor(e){super(e)}load(e,c,p,_){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const w=this,L=gn.get(e);if(void 0!==L)return w.manager.itemStart(e),setTimeout(function(){c&&c(L),w.manager.itemEnd(e)},0),L;const O=document.createElementNS("http://www.w3.org/1999/xhtml","img");function F(){O.removeEventListener("load",F,!1),O.removeEventListener("error",U,!1),gn.add(e,this),c&&c(this),w.manager.itemEnd(e)}function U(te){O.removeEventListener("load",F,!1),O.removeEventListener("error",U,!1),_&&_(te),w.manager.itemError(e),w.manager.itemEnd(e)}return O.addEventListener("load",F,!1),O.addEventListener("error",U,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(O.crossOrigin=this.crossOrigin),w.manager.itemStart(e),O.src=e,O}}class fo extends Rn{constructor(e){super(e)}load(e,c,p,_){const w=new Zl,L=new no(this.manager);L.setCrossOrigin(this.crossOrigin),L.setPath(this.path);let O=0;function F(U){L.load(e[U],function(te){w.images[U]=te,O++,6===O&&(w.needsUpdate=!0,c&&c(w))},void 0,_)}for(let U=0;U<e.length;++U)F(U);return w}}class Vo extends Rn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new La,O=new Kn(this.manager);return O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setPath(this.path),O.setWithCredentials(w.withCredentials),O.load(e,function(F){const U=w.parse(F);U&&(void 0!==U.image?L.image=U.image:void 0!==U.data&&(L.image.width=U.width,L.image.height=U.height,L.image.data=U.data),L.wrapS=void 0!==U.wrapS?U.wrapS:Yr,L.wrapT=void 0!==U.wrapT?U.wrapT:Yr,L.magFilter=void 0!==U.magFilter?U.magFilter:ai,L.minFilter=void 0!==U.minFilter?U.minFilter:ai,L.anisotropy=void 0!==U.anisotropy?U.anisotropy:1,void 0!==U.encoding&&(L.encoding=U.encoding),void 0!==U.flipY&&(L.flipY=U.flipY),void 0!==U.format&&(L.format=U.format),void 0!==U.type&&(L.type=U.type),void 0!==U.mipmaps&&(L.mipmaps=U.mipmaps,L.minFilter=Ka),1===U.mipmapCount&&(L.minFilter=ai),void 0!==U.generateMipmaps&&(L.generateMipmaps=U.generateMipmaps),L.needsUpdate=!0,c&&c(L,U))},p,_),L}}class Uo extends Rn{constructor(e){super(e)}load(e,c,p,_){const w=new As,L=new no(this.manager);return L.setCrossOrigin(this.crossOrigin),L.setPath(this.path),L.load(e,function(O){w.image=O;const F=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);w.format=F?Is:mo,w.needsUpdate=!0,void 0!==c&&c(w)},p,_),w}}class Gs extends Ks{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);e.equals(c)||this.curves.push(new Us(c,e))}getPoint(e){const c=e*this.getLength(),p=this.getCurveLengths();let _=0;for(;_<p.length;){if(p[_]>=c){const w=p[_]-c,L=this.curves[_],O=L.getLength();return L.getPointAt(0===O?0:1-w/O)}_++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let c=0;for(let p=0,_=this.curves.length;p<_;p++)c+=this.curves[p].getLength(),e.push(c);return this.cacheLengths=e,e}getSpacedPoints(e=40){const c=[];for(let p=0;p<=e;p++)c.push(this.getPoint(p/e));return this.autoClose&&c.push(c[0]),c}getPoints(e=12){const c=[];let p;for(let _=0,w=this.curves;_<w.length;_++){const L=w[_],F=L.getPoints(L&&L.isEllipseCurve?2*e:L&&(L.isLineCurve||L.isLineCurve3)?1:L&&L.isSplineCurve?e*L.points.length:e);for(let U=0;U<F.length;U++){const te=F[U];p&&p.equals(te)||(c.push(te),p=te)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(e){super.copy(e),this.curves=[];for(let c=0,p=e.curves.length;c<p;c++)this.curves.push(e.curves[c].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let c=0,p=this.curves.length;c<p;c++)e.curves.push(this.curves[c].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let c=0,p=e.curves.length;c<p;c++){const _=e.curves[c];this.curves.push((new Jo[_.type]).fromJSON(_))}return this}}class hs extends Gs{constructor(e){super(),this.type="Path",this.currentPoint=new Un,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let c=1,p=e.length;c<p;c++)this.lineTo(e[c].x,e[c].y);return this}moveTo(e,c){return this.currentPoint.set(e,c),this}lineTo(e,c){const p=new Us(this.currentPoint.clone(),new Un(e,c));return this.curves.push(p),this.currentPoint.set(e,c),this}quadraticCurveTo(e,c,p,_){const w=new _a(this.currentPoint.clone(),new Un(e,c),new Un(p,_));return this.curves.push(w),this.currentPoint.set(p,_),this}bezierCurveTo(e,c,p,_,w,L){const O=new rp(this.currentPoint.clone(),new Un(e,c),new Un(p,_),new Un(w,L));return this.curves.push(O),this.currentPoint.set(w,L),this}splineThru(e){const c=[this.currentPoint.clone()].concat(e),p=new uo(c);return this.curves.push(p),this.currentPoint.copy(e[e.length-1]),this}arc(e,c,p,_,w,L){return this.absarc(e+this.currentPoint.x,c+this.currentPoint.y,p,_,w,L),this}absarc(e,c,p,_,w,L){return this.absellipse(e,c,p,p,_,w,L),this}ellipse(e,c,p,_,w,L,O,F){return this.absellipse(e+this.currentPoint.x,c+this.currentPoint.y,p,_,w,L,O,F),this}absellipse(e,c,p,_,w,L,O,F){const U=new oc(e,c,p,_,w,L,O,F);if(this.curves.length>0){const ce=U.getPoint(0);ce.equals(this.currentPoint)||this.lineTo(ce.x,ce.y)}this.curves.push(U);const te=U.getPoint(1);return this.currentPoint.copy(te),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class ps extends hs{constructor(e){super(e),this.uuid=eo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const c=[];for(let p=0,_=this.holes.length;p<_;p++)c[p]=this.holes[p].getPoints(e);return c}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let c=0,p=e.holes.length;c<p;c++)this.holes.push(e.holes[c].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let c=0,p=this.holes.length;c<p;c++)e.holes.push(this.holes[c].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let c=0,p=e.holes.length;c<p;c++){const _=e.holes[c];this.holes.push((new hs).fromJSON(_))}return this}}class ds extends Pr{constructor(e,c=1){super(),this.type="Light",this.color=new Qn(e),this.intensity=c}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const c=super.toJSON(e);return c.object.color=this.color.getHex(),c.object.intensity=this.intensity,void 0!==this.groundColor&&(c.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(c.object.distance=this.distance),void 0!==this.angle&&(c.object.angle=this.angle),void 0!==this.decay&&(c.object.decay=this.decay),void 0!==this.penumbra&&(c.object.penumbra=this.penumbra),void 0!==this.shadow&&(c.object.shadow=this.shadow.toJSON()),c}}ds.prototype.isLight=!0;class Ic extends ds{constructor(e,c,p){super(e,p),this.type="HemisphereLight",this.position.copy(Pr.DefaultUp),this.updateMatrix(),this.groundColor=new Qn(c)}copy(e){return ds.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}Ic.prototype.isHemisphereLight=!0;const ad=new Kt,Up=new at,ip=new at;class sp{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Un(512,512),this.map=null,this.mapPass=null,this.matrix=new Kt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Dr,this._frameExtents=new Un(1,1),this._viewportCount=1,this._viewports=[new ji(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const c=this.camera,p=this.matrix;Up.setFromMatrixPosition(e.matrixWorld),c.position.copy(Up),ip.setFromMatrixPosition(e.target.matrixWorld),c.lookAt(ip),c.updateMatrixWorld(),ad.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ad),p.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),p.multiply(c.projectionMatrix),p.multiply(c.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Ad extends sp{constructor(){super(new Fo(50,1,.5,500)),this.focus=1}updateMatrices(e){const c=this.camera,p=2*ss*e.angle*this.focus,_=this.mapSize.width/this.mapSize.height,w=e.distance||c.far;p===c.fov&&_===c.aspect&&w===c.far||(c.fov=p,c.aspect=_,c.far=w,c.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}Ad.prototype.isSpotLightShadow=!0;class Oc extends ds{constructor(e,c,p=0,_=Math.PI/3,w=0,L=1){super(e,c),this.type="SpotLight",this.position.copy(Pr.DefaultUp),this.updateMatrix(),this.target=new Pr,this.distance=p,this.angle=_,this.penumbra=w,this.decay=L,this.shadow=new Ad}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Oc.prototype.isSpotLight=!0;const ap=new Kt,au=new at,Na=new at;class $d extends sp{constructor(){super(new Fo(90,1,.5,500)),this._frameExtents=new Un(4,2),this._viewportCount=6,this._viewports=[new ji(2,1,1,1),new ji(0,1,1,1),new ji(3,1,1,1),new ji(1,1,1,1),new ji(3,0,1,1),new ji(1,0,1,1)],this._cubeDirections=[new at(1,0,0),new at(-1,0,0),new at(0,0,1),new at(0,0,-1),new at(0,1,0),new at(0,-1,0)],this._cubeUps=[new at(0,1,0),new at(0,1,0),new at(0,1,0),new at(0,1,0),new at(0,0,1),new at(0,0,-1)]}updateMatrices(e,c=0){const p=this.camera,_=this.matrix,w=e.distance||p.far;w!==p.far&&(p.far=w,p.updateProjectionMatrix()),au.setFromMatrixPosition(e.matrixWorld),p.position.copy(au),Na.copy(p.position),Na.add(this._cubeDirections[c]),p.up.copy(this._cubeUps[c]),p.lookAt(Na),p.updateMatrixWorld(),_.makeTranslation(-au.x,-au.y,-au.z),ap.multiplyMatrices(p.projectionMatrix,p.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ap)}}$d.prototype.isPointLightShadow=!0;class Dm extends ds{constructor(e,c,p=0,_=1){super(e,c),this.type="PointLight",this.distance=p,this.decay=_,this.shadow=new $d}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}Dm.prototype.isPointLight=!0;class Cd extends sp{constructor(){super(new Ql(-5,5,5,-5,.5,500))}}Cd.prototype.isDirectionalLightShadow=!0;class Rf extends ds{constructor(e,c){super(e,c),this.type="DirectionalLight",this.position.copy(Pr.DefaultUp),this.updateMatrix(),this.target=new Pr,this.shadow=new Cd}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Rf.prototype.isDirectionalLight=!0;class Ld extends ds{constructor(e,c){super(e,c),this.type="AmbientLight"}}Ld.prototype.isAmbientLight=!0;class ld extends ds{constructor(e,c,p=10,_=10){super(e,c),this.type="RectAreaLight",this.width=p,this.height=_}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const c=super.toJSON(e);return c.object.width=this.width,c.object.height=this.height,c}}ld.prototype.isRectAreaLight=!0;class hm{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new at)}set(e){for(let c=0;c<9;c++)this.coefficients[c].copy(e[c]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,c){const p=e.x,_=e.y,w=e.z,L=this.coefficients;return c.copy(L[0]).multiplyScalar(.282095),c.addScaledVector(L[1],.488603*_),c.addScaledVector(L[2],.488603*w),c.addScaledVector(L[3],.488603*p),c.addScaledVector(L[4],p*_*1.092548),c.addScaledVector(L[5],_*w*1.092548),c.addScaledVector(L[6],.315392*(3*w*w-1)),c.addScaledVector(L[7],p*w*1.092548),c.addScaledVector(L[8],.546274*(p*p-_*_)),c}getIrradianceAt(e,c){const p=e.x,_=e.y,w=e.z,L=this.coefficients;return c.copy(L[0]).multiplyScalar(.886227),c.addScaledVector(L[1],1.023328*_),c.addScaledVector(L[2],1.023328*w),c.addScaledVector(L[3],1.023328*p),c.addScaledVector(L[4],.858086*p*_),c.addScaledVector(L[5],.858086*_*w),c.addScaledVector(L[6],.743125*w*w-.247708),c.addScaledVector(L[7],.858086*p*w),c.addScaledVector(L[8],.429043*(p*p-_*_)),c}add(e){for(let c=0;c<9;c++)this.coefficients[c].add(e.coefficients[c]);return this}addScaledSH(e,c){for(let p=0;p<9;p++)this.coefficients[p].addScaledVector(e.coefficients[p],c);return this}scale(e){for(let c=0;c<9;c++)this.coefficients[c].multiplyScalar(e);return this}lerp(e,c){for(let p=0;p<9;p++)this.coefficients[p].lerp(e.coefficients[p],c);return this}equals(e){for(let c=0;c<9;c++)if(!this.coefficients[c].equals(e.coefficients[c]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,c=0){const p=this.coefficients;for(let _=0;_<9;_++)p[_].fromArray(e,c+3*_);return this}toArray(e=[],c=0){const p=this.coefficients;for(let _=0;_<9;_++)p[_].toArray(e,c+3*_);return e}static getBasisAt(e,c){const p=e.x,_=e.y,w=e.z;c[0]=.282095,c[1]=.488603*_,c[2]=.488603*w,c[3]=.488603*p,c[4]=1.092548*p*_,c[5]=1.092548*_*w,c[6]=.315392*(3*w*w-1),c[7]=1.092548*p*w,c[8]=.546274*(p*p-_*_)}}hm.prototype.isSphericalHarmonics3=!0;class Pf extends ds{constructor(e=new hm,c=1){super(void 0,c),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const c=super.toJSON(e);return c.object.sh=this.sh.toArray(),c}}Pf.prototype.isLightProbe=!0;class Bd extends Rn{constructor(e){super(e),this.textures={}}load(e,c,p,_){const w=this,L=new Kn(w.manager);L.setPath(w.path),L.setRequestHeader(w.requestHeader),L.setWithCredentials(w.withCredentials),L.load(e,function(O){try{c(w.parse(JSON.parse(O)))}catch(F){_?_(F):console.error(F),w.manager.itemError(e)}},p,_)}parse(e){const c=this.textures;function p(w){return void 0===c[w]&&console.warn("THREE.MaterialLoader: Undefined texture",w),c[w]}const _=new Oe[e.type];if(void 0!==e.uuid&&(_.uuid=e.uuid),void 0!==e.name&&(_.name=e.name),void 0!==e.color&&void 0!==_.color&&_.color.setHex(e.color),void 0!==e.roughness&&(_.roughness=e.roughness),void 0!==e.metalness&&(_.metalness=e.metalness),void 0!==e.sheenTint&&(_.sheenTint=(new Qn).setHex(e.sheenTint)),void 0!==e.emissive&&void 0!==_.emissive&&_.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==_.specular&&_.specular.setHex(e.specular),void 0!==e.specularIntensity&&(_.specularIntensity=e.specularIntensity),void 0!==e.specularTint&&void 0!==_.specularTint&&_.specularTint.setHex(e.specularTint),void 0!==e.shininess&&(_.shininess=e.shininess),void 0!==e.clearcoat&&(_.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(_.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(_.transmission=e.transmission),void 0!==e.thickness&&(_.thickness=e.thickness),void 0!==e.attenuationDistance&&(_.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationTint&&void 0!==_.attenuationTint&&_.attenuationTint.setHex(e.attenuationTint),void 0!==e.fog&&(_.fog=e.fog),void 0!==e.flatShading&&(_.flatShading=e.flatShading),void 0!==e.blending&&(_.blending=e.blending),void 0!==e.combine&&(_.combine=e.combine),void 0!==e.side&&(_.side=e.side),void 0!==e.shadowSide&&(_.shadowSide=e.shadowSide),void 0!==e.opacity&&(_.opacity=e.opacity),void 0!==e.format&&(_.format=e.format),void 0!==e.transparent&&(_.transparent=e.transparent),void 0!==e.alphaTest&&(_.alphaTest=e.alphaTest),void 0!==e.depthTest&&(_.depthTest=e.depthTest),void 0!==e.depthWrite&&(_.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(_.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(_.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(_.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(_.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(_.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(_.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(_.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(_.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(_.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(_.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(_.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(_.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(_.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(_.rotation=e.rotation),1!==e.linewidth&&(_.linewidth=e.linewidth),void 0!==e.dashSize&&(_.dashSize=e.dashSize),void 0!==e.gapSize&&(_.gapSize=e.gapSize),void 0!==e.scale&&(_.scale=e.scale),void 0!==e.polygonOffset&&(_.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(_.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(_.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(_.dithering=e.dithering),void 0!==e.alphaToCoverage&&(_.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(_.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(_.visible=e.visible),void 0!==e.toneMapped&&(_.toneMapped=e.toneMapped),void 0!==e.userData&&(_.userData=e.userData),void 0!==e.vertexColors&&(_.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const w in e.uniforms){const L=e.uniforms[w];switch(_.uniforms[w]={},L.type){case"t":_.uniforms[w].value=p(L.value);break;case"c":_.uniforms[w].value=(new Qn).setHex(L.value);break;case"v2":_.uniforms[w].value=(new Un).fromArray(L.value);break;case"v3":_.uniforms[w].value=(new at).fromArray(L.value);break;case"v4":_.uniforms[w].value=(new ji).fromArray(L.value);break;case"m3":_.uniforms[w].value=(new ot).fromArray(L.value);break;case"m4":_.uniforms[w].value=(new Kt).fromArray(L.value);break;default:_.uniforms[w].value=L.value}}if(void 0!==e.defines&&(_.defines=e.defines),void 0!==e.vertexShader&&(_.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(_.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const w in e.extensions)_.extensions[w]=e.extensions[w];if(void 0!==e.shading&&(_.flatShading=1===e.shading),void 0!==e.size&&(_.size=e.size),void 0!==e.sizeAttenuation&&(_.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(_.map=p(e.map)),void 0!==e.matcap&&(_.matcap=p(e.matcap)),void 0!==e.alphaMap&&(_.alphaMap=p(e.alphaMap)),void 0!==e.bumpMap&&(_.bumpMap=p(e.bumpMap)),void 0!==e.bumpScale&&(_.bumpScale=e.bumpScale),void 0!==e.normalMap&&(_.normalMap=p(e.normalMap)),void 0!==e.normalMapType&&(_.normalMapType=e.normalMapType),void 0!==e.normalScale){let w=e.normalScale;!1===Array.isArray(w)&&(w=[w,w]),_.normalScale=(new Un).fromArray(w)}return void 0!==e.displacementMap&&(_.displacementMap=p(e.displacementMap)),void 0!==e.displacementScale&&(_.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(_.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(_.roughnessMap=p(e.roughnessMap)),void 0!==e.metalnessMap&&(_.metalnessMap=p(e.metalnessMap)),void 0!==e.emissiveMap&&(_.emissiveMap=p(e.emissiveMap)),void 0!==e.emissiveIntensity&&(_.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(_.specularMap=p(e.specularMap)),void 0!==e.specularIntensityMap&&(_.specularIntensityMap=p(e.specularIntensityMap)),void 0!==e.specularTintMap&&(_.specularTintMap=p(e.specularTintMap)),void 0!==e.envMap&&(_.envMap=p(e.envMap)),void 0!==e.envMapIntensity&&(_.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(_.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(_.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(_.lightMap=p(e.lightMap)),void 0!==e.lightMapIntensity&&(_.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(_.aoMap=p(e.aoMap)),void 0!==e.aoMapIntensity&&(_.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(_.gradientMap=p(e.gradientMap)),void 0!==e.clearcoatMap&&(_.clearcoatMap=p(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap=p(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(_.clearcoatNormalMap=p(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(_.clearcoatNormalScale=(new Un).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(_.transmissionMap=p(e.transmissionMap)),void 0!==e.thicknessMap&&(_.thicknessMap=p(e.thicknessMap)),_}setTextures(e){return this.textures=e,this}}class ff{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let c="";for(let p=0,_=e.length;p<_;p++)c+=String.fromCharCode(e[p]);try{return decodeURIComponent(escape(c))}catch{return c}}static extractUrlBase(e){const c=e.lastIndexOf("/");return-1===c?"./":e.substr(0,c+1)}}class If extends gr{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}If.prototype.isInstancedBufferGeometry=!0;class pm extends Rn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new Kn(w.manager);L.setPath(w.path),L.setRequestHeader(w.requestHeader),L.setWithCredentials(w.withCredentials),L.load(e,function(O){try{c(w.parse(JSON.parse(O)))}catch(F){_?_(F):console.error(F),w.manager.itemError(e)}},p,_)}parse(e){const c={},p={};function _(ce,oe){if(void 0!==c[oe])return c[oe];const de=ce.interleavedBuffers[oe],ve=function(Ae,ke){if(void 0!==p[ke])return p[ke];const We=new Uint32Array(Ae.arrayBuffers[ke]).buffer;return p[ke]=We,We}(ce,de.buffer),Me=ja(de.type,ve),Be=new Js(Me,de.stride);return Be.uuid=de.uuid,c[oe]=Be,Be}const w=e.isInstancedBufferGeometry?new If:new gr,L=e.data.index;if(void 0!==L){const ce=ja(L.type,L.array);w.setIndex(new Fi(ce,1))}const O=e.data.attributes;for(const ce in O){const oe=O[ce];let de;if(oe.isInterleavedBufferAttribute){const ve=_(e.data,oe.data);de=new nc(ve,oe.itemSize,oe.offset,oe.normalized)}else{const ve=ja(oe.type,oe.array);de=new(oe.isInstancedBufferAttribute?Zi:Fi)(ve,oe.itemSize,oe.normalized)}void 0!==oe.name&&(de.name=oe.name),void 0!==oe.usage&&de.setUsage(oe.usage),void 0!==oe.updateRange&&(de.updateRange.offset=oe.updateRange.offset,de.updateRange.count=oe.updateRange.count),w.setAttribute(ce,de)}const F=e.data.morphAttributes;if(F)for(const ce in F){const oe=F[ce],de=[];for(let ve=0,Me=oe.length;ve<Me;ve++){const Be=oe[ve];let Ae;if(Be.isInterleavedBufferAttribute){const ke=_(e.data,Be.data);Ae=new nc(ke,Be.itemSize,Be.offset,Be.normalized)}else{const ke=ja(Be.type,Be.array);Ae=new Fi(ke,Be.itemSize,Be.normalized)}void 0!==Be.name&&(Ae.name=Be.name),de.push(Ae)}w.morphAttributes[ce]=de}e.data.morphTargetsRelative&&(w.morphTargetsRelative=!0);const U=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==U)for(let ce=0,oe=U.length;ce!==oe;++ce){const de=U[ce];w.addGroup(de.start,de.count,de.materialIndex)}const te=e.data.boundingSphere;if(void 0!==te){const ce=new at;void 0!==te.center&&ce.fromArray(te.center),w.boundingSphere=new To(ce,te.radius)}return e.name&&(w.name=e.name),e.userData&&(w.userData=e.userData),w}}class Um extends Rn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=""===this.path?ff.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||L;const O=new Kn(this.manager);O.setPath(this.path),O.setRequestHeader(this.requestHeader),O.setWithCredentials(this.withCredentials),O.load(e,function(F){let U=null;try{U=JSON.parse(F)}catch(ce){return void 0!==_&&_(ce),void console.error("THREE:ObjectLoader: Can't parse "+e+".",ce.message)}const te=U.metadata;void 0!==te&&void 0!==te.type&&"geometry"!==te.type.toLowerCase()?w.parse(U,c):console.error("THREE.ObjectLoader: Can't load "+e)},p,_)}async loadAsync(e,c){const p=""===this.path?ff.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||p;const _=new Kn(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials);const w=await _.loadAsync(e,c),L=JSON.parse(w),O=L.metadata;if(void 0===O||void 0===O.type||"geometry"===O.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(L)}parse(e,c){const p=this.parseAnimations(e.animations),_=this.parseShapes(e.shapes),w=this.parseGeometries(e.geometries,_),L=this.parseImages(e.images,function(){void 0!==c&&c(U)}),O=this.parseTextures(e.textures,L),F=this.parseMaterials(e.materials,O),U=this.parseObject(e.object,w,F,O,p),te=this.parseSkeletons(e.skeletons,U);if(this.bindSkeletons(U,te),void 0!==c){let ce=!1;for(const oe in L)if(L[oe]instanceof HTMLImageElement){ce=!0;break}!1===ce&&c(U)}return U}async parseAsync(e){const c=this.parseAnimations(e.animations),p=this.parseShapes(e.shapes),_=this.parseGeometries(e.geometries,p),w=await this.parseImagesAsync(e.images),L=this.parseTextures(e.textures,w),O=this.parseMaterials(e.materials,L),F=this.parseObject(e.object,_,O,L,c),U=this.parseSkeletons(e.skeletons,F);return this.bindSkeletons(F,U),F}parseShapes(e){const c={};if(void 0!==e)for(let p=0,_=e.length;p<_;p++){const w=(new ps).fromJSON(e[p]);c[w.uuid]=w}return c}parseSkeletons(e,c){const p={},_={};if(c.traverse(function(w){w.isBone&&(_[w.uuid]=w)}),void 0!==e)for(let w=0,L=e.length;w<L;w++){const O=(new Bu).fromJSON(e[w],_);p[O.uuid]=O}return p}parseGeometries(e,c){const p={};if(void 0!==e){const _=new pm;for(let w=0,L=e.length;w<L;w++){let O;const F=e[w];switch(F.type){case"BufferGeometry":case"InstancedBufferGeometry":O=_.parse(F);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:F.type in H?O=H[F.type].fromJSON(F,c):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${F.type}"`)}O.uuid=F.uuid,void 0!==F.name&&(O.name=F.name),!0===O.isBufferGeometry&&void 0!==F.userData&&(O.userData=F.userData),p[F.uuid]=O}}return p}parseMaterials(e,c){const p={},_={};if(void 0!==e){const w=new Bd;w.setTextures(c);for(let L=0,O=e.length;L<O;L++){const F=e[L];if("MultiMaterial"===F.type){const U=[];for(let te=0;te<F.materials.length;te++){const ce=F.materials[te];void 0===p[ce.uuid]&&(p[ce.uuid]=w.parse(ce)),U.push(p[ce.uuid])}_[F.uuid]=U}else void 0===p[F.uuid]&&(p[F.uuid]=w.parse(F)),_[F.uuid]=p[F.uuid]}}return _}parseAnimations(e){const c={};if(void 0!==e)for(let p=0;p<e.length;p++){const w=Qt.parse(e[p]);c[w.uuid]=w}return c}parseImages(e,c){const p=this,_={};let w;function L(O){if("string"==typeof O){const F=O;return U=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(F)?F:p.resourcePath+F,p.manager.itemStart(U),w.load(U,function(){p.manager.itemEnd(U)},void 0,function(){p.manager.itemError(U),p.manager.itemEnd(U)})}var U;return O.data?{data:ja(O.type,O.data),width:O.width,height:O.height}:null}if(void 0!==e&&e.length>0){const O=new fr(c);w=new no(O),w.setCrossOrigin(this.crossOrigin);for(let F=0,U=e.length;F<U;F++){const te=e[F],ce=te.url;if(Array.isArray(ce)){_[te.uuid]=[];for(let oe=0,de=ce.length;oe<de;oe++){const ve=L(ce[oe]);null!==ve&&(ve instanceof HTMLImageElement?_[te.uuid].push(ve):_[te.uuid].push(new La(ve.data,ve.width,ve.height)))}}else{const oe=L(te.url);null!==oe&&(_[te.uuid]=oe)}}}return _}async parseImagesAsync(e){const c=this,p={};let _;async function w(L){if("string"==typeof L){const O=L,F=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(O)?O:c.resourcePath+O;return await _.loadAsync(F)}return L.data?{data:ja(L.type,L.data),width:L.width,height:L.height}:null}if(void 0!==e&&e.length>0){_=new no(this.manager),_.setCrossOrigin(this.crossOrigin);for(let L=0,O=e.length;L<O;L++){const F=e[L],U=F.url;if(Array.isArray(U)){p[F.uuid]=[];for(let te=0,ce=U.length;te<ce;te++){const oe=U[te],de=await w(oe);null!==de&&(de instanceof HTMLImageElement?p[F.uuid].push(de):p[F.uuid].push(new La(de.data,de.width,de.height)))}}else{const te=await w(F.url);null!==te&&(p[F.uuid]=te)}}}return p}parseTextures(e,c){function p(w,L){return"number"==typeof w?w:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",w),L[w])}const _={};if(void 0!==e)for(let w=0,L=e.length;w<L;w++){const O=e[w];let F;void 0===O.image&&console.warn('THREE.ObjectLoader: No "image" specified for',O.uuid),void 0===c[O.image]&&console.warn("THREE.ObjectLoader: Undefined image",O.image);const U=c[O.image];Array.isArray(U)?(F=new Zl(U),6===U.length&&(F.needsUpdate=!0)):(F=U&&U.data?new La(U.data,U.width,U.height):new As(U),U&&(F.needsUpdate=!0)),F.uuid=O.uuid,void 0!==O.name&&(F.name=O.name),void 0!==O.mapping&&(F.mapping=p(O.mapping,y_)),void 0!==O.offset&&F.offset.fromArray(O.offset),void 0!==O.repeat&&F.repeat.fromArray(O.repeat),void 0!==O.center&&F.center.fromArray(O.center),void 0!==O.rotation&&(F.rotation=O.rotation),void 0!==O.wrap&&(F.wrapS=p(O.wrap[0],dm),F.wrapT=p(O.wrap[1],dm)),void 0!==O.format&&(F.format=O.format),void 0!==O.type&&(F.type=O.type),void 0!==O.encoding&&(F.encoding=O.encoding),void 0!==O.minFilter&&(F.minFilter=p(O.minFilter,t_)),void 0!==O.magFilter&&(F.magFilter=p(O.magFilter,t_)),void 0!==O.anisotropy&&(F.anisotropy=O.anisotropy),void 0!==O.flipY&&(F.flipY=O.flipY),void 0!==O.premultiplyAlpha&&(F.premultiplyAlpha=O.premultiplyAlpha),void 0!==O.unpackAlignment&&(F.unpackAlignment=O.unpackAlignment),_[O.uuid]=F}return _}parseObject(e,c,p,_,w){let L,O,F;function U(oe){return void 0===c[oe]&&console.warn("THREE.ObjectLoader: Undefined geometry",oe),c[oe]}function te(oe){if(void 0!==oe){if(Array.isArray(oe)){const de=[];for(let ve=0,Me=oe.length;ve<Me;ve++){const Be=oe[ve];void 0===p[Be]&&console.warn("THREE.ObjectLoader: Undefined material",Be),de.push(p[Be])}return de}return void 0===p[oe]&&console.warn("THREE.ObjectLoader: Undefined material",oe),p[oe]}}function ce(oe){return void 0===_[oe]&&console.warn("THREE.ObjectLoader: Undefined texture",oe),_[oe]}switch(e.type){case"Scene":L=new rh,void 0!==e.background&&(L.background=Number.isInteger(e.background)?new Qn(e.background):ce(e.background)),void 0!==e.environment&&(L.environment=ce(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?L.fog=new nh(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(L.fog=new eu(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":L=new Fo(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(L.focus=e.focus),void 0!==e.zoom&&(L.zoom=e.zoom),void 0!==e.filmGauge&&(L.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(L.filmOffset=e.filmOffset),void 0!==e.view&&(L.view=Object.assign({},e.view));break;case"OrthographicCamera":L=new Ql(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(L.zoom=e.zoom),void 0!==e.view&&(L.view=Object.assign({},e.view));break;case"AmbientLight":L=new Ld(e.color,e.intensity);break;case"DirectionalLight":L=new Rf(e.color,e.intensity);break;case"PointLight":L=new Dm(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":L=new ld(e.color,e.intensity,e.width,e.height);break;case"SpotLight":L=new Oc(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":L=new Ic(e.color,e.groundColor,e.intensity);break;case"LightProbe":L=(new Pf).fromJSON(e);break;case"SkinnedMesh":O=U(e.geometry),F=te(e.material),L=new Ps(O,F),void 0!==e.bindMode&&(L.bindMode=e.bindMode),void 0!==e.bindMatrix&&L.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(L.skeleton=e.skeleton);break;case"Mesh":O=U(e.geometry),F=te(e.material),L=new ko(O,F);break;case"InstancedMesh":O=U(e.geometry),F=te(e.material);const de=e.instanceMatrix,ve=e.instanceColor;L=new Go(O,F,e.count),L.instanceMatrix=new Zi(new Float32Array(de.array),16),void 0!==ve&&(L.instanceColor=new Zi(new Float32Array(ve.array),ve.itemSize));break;case"LOD":L=new Ds;break;case"Line":L=new to(U(e.geometry),te(e.material));break;case"LineLoop":L=new df(U(e.geometry),te(e.material));break;case"LineSegments":L=new Qs(U(e.geometry),te(e.material));break;case"PointCloud":case"Points":L=new Po(U(e.geometry),te(e.material));break;case"Sprite":L=new Ol(te(e.material));break;case"Group":L=new Eh;break;case"Bone":L=new Xa;break;default:L=new Pr}if(L.uuid=e.uuid,void 0!==e.name&&(L.name=e.name),void 0!==e.matrix?(L.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(L.matrixAutoUpdate=e.matrixAutoUpdate),L.matrixAutoUpdate&&L.matrix.decompose(L.position,L.quaternion,L.scale)):(void 0!==e.position&&L.position.fromArray(e.position),void 0!==e.rotation&&L.rotation.fromArray(e.rotation),void 0!==e.quaternion&&L.quaternion.fromArray(e.quaternion),void 0!==e.scale&&L.scale.fromArray(e.scale)),void 0!==e.castShadow&&(L.castShadow=e.castShadow),void 0!==e.receiveShadow&&(L.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(L.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(L.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(L.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&L.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(L.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(L.visible=e.visible),void 0!==e.frustumCulled&&(L.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(L.renderOrder=e.renderOrder),void 0!==e.userData&&(L.userData=e.userData),void 0!==e.layers&&(L.layers.mask=e.layers),void 0!==e.children){const oe=e.children;for(let de=0;de<oe.length;de++)L.add(this.parseObject(oe[de],c,p,_,w))}if(void 0!==e.animations){const oe=e.animations;for(let de=0;de<oe.length;de++)L.animations.push(w[oe[de]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(L.autoUpdate=e.autoUpdate);const oe=e.levels;for(let de=0;de<oe.length;de++){const ve=oe[de],Me=L.getObjectByProperty("uuid",ve.object);void 0!==Me&&L.addLevel(Me,ve.distance)}}return L}bindSkeletons(e,c){0!==Object.keys(c).length&&e.traverse(function(p){if(!0===p.isSkinnedMesh&&void 0!==p.skeleton){const _=c[p.skeleton];void 0===_?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",p.skeleton):p.bind(_,p.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const y_={UVMapping:gi,CubeReflectionMapping:Ti,CubeRefractionMapping:$o,EquirectangularReflectionMapping:Hs,EquirectangularRefractionMapping:ia,CubeUVReflectionMapping:Oi,CubeUVRefractionMapping:Co},dm={RepeatWrapping:wo,ClampToEdgeWrapping:Yr,MirroredRepeatWrapping:os},t_={NearestFilter:Or,NearestMipmapNearestFilter:Oa,NearestMipmapLinearFilter:fs,LinearFilter:ai,LinearMipmapNearestFilter:Fc,LinearMipmapLinearFilter:Ka};class n_ extends Rn{constructor(e){super(e),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,c,p,_){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const w=this,L=gn.get(e);if(void 0!==L)return w.manager.itemStart(e),setTimeout(function(){c&&c(L),w.manager.itemEnd(e)},0),L;const O={};O.credentials="anonymous"===this.crossOrigin?"same-origin":"include",O.headers=this.requestHeader,fetch(e,O).then(function(F){return F.blob()}).then(function(F){return createImageBitmap(F,Object.assign(w.options,{colorSpaceConversion:"none"}))}).then(function(F){gn.add(e,F),c&&c(F),w.manager.itemEnd(e)}).catch(function(F){_&&_(F),w.manager.itemError(e),w.manager.itemEnd(e)}),w.manager.itemStart(e)}}n_.prototype.isImageBitmapLoader=!0;class r_{constructor(){this.type="ShapePath",this.color=new Qn,this.subPaths=[],this.currentPath=null}moveTo(e,c){return this.currentPath=new hs,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,c),this}lineTo(e,c){return this.currentPath.lineTo(e,c),this}quadraticCurveTo(e,c,p,_){return this.currentPath.quadraticCurveTo(e,c,p,_),this}bezierCurveTo(e,c,p,_,w,L){return this.currentPath.bezierCurveTo(e,c,p,_,w,L),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,c){function p(ke){const Je=[];for(let We=0,rt=ke.length;We<rt;We++){const nt=ke[We],gt=new ps;gt.curves=nt.curves,Je.push(gt)}return Je}function _(ke,Je){const We=Je.length;let rt=!1;for(let nt=We-1,gt=0;gt<We;nt=gt++){let xt=Je[nt],Ut=Je[gt],Ht=Ut.x-xt.x,Ye=Ut.y-xt.y;if(Math.abs(Ye)>Number.EPSILON){if(Ye<0&&(xt=Je[gt],Ht=-Ht,Ut=Je[nt],Ye=-Ye),ke.y<xt.y||ke.y>Ut.y)continue;if(ke.y===xt.y){if(ke.x===xt.x)return!0}else{const pt=Ye*(ke.x-xt.x)-Ht*(ke.y-xt.y);if(0===pt)return!0;if(pt<0)continue;rt=!rt}}else{if(ke.y!==xt.y)continue;if(Ut.x<=ke.x&&ke.x<=xt.x||xt.x<=ke.x&&ke.x<=Ut.x)return!0}}return rt}const w=hi.isClockWise,L=this.subPaths;if(0===L.length)return[];if(!0===c)return p(L);let O,F,U;const te=[];if(1===L.length)return F=L[0],U=new ps,U.curves=F.curves,te.push(U),te;let ce=!w(L[0].getPoints());ce=e?!ce:ce;const oe=[],de=[];let ve,Me,Be=[],Ae=0;de[Ae]=void 0,Be[Ae]=[];for(let ke=0,Je=L.length;ke<Je;ke++)F=L[ke],ve=F.getPoints(),O=w(ve),O=e?!O:O,O?(!ce&&de[Ae]&&Ae++,de[Ae]={s:new ps,p:ve},de[Ae].s.curves=F.curves,ce&&Ae++,Be[Ae]=[]):Be[Ae].push({h:F,p:ve[0]});if(!de[0])return p(L);if(de.length>1){let ke=!1;const Je=[];for(let We=0,rt=de.length;We<rt;We++)oe[We]=[];for(let We=0,rt=de.length;We<rt;We++){const nt=Be[We];for(let gt=0;gt<nt.length;gt++){const xt=nt[gt];let Ut=!0;for(let Ht=0;Ht<de.length;Ht++)_(xt.p,de[Ht].p)&&(We!==Ht&&Je.push({froms:We,tos:Ht,hole:gt}),Ut?(Ut=!1,oe[Ht].push(xt)):ke=!0);Ut&&oe[We].push(xt)}}Je.length>0&&(ke||(Be=oe))}for(let ke=0,Je=de.length;ke<Je;ke++){U=de[ke].s,te.push(U),Me=Be[ke];for(let We=0,rt=Me.length;We<rt;We++)U.holes.push(Me[We].h)}return te}}class zm{constructor(e){this.type="Font",this.data=e}generateShapes(e,c=100){const p=[],_=function(w,L,O){const F=Array.from(w),U=L/O.resolution,te=(O.boundingBox.yMax-O.boundingBox.yMin+O.underlineThickness)*U,ce=[];let oe=0,de=0;for(let ve=0;ve<F.length;ve++){const Me=F[ve];if("\n"===Me)oe=0,de-=te;else{const Be=b_(Me,U,oe,de,O);oe+=Be.offsetX,ce.push(Be.path)}}return ce}(e,c,this.data);for(let w=0,L=_.length;w<L;w++)Array.prototype.push.apply(p,_[w].toShapes());return p}}function b_(S,e,c,p,_){const w=_.glyphs[S]||_.glyphs["?"];if(!w)return void console.error('THREE.Font: character "'+S+'" does not exists in font family '+_.familyName+".");const L=new r_;let O,F,U,te,ce,oe,de,ve;if(w.o){const Me=w._cachedOutline||(w._cachedOutline=w.o.split(" "));for(let Be=0,Ae=Me.length;Be<Ae;)switch(Me[Be++]){case"m":O=Me[Be++]*e+c,F=Me[Be++]*e+p,L.moveTo(O,F);break;case"l":O=Me[Be++]*e+c,F=Me[Be++]*e+p,L.lineTo(O,F);break;case"q":U=Me[Be++]*e+c,te=Me[Be++]*e+p,ce=Me[Be++]*e+c,oe=Me[Be++]*e+p,L.quadraticCurveTo(ce,oe,U,te);break;case"b":U=Me[Be++]*e+c,te=Me[Be++]*e+p,ce=Me[Be++]*e+c,oe=Me[Be++]*e+p,de=Me[Be++]*e+c,ve=Me[Be++]*e+p,L.bezierCurveTo(ce,oe,de,ve,U,te)}}return{offsetX:w.ha*e,path:L}}zm.prototype.isFont=!0;class x_ extends Rn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new Kn(this.manager);L.setPath(this.path),L.setRequestHeader(this.requestHeader),L.setWithCredentials(w.withCredentials),L.load(e,function(O){let F;try{F=JSON.parse(O)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),F=JSON.parse(O.substring(65,O.length-2))}const U=w.parse(F);c&&c(U)},p,_)}parse(e){return new zm(e)}}let fm;const mm={getContext:function(){return void 0===fm&&(fm=new(window.AudioContext||window.webkitAudioContext)),fm},setContext:function(S){fm=S}};class lc extends Rn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new Kn(this.manager);L.setResponseType("arraybuffer"),L.setPath(this.path),L.setRequestHeader(this.requestHeader),L.setWithCredentials(this.withCredentials),L.load(e,function(O){try{const F=O.slice(0);mm.getContext().decodeAudioData(F,function(U){c(U)})}catch(F){_?_(F):console.error(F),w.manager.itemError(e)}},p,_)}}class jm extends Pf{constructor(e,c,p=1){super(void 0,p);const _=(new Qn).set(e),w=(new Qn).set(c),L=new at(_.r,_.g,_.b),O=new at(w.r,w.g,w.b),F=Math.sqrt(Math.PI),U=F*Math.sqrt(.75);this.sh.coefficients[0].copy(L).add(O).multiplyScalar(F),this.sh.coefficients[1].copy(L).sub(O).multiplyScalar(U)}}jm.prototype.isHemisphereLightProbe=!0;class Gm extends Pf{constructor(e,c=1){super(void 0,c);const p=(new Qn).set(e);this.sh.coefficients[0].set(p.r,p.g,p.b).multiplyScalar(2*Math.sqrt(Math.PI))}}Gm.prototype.isAmbientLightProbe=!0;const _m=new Kt,Of=new Kt;class Hm{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Fo,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Fo,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const c=this._cache;if(c.focus!==e.focus||c.fov!==e.fov||c.aspect!==e.aspect*this.aspect||c.near!==e.near||c.far!==e.far||c.zoom!==e.zoom||c.eyeSep!==this.eyeSep){c.focus=e.focus,c.fov=e.fov,c.aspect=e.aspect*this.aspect,c.near=e.near,c.far=e.far,c.zoom=e.zoom,c.eyeSep=this.eyeSep;const p=e.projectionMatrix.clone(),_=c.eyeSep/2,w=_*c.near/c.focus,L=c.near*Math.tan(jo*c.fov*.5)/c.zoom;let O,F;Of.elements[12]=-_,_m.elements[12]=_,O=-L*c.aspect+w,F=L*c.aspect+w,p.elements[0]=2*c.near/(F-O),p.elements[8]=(F+O)/(F-O),this.cameraL.projectionMatrix.copy(p),O=-L*c.aspect-w,F=L*c.aspect-w,p.elements[0]=2*c.near/(F-O),p.elements[8]=(F+O)/(F-O),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Of),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(_m)}}class gm{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Vm(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=Vm();e=(c-this.oldTime)/1e3,this.oldTime=c,this.elapsedTime+=e}return e}}function Vm(){return(typeof performance>"u"?Date:performance).now()}const cd=new at,i_=new Ci,o_=new at,Nd=new at;class Wm extends Pr{constructor(){super(),this.type="AudioListener",this.context=mm.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new gm}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const c=this.context.listener,p=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(cd,i_,o_),Nd.set(0,0,-1).applyQuaternion(i_),c.positionX){const _=this.context.currentTime+this.timeDelta;c.positionX.linearRampToValueAtTime(cd.x,_),c.positionY.linearRampToValueAtTime(cd.y,_),c.positionZ.linearRampToValueAtTime(cd.z,_),c.forwardX.linearRampToValueAtTime(Nd.x,_),c.forwardY.linearRampToValueAtTime(Nd.y,_),c.forwardZ.linearRampToValueAtTime(Nd.z,_),c.upX.linearRampToValueAtTime(p.x,_),c.upY.linearRampToValueAtTime(p.y,_),c.upZ.linearRampToValueAtTime(p.z,_)}else c.setPosition(cd.x,cd.y,cd.z),c.setOrientation(Nd.x,Nd.y,Nd.z,p.x,p.y,p.z)}}class vm extends Pr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const c=this.context.createBufferSource();return c.buffer=this.buffer,c.loop=this.loop,c.loopStart=this.loopStart,c.loopEnd=this.loopEnd,c.onended=this.onEnded.bind(this),c.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=c,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,c=this.filters.length;e<c;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,c=this.filters.length;e<c;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const zp=new at,ym=new Ci,kf=new at,Rd=new at;class mf extends vm{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,c,p){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=c,this.panner.coneOuterGain=p,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(zp,ym,kf),Rd.set(0,0,1).applyQuaternion(ym);const c=this.panner;if(c.positionX){const p=this.context.currentTime+this.listener.timeDelta;c.positionX.linearRampToValueAtTime(zp.x,p),c.positionY.linearRampToValueAtTime(zp.y,p),c.positionZ.linearRampToValueAtTime(zp.z,p),c.orientationX.linearRampToValueAtTime(Rd.x,p),c.orientationY.linearRampToValueAtTime(Rd.y,p),c.orientationZ.linearRampToValueAtTime(Rd.z,p)}else c.setPosition(zp.x,zp.y,zp.z),c.setOrientation(Rd.x,Rd.y,Rd.z)}}class ud{constructor(e,c=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=c,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const c=this.getFrequencyData();for(let p=0;p<c.length;p++)e+=c[p];return e/c.length}}class Ff{constructor(e,c,p){let _,w,L;switch(this.binding=e,this.valueSize=p,c){case"quaternion":_=this._slerp,w=this._slerpAdditive,L=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*p),this._workIndex=5;break;case"string":case"bool":_=this._select,w=this._select,L=this._setAdditiveIdentityOther,this.buffer=new Array(5*p);break;default:_=this._lerp,w=this._lerpAdditive,L=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*p)}this._mixBufferRegion=_,this._mixBufferRegionAdditive=w,this._setIdentity=L,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,c){const p=this.buffer,_=this.valueSize,w=e*_+_;let L=this.cumulativeWeight;if(0===L){for(let O=0;O!==_;++O)p[w+O]=p[O];L=c}else L+=c,this._mixBufferRegion(p,w,0,c/L,_);this.cumulativeWeight=L}accumulateAdditive(e){const c=this.buffer,p=this.valueSize,_=p*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(c,_,0,e,p),this.cumulativeWeightAdditive+=e}apply(e){const c=this.valueSize,p=this.buffer,_=e*c+c,w=this.cumulativeWeight,L=this.cumulativeWeightAdditive,O=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,w<1&&this._mixBufferRegion(p,_,c*this._origIndex,1-w,c),L>0&&this._mixBufferRegionAdditive(p,_,this._addIndex*c,1,c);for(let F=c,U=c+c;F!==U;++F)if(p[F]!==p[F+c]){O.setValue(p,_);break}}saveOriginalState(){const c=this.buffer,p=this.valueSize,_=p*this._origIndex;this.binding.getValue(c,_);for(let w=p,L=_;w!==L;++w)c[w]=c[_+w%p];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,c=e+this.valueSize;for(let p=e;p<c;p++)this.buffer[p]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,c=this._addIndex*this.valueSize;for(let p=0;p<this.valueSize;p++)this.buffer[c+p]=this.buffer[e+p]}_select(e,c,p,_,w){if(_>=.5)for(let L=0;L!==w;++L)e[c+L]=e[p+L]}_slerp(e,c,p,_){Ci.slerpFlat(e,c,e,c,e,p,_)}_slerpAdditive(e,c,p,_,w){const L=this._workIndex*w;Ci.multiplyQuaternionsFlat(e,L,e,c,e,p),Ci.slerpFlat(e,c,e,c,e,L,_)}_lerp(e,c,p,_,w){const L=1-_;for(let O=0;O!==w;++O){const F=c+O;e[F]=e[F]*L+e[p+O]*_}}_lerpAdditive(e,c,p,_,w){for(let L=0;L!==w;++L){const O=c+L;e[O]=e[O]+e[p+L]*_}}}const Df="\\[\\]\\.:\\/",s_=new RegExp("["+Df+"]","g"),hd="[^"+Df+"]",_f="[^"+Df.replace("\\.","")+"]",w_=/((?:WC+[\/:])*)/.source.replace("WC",hd),a_=/(WCOD+)?/.source.replace("WCOD",_f),l_=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",hd),gf=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",hd),Uf=new RegExp("^"+w_+a_+l_+gf+"$"),bm=["material","materials","bones"];class yo{constructor(e,c,p){this.path=c,this.parsedPath=p||yo.parseTrackName(c),this.node=yo.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,c,p){return e&&e.isAnimationObjectGroup?new yo.Composite(e,c,p):new yo(e,c,p)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(s_,"")}static parseTrackName(e){const c=Uf.exec(e);if(!c)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const p={nodeName:c[2],objectName:c[3],objectIndex:c[4],propertyName:c[5],propertyIndex:c[6]},_=p.nodeName&&p.nodeName.lastIndexOf(".");if(void 0!==_&&-1!==_){const w=p.nodeName.substring(_+1);-1!==bm.indexOf(w)&&(p.nodeName=p.nodeName.substring(0,_),p.objectName=w)}if(null===p.propertyName||0===p.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return p}static findNode(e,c){if(!c||""===c||"."===c||-1===c||c===e.name||c===e.uuid)return e;if(e.skeleton){const p=e.skeleton.getBoneByName(c);if(void 0!==p)return p}if(e.children){const p=function(w){for(let L=0;L<w.length;L++){const O=w[L];if(O.name===c||O.uuid===c)return O;const F=p(O.children);if(F)return F}return null},_=p(e.children);if(_)return _}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,c){e[c]=this.targetObject[this.propertyName]}_getValue_array(e,c){const p=this.resolvedProperty;for(let _=0,w=p.length;_!==w;++_)e[c++]=p[_]}_getValue_arrayElement(e,c){e[c]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,c){this.resolvedProperty.toArray(e,c)}_setValue_direct(e,c){this.targetObject[this.propertyName]=e[c]}_setValue_direct_setNeedsUpdate(e,c){this.targetObject[this.propertyName]=e[c],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,c){this.targetObject[this.propertyName]=e[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,c){const p=this.resolvedProperty;for(let _=0,w=p.length;_!==w;++_)p[_]=e[c++]}_setValue_array_setNeedsUpdate(e,c){const p=this.resolvedProperty;for(let _=0,w=p.length;_!==w;++_)p[_]=e[c++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,c){const p=this.resolvedProperty;for(let _=0,w=p.length;_!==w;++_)p[_]=e[c++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,c){this.resolvedProperty[this.propertyIndex]=e[c]}_setValue_arrayElement_setNeedsUpdate(e,c){this.resolvedProperty[this.propertyIndex]=e[c],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,c){this.resolvedProperty[this.propertyIndex]=e[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,c){this.resolvedProperty.fromArray(e,c)}_setValue_fromArray_setNeedsUpdate(e,c){this.resolvedProperty.fromArray(e,c),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,c){this.resolvedProperty.fromArray(e,c),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,c){this.bind(),this.getValue(e,c)}_setValue_unbound(e,c){this.bind(),this.setValue(e,c)}bind(){let e=this.node;const c=this.parsedPath,p=c.objectName,_=c.propertyName;let w=c.propertyIndex;if(e||(e=yo.findNode(this.rootNode,c.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(p){let U=c.objectIndex;switch(p){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let te=0;te<e.length;te++)if(e[te].name===U){U=te;break}break;default:if(void 0===e[p])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[p]}if(void 0!==U){if(void 0===e[U])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[U]}}const L=e[_];if(void 0===L)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+c.nodeName+"."+_+" but it wasn't found.",e);let O=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?O=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(O=this.Versioning.MatrixWorldNeedsUpdate);let F=this.BindingType.Direct;if(void 0!==w){if("morphTargetInfluences"===_){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[w]&&(w=e.morphTargetDictionary[w])}F=this.BindingType.ArrayElement,this.resolvedProperty=L,this.propertyIndex=w}else void 0!==L.fromArray&&void 0!==L.toArray?(F=this.BindingType.HasFromToArray,this.resolvedProperty=L):Array.isArray(L)?(F=this.BindingType.EntireArray,this.resolvedProperty=L):this.propertyName=_;this.getValue=this.GetterByBindingType[F],this.setValue=this.SetterByBindingTypeAndVersioning[F][O]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}yo.Composite=class{constructor(S,e,c){const p=c||yo.parseTrackName(e);this._targetGroup=S,this._bindings=S.subscribe_(e,p)}getValue(S,e){this.bind();const p=this._bindings[this._targetGroup.nCachedObjects_];void 0!==p&&p.getValue(S,e)}setValue(S,e){const c=this._bindings;for(let p=this._targetGroup.nCachedObjects_,_=c.length;p!==_;++p)c[p].setValue(S,e)}bind(){const S=this._bindings;for(let e=this._targetGroup.nCachedObjects_,c=S.length;e!==c;++e)S[e].bind()}unbind(){const S=this._bindings;for(let e=this._targetGroup.nCachedObjects_,c=S.length;e!==c;++e)S[e].unbind()}},yo.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},yo.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},yo.prototype.GetterByBindingType=[yo.prototype._getValue_direct,yo.prototype._getValue_array,yo.prototype._getValue_arrayElement,yo.prototype._getValue_toArray],yo.prototype.SetterByBindingTypeAndVersioning=[[yo.prototype._setValue_direct,yo.prototype._setValue_direct_setNeedsUpdate,yo.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[yo.prototype._setValue_array,yo.prototype._setValue_array_setNeedsUpdate,yo.prototype._setValue_array_setMatrixWorldNeedsUpdate],[yo.prototype._setValue_arrayElement,yo.prototype._setValue_arrayElement_setNeedsUpdate,yo.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[yo.prototype._setValue_fromArray,yo.prototype._setValue_fromArray_setNeedsUpdate,yo.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class zf{constructor(){this.uuid=eo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let p=0,_=arguments.length;p!==_;++p)e[arguments[p].uuid]=p;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const c=this;this.stats={objects:{get total(){return c._objects.length},get inUse(){return this.total-c.nCachedObjects_}},get bindingsPerObject(){return c._bindings.length}}}add(){const e=this._objects,c=this._indicesByUUID,p=this._paths,_=this._parsedPaths,w=this._bindings,L=w.length;let O,F=e.length,U=this.nCachedObjects_;for(let te=0,ce=arguments.length;te!==ce;++te){const oe=arguments[te],de=oe.uuid;let ve=c[de];if(void 0===ve){ve=F++,c[de]=ve,e.push(oe);for(let Me=0,Be=L;Me!==Be;++Me)w[Me].push(new yo(oe,p[Me],_[Me]))}else if(ve<U){O=e[ve];const Me=--U,Be=e[Me];c[Be.uuid]=ve,e[ve]=Be,c[de]=Me,e[Me]=oe;for(let Ae=0,ke=L;Ae!==ke;++Ae){const Je=w[Ae];let rt=Je[ve];Je[ve]=Je[Me],void 0===rt&&(rt=new yo(oe,p[Ae],_[Ae])),Je[Me]=rt}}else e[ve]!==O&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=U}remove(){const e=this._objects,c=this._indicesByUUID,p=this._bindings,_=p.length;let w=this.nCachedObjects_;for(let L=0,O=arguments.length;L!==O;++L){const F=arguments[L],U=F.uuid,te=c[U];if(void 0!==te&&te>=w){const ce=w++,oe=e[ce];c[oe.uuid]=te,e[te]=oe,c[U]=ce,e[ce]=F;for(let de=0,ve=_;de!==ve;++de){const Me=p[de],Ae=Me[te];Me[te]=Me[ce],Me[ce]=Ae}}}this.nCachedObjects_=w}uncache(){const e=this._objects,c=this._indicesByUUID,p=this._bindings,_=p.length;let w=this.nCachedObjects_,L=e.length;for(let O=0,F=arguments.length;O!==F;++O){const U=arguments[O].uuid,te=c[U];if(void 0!==te)if(delete c[U],te<w){const ce=--w,oe=e[ce],de=--L,ve=e[de];c[oe.uuid]=te,e[te]=oe,c[ve.uuid]=ce,e[ce]=ve,e.pop();for(let Me=0,Be=_;Me!==Be;++Me){const Ae=p[Me],Je=Ae[de];Ae[te]=Ae[ce],Ae[ce]=Je,Ae.pop()}}else{const ce=--L,oe=e[ce];ce>0&&(c[oe.uuid]=te),e[te]=oe,e.pop();for(let de=0,ve=_;de!==ve;++de){const Me=p[de];Me[te]=Me[ce],Me.pop()}}}this.nCachedObjects_=w}subscribe_(e,c){const p=this._bindingsIndicesByPath;let _=p[e];const w=this._bindings;if(void 0!==_)return w[_];const L=this._paths,O=this._parsedPaths,F=this._objects,te=this.nCachedObjects_,ce=new Array(F.length);_=w.length,p[e]=_,L.push(e),O.push(c),w.push(ce);for(let oe=te,de=F.length;oe!==de;++oe)ce[oe]=new yo(F[oe],e,c);return ce}unsubscribe_(e){const c=this._bindingsIndicesByPath,p=c[e];if(void 0!==p){const _=this._paths,w=this._parsedPaths,L=this._bindings,O=L.length-1,F=L[O];c[e[O]]=p,L[p]=F,L.pop(),w[p]=w[O],w.pop(),_[p]=_[O],_.pop()}}}zf.prototype.isAnimationObjectGroup=!0;class c_{constructor(e,c,p=null,_=c.blendMode){this._mixer=e,this._clip=c,this._localRoot=p,this.blendMode=_;const w=c.tracks,L=w.length,O=new Array(L),F={endingStart:ba,endingEnd:ba};for(let U=0;U!==L;++U){const te=w[U].createInterpolant(null);O[U]=te,te.settings=F}this._interpolantSettings=F,this._interpolants=O,this._propertyBindings=new Array(L),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Fa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,c){return this.loop=e,this.repetitions=c,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,c,p){if(e.fadeOut(c),this.fadeIn(c),p){const _=this._clip.duration,w=e._clip.duration,O=_/w;e.warp(1,w/_,c),this.warp(O,1,c)}return this}crossFadeTo(e,c,p){return e.crossFadeFrom(this,c,p)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,c,p){const _=this._mixer,w=_.time,L=this.timeScale;let O=this._timeScaleInterpolant;null===O&&(O=_._lendControlInterpolant(),this._timeScaleInterpolant=O);const F=O.parameterPositions,U=O.sampleValues;return F[0]=w,F[1]=w+p,U[0]=e/L,U[1]=c/L,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,c,p,_){if(!this.enabled)return void this._updateWeight(e);const w=this._startTime;if(null!==w){const F=(e-w)*p;if(F<0||0===p)return;this._startTime=null,c=p*F}c*=this._updateTimeScale(e);const L=this._updateTime(c),O=this._updateWeight(e);if(O>0){const F=this._interpolants,U=this._propertyBindings;if(this.blendMode===Wu)for(let te=0,ce=F.length;te!==ce;++te)F[te].evaluate(L),U[te].accumulateAdditive(O);else for(let te=0,ce=F.length;te!==ce;++te)F[te].evaluate(L),U[te].accumulate(_,O)}}_updateWeight(e){let c=0;if(this.enabled){c=this.weight;const p=this._weightInterpolant;if(null!==p){const _=p.evaluate(e)[0];c*=_,e>p.parameterPositions[1]&&(this.stopFading(),0===_&&(this.enabled=!1))}}return this._effectiveWeight=c,c}_updateTimeScale(e){let c=0;if(!this.paused){c=this.timeScale;const p=this._timeScaleInterpolant;null!==p&&(c*=p.evaluate(e)[0],e>p.parameterPositions[1]&&(this.stopWarping(),0===c?this.paused=!0:this.timeScale=c))}return this._effectiveTimeScale=c,c}_updateTime(e){const c=this._clip.duration,p=this.loop;let _=this.time+e,w=this._loopCount;const L=p===dc;if(0===e)return-1===w||!L||1&~w?_:c-_;if(p===fu){-1===w&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(_>=c)_=c;else{if(!(_<0)){this.time=_;break e}_=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===w&&(e>=0?(w=0,this._setEndings(!0,0===this.repetitions,L)):this._setEndings(0===this.repetitions,!0,L)),_>=c||_<0){const O=Math.floor(_/c);_-=c*O,w+=Math.abs(O);const F=this.repetitions-w;if(F<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,_=e>0?c:0,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===F){const U=e<0;this._setEndings(U,!U,L)}else this._setEndings(!1,!1,L);this._loopCount=w,this.time=_,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:O})}}else this.time=_;if(L&&!(1&~w))return c-_}return _}_setEndings(e,c,p){const _=this._interpolantSettings;p?(_.endingStart=sa,_.endingEnd=sa):(_.endingStart=e?this.zeroSlopeAtStart?sa:ba:wl,_.endingEnd=c?this.zeroSlopeAtEnd?sa:ba:wl)}_scheduleFading(e,c,p){const _=this._mixer,w=_.time;let L=this._weightInterpolant;null===L&&(L=_._lendControlInterpolant(),this._weightInterpolant=L);const O=L.parameterPositions,F=L.sampleValues;return O[0]=w,F[0]=c,O[1]=w+e,F[1]=p,this}}class tf extends Os{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,c){const p=e._localRoot||this._root,_=e._clip.tracks,w=_.length,L=e._propertyBindings,O=e._interpolants,F=p.uuid,U=this._bindingsByRootAndName;let te=U[F];void 0===te&&(te={},U[F]=te);for(let ce=0;ce!==w;++ce){const oe=_[ce],de=oe.name;let ve=te[de];if(void 0!==ve)L[ce]=ve;else{if(ve=L[ce],void 0!==ve){null===ve._cacheIndex&&(++ve.referenceCount,this._addInactiveBinding(ve,F,de));continue}ve=new Ff(yo.create(p,de,c&&c._propertyBindings[ce].binding.parsedPath),oe.ValueTypeName,oe.getValueSize()),++ve.referenceCount,this._addInactiveBinding(ve,F,de),L[ce]=ve}O[ce].resultBuffer=ve.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const p=(e._localRoot||this._root).uuid,_=e._clip.uuid,w=this._actionsByClip[_];this._bindAction(e,w&&w.knownActions[0]),this._addInactiveAction(e,_,p)}const c=e._propertyBindings;for(let p=0,_=c.length;p!==_;++p){const w=c[p];0==w.useCount++&&(this._lendBinding(w),w.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const c=e._propertyBindings;for(let p=0,_=c.length;p!==_;++p){const w=c[p];0==--w.useCount&&(w.restoreOriginalState(),this._takeBackBinding(w))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const c=e._cacheIndex;return null!==c&&c<this._nActiveActions}_addInactiveAction(e,c,p){const _=this._actions,w=this._actionsByClip;let L=w[c];if(void 0===L)L={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,w[c]=L;else{const O=L.knownActions;e._byClipCacheIndex=O.length,O.push(e)}e._cacheIndex=_.length,_.push(e),L.actionByRoot[p]=e}_removeInactiveAction(e){const c=this._actions,p=c[c.length-1],_=e._cacheIndex;p._cacheIndex=_,c[_]=p,c.pop(),e._cacheIndex=null;const w=e._clip.uuid,L=this._actionsByClip,O=L[w],F=O.knownActions,U=F[F.length-1],te=e._byClipCacheIndex;U._byClipCacheIndex=te,F[te]=U,F.pop(),e._byClipCacheIndex=null,delete O.actionByRoot[(e._localRoot||this._root).uuid],0===F.length&&delete L[w],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const c=e._propertyBindings;for(let p=0,_=c.length;p!==_;++p){const w=c[p];0==--w.referenceCount&&this._removeInactiveBinding(w)}}_lendAction(e){const c=this._actions,p=e._cacheIndex,_=this._nActiveActions++,w=c[_];e._cacheIndex=_,c[_]=e,w._cacheIndex=p,c[p]=w}_takeBackAction(e){const c=this._actions,p=e._cacheIndex,_=--this._nActiveActions,w=c[_];e._cacheIndex=_,c[_]=e,w._cacheIndex=p,c[p]=w}_addInactiveBinding(e,c,p){const _=this._bindingsByRootAndName,w=this._bindings;let L=_[c];void 0===L&&(L={},_[c]=L),L[p]=e,e._cacheIndex=w.length,w.push(e)}_removeInactiveBinding(e){const c=this._bindings,p=e.binding,_=p.rootNode.uuid,w=p.path,L=this._bindingsByRootAndName,O=L[_],F=c[c.length-1],U=e._cacheIndex;F._cacheIndex=U,c[U]=F,c.pop(),delete O[w],0===Object.keys(O).length&&delete L[_]}_lendBinding(e){const c=this._bindings,p=e._cacheIndex,_=this._nActiveBindings++,w=c[_];e._cacheIndex=_,c[_]=e,w._cacheIndex=p,c[p]=w}_takeBackBinding(e){const c=this._bindings,p=e._cacheIndex,_=--this._nActiveBindings,w=c[_];e._cacheIndex=_,c[_]=e,w._cacheIndex=p,c[p]=w}_lendControlInterpolant(){const e=this._controlInterpolants,c=this._nActiveControlInterpolants++;let p=e[c];return void 0===p&&(p=new it(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),p.__cacheIndex=c,e[c]=p),p}_takeBackControlInterpolant(e){const c=this._controlInterpolants,p=e.__cacheIndex,_=--this._nActiveControlInterpolants,w=c[_];e.__cacheIndex=_,c[_]=e,w.__cacheIndex=p,c[p]=w}clipAction(e,c,p){const _=c||this._root,w=_.uuid;let L="string"==typeof e?Qt.findByName(_,e):e;const O=null!==L?L.uuid:e,F=this._actionsByClip[O];let U=null;if(void 0===p&&(p=null!==L?L.blendMode:Vu),void 0!==F){const ce=F.actionByRoot[w];if(void 0!==ce&&ce.blendMode===p)return ce;U=F.knownActions[0],null===L&&(L=U._clip)}if(null===L)return null;const te=new c_(this,L,c,p);return this._bindAction(te,U),this._addInactiveAction(te,O,w),te}existingAction(e,c){const p=c||this._root,_=p.uuid,w="string"==typeof e?Qt.findByName(p,e):e,O=this._actionsByClip[w?w.uuid:e];return void 0!==O&&O.actionByRoot[_]||null}stopAllAction(){const e=this._actions;for(let c=this._nActiveActions-1;c>=0;--c)e[c].stop();return this}update(e){const c=this._actions,p=this._nActiveActions,_=this.time+=e*=this.timeScale,w=Math.sign(e),L=this._accuIndex^=1;for(let U=0;U!==p;++U)c[U]._update(_,e,w,L);const O=this._bindings,F=this._nActiveBindings;for(let U=0;U!==F;++U)O[U].apply(L);return this}setTime(e){this.time=0;for(let c=0;c<this._actions.length;c++)this._actions[c].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const c=this._actions,p=e.uuid,_=this._actionsByClip,w=_[p];if(void 0!==w){const L=w.knownActions;for(let O=0,F=L.length;O!==F;++O){const U=L[O];this._deactivateAction(U);const te=U._cacheIndex,ce=c[c.length-1];U._cacheIndex=null,U._byClipCacheIndex=null,ce._cacheIndex=te,c[te]=ce,c.pop(),this._removeInactiveBindingsForAction(U)}delete _[p]}}uncacheRoot(e){const c=e.uuid,p=this._actionsByClip;for(const w in p){const L=p[w].actionByRoot[c];void 0!==L&&(this._deactivateAction(L),this._removeInactiveAction(L))}const _=this._bindingsByRootAndName[c];if(void 0!==_)for(const w in _){const L=_[w];L.restoreOriginalState(),this._removeInactiveBinding(L)}}uncacheAction(e,c){const p=this.existingAction(e,c);null!==p&&(this._deactivateAction(p),this._removeInactiveAction(p))}}tf.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class nf{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new nf(void 0===this.value.clone?this.value:this.value.clone())}}class na extends Js{constructor(e,c,p=1){super(e,c),this.meshPerAttribute=p}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const c=super.clone(e);return c.meshPerAttribute=this.meshPerAttribute,c}toJSON(e){const c=super.toJSON(e);return c.isInstancedInterleavedBuffer=!0,c.meshPerAttribute=this.meshPerAttribute,c}}na.prototype.isInstancedInterleavedBuffer=!0;class vf{constructor(e,c,p,_,w){this.buffer=e,this.type=c,this.itemSize=p,this.elementSize=_,this.count=w,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,c){return this.type=e,this.elementSize=c,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}vf.prototype.isGLBufferAttribute=!0;class Ra{constructor(e,c,p=0,_=1/0){this.ray=new mn(e,c),this.near=p,this.far=_,this.camera=null,this.layers=new Xs,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,c){this.ray.set(e,c)}setFromCamera(e,c){c&&c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c&&c.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}intersectObject(e,c=!1,p=[]){return jp(e,this,p,c),p.sort(jf),p}intersectObjects(e,c=!1,p=[]){for(let _=0,w=e.length;_<w;_++)jp(e[_],this,p,c);return p.sort(jf),p}}function jf(S,e){return S.distance-e.distance}function jp(S,e,c,p){if(S.layers.test(e.layers)&&S.raycast(e,c),!0===p){const _=S.children;for(let w=0,L=_.length;w<L;w++)jp(_[w],e,c,!0)}}class Gf{constructor(e=1,c=0,p=0){return this.radius=e,this.phi=c,this.theta=p,this}set(e,c,p){return this.radius=e,this.phi=c,this.theta=p,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,c,p){return this.radius=Math.sqrt(e*e+c*c+p*p),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,p),this.phi=Math.acos(Gr(c/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Hf{constructor(e=1,c=0,p=0){return this.radius=e,this.theta=c,this.y=p,this}set(e,c,p){return this.radius=e,this.theta=c,this.y=p,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,c,p){return this.radius=Math.sqrt(e*e+p*p),this.theta=Math.atan2(e,p),this.y=c,this}clone(){return(new this.constructor).copy(this)}}const qm=new Un;class pd{constructor(e=new Un(1/0,1/0),c=new Un(-1/0,-1/0)){this.min=e,this.max=c}set(e,c){return this.min.copy(e),this.max.copy(c),this}setFromPoints(e){this.makeEmpty();for(let c=0,p=e.length;c<p;c++)this.expandByPoint(e[c]);return this}setFromCenterAndSize(e,c){const p=qm.copy(c).multiplyScalar(.5);return this.min.copy(e).sub(p),this.max.copy(e).add(p),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,c){return c.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,c){return c.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qm.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}pd.prototype.isBox2=!0;const xm=new at,lp=new at;class yf{constructor(e=new at,c=new at){this.start=e,this.end=c}set(e,c){return this.start.copy(e),this.end.copy(c),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,c){return this.delta(c).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,c){xm.subVectors(e,this.start),lp.subVectors(this.end,this.start);const p=lp.dot(lp);let _=lp.dot(xm)/p;return c&&(_=Gr(_,0,1)),_}closestPointToPoint(e,c,p){const _=this.closestPointToPointParameter(e,c);return this.delta(p).multiplyScalar(_).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class up extends Pr{constructor(e){super(),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}up.prototype.isImmediateRenderObject=!0;const Xm=new at;class u_ extends Pr{constructor(e,c){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=c;const p=new gr,_=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let L=0,O=1,F=32;L<F;L++,O++){const U=L/F*Math.PI*2,te=O/F*Math.PI*2;_.push(Math.cos(U),Math.sin(U),1,Math.cos(te),Math.sin(te),1)}p.setAttribute("position",new pn(_,3));const w=new wi({fog:!1,toneMapped:!1});this.cone=new Qs(p,w),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,c=e*Math.tan(this.light.angle);this.cone.scale.set(c,c,e),Xm.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Xm),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const ch=new at,uh=new Kt,Vf=new Kt;class bf extends Qs{constructor(e){const c=Ym(e),p=new gr,_=[],w=[],L=new Qn(0,0,1),O=new Qn(0,1,0);for(let F=0;F<c.length;F++){const U=c[F];U.parent&&U.parent.isBone&&(_.push(0,0,0),_.push(0,0,0),w.push(L.r,L.g,L.b),w.push(O.r,O.g,O.b))}p.setAttribute("position",new pn(_,3)),p.setAttribute("color",new pn(w,3)),super(p,new wi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=c,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const c=this.bones,p=this.geometry,_=p.getAttribute("position");Vf.copy(this.root.matrixWorld).invert();for(let w=0,L=0;w<c.length;w++){const O=c[w];O.parent&&O.parent.isBone&&(uh.multiplyMatrices(Vf,O.matrixWorld),ch.setFromMatrixPosition(uh),_.setXYZ(L,ch.x,ch.y,ch.z),uh.multiplyMatrices(Vf,O.parent.matrixWorld),ch.setFromMatrixPosition(uh),_.setXYZ(L+1,ch.x,ch.y,ch.z),L+=2)}p.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function Ym(S){const e=[];S&&S.isBone&&e.push(S);for(let c=0;c<S.children.length;c++)e.push.apply(e,Ym(S.children[c]));return e}class wm extends ko{constructor(e,c,p){super(new r(c,4,2),new sl({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=p,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Jm=new at,Pd=new Qn,rf=new Qn;class h_ extends Pr{constructor(e,c,p){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=p;const _=new Rh(c);_.rotateY(.5*Math.PI),this.material=new sl({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const w=_.getAttribute("position"),L=new Float32Array(3*w.count);_.setAttribute("color",new Fi(L,3)),this.add(new ko(_,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const c=e.geometry.getAttribute("color");Pd.copy(this.light.color),rf.copy(this.light.groundColor);for(let p=0,_=c.count;p<_;p++){const w=p<_/2?Pd:rf;c.setXYZ(p,w.r,w.g,w.b)}c.needsUpdate=!0}e.lookAt(Jm.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Sm extends Qs{constructor(e=10,c=10,p=4473924,_=8947848){p=new Qn(p),_=new Qn(_);const w=c/2,L=e/c,O=e/2,F=[],U=[];for(let ce=0,oe=0,de=-O;ce<=c;ce++,de+=L){F.push(-O,0,de,O,0,de),F.push(de,0,-O,de,0,O);const ve=ce===w?p:_;ve.toArray(U,oe),oe+=3,ve.toArray(U,oe),oe+=3,ve.toArray(U,oe),oe+=3,ve.toArray(U,oe),oe+=3}const te=new gr;te.setAttribute("position",new pn(F,3)),te.setAttribute("color",new pn(U,3)),super(te,new wi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class S_ extends Qs{constructor(e=10,c=16,p=8,_=64,w=4473924,L=8947848){w=new Qn(w),L=new Qn(L);const O=[],F=[];for(let te=0;te<=c;te++){const ce=te/c*(2*Math.PI),oe=Math.sin(ce)*e,de=Math.cos(ce)*e;O.push(0,0,0),O.push(oe,0,de);const ve=1&te?w:L;F.push(ve.r,ve.g,ve.b),F.push(ve.r,ve.g,ve.b)}for(let te=0;te<=p;te++){const ce=1&te?w:L,oe=e-e/p*te;for(let de=0;de<_;de++){let ve=de/_*(2*Math.PI),Me=Math.sin(ve)*oe,Be=Math.cos(ve)*oe;O.push(Me,0,Be),F.push(ce.r,ce.g,ce.b),ve=(de+1)/_*(2*Math.PI),Me=Math.sin(ve)*oe,Be=Math.cos(ve)*oe,O.push(Me,0,Be),F.push(ce.r,ce.g,ce.b)}}const U=new gr;U.setAttribute("position",new pn(O,3)),U.setAttribute("color",new pn(F,3)),super(U,new wi({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const Zm=new at,of=new at,Qm=new at;class p_ extends Pr{constructor(e,c,p){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=p,void 0===c&&(c=1);let _=new gr;_.setAttribute("position",new pn([-c,c,0,c,c,0,c,-c,0,-c,-c,0,-c,c,0],3));const w=new wi({fog:!1,toneMapped:!1});this.lightPlane=new to(_,w),this.add(this.lightPlane),_=new gr,_.setAttribute("position",new pn([0,0,0,0,0,1],3)),this.targetLine=new to(_,w),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){Zm.setFromMatrixPosition(this.light.matrixWorld),of.setFromMatrixPosition(this.light.target.matrixWorld),Qm.subVectors(of,Zm),this.lightPlane.lookAt(of),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(of),this.targetLine.scale.z=Qm.length()}}const Em=new at,va=new $l;class E_ extends Qs{constructor(e){const c=new gr,p=new wi({color:16777215,vertexColors:!0,toneMapped:!1}),_=[],w=[],L={},O=new Qn(16755200),F=new Qn(16711680),U=new Qn(43775),te=new Qn(16777215),ce=new Qn(3355443);function oe(ve,Me,Be){de(ve,Be),de(Me,Be)}function de(ve,Me){_.push(0,0,0),w.push(Me.r,Me.g,Me.b),void 0===L[ve]&&(L[ve]=[]),L[ve].push(_.length/3-1)}oe("n1","n2",O),oe("n2","n4",O),oe("n4","n3",O),oe("n3","n1",O),oe("f1","f2",O),oe("f2","f4",O),oe("f4","f3",O),oe("f3","f1",O),oe("n1","f1",O),oe("n2","f2",O),oe("n3","f3",O),oe("n4","f4",O),oe("p","n1",F),oe("p","n2",F),oe("p","n3",F),oe("p","n4",F),oe("u1","u2",U),oe("u2","u3",U),oe("u3","u1",U),oe("c","t",te),oe("p","c",ce),oe("cn1","cn2",ce),oe("cn3","cn4",ce),oe("cf1","cf2",ce),oe("cf3","cf4",ce),c.setAttribute("position",new pn(_,3)),c.setAttribute("color",new pn(w,3)),super(c,p),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=L,this.update()}update(){const e=this.geometry,c=this.pointMap;va.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Pa("c",c,e,va,0,0,-1),Pa("t",c,e,va,0,0,1),Pa("n1",c,e,va,-1,-1,-1),Pa("n2",c,e,va,1,-1,-1),Pa("n3",c,e,va,-1,1,-1),Pa("n4",c,e,va,1,1,-1),Pa("f1",c,e,va,-1,-1,1),Pa("f2",c,e,va,1,-1,1),Pa("f3",c,e,va,-1,1,1),Pa("f4",c,e,va,1,1,1),Pa("u1",c,e,va,.7,1.1,-1),Pa("u2",c,e,va,-.7,1.1,-1),Pa("u3",c,e,va,0,2,-1),Pa("cf1",c,e,va,-1,0,1),Pa("cf2",c,e,va,1,0,1),Pa("cf3",c,e,va,0,-1,1),Pa("cf4",c,e,va,0,1,1),Pa("cn1",c,e,va,-1,0,-1),Pa("cn2",c,e,va,1,0,-1),Pa("cn3",c,e,va,0,-1,-1),Pa("cn4",c,e,va,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Pa(S,e,c,p,_,w,L){Em.set(_,w,L).unproject(p);const O=e[S];if(void 0!==O){const F=c.getAttribute("position");for(let U=0,te=O.length;U<te;U++)F.setXYZ(O[U],Em.x,Em.y,Em.z)}}const Tm=new Gi;class d_ extends Qs{constructor(e,c=16776960){const p=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),_=new Float32Array(24),w=new gr;w.setIndex(new Fi(p,1)),w.setAttribute("position",new Fi(_,3)),super(w,new wi({color:c,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Tm.setFromObject(this.object),Tm.isEmpty())return;const c=Tm.min,p=Tm.max,_=this.geometry.attributes.position,w=_.array;w[0]=p.x,w[1]=p.y,w[2]=p.z,w[3]=c.x,w[4]=p.y,w[5]=p.z,w[6]=c.x,w[7]=c.y,w[8]=p.z,w[9]=p.x,w[10]=c.y,w[11]=p.z,w[12]=p.x,w[13]=p.y,w[14]=c.z,w[15]=c.x,w[16]=p.y,w[17]=c.z,w[18]=c.x,w[19]=c.y,w[20]=c.z,w[21]=p.x,w[22]=c.y,w[23]=c.z,_.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return Qs.prototype.copy.call(this,e),this.object=e.object,this}}class T_ extends Qs{constructor(e,c=16776960){const p=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),_=new gr;_.setIndex(new Fi(p,1)),_.setAttribute("position",new pn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(_,new wi({color:c,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const c=this.box;c.isEmpty()||(c.getCenter(this.position),c.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class M_ extends to{constructor(e,c=1,p=16776960){const _=p,w=new gr;w.setAttribute("position",new pn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),w.computeBoundingSphere(),super(w,new wi({color:_,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=c;const L=new gr;L.setAttribute("position",new pn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),L.computeBoundingSphere(),this.add(new ko(L,new sl({color:_,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let c=-this.plane.constant;Math.abs(c)<1e-8&&(c=1e-8),this.scale.set(.5*this.size,.5*this.size,c),this.children[0].material.side=c<0?W:ie,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const f_=new at;let Mm,Km;class A_ extends Pr{constructor(e=new at(0,0,1),c=new at(0,0,0),p=1,_=16776960,w=.2*p,L=.2*w){super(),this.type="ArrowHelper",void 0===Mm&&(Mm=new gr,Mm.setAttribute("position",new pn([0,0,0,0,1,0],3)),Km=new sh(0,.5,1,5,1),Km.translate(0,-.5,0)),this.position.copy(c),this.line=new to(Mm,new wi({color:_,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ko(Km,new sl({color:_,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(p,w,L)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{f_.set(e.z,0,-e.x).normalize();const c=Math.acos(e.y);this.quaternion.setFromAxisAngle(f_,c)}}setLength(e,c=.2*e,p=.2*c){this.line.scale.set(1,Math.max(1e-4,e-c),1),this.line.updateMatrix(),this.cone.scale.set(p,c,p),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class m_ extends Qs{constructor(e=1){const c=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],p=new gr;p.setAttribute("position",new pn(c,3)),p.setAttribute("color",new pn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(p,new wi({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,c,p){const _=new Qn,w=this.geometry.attributes.color.array;return _.set(e),_.toArray(w,0),_.toArray(w,3),_.set(c),_.toArray(w,6),_.toArray(w,9),_.set(p),_.toArray(w,12),_.toArray(w,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const __=new Float32Array(1),$_=new Int32Array(__.buffer);class C_{static toHalfFloat(e){__[0]=e;const c=$_[0];let p=c>>16&32768,_=c>>12&2047;const w=c>>23&255;return w<103?p:w>142?(p|=31744,p|=(255==w?0:1)&&8388607&c,p):w<113?(_|=2048,p|=(_>>114-w)+(_>>113-w&1),p):(p|=w-112<<10|_>>1,p+=1&_,p)}}const L_=0,B_=1,N_=0,R_=1,P_=2;function I_(S){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),S}function O_(S=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),S.isMultiMaterial=!0,S.materials=S,S.clone=function(){return S.slice()},S}function k_(S,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Po(S,e)}function F_(S){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Ol(S)}function g_(S,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Po(S,e)}function v_(S){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new br(S)}function e_(S){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new br(S)}function D_(S){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new br(S)}function U_(S,e,c){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new at(S,e,c)}function z_(S,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Fi(S,e).setUsage(Lr)}function j_(S,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Dd(S,e)}function G_(S,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new $p(S,e)}function H_(S,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Sa(S,e)}function V_(S,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Ju(S,e)}function W_(S,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Zu(S,e)}function q_(S,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Ea(S,e)}function X_(S,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new li(S,e)}function Y_(S,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new pn(S,e)}function J_(S,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new qc(S,e)}function t(S){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new m_(S)}function u(S,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new d_(S,e)}function m(S,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Qs(new Ru(S.geometry),new wi({color:void 0!==e?e:16777215}))}function g(S,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Qs(new k(S.geometry),new wi({color:void 0!==e?e:16777215}))}function E(S){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Kn(S)}function I(S){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Vo(S)}function V(S,e,c){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Mc(S,c)}function Z(){console.error("THREE.CanvasRenderer has been removed")}function J(){console.error("THREE.JSONLoader has been removed.")}Ks.create=function(S,e){return console.log("THREE.Curve.create() has been deprecated"),S.prototype=Object.create(Ks.prototype),S.prototype.constructor=S,S.prototype.getPoint=e,S},hs.prototype.fromPoints=function(S){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(S)},Sm.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},bf.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Rn.prototype.extractUrlBase=function(S){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ff.extractUrlBase(S)},Rn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},pd.prototype.center=function(S){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(S)},pd.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},pd.prototype.isIntersectionBox=function(S){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(S)},pd.prototype.size=function(S){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(S)},Gi.prototype.center=function(S){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(S)},Gi.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Gi.prototype.isIntersectionBox=function(S){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(S)},Gi.prototype.isIntersectionSphere=function(S){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(S)},Gi.prototype.size=function(S){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(S)},To.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Dr.prototype.setFromMatrix=function(S){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(S)},yf.prototype.center=function(S){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(S)},ot.prototype.flattenToArrayOffset=function(S,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(S,e)},ot.prototype.multiplyVector3=function(S){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),S.applyMatrix3(this)},ot.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},ot.prototype.applyToBufferAttribute=function(S){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),S.applyMatrix3(this)},ot.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},ot.prototype.getInverse=function(S){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(S).invert()},Kt.prototype.extractPosition=function(S){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(S)},Kt.prototype.flattenToArrayOffset=function(S,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(S,e)},Kt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new at).setFromMatrixColumn(this,3)},Kt.prototype.setRotationFromQuaternion=function(S){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(S)},Kt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Kt.prototype.multiplyVector3=function(S){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),S.applyMatrix4(this)},Kt.prototype.multiplyVector4=function(S){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),S.applyMatrix4(this)},Kt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Kt.prototype.rotateAxis=function(S){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),S.transformDirection(this)},Kt.prototype.crossVector=function(S){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),S.applyMatrix4(this)},Kt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Kt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Kt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Kt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Kt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Kt.prototype.applyToBufferAttribute=function(S){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),S.applyMatrix4(this)},Kt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Kt.prototype.makeFrustum=function(S,e,c,p,_,w){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(S,e,p,c,_,w)},Kt.prototype.getInverse=function(S){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(S).invert()},Ta.prototype.isIntersectionLine=function(S){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(S)},Ci.prototype.multiplyVector3=function(S){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),S.applyQuaternion(this)},Ci.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},mn.prototype.isIntersectionBox=function(S){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(S)},mn.prototype.isIntersectionPlane=function(S){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(S)},mn.prototype.isIntersectionSphere=function(S){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(S)},ro.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ro.prototype.barycoordFromPoint=function(S,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(S,e)},ro.prototype.midpoint=function(S){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(S)},ro.prototypenormal=function(S){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(S)},ro.prototype.plane=function(S){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(S)},ro.barycoordFromPoint=function(S,e,c,p,_){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ro.getBarycoord(S,e,c,p,_)},ro.normal=function(S,e,c,p){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ro.getNormal(S,e,c,p)},ps.prototype.extractAllPoints=function(S){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(S)},ps.prototype.extrude=function(S){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ul(this,S)},ps.prototype.makeGeometry=function(S){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new a(this,S)},Un.prototype.fromAttribute=function(S,e,c){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(S,e,c)},Un.prototype.distanceToManhattan=function(S){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(S)},Un.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},at.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},at.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},at.prototype.getPositionFromMatrix=function(S){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(S)},at.prototype.getScaleFromMatrix=function(S){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(S)},at.prototype.getColumnFromMatrix=function(S,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,S)},at.prototype.applyProjection=function(S){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(S)},at.prototype.fromAttribute=function(S,e,c){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(S,e,c)},at.prototype.distanceToManhattan=function(S){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(S)},at.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ji.prototype.fromAttribute=function(S,e,c){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(S,e,c)},ji.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Pr.prototype.getChildByName=function(S){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(S)},Pr.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Pr.prototype.translate=function(S,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,S)},Pr.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Pr.prototype.applyMatrix=function(S){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(S)},Object.defineProperties(Pr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(S){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=S}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ko.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(ko.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),jh},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Ps.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Fo.prototype.setLens=function(S,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(S)},Object.defineProperties(ds.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(S){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=S}},shadowCameraLeft:{set:function(S){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=S}},shadowCameraRight:{set:function(S){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=S}},shadowCameraTop:{set:function(S){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=S}},shadowCameraBottom:{set:function(S){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=S}},shadowCameraNear:{set:function(S){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=S}},shadowCameraFar:{set:function(S){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=S}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(S){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=S}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(S){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=S}},shadowMapHeight:{set:function(S){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=S}}}),Object.defineProperties(Fi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Lr},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Lr)}}}),Fi.prototype.setDynamic=function(S){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===S?Lr:yi),this},Fi.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Fi.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},gr.prototype.addIndex=function(S){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(S)},gr.prototype.addAttribute=function(S,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===S?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(S,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(S,new Fi(arguments[1],arguments[2])))},gr.prototype.addDrawCall=function(S,e,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(S,e)},gr.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},gr.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},gr.prototype.removeAttribute=function(S){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(S)},gr.prototype.applyMatrix=function(S){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(S)},Object.defineProperties(gr.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Js.prototype.setDynamic=function(S){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===S?Lr:yi),this},Js.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ul.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ul.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ul.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},rh.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},nf.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties($s.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Qn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(S){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=S===A}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(S){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=S}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Rs.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(S){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=S}}}),Ir.prototype.clearTarget=function(S,e,c,p){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(S),this.clear(e,c,p)},Ir.prototype.animate=function(S){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(S)},Ir.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Ir.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Ir.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Ir.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Ir.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Ir.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Ir.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Ir.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Ir.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Ir.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Ir.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Ir.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Ir.prototype.enableScissorTest=function(S){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(S)},Ir.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Ir.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Ir.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Ir.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Ir.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Ir.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Ir.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Ir.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Ir.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Ir.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Ir.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(S){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=S}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(S){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=S}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(S){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===S?rl:Ki}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Kd.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(lo.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(S){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=S}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(S){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=S}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(S){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=S}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(S){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=S}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(S){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=S}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(S){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=S}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(S){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=S}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(S){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=S}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(S){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=S}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(S){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=S}}}),vm.prototype.load=function(S){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new lc).load(S,function(c){e.setBuffer(c)}),this},ud.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ul.prototype.updateCubeMap=function(S,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(S,e)},ul.prototype.clear=function(S,e,c,p){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(S,e,c,p)},Ms.crossOrigin=void 0,Ms.loadTexture=function(S,e,c,p){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const _=new Uo;_.setCrossOrigin(this.crossOrigin);const w=_.load(S,c,void 0,p);return e&&(w.mapping=e),w},Ms.loadTextureCube=function(S,e,c,p){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const _=new fo;_.setCrossOrigin(this.crossOrigin);const w=_.load(S,c,void 0,p);return e&&(w.mapping=e),w},Ms.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ms.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const ee={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function _e(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:x}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=x)},980:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(){var process={release:{name:""}},__BRYTHON__=__BRYTHON__||{};try{eval("async function* f(){}")}catch(n){console.warn("Your browser is not fully supported. If you are using Microsoft Edge, please upgrade to the latest version")}(function(n){var o;n.isWebWorker=typeof WorkerGlobalScope<"u"&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,n.isNode=void 0!==process&&"node"===process.release.name;var l,x=(o=n.isNode?{location:{href:"",origin:"",pathname:""},navigator:{userLanguage:""}}:self).location.href;if(n.protocol=x.split(":")[0],n.BigInt=o.BigInt,void 0===n.brython_path){var B;if(n.isWebWorker)(B=o.location.href).startsWith("blob:")&&(B=B.substr(5));else{var D=document.getElementsByTagName("script");B=D[D.length-1].src}var G=B.split("/");G.pop(),l=n.brython_path=G.join("/")+"/"}else n.brython_path.endsWith("/")||(n.brython_path+="/"),l=n.brython_path;var M=(o.location.origin+o.location.pathname).split("/");M.pop();var P=n.script_dir=M.join("/");if(n.__ARGV=[],n.webworkers={},n.$py_module_path={},n.file_cache={},n.$py_src={},n.path=[l+"Lib",l+"libs",P,l+"Lib/site-packages"],n.async_enabled=!1,n.async_enabled&&(n.block={}),n.imported={},n.precompiled={},n.frames_stack=[],n.builtins={},n.builtins_scope={id:"__builtins__",module:"__builtins__",binding:{}},n.builtin_funcs={},n.builtin_classes=[],n.__getattr__=function(fe){return this[fe]},n.__setattr__=function(fe,ye){if(!(["debug","stdout","stderr"].indexOf(fe)>-1))throw n.builtins.AttributeError.$factory("__BRYTHON__ object has no attribute "+fe);n[fe]=ye},n.language=o.navigator.userLanguage||o.navigator.language,n.locale="C",n.charset=n.isWebWorker?"utf-8":document.characterSet||document.inputEncoding||"utf-8",n.max_int=Math.pow(2,53)-1,n.min_int=-n.max_int,n.$py_next_hash=Math.pow(2,53)-1,n.$py_UUID=0,n.lambda_magic=Math.random().toString(36).substr(2,8),n.set_func_names=function(fe,ye){if(fe.$infos){var ne=fe.$infos.__name__;fe.$infos.__module__=ye,fe.$infos.__qualname__=ne}else fe.$infos={__name__:ne=fe.__name__,__module__:ye,__qualname__:ne};for(var ue in fe.__module__=ye,fe)"function"==typeof fe[ue]&&(fe[ue].$infos={__doc__:fe[ue].__doc__||"",__module__:ye,__qualname__:ne+"."+ue,__name__:ue},"classmethod"==fe[ue].$type&&(fe[ue].__class__=n.method))},typeof Storage<"u"){n.has_local_storage=!1;try{localStorage&&(n.local_storage=localStorage,n.has_local_storage=!0)}catch{}n.has_session_storage=!1;try{sessionStorage&&(n.session_storage=sessionStorage,n.has_session_storage=!0)}catch{}}else n.has_local_storage=!1,n.has_session_storage=!1;n.globals=function(){return n.frames_stack[n.frames_stack.length-1][3]},n.scripts={},n.$options={},n.update_VFS=function(fe){n.VFS=n.VFS||{};var ye=fe.$timestamp;for(var ne in void 0!==ye&&delete fe.$timestamp,fe)n.VFS.hasOwnProperty(ne)&&console.warn("Virtual File System: duplicate entry "+ne),n.VFS[ne]=fe[ne],n.VFS[ne].timestamp=ye},n.add_files=function(fe){for(var ye in n.files=n.files||{},fe)n.files[ye]=fe[ye]},n.python_to_js=function(fe,ye){return n.meta_path=n.$meta_path.slice(),n.use_VFS||n.meta_path.shift(),void 0===ye&&(ye="__main__"),"(function() {\n var $locals_"+ye+" = {}\n"+__BRYTHON__.py2js(fe,ye,ye).to_js()+"\n}())"},o.py=function(fe){var ye=n.py2js(fe[0],"script","script").to_js();n.set_import_paths(),new Function("$locals_script",ye)({})}})(__BRYTHON__),__BRYTHON__.implementation=[3,8,10,"final",0],__BRYTHON__.__MAGIC__="3.8.10",__BRYTHON__.version_info=[3,8,0,"final",0],__BRYTHON__.compiled_date="2020-10-06 14:56:18.181563",__BRYTHON__.timestamp=1601988978181,__BRYTHON__.builtin_module_names=["_aio","_ajax","_base64","_binascii","_io_classes","_json","_jsre","_locale","_multiprocessing","_posixsubprocess","_profile","_sre_utils","_string","_strptime","_svg","_warnings","_webcomponent","_webworker","_zlib_utils","array","builtins","dis","hashlib","long_int","marshal","math","math1","modulefinder","posix","random","unicodedata"],function($B){var js,$pos,res,$op;Number.isInteger=Number.isInteger||function(n){return"number"==typeof n&&isFinite(n)&&Math.floor(n)===n},Number.isSafeInteger=Number.isSafeInteger||function(n){return Number.isInteger(n)&&Math.abs(n)<=Number.MAX_SAFE_INTEGER};var _b_=$B.builtins,_window;_window=$B.isNode?{location:{href:"",origin:"",pathname:""}}:self,$B.parser={};var clone=$B.clone=function(n){var o={};for(var l in n)o[l]=n[l];return o};$B.last=function(n){return void 0===n&&console.log($B.frames_stack.slice()),n[n.length-1]},$B.list2obj=function(n,o){var l={},x=n.length;for(void 0===o&&(o=!0);x-- >0;)l[n[x]]=o;return l},$B.op2method={operations:{"**":"pow","//":"floordiv","<<":"lshift",">>":"rshift","+":"add","-":"sub","*":"mul","/":"truediv","%":"mod","@":"matmul"},augmented_assigns:{"//=":"ifloordiv",">>=":"irshift","<<=":"ilshift","**=":"ipow","+=":"iadd","-=":"isub","*=":"imul","/=":"itruediv","%=":"imod","&=":"iand","|=":"ior","^=":"ixor","@=":"imatmul"},binary:{"&":"and","|":"or","~":"invert","^":"xor"},comparisons:{"<":"lt",">":"gt","<=":"le",">=":"ge","==":"eq","!=":"ne"},boolean:{or:"or",and:"and",in:"in",not:"not",is:"is",not_in:"not_in",is_not:"is_not"},subset:function(){var n={},o=[];if("all"==arguments[0])(o=Object.keys($B.op2method)).splice(o.indexOf("subset"),1);else for(var l=0,x=arguments.length;l<x;l++)o.push(arguments[l]);for(l=0,x=o.length;l<x;l++){var B=o[l],D=$B.op2method[B];if(void 0===D)throw Error(B);for(var G in D)n[G]=D[G]}return n}};var $operators=$B.op2method.subset("all"),$augmented_assigns=$B.augmented_assigns=$B.op2method.augmented_assigns,noassign=$B.list2obj(["True","False","None","__debug__"]),$op_order=[["or"],["and"],["not"],["in","not_in"],["<","<=",">",">=","!=","==","is","is_not"],["|"],["^"],["&"],[">>","<<"],["+"],["-"],["*","@","/","//","%"],["unary_neg","unary_inv","unary_pos"],["**"]],$op_weight={},$weight=1;$op_order.forEach(function(n){n.forEach(function(o){$op_weight[o]=$weight}),$weight++});var $loop_num=0,create_temp_name=$B.parser.create_temp_name=function(n){return(n||"$temp")+$loop_num++},replace_node=$B.parser.replace_node=function(n,o){var l=n.parent,x=get_rank_in_parent(n);l.children[x]=o,o.parent=l,o.bindings=n.bindings},get_rank_in_parent=$B.parser.get_rank_in_parent=function(n){return n.parent.children.indexOf(n)},add_identnode=$B.parser.add_identnode=function(n,o,l,x){var B=new $Node;B.parent=n,B.locals=n.locals,B.module=n.module;var D=new $NodeCtx(B),G=new $ExprCtx(D,"id",!0),M=(new $IdCtx(G,l),new $AssignCtx(G));return-1===o?n.add(B):n.insert(o,B),M.tree[1]=x,B},chained_comp_num=0,$_SyntaxError=$B.parser.$_SyntaxError=function(n,o,l){for(var x=n;"node"!==x.type;)x=x.parent;for(var B=x.node,D=B;void 0!==D.parent;)D=D.parent;var G=B.module,M=D.src,P=B.line_num;if(M&&(P=M.substr(0,$pos).split("\n").length),D.line_info&&(P=D.line_info),void 0!==l&&"number"==typeof l)throw $B.$IndentationError(G,o,M,$pos,P,D);Array.isArray(o)&&$B.$SyntaxError(G,o[0],M,$pos,P,D),"Triple string end not found"===o&&$B.$SyntaxError(G,"invalid syntax : triple string end not found",M,$pos,P,D);var fe="invalid syntax";o.startsWith("token ")||(fe+=" ("+o+")"),$B.$SyntaxError(G,fe,M,$pos,P,D)};function SyntaxWarning(n,o){var l=$get_node(n),x=$get_module(n),B=x.src.split("\n"),D=`Module ${x.module}line ${l.line_num}:${o}\n    `+B[l.line_num-1];$B.$getattr($B.stderr,"write")(D)}function check_assignment(n){for(var o=n,l=["assert","del","import","raise","return"];o;)l.indexOf(o.type)>-1?$_SyntaxError(n,"invalid syntax - assign"):"expr"==o.type&&"op"==o.tree[0].type&&$_SyntaxError(n,void 0!==$B.op2method.comparisons[o.tree[0].op]?["cannot assign to comparison"]:["cannot assign to operator"]),o=o.parent}var $Node=$B.parser.$Node=function(n){this.type=n,this.children=[]};$Node.prototype.add=function(n){this.children[this.children.length]=n,n.parent=this,n.module=this.module},$Node.prototype.insert=function(n,o){this.children.splice(n,0,o),o.parent=this,o.module=this.module},$Node.prototype.toString=function(){return"<object 'Node'>"},$Node.prototype.show=function(n){var o="";return"module"===this.type?(this.children.forEach(function(l){o+=l.show(n)}),o):(o+=" ".repeat(n=n||0),o+=this.C,this.children.length>0&&(o+="{"),o+="\n",this.children.forEach(function(l){o+="["+i+"] "+l.show(n+4)}),this.children.length>0&&(o+=" ".repeat(n),o+="}\n"),o)},$Node.prototype.to_js=function(n){if(void 0!==this.js)return this.js;if(this.res=[],this.unbound=[],"module"===this.type)return this.children.forEach(function(l){this.res.push(l.to_js())},this),this.js=this.res.join(""),this.js;n=n||0;var o=this.C.to_js();return o&&(this.res.push(" ".repeat(n)),this.res.push(o),this.children.length>0&&this.res.push("{"),this.res.push("\n"),this.children.forEach(function(l){this.res.push(l.to_js(n+4))},this),this.children.length>0&&(this.res.push(" ".repeat(n)),this.res.push("}\n"))),this.js=this.res.join(""),this.js},$Node.prototype.transform=function(n){if(this.has_await)return this.parent.insert(n,$NodeJS("var save_stack = $B.save_stack()")),this.parent.insert(n+2,$NodeJS("$B.restore_stack(save_stack, $locals)")),this.has_await=!1,1;if(this.has_yield&&!this.has_yield.transformed){var o=this.parent;if(this.has_yield.from){var l=new $Node,x=new $NodeCtx(l),B=new $ExprCtx(x,"js",!1),D=new $RawJSCtx(B,`var _i${this.has_yield.from_num}`),G=new $AssignCtx(B);new $ExprCtx(G).tree=this.has_yield.tree,o.insert(n,l),$get_node(this.has_yield);var M=this.has_yield.from_num;return o.insert(n+1,$NodeJS(`$B.$import("sys",[],{})\n_i${M}=_b_.iter(_i${M})\nvar $failed${M}=false\ntry{var _y${M}=_b_.next(_i${M})}catch(_e){$B.set_exc(_e)\n$failed${M}=true\n$B.pmframe=$B.last($B.frames_stack)\n_e=$B.exception(_e)\nif(_e.__class__===_b_.StopIteration){var _r${M}=$B.$getattr(_e,"value")}else{throw _e}}\nif(! $failed${M}){while(true){var $failed1${M}=false\ntry{$B.leave_frame({$locals})\nvar _s${M}=yield _y${M}\n$B.frames_stack.push($top_frame)}catch(_e){if(_e.__class__===_b_.GeneratorExit){var $failed2${M}=false\ntry{var _m${M}=$B.$geatttr(_i${M},"close")}catch(_e1){$failed2${M}=true\nif(_e1.__class__ !==_b_.AttributeError){throw _e1}}\nif(! $failed2${M}){$B.$call(_m${M})()}\nthrow _e}else if($B.is_exc(_e,[_b_.BaseException])){var _x=$B.$call($B.$getattr($locals.sys,"exc_info"))()\nvar $failed3${M}=false\ntry{var _m${M}=$B.$getattr(_i${M},"throw")}catch(err){$failed3${M}=true\nif($B.is_exc(err,[_b_.AttributeError])){throw err}}\nif(! $failed3${M}){try{_y${M}=$B.$call(_m${M}).apply(null,_b_.list.$factory(_x${M}))}catch(err){if($B.$is_exc(err,[_b_.StopIteration])){_r${M}=$B.$getattr(err,"value")\nbreak}\nthrow err}}}}\nif(! $failed1${M}){try{if(_s${M}===_b_.None){_y${M}=_b_.next(_i${M})}else{_y${M}=$B.$call($B.$getattr(_i${M},"send"))(_s${M})}}catch(err){if($B.is_exc(err,[_b_.StopIteration])){_r${M}=$B.$getattr(err,"value")\nbreak}\nthrow err}}}}`)),3}o.children.splice(n,1),"abstract_expr"===this.has_yield.tree[0].type?l=$NodeJS("var result = _b_.None"):(l=new $Node,x=new $NodeCtx(l),B=new $ExprCtx(x,"js",!1),D=new $RawJSCtx(B,"var result"),(G=new $AssignCtx(B)).tree[1]=this.has_yield.tree[0],D.parent=G),l.line_num=this.line_num,o.insert(n,l);var fe=new $NodeJS("try");fe.add($NodeJS("$B.leave_frame({$locals})")),fe.add(this),o.insert(n+1,fe),this.has_yield.to_js=function(){return"yield result"},this.has_yield.transformed=!0;for(var ye=0;ye<fe.children.length;)void 0===(ie=fe.children[ye].transform(ye))&&(ie=1),ye+=ie;var ne=$NodeJS(`catch(err${this.line_num})`);return ne.add($NodeJS("$B.frames_stack.push($top_frame)")),ne.add($NodeJS(`throw err${this.line_num}`)),o.insert(n+2,ne),o.insert(n+3,$NodeJS("$B.frames_stack.push($top_frame)")),2}if("module"!==this.type){var ue,me=this.C.tree[0];for(void 0===me&&console.log(this),void 0!==me.transform&&(ue=me.transform(this,n)),ye=0;ye<this.children.length;)void 0===(ie=this.children[ye].transform(ye))&&(ie=1),ye+=ie;return void 0===ue&&(ue=1),ue}for(this.__doc__=$get_docstring(this),ye=0;ye<this.children.length;){var ie;void 0===(ie=this.children[ye].transform(ye))&&(ie=1),ye+=ie}},$Node.prototype.clone=function(){var n=new $Node(this.type);for(var o in this)n[o]=this[o];return n},$Node.prototype.clone_tree=function(){var n=new $Node(this.type);for(var o in this)n[o]=this[o];n.children=[];for(var l=0,x=this.children.length;l<x;l++)n.add(this.children[l].clone_tree());return n};var $AbstractExprCtx=$B.parser.$AbstractExprCtx=function(n,o){this.type="abstract_expr",this.with_commas=o,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$AbstractExprCtx.prototype.toString=function(){return"(abstract_expr "+this.with_commas+") "+this.tree},$AbstractExprCtx.prototype.transition=function(n,o){var l=this,x=l.packed,B=l.is_await,D=l.assign;if(!D)switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":case"yield":l.parent.tree.pop();var G=l.with_commas;(l=l.parent).packed=x,l.is_await=B,D&&(console.log("set assign to parent",l),l.assign=D)}switch(n){case"await":return new $AwaitCtx(l);case"id":return new $IdCtx(new $ExprCtx(l,"id",G),o);case"str":return new $StringCtx(new $ExprCtx(l,"str",G),o);case"bytes":return new $StringCtx(new $ExprCtx(l,"bytes",G),o);case"int":return new $NumberCtx("int",new $ExprCtx(l,"int",G),o);case"float":return new $NumberCtx("float",new $ExprCtx(l,"float",G),o);case"imaginary":return new $NumberCtx("imaginary",new $ExprCtx(l,"imaginary",G),o);case"(":return new $ListOrTupleCtx(new $ExprCtx(l,"tuple",G),"tuple");case"[":return new $ListOrTupleCtx(new $ExprCtx(l,"list",G),"list");case"{":return new $DictOrSetCtx(new $ExprCtx(l,"dict_or_set",G));case".":return new $EllipsisCtx(new $ExprCtx(l,"ellipsis",G));case"not":return"op"==l.type&&"is"==l.op?(l.op="is_not",l):new $NotCtx(new $ExprCtx(l,"not",G));case"lambda":return new $LambdaCtx(new $ExprCtx(l,"lambda",G));case"op":var M=o;switch(M){case"*":return l.parent.tree.pop(),G=l.with_commas,new $PackedCtx(new $ExprCtx(l=l.parent,"expr",G));case"-":case"~":case"+":l.parent.tree.pop();var P=new $UnaryCtx(l.parent,M);if("-"==M)var fe=new $OpCtx(P,"unary_neg");else fe=new $OpCtx(P,"+"==M?"unary_pos":"unary_inv");return new $AbstractExprCtx(fe,!1);case"not":return l.parent.tree.pop(),G=l.with_commas,new $NotCtx(new $ExprCtx(l=l.parent,"not",G))}$_SyntaxError(l,"token "+n+" after "+l);case"=":$_SyntaxError(l,"token "+n+" after "+l);case"yield":return new $AbstractExprCtx(new $YieldCtx(l),!0);case":":return"sub"==l.parent.type||"list_or_tuple"==l.parent.type&&"sub"==l.parent.parent.type?new $AbstractExprCtx(new $SliceCtx(l.parent),!1):$transition(l.parent,n,o);case")":case",":switch(l.parent.type){case"list_or_tuple":case"slice":case"call_arg":case"op":case"yield":break;case"annotation":$_SyntaxError(l,"empty annotation");default:$_SyntaxError(l,n)}}return $transition(l.parent,n,o)},$AbstractExprCtx.prototype.to_js=function(){return this.js_processed=!0,"list"===this.type?"["+$to_js(this.tree)+"]":$to_js(this.tree)};var $AliasCtx=$B.parser.$AliasCtx=function(n){this.type="ctx_manager_alias",this.parent=n,this.tree=[],n.tree[n.tree.length-1].alias=this};$AliasCtx.prototype.transition=function(n,o){var l=this;switch(n){case",":case":":return l.parent.set_alias(l.tree[0].tree[0]),$transition(l.parent,n,o)}$_SyntaxError(l,"token "+n+" after "+l)};var $AnnotationCtx=$B.parser.$AnnotationCtx=function(n){this.type="annotation",this.parent=n,this.tree=[],n.annotation=this;var o=$get_scope(n);if(void 0===o.binding.__annotations__&&(o.binding.__annotations__=!0,n.create_annotations=!0),"def"==o.ntype&&n.tree&&n.tree.length>0&&"id"==n.tree[0].type){var l=n.tree[0].value;o.globals&&o.globals.has(l)>-1&&$_SyntaxError(n,["annotated name '"+l+"' can't be global"]),o.annotations=o.annotations||new Set,o.annotations.add(l),n.$in_parens||(o.binding=o.binding||{},o.binding[l]=!0)}};$AnnotationCtx.prototype.toString=function(){return"(annotation) "+this.tree},$AnnotationCtx.prototype.transition=function(n,o){var l=this;return"eol"==n&&1==l.tree.length&&0==l.tree[0].tree.length?$_SyntaxError(l,"empty annotation"):":"==n&&"def"!=l.parent.type?$_SyntaxError(l,"more than one annotation"):"augm_assign"==n?$_SyntaxError(l,"augmented assign as annotation"):"op"==n&&$_SyntaxError(l,"operator as annotation"),$transition(l.parent,n)},$AnnotationCtx.prototype.to_js=function(){return $to_js(this.tree)};var $AssertCtx=$B.parser.$AssertCtx=function(n){this.type="assert",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$AssertCtx.prototype.toString=function(){return"(assert) "+this.tree},$AssertCtx.prototype.transition=function(n,o){var l=this;return","==n?(this.tree.length>1&&$_SyntaxError(l,"too many commas after assert"),new $AbstractExprCtx(this,!1)):"eol"==n?$transition(l.parent,n):void $_SyntaxError(l,n)},$AssertCtx.prototype.transform=function(n,o){if(this.tree.length>1)var l=this.tree[0],x=this.tree[1];else l=this.tree[0],x=null;"expr"==this.tree[0].type&&"tuple"==this.tree[0].name&&this.tree[0].tree[0].tree.length>1&&SyntaxWarning(this,"assertion is always true, perhaps remove parentheses?");var B=new $ConditionCtx(n.C,"if");new $NotCtx(B).tree=[l],n.C=B;var D=new $Node,G="throw _b_.AssertionError.$factory()";null!==x&&(G="throw _b_.AssertionError.$factory(_b_.str.$factory("+x.to_js()+"))"),new $NodeJSCtx(D,G),n.add(D)};var $AssignCtx=$B.parser.$AssignCtx=function(n,o){check_assignment(n),"expr"==n.type&&"lambda"==n.tree[0].type&&$_SyntaxError(n,["cannot assign to lambda"]),this.type="assign","expression"==o&&(this.expression=!0,console.log("parent of assign expr",n.parent)),n.parent.tree.pop(),n.parent.tree[n.parent.tree.length]=this,this.parent=n.parent,this.tree=[n];var l=$get_scope(this);if("expr"==n.type&&"call"==n.tree[0].type)$_SyntaxError(n,["cannot assign to function call "]);else if("list_or_tuple"==n.type||"expr"==n.type&&"list_or_tuple"==n.tree[0].type)"expr"==n.type&&(n=n.tree[0]),n.bind_ids(l);else if("assign"==n.type)n.tree.forEach(function(D){var G=D.tree[0];"id"==G.type&&$bind(G.value,l,this)},this);else{var x=n.tree[0];if(x&&"id"==x.type)if(!0===noassign[x.value]&&$_SyntaxError(n,["cannot assign to keyword"]),x.bound=!0,l.globals&&l.globals.has(x.value)){var B=$get_module(n);x.global_module=B.module,$bind(x.value,B,this)}else $get_node(this).bound_before=Object.keys(l.binding),$bind(x.value,l,this);else["str","int","float","complex"].indexOf(x.type)>-1?$_SyntaxError(n,["cannot assign to literal"]):"unary"==x.type&&$_SyntaxError(n,["cannot assign to operator"])}};$AssignCtx.prototype.guess_type=function(){},$AssignCtx.prototype.toString=function(){return"(assign) "+this.tree[0]+"="+this.tree[1]},$AssignCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return"abstract_expr"==l.tree[1].type&&$_SyntaxError(l,"token "+n+" after "+l),l.guess_type(),$transition(l.parent,"eol");$_SyntaxError(l,"token "+n+" after "+l)},$AssignCtx.prototype.transform=function(n,o){for(var l=$get_scope(this),x=this.tree[0],B=this.tree[1],D=[];"assign"==x.type;)D.push(x.tree[1]),x=x.tree[0];if(D.length>0){D.push(x);var G=n.C;G.tree=[];var M=new $RawJSCtx(G,"var $temp"+$loop_num);return M.tree=G.tree,new $AssignCtx(M).tree[1]=B,D.forEach(function(Le){"expr"==Le.type&&"list_or_tuple"==Le.tree[0].type&&"tuple"==Le.tree[0].real&&1==Le.tree[0].tree.length&&(Le=Le.tree[0].tree[0]);var K=new $Node,be=new $NodeCtx(K);K.locals=n.locals,K.line_num=n.line_num,n.parent.insert(o+1,K),Le.parent=be;var Ne=new $AssignCtx(Le);new $RawJSCtx(Ne,"$temp"+$loop_num)}),$loop_num++,void(this.tree[0]=x)}var P=null;switch(x.type){case"expr":x.tree.length>1?P=x.tree:"list_or_tuple"==x.tree[0].type||"target_list"==x.tree[0].type?P=x.tree[0].tree:"id"==x.tree[0].type&&(l.globals&&l.globals.has(x.tree[0].value)||(x.tree[0].bound=!0));break;case"target_list":case"list_or_tuple":P=x.tree}if(B=this.tree[1],null!==P){var ye=null;if(("list"==B.type||"tuple"==B.type||"expr"==B.type&&B.tree.length>1)&&(ye=B.tree),null!==ye){if(ye.length>P.length)throw Error("ValueError : too many values to unpack (expected "+P.length+")");if(ye.length<P.length)throw Error("ValueError : need more than "+ye.length+" to unpack");var ne=[],ue=0;(Q=new $Node).line_num=n.line_num,new $NodeJSCtx(Q,"void(0)"),ne[ue++]=Q;var me="$temp"+$loop_num;(Q=new $Node).line_num=n.line_num,new $NodeJSCtx(Q,"var "+me+" = [], $pos = 0"),ne[ue++]=Q,ye.forEach(function(Le){var K=me+"[$pos++] = "+Le.to_js(),be=new $Node;be.line_num=n.line_num,new $NodeJSCtx(be,K),ne[ue++]=be});var ie=$get_node(this);P.forEach(function(Le){var K=new $Node;K.id=ie.module,K.locals=ie.locals,K.line_num=n.line_num;var be=new $NodeCtx(K);Le.parent=be,new $AssignCtx(Le,!1).tree[1]=new $JSCode(me+"["+W+"]"),ne[ue++]=K},this),n.parent.children.splice(o,1);for(var W=ne.length-1;W>=0;W--)n.parent.insert(o,ne[W]);$loop_num++}else{n.parent.children.splice(o,1);var Q,A=create_temp_name("$right"),R=create_temp_name("$rlist");(Q=$NodeJS("var "+A+" = $B.$getattr($B.$iter("+B.to_js()+'), "__next__");')).line_num=n.line_num,n.parent.insert(o++,Q),n.parent.insert(o++,$NodeJS("var "+R+"=[], $pos=0;while(1){try{"+R+"[$pos++] = "+A+"()}catch(err){break}}"));var X=null,he=P.length;for(W=0;W<P.length;W++){var z=P[W];if("packed"==z.type||"expr"==z.type&&"packed"==z.tree[0].type){X=W,he--;break}}n.parent.insert(o++,$NodeJS("if("+R+".length<"+he+'){throw _b_.ValueError.$factory("need more than " +'+R+'.length + " value" + ('+R+'.length > 1 ? "s" : "") + " to unpack")}')),null==X&&n.parent.insert(o++,$NodeJS("if("+R+".length>"+he+'){throw _b_.ValueError.$factory("too many values to unpack (expected '+P.length+')")}')),P.forEach(function(Le,K){var be=new $Node;be.id=l.id,be.line_num=n.line_num,n.parent.insert(o++,be);var Ne=new $NodeCtx(be);Le.parent=Ne;var je=new $AssignCtx(Le,!1),Te=R;je.tree[1]=new $JSCode(Te+=null==X||K<X?"["+K+"]":K==X?".slice("+K+","+R+".length-"+(P.length-K-1)+")":"["+R+".length-"+(P.length-K)+"]")}),$loop_num++}}else x.tree[0].bound&&"expr"==B.type&&"int"==B.name&&(n.bindings=n.bindings||{},n.bindings[x.tree[0].value]="int")},$AssignCtx.prototype.to_js=function(){if(this.js_processed=!0,"call"==this.parent.type)return'{$nat:"kw",name:'+this.tree[0].to_js()+",value:"+this.tree[1].to_js()+"}";for(var n=this.tree[0];"expr"==n.type&&!n.assign;)n=n.tree[0];var o=this.tree[1];if("attribute"==n.type||"sub"==n.type){var l=o.to_js(),x="",B="",D="$temp"+$loop_num;if("expr"!=o.type||void 0===o.tree[0]||"call"!=o.tree[0].type||"eval"!=o.tree[0].func.value&&"exec"!=o.tree[0].func.value?"expr"==o.type&&void 0!==o.tree[0]&&"sub"==o.tree[0].type?(x+="var "+D+" = "+l+";\n",B=D):B=l:(x+="var "+D+" = "+l+";\n",B=D),"attribute"==n.type){$loop_num++,n.func="setattr";var G=n.to_js();return n.func="getattr",n.assign_self?x+G[0]+B+G[1]+B+")":(x=(x+=G).substr(0,x.length-1))+","+B+");_b_.None;"}if("sub"==n.type){var M,P=n.value.to_js(),fe="$temp"+$loop_num;return"id"==n.value.type&&(M=$get_node(this).locals[n.value.value]),$loop_num++,x="var "+fe+" = "+P+"\n","list"!==M&&(x+="if(Array.isArray("+fe+") && !"+fe+".__class__){"),1==n.tree.length?x+="$B.set_list_key("+fe+","+(n.tree[0].to_js()+""||"null")+","+o.to_js()+")":2==n.tree.length?x+="$B.set_list_slice("+fe+","+(n.tree[0].to_js()+""||"null")+","+(n.tree[1].to_js()+""||"null")+","+o.to_js()+")":3==n.tree.length&&(x+="$B.set_list_slice_step("+fe+","+(n.tree[0].to_js()+""||"null")+","+(n.tree[1].to_js()+""||"null")+","+(n.tree[2].to_js()+""||"null")+","+o.to_js()+")"),"list"==M||(x+="\n}else{",1==n.tree.length?x+="$B.$setitem("+n.value.to_js()+","+n.tree[0].to_js()+","+l+")};_b_.None;":(n.func="setitem",x=(x+=n.to_js()).substr(0,x.length-1),n.func="getitem",x+=","+l+")};_b_.None;")),x}}return n.to_js()+" = "+o.to_js()};var $AsyncCtx=$B.parser.$AsyncCtx=function(n){this.type="async",this.parent=n,n.async=!0};$AsyncCtx.prototype.toString=function(){return"(async)"},$AsyncCtx.prototype.transition=function(n,o){var l=this;if("def"==n)return $transition(l.parent,n,o);if("for"==n||"with"==n){var x=$get_scope(l).ntype;"def"!==x&&"generator"!=x&&$_SyntaxError(l,["'async "+n+"' outside async function"]);var B=$transition(l.parent,n,o);return B.parent.async=!0,B}$_SyntaxError(l,"token "+n+" after "+l)};var $AttrCtx=$B.parser.$AttrCtx=function(n){this.type="attribute",this.value=n.tree[0],this.parent=n,n.tree.pop(),n.tree[n.tree.length]=this,this.tree=[],this.func="getattr"};$AttrCtx.prototype.toString=function(){return"(attr) "+this.value+"."+this.name},$AttrCtx.prototype.transition=function(n,o){var l=this;if("id"===n){var x=o;return!0===noassign[x]&&$_SyntaxError(l,["cannot assign to "+x]),x=$mangle(x,l),l.name=x,l.parent}$_SyntaxError(l,n)},$AttrCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.value.to_js();if("setattr"==this.func&&"id"==this.value.type){var o=$get_scope(this),l=o.parent;if("def"==o.ntype&&"class"==l.ntype&&this.value.value==o.C.tree[0].positional_list[0]&&l.C&&void 0===l.C.tree[0].args)return this.assign_self=!0,[n+".__class__ && "+n+".__dict__ && !"+n+".__class__.$has_setattr && ! "+n+".$is_class ? _b_.dict.$setitem("+n+".__dict__, '"+this.name+"', ",") : $B.$setattr("+n+', "'+this.name+'", ']}return"setattr"==this.func?"$B.$setattr("+n+',"'+this.name+'")':"$B.$getattr("+n+',"'+this.name+'")'};var $AugmentedAssignCtx=$B.parser.$AugmentedAssignCtx=function(n,o){check_assignment(n),this.type="augm_assign",this.C=n,this.parent=n.parent,n.parent.tree.pop(),n.parent.tree[n.parent.tree.length]=this,this.op=o,this.tree=[n];var l=this.scope=$get_scope(this);if("expr"==n.type){var x=n.tree[0];if("id"==x.type){var B=x.value;!0===noassign[B]?$_SyntaxError(n,["cannot assign to keyword"]):"def"!=l.ntype&&"generator"!=l.ntype||void 0!==l.binding[B]||void 0!==l.globals&&l.globals.has(B)||(x.unbound=!0)}else["str","int","float","complex"].indexOf(x.type)>-1&&$_SyntaxError(n,["cannot assign to literal"])}$get_node(this).bound_before=Object.keys(l.binding),this.module=l.module};$AugmentedAssignCtx.prototype.toString=function(){return"(augm assign) "+this.tree},$AugmentedAssignCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return"abstract_expr"==l.tree[1].type&&$_SyntaxError(l,"token "+n+" after "+l),$transition(l.parent,"eol");$_SyntaxError(l,"token "+n+" after "+l)},$AugmentedAssignCtx.prototype.transform=function(n,o){var l=this.C,x=this.op,B="__"+$operators[x]+"__",D=0,G=n.parent,M=n.line_num,P=!1;G.children.splice(o,1);var fe="expr"==this.tree[0].type&&"id"==this.tree[0].tree[0].type;if(fe){var ye="int"==this.tree[0].tree[0].bindingType(this.scope);if(this.tree[0].tree[0].augm_assign=!0,$B.debug>0){var ne=$NodeJS("if("+this.tree[0].to_js()+" === undefined){throw _b_.NameError.$factory(\"name '"+this.tree[0].tree[0].value+"' is not defined\")}");n.parent.insert(o,ne),D++}var ue=this.tree[0].tree[0].value,me=void 0!==this.scope.binding[ue],ie=this.tree[0].tree[0].unbound}var W="expr"==this.tree[1].type&&"int"==this.tree[1].tree[0].type;if(W){var Q=this.tree[1].tree[0].value,A=parseInt(Q[1],Q[0]);W=A>$B.min_int&&A<$B.max_int}var R=W?this.tree[1].tree[0].to_js():"$temp";if(!W){(Te=new $Node).line_num=M,P=!0,new $NodeJSCtx(Te,"var $temp,$left;"),G.insert(o,Te),D++,(Te=new $Node).id=this.scope.id;var X=new $NodeCtx(Te),he=new $ExprCtx(X,"js",!1),z=new $RawJSCtx(he,"$temp"),Le=new $AssignCtx(he);Le.tree[1]=this.tree[1],z.parent=Le,G.insert(o+D,Te),D++}var K="",be=!1;switch(x){case"+=":case"-=":case"*=":case"/=":if(fe){var Ne=this.scope,je="$local_"+Ne.module.replace(/\./g,"_");switch(Ne.ntype){case"module":K=je;break;case"def":case"generator":K=Ne.globals&&Ne.globals.has(l.tree[0].value)?je:"$locals";break;case"class":var Te=new $Node;P||(Te.line_num=M,P=!0),new $NodeJSCtx(Te,"var $left = "+l.to_js()),G.insert(o+D,Te),be=!0,D++}}}var qe=l.tree[0].to_js();if("id"==l.tree[0].type){var Ke=l.tree[0].firstBindingScopeId(),vt=l.tree[0].value;qe=Ke?"$locals_"+Ke.replace(/\./g,"_")+'["'+vt+'"]':'$locals["'+vt+'"]'}if(ye&&W&&"//="!=x)return G.insert(o+D,$NodeJS(qe+" "+x+" "+R)),D++;K=K&&!l.tree[0].unknown_binding&&!ie;var ht=x.charAt(0);if(K){var Bt=be?"$left":qe;Te=new $Node,P||(Te.line_num=M,P=!0),Ft=W?"if(":'if(typeof $temp.valueOf() == "number" && ',Ft+=Bt+".constructor === Number",Ft+=" && Number.isSafeInteger("+qe+ht+R+")){"+(W?"(":'(typeof $temp == "number" && ')+"typeof "+Bt+' == "number") ? ',Ft+=qe+x+R,new $NodeJSCtx(Te,Ft+=" : "+qe+" = new Number("+qe+ht+(W?R:R+".valueOf()")+")}"),G.insert(o+D,Te),D++}if("sub"==l.tree[0].type&&("+="==x||"-="==x||"*="==x)&&1==l.tree[0].tree.length){var wt="$B.augm_item_"+{"+=":"add","-=":"sub","*=":"mul"}[x]+"("+l.tree[0].value.to_js()+","+l.tree[0].tree[0].to_js()+","+R+");_b_.None;";return Te=new $Node,P||(Te.line_num=M,P=!0),new $NodeJSCtx(Te,wt),G.insert(o+D,Te),void D++}Te=new $Node,P||(Te.line_num=M,P=!0);var Ft="";K&&(Ft+="else "),Ft+="if(! _b_.hasattr("+l.to_js()+',"'+B+'"))',new $NodeJSCtx(Te,Ft),G.insert(o+D,Te),D++;var Ot=new $Node;Ot.id=this.scope.id,Ot.line_num=n.line_num,Te.add(Ot);var on=new $NodeCtx(Ot),ft=new $ExprCtx(on,"clone",!1);ie?new $RawJSCtx(ft,qe):(ft.tree=l.tree,ft.tree.forEach(function(nr){nr.parent=ft}));var An=new $AssignCtx(ft),Cn=new $OpCtx(ft,x.substr(0,x.length-1));Cn.parent=An,new $RawJSCtx(Cn,R),An.tree.push(Cn),ft.parent.tree.pop(),ft.parent.tree.push(An);var fn=$NodeJS("else");G.insert(o+D,fn);var On=new $Node;On.line_num=n.line_num,fn.add(On);var $n=new $NodeCtx(On),_n=new $ExprCtx($n,"clone",!1);ie?(Ft=qe,Ke||(Ft='$B.$local_search("'+vt+'");'+qe),new $RawJSCtx(_n,Ft)):(_n.tree=l.tree,_n.tree.forEach(function(nr){nr.parent=_n}));var ar=new $AssignCtx(_n);return ar.tree.push($NodeJS("$B.$getattr("+l.to_js()+',"'+B+'")('+R+")")),_n.parent.tree.pop(),_n.parent.tree.push(ar),!fe||me||this.scope.blurred||(this.scope.binding[ue]=void 0),D},$AugmentedAssignCtx.prototype.to_js=function(){return""};var $AwaitCtx=$B.parser.$AwaitCtx=function(n){this.type="await",this.parent=n,this.tree=[],n.tree.push(this);for(var o=n;o;)"list_or_tuple"==o.type&&(o.is_await=!0),o=o.parent};$AwaitCtx.prototype.transition=function(n,o){return this.parent.is_await=!0,$transition(this.parent,n,o)},$AwaitCtx.prototype.to_js=function(){return"var save_stack = $B.save_stack();await ($B.promise("+$to_js(this.tree)+"));$B.restore_stack(save_stack, $locals); "};var $BodyCtx=$B.parser.$BodyCtx=function(n){for(var o=n.parent;"node"!==o.type;)o=o.parent;var l=o.node,x=new $Node;return x.is_body_node=!0,x.line_num=l.line_num,l.insert(0,x),new $NodeCtx(x)},set_loop_context=$B.parser.set_loop_context=function(n,o){for(var l=n;"node"!==l.type;)l=l.parent;for(var x=l.node.parent,B=!1;;)if("module"==x.type)$_SyntaxError(n,o+" outside of a loop");else{var D=x.C.tree[0];if("condition"==D.type&&"while"==D.token){this.loop_ctx=D,D["has_"+o]=!0;break}switch(D.type){case"for":this.loop_ctx=D,D["has_"+o]=!0,B=!0;break;case"def":case"generator":case"class":$_SyntaxError(n,o+" outside of a loop");default:x=x.parent}if(B)break}},$BreakCtx=$B.parser.$BreakCtx=function(n){this.type="break",this.parent=n,n.tree[n.tree.length]=this,set_loop_context.apply(this,[n,"break"])};$BreakCtx.prototype.toString=function(){return"break "},$BreakCtx.prototype.transition=function(n,o){if("eol"==n)return $transition(this.parent,"eol");$_SyntaxError(this,n)},$BreakCtx.prototype.to_js=function(){return this.js_processed=!0,";$locals_"+$get_scope(this).id.replace(/\./g,"_")+'["$no_break'+this.loop_ctx.loop_num+'"] = false'+("asyncfor"!=this.loop_ctx.type?";break":";throw _b_.StopIteration.$factory("+this.loop_ctx.loop_num+")")};var $CallArgCtx=$B.parser.$CallArgCtx=function(n){this.type="call_arg",this.parent=n,this.start=$pos,this.tree=[],n.tree.push(this),this.expect="id"};$CallArgCtx.prototype.toString=function(){return"call_arg "+this.tree},$CallArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"await":case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":if("id"==l.expect){l.expect=",";var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o)}break;case"=":if(","==l.expect)return new $ExprCtx(new $KwArgCtx(l),"kw_value",!1);break;case"for":this.parent.tree.length>1&&$_SyntaxError(l,"non-parenthesized generator expression");var B=new $ListOrTupleCtx(l,"gen_expr");B.vars=l.vars,B.locals=l.locals,B.intervals=[l.start],l.tree.pop(),B.expression=l.tree,l.tree=[B],B.tree=[];var D=new $ComprehensionCtx(B);return new $TargetListCtx(new $CompForCtx(D));case"op":if("id"==l.expect){var G=o;switch(l.expect=",",G){case"+":case"-":case"~":return $transition(new $AbstractExprCtx(l,!1),n,G);case"*":return new $StarArgCtx(l);case"**":return new $DoubleStarArgCtx(l)}}$_SyntaxError(l,"token "+n+" after "+l);case")":if(l.parent.kwargs&&$B.last(l.parent.tree).tree[0]&&-1==["kwarg","star_arg","double_star_arg"].indexOf($B.last(l.parent.tree).tree[0].type)&&$_SyntaxError(l,["non-keyword argument after keyword argument"]),l.tree.length>0){var M=l.tree[l.tree.length-1];"list_or_tuple"==M.type&&"gen_expr"==M.real&&M.intervals.push($pos)}return $transition(l.parent,n);case":":if(","==l.expect&&"lambda"==l.parent.parent.type)return $transition(l.parent.parent,n);break;case",":if(","==l.expect)return l.parent.kwargs&&-1==["kwarg","star_arg","double_star_arg"].indexOf($B.last(l.parent.tree).tree[0].type)&&$_SyntaxError(l,["non-keyword argument after keyword argument"]),$transition(l.parent,n,o)}console.log("token ",n," after ",l),$_SyntaxError(l,"token "+n+" after "+l)},$CallArgCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $CallCtx=$B.parser.$CallCtx=function(n){this.type="call",this.func=n.tree[0],void 0!==this.func&&(this.func.parent=this),this.parent=n,"class"!=n.type?(n.tree.pop(),n.tree[n.tree.length]=this):n.args=this,this.expect="id",this.tree=[],this.start=$pos,this.func&&"attribute"==this.func.type&&"wait"==this.func.name&&"id"==this.func.value.type&&"time"==this.func.value.value&&(console.log("call",this.func),$get_node(this).blocking={type:"wait",call:this}),this.func&&"input"==this.func.value&&($get_node(this).blocking={type:"input"})};$CallCtx.prototype.toString=function(){return"(call) "+this.func+"("+this.tree+")"},$CallCtx.prototype.transition=function(n,o){var l=this;switch(n){case",":return"id"==l.expect&&$_SyntaxError(l,n),l.expect="id",l;case"await":case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return l.expect=",",$transition(new $CallArgCtx(l),n,o);case")":return l.end=$pos,l.parent;case"op":switch(l.expect=",",o){case"-":case"~":case"+":return l.expect=",",$transition(new $CallArgCtx(l),n,o);case"*":return l.has_star=!0,new $StarArgCtx(l);case"**":return l.has_dstar=!0,new $DoubleStarArgCtx(l)}$_SyntaxError(l,n);case"yield":$_SyntaxError(l,n)}return $transition(l.parent,n,o)},$CallCtx.prototype.to_js=function(){this.js_processed=!0,this.tree.length>0&&0==this.tree[this.tree.length-1].tree.length&&this.tree.pop();var n=this.func.to_js();if(void 0!==this.func){if("classmethod"===this.func.value)return"_b_.classmethod.$factory("+$to_js(this.tree)+")";if("unary"==this.func.type){var o="$B.$getattr("+$to_js(this.tree);switch(this.func.op){case"+":return o+',"__pos__")()';case"-":return o+',"__neg__")()';case"~":return o+',"__invert__")()'}}var l,x=[],B=[],D=!1,G=[];if(this.tree.forEach(function(me){switch(me.type){case"star_arg":D=!0,x.push([me.tree[0].tree[0].to_js(),"*"]);break;case"double_star_arg":G.push(me.tree[0].tree[0].to_js());break;case"id":x.push([me.to_js(),"s"]);break;default:switch(me.tree[0].type){case"expr":case"list_or_tuple":case"op":default:x.push([me.to_js(),"s"]);break;case"kwarg":B.push(me.tree[0].tree[0].value+":"+me.tree[0].tree[1].to_js());break;case"star_arg":D=!0,x.push([me.tree[0].tree[0].to_js(),"*"]);break;case"double_star_arg":G.push(me.tree[0].tree[0].to_js())}}}),D){for(var M=[],P=0,fe=x.length;P<fe;P++)if(arg=x[P],"*"==arg[1])M.push("_b_.list.$factory("+arg[0]+")");else{var ye=[x[P][0]];for(P++;P<fe&&"s"==x[P][1];)ye.push(x[P][0]),P++;P--,M.push("["+ye.join(",")+"]")}for(l=M[0],P=1;P<M.length;P++)l+=".concat("+M[P]+")"}else{for(P=0,fe=x.length;P<fe;P++)x[P]=x[P][0];l=x.join(", ")}var ne="{"+B.join(", ")+"}";ne=G.length?'{$nat:"kw",kw:['+ne+","+G.join(", ")+"]}":"{}"!=ne?'{$nat:"kw",kw:'+ne+"}":"",D&&ne?l+=".concat(["+ne+"])":l&&ne?l+=","+ne:l||(l=ne);var ue="$B.$call("+n+")"+(l=D?".apply(null,"+l+")":"("+l+")");return this.tree.length>-1&&"id"==this.func.type&&this.func.is_builtin&&void 0!==$B.builtin_funcs[this.func.value]?-1==["complex","bytes","bytearray","object","memoryview","int","float","str","list","tuple","dict","set","frozenset","range","slice","zip","bool","type","classmethod","staticmethod","enumerate","reversed","property","$$super","zip","map","filter"].indexOf(this.func.value)?n+l:n+".$factory"+l:ue}};var $ClassCtx=$B.parser.$ClassCtx=function(n){this.type="class",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id";var o=this.scope=$get_scope(this);this.parent.node.parent_block=o,this.parent.node.bound={},this.parent.node.binding={__annotations__:!0}};$ClassCtx.prototype.toString=function(){return"(class) "+this.name+" "+this.tree+" args "+this.args},$ClassCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.set_name(o),l.expect="(:",l;break;case"(":return new $CallCtx(l);case":":return $BodyCtx(l)}$_SyntaxError(l,"token "+n+" after "+l)},$ClassCtx.prototype.set_name=function(n){var o=this.parent;this.random=$B.UUID(),this.name=n,this.id=o.node.module+"_"+n+"_"+this.random,this.binding={},this.parent.node.id=this.id;for(var l=this.scope,x=l,B=l,D=[];"class"==B.ntype;)D.splice(0,0,B.C.tree[0].name),B=B.parent;for(this.qualname=D.concat([n]).join(".");x.C&&"class"==x.C.tree[0].type;)x=x.parent;for(;x.C&&"def"!=x.C.tree[0].type&&"generator"!=x.C.tree[0].type;)x=x.parent;this.parent.node.parent_block=x,$bind(n,l,this),l.is_function&&-1==l.C.tree[0].locals.indexOf(n)&&l.C.tree[0].locals.push(n)},$ClassCtx.prototype.transform=function(n,o){this.doc_string=$get_docstring(n),this.module=$get_module(this).module.replace(/\./g,"_");var l="\n"+" ".repeat(n.indent+12),x=new $Node,B="$locals_"+this.id.replace(/\./g,"_");new $NodeJSCtx(x,M="var "+B+" = {__annotations__: $B.empty_dict()}, "+l+"$locals = "+B),n.insert(0,x);for(var D=this.scope;"__builtins__"!==D.parent_block.id;)D=D.parent_block;var G="$locals_"+D.id.replace(/\./g,"_"),M=" ".repeat(n.indent+4)+'$locals.$name = "'+this.name+'"'+l+'$locals.$qualname = "'+this.qualname+'"'+l+"$locals.$is_class = true; "+l+'$locals.$line_info = "'+n.line_num+","+this.module+'";'+l+'var $top_frame = ["'+B+'", $locals,"'+D.id+'", '+G+"]"+l+"$locals.$f_trace = $B.enter_frame($top_frame);"+l+"if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_line()}";n.insert(1,$NodeJS(M)),n.add($NodeJS("if($locals.$f_trace !== _b_.None){$B.trace_return(_b_.None)}")),n.add($NodeJS("$B.leave_frame({$locals})"));var P=new $Node;new $NodeJSCtx(P,"return "+B+";"),n.insert(n.children.length,P);var fe=new $Node;new $NodeJSCtx(fe,")();"),n.parent.insert(o+1,fe),o++,n.parent.insert(o+1,$NodeJS("$"+this.name+"_"+this.random+".__module__ = $locals_"+this.module+".__name__"));var ne=$get_scope(this),ue=";$locals_"+ne.id.replace(/\./g,"_"),me=1;if((M=[(ue+='["'+this.name+'"]')+' = $B.$class_constructor("'+this.name])[me++]='", $'+this.name+"_"+this.random,void 0!==this.args){var W=[],Q=[];this.args.tree.forEach(function(K){"kwarg"==K.tree[0].type?Q.push(K.tree[0]):W.push(K.to_js())}),M[me++]=", _b_.tuple.$factory(["+W.join(",")+"]),[";var A=new RegExp('"',"g"),R=[],X=0;W.forEach(function(K){R[X++]='"'+K.replace(A,'\\"')+'"'}),M[me++]=R.join(",")+"]",R=[],X=0,Q.forEach(function(K){R[X++]='["'+K.tree[0].value+'",'+K.tree[1].to_js()+"]"}),M[me++]=",["+R.join(",")+"]"}else M[me++]=", _b_.tuple.$factory([]),[],[]";M[me++]=")";var he=new $Node;new $NodeJSCtx(he,M.join("")),o++,n.parent.insert(o+1,he),o++;var z=new $Node;if(new $NodeJSCtx(z,M=ue+".__doc__ = "+(this.doc_string||"_b_.None")+";"),n.parent.insert(o+1,z),"module"==ne.ntype){var Le=new $Node;new $NodeJSCtx(Le,'$locals["'+this.name+'"] = '+this.name)}n.parent.insert(o+2,$NodeJS("_b_.None;")),this.transformed=!0},$ClassCtx.prototype.to_js=function(){return this.js_processed=!0,"var $"+this.name+"_"+this.random+" = (function()"};var $CompIfCtx=$B.parser.$CompIfCtx=function(n){this.type="comp_if",n.parent.intervals.push($pos),this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$CompIfCtx.prototype.toString=function(){return"(comp if) "+this.tree},$CompIfCtx.prototype.transition=function(n,o){return $transition(this.parent,n,o)},$CompIfCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $ComprehensionCtx=$B.parser.$ComprehensionCtx=function(n){this.type="comprehension",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ComprehensionCtx.prototype.toString=function(){return"(comprehension) "+this.tree},$ComprehensionCtx.prototype.transition=function(n,o){var l=this;switch(n){case"if":return new $AbstractExprCtx(new $CompIfCtx(l),!1);case"for":return new $TargetListCtx(new $CompForCtx(l))}return $transition(l.parent,n,o)},$ComprehensionCtx.prototype.to_js=function(){this.js_processed=!0;var n=[];return this.tree.forEach(function(o){n.push(o.start)}),n};var $CompForCtx=$B.parser.$CompForCtx=function(n){this.type="comp_for",n.parent.intervals.push($pos),this.parent=n,this.tree=[],this.expect="in",n.tree[n.tree.length]=this};$CompForCtx.prototype.toString=function(){return"(comp for) "+this.tree},$CompForCtx.prototype.transition=function(n,o){var l=this;return"in"==n&&"in"==l.expect?(l.expect=null,new $AbstractExprCtx(new $CompIterableCtx(l),!0)):null===l.expect?$transition(l.parent,n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$CompForCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $CompIterableCtx=$B.parser.$CompIterableCtx=function(n){this.type="comp_iterable",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$CompIterableCtx.prototype.toString=function(){return"(comp iter) "+this.tree},$CompIterableCtx.prototype.transition=function(n,o){return $transition(this.parent,n,o)},$CompIterableCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $ConditionCtx=$B.parser.$ConditionCtx=function(n,o){this.type="condition",this.token=o,this.parent=n,this.tree=[],this.scope=$get_scope(this),"while"==o&&(this.loop_num=$loop_num++),n.tree[n.tree.length]=this};$ConditionCtx.prototype.toString=function(){return this.token+" "+this.tree},$ConditionCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return"abstract_expr"==l.tree[0].type&&0==l.tree[0].tree.length&&$_SyntaxError(l,"token "+n+" after "+l),$BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$ConditionCtx.prototype.transform=function(n,o){if($get_scope(this),"while"==this.token){n.parent.insert(o,$NodeJS('$locals["$no_break'+this.loop_num+'"] = true'));var l=$get_module(this).module;return"return"!=$B.last(n.children).C.tree[0].type&&n.add($NodeJS('$locals.$line_info = "'+n.line_num+","+l+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;')),2}},$ConditionCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.token;"elif"==n&&(n="else if");var o=[n+"($B.$bool("];if("while"==n)o.push('$locals["$no_break'+this.loop_num+'"] && ');else if("else if"==n){var l=$get_node(this).line_num+","+$get_scope(this).id;o.push('($B.set_line("'+l+'")) && ')}return 1==this.tree.length?o.push($to_js(this.tree)+"))"):(o.push(this.tree[0].to_js()+"))"),this.tree[1].tree.length>0&&o.push("{"+this.tree[1].to_js()+"}")),o.join("")};var $ContinueCtx=$B.parser.$ContinueCtx=function(n){this.type="continue",this.parent=n,$get_node(this).is_continue=!0,n.tree[n.tree.length]=this,set_loop_context.apply(this,[n,"continue"])};$ContinueCtx.prototype.toString=function(){return"(continue)"},$ContinueCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return l.parent;$_SyntaxError(l,"token "+n+" after "+l)},$ContinueCtx.prototype.to_js=function(){this.js_processed=!0;var n="continue";return this.loop_ctx.has_break&&(n=`$locals["$no_break${this.loop_ctx.loop_num}"]=true;${n}`),n};var $DebuggerCtx=$B.parser.$DebuggerCtx=function(n){this.type="continue",this.parent=n,n.tree[n.tree.length]=this};$DebuggerCtx.prototype.toString=function(){return"(debugger)"},$DebuggerCtx.prototype.transition=function(n,o){},$DebuggerCtx.prototype.to_js=function(){return this.js_processed=!0,"debugger"};var $DecoratorCtx=$B.parser.$DecoratorCtx=function(n){this.type="decorator",this.parent=n,n.tree[n.tree.length]=this,this.tree=[]};$DecoratorCtx.prototype.toString=function(){return"(decorator) "+this.tree},$DecoratorCtx.prototype.transition=function(n,o){var l=this;return"id"==n&&0==l.tree.length?$transition(new $AbstractExprCtx(l,!1),n,o):"eol"==n?$transition(l.parent,n):void $_SyntaxError(l,"token "+n+" after "+l)},$DecoratorCtx.prototype.transform=function(n,o){for(var l=o+1,x=n.parent.children,B=[this.tree];;)if(l>=x.length)$_SyntaxError(C,["decorator expects function"]);else if("node_js"==x[l].C.type)l++;else{if("decorator"!=x[l].C.tree[0].type)break;B.push(x[l].C.tree[0].tree),x.splice(l,1)}this.dec_ids=[],B.forEach(function(){this.dec_ids.push("$id"+$B.UUID())},this);var D=x[l].C.tree[0];"def"==D.type&&(D.decorated=!0,D.alias="$dec"+$B.UUID());var G="",M=$get_scope(this),P='$locals["';M.globals&&M.globals.has(D.name)&&(P="$locals_"+$get_module(this).id+'["');var fe=(P+=D.name+'"]')+" = ";B.forEach(function(ye,ne){fe+="$B.$call("+this.dec_ids[ne]+")(",G+=")"},this),fe+=(D.decorated?D.alias:P)+G+";",$bind(D.name,M,this),n.parent.insert(l+1,$NodeJS(fe)),this.decorators=B},$DecoratorCtx.prototype.to_js=function(){this.js_processed=!0;var n=[];return this.decorators.forEach(function(o,l){n.push("var "+this.dec_ids[l]+" = "+$to_js(o)+";")},this),n.join("")};var $DefCtx=$B.parser.$DefCtx=function(n){this.type="def",this.name=null,this.parent=n,this.tree=[],this.async=n.async,this.locals=[],n.tree[n.tree.length]=this,this.enclosing=[];var o=this.scope=$get_scope(this);o.C&&"class"==o.C.tree[0].type&&(this.class_name=o.C.tree[0].name),n.node.binding={};for(var l=o;l.C&&"class"==l.C.tree[0].type;)l=l.parent;for(;l.C&&"def"!=l.C.tree[0].type;)l=l.parent;this.parent.node.parent_block=l;var x=l;for(this.is_comp=x.is_comp;x&&x.C;){if("def"==x.C.tree[0].type){this.inside_function=!0;break}x=x.parent_block}this.module=o.module,this.root=$get_module(this),this.num=$loop_num,$loop_num++,this.positional_list=[],this.default_list=[],this.other_args=null,this.other_kw=null,this.after_star=[]};$DefCtx.prototype.set_name=function(n){try{n=$mangle(n,this.parent.tree[0])}catch(x){throw console.log(x),console.log("parent",this.parent),x}var o=new $IdCtx(this,n);this.name=n,this.id=this.scope.id+"_"+n,this.id=this.id.replace(/\./g,"_"),this.id+="_"+$B.UUID(),this.parent.node.id=this.id,this.parent.node.module=this.module,this.binding={};var l=this.scope;void 0!==l.globals&&l.globals.has(n)?$bind(n,this.root,this):$bind(n,l,this),o.bound=!0,l.is_function&&-1==l.C.tree[0].locals.indexOf(n)&&l.C.tree[0].locals.push(n)},$DefCtx.prototype.toString=function(){return"def "+this.name+"("+this.tree+")"},$DefCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return l.name&&$_SyntaxError(l,"token "+n+" after "+l),l.set_name(o),l;case"(":return null==l.name&&$_SyntaxError(l,"missing name in function definition"),l.has_args=!0,new $FuncArgs(l);case"annotation":return new $AbstractExprCtx(new $AnnotationCtx(l),!0);case":":if(l.has_args)return $BodyCtx(l);$_SyntaxError(l,"missing function parameters");case"eol":l.has_args&&$_SyntaxError(l,"missing colon")}$_SyntaxError(l,"token "+n+" after "+l)},$DefCtx.prototype.transform=function(n,o){if(this.is_comp&&($get_node(this).is_comp=!0),void 0===this.transformed){var l=this.scope;this.doc_string=$get_docstring(n),this.rank=o;var x=n.indent+12;if(this.name.substr(0,15)=="lambda_"+$B.lambda_magic){var B=l.parent_block;B.C&&"def"==B.C.tree[0].type&&this.enclosing.push(B)}for(var D=this.parent.node;D.parent&&D.parent.is_def_func;)this.enclosing.push(D.parent.parent),D=D.parent.parent;var G=[],M=[],P=!1;this.argcount=0,this.kwonlyargcount=0,this.kwonlyargsdefaults=[],this.otherdefaults=[],this.varnames={},this.args=[],this.__defaults__=[],this.slots=[];var fe=[],ye=[],ne=[];this.annotation&&ne.push('"return":'+this.annotation.to_js()),this.func_name=this.tree[0].to_js();var ue=this.func_name;this.decorated&&(this.func_name="var "+this.alias,ue=this.alias),this.tree[1].tree.forEach(function(rr){if("end_positional"==rr.type?(this.args.push("/"),fe.push('"/"'),P=!0):(this.args.push(rr.name),this.varnames[rr.name]=!0),"func_arg_id"==rr.type?(this.star_arg?(this.kwonlyargcount++,rr.has_default&&this.kwonlyargsdefaults.push(rr.name)):(this.argcount++,rr.has_default&&this.otherdefaults.push(rr.name)),this.slots.push(rr.name+":null"),fe.push('"'+rr.name+'"'),ye.push(rr.name+":"+rr.name),rr.tree.length>0&&(G.push('"'+rr.name+'"'),M.push(rr.name+":"+$to_js(rr.tree)),this.__defaults__.push($to_js(rr.tree)))):"func_star_arg"==rr.type&&("*"==rr.op?this.star_arg=rr.name:"**"==rr.op&&(this.kw_arg=rr.name)),rr.annotation){var ti=$mangle(rr.name,this);ne.push(ti+": "+rr.annotation.to_js())}},this),ye="{"+ye.join(", ")+"}";var me=67;this.star_arg&&(me|=4),this.kw_arg&&(me|=8),"generator"==this.type&&(me|=32),this.async&&(me|=128);for(var ie=[],W=l;W.parent_block&&"__builtins__"!==W.parent_block.id;)W=W.parent_block;var Q="$locals_"+W.id.replace(/\./g,"_"),A=this.name+this.num,R="$locals_"+this.id;z="var "+R+" = {},"+(ft="\n"+" ".repeat(x))+"$locals = "+R+";",(Le=new $Node).locals_def=!0,Le.func_node=n,new $NodeJSCtx(Le,z),ie.push(Le);var X=[$NodeJS('$locals.$line_info = "'+n.line_num+","+this.module+'"'),$NodeJS(`var $top_frame=["${this.id}",$locals,"`+W.id+'", '+Q+", "+(this.is_comp?this.name:A)+"]"),$NodeJS("$locals.$f_trace = $B.enter_frame($top_frame)"),$NodeJS("var $stack_length = $B.frames_stack.length;")];"generator"==this.type&&X.push($NodeJS("$locals.$is_generator = true")),this.async&&X.splice(1,0,$NodeJS(`$locals.$async="${this.id}"`)),X.forEach(function(rr){rr.enter_frame=!0}),this.is_comp&&ie.push($NodeJS("var $defaults = {}")),this.env=[];var he=[],z=R+' = $locals = $B.args("'+this.name+'", '+this.argcount+", {"+this.slots.join(", ")+"}, ["+fe.join(", ")+"], arguments, $defaults, "+this.other_args+", "+this.other_kw+");",Le=new $Node;new $NodeJSCtx(Le,z),he.push(Le);var K=!1;if(null!==this.other_args||null!==this.other_kw||0!=this.after_star.length||P)ie.push(he[0]),he.length>1&&ie.push(he[1]);else{K=!0,ie.push($NodeJS("var $len = arguments.length;")),Le=new $Node,new $NodeJSCtx(Le,z="if($len > 0 && arguments[$len - 1].$nat !== undefined)"),ie.push(Le),he.forEach(function(rr){Le.add(rr)});var be=new $Node;new $NodeJSCtx(be,"else"),ie.push(be);var Ne=this.slots.length,je=$NodeJS("if($len == "+Ne+")");be.add(je),je.add($NodeJS(R+" = $locals = "+ye)),be.add($NodeJS("else if($len > "+Ne+'){$B.wrong_nb_args("'+this.name+'", $len, '+Ne+", ["+fe+"])}")),Ne>0&&(be.add($NodeJS("else if($len + Object.keys($defaults).length < "+Ne+'){$B.wrong_nb_args("'+this.name+'", $len, '+Ne+", ["+fe+"])}")),subelse_node=$NodeJS("else"),be.add(subelse_node),subelse_node.add($NodeJS(R+" = $locals = "+ye)),subelse_node.add($NodeJS("var defparams = ["+fe+"]")),subelse_node.add($NodeJS("for(var i = $len; i < defparams.length; i++){$locals[defparams[i]] = $defaults[defparams[i]]}")))}ie=ie.concat(X),"class"==l.ntype&&(class_ref="$locals_"+l.parent_block.id.replace(/\./g,"_")+"."+l.C.tree[0].qualname,this.parent.node.binding.__class__=!0,ie.push($NodeJS("$locals.__class__ = "+class_ref))),ie.push($NodeJS("$B.js_this = this;"));for(var Te=ie.length-1;Te>=0;Te--)n.children.splice(0,0,ie[Te]);var qe=new $Node;this.params="",K&&(this.params=Object.keys(this.varnames).join(", ")),new $NodeJSCtx(qe,""),qe.is_def_func=!0,qe.module=this.module;var Ke=n.children[n.children.length-1];x=Ke.indent,"return"!=Ke.C.tree[0].type&&(z="if($locals.$f_trace !== _b_.None){\n"+"    ".repeat(x)+"$B.trace_return(_b_.None)\n"+"    ".repeat(x)+"}\n"+"    ".repeat(x),z+="$B.leave_frame","$exec"==this.id.substr(0,5)&&(z+="_exec"),n.add($NodeJS(z+="({$locals});return _b_.None")));var vt=[];if(this.parent.node.referenced)for(var ht in this.parent.node.referenced)this.parent.node.binding[ht]||vt.push('"'+ht+'"');n.add(qe);var Bt=1;if(x=n.indent,!this.is_comp){n.parent.insert(o+Bt++,$NodeJS(A+".$is_func = true")),this.$has_yield_in_cm&&n.parent.insert(o+Bt++,$NodeJS(A+".$has_yield_in_cm = true")),n.parent.insert(o+Bt++,$NodeJS(A+".$infos = {"));var wt=this.name;"$$"==this.name.substr(0,2)&&(wt=wt.substr(2)),wt.substr(0,15)=="lambda_"+$B.lambda_magic&&(wt="<lambda>"),n.parent.insert(o+Bt++,$NodeJS(z='    __name__:"'+wt+'",'));var Ft=wt;if(this.class_name&&(Ft=this.class_name+"."+wt),n.parent.insert(o+Bt++,$NodeJS(z='    __qualname__:"'+Ft+'",')),this.otherdefaults.length>0){var Ot=[];this.otherdefaults.forEach(function(rr){Ot.push("$defaults."+rr)}),n.parent.insert(o+Bt++,$NodeJS("    __defaults__ : $B.fast_tuple(["+Ot.join(", ")+"]),"))}else n.parent.insert(o+Bt++,$NodeJS("    __defaults__ : _b_.None,"));this.kwonlyargsdefaults.lengh>0?(Ot=[],this.kwonlyargsdefaults.forEach(function(rr){Ot.push("$defaults."+rr)}),n.parent.insert(o+Bt++,$NodeJS("    __kwdefaults__ : $B.fast_tuple(["+Ot.join(", ")+"]),"))):n.parent.insert(o+Bt++,$NodeJS("    __kwdefaults__ : _b_.None,")),n.parent.insert(o+Bt++,$NodeJS("    __annotations__: {"+ne.join(",")+"},")),n.parent.insert(o+Bt++,$NodeJS("    __dict__: $B.empty_dict(),")),n.parent.insert(o+Bt++,$NodeJS("    __doc__: "+(this.doc_string||"_b_.None")+","));var on=$get_module(this);for(var ht in n.parent.insert(o+Bt++,$NodeJS('    __module__ : "'+on.module+'",')),this.binding)this.varnames[ht]=!0;var ft,An=[];for(var ht in this.varnames)An.push('"'+$B.from_alias(ht)+'"');z="    __code__:{"+(ft="\n"+" ".repeat(x+8))+"    co_argcount:"+this.argcount;var Cn=","+ft+" ".repeat(4);z+=Cn+"co_filename:$locals_"+$get_module(this).module.replace(/\./g,"_")+'["__file__"] || "<string>"'+Cn+"co_firstlineno:"+n.line_num+Cn+"co_flags:"+me+Cn+"co_freevars: ["+vt+"]"+Cn+"co_kwonlyargcount:"+this.kwonlyargcount+Cn+'co_name: "'+this.name+'"'+Cn+"co_nlocals: "+An.length+Cn+"co_posonlyargcount: "+(this.pos_only||0)+Cn+"co_varnames: $B.fast_tuple(["+An.join(", ")+"])"+ft+"}\n"+" ".repeat(x+4)+"};",n.parent.insert(o+Bt++,$NodeJS(z+="_b_.None;"))}if(this.default_str="{"+M.join(", ")+"}",!this.is_comp){var fn=A;"generator"==this.type&&(fn=`$B.generator.$factory(${A})`);var On="return "+fn;this.async&&(On="generator"==this.type?`return $B.async_generator.$factory(${A})`:"return $B.make_async("+fn+")"),n.parent.insert(o+Bt++,$NodeJS(On+"}")),n.parent.insert(o+Bt++,$NodeJS(this.func_name+" = "+this.name+"$"+this.num+"("+this.default_str+")")),n.parent.insert(o+Bt++,$NodeJS(ue+".$set_defaults = function(value){return "+ue+" = "+this.name+"$"+this.num+"(value)}")),this.$has_yield_in_cm&&n.parent.insert(o+Bt++,$NodeJS(`${ue}.$has_yield_in_cm=true`))}for(var $n=n,_n=0;_n<$n.children.length&&$n.children[_n]!==$B.last(X);_n++);var ar=$NodeJS("try"),nr=$n.children.slice(_n+1);$n.insert(_n+1,ar),nr.forEach(function(rr){rr.is_def_func?rr.children.forEach(function(ti){ar.add(ti)}):ar.add(rr)}),$n.children.splice(_n+2,$n.children.length);var lr=$NodeJS("catch(err)");return lr.add($NodeJS("$B.set_exc(err)")),lr.add($NodeJS("if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_exception()}")),lr.add($NodeJS("$B.leave_frame({$locals});throw err")),$n.add(lr),this.transformed=!0,Bt}},$DefCtx.prototype.to_js=function(n){return this.js_processed=!0,this.is_comp?"var "+this.name+" = "+(this.async?" async ":"")+"function* (expr)":(n=n||this.tree[0].to_js(),this.decorated&&(n="var "+this.alias),"var "+this.name+"$"+this.num+" = function($defaults){"+(this.async?"async ":"")+"function"+("generator"==this.type?"* ":" ")+this.name+this.num+"("+this.params+")")};var $DelCtx=$B.parser.$DelCtx=function(n){this.type="del",this.parent=n,n.tree[n.tree.length]=this,this.tree=[]};$DelCtx.prototype.toString=function(){return"del "+this.tree},$DelCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return $transition(l.parent,n);$_SyntaxError(l,"token "+n+" after "+l)},$DelCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.parent;if("list_or_tuple"==this.tree[0].type){var o=[];return this.tree[0].tree.forEach(function(D){var G=new $DelCtx(n);G.tree=[D],o.push(G.to_js()),n.tree.pop()}),this.tree=[],o.join(";")}if("expr"==this.tree[0].type&&"list_or_tuple"==this.tree[0].tree[0].type)return this.tree[0]=this.tree[0].tree[0],this.to_js();var l=this.tree[0].tree[0];switch(l.type){case"id":var x=$get_scope(this),B=!1;if(("def"==x.ntype||"generator"==x.ntype)&&x.globals&&x.globals.has(l.value)){for(x=x.parent;x.parent&&"__builtins__"!==x.parent.id;)x=x.parent;B=!0}return o='$B.$delete("'+l.value+'"'+(B?', "global"':"")+");",delete x.binding[l.value],o;case"list_or_tuple":return o=[],l.tree.forEach(function(D){o.push("delete "+D.to_js())}),o.join(";");case"sub":return l.func="delitem",js=l.to_js(),l.func="getitem",js;case"op":$_SyntaxError(this,["cannot delete operator"]);case"call":$_SyntaxError(this,["cannot delete function call"]);case"attribute":return"_b_.delattr("+l.value.to_js()+',"'+l.name+'")';default:$_SyntaxError(this,["cannot delete "+l.type])}};var $DictOrSetCtx=$B.parser.$DictOrSetCtx=function(n){this.type="dict_or_set",this.real="dict_or_set",this.expect="id",this.closed=!1,this.start=$pos,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$DictOrSetCtx.prototype.toString=function(){switch(this.real){case"dict":return"(dict) {"+this.items+"}";case"set":return"(set) {"+this.tree+"}"}return"(dict_or_set) {"+this.tree+"}"},$DictOrSetCtx.prototype.transition=function(n,o){var l=this;if(l.closed){switch(n){case"[":return new $AbstractExprCtx(new $SubCtx(l.parent),!1);case"(":return new $CallArgCtx(new $CallCtx(l.parent))}return $transition(l.parent,n,o)}if(","==l.expect){switch(n){case"}":switch(l.real){case"dict_or_set":if(1!=l.tree.length)break;l.real="set";case"set":case"set_comp":case"dict_comp":return l.items=l.tree,l.tree=[],l.closed=!0,l;case"dict":if(l.nb_dict_items()%2==0)return l.items=l.tree,l.tree=[],l.closed=!0,l}$_SyntaxError(l,"token "+n+" after "+l);case",":return"dict_or_set"==l.real&&(l.real="set"),"dict"==l.real&&l.nb_dict_items()%2&&$_SyntaxError(l,"token "+n+" after "+l),l.expect="id",l;case":":if("dict_or_set"==l.real&&(l.real="dict"),"dict"==l.real)return l.expect=",",new $AbstractExprCtx(l,!1);$_SyntaxError(l,"token "+n+" after "+l);case"for":l.real="dict_or_set"==l.real?"set_comp":"dict_comp";var x=new $ListOrTupleCtx(l,"dict_or_set_comp");x.intervals=[l.start+1],x.vars=l.vars,l.tree.pop(),x.expression=l.tree,l.yields&&(x.expression.yields=l.yields,delete l.yields),l.tree=[x],x.tree=[];var B=new $ComprehensionCtx(x);return new $TargetListCtx(new $CompForCtx(B))}$_SyntaxError(l,"token "+n+" after "+l)}else if("id"==l.expect){switch(n){case"}":return 0==l.tree.length?(l.items=[],l.real="dict"):l.items=l.tree,l.tree=[],l.closed=!0,l;case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":l.expect=",";var D=new $AbstractExprCtx(l,!1);return $transition(D,n,o);case"op":switch(o){case"*":case"**":return l.expect=",",(D=new $AbstractExprCtx(l,!1)).packed=o.length,"dict_or_set"==l.real?l.real="*"==o?"set":"dict":("set"==l.real&&"**"==o||"dict"==l.real&&"*"==o)&&$_SyntaxError(l,"token "+n+" after "+l),D;case"+":return l;case"-":case"~":l.expect=",";var G=new $UnaryCtx(l,o);if("-"==o)var M=new $OpCtx(G,"unary_neg");else M=new $OpCtx(G,"+"==o?"unary_pos":"unary_inv");return new $AbstractExprCtx(M,!1)}$_SyntaxError(l,"token "+n+" after "+l)}$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n,o)},$DictOrSetCtx.prototype.nb_dict_items=function(){var n=0;return this.tree.forEach(function(o){o.packed?n+=2:n++}),n},$DictOrSetCtx.prototype.packed_indices=function(){var n=[];return this.items.forEach(function(o,l){"expr"==o.type&&o.packed&&n.push(l)}),n},$DictOrSetCtx.prototype.unpack_dict=function(n){for(var o,l,x,B="",D=0;D<this.items.length;)l=0==D,"expr"==(x=this.items[D]).type&&x.packed?(o="_b_.list.$factory(_b_.dict.items("+x.to_js()+"))",D++):(o="[["+x.to_js()+","+this.items[D+1].to_js()+"]]",D+=2),l||(o=".concat("+o+")"),B+=o;return B},$DictOrSetCtx.prototype.unpack_set=function(n){var o,l="";return this.items.forEach(function(x,B){o=n.indexOf(B)>-1?"_b_.list.$factory("+x.to_js()+")":"["+x.to_js()+"]",B>0&&(o=".concat("+o+")"),l+=o}),l},$DictOrSetCtx.prototype.to_js=function(){switch(this.js_processed=!0,this.real){case"dict":if((l=this.packed_indices()).length>0)return"_b_.dict.$factory("+this.unpack_dict(l)+")"+$to_js(this.tree);for(var n=[],o=0;o<this.items.length;o+=2)n.push("["+this.items[o].to_js()+","+this.items[o+1].to_js()+"]");return"_b_.dict.$factory(["+n.join(",")+"])"+$to_js(this.tree);case"set_comp":return"_b_.set.$factory("+$to_js(this.items)+")"+$to_js(this.tree);case"dict_comp":return"_b_.dict.$factory("+$to_js(this.items)+")"+$to_js(this.tree)}var l;return(l=this.packed_indices()).length>0?"_b_.set.$factory("+this.unpack_set(l)+")":"_b_.set.$factory(["+$to_js(this.items)+"])"+$to_js(this.tree)};var $DoubleStarArgCtx=$B.parser.$DoubleStarArgCtx=function(n){this.type="double_star_arg",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$DoubleStarArgCtx.prototype.toString=function(){return"**"+this.tree},$DoubleStarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case",":case")":return $transition(l.parent,n);case":":if("lambda"==l.parent.parent.type)return $transition(l.parent.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$DoubleStarArgCtx.prototype.to_js=function(){return this.js_processed=!0,'{$nat:"pdict",arg:'+$to_js(this.tree)+"}"};var $EllipsisCtx=$B.parser.$EllipsisCtx=function(n){this.type="ellipsis",this.parent=n,this.nbdots=1,this.start=$pos,n.tree[n.tree.length]=this};$EllipsisCtx.prototype.toString=function(){return"ellipsis"},$EllipsisCtx.prototype.transition=function(n,o){var l=this;return"."==n?(l.nbdots++,3==l.nbdots&&$pos-l.start==2&&(l.$complete=!0),l):l.$complete?$transition(l.parent,n,o):($pos--,void $_SyntaxError(l,"token "+n+" after "+l))},$EllipsisCtx.prototype.to_js=function(){return this.js_processed=!0,'$B.builtins["Ellipsis"]'};var $EndOfPositionalCtx=$B.parser.$EndOfConditionalCtx=function(n){this.type="end_positional",this.parent=n,n.has_end_positional=!0,n.parent.pos_only=n.tree.length,n.tree.push(this)};$EndOfPositionalCtx.prototype.transition=function(n,o){var l=this;if(","==n||")"==n)return $transition(l.parent,n,o);$_SyntaxError(l,"token "+n+" after "+l)},$EndOfPositionalCtx.prototype.to_js=function(){return"/"};var $ExceptCtx=$B.parser.$ExceptCtx=function(n){this.type="except",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.expect="id",this.scope=$get_scope(this)};$ExceptCtx.prototype.toString=function(){return"(except) "},$ExceptCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":if("id"==l.expect)return l.expect="as",$transition(new $AbstractExprCtx(l,!1),n,o);case"as":if("as"==l.expect&&void 0===l.has_alias)return l.expect="alias",l.has_alias=!0,l;case"id":if("alias"==l.expect)return l.expect=":",l.set_alias(o),l;break;case":":var x=l.expect;if("id"==x||"as"==x||":"==x)return $BodyCtx(l);break;case"(":if("id"==l.expect&&0==l.tree.length)return l.parenth=!0,l;break;case")":if(","==l.expect||"as"==l.expect)return l.expect="as",l;case",":if(void 0!==l.parenth&&void 0===l.has_alias&&("as"==l.expect||","==l.expect))return l.expect="id",l}$_SyntaxError(l,"token "+n+" after "+l.expect)},$ExceptCtx.prototype.set_alias=function(n){this.tree[0].alias=$mangle(n,this),$bind(n,this.scope,this)},$ExceptCtx.prototype.transform=function(n,o){var l=$NodeJS("void(0)");l.line_num=n.line_num,n.insert(0,l);var x=$B.last(n.children);x.C.tree&&x.C.tree[0]&&"return"==x.C.tree[0].type||n.add($NodeJS("$B.del_exc()"))},$ExceptCtx.prototype.to_js=function(){switch(this.js_processed=!0,this.tree.length){case 0:return"else";case 1:if("Exception"==this.tree[0].name)return"else if(1)"}var n=[];this.tree.forEach(function(x){n.push(x.to_js())});var o="";if($B.debug>0){var l=$get_module(this);o='($locals.$line_info = "'+$get_node(this).line_num+","+l.id+'") && '}return"else if("+o+"$B.is_exc("+this.error_name+",["+n.join(",")+"]))"};var $ExprCtx=$B.parser.$ExprCtx=function(n,o,l){if(this.type="expr",this.name=o,this.with_commas=l,this.expect=",",this.parent=n,n.packed&&(this.packed=n.packed),n.is_await){var x=$get_node(this);x.has_await=x.has_await||[],this.is_await=n.is_await,x.has_await.push(this)}n.assign&&(this.assign=n.assign),this.tree=[],n.tree[n.tree.length]=this};$ExprCtx.prototype.toString=function(){return"(expr "+this.with_commas+") "+this.tree},$ExprCtx.prototype.transition=function(n,o){var l=this;switch(n){case"bytes":case"float":case"id":case"imaginary":case"int":case"lambda":case"pass":case"str":$_SyntaxError(l,"token "+n+" after "+l);break;case"{":return"id"==l.tree[0].type&&-1!=["print","exec"].indexOf(l.tree[0].value)||$_SyntaxError(l,"token "+n+" after "+l),new $DictOrSetCtx(l);case"[":case"(":case".":case"not":if("expr"==l.expect)return l.expect=",",$transition(new $AbstractExprCtx(l,!1),n,o)}switch(n){case"not":if(","==l.expect)return new $ExprNot(l);break;case"in":if("target_list"==l.parent.type)return $transition(l.parent,n);if(","==l.expect)return $transition(l,"op","in");break;case",":if(","==l.expect&&(l.with_commas||["assign","return"].indexOf(l.parent.type)>-1)){$parent_match(l,{type:"yield",from:!0})&&$_SyntaxError(l,"no implicit tuple for yield from"),l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.implicit=!0,x.has_comma=!0,x.tree=[l],l.parent=x,x}return $transition(l.parent,n);case".":return new $AttrCtx(l);case"[":return new $AbstractExprCtx(new $SubCtx(l),!0);case"(":return new $CallCtx(l);case"op":var B=l.parent,D=o;if("ternary"==B.type&&B.in_else){var G=new $OpCtx(l,D);return new $AbstractExprCtx(G,!1)}for(var M=l.parent,P=null;;)if("expr"==M.type)M=M.parent;else if("op"==M.type&&$op_weight[M.op]>=$op_weight[D]&&("**"!=M.op||"**"!=D))P=M,M=M.parent;else{if(!("not"==M.type&&$op_weight.not>$op_weight[D]))break;P=M,M=M.parent}if(null===P){for(;l.parent!==M;)B=(l=l.parent).parent;var fe;return l.parent.tree.pop(),(fe=new $ExprCtx(B,"operand",l.with_commas)).expect=",",l.parent=fe,G=new $OpCtx(l,D),new $AbstractExprCtx(G,!1)}if("and"===D||"or"===D)for(;"not"==P.parent.type||"expr"==P.parent.type&&"not"==P.parent.parent.type;)B=(P=P.parent).parent;if("op"==P.type){var ye=!1;switch(P.op){case"<":case"<=":case"==":case"!=":case"is":case">=":case">":ye=!0}if(ye)switch(D){case"<":case"<=":case"==":case"!=":case"is":case">=":case">":var ne=P.tree[1],ue=ne.to_js(),me=new Object;for(var ie in ne)me[ie]=ne[ie];var W="$c"+chained_comp_num;for(ne.to_js=function(){return W},me.to_js=function(){return W},chained_comp_num++;P.parent&&"op"==P.parent.type&&$op_weight[P.parent.op]<$op_weight[P.op];)P=P.parent;P.parent.tree.pop();var Q=new $OpCtx(P,"and");return Q.wrap={name:W,js:ue},me.parent=Q,Q.tree.push("xxx"),G=new $OpCtx(me,D),new $AbstractExprCtx(G,!1)}}return P.parent.tree.pop(),(fe=new $ExprCtx(P.parent,"operand",!1)).tree=[M],P.parent=fe,G=new $OpCtx(P,D),new $AbstractExprCtx(G,!1);case"augm_assign":for(var A=l.parent;A;)"assign"==A.type||"augm_assign"==A.type?$_SyntaxError(l,"augmented assignment inside assignment"):"op"==A.type&&$_SyntaxError(l,["cannot assign to operator"]),A=A.parent;return","==l.expect?new $AbstractExprCtx(new $AugmentedAssignCtx(l,o),!0):$transition(l.parent,n,o);case":":if("sub"==l.parent.type||"list_or_tuple"==l.parent.type&&"sub"==l.parent.parent.type)return new $AbstractExprCtx(new $SliceCtx(l.parent),!1);if("slice"==l.parent.type)return $transition(l.parent,n,o);if("node"==l.parent.type){if(1==l.tree.length){var R=l.tree[0];if(["id","sub","attribute"].indexOf(R.type)>-1)return new $AbstractExprCtx(new $AnnotationCtx(l),!1);if("tuple"==R.real&&","==R.expect&&1==R.tree.length)return new $AbstractExprCtx(new $AnnotationCtx(R.tree[0]),!1)}$_SyntaxError(l,"invalid target for annotation")}break;case"=":var X;if(","==l.expect){if("call_arg"==l.parent.type)return"id"!=l.tree[0].type&&$_SyntaxError(l,['expression cannot contain assignment, perhaps you meant "=="?']),new $AbstractExprCtx(new $KwArgCtx(l),!0);if(X=function(Ke){for(;Ke.parent;){if("annotation"==Ke.parent.type)return Ke.parent;Ke=Ke.parent}return!1}(l))return $transition(X,n,o);if("op"==l.parent.type)$_SyntaxError(l,["cannot assign to operator"]);else if("not"==l.parent.type)$_SyntaxError(l,["cannot assign to operator"]);else if("list_or_tuple"==l.parent.type)for(var he=0;he<l.parent.tree.length;he++){var z=l.parent.tree[he];"expr"==z.type&&"operand"==z.name&&$_SyntaxError(l,["cannot assign to operator"])}else l.tree.length>0&&l.tree[0].assign?$_SyntaxError(l,["cannot assign to named expression"]):"expr"==l.parent.type&&"target list"==l.parent.name?$_SyntaxError(l,"token "+n+" after "+l):"lambda"==l.parent.type&&"node"!=l.parent.parent.parent.type&&$_SyntaxError(l,['expression cannot contain assignment, perhaps you meant "=="?']);for(;void 0!==l.parent;)"condition"==(l=l.parent).type?$_SyntaxError(l,"token "+n+" after "+l):"augm_assign"==l.type&&$_SyntaxError(l,"assignment inside augmented assignment");return new $AbstractExprCtx(new $AssignCtx(l=l.tree[0]),!0)}break;case":=":var Le=l.parent.type;if(["node","assign","kwarg","annotation"].indexOf(Le)>-1||"func_arg_id"==Le&&l.parent.tree.length>0?$_SyntaxError(l,":= invalid, parent "+Le):"call_arg"==Le&&"call"==l.parent.parent.type&&"lambda"==l.parent.parent.parent.type&&$_SyntaxError(l,":= invalid inside function arguments"),1==l.tree.length&&"id"==l.tree[0].type){for(var K=$get_scope(l),be=l.tree[0].value;K.is_comp;)K=K.parent_block;$bind(be,K,l),(A=l.parent).tree.pop();var Ne=new $AbstractExprCtx(A,!1);return Ne.assign=l.tree[0],Ne}$_SyntaxError(l,"token "+n+" after "+l);case"if":for(var je=!1,Te=l.parent;"list_or_tuple"!=Te.type;){if("comp_for"==Te.type||"comp_if"==Te.type){je=!0;break}if("call_arg"==Te.type||void 0===Te.parent)break;Te=Te.parent}if(je)break;for(Te=l;Te.parent&&("op"==Te.parent.type||"expr"==Te.parent.type&&"operand"==Te.parent.name);)Te=Te.parent;return new $AbstractExprCtx(new $TernaryCtx(Te),!0);case"eol":if(2==l.tree.length&&"id"==l.tree[0].type&&["print","exec"].indexOf(l.tree[0].value)>-1&&$_SyntaxError(l,["Missing parentheses in call to '"+l.tree[0].value+"'."]),-1==["dict_or_set","list_or_tuple"].indexOf(l.parent.type)){var qe=l.tree[0];("packed"==qe.type||"call"==qe.type&&"packed"==qe.func.type)&&$_SyntaxError(l,["can't use starred expression here"])}}return $transition(l.parent,n)},$ExprCtx.prototype.to_js=function(n){var o;if(this.js_processed=!0,o="list"==this.type?"["+$to_js(this.tree)+"]":1==this.tree.length?this.tree[0].to_js(n):"_b_.tuple.$factory(["+$to_js(this.tree)+"])",this.is_await&&(o="await ($B.promise("+o+"))"),this.assign){for(var l=$get_scope(this);l.is_comp;)l=l.parent_block;if(l.globals&&l.globals.has(this.assign.value))for(;l.parent_block&&"__builtins__"!==l.parent_block.id;)l=l.parent_block;else l.nonlocals&&l.nonlocals[this.assign.value]&&(l=l.parent_block);o="($locals_"+l.id.replace(/\./g,"_")+'["'+this.assign.value+'"] = '+o+")"}return o};var $ExprNot=$B.parser.$ExprNot=function(n){this.type="expr_not",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ExprNot.prototype.transition=function(n,o){var l=this;if("in"==n)return l.parent.tree.pop(),new $AbstractExprCtx(new $OpCtx(l.parent,"not_in"),!1);$_SyntaxError(l,"token "+n+" after "+l)},$ExprNot.prototype.toString=function(){return"(expr_not)"};var $ForExpr=$B.parser.$ForExpr=function(n){n.node.parent.is_comp&&(n.node.parent.first_for=this),this.type="for",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.loop_num=$loop_num,this.scope=$get_scope(this),this.module=this.scope.module,$loop_num++};$ForExpr.prototype.toString=function(){return"(for) "+this.tree},$ForExpr.prototype.transition=function(n,o){var l=this;switch(n){case"in":return 0==l.tree[0].tree.length&&$_SyntaxError(l,"missing target between 'for' and 'in'"),new $AbstractExprCtx(new $ExprCtx(l,"target list",!0),!1);case":":return(l.tree.length<2||"abstract_expr"==l.tree[1].tree[0].type)&&$_SyntaxError(l,"token "+n+" after "+l),$BodyCtx(l)}$_SyntaxError(l,"token "+n+" after "+l)},$ForExpr.prototype.transform=function(n,o){for(var l=this.parent.node.parent;l;){if(l.is_comp){var x=$get_module(this);void 0===x.outermost_expr&&(l.outermost_expr=this.tree[1],x.outermost_expr=this.tree[1],this.tree.pop(),new $RawJSCtx(this,"expr"));break}l=l.parent}if(this.async)return this.transform_async(n,o);var B=$get_scope(this),D=this.tree[0],G=1==D.tree.length&&"id"==D.expect,M=this.tree[1],P=this.loop_num,fe="$locals_"+B.id.replace(/\./g,"_"),ye="\n"+" ".repeat(n.indent+4),ne=!1;if(1==D.tree.length&&!B.blurred&&"id"!=D.expct&&"expr"==M.type&&"expr"==M.tree[0].type&&"call"==M.tree[0].tree[0].type){var ue=M.tree[0].tree[0];"id"==ue.func.type&&"range"==ue.func.value&&ue.tree.length<3&&ue.tree.length>0&&(ne=ue)}var me=[],ie=0,W=n.children;if(ne){this.has_break&&(Bt=new $Node,new $NodeJSCtx(Bt,fe+'["$no_break'+P+'"] = true'),me[ie++]=Bt);for(var Q,A=$get_scope(this),R=[];A.binding.range&&R.push(A.id),A.parent_block;)A=A.parent_block;Q=1==R.length&&"__builtins__"==R[0];var X=new $Node;X.module=n.parent.module,new $NodeJSCtx(X,Q?"if(1)":"if("+ue.func.to_js()+" === _b_.range)"),me[ie++]=X;var he=D.to_js(),z=!1;if(1==ne.tree.length){if("int"==(be=ne.tree[0].tree[0]).tree[0].type&&0<(be=parseInt(be.to_js()))<$B.max_int){z=!0;var Le="$i"+$B.UUID();(je=$NodeJS("for (var "+Le+" = 0; "+Le+" < "+be+"; "+Le+"++)")).add($NodeJS(he+" = "+Le))}var K=0,be=ne.tree[0].to_js()}else K=ne.tree[0].to_js(),be=ne.tree[1].to_js();if(!z){var Ne="var $stop_"+P+" = $B.int_or_bool("+be+"),"+ye+"        $next"+P+" = "+K+","+ye+"        $safe"+P+" = typeof $next"+P+' == "number" && typeof $stop_'+P+' == "number";'+ye+"    while(true)",je=new $Node;new $NodeJSCtx(je,Ne),je.add($NodeJS("if($safe"+P+" && $next"+P+">= $stop_"+P+"){break}")),je.add($NodeJS("else if(!$safe"+P+" && $B.ge($next"+P+", $stop_"+P+")){break}")),je.add($NodeJS(he+" = $next"+P)),je.add($NodeJS("if($safe"+P+"){$next"+P+" += 1}")),je.add($NodeJS("else{$next"+P+" = $B.add($next"+P+",1)}"))}W.forEach(function(On){je.add(On.clone_tree())}),"return"!=$B.last(n.children).C.tree[0].type&&je.add($NodeJS(Ne='$locals.$line_info = "'+n.line_num+","+this.module+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;'));var Te=!1;if("module"==B.ntype)for(l=n.parent;l;){if(l.for_wrapper){Te=!0;break}l=l.parent}if("module"!=B.ntype||Te)X.add(je);else{var qe=new $Node;qe.for_wrapper=!0,Ne="function $f"+P+"(",this.has_break&&(Ne+="$no_break"+P),new $NodeJSCtx(qe,Ne+=")"),X.add(qe),qe.add(je),this.has_break&&qe.add($NodeJS("return $no_break"+P)),X.add($NodeJS("var $res"+P+" = $f"+P+"();")),this.has_break&&X.add($NodeJS("var $no_break"+P+" = $res"+P))}if(Q){n.parent.children.splice(o,1);var Ke=0;return this.has_break&&(n.parent.insert(o,me[0]),Ke++),me[Ke].children.forEach(function(On){n.parent.insert(o+Ke,On)}),n.parent.children[o].line_num=n.line_num,n.parent.children[o].bindings=n.bindings,n.children=[],0}var vt=$NodeJS("else");me[ie++]=vt;for(var ht=me.length-1;ht>=0;ht--)n.parent.insert(o+1,me[ht]);this.test_range=!0,me=[],ie=0}var Bt=new $Node;Bt.line_num=$get_node(this).line_num;var wt=M.to_js(),Ft="$iter"+P;new $NodeJSCtx(Bt,Ne="var "+Ft+" = "+wt+';$locals["$next'+P+'"] = $B.$getattr($B.$iter('+Ft+'),"__next__")'),me[ie++]=Bt,this.has_break&&(me[ie++]=$NodeJS(fe+'["$no_break'+P+'"] = true;'));var Ot=new $Node;if(new $NodeJSCtx(Ot,Ne=this.has_break?"while("+fe+'["$no_break'+P+'"])':"while(true)"),Ot.C.loop_num=P,Ot.C.type="for",me[ie++]=Ot,n.parent.children.splice(o,1),this.test_range)for(ht=me.length-1;ht>=0;ht--)vt.insert(0,me[ht]);else for(ht=me.length-1;ht>=0;ht--)n.parent.insert(o,me[ht]);var on=$NodeJS("try");on.bindings=n.bindings,Ot.add(on);var ft=new $Node;ft.id=this.module;var An=new $NodeCtx(ft),Cn=new $ExprCtx(An,"left",!0);if(G){var fn=new $ListOrTupleCtx(Cn);fn.real="tuple",fn.tree=D.tree}else Cn.tree=D.tree;return new $AssignCtx(Cn).tree[1]=new $JSCode('$locals["$next'+P+'"]()'),on.add(ft),Ot.add($NodeJS("catch($err){if($B.is_exc($err, [_b_.StopIteration])){break;}else{throw($err)}}")),W.forEach(function(On){Ot.add(On.clone())}),0==n.children.length&&console.log("bizarre",this),"return"!=$B.last(n.children).C.tree[0].type&&Ot.add($NodeJS(Ne='$locals.$line_info = "'+n.line_num+","+this.module+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;')),n.children=[],0},$ForExpr.prototype.transform_async=function(n,o){var l=$get_scope(this),x=this.tree[0],B=this.tree[1],D=this.loop_num,G=(l.id.replace(/\./g,"_")," ".repeat(n.indent+4),[]),M="$iter"+D,P="$type"+D,fe="$running"+D,ye="$anext"+D,ne="var "+M+" = "+B.to_js();G.push($NodeJS(ne)),G.push($NodeJS("var "+P+" = _b_.type.$factory( "+M+")")),G.push($NodeJS(ne=M+" = $B.$call($B.$getattr("+P+', "__aiter__"))('+M+")")),G.push($NodeJS("var "+fe+" = true")),G.push($NodeJS("var "+ye+" = $B.$call($B.$getattr("+P+', "__anext__"))'));var ue=$NodeJS("while("+fe+")");G.push(ue);var me=$NodeJS("try");if(ue.add(me),1==x.tree.length)ne=x.to_js()+" = await ($B.promise("+ye+"("+M+")))",me.add($NodeJS(ne));else{var ie=new $Node,W=new $NodeCtx(ie),Q=new $ExprCtx(W,"left",!1);Q.tree.push(x),x.parent=Q;var A=new $AssignCtx(Q);new $RawJSCtx(A,"await ($B.promise("+ye+"("+M+")))"),me.add(ie)}var R=$NodeJS("catch(err)");ue.add(R),R.add($NodeJS(ne="if(err.__class__ === _b_.StopAsyncIteration){"+fe+" = false; continue}else{throw err}")),n.children.forEach(function(he){ue.add(he)}),n.parent.children.splice(o,1);for(var X=G.length-1;X>=0;X--)n.parent.insert(o,G[X]);return n.children=[],0},$ForExpr.prototype.to_js=function(){this.js_processed=!0;var n=this.tree.pop();return"for ("+$to_js(this.tree)+" in "+n.to_js()+")"};var $FromCtx=$B.parser.$FromCtx=function(n){this.type="from",this.parent=n,this.module="",this.names=[],n.tree[n.tree.length]=this,this.expect="module",this.scope=$get_scope(this)};$FromCtx.prototype.add_name=function(n){this.names[this.names.length]=n,"*"==n&&(this.scope.blurred=!0)},$FromCtx.prototype.bind_names=function(){var n=$get_scope(this);this.names.forEach(function(o){Array.isArray(o)&&(o=o[1]),$bind(o,n,this)},this)},$FromCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.add_name(o),l.expect=",",l;if("alias"==l.expect)return l.names[l.names.length-1]=[$B.last(l.names),o],l.expect=",",l;case".":if("module"==l.expect)return l.module+="id"==n?o:".",l;case"import":if("module"==l.expect)return l.expect="id",l;case"op":if("*"==o&&"id"==l.expect&&0==l.names.length)return"module"!==$get_scope(l).ntype&&$_SyntaxError(l,["import * only allowed at module level"]),l.add_name("*"),l.expect="eol",l;case",":if(","==l.expect)return l.expect="id",l;case"eol":switch(l.expect){case",":case"eol":return l.bind_names(),$transition(l.parent,n);case"id":$_SyntaxError(l,["trailing comma not allowed without surrounding parentheses"]);default:$_SyntaxError(l,["invalid syntax"])}case"as":if(","==l.expect||"eol"==l.expect)return l.expect="alias",l;case"(":if("id"==l.expect)return l.expect="id",l;case")":if(","==l.expect||"id"==l.expect)return l.expect="eol",l}$_SyntaxError(l,"token "+n+" after "+l)},$FromCtx.prototype.toString=function(){return"(from) "+this.module+" (import) "+this.names},$FromCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=$get_module(this),l=o.module,x=[],B=0,D=$get_node(this).indent,G=" ".repeat(D);if(l.startsWith("$exec")){var M=$B.last($B.frames_stack)[1];M.module&&M.module.__name__&&(l=M.module.__name__)}for(var P=this.module.split("."),fe=0;fe<P.length;fe++)o.imports[P.slice(0,fe+1).join(".")]=!0;for(var ye,ne=this.module.replace(/\$/g,""),ue=[];ne.length>0&&"."==ne.charAt(0);){if(void 0===ye?void 0!==$B.imported[l]&&(ue=(ye=$B.imported[l].__package__).split(".")):(ye=$B.imported[ye],ue.pop()),void 0===ye)return"throw _b_.SystemError.$factory(\"Parent module '' not loaded, cannot perform relative import\")";"None"==ye&&console.log("package is None !"),ne=ne.substr(1)}ne&&ue.push(ne),this.module=ue.join(".");var me=this.module.replace(/\$/g,"");x[B++]='var module = $B.$import("',x[B++]=me+'",["';for(var ie=[],W=(fe=0,this.names.length);fe<W;fe++)Array.isArray(this.names[fe])?ie.push(this.names[fe][0]):ie.push(this.names[fe]);x[B++]=ie.join('","')+'"], {';var Q="";for(var A in this.aliases)x[B++]=Q+'"'+A+'": "'+this.aliases[A]+'"',Q=",";return x[B++]="}, {}, true);","*"==this.names[0]?(n.blurred=!0,x[B++]="\n"+G+"$B.import_all($locals, module);"):this.names.forEach(function(R){var X=R;Array.isArray(R)&&(X=R[1],R=R[0]),o.imports[this.module+"."+R]=!0,x[B++]="\n"+G+'$locals["'+X+'"] = $B.$getattr($B.imported["'+me+'"], "'+R+'");'},this),x[B++]="\n"+G+"_b_.None;",x.join("")};var $FuncArgs=$B.parser.$FuncArgs=function(n){this.type="func_args",this.parent=n,this.tree=[],this.names=[],n.tree[n.tree.length]=this,this.expect="id",this.has_default=!1,this.has_star_arg=!1,this.has_kw_arg=!1};$FuncArgs.prototype.toString=function(){return"func args "+this.tree},$FuncArgs.prototype.transition=function(n,o){var l=this;switch(n){case"id":return l.has_kw_arg&&$_SyntaxError(l,"duplicate keyword argument"),"id"==l.expect&&(l.expect=",",l.names.indexOf(o)>-1&&$_SyntaxError(l,["duplicate argument "+o+" in function definition"])),new $FuncArgIdCtx(l,o);case",":if(","==l.expect)return l.expect="id",l;$_SyntaxError(l,"token "+n+" after "+l);case")":var x=$B.last(l.tree);return x&&"func_star_arg"==x.type&&"*"==x.name&&$_SyntaxError(l,"*"==l.op?["named arguments must follow bare *"]:"invalid syntax"),l.parent;case"op":l.has_kw_arg&&$_SyntaxError(l,"duplicate keyword argument");var B=o;if(l.expect=",","*"==B)return l.has_star_arg&&$_SyntaxError(l,"duplicate star argument"),new $FuncStarArgCtx(l,"*");if("**"==B)return new $FuncStarArgCtx(l,"**");if("/"==B)return l.has_end_positional?$_SyntaxError(l,["duplicate / in function parameters"]):l.has_star_arg&&$_SyntaxError(l,["/ after * in function parameters"]),new $EndOfPositionalCtx(l);$_SyntaxError(l,"token "+B+" after "+l);case":":if("lambda"==l.parent.type)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$FuncArgs.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $FuncArgIdCtx=$B.parser.$FuncArgIdCtx=function(n,o){this.type="func_arg_id",this.name=o,this.parent=n,n.has_star_arg?n.parent.after_star.push(o):n.parent.positional_list.push(o);var l=$get_node(this);l.binding[o]&&$_SyntaxError(n,["duplicate argument '"+o+"' in function definition"]),$bind(o,l,this),this.tree=[],n.tree[n.tree.length]=this;for(var x=n;void 0!==x.parent;){if("def"==x.type){x.locals.push(o);break}x=x.parent}this.expect="="};$FuncArgIdCtx.prototype.toString=function(){return"func arg id "+this.name+"="+this.tree},$FuncArgIdCtx.prototype.transition=function(n,o){var l=this;switch(n){case"=":if("="==l.expect){l.has_default=!0;var x=l.parent.parent;return x.default_list.push(l.parent.has_star_arg?x.after_star.pop():x.positional_list.pop()),new $AbstractExprCtx(l,!1)}break;case",":case")":if(!l.parent.has_default||0!=l.tree.length||void 0!==l.parent.has_star_arg)return $transition(l.parent,n);$pos-=l.name.length,$_SyntaxError(l,["non-default argument follows default argument"]);case":":return"lambda"==l.parent.parent.type?$transition(l.parent.parent,":"):(l.has_default&&$_SyntaxError(l,"token "+n+" after "+l),new $AbstractExprCtx(new $AnnotationCtx(l),!1))}$_SyntaxError(l,"token "+n+" after "+l)},$FuncArgIdCtx.prototype.to_js=function(){return this.js_processed=!0,this.name+$to_js(this.tree)};var $FuncStarArgCtx=$B.parser.$FuncStarArgCtx=function(n,o){this.type="func_star_arg",this.op=o,this.parent=n,this.node=$get_node(this),n.has_star_arg="*"==o,n.has_kw_arg="**"==o,n.tree[n.tree.length]=this};$FuncStarArgCtx.prototype.toString=function(){return"(func star arg "+this.op+") "+this.name},$FuncStarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return void 0===l.name&&l.parent.names.indexOf(o)>-1&&$_SyntaxError(l,["duplicate argument "+o+" in function definition"]),l.set_name(o),l.parent.names.push(o),l;case",":case")":return void 0===l.name&&(l.set_name("*"),l.parent.names.push("*")),$transition(l.parent,n);case":":return"lambda"==l.parent.parent.type?$transition(l.parent.parent,":"):(void 0===l.name&&$_SyntaxError(l,"annotation on an unnamed parameter"),new $AbstractExprCtx(new $AnnotationCtx(l),!1))}$_SyntaxError(l,"token "+n+" after "+l)},$FuncStarArgCtx.prototype.set_name=function(n){this.name=n,this.node.binding[n]&&$_SyntaxError(C,["duplicate argument '"+n+"' in function definition"]),$bind(n,this.node,this);for(var o=this.parent;void 0!==o.parent;){if("def"==o.type){o.locals.push(n);break}o=o.parent}"*"==this.op?o.other_args='"'+n+'"':o.other_kw='"'+n+'"'};var $GlobalCtx=$B.parser.$GlobalCtx=function(n){for(this.type="global",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id",this.scope=$get_scope(this),this.scope.globals=this.scope.globals||new Set,this.module=$get_module(this);this.module.module!=this.module.id;)this.module=this.module.parent_block;this.module.binding=this.module.binding||{}};$GlobalCtx.prototype.toString=function(){return"global "+this.tree},$GlobalCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $IdCtx(l,o),l.add(o),l.expect=",",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"eol":if(","==l.expect)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$GlobalCtx.prototype.add=function(n){this.scope.annotations&&this.scope.annotations.has(n)&&$_SyntaxError(C,["annotated name '"+n+"' can't be global"]),this.scope.globals.add(n);var o=this.scope.parent_block;if(this.module.module.startsWith("$exec"))for(;o&&o.parent_block!==this.module;)o._globals=o._globals||{},o._globals[n]=this.module.id,delete o.binding[n],o=o.parent_block;this.module.binding[n]=!0},$GlobalCtx.prototype.to_js=function(){return this.js_processed=!0,""};var $IdCtx=$B.parser.$IdCtx=function(n,o){this.type="id",this.value=$mangle(o,n),this.parent=n,this.tree=[],n.tree[n.tree.length]=this;var l=this.scope=$get_scope(this);this.blurred_scope=this.scope.blurred,this.env=clone(this.scope.binding),["def","generator"].indexOf(l.ntype)>-1&&(l.referenced=l.referenced||{},$B.builtins[this.value]||(l.referenced[this.value]=!0)),"call_arg"==n.parent.type&&(this.call_arg=!0);for(var x=n;void 0!==x.parent;){switch(x.type){case"ctx_manager_alias":$bind(o,l,this);break;case"list_or_tuple":case"dict_or_set":case"call_arg":case"def":case"lambda":void 0===x.vars?x.vars=[o]:-1==x.vars.indexOf(o)&&x.vars.push(o),this.call_arg&&"lambda"==x.type&&(void 0===x.locals?x.locals=[o]:x.locals.push(o))}x=x.parent}if($parent_match(n,{type:"target_list"})&&(this.no_bindings=!0,$bind(o,l,this),this.bound=!0),["def","generator"].indexOf(l.ntype)>-1){for(var B=this.parent;B;){if("list_or_tuple"==B.type&&B.is_comp()){this.in_comp=!0;break}B=B.parent}"expr"==n.type&&"comp_if"==n.parent.type||"global"==n.type&&(void 0===l.globals?l.globals=new Set([o]):l.globals.add(o))}};$IdCtx.prototype.toString=function(){return"(id) "+this.value+":"+(this.tree||"")},$IdCtx.prototype.transition=function(n,o){var l=this;switch(n){case"=":return"expr"==l.parent.type&&void 0!==l.parent.parent&&"call_arg"==l.parent.parent.type?new $AbstractExprCtx(new $KwArgCtx(l.parent),!1):$transition(l.parent,n,o);case"op":return $transition(l.parent,n,o);case"id":case"str":case"int":case"float":case"imaginary":["print","exec"].indexOf(l.value)>-1&&$_SyntaxError(l,["missing parenthesis in call to '"+l.value+"'"]),$_SyntaxError(l,"token "+n+" after "+l)}return"packed"==this.parent.parent.type&&-1==[".","[","("].indexOf(n)?this.parent.parent.transition(n,o):$transition(l.parent,n,o)},$IdCtx.prototype.firstBindingScopeId=function(){for(var n=this.scope;n;){if(n.globals&&n.globals.has(this.value))return $get_module(this).id;if(n.binding&&n.binding[this.value])return n.id;n=n.parent}},$IdCtx.prototype.boundBefore=function(n){for(var o=$get_node(this);o.parent;){var l=o.parent;if(l.bindings&&l.bindings[this.value])return l.bindings[this.value];for(var x=0;x<l.children.length;x++){var B=l.children[x];if(B===o)break;if(B.bindings&&B.bindings[this.value])return B.bindings[this.value]}if(l===n)break;o=l}return!1},$IdCtx.prototype.bindingType=function(n){for(var o,l,x=0,B=$get_node(this),D=!1;!D&&B.parent&&x++<100;){var G=B.parent;if(G.bindings&&G.bindings[this.value])return G.bindings[this.value];for(var M=0;M<G.children.length;M++){var P=G.children[M];if(P===B)break;P.bindings&&P.bindings[this.value]&&(D=P.bindings[this.value],l=M)}if(D){for(var fe=l+1;fe<G.children.length;fe++){if((P=G.children[fe]).children.length>0){o=!0;break}if(P===B)break}return o||D}if(G===n)break;B=G}return D},$IdCtx.prototype.to_js=function(n){if(void 0!==this.result&&"generator"==this.scope.ntype)return this.result;var o=this.value;if("__BRYTHON__"==o||"$B"==o)return o;if(o.startsWith("comp_result_"+$B.lambda_magic))return this.bound?"var "+o:o;if(this.js_processed=!0,this.scope._globals&&this.scope._globals[o]&&(this.global_module=this.scope._globals[o]),this.global_module)return"$locals_"+this.global_module.replace(/\./g,"_")+'["'+o+'"]';var l=void 0!==this.scope.binding[o],x=$get_node(this),B=x.bound_before;if(this.nonlocal=this.scope.nonlocals&&void 0!==this.scope.nonlocals[o],this.unbound=this.unbound||l&&!this.bound&&B&&-1==B.indexOf(o),!this.bound&&this.scope.C&&"class"==this.scope.ntype&&this.scope.C.tree[0].name==o)return'$B.$search("'+o+'")';if(this.unbound&&!this.nonlocal)return"def"==this.scope.ntype||"generator"==this.scope.ntype?'$B.$local_search("'+o+'")':'$B.$search("'+o+'")';for(var D=$get_scope(this),G=D,M=[],P=['"'+D.id+'"'],fe=D;;){if(fe.parent_block){if(fe.parent_block==$B.builtins_scope||void 0===fe.parent_block.id)break;fe=fe.parent_block}P.push('"'+fe.id+'"')}if(P="["+P.join(", ")+"]",D.globals&&D.globals.has(o)&&(P=['"'+fe.id+'"'],D=fe),this.nonlocal||this.bound){var ye=this.firstBindingScopeId();if(void 0!==ye)return"$locals_"+ye.replace(/\./g,"_")+'["'+o+'"]';if(this.bound)return"$locals_"+D.id.replace(/\./g,"_")+'["'+o+'"]'}for(var ne="$locals_"+fe.id.replace(/\./g,"_");;){if(void 0!==G.globals&&G.globals.has(o))return this.boundBefore(fe)||this.augm_assign?ne+'["'+o+'"]':'$B.$global_search("'+o+'", '+P+")";if(G===D){if(B)(B.indexOf(o)>-1||G.C&&"def"==G.C.tree[0].type&&G.C.tree[0].env.indexOf(o)>-1)&&M.push(G);else if(G.binding[o]){if(void 0!==x.locals[o]){M.push(G);break}G.is_comp||G.parent_block&&G.parent_block.is_comp||M.push(G)}}else void 0===G.binding&&console.log("scope",G,o,"no binding",D),G.binding[o]&&M.push(G);if(!G.parent_block)break;G=G.parent_block}if(this.found=M,this.nonlocal&&M[0]===D&&M.shift(),M.length>0){if(M[0].C&&M[0]===D&&"$"!=o.charAt(0)){var ue=x.locals||{},me=D.nonlocals;try{if(void 0===ue[o]&&!this.augm_assign&&("def"!=D.type||"generator"!=D.type)&&"class"!=D.ntype&&D.C.tree[0].args&&-1==D.C.tree[0].args.indexOf(o)&&(void 0===me||void 0===me[o]))return this.result='$B.$local_search("'+o+'")',this.result}catch(R){throw console.log("error",o,D),R}}if(M.length>1&&M[0].C&&"class"==M[0].C.tree[0].type){var ie="$locals_"+M[0].id.replace(/\./g,"_"),W="$locals_"+M[1].id.replace(/\./g,"_");if(B)return B.indexOf(o)>-1?(this.found=M[0].binding[o],Q=ie):(this.found=M[1].binding[o],Q=W),this.result=Q+'["'+o+'"]',this.result;this.found=!1;var Q=ie+'["'+o+'"] !== undefined ? ';return this.result="("+(Q+=ie+'["'+o+'"] : ')+W+'["'+o+'"])',this.result}this.found=(G=M[0]).binding[o];var A="$locals_"+G.id.replace(/\./g,"_");if(void 0===G.C)if("__builtins__"==G.id)fe.blurred?o="("+ne+'["'+o+'"] || _b_.'+o+")":(o="_b_."+o,this.is_builtin=!0);else if(this.bound||this.augm_assign)o=A+'["'+o+'"]';else{if(G===D&&void 0===this.env[o])return this.result='$B.$search("'+o+'")',this.result;o=this.boundBefore(G)?A+'["'+o+'"]':'$B.$check_def("'+o+'",'+A+'["'+o+'"])'}else o=G===D?G.globals&&G.globals.has(o)?ne+'["'+o+'"]':this.bound||this.augm_assign||this.boundBefore(G)?'$locals["'+o+'"]':'$B.$check_def_local("'+o+'",$locals["'+o+'"])':this.augm_assign?A+'["'+o+'"]':'$B.$check_def_free("'+o+'",'+A+'["'+o+'"])';return this.result=o+$to_js(this.tree,""),this.result}return this.unknown_binding=!0,this.result='$B.$global_search("'+o+'", '+P+")",this.result};var $ImportCtx=$B.parser.$ImportCtx=function(n){this.type="import",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id"};$ImportCtx.prototype.toString=function(){return"import "+this.tree},$ImportCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $ImportedModuleCtx(l,o),l.expect=",",l;if("qual"==l.expect)return l.expect=",",l.tree[l.tree.length-1].name+="."+o,l.tree[l.tree.length-1].alias+="."+o,l;if("alias"==l.expect)return l.expect=",",l.tree[l.tree.length-1].alias=o,l;break;case".":if(","==l.expect)return l.expect="qual",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"as":if(","==l.expect)return l.expect="alias",l;break;case"eol":if(","==l.expect)return l.bind_names(),$transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$ImportCtx.prototype.bind_names=function(){var n=$get_scope(this);this.tree.forEach(function(o){if(o.name==o.alias){var l=o.name,x=l.split("."),B=l;x.length>1&&(B=x[0])}else B=o.alias;$bind(B,n,this)},this)},$ImportCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=[],l=$get_module(this);return this.tree.forEach(function(x){for(var B=x.name,D=x.name==x.alias?"{}":'{"'+B+'" : "'+x.alias+'"}',G="$locals_"+n.id.replace(/\./g,"_"),M=x.name.split("."),P=0;P<M.length;P++)l.imports[M.slice(0,P+1).join(".")]=!0;o.push('$B.$import("'+B+'", [],'+D+","+G+", true);")}),o.join("")+"_b_.None;"};var $ImportedModuleCtx=$B.parser.$ImportedModuleCtx=function(n,o){this.type="imported module",this.parent=n,this.name=o,this.alias=o,n.tree[n.tree.length]=this};$ImportedModuleCtx.prototype.toString=function(){return" (imported module) "+this.name},$ImportedModuleCtx.prototype.transition=function(n,o){},$ImportedModuleCtx.prototype.to_js=function(){return this.js_processed=!0,'"'+this.name+'"'};var $JSCode=$B.parser.$JSCode=function(n){this.js=n};$JSCode.prototype.toString=function(){return this.js},$JSCode.prototype.transition=function(n,o){},$JSCode.prototype.to_js=function(){return this.js_processed=!0,this.js};var $KwArgCtx=$B.parser.$KwArgCtx=function(n){this.type="kwarg",this.parent=n.parent,this.tree=[n.tree[0]],n.parent.tree.pop(),n.parent.tree.push(this),n.parent.parent.has_kw=!0;var o=this.tree[0].value,l=n.parent.parent;void 0===l.kwargs?l.kwargs=[o]:-1==l.kwargs.indexOf(o)?l.kwargs.push(o):$_SyntaxError(n,["keyword argument repeated"])};$KwArgCtx.prototype.toString=function(){return"kwarg "+this.tree[0]+"="+this.tree[1]},$KwArgCtx.prototype.transition=function(n,o){return","==n?new $CallArgCtx(this.parent.parent):$transition(this.parent,n)},$KwArgCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.tree[0].value;return"$$"==n.substr(0,2)&&(n=n.substr(2)),'{$nat:"kw",name:"'+n+'",value:'+$to_js(this.tree.slice(1,this.tree.length))+"}"};var $LambdaCtx=$B.parser.$LambdaCtx=function(n){this.type="lambda",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.args_start=$pos+6,this.vars=[],this.locals=[],this.node=$get_node(this),this.node.binding={},this.positional_list=[],this.default_list=[],this.other_args=null,this.other_kw=null,this.after_star=[]};$LambdaCtx.prototype.toString=function(){return"(lambda) "+this.args_start+" "+this.body_start},$LambdaCtx.prototype.transition=function(n,o){var l=this;return":"==n&&void 0===l.args?(l.args=l.tree,l.tree=[],l.body_start=$pos,new $AbstractExprCtx(l,!1)):void 0!==l.args?(l.body_end=$pos,$transition(l.parent,n)):void 0===l.args&&"("!=n?$transition(new $FuncArgs(l),n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$LambdaCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.parent,o=this.node,l=$get_module(this),x=$get_src(n),B=x.substring(this.args_start,this.body_start),D=x.substring(this.body_start+1,this.body_end);D=(D=D.replace(/\\\n/g," ")).replace(/\n/g," ");var G=$get_scope(this),M=$B.UUID(),P="lambda_"+$B.lambda_magic+"_"+M,fe="def "+P+"("+B+"):";fe+="    return "+D;var ye="lambda"+M,ne=l.id.replace(/\./g,"_"),ue=$B.py2js(fe,ne,ye,G,o.line_num).to_js(),me=`$locals_${ye}`;return B="{}",l.is_comp&&(me+=`,$locals_${l.id.replace(/\./g,"_")}`,B+=`,typeof $locals_${l.id.replace(/\./g,"_")}==="undefined" ?{}:$locals_${l.id.replace(/\./g,"_")}`),ue=`(function(${me}){\n`+ue+`\nreturn $locals.${P}})(${B})`,$B.clear_ns(ye),$B.$py_src[ye]=null,delete $B.$py_src[ye],ue};var $ListOrTupleCtx=$B.parser.$ListOrTupleCtx=function(n,o){this.type="list_or_tuple",this.start=$pos,this.real=o,this.expect="id",this.closed=!1,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ListOrTupleCtx.prototype.toString=function(){switch(this.real){case"list":return"(list) ["+this.tree+"]";case"list_comp":case"gen_expr":return"("+this.real+") ["+this.intervals+"-"+this.tree+"]";default:return"(tuple) ("+this.tree+")"}},$ListOrTupleCtx.prototype.transition=function(n,o){var l=this;if(l.closed)return"["==n?new $AbstractExprCtx(new $SubCtx(l.parent),!1):"("==n?new $CallCtx(l.parent):$transition(l.parent,n,o);if(","==l.expect){switch(l.real){case"tuple":case"gen_expr":if(")"==n){for(var x=!0;"list_or_tuple"==l.type&&"tuple"==l.real&&"expr"==l.parent.type&&"node"==l.parent.parent.type&&1==l.tree.length;){x=!1;var B=l.parent.parent,D=B.tree.indexOf(l.parent);(P=l.tree[0]).parent=B,P.$in_parens=!0,B.tree.splice(D,1,P),l=P.tree[0]}if(x&&l.close(),"gen_expr"==l.real){if(l.expression.yields)for(const fe of l.expression.yields)$pos=fe[1],$_SyntaxError(l,["'yield' inside generator expression"]);l.intervals.push($pos)}return"packed"==l.parent.type?l.parent.parent:"abstract_expr"==l.parent.type&&l.parent.assign?(l.parent.parent.tree.pop(),(P=new $ExprCtx(l.parent.parent,"assign",!1)).tree=l.parent.tree,P.tree[0].parent=P,P.assign=l.parent.assign,P):l.parent}break;case"list":case"list_comp":if("]"==n){if(l.close(),"list_comp"==l.real){if(l.expression.yields)for(const fe of l.expression.yields)$pos=fe[1],$_SyntaxError(l,["'yield' inside list comprehension"]);l.intervals.push($pos)}return"packed"==l.parent.type?l.parent.tree.length>0?l.parent.tree[0]:l.parent.parent:l.parent}break;case"dict_or_set_comp":if("}"==n){if(l.expression.yields)for(const fe of l.expression.yields)$pos=fe[1],$_SyntaxError(l,[`'yield' inside ${"set_comp"==l.parent.real?"set":"dict"}comprehension`]);return l.intervals.push($pos),$transition(l.parent,n)}}switch(n){case",":return"tuple"==l.real&&(l.has_comma=!0),l.expect="id",l;case"for":"list"==l.real?(this.tree.length>1&&$_SyntaxError(l,"unparenthesized expression before 'for'"),l.real="list_comp"):l.real="gen_expr",l.intervals=[l.start+1],l.expression=l.tree,l.yields&&(l.expression.yields=l.yields,delete l.yields),l.tree=[];var M=new $ComprehensionCtx(l);return new $TargetListCtx(new $CompForCtx(M))}return $transition(l.parent,n,o)}if("id"!=l.expect)return $transition(l.parent,n,o);switch(l.real){case"tuple":if(")"==n)return l.close(),l.parent;if("eol"==n&&!0===l.implicit)return l.close(),$transition(l.parent,n);break;case"gen_expr":if(")"==n)return l.close(),$transition(l.parent,n);break;case"list":if("]"==n)return l.close(),l}switch(n){case"=":if("tuple"==l.real&&!0===l.implicit)return l.close(),l.parent.tree.pop(),(P=new $ExprCtx(l.parent,"tuple",!1)).tree=[l],l.parent=P,$transition(l.parent,n);break;case")":break;case"]":if("tuple"==l.real&&!0===l.implicit)return $transition(l.parent,n,o);break;case",":$_SyntaxError(l,"unexpected comma inside list");default:l.expect=",";var P=new $AbstractExprCtx(l,!1);return $transition(P,n,o)}},$ListOrTupleCtx.prototype.close=function(){this.closed=!0;for(var n=0,o=this.tree.length;n<o;n++){var l=this.tree[n];"expr"==l.type&&"list_or_tuple"==l.tree[0].type&&"tuple"==l.tree[0].real&&1==l.tree[0].tree.length&&","==l.tree[0].expect&&(this.tree[n]=l.tree[0].tree[0],this.tree[n].parent=this)}},$ListOrTupleCtx.prototype.is_comp=function(){switch(this.real){case"list_comp":case"gen_expr":case"dict_or_set_comp":return!0}return!1},$ListOrTupleCtx.prototype.get_src=function(){var n=$get_module(this).src,o=$get_scope(this);return void 0===o.comments||o.comments.forEach(function(l){var x=l[0],B=l[1];n=n.substr(0,x)+" ".repeat(B+1)+n.substr(x+B+1)}),n},$ListOrTupleCtx.prototype.bind_ids=function(n){this.tree.forEach(function(o){if("id"==o.type)$bind(o.value,n,this),o.bound=!0;else if("expr"==o.type&&"id"==o.tree[0].type)$bind(o.tree[0].value,n,this),o.tree[0].bound=!0;else if("expr"==o.type&&"packed"==o.tree[0].type){var l=o.tree[0].tree[0];"expr"==l.type&&"id"==l.tree[0].type&&($bind(l.tree[0].value,n,this),l.tree[0].bound=!0)}else("list_or_tuple"==o.type||"expr"==o.type&&"list_or_tuple"==o.tree[0].type)&&("expr"==o.type&&(o=o.tree[0]),o.bind_ids(n))},this)},$ListOrTupleCtx.prototype.packed_indices=function(){for(var n=[],o=0;o<this.tree.length;o++){var l=this.tree[o];"expr"==l.type&&("packed"==(l=l.tree[0]).type||"call"==l.type&&"packed"==l.func.type)&&n.push(o)}return n},$ListOrTupleCtx.prototype.unpack=function(n){for(var o,l="",x=0;x<this.tree.length;x++)o=n.indexOf(x)>-1?"_b_.list.$factory("+this.tree[x].to_js()+")":"["+this.tree[x].to_js()+"]",x>0&&(o=".concat("+o+")"),l+=o;return l},$ListOrTupleCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=(n.id.replace(/\//g,"_"),0),l=(A=$get_module(this)).module;switch(this.real){case"list":return(Te=this.packed_indices()).length>0?"$B.$list("+this.unpack(Te)+")":"$B.$list(["+$to_js(this.tree)+"])";case"list_comp":case"gen_expr":case"dict_or_set_comp":for(var x=this.get_src(),B=[],D=[],G=new RegExp('"',"g"),M=A.comments,P=1;P<this.intervals.length;P++){for(var fe=this.intervals[P-1],ye=this.intervals[P],ne=x.substring(fe,ye),ue=M.length-1;ue>=0;ue--){var me=M[ue];me[0]>fe&&me[0]<ye&&(ne=ne.substr(0,o=me[0]-fe)+" ".repeat(me[1])+ne.substr(o+me[1]+1))}ne=ne.replace(/\\\n/g," "),D.push(ne);var ie=ne.split("\n"),W=[];ie.forEach(function(qe){0!=qe.replace(/ /g,"").length&&(qe=(qe=(qe=qe.replace(/\n/g," ")).replace(/\\/g,"\\\\")).replace(G,'\\"'),W.push('"'+qe+'"'))}),B.push("["+W.join(",")+"]")}var Q=$get_node(this).line_num;switch(this.real){case"list_comp":var A,R=$B.$list_comp(D),he=R[1],z="lc"+$B.lambda_magic+he,Le=$pos,be=(A=$B.py2js({src:R[0],is_comp:!0,line_info:Q+","+l},l,z,n,1)).outermost_expr;$get_node(this).has_yield&&(be=this.tree[0].tree[0].tree[1]),void 0===be&&(be=A.first_for.tree[1]);var Ne=be.to_js();$pos=Le;var je=A.to_js();return A=null,$B.clear_ns(z),delete $B.$py_src[z],je=`function(expr){${je+="return $locals_"+z+'["x'+he+'"]'}})(${Ne})`,this.is_await&&(je="async "+je),"("+je;case"dict_or_set_comp":return 1==this.expression.length?$B.$gen_expr(l,n,D,Q,!0):$B.$dict_comp(l,n,D,Q)}return $B.$gen_expr(l,n,D,Q);case"tuple":var Te;return(Te=this.packed_indices()).length>0?"$B.fast_tuple("+this.unpack(Te)+")":1==this.tree.length&&void 0===this.has_comma?this.tree[0].to_js():"$B.fast_tuple(["+$to_js(this.tree)+"])"}};var $NodeCtx=$B.parser.$NodeCtx=function(n){this.node=n,n.C=this,this.tree=[],this.type="node";for(var o=null,l=n;l.parent&&"module"!=l.parent.type;){var x=!1;switch(l.parent.C.tree[0].type){case"def":case"class":case"generator":o=l.parent,x=!0}if(x)break;l=l.parent}null===o&&(o=l.parent||l),this.node.locals=clone(o.binding),this.scope=o};$NodeCtx.prototype.toString=function(){return"node "+this.tree},$NodeCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":case".":var x=new $AbstractExprCtx(l,!0);return $transition(x,n,o);case"op":switch(o){case"*":case"+":case"-":case"~":return x=new $AbstractExprCtx(l,!0),$transition(x,n,o)}break;case"async":return new $AsyncCtx(l);case"await":return new $AbstractExprCtx(new $AwaitCtx(l),!0);case"class":return new $ClassCtx(l);case"continue":return new $ContinueCtx(l);case"__debugger__":return new $DebuggerCtx(l);case"break":return new $BreakCtx(l);case"def":return new $DefCtx(l);case"for":return new $TargetListCtx(new $ForExpr(l));case"if":case"while":return new $AbstractExprCtx(new $ConditionCtx(l,n),!1);case"elif":var B=$previous(l);return-1!=["condition"].indexOf(B.type)&&"while"!=B.token||$_SyntaxError(l,"elif after "+B.type),new $AbstractExprCtx(new $ConditionCtx(l,n),!1);case"else":return B=$previous(l),-1==["condition","except","for"].indexOf(B.type)&&$_SyntaxError(l,"else after "+B.type),new $SingleKwCtx(l,n);case"finally":return B=$previous(l),-1!=["try","except"].indexOf(B.type)||"single_kw"==B.type&&"else"==B.token||$_SyntaxError(l,"finally after "+B.type),new $SingleKwCtx(l,n);case"try":return new $TryCtx(l);case"except":return B=$previous(l),-1==["try","except"].indexOf(B.type)&&$_SyntaxError(l,"except after "+B.type),new $ExceptCtx(l);case"assert":return new $AbstractExprCtx(new $AssertCtx(l),!1,!0);case"from":return new $FromCtx(l);case"import":return new $ImportCtx(l);case"global":return new $GlobalCtx(l);case"nonlocal":return new $NonlocalCtx(l);case"lambda":return new $LambdaCtx(l);case"pass":return new $PassCtx(l);case"raise":return new $AbstractExprCtx(new $RaiseCtx(l),!0);case"return":return new $AbstractExprCtx(new $ReturnCtx(l),!0);case"with":return new $AbstractExprCtx(new $WithCtx(l),!1);case"yield":return new $AbstractExprCtx(new $YieldCtx(l),!0);case"del":return new $AbstractExprCtx(new $DelCtx(l),!0);case"@":return new $DecoratorCtx(l);case",":l.tree&&0==l.tree.length&&$_SyntaxError(l,"token "+n+" after "+l);var D=l.tree[0];l.tree=[];var G=new $ListOrTupleCtx(l);return G.real="tuple",G.implicit=0,G.tree.push(D),D.parent=G,G;case"eol":return 0==l.tree.length?(l.node.parent.children.pop(),l.node.parent.C):l}$_SyntaxError(l,"token "+n+" after "+l)},$NodeCtx.prototype.to_js=function(){if(void 0!==this.js)return this.js;if(this.js_processed=!0,this.tree.length>1){var n=new $Node;new $NodeCtx(n).tree=[this.tree[1]],n.indent=node.indent+4,this.tree.pop(),node.add(n)}if(this.js="",this.tree[0]){var o="def"!=this.scope.ntype;if(this.tree[0].annotation)if(o){if("expr"==this.tree[0].type&&!this.tree[0].$in_parens&&"id"==this.tree[0].tree[0].type){var l="";return this.create_annotations&&(l+="$locals.__annotations__ = $B.empty_dict();"),l+"_b_.dict.$setitem($locals.__annotations__, '"+this.tree[0].tree[0].value+"', "+this.tree[0].annotation.to_js()+");"}"def"==this.tree[0].type?this.js=this.tree[0].annotation.to_js()+";":(this.js="",this.tree=[])}else"def"!=this.tree[0].type&&(this.tree=[]);else if("assign"==this.tree[0].type&&!this.tree[0].tree[0].$in_parens&&this.tree[0].tree[0].annotation){var x=this.tree[0].tree[0],B=this.tree[0].tree[1];if(this.create_annotations&&(this.js+="$locals.__annotations__ = $B.empty_dict();"),this.js+="var $value = "+B.to_js()+";",this.tree[0].tree.splice(1,1),new $RawJSCtx(this.tree[0],"$value"),!x.tree[0]||"id"!=x.tree[0].type||!o)return this.js+=$to_js(this.tree)+";",o&&(this.js+=x.annotation.to_js()),this.js;this.js+="_b_.dict.$setitem($locals.__annotations__, '"+x.tree[0].value+"', "+x.annotation.to_js()+");"}}return this.js+=0==this.node.children.length?$to_js(this.tree)+";":$to_js(this.tree),this.js};var $NodeJS=$B.parser.$NodeJS=function(n){var o=new $Node;return new $NodeJSCtx(o,n),o},$NodeJSCtx=$B.parser.$NodeJSCtx=function(n,o){this.node=n,n.C=this,this.type="node_js",this.tree=[o]};$NodeJSCtx.prototype.toString=function(){return"js "+js},$NodeJSCtx.prototype.to_js=function(){return this.js_processed=!0,this.tree[0]};var $NonlocalCtx=$B.parser.$NonlocalCtx=function(n){this.type="nonlocal",this.parent=n,this.tree=[],this.names={},n.tree[n.tree.length]=this,this.expect="id",this.scope=$get_scope(this),this.scope.nonlocals=this.scope.nonlocals||{},void 0===this.scope.C&&$_SyntaxError(n,["nonlocal declaration not allowed at module level"])};$NonlocalCtx.prototype.toString=function(){return"nonlocal "+this.tree},$NonlocalCtx.prototype.add=function(n){"arg"==this.scope.binding[n]&&$_SyntaxError(C,["name '"+n+"' is parameter and nonlocal"]),this.names[n]=[!1,$pos],this.scope.nonlocals[n]=!0},$NonlocalCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $IdCtx(l,o),l.add(o),l.expect=",",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"eol":if(","==l.expect)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$NonlocalCtx.prototype.transform=function(n,o){var l=this.parent,x=this.scope.parent_block;if(void 0===x.C)$_SyntaxError(l,["no binding for nonlocal '"+$B.last(Object.keys(this.names))+"' found"]);else{for(;void 0!==x&&void 0!==x.C;){for(var B in this.names)void 0!==x.binding[B]&&(this.names[B]=[!0]);x=x.parent_block}for(var B in this.names)this.names[B][0]||(console.log("nonlocal error, C "+l),$pos=this.names[B][1],$_SyntaxError(l,["no binding for nonlocal '"+B+"' found"]))}},$NonlocalCtx.prototype.to_js=function(){return this.js_processed=!0,""};var $NotCtx=$B.parser.$NotCtx=function(n){this.type="not",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$NotCtx.prototype.toString=function(){return"not ("+this.tree+")"},$NotCtx.prototype.transition=function(n,o){var l=this;switch(n){case"in":return l.parent.parent.tree.pop(),new $ExprCtx(new $OpCtx(l.parent,"not_in"),"op",!1);case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o);case"op":if("+"==o||"-"==o||"~"==o)return x=new $AbstractExprCtx(l,!1),$transition(x,n,o)}return $transition(l.parent,n)},$NotCtx.prototype.to_js=function(){return this.js_processed=!0,"!$B.$bool("+$to_js(this.tree)+")"};var $NumberCtx=$B.parser.$NumberCtx=function(n,o,l){this.type=n,this.value=l,this.parent=o,this.tree=[],o.tree[o.tree.length]=this};$NumberCtx.prototype.toString=function(){return this.type+" "+this.value},$NumberCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n,o)},$NumberCtx.prototype.to_js=function(){this.js_processed=!0;var type=this.type,value=this.value;if("int"==type){var v=parseInt(value[1],value[0]);if(v>$B.min_int&&v<$B.max_int)return this.unary_op&&(v=eval(this.unary_op+v)),v;var v=$B.long_int.$factory(value[1],value[0]);switch(this.unary_op){case"-":v=$B.long_int.__neg__(v);break;case"~":v=$B.long_int.__invert__(v)}return'{__class__: $B.long_int, value: "'+v.value+'", pos: '+v.pos+"}"}return"float"==type?/^\d+$/.exec(value)||/^\d+\.\d*$/.exec(value)?"(new Number("+this.value+"))":"_b_.float.$factory("+value+")":"imaginary"==type?"$B.make_complex(0,"+value+")":void 0};var $OpCtx=$B.parser.$OpCtx=function(n,o){if(this.type="op",this.op=o,this.parent=n.parent,this.tree=[n],this.scope=$get_scope(this),"expr"==n.type)if(["int","float","str"].indexOf(n.tree[0].type)>-1)this.left_type=n.tree[0].type;else if("id"==n.tree[0].type){var l=this.scope.binding[n.tree[0].value];l&&(this.left_type=l.type)}n.parent.tree.pop(),n.parent.tree.push(this)};$OpCtx.prototype.toString=function(){return"(op "+this.op+") ["+this.tree+"]"},$OpCtx.prototype.transition=function(n,o){var l=this;if(void 0===l.op&&$_SyntaxError(l,["C op undefined "+l]),"unary"==l.op.substr(0,5)){if("eol"!=n&&("assign"==l.parent.type||"return"==l.parent.type)){l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.tree.push(l),l.parent=x,x}2==l.tree.length&&"expr"==l.tree[1].type&&"int"==l.tree[1].tree[0].type&&(l.parent.tree.pop(),l.parent.tree.push(l.tree[1]),l.tree[1].parent=l.parent,l.tree[1].tree[0].unary_op=l.tree[0].op)}switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case"op":switch(o){case"+":case"-":case"~":return new $UnaryCtx(l,o)}default:"abstract_expr"==l.tree[l.tree.length-1].type&&$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n)},$OpCtx.prototype.to_js=function(){this.js_processed=!0;var n={"==":"eq","!=":"ne",">=":"ge","<=":"le","<":"lt",">":"gt"};if(void 0!==n[this.op]){var o=n[this.op];if("expr"==this.tree[0].type&&"expr"==this.tree[1].type){var l=this.tree[0].tree[0],x=this.tree[1].tree[0],B=l.to_js(),D=x.to_js();switch(x.type){case"int":switch(l.type){case"int":return Number.isSafeInteger(l.value)&&Number.isSafeInteger(x.value)?B+this.op+D:"$B.$getattr("+this.tree[0].to_js()+',"__'+o+'__")('+this.tree[1].to_js()+")";case"str":switch(this.op){case"==":return"false";case"!=":return"true";default:return'$B.$TypeError("unorderable types:  int() '+this.op+' str()")'}case"id":return"(typeof "+B+' == "number" ? '+B+this.op+D+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+"))"}break;case"str":switch(l.type){case"str":return B+this.op+D;case"int":switch(this.op){case"==":return"false";case"!=":return"true";default:return'$B.$TypeError("unorderable types:  str() '+this.op+' int()")'}case"id":return"(typeof "+B+' == "string" ? '+B+this.op+D+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+"))"}break;case"id":if("id"==l.type)return"typeof "+B+'!="object" && typeof '+B+'!="function" && typeof '+B+" == typeof "+D+" ? "+B+this.op+D+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+")"}}}switch(this.op){case"and":var G=this.tree[0].to_js(),M=this.tree[1].to_js();return void 0!==this.wrap?"(function(){var "+this.wrap.name+" = "+this.wrap.js+";return $B.$test_expr($B.$test_item("+G+") && $B.$test_item("+M+"))})()":"$B.$test_expr($B.$test_item("+G+")&&$B.$test_item("+M+"))";case"or":return(X="$B.$test_expr($B.$test_item("+this.tree[0].to_js()+")||")+"$B.$test_item("+this.tree[1].to_js()+"))";case"in":return"$B.$is_member("+$to_js(this.tree)+")";case"not_in":return"!$B.$is_member("+$to_js(this.tree)+")";case"unary_neg":case"unary_pos":case"unary_inv":if("unary_neg"==this.op?(ye="-",o="__neg__"):"unary_pos"==this.op?(ye="+",o="__pos__"):(ye="~",o="__invert__"),"expr"==this.tree[1].type){var P=this.tree[1].tree[0];switch(P.type){case"int":var fe=parseInt(P.value[1],P.value[0]);return Number.isSafeInteger(fe)?ye+fe:"$B.$getattr("+P.to_js()+', "'+o+'")()';case"float":return"_b_.float.$factory("+ye+P.value+")";case"imaginary":return"$B.make_complex(0,"+ye+P.value+")"}}return"$B.$getattr("+this.tree[1].to_js()+',"'+o+'")()';case"is":return"$B.$is("+this.tree[0].to_js()+", "+this.tree[1].to_js()+")";case"is_not":return this.tree[0].to_js()+"!=="+this.tree[1].to_js();case"+":return"$B.add("+this.tree[0].to_js()+", "+this.tree[1].to_js()+")";case"*":case"-":let K=function(be,Ne){var je;return["int","float","str"].indexOf(Ne.type)>-1?je=Ne.type:"id"==Ne.type&&be[Ne.value]&&(je=be[Ne.value].type),je};var ye=this.op,ne=[],ue=!1,me=$get_scope(this),ie=this.tree[0],W=this.tree[1];if(function be(Ne){if("expr"==Ne.type&&"int"==Ne.tree[0].type)return!0;if("expr"==Ne.type&&"float"==Ne.tree[0].type)return ue=!0,!0;if("expr"==Ne.type&&"list_or_tuple"==Ne.tree[0].type&&"tuple"==Ne.tree[0].real&&1==Ne.tree[0].tree.length&&"expr"==Ne.tree[0].tree[0].type)return be(Ne.tree[0].tree[0].tree[0]);if("expr"==Ne.type&&"id"==Ne.tree[0].type){var je=Ne.tree[0].to_js();return-1==ne.indexOf(je)&&ne.push(je),!0}if("op"==Ne.type&&["*","+","-"].indexOf(Ne.op)>-1){for(var Te=0;Te<Ne.tree.length;Te++)if(!be(Ne.tree[Te]))return!1;return!0}return!1}(this)){var Q=this.tree[0].tree[0],A=this.tree[1].tree[0];if(0!=ne.length||ue){if(0==ne.length)return"new Number("+this.simple_js()+")";var R=me.binding;if(l=K(R,Q),x=K(R,A),"float"==l&&"float"==x||"+"==this.op&&"str"==l&&"str"==x)return this.result_type=l,Q.to_js()+this.op+A.to_js();if(["int","float"].indexOf(l)>-1&&["int","float"].indexOf(x)>-1)switch(this.result_type="int"==l&&"int"==x?"int":"float",this.op){case"-":return"$B.sub("+Q.to_js()+","+A.to_js()+")";case"*":return"$B.mul("+Q.to_js()+","+A.to_js()+")"}var X,he=[],z=[];return ne.forEach(function(be){he.push("typeof "+be+'.valueOf() == "number"'),z.push("typeof "+be+' == "number"')}),(X=[he.join(" && ")+" ? "]).push("("+z.join(" && ")+" ? "),X.push(this.simple_js()),X.push(" : new Number("+this.simple_js()+")"),X.push(")"),l=this.tree[0].to_js(),x=this.tree[1].to_js(),"+"==this.op&&X.push(" : (typeof "+l+' == "string" && typeof '+x+' == "string") ? '+l+"+"+x),X.push(': $B.rich_op("'+$operators[this.op]+'",'+l+","+x+")"),"("+X.join("")+")"}return this.simple_js()}return void 0!==n[this.op]?'$B.rich_comp("__'+$operators[this.op]+'__",'+ie.to_js()+","+W.to_js()+")":'$B.rich_op("'+$operators[this.op]+'", '+ie.to_js()+", "+W.to_js()+")";default:return void 0!==n[this.op]?'$B.rich_comp("__'+$operators[this.op]+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+")":'$B.rich_op("'+$operators[this.op]+'", '+this.tree[0].to_js()+", "+this.tree[1].to_js()+")"}},$OpCtx.prototype.simple_js=function(){var n=this.op;function o(l){return"op"==l.type?l.simple_js():"expr"==l.type&&"list_or_tuple"==l.tree[0].type&&"tuple"==l.tree[0].real&&1==l.tree[0].tree.length&&"expr"==l.tree[0].tree[0].type?"("+l.tree[0].tree[0].tree[0].simple_js()+")":l.tree[0].to_js()}return"+"==n?"$B.add("+o(this.tree[0])+","+o(this.tree[1])+")":"-"==n?"$B.sub("+o(this.tree[0])+","+o(this.tree[1])+")":"*"==n?"$B.mul("+o(this.tree[0])+","+o(this.tree[1])+")":"/"==n?"$B.div("+o(this.tree[0])+","+o(this.tree[1])+")":o(this.tree[0])+n+o(this.tree[1])};var $PackedCtx=$B.parser.$PackedCtx=function(n){if(this.type="packed","list_or_tuple"==n.parent.type&&"node"==n.parent.parent.type)for(var o=0;o<n.parent.tree.length;o++){var l=n.parent.tree[o];"expr"==l.type&&l.tree.length>0&&"packed"==l.tree[0].type&&$_SyntaxError(n,["two starred expressions in assignment"])}this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$PackedCtx.prototype.toString=function(){return"(packed) "+this.tree},$PackedCtx.prototype.transition=function(n,o){var l=this;if(l.tree.length>0&&"["==n)return $transition(l.tree[0],n,o);if("id"==n){var x=new $AbstractExprCtx(l,!1);return x.packed=!0,l.parent.expect=",",$transition(x,n,o)}return"["==n?(l.parent.expect=",",new $ListOrTupleCtx(l,"list")):"("==n?(l.parent.expect=",",new $ListOrTupleCtx(l,"tuple")):"]"==n?$transition(l.parent,n,o):"{"==n?(l.parent.expect=",",new $DictOrSetCtx(l)):l.parent.transition(n,l)},$PackedCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $PassCtx=$B.parser.$PassCtx=function(n){this.type="pass",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$PassCtx.prototype.toString=function(){return"(pass)"},$PassCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return l.parent;$_SyntaxError(l,"token "+n+" after "+l)},$PassCtx.prototype.to_js=function(){return this.js_processed=!0,"void(0)"};var $RaiseCtx=$B.parser.$RaiseCtx=function(n){this.type="raise",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.scope_type=$get_scope(this).ntype};$RaiseCtx.prototype.toString=function(){return" (raise) "+this.tree},$RaiseCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if(0==l.tree.length)return new $IdCtx(new $ExprCtx(l,"exc",!1),o);break;case"from":if(l.tree.length>0)return new $AbstractExprCtx(l,!1);break;case"eol":return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$RaiseCtx.prototype.to_js=function(){return this.js_processed=!0,"$B.$raise("+(0==this.tree.length?"":this.tree[0].to_js())+")"};var $RawJSCtx=$B.parser.$RawJSCtx=function(n,o){this.type="raw_js",n.tree[n.tree.length]=this,this.parent=n,this.js=o};$RawJSCtx.prototype.toString=function(){return"(js) "+this.js},$RawJSCtx.prototype.transition=function(n,o){},$RawJSCtx.prototype.to_js=function(){return this.js_processed=!0,this.js};var $ReturnCtx=$B.parser.$ReturnCtx=function(n){this.type="return",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.scope=$get_scope(this),-1==["def","generator"].indexOf(this.scope.ntype)&&$_SyntaxError(n,["'return' outside function"]);for(var o=this.node=$get_node(this);o.parent;){if(o.parent.C){var l=o.parent.C.tree[0];if("for"==l.type){l.has_return=!0;break}("try"==l.type||"single_kw"==l.type&&"finally"==l.token)&&(l.has_return=!0)}o=o.parent}};$ReturnCtx.prototype.toString=function(){return"return "+this.tree},$ReturnCtx.prototype.transition=function(n,o){return $transition(this.parent,n)},$ReturnCtx.prototype.to_js=function(){this.js_processed=!0,1==this.tree.length&&"abstract_expr"==this.tree[0].type&&(this.tree.pop(),new $IdCtx(new $ExprCtx(this,"rvalue",!1),"None"));var n=this.scope;if("generator"==n.ntype)return"var $res = "+$to_js(this.tree)+"; $B.leave_frame({$locals});return $B.generator_return($res)";var o="    ".repeat(this.node.indent-1),l="var $res = "+$to_js(this.tree)+";\n"+o+"if($locals.$f_trace !== _b_.None){$B.trace_return($res)}\n"+o+"$B.leave_frame";return"$exec_"==n.id.substr(0,6)&&(l+="_exec"),l+"({$locals});\n"+o+"return $res"};var $SingleKwCtx=$B.parser.$SingleKwCtx=function(n,o){if(this.type="single_kw",this.token=o,this.parent=n,this.tree=[],n.tree[n.tree.length]=this,"else"==o){for(var l=n.node,x=l.parent,B=0;B<x.children.length&&x.children[B]!==l;B++);var D=x.children[B-1].C;if(D.tree.length>0){var G=D.tree[0];("for"==G.type||"asyncfor"==G.type||"condition"==G.type&&"while"==G.token)&&(G.has_break=!0,G.else_node=$get_node(this),this.loop_num=G.loop_num)}}};$SingleKwCtx.prototype.toString=function(){return this.token},$SingleKwCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return $BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$SingleKwCtx.prototype.transform=function(n,o){if("finally"==this.token){var l=$get_scope(this);n.insert(0,$NodeJS("var $exit;if($B.frames_stack.length < $stack_length){$exit = true;$B.frames_stack.push($top_frame)}")),l.id.replace(/\./g,"_"),"return"!=n.children[n.children.length-1].C.tree[0].type&&n.add($NodeJS("if($exit){$B.leave_frame({$locals})}"))}},$SingleKwCtx.prototype.to_js=function(){return this.js_processed=!0,"finally"==this.token?this.token:void 0!==this.loop_num?"if($locals_"+$get_scope(this).id.replace(/\./g,"_")+'["$no_break'+this.loop_num+'"])':this.token};var $SliceCtx=$B.parser.$SliceCtx=function(n){this.type="slice",this.parent=n,this.tree=n.tree.length>0?[n.tree.pop()]:[],n.tree.push(this)};$SliceCtx.prototype.transition=function(n,o){return":"==n?new $AbstractExprCtx(this,!1):$transition(this.parent,n,o)},$SliceCtx.prototype.to_js=function(){for(var n=0;n<this.tree.length;n++)"abstract_expr"==this.tree[n].type&&(this.tree[n].to_js=function(){return"_b_.None"});return"_b_.slice.$factory("+$to_js(this.tree)+")"};var $StarArgCtx=$B.parser.$StarArgCtx=function(n){this.type="star_arg",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$StarArgCtx.prototype.toString=function(){return"(star arg) "+this.tree},$StarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return"target_list"==l.parent.type?(l.tree.push(o),l.parent.expect=",",l.parent):$transition(new $AbstractExprCtx(l,!1),n,o);case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case",":case")":return 0==l.tree.length&&$_SyntaxError(l,"unnamed star argument"),$transition(l.parent,n);case":":if("lambda"==l.parent.parent.type)return $transition(l.parent.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$StarArgCtx.prototype.to_js=function(){return this.js_processed=!0,'{$nat:"ptuple",arg:'+$to_js(this.tree)+"}"};var $StringCtx=$B.parser.$StringCtx=function(n,o){this.type="str",this.parent=n,this.tree=[o],n.tree[n.tree.length]=this,this.raw=!1};$StringCtx.prototype.toString=function(){return"string "+(this.tree||"")},$StringCtx.prototype.transition=function(n,o){var l=this;switch(n){case"[":return new $AbstractExprCtx(new $SubCtx(l.parent),!1);case"(":return l.parent.tree[0]=l,new $CallCtx(l.parent);case"str":return l.tree.push(o),l}return $transition(l.parent,n,o)},$StringCtx.prototype.to_js=function(){this.js_processed=!0;var n="",o=null,l=$get_scope(this),x=!1;function B(ne){for(var ue=0;ue<ne.length;ue++){try{code=ne.charCodeAt(ue)}catch(me){throw console.log("err for s",ne),me}if(code>=55296&&code<=56319)return!0}return!1}function D(ne){for(var ue=[],me=0;me<ne.length;me++)if("expression"==ne[me].type){for(var ie=ne[me].expression,W=0,Q=[],A=[ie];W<ie.length;){var R=ie.charAt(W);if(":"==R&&0==Q.length){A=[ie.substr(0,W),ie.substr(W+1)];break}"{[(".indexOf(R)>-1?Q.push(R):")]}".indexOf(R)>-1&&Q.pop(),W++}var X=$pos,he=$B.py2js(ie=A[0],l.module,l.id,l);he.to_js(),$pos=X;for(var z=0;z<he.children.length;z++){var Le=he.children[z];if(Le.C.tree&&1==Le.C.tree.length&&"try"==Le.C.tree[0]){for(var K=0;K<Le.children.length;K++)if(!Le.children[K].is_line_num){for(var be=Le.children[K].js;"\n;".indexOf(be.charAt(be.length-1))>-1;)be=be.substr(0,be.length-1);break}break}}switch(ne[me].conversion){case"a":be="_b_.ascii("+be+")";break;case"r":be="_b_.repr("+be+")";break;case"s":be="_b_.str.$factory("+be+")"}var Ne=A[1];if(void 0!==Ne){var je=$B.parse_fstring(Ne),Te="_b_.str.format('{0:' + "+(Ne=je.length>1?D(je):"'"+Ne+"'")+" + '}', "+be+")";ue.push(Te)}else null===ne[me].conversion&&(be="_b_.str.$factory("+be+")"),ue.push(be)}else{var qe=new RegExp("'","g"),Ke=ne[me].replace(qe,"\\'").replace(/\n/g,"\\n");x=x||B(Ke),ue.push("'"+Ke+"'")}return ue.join(" + ")}function G(ne){return(ne=ne.replace(/\n/g,"\\n\\\n")).replace(/\\U([A-Fa-f0-9]{8})/gm,function(ue){return String.fromCharCode("0x"+ue.slice(2))})}for(var M=0;M<this.tree.length;M++){if("call"==this.tree[M].type)return"(function(){throw _b_.TypeError.$factory(\"'str' object is not callable\")}())";var P=this.tree[M],fe=Array.isArray(P),ye=!1;if(fe||(ye="b"==P.charAt(0)),null==o)o=ye,ye&&(n+="_b_.bytes.$new(_b_.bytes, ");else if(o!=ye)return'$B.$TypeError("can\'t concat bytes to str")';ye?n+=G(P.substr(1)):fe?n+=D(P):(x=x||B(P),n+=G(P)),M<this.tree.length-1&&(n+="+")}return ye&&(n+=',"ISO-8859-1")'),0==n.length&&(n='""'),x&&(n="_b_.str.$surrogate.$factory("+n+")"),n};var $SubCtx=$B.parser.$SubCtx=function(n){this.type="sub",this.func="getitem",this.value=n.tree[0],n.tree.pop(),n.tree[n.tree.length]=this,this.parent=n,this.tree=[]};$SubCtx.prototype.toString=function(){return"(sub) (value) "+this.value+" (tree) "+this.tree},$SubCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o);case"]":if(l.parent.packed)return l.parent.tree[0];if(l.tree[0].tree.length>0)return l.parent;break;case":":return new $AbstractExprCtx(new $SliceCtx(l),!1);case",":return new $AbstractExprCtx(l,!1)}$_SyntaxError(l,"token "+n+" after "+l)},$SubCtx.prototype.to_js=function(){if(this.js_processed=!0,"getitem"==this.func&&"id"==this.value.type){var n=$get_node(this).locals[this.value.value],o=this.value.to_js();if("list"==n||"tuple"==n){if(1==this.tree.length)return"$B.list_key("+o+", "+this.tree[0].to_js()+")";if(2==this.tree.length)return"$B.list_slice("+o+", "+(this.tree[0].to_js()||"null")+","+(this.tree[1].to_js()||"null")+")";if(3==this.tree.length)return"$B.list_slice_step("+o+", "+(this.tree[0].to_js()||"null")+","+(this.tree[1].to_js()||"null")+","+(this.tree[2].to_js()||"null")+")"}}if("getitem"==this.func&&1==this.tree.length)return"slice"==this.tree[0].type?`$B.getitem_slice(${this.value.to_js()},${this.tree[0].to_js()})`:"$B.$getitem("+this.value.to_js()+","+this.tree[0].to_js()+")";var l="",x=!1;if("delitem"!==this.func&&1==this.tree.length&&!this.in_sub){var B="",D=this;for(x=!0;"sub"==D.value.type;)B+="["+D.tree[0].to_js()+"]",D.value.in_sub=!0,D=D.value;var G=D.value.to_js()+"["+D.tree[0].to_js()+"]((Array.isArray("+D.value.to_js()+") || typeof "+D.value.to_js()+' == "string") && '+G+" !== undefined ?"+G+B+" : "}if(l+="$B.$getattr("+(o=this.value.to_js())+',"__'+this.func+'__")(',1==this.tree.length)l+=this.tree[0].to_js()+")";else{var M=[];this.tree.forEach(function(P){M.push("abstract_expr"==P.type?"_b_.None":P.to_js())}),l+="_b_.tuple.$factory(["+M.join(",")+"]))"}return x?l+")":l};var $TargetListCtx=$B.parser.$TargetListCtx=function(n){this.type="target_list",this.parent=n,this.tree=[],this.expect="id",n.tree[n.tree.length]=this};$TargetListCtx.prototype.toString=function(){return"(target list) "+this.tree},$TargetListCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.expect=",",new $IdCtx(new $ExprCtx(l,"target",!1),o);case"op":if("id"==l.expect&&"*"==o)return new $PackedCtx(l);case"(":case"[":if("id"==l.expect)return l.expect=",",new $ListOrTupleCtx(l,"("==n?"tuple":"list");case")":case"]":if(","==l.expect)return l.parent;case",":if(","==l.expect)return l.expect="id",l}return","==l.expect||"in"==n?$transition(l.parent,n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$TargetListCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $TernaryCtx=$B.parser.$TernaryCtx=function(n){this.type="ternary",this.parent=n.parent,n.parent.tree.pop(),n.parent.tree.push(this),n.parent=this,this.tree=[n]};$TernaryCtx.prototype.toString=function(){return"(ternary) "+this.tree},$TernaryCtx.prototype.transition=function(n,o){var l=this;if("else"==n)return l.in_else=!0,new $AbstractExprCtx(l,!1);if(l.in_else){if(","==n&&["assign","augm_assign","node","return"].indexOf(l.parent.type)>-1){l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.implicit=!0,x.tree[0]=l,l.parent=x,x.expect="id",x}}else $_SyntaxError(l,"token "+n+" after "+l);return $transition(l.parent,n,o)},$TernaryCtx.prototype.to_js=function(){this.js_processed=!0;var n="$B.$bool("+this.tree[1].to_js()+") ? ";return(n+=this.tree[0].to_js()+" : ")+this.tree[2].to_js()};var $TryCtx=$B.parser.$TryCtx=function(n){this.type="try",this.parent=n,n.tree[n.tree.length]=this};$TryCtx.prototype.toString=function(){return"(try) "},$TryCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return $BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$TryCtx.prototype.transform=function(n,o){if(n.parent.children.length==o+1)$_SyntaxError(C,["unexpected EOF while parsing"]);else switch(n.parent.children[o+1].C.tree[0].type){case"except":case"finally":case"single_kw":break;default:$_SyntaxError(C,"no clause after try")}var l=$get_scope(this),x=create_temp_name("$err"),B="$locals."+create_temp_name("$failed"),D=B+" = false;\n"+" ".repeat(n.indent+4)+"try";new $NodeJSCtx(n,D),n.has_return=this.has_return;var G=$NodeJS("catch("+x+")");n.parent.insert(o+1,G),G.add($NodeJS("$B.set_exc("+x+")")),G.add($NodeJS("if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_exception()}")),G.add($NodeJS(B+" = true;$B.pmframe = $B.last($B.frames_stack);if(false){}"));for(var M=o+2,P=!1,fe=!1,ye=!1;M!=n.parent.children.length&&void 0!==(W=n.parent.children[M].C.tree[0]);)if("except"==W.type)fe&&$_SyntaxError(C,"'except' or 'finally' after 'else'"),ye&&$_SyntaxError(C,"'except' after 'finally'"),W.error_name=x,W.tree.length>0&&null!=W.tree[0].alias&&n.parent.children[M].insert(0,$NodeJS('$locals["'+W.tree[0].alias+'"] = $B.exception('+x+")")),G.insert(G.children.length,n.parent.children[M]),0==W.tree.length&&(P&&$_SyntaxError(C,"more than one except: line"),P=!0),n.parent.children.splice(M,1);else if("single_kw"==W.type&&"finally"==W.token){ye=!0;var ue=n.parent.children[M];M++}else{if("single_kw"!=W.type||"else"!=W.token)break;fe&&$_SyntaxError(C,"more than one 'else'"),ye&&$_SyntaxError(C,"'else' after 'finally'"),fe=!0;var me=n.parent.children[M];n.parent.children.splice(M,1)}if(!P){var ie=new $Node,W=new $NodeCtx(ie);G.insert(G.children.length,ie),new $SingleKwCtx(W,"else"),ie.add($NodeJS("throw "+x))}if(fe){var Q=new $Node;Q.module=l.module,new $NodeJSCtx(Q,"if(!"+B+")"),me.children.forEach(function(A){Q.add(A)}),ye?ue.insert(0,Q):n.parent.insert(M,Q),M++}$loop_num++},$TryCtx.prototype.to_js=function(){return this.js_processed=!0,"try"};var $UnaryCtx=$B.parser.$UnaryCtx=function(n,o){this.type="unary",this.op=o,this.parent=n,n.tree[n.tree.length]=this};$UnaryCtx.prototype.toString=function(){return"(unary) "+this.op},$UnaryCtx.prototype.transition=function(n,o){var l=this;switch(n){case"int":case"float":case"imaginary":var x=l.parent;return l.parent.parent.tree.pop(),"-"==l.op?o="-"+o:"~"==l.op&&(o=~o),$transition(l.parent.parent,n,o);case"id":l.parent.parent.tree.pop(),x=new $ExprCtx(l.parent.parent,"call",!1);var B=new $ExprCtx(x,"id",!1);return new $IdCtx(B,o),new $AttrCtx(x).name="+"==l.op?"__pos__":"-"==l.op?"__neg__":"__invert__",B;case"op":if("+"==o||"-"==o)return l.op=l.op===o?"+":"-",l}return $transition(l.parent,n,o)},this.to_js=function(){return this.js_processed=!0,this.op};var $WithCtx=$B.parser.$WithCtx=function(n){this.type="with",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.expect="as",this.scope=$get_scope(this)};$WithCtx.prototype.toString=function(){return"(with) "+this.tree},$WithCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.expect="as",$transition(new $AbstractExprCtx(l,!1),n,o);$_SyntaxError(l,"token "+n+" after "+l);case"as":return new $AbstractExprCtx(new $AliasCtx(l));case":":switch(l.expect){case"id":case"as":case":":return $BodyCtx(l)}break;case"(":if("id"==l.expect&&0==l.tree.length)return l.parenth=!0,l;if("alias"==l.expect)return l.expect=":",new $TargetListCtx(l,!1);break;case")":if(","==l.expect||"as"==l.expect)return l.expect=":",l;break;case",":if(void 0!==l.parenth&&void 0===l.has_alias&&(","==l.expect||"as"==l.expect)||"as"==l.expect||":"==l.expect)return l.expect="id",l}$_SyntaxError(l,"token "+n+" after "+l.expect)},$WithCtx.prototype.set_alias=function(n){var o=[];"id"==n.type?o=[n]:"list_or_tuple"==n.type&&n.tree.forEach(function(D){"expr"==D.type&&"id"==D.tree[0].type&&o.push(D.tree[0])});for(var l=0,x=o.length;l<x;l++){var B=o[l];$bind(B.value,this.scope,this),B.bound=!0,"module"!==this.scope.ntype&&this.scope.C.tree[0].locals.push(B.value)}},$WithCtx.prototype.transform=function(n,o){for(;this.tree.length>1;){var l=n.children,x=this.tree.pop(),B=new $Node,D=new $NodeCtx(B),G=new $WithCtx(D);x.parent=G,G.tree=[x],G.async=this.async,l.forEach(function(X){B.add(X)}),n.children=[B]}if(!this.transformed){if(this.prefix="",this.tree.length>1){var M=new $Node;D=new $NodeCtx(M),M.parent=n,M.module=n.module,M.indent=n.indent+4;var P=new $WithCtx(D);return P.async=this.async,P.tree=this.tree.slice(1),n.children.forEach(function(X){M.add(X)}),n.children=[M],void(this.transformed=!0)}if(this.async)return this.transform_async(n,o);var fe=$NodeJS("try");n.parent.insert(o+1,fe);var ye=this.num=$loop_num++;if(fe.ctx_manager_num=ye,this.cm_name=this.prefix+"$ctx_manager"+ye,this.cmexit_name=this.prefix+"$ctx_manager_exit"+ye,this.exc_name=this.prefix+"$exc"+ye,this.err_name="$err"+ye,this.val_name="$value"+ye,this.yield_name=this.prefix+"$yield"+ye,null===this.tree[0].alias&&(this.tree[0].alias="$temp"),"expr"==this.tree[0].type&&"list_or_tuple"==this.tree[0].tree[0].type){"expr"==this.tree[1].type&&"list_or_tuple"==this.tree[1].tree[0].type||$_SyntaxError(C),this.tree[0].tree[0].tree.length!=this.tree[1].tree[0].tree.length&&$_SyntaxError(C,["wrong number of alias"]);var ne=this.tree[0].tree[0].tree,ue=this.tree[1].tree[0].tree;this.tree.shift(),this.tree.shift();for(var me=ne.length-1;me>=0;me--)ne[me].alias=ue[me].value,this.tree.splice(0,0,ne[me])}var ie=n.children;n.children=[];var W=new $Node;new $NodeJSCtx(W,"try"),fe.add(W),this.tree[0].alias&&W.add($NodeJS('$locals["'+(ue=this.tree[0].alias.tree[0].tree[0].value)+'"] = '+this.val_name)),ie.forEach(function(X){W.add(X)});var Q=new $Node;new $NodeJSCtx(Q,"catch("+this.err_name+")");var A=this.exc_name+" = false;"+this.err_name+" = $B.exception("+this.err_name+", true)\n"+" ".repeat(n.indent+4)+"var $b = "+this.cmexit_name+"("+this.err_name+".__class__,"+this.err_name+",$B.$getattr("+this.err_name+', "__traceback__"));';"generator"==this.scope.ntype&&(A+="$B.set_cm_in_generator("+this.cmexit_name+");"),Q.add($NodeJS(A+="if(!$B.$bool($b)){throw "+this.err_name+"}")),fe.add(Q);var R=new $Node;new $NodeJSCtx(R,"finally"),R.C.type="single_kw",R.C.token="finally",R.C.in_ctx_manager=!0,R.is_except=!0,R.in_ctx_manager=!0,A="if("+this.exc_name,A+="){"+this.cmexit_name+"(_b_.None, _b_.None, _b_.None);","generator"==this.scope.ntype&&(A+="delete "+this.cmexit_name),R.add($NodeJS(A+="};")),n.parent.insert(o+2,R),this.transformed=!0}},$WithCtx.prototype.transform_async=function(n,o){$get_scope(this);var l=this.tree[0],x=this.tree[0].alias,B=[],D=this.num=$loop_num++;this.cm_name="$ctx_manager"+D,this.cmexit_name="$ctx_manager_exit"+D,this.exc_name="$exc"+D;var G="$ctx_mgr_type"+D,M="$ctx_manager_enter"+D,P="$err"+D,fe="var "+this.cm_name+" = "+l.to_js()+",";if(B.push($NodeJS(fe)),B.push($NodeJS("    "+G+" = _b_.type.$factory("+this.cm_name+"),")),B.push($NodeJS("    "+this.cmexit_name+" = $B.$call($B.$getattr("+G+', "__aexit__")),')),B.push($NodeJS("    "+M+" = $B.$call($B.$getattr("+G+', "__aenter__"))('+this.cm_name+"),")),B.push($NodeJS("    "+this.exc_name+" = false")),fe="",x)if("list_or_tuple"!=x.tree[0].tree[0].type)fe=x.tree[0].to_js()+" = await ($B.promise("+M+"))",B.push($NodeJS(fe));else{var ye=new $Node,ne=new $NodeCtx(ye);(l=new $ExprCtx(ne,"left",!1)).tree.push(x.tree[0].tree[0]),x.tree[0].tree[0].parent=l;var ue=new $AssignCtx(l);new $RawJSCtx(ue,"await ($B.promise("+M+"))"),B.push(ye)}else B.push($NodeJS("await ($B.promise("+M+"))"));var me=new $NodeJS("try");n.children.forEach(function(R){me.add(R)}),B.push(me);var ie=new $NodeJS("catch(err)");B.push(ie),ie.add($NodeJS(this.exc_name+" = true")),ie.add($NodeJS("var "+P+' = $B.imported["_sys"].exc_info()'));var W=$NodeJS("if(! await ($B.promise("+this.cmexit_name+"("+this.cm_name+", "+P+"[0], "+P+"[1], "+P+"[2]))))");ie.add(W),W.add($NodeJS("$B.$raise()"));var Q=$NodeJS("if(! "+this.exc_name+")");B.push(Q),Q.add($NodeJS("await ($B.promise("+this.cmexit_name+"("+this.cm_name+", _b_.None, _b_.None, _b_.None)))")),n.parent.children.splice(o,1);for(var A=B.length-1;A>=0;A--)n.parent.insert(o,B[A]);return n.children=[],0},$WithCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_node(this).indent,o=" ".repeat(n),l=this.num,x=""==this.prefix?"var ":this.prefix,B="$ctx_manager"+l,D=x+"$ctx_manager_exit"+l,G=x+"$exc"+l,M="$value"+l;return"var "+B+" = "+this.tree[0].to_js()+"\n"+o+D+" = $B.$getattr("+B+',"__exit__")\n'+o+"var "+M+" = $B.$getattr("+B+',"__enter__")()\n'+o+G+" = true\n"};var $YieldCtx=$B.parser.$YieldCtx=function(n,o){this.type="yield",this.parent=n,this.tree=[],this.is_await=o,n.tree[n.tree.length]=this,"list_or_tuple"==n.type&&n.tree.length>1&&$_SyntaxError(n,"non-parenthesized yield"),$parent_match(n,{type:"annotation"})&&$_SyntaxError(n,["'yield' outside function"]);for(var l=this;;){var x=$parent_match(l,{type:"list_or_tuple"});if(!x)break;x.yields=x.yields||[],x.yields.push([this,$pos]),l=x}for(l=this;;){var B=$parent_match(l,{type:"dict_or_set"});if(!B)break;B.yields=B.yields||[],B.yields.push([this,$pos]),l=B}var D=$get_module(this);D.yields_func_check=D.yields_func_check||[],D.yields_func_check.push([this,$pos]);var G=this.scope=$get_scope(this,!0),M=$get_node(this);M.has_yield=this;var P=$parent_match(this,{type:"comprehension"});if($get_scope(this).id.startsWith("lc"+$B.lambda_magic)&&delete M.has_yield,P){var fe=P.tree[0].tree[1];for(l=n;l&&l!==fe;)l=l.parent;l||$_SyntaxError(n,["'yield' inside list comprehension"])}var ye=!1;for(l=n;l;){if("lambda"==l.type){ye=!0,this.in_lambda=!0;break}l=l.parent}for(l=M.parent;l;){if(l.C&&l.C.tree.length>0&&"with"==l.C.tree[0].type){G.C.tree[0].$has_yield_in_cm=!0;break}l=l.parent}if(!ye)switch(n.type){case"node":case"assign":case"list_or_tuple":break;default:$_SyntaxError(n,"yield atom must be inside ()")}};$YieldCtx.prototype.toString=function(){return"(yield) "+(this.from?"(from) ":"")+this.tree},$YieldCtx.prototype.transition=function(n,o){var l=this;return"from"==n?("abstract_expr"!=l.tree[0].type&&$_SyntaxError(l,"'from' must follow 'yield'"),l.from=!0,l.from_num=$B.UUID(),l.tree[0]):$transition(l.parent,n)},$YieldCtx.prototype.transform=function(n,o){for(var l=n.parent;l;){if(void 0!==l.ctx_manager_num){n.parent.insert(o+1,$NodeJS("$top_frame[1].$has_yield_in_cm = true"));break}l=l.parent}},$YieldCtx.prototype.to_js=function(){return this.from?`_r${this.from_num}`:"yield "+$to_js(this.tree)},$YieldCtx.prototype.check_in_function=function(){if(!this.in_lambda){var n=$get_scope(this),o=n.is_function,l=n;if(!o&&n.is_comp){for(var x=n.parent_block;x.is_comp;)x=parent_block;o=x.is_function,l=x}o?this.is_await||(l.C.tree[0].type="generator"):$_SyntaxError(this.parent,["'yield' outside function"])}};var $add_line_num=$B.parser.$add_line_num=function(n,o,l){if("module"!=n.type){if("marker"!==n.type){for(var x=n.C.tree[0],B=1,D=!0,G=n;void 0!==G.parent;)G=G.parent;var P=n.line_num;if(void 0===P&&(D=!1),("condition"==x.type&&"elif"==x.token||"except"==x.type||"single_kw"==x.type)&&(D=!1),D){var fe=';$locals.$line_info = "'+(void 0===l?P+","+G.id:l)+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;',ye=new $Node;ye.is_line_num=!0,new $NodeJSCtx(ye,fe),n.parent.insert(o,ye),B=2}for(ne=0;ne<n.children.length;)ne+=$add_line_num(n.children[ne],ne,l);return B}return 1}for(var ne=0;ne<n.children.length;)ne+=$add_line_num(n.children[ne],ne,l)},$bind=$B.parser.$bind=function(n,o,l){if(!o.nonlocals||!o.nonlocals[n])if(o.globals&&o.globals.has(n))$get_module(l).binding[n]=!0;else{if(!l.no_bindings){var x=$get_node(l);x.bindings=x.bindings||{},x.bindings[n]=!0}o.binding=o.binding||{},void 0===o.binding[n]&&(o.binding[n]=!0)}};function $parent_match(n,o){for(var l;n.parent;){for(var x in l=!0,o)if(n.parent[x]!=o[x]){l=!1;break}if(l)return n.parent;n=n.parent}return!1}var $previous=$B.parser.$previous=function(n){var o=n.node.parent.children[n.node.parent.children.length-2];return o&&o.C||$_SyntaxError(n,"keyword not following correct keyword"),o.C.tree[0]},$get_docstring=$B.parser.$get_docstring=function(n){var o="";if(n.children.length>0){var l=n.children[0];if(l.C.tree&&l.C.tree.length>0&&"expr"==l.C.tree[0].type){var x=l.C.tree[0].tree[0];"str"!=x.type||Array.isArray(x.tree[0])||(o=l.C.tree[0].tree[0].to_js())}}return o},$get_scope=$B.parser.$get_scope=function(n,o){for(var l=n.parent;"node"!==l.type;)l=l.parent;for(var x=l.node,B=null;x.parent&&"module"!==x.parent.type;){var D=x.parent.C.tree[0].type;switch(D){case"def":case"class":case"generator":return(B=x.parent).ntype=D,B.is_function="class"!=D,B}x=x.parent}return(B=x.parent||x).ntype="module",B},$get_line_num=$B.parser.$get_line_num=function(n){var o=$get_node(n),l=o.line_num;if(void 0===o.line_num){for(o=o.parent;o&&void 0===o.line_num;)o=o.parent;o&&o.line_num&&(l=o.line_num)}return l},$get_module=$B.parser.$get_module=function(n){for(var o=n.parent;"node"!==o.type;)o=o.parent;var l=o.node;if("module"==l.ntype)return l;for(var x=null;"module"!=l.parent.type;)l=l.parent;return(x=l.parent).ntype="module",x},$get_src=$B.parser.$get_src=function(n){for(var o=$get_node(n);void 0!==o.parent;)o=o.parent;return o.src},$get_node=$B.parser.$get_node=function(n){for(var o=n;o.parent;)o=o.parent;return o.node},$to_js_map=$B.parser.$to_js_map=function(n){if(void 0!==n.to_js)return n.to_js();throw Error("no to_js() for "+n)},$to_js=$B.parser.$to_js=function(n,o){return void 0===o&&(o=","),n.map($to_js_map).join(o)},$mangle=$B.parser.$mangle=function(n,o){if("__"!=n.substr(0,2)||"__"===n.substr(n.length-2))return n;for(var l=$get_scope(o);;){if("module"==l.ntype)return n;if("class"==l.ntype){for(var x=l.C.tree[0].name;"_"==x.charAt(0);)x=x.substr(1);return"_"+x+n}if(!l.parent||!l.parent.C)return n;l=$get_scope(l.C.tree[0])}},$transition=$B.parser.$transition=function(n,o,l){return n.transition(o,l)};$B.forbidden=["alert","arguments","case","catch","const","constructor","Date","debugger","delete","default","do","document","enum","export","eval","extends","Error","history","function","instanceof","keys","length","location","Math","message","new","null","Number","RegExp","String","super","switch","this","throw","typeof","var","window","toLocaleString","toString","void"],$B.aliased_names=$B.list2obj($B.forbidden);for(var s_escaped="abfnrtvxuU\"0123456789'\\",is_escaped={},i=0;i<s_escaped.length;i++)is_escaped[s_escaped.charAt(i)]=!0;var $tokenize=$B.parser.$tokenize=function(root,src){for(var br_close={")":"(","]":"[","}":"{"},br_stack="",br_pos=[],kwdict=["class","return","break","for","lambda","try","finally","raise","def","from","nonlocal","while","del","global","with","as","elif","else","if","yield","assert","import","except","raise","in","pass","with","continue","__debugger__","async","await"],unsupported=[],$indented=["class","def","for","condition","single_kw","try","except","with"],int_pattern=/^(\d[0-9_]*)(j|J)?/,float_pattern1=/^(\d[\d_]*)\.(\d+(_\d+)*)?([eE][+-]?\d+(_\d+)*)?(j|J)?/,float_pattern2=/^(\d[\d_]*)([eE][+-]?\d+(_\d+)*)(j|J)?/,hex_pattern=/^0[xX]([\da-fA-F_]+)/,octal_pattern=/^0[oO]([0-7_]+)/,binary_pattern=/^0[bB]([01_]+)/,C=null,new_node=new $Node,current=root,name="",_type=null,pos=0,indent=null,string_modifier=!1,module=root.module,lnum=root.line_num||1;pos<src.length;){function rmuf(n){return(n.search("__")>-1||n.endsWith("_"))&&$_SyntaxError(C,"invalid literal"),n.replace(/_/g,"")}function check_int(n){if(rmuf(n),n.startsWith("0")){if(!(n.substr(1).search(/[^0_]/)>-1))return"0";$_SyntaxError(C,"invalid literal")}}function rmu(n){return n.replace(/_/g,"")}var car=src.charAt(pos);if(null!==indent)if("#"!=car)if('"'!=car&&"'"!=car){if(""==name&&"$"!=car){if($B.unicode_tables.XID_Start[car.charCodeAt(0)]){name=car;var p0=pos;for(pos++;pos<src.length&&$B.unicode_tables.XID_Continue[src.charCodeAt(pos)];)name+=src.charAt(pos),pos++}if(name){if(kwdict.indexOf(name)>-1)$pos=pos-name.length,unsupported.indexOf(name)>-1&&$_SyntaxError(C,"Unsupported Python keyword '"+name+"'"),C=$transition(C,name);else if("string"==typeof $operators[name]&&-1==["is_not","not_in"].indexOf(name))if("is"==name){var re=/^\s+not\s+/,res=re.exec(src.substr(pos));null!==res?(pos+=res[0].length,$pos=pos-name.length,C=$transition(C,"op","is_not")):($pos=pos-name.length,C=$transition(C,"op",name))}else if("not"==name){var re=/^\s+in\s+/,res=re.exec(src.substr(pos));null!==res?(pos+=res[0].length,$pos=pos-name.length,C=$transition(C,"op","not_in")):($pos=pos-name.length,C=$transition(C,name))}else $pos=pos-name.length,C=$transition(C,"op",name);else{if(('"'==src.charAt(pos)||"'"==src.charAt(pos))&&-1!==["r","b","u","rb","br","f","fr","rf"].indexOf(name.toLowerCase())){string_modifier=name.toLowerCase(),name="";continue}$B.forbidden.indexOf(name)>-1&&(name="$$"+name),$pos=pos-name.length,C=$transition(C,"id",name)}name="";continue}}switch(car){case" ":case"\t":pos++;break;case".":if(pos<src.length-1&&/^\d$/.test(src.charAt(pos+1))){for(var j=pos+1;j<src.length&&src.charAt(j).search(/\d|e|E|_/)>-1;)j++;"j"==src.charAt(j)?(C=$transition(C,"imaginary","0"+rmu(src.substr(pos,j-pos))),j++):C=$transition(C,"float","0"+rmu(src.substr(pos,j-pos))),pos=j;break}$pos=pos,C=$transition(C,"."),pos++;break;case"0":var res=hex_pattern.exec(src.substr(pos));if(res){rmuf(res[1]),C=$transition(C,"int",[16,rmu(res[1])]),pos+=res[0].length;break}var res=octal_pattern.exec(src.substr(pos));if(res){C=$transition(C,"int",[8,rmuf(res[1])]),pos+=res[0].length;break}var res=binary_pattern.exec(src.substr(pos));if(res){C=$transition(C,"int",[2,rmuf(res[1])]),pos+=res[0].length;break}if(src.charAt(pos+1).search(/\d/)>-1){if(0===parseInt(src.substr(pos))){res=int_pattern.exec(src.substr(pos)),$pos=pos,check_int(res[0]),C=$transition(C,"int",[10,rmu(res[0])]),pos+=res[0].length;break}$_SyntaxError(C,"invalid literal starting with 0")}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":var res=float_pattern1.exec(src.substr(pos));res?(check_int(res[1]),res[2]&&rmuf(res[2]),$pos=pos,C=void 0!==$B.last(res)?$transition(C,"imaginary",rmuf(res[0].substr(0,res[0].length-1))):$transition(C,"float",rmuf(res[0]))):(res=float_pattern2.exec(src.substr(pos)),res?(check_int(res[1]),$pos=pos,C=void 0!==$B.last(res)?$transition(C,"imaginary",rmuf(res[0].substr(0,res[0].length-1))):$transition(C,"float",rmuf(res[0]))):(res=int_pattern.exec(src.substr(pos)),check_int(res[1]),$pos=pos,C=void 0!==res[2]?$transition(C,"imaginary",rmu(res[1])):$transition(C,"int",[10,rmu(res[0])]))),pos+=res[0].length;break;case"\n":lnum++,br_stack.length>0||(current.C.tree.length>0||current.C.async?($pos=pos,C=$transition(C,"eol"),indent=null,new_node=new $Node):new_node.line_num=lnum),pos++;break;case"(":case"[":case"{":br_stack+=car,br_pos[br_stack.length-1]=[C,pos],$pos=pos,C=$transition(C,car),pos++;break;case")":case"]":case"}":""==br_stack?($pos=pos,$_SyntaxError(C,"Unexpected closing bracket")):br_close[car]!=br_stack.charAt(br_stack.length-1)?($pos=pos,$_SyntaxError(C,"Unbalanced bracket")):(br_stack=br_stack.substr(0,br_stack.length-1),$pos=pos,C=$transition(C,car),pos++);break;case"=":"="!=src.charAt(pos+1)?($pos=pos,C=$transition(C,"="),pos++):($pos=pos,C=$transition(C,"op","=="),pos+=2);break;case",":case":":$pos=pos,":="==src.substr(pos,2)?(C=$transition(C,":="),pos++):C=$transition(C,car),pos++;break;case";":$transition(C,"eol"),0==current.C.tree.length&&($pos=pos,$_SyntaxError(C,"invalid syntax"));for(var pos1=pos+1,ends_line=!1;pos1<src.length;){var _s=src.charAt(pos1);if("\n"==_s||"#"==_s){ends_line=!0;break}if(" "!=_s)break;pos1++}if(ends_line){pos++;break}new_node=new $Node,new_node.indent=$get_node(C).indent,new_node.line_num=lnum,new_node.module=module,$get_node(C).parent.add(new_node),current=new_node,C=new $NodeCtx(new_node),pos++;break;case"/":case"%":case"&":case">":case"<":case"-":case"+":case"*":case"@":case"/":case"^":case"=":case"|":case"~":case"!":if("-"==car&&">"==src.charAt(pos+1)){C=$transition(C,"annotation"),pos+=2;continue}if("@"==car&&"node"==C.type){$pos=pos,C=$transition(C,car),pos++;break}var op_match="";for(var op_sign in $operators)op_sign==src.substr(pos,op_sign.length)&&op_sign.length>op_match.length&&(op_match=op_sign);$pos=pos,op_match.length>0?(C=$transition(C,op_match in $augmented_assigns?"augm_assign":"op",op_match),pos+=op_match.length):$_SyntaxError(C,"invalid character: "+car);break;case"\\":if("\n"==src.charAt(pos+1)){lnum++,pos+=2,pos==src.length?$_SyntaxError(C,["unexpected EOF while parsing"]):"node"==C.type&&$_SyntaxError(C,"nothing before \\");break}$pos=pos,$_SyntaxError(C,["unexpected character after line continuation character"]);case"\f":pos+=1;break;default:$pos=pos,$_SyntaxError(C,"unknown token ["+car+"]")}}else{var raw="str"==C.type&&C.raw,bytes=!1,fstring=!1,sm_length,end=null;if(string_modifier){switch(string_modifier){case"r":raw=!0;break;case"u":break;case"b":bytes=!0;break;case"rb":case"br":bytes=!0,raw=!0;break;case"f":fstring=!0,sm_length=1;break;case"rf":fstring=!0,sm_length=2,raw=!0}string_modifier=!1}src.substr(pos,3)==car+car+car?(_type="triple_string",end=pos+3):(_type="string",end=pos+1);for(var escaped=!1,zone=car,found=!1;end<src.length;)if(escaped)"a"==src.charAt(end)?zone=zone.substr(0,zone.length-1)+"\x07":(zone+=src.charAt(end),raw&&"\\"==src.charAt(end)&&(zone+="\\")),escaped=!1,end++;else if("\\"==src.charAt(end))if(raw)end<src.length-1&&src.charAt(end+1)==car?(zone+="\\\\"+car,end+=2):(zone+="\\\\",end++),escaped=!0;else if("\n"==src.charAt(end+1))end+=2,lnum++;else if("N{"==src.substr(end+1,2)){var end_lit=end+3,re=new RegExp("[-a-zA-Z0-9 ]+"),search=re.exec(src.substr(end_lit));null===search&&$_SyntaxError(C,"(unicode error) malformed \\N character escape",pos);var end_lit=end_lit+search[0].length;"}"!=src.charAt(end_lit)&&$_SyntaxError(C,"(unicode error) malformed \\N character escape");var description=search[0].toUpperCase();if(void 0===$B.unicodedb){var xhr=new XMLHttpRequest;xhr.open("GET",$B.brython_path+"unicode.txt",!1),xhr.onreadystatechange=function(){4==this.readyState&&(200==this.status?$B.unicodedb=this.responseText:console.log("Warning - could not load unicode.txt"))},xhr.send()}if(void 0!==$B.unicodedb){var re=new RegExp("^([0-9A-F]+);"+description+";.*$","m");search=re.exec($B.unicodedb),null===search&&$_SyntaxError(C,"(unicode error) unknown Unicode character name");var cp="0x"+search[1];zone+=String.fromCodePoint(eval(cp)),end=end_lit+1}else end++}else end<src.length-1&&void 0===is_escaped[src.charAt(end+1)]&&(zone+="\\"),zone+="\\",escaped=!0,end++;else if("\n"==src.charAt(end)&&"triple_string"!=_type)console.log(pos,end,src.substring(pos,end)),$pos=end,$_SyntaxError(C,["EOL while scanning string literal"]);else if(src.charAt(end)==car){if("triple_string"!=_type||src.substr(end,3)==car+car+car){found=!0,$pos=pos;for(var $string=zone.substr(1),string="",i=0;i<$string.length;i++){var $car=$string.charAt(i);$car!=car||!raw&&0!=i&&"\\"==$string.charAt(i-1)||(string+="\\"),string+=$car}if(fstring)try{var re=new RegExp("\\\\"+car,"g"),string_no_bs=string.replace(re,car),elts=$B.parse_fstring(string_no_bs)}catch(n){$_SyntaxError(C,[n.toString()])}bytes?C=$transition(C,"str","b"+car+string+car):fstring?($pos-=sm_length,C=$transition(C,"str",elts),$pos+=sm_length):C=$transition(C,"str",car+string+car),C.raw=raw,pos=end+1,"triple_string"==_type&&(pos=end+3);break}zone+=src.charAt(end),end++}else zone+=src.charAt(end),"\n"==src.charAt(end)&&lnum++,end++;found||$_SyntaxError(C,"triple_string"===_type?"Triple string end not found":"String end not found")}else{var end=src.substr(pos+1).search("\n");-1==end&&(end=src.length-1),root.comments.push([pos,end]),pos+=end+1}else{for(var indent=0;pos<src.length;){var _s=src.charAt(pos);if(" "==_s)indent++,pos++;else{if("\t"!=_s)break;indent++,pos++,indent%8>0&&(indent+=8-indent%8)}}var _s=src.charAt(pos);if("\n"==_s){pos++,lnum++,indent=null;continue}if("#"==_s){var offset=src.substr(pos).search(/\n/);if(-1==offset)break;pos+=offset+1,lnum++,indent=null;continue}if(new_node.indent=indent,new_node.line_num=lnum,new_node.module=module,current.is_body_node&&(current.indent=indent),indent>current.indent)null!==C&&-1==$indented.indexOf(C.tree[0].type)&&($pos=pos,$_SyntaxError(C,"unexpected indent",pos)),current.add(new_node);else if(indent<=current.indent&&C&&C.tree[0]&&$indented.indexOf(C.tree[0].type)>-1&&C.tree.length<2)$pos=pos,$_SyntaxError(C,"expected an indented block",pos);else{for(;indent!==current.indent;)current=current.parent,(void 0===current||indent>current.indent)&&($pos=pos,$_SyntaxError(C,"unexpected indent",pos));current.parent.add(new_node)}current=new_node,C=new $NodeCtx(new_node)}}if(0!=br_stack.length){var br_err=br_pos[0];$pos=br_err[1];var lines=src.split("\n"),id=root.id,fname=id.startsWith("$")?"<string>":id;$_SyntaxError(br_err[0],["unexpected EOF while parsing ("+fname+", line "+(lines.length-1)+")"])}if(null!==C){if("async"==C.type)throw console.log("error with async",pos,src,src.substr(pos)),$pos=pos-7,$_SyntaxError(C,"car "+car+"after async",pos);if(C.tree[0]&&$indented.indexOf(C.tree[0].type)>-1)$pos=pos-1,$_SyntaxError(C,"expected an indented block",pos);else{var parent=current.parent;if(parent.C&&parent.C.tree&&parent.C.tree[0]&&"try"==parent.C.tree[0].type&&($pos=pos-1,$_SyntaxError(C,["unexpected EOF while parsing"])),root.yields_func_check){var save_pos=$pos;for(const n of root.yields_func_check)$pos=n[1],n[0].check_in_function();$pos=save_pos}}}},$create_root_node=$B.parser.$create_root_node=function(n,o,l,x,B){var D=new $Node("module");return D.module=o,D.id=l,D.binding={__doc__:!0,__name__:!0,__file__:!0,__package__:!0},D.parent_block=x,D.line_num=B,D.indent=-1,D.comments=[],D.imports={},"object"==typeof n&&(D.is_comp=n.is_comp,n.has_annotations&&(D.binding.__annotations__=!0),n=n.src),D.src=n,D};$B.py2js=function(n,o,l,x,B){if($pos=0,"object"==typeof o){var D=o.__package__;o=o.__name__}else D="";x=x||$B.builtins_scope;var G=(new Date).getTime(),M=!1,P=!0;if("object"==typeof n){M=n.is_comp,P=n.has_annotations;var fe=n.line_info,ye=n.ix;void 0!==fe&&(B=parseInt(fe.split(",")[0])),n=n.src}(n=n.replace(/\r\n/gm,"\n")).endsWith("\\")&&!n.endsWith("\\\\")&&(n=n.substr(0,n.length-1)),"\n"!=n.charAt(n.length-1)&&(n+="\n"),Array.isArray(l)&&(l=l[0]),l.charAt(0);var ne="$locals_"+l.replace(/\./g,"_"),ue="$locals_"+o.replace(/\./g,"_"),me=$create_root_node({src:n,is_comp:M,has_annotations:P},o,l,x,B);$tokenize(me,n),me.is_comp=M,null!=ye&&(me.ix=ye),me.transform();var ie=1;(A=["var $B = __BRYTHON__;\n"])[ie++]="var _b_ = __BRYTHON__.builtins;\n",A[2]="var $locals = "+ne,M&&(A[2]+=" = {}");var W=0;me.insert(0,$NodeJS(A.join(""))),W++,me.insert(W++,$NodeJS(ne+'.__package__ = "'+D+'"')),me.binding.__annotations__&&me.insert(W++,$NodeJS("$locals.__annotations__ = $B.empty_dict()"));var Q=W,A='var $top_frame = ["'+l.replace(/\./g,"_")+'", '+ne+', "'+o.replace(/\./g,"_")+'", '+ue+"]\n$locals.$f_trace = $B.enter_frame($top_frame)\nvar $stack_length = $B.frames_stack.length;";me.insert(W++,$NodeJS(A));var R=new $NodeJS("try"),X=me.children.slice(Q+1,me.children.length);me.insert(Q+1,R),0==X.length&&(X=[$NodeJS("")]),X.forEach(function(Le){R.add(Le)}),R.add($NodeJS("$B.leave_frame({$locals, value: _b_.None})")),me.children.splice(Q+2,me.children.length);var he=$NodeJS("catch(err)");he.add($NodeJS("$B.leave_frame({$locals, value: _b_.None})")),he.add($NodeJS("throw err")),me.add(he),$add_line_num(me,null,fe);var z=(new Date).getTime();return $B.debug>2&&o==l&&console.log("module "+o+" translated in "+(z-G)+" ms"),$B.compile_time+=z-G,me},$B.set_import_paths=function(){var n=[],o=[];$B.use_VFS&&n.push($B.finders.VFS),!1!==$B.$options.static_stdlib_import&&"file"!=$B.protocol&&(n.push($B.finders.stdlib_static),$B.path.length>3&&($B.path.shift(),$B.path.shift())),"file"!==$B.protocol&&(n.push($B.finders.path),o.push($B.$path_hooks[0])),$B.$options.cpython_import&&("replace"==$B.$options.cpython_import&&$B.path.pop(),n.push($B.finders.CPython)),$B.meta_path=n,$B.path_hooks=o};var brython=$B.parser.brython=function(n){void 0===n&&(n={debug:1}),"number"==typeof n&&(n={debug:n}),void 0===n.debug&&(n.debug=1),$B.debug=n.debug,_b_.__debug__=$B.debug>0,$B.compile_time=0,void 0===n.profile&&(n.profile=0),$B.profile=n.profile,void 0===n.indexedDB&&(n.indexedDB=!0),void 0===n.static_stdlib_import&&(n.static_stdlib_import=!0),$B.static_stdlib_import=n.static_stdlib_import,$B.$options=n,$B.set_import_paths();var o=($B.script_path=_window.location.href).split("/");if(o.pop(),($B.isWebWorker||$B.isNode)&&o.pop(),$B.curdir=o.join("/"),void 0!==n.pythonpath&&($B.path=n.pythonpath,$B.$options.static_stdlib_import=!1),n.python_paths&&n.python_paths.forEach(function(P){var fe,ye;"string"!=typeof P&&(fe=P.lang,ye=P.prefetch,P=P.path),$B.path.push(P),".vfs.js"!=P.slice(-7).toLowerCase()||void 0!==ye&&!0!==ye||($B.path_importer_cache[P+"/"]=$B.imported._importlib.VFSPathFinder(P)),fe&&B.optimize_import_for_path(P,fe)}),!$B.isWebWorker&&!$B.isNode)for(var l,x=document.querySelectorAll("head link[rel~=pythonpath]"),B=$B.imported._importlib,D=0;l=x[D];++D){var G=l.href;-1!=(" "+l.rel+" ").indexOf(" prepend ")?$B.path.unshift(G):$B.path.push(G);var M=l.hreflang;M&&("x-"==M.slice(0,2)&&(M=M.slice(2)),B.optimize_import_for_path(l.href,M))}$B.__ARGV=$B.$options.args?$B.$options.args:_b_.list.$factory([]),$B.isWebWorker||$B.isNode||_run_scripts(n)};$B.run_script=function(n,o,l){$B.$py_module_path[o]=$B.script_path;try{var x=$B.py2js(n,o,o),B=x.to_js(),D={__doc__:x.__doc__,js:B,__name__:o,$src:n,__file__:$B.script_path+($B.script_path.endsWith("/")?"":"/")+o};$B.file_cache[D.__file__]=n,$B.debug>1&&console.log(B)}catch(P){$B.handle_error(P)}if($B.hasOwnProperty("VFS")&&$B.has_indexedDB){var G=Object.keys(x.imports).slice().filter(function(P){return $B.VFS.hasOwnProperty(P)});Object.keys(G).forEach(function(P){if($B.VFS.hasOwnProperty(P)){var fe=$B.VFS[P],ye=fe[0];if(".py"==ye){var ne=fe[2];".py"==ye&&required_stdlib_imports(ne),ne.forEach(function(ue){-1==G.indexOf(ue)&&G.push(ue)})}}});for(var M=0;M<G.length;M++)$B.tasks.push([$B.inImported,G[M]]);x=null}$B.tasks.push(["execute",D]),l&&$B.loop()};var $log=$B.$log=function(n){n.split("\n").forEach(function(o,l){console.log(l+1,":",o)})},_run_scripts=$B.parser._run_scripts=function(options){var kk=Object.keys(_window),defined_ids={};if(void 0!==options.ipy_id){var $elts=[];options.ipy_id.forEach(function(n){$elts.push(document.getElementById(n))})}else for(var scripts=document.getElementsByTagName("script"),$elts=[],webworkers=[],i=0;i<scripts.length;i++){var script=scripts[i];if("text/python"==script.type||"text/python3"==script.type)if("webworker"==script.className){if(void 0===script.id)throw _b_.AttributeError.$factory("webworker script has no attribute 'id'");webworkers.push(script)}else $elts.push(script)}var first_script=!0,module_name;if(void 0!==options.ipy_id){module_name="__main__";var $src="",js,root;$B.$py_module_path[module_name]=$B.script_path,$elts.forEach(function(n){$src+=n.innerHTML||n.textContent});try{root=$B.py2js($src,module_name,module_name),js=root.to_js(),$B.debug>1&&$log(js),eval(js),$B.clear_ns(module_name),root=null,js=null}catch(n){if(root=null,js=null,console.log(n),$B.debug>1)for(var attr in console.log(n),n)console.log(attr+" : ",n[attr]);void 0===n.$py_error&&(console.log("Javascript error",n),n=_b_.RuntimeError.$factory(n+""));var $trace=$B.$getattr(n,"info")+"\n"+n.__name__+": "+n.args;try{$B.$getattr($B.stderr,"write")($trace)}catch{console.log($trace)}throw n}}else{$elts.length>0&&options.indexedDB&&$B.has_indexedDB&&$B.hasOwnProperty("VFS")&&$B.tasks.push([$B.idb_open]);for(var i=0;i<$elts.length;i++){var elt=$elts[i];if(elt.id){if(defined_ids[elt.id])throw Error("Brython error : Found 2 scripts with the same id '"+elt.id+"'");defined_ids[elt.id]=!0}}for(var src,i=0,len=webworkers.length;i<len;i++){var worker=webworkers[i];worker.src?$B.tasks.push([$B.ajax_load_script,{name:worker.id,url:worker.src,is_ww:!0}]):(src=worker.innerHTML||worker.textContent,src=src.replace(/^\n/,""),$B.webworkers[worker.id]=src)}for(var i=0;i<$elts.length;i++){var elt=$elts[i];if("text/python"==elt.type||"text/python3"==elt.type){if(elt.id)module_name=elt.id;else for(first_script?(module_name="__main__",first_script=!1):module_name="__main__"+$B.UUID();void 0!==defined_ids[module_name];)module_name="__main__"+$B.UUID();elt.src?$B.tasks.push([$B.ajax_load_script,{name:module_name,url:elt.src}]):(src=elt.innerHTML||elt.textContent,src=src.replace(/^\n/,""),$B.run_script(src,module_name))}}}void 0===options.ipy_id&&$B.loop()};$B.$operators=$operators,$B.$Node=$Node,$B.$NodeJSCtx=$NodeJSCtx,$B.brython=brython}(__BRYTHON__);var brython=__BRYTHON__.brython;__BRYTHON__.isNode&&(__webpack_require__.g.__BRYTHON__=__BRYTHON__,module.exports={__BRYTHON__}),function(n){var o=n.builtins;function l(G,M,P,fe,ye){var ne=n.idb_cx.result.transaction("modules","readwrite").objectStore("modules"),ue=(ne.openCursor(),{name:G,content:M,imports:fe,origin,timestamp:__BRYTHON__.timestamp,source_ts:P,is_package:ye}),me=ne.put(ue);n.debug>1&&console.log("store precompiled",G,"package",ye),document.dispatchEvent(new CustomEvent("precompile",{detail:"cache module "+G}));var ie=n.outdated.indexOf(G);ie>-1&&n.outdated.splice(ie,1),me.onsuccess=function(W){n.tasks.splice(0,0,[x,G]),D()}}function x(G){var M=n.idb_cx.result.transaction("modules","readonly");try{var P=M.objectStore("modules");req=P.get(G),req.onsuccess=function(fe){!function(ye,ne){var ue=ye.target.result;if(void 0===ue||ue.timestamp!=n.timestamp||n.VFS[ne]&&ue.source_ts!==n.VFS[ne].timestamp){if(void 0!==n.VFS[ne]){var me=(je=n.VFS[ne])[0],ie=je[1];if(".py"==me){var W,Q,A=je[2],R=4==je.length,X=je.timestamp;R?W=ne:((Q=ne.split(".")).pop(),W=Q.join(".")),n.imported[ne]=n.module.$factory(ne,"",W);try{var he=n.py2js(ie,ne,ne).to_js()}catch(qe){n.handle_error(qe)}delete n.imported[ne],n.debug>1&&console.log("precompile",ne),(Q=ne.split(".")).length>1&&Q.pop(),n.stdlib.hasOwnProperty(Q.join("."))&&(A=(A=je[2]).join(","),n.tasks.splice(0,0,[l,ne,he,X,A,R]))}else console.log("bizarre",ne,me)}}else if(n.precompiled[ne]=ue.is_package?[ue.content]:ue.content,ue.imports.length>0){n.debug>1&&console.log(ne,"imports",ue.imports);for(var z=ue.imports.split(","),Le=0;Le<z.length;Le++){var K=z[Le];if(K.startsWith(".")){for(var be=ne.split("."),Ne=0;K.startsWith(".");)Ne++,K=K.substr(1);var je=be.slice(0,Ne);K&&(je=je.concat([K])),K=je.join(".")}if(!n.imported.hasOwnProperty(K)&&!n.precompiled.hasOwnProperty(K)&&n.VFS.hasOwnProperty(K)){var Te=n.VFS[K];me=Te[0],ie=Te[1],".py"==Te[0]?n.tasks.splice(0,0,[x,K]):B(K,ie)}}}D()}(fe,G)}}catch(fe){console.info("error",fe)}}function B(G,M){M+="\nvar $locals_"+G.replace(/\./g,"_")+" = $module",n.precompiled[G]=M}n.VFS_timestamp&&n.VFS_timestamp>n.timestamp&&(n.timestamp=n.VFS_timestamp),n.idb_open=function(G){n.idb_name="brython-cache";var M=n.idb_cx=indexedDB.open(n.idb_name);M.onsuccess=function(){var P=M.result;if(P.objectStoreNames.contains("modules")){n.debug>1&&console.info("using indexedDB for stdlib modules cache");var fe,ye=P.transaction("modules","readwrite").objectStore("modules"),ne=[],ue=ye.openCursor();ue.onerror=function(ie){console.log("open cursor error",ie)},ue.onsuccess=function(ie){cursor=ie.target.result,cursor?((fe=cursor.value).timestamp==n.timestamp?n.VFS&&n.VFS[fe.name]&&n.VFS[fe.name].timestamp!=fe.source_ts?ne.push(fe.name):(n.precompiled[fe.name]=fe.is_package?[fe.content]:fe.content,n.debug>1&&console.info("load from cache",fe.name)):ne.push(fe.name),cursor.continue()):(n.debug>1&&console.log("done"),n.outdated=ne,D())}}else{var me=P.version;P.close(),console.info("create object store",me),(M=indexedDB.open(n.idb_name,me+1)).onupgradeneeded=function(){console.info("upgrade needed"),n.idb_cx.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=D},M.onversionchanged=function(){console.log("version changed")},M.onsuccess=function(){console.info("db opened",M),M.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=D}}},M.onupgradeneeded=function(){console.info("upgrade needed"),M.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=D},M.onerror=function(){console.info("could not open indexedDB database"),n.idb_cx=null,n.idb_name=null,n.$options.indexedDB=!1,D()}},n.ajax_load_script=function(G){var M=G.url,P=G.name;if(n.files&&n.files.hasOwnProperty(P))n.tasks.splice(0,0,[n.run_script,n.files[P],P,!0]);else{if("file"==n.protocol)throw o.IOError.$factory("can't load external script at "+G.url+" (Ajax calls not supported with protocol file:///)");var fe=new XMLHttpRequest,ye=n.$options.cache?"":(M.search(/\?/)>-1?"&":"?")+Date.now();fe.open("GET",M+ye,!0),fe.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){var ne=this.responseText;G.is_ww?n.webworkers[P]=ne:n.tasks.splice(0,0,[n.run_script,ne,P,!0]),D()}else if(404==this.status)throw Error(M+" not found")},fe.send()}},n.inImported=function(G){if(!n.imported.hasOwnProperty(G))if(__BRYTHON__.VFS&&__BRYTHON__.VFS.hasOwnProperty(G)){var M=__BRYTHON__.VFS[G];void 0===M&&console.log("bizarre",G);var fe=M[1];".py"==M[0]?n.idb_cx&&!n.idb_cx.$closed&&n.tasks.splice(0,0,[x,G]):B(G,fe)}else console.log("bizarre",G);D()};var D=n.loop=function(){if(0!=n.tasks.length){var G=n.tasks.shift(),M=G[0],P=G.slice(1);if("execute"==M){try{var fe=G[1],ye=fe.__name__.replace(/\./g,"_");(ue=n.module.$factory(fe.__name__)).$src=fe.$src,ue.__file__=fe.__file__,n.imported[ye]=ue,new Function("$locals_"+ye,fe.js)(ue)}catch(me){void 0===me.__class__&&(console.log("Javascript error",me),n.is_recursion_error(me)?me=o.RecursionError.$factory("too much recursion"):(n.print_stack(),me=o.RuntimeError.$factory(me+""))),n.debug>1&&(console.log("handle error",me.__class__,me.args,me.$stack),console.log(n.frames_stack.slice())),n.handle_error(me)}D()}else try{M.apply(null,P)}catch(me){n.handle_error(me)}}else if(n.idb_cx&&!n.idb_cx.$closed){for(var ne=n.idb_cx.result.transaction("modules","readwrite").objectStore("modules");n.outdated.length>0;){var ue=n.outdated.pop();ne.delete(ue).onsuccess=function(me){n.debug>1&&console.info("delete outdated",ue),document.dispatchEvent(new CustomEvent("precompile",{detail:"remove outdated "+ue+" from cache"}))}}document.dispatchEvent(new CustomEvent("precompile",{detail:"close"})),n.idb_cx.result.close(),n.idb_cx.$closed=!0}};n.tasks=[],n.has_indexedDB=void 0!==self.indexedDB,n.handle_error=function(G){if(n.debug>1&&console.log("handle error",G.__class__,G.args),void 0!==G.__class__){var M=n.class_name(G),P=n.$getattr(G,"info");"SyntaxError"==M||"IndentationError"==M?P+="\n    "+" ".repeat(G.args[3])+"^\n"+M+": "+G.args[0]:(P+="\n"+M,G.args[0]&&G.args[0]!==o.None&&(P+=": "+o.str.$factory(G.args[0])))}else console.log(G),P=G+"";try{n.$getattr(n.stderr,"write")(P);try{n.$getattr(n.stderr,"flush")()}catch(ye){console.log(ye)}}catch{console.log(P)}throw G}}(__BRYTHON__),__BRYTHON__.builtins.object=function(n){var o=n.builtins,l={$infos:{__name__:"object"},$is_class:!0,$native:!0};function x(B){return n.$getattr(B,"__new__").apply(null,arguments)}return l.__delattr__=function(B,D){if(D=n.from_alias(D),B.__dict__&&B.__dict__.$string_dict&&void 0!==B.__dict__.$string_dict[D])return delete B.__dict__.$string_dict[D],o.None;if(void 0===B.__dict__&&void 0!==B[D])return delete B[D],o.None;var G=B.__class__;if(G){var M=n.$getattr(G,D);if(M.__class__===o.property&&void 0!==M.__delete__)return M.__delete__(B),o.None}throw o.AttributeError.$factory(D)},l.__dir__=function(B){var D;if(B.$is_class)D=[B].concat(B.__mro__);else{var G=B.__class__||n.get_class(B);D=[B,G].concat(G.__mro__)}for(var M=[],P=0,fe=D.length;P<fe;P++)for(var ye in D[P])"$"!=ye.charAt(0)?isNaN(parseInt(ye.charAt(0)))&&"__mro__"!=ye&&M.push(ye):"$"==ye.charAt(1)&&M.push(ye.substr(2));if(B.__dict__)for(var ye in B.__dict__.$string_dict)"$$"==ye.substr(0,2)?M.push(ye.substr(2)):"$"!=ye.charAt(0)&&M.push(ye);return M=o.list.$factory(o.set.$factory(M)),o.list.sort(M),M},l.__eq__=function(B,D){return B===D||o.NotImplemented},l.__format__=function(){var B=n.args("__format__",2,{self:null,spec:null},["self","spec"],arguments,{},null,null);if(""!==B.spec)throw o.TypeError.$factory("non-empty format string passed to object.__format__");return o.getattr(B.self,"__str__")()},l.__ge__=function(){return o.NotImplemented},l.__getattribute__=function(B,D){var G=B.__class__||n.get_class(B),M=!1;if("__class__"===D)return G;var P=B[D];if(Array.isArray(B)&&void 0!==Array.prototype[D]&&(P=void 0),void 0===P&&B.__dict__){var fe=B.__dict__;if(fe.$string_dict.hasOwnProperty(D))return fe.$string_dict[D][0]}if(void 0===P){let he=function(z,Le,K){var be=Le[K];if(void 0!==be)return be};if(void 0===(P=he(0,G,D)))for(var ye=0,ne=(A=G.__mro__).length;ye<ne&&void 0===(P=he(0,A[ye],D));ye++);else P.__class__!==n.method&&void 0===P.__get__&&(M=!0)}else if(void 0===P.__set__)return P;if(void 0!==P){if(P.__class__===o.property)return P.__get__(P,B,G);if(P.__class__===n.method)return void 0===P.__get__&&console.log("bizarre",B,D,P),P.__get__(B,G);if(void 0===(ue=P.__get__)&&P.__class__){var ue=P.__class__.__get__;for(ye=0;ye<P.__class__.__mro__.length&&void 0===ue;ye++)ue=P.__class__.__mro__[ye].__get__}var me=void 0===ue?null:n.$getattr(P,"__get__",null);if(null!==me)try{return me.apply(null,[B,G])}catch(he){throw console.log("error in get.apply",he),console.log("get attr",D,"of",B),console.log(me+""),he}if("object"==typeof P&&me&&"function"==typeof me&&(get_func=function(he,z){return me.apply(he,[z,G.$factory])}),null===me&&"function"==typeof P&&(me=function(he){return he}),null!==me){P.__name__=D,"__new__"==D&&(P.$type="staticmethod");var ie=me.apply(null,[P,B,G]);if("function"==typeof ie){if(ie.__class__===n.method||"staticmethod"==P.$type)return P;var W=P.__class__===n.method?G:B,Q=function(){for(var he=[W],z=0,Le=arguments.length;z<Le;z++)he.push(arguments[z]);return P.apply(this,he)};return Q.__class__=n.method,(Q.__get__=function(he,z){var Le=P.bind(null,z);return Le.__class__=n.method,Le.$infos={__self__:z,__func__:P,__name__:P.$infos.__name__,__qualname__:z.$infos.__name__+"."+P.$infos.__name__},Le}).__class__=n.method_wrapper,Q.__get__.$infos=P.$infos,void 0===G.$infos&&(console.log("no $infos",G),console.log(n.last(n.frames_stack))),Q.$infos={__self__:W,__func__:P,__name__:D,__qualname__:G.$infos.__name__+"."+D},M&&(B.$method_cache=B.$method_cache||{},B.$method_cache[D]=[Q,P]),Q}return ie}return P}var A,R=B.__getattr__;if(void 0===R&&void 0===(R=G.__getattr__))for(ye=0,ne=(A=G.__mro__).length;ye<ne&&void 0===(R=A[ye].__getattr__);ye++);if(void 0!==R)return G===n.module?R(D):R(B,D);throw o.AttributeError.$factory(D)},l.__gt__=function(){return o.NotImplemented},l.__hash__=function(B){var D=B.__hashvalue__;return void 0!==D?D:B.__hashvalue__=n.$py_next_hash--},l.__init__=function(){if(0==arguments.length)throw o.TypeError.$factory("descriptor '__init__' of 'object' object needs an argument");return o.None},l.__init_subclass__=function(){return n.args("__init_subclass__",0,{},[],arguments,{},null,null),o.None},l.__init_subclass__.$type="staticmethod",l.__le__=function(){return o.NotImplemented},l.__lt__=function(){return o.NotImplemented},l.__mro__=[],l.__new__=function(B,...D){if(void 0===B)throw o.TypeError.$factory("object.__new__(): not enough arguments");if(n.$getattr(B,"__init__")===l.__init__&&D.length>0)throw o.TypeError.$factory("object() takes no parameters");return{__class__:B,__dict__:n.empty_dict()}},l.__ne__=function(B,D){if(B===D)return!1;var G=n.$getattr(B,"__eq__",null);if(null!==G){var M=n.$call(G)(D);return M===o.NotImplemented?M:!n.$bool(M)}return o.NotImplemented},l.__reduce__=function(B){function D(fe){return n.$call(fe)()}D.$infos={__qualname__:"_reconstructor"};var G=[D];G.push(o.tuple.$factory([B.__class__].concat(B.__class__.__mro__)));var M=n.empty_dict();for(var P in B.__dict__.$string_dict)o.dict.$setitem(M.$string_dict,P,B.__dict__.$string_dict[P][0]);return console.log("object.__reduce__, d",M),G.push(M),o.tuple.$factory(G)},x.$infos={__name__:"__newobj__",__qualname__:"__newobj__"},o.__newobj__=x,l.__reduce_ex__=function(B){var D=[x],G=o.tuple.$factory([B.__class__]);Array.isArray(B)&&B.forEach(function(ye){G.push(ye)}),D.push(G);var M=n.empty_dict(),P=0;if(void 0===B.__dict__)throw o.TypeError.$factory("cannot pickle '"+n.class_name(B)+"' object");for(var fe in B.__dict__.$string_dict)"__class__"==fe||fe.startsWith("$")||(o.dict.$setitem(M,fe,B.__dict__.$string_dict[fe][0]),P++);return 0==P&&(M=o.None),D.push(M),D.push(o.None),o.tuple.$factory(D)},l.__repr__=function(B){if(B===l)return"<class 'object'>";if(B.__class__===o.type)return"<class '"+B.__name__+"'>";var D=B.__class__.$infos.__module__;return void 0===D||D.startsWith("$")||"builtins"===D?"<"+n.class_name(B)+" object>":"<"+B.__class__.$infos.__module__+"."+n.class_name(B)+" object>"},l.__setattr__=function(B,D,G){if(void 0===G)throw o.TypeError.$factory("can't set attributes of built-in/extension type 'object'");if(B.__class__===l)throw o.AttributeError.$factory(void 0===l[D]?"'object' object has no attribute '"+D+"'":"'object' object attribute '"+D+"' is read-only");return n.aliased_names[D]&&(D="$$"+D),B.__dict__?o.dict.$setitem(B.__dict__,D,G):B[D]=G,o.None},l.__setattr__.__get__=function(B){return function(D,G){l.__setattr__(B,D,G)}},l.__setattr__.__str__=function(){return"method object.setattr"},l.__str__=function(B){var D=n.$getattr(B,"__repr__");return n.$call(D)()},l.__subclasshook__=function(){return o.NotImplemented},l.$factory=function(){var B={__class__:l},D=[B].concat(Array.prototype.slice.call(arguments));return l.__init__.apply(null,D),B},n.set_func_names(l,"builtins"),n.make_class=function(B,D){var G={__class__:o.type,__mro__:[l],$infos:{__name__:B},$is_class:!0};return G.$factory=D,G},l}(__BRYTHON__),function(n){var o=n.builtins;n.$class_constructor=function(M,P,fe,ye,ne){var ue;fe=fe||[];var me=P.__module__;void 0===me&&(me=P.__module__=n.last(n.frames_stack)[2]);for(var ie=0;ie<fe.length;ie++)if(void 0===fe[ie])throw n.line_info=P.$def_line,o.NameError.$factory("name '"+ye[ie]+"' is not defined");var W={},Q={};if(ne)for(ie=0;ie<ne.length;ie++){var R=ne[ie][1];"metaclass"==(A=ne[ie][0])?ue=R:W[A]=R,Q[A]=R}var X=P;void 0!==P.__eq__&&void 0===P.__hash__&&(P.__hash__=o.None);var he=fe.slice(),z=!1;for(ie=0;ie<fe.length;ie++)if(void 0===fe[ie]||void 0===fe[ie].__mro__){var Le=n.$getattr(fe[ie],"__mro_entries__",o.None);if(Le!==o.None){var K=o.list.$factory(Le(fe));fe.splice(ie,1,...K),z=!0,ie--;continue}}if(void 0===ue)if(fe&&fe.length>0){if(void 0===(ue=fe[0].__class__)){if("function"!=typeof fe[0])throw o.TypeError.$factory("Argument of "+M+"is not a class (type '"+n.class_name(fe[0])+"')");if(1!=fe.length)throw o.TypeError.$factory("A Brython class can inherit at most 1 Javascript constructor");ue=fe[0].__class__=n.JSMeta,n.set_func_names(fe[0],me)}for(ie=1;ie<fe.length;ie++){var be=fe[ie].__class__;if(be!==ue&&!o.issubclass(ue,be))if(o.issubclass(be,ue))ue=be;else if(ue.__bases__&&-1==ue.__bases__.indexOf(be))throw o.TypeError.$factory("metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases")}}else ue=o.type;var Ne=n.$getattr(ue,"__prepare__",o.None),je=n.$call(Ne)(M,fe);for(var Te in set_class_item=je.__class__!==o.dict?n.$getattr(je,"__setitem__"):function(fn,On){je.$string_dict[fn]=[On,je.$order++]},P)if("__annotations__"==Te)for(var A in void 0===je.$string_dict[Te]&&(je.$string_dict[Te]=[n.empty_dict(),je.$order++]),P[Te].$string_dict)n.$setitem(je.$string_dict[Te][0],A,P[Te].$string_dict[A][0]);else"$"==Te.charAt(0)&&"$$"!=Te.substr(0,2)||set_class_item(Te,P[Te]);z&&set_class_item("__orig_bases__",o.tuple.$factory(he));var qe={__bases__:fe,__class__:ue,__dict__:je};if(je.__class__===o.dict)for(var A in je.$string_dict)qe[A]=je.$string_dict[A][0];else for(var Ke=n.$getattr(je,"__getitem__"),vt=o.iter(je);;)try{qe[A=o.next(vt)]=Ke(A)}catch{break}qe.__mro__=o.type.mro(qe).slice(1);var ht=!0,Bt={},wt={},Ft=[qe].concat(qe.__mro__);for(ie=0;ie<Ft.length;ie++){var Ot=0==ie?X:Ft[ie];for(var Te in Ot)if(!Bt[Te]){var on=Ot[Te];"function"==typeof on&&(!0===on.__isabstractmethod__||on.$attrs&&on.$attrs.__isabstractmethod__?(ht=!1,wt[Te]=!0):Bt[Te]=!0)}}var ft=P.__slots__;for(void 0!==ft&&(ft="string"==typeof ft?[ft]:o.list.$factory(ft),je.__slots__=ft),ie=0;ie<Ft.length-1;ie++)for(var Te in Ft[ie]){if("__setattr__"==Te){je.$has_setattr=!0;break}if(Ft[ie][Te]&&(Ft[ie][Te].__get__||Ft[ie][Te].__class__&&Ft[ie][Te].__class__.__get__)){je.$has_setattr=!0;break}}var An=o.type.__getattribute__(ue,"__new__")(ue,M,fe,je);for(var Te in An.__module__=me,An.$infos={__module__:me,__name__:n.from_alias(M),__qualname__:P.$qualname},An.$subclasses=[],P)"$"==Te.charAt(0)&&"$$"!=Te.substr(0,2)||"function"==typeof P[Te]&&(P[Te].$infos.$class=An);for(An.__class__===ue&&o.type.__getattribute__(ue,"__init__")(An,M,fe,je),ie=0;ie<fe.length;ie++)fe[ie].$subclasses=fe[ie].$subclasses||[],fe[ie].$subclasses.push(An);var Cn=o.$$super.$factory(An,An);return o.$$super.__getattribute__(Cn,"__init_subclass__")({$nat:"kw",kw:W}),ht||(An.$factory=function(){throw o.TypeError.$factory("Can't instantiate abstract class interface with abstract methods "+Object.keys(wt).join(", "))}),An.__qualname__=M.replace("$$",""),An};var l=n.make_class("type",function(M,P,fe){return 1==arguments.length?void 0===M?n.UndefinedClass:M.__class__||n.get_class(M):l.__new__(l,M,P,fe)});l.__call__=function(){for(var M=[],P=arguments[0],fe=1,ye=arguments.length;fe<ye;fe++)M.push(arguments[fe]);var ne=o.type.__getattribute__(P,"__new__").apply(null,arguments);if(ne.__class__===P){var ue=o.type.__getattribute__(P,"__init__");if(ue!==o.object.__init__){var me=[ne].concat(M);ue.apply(null,me)}}return ne},l.__class__=l,l.__format__=function(M,P){return o.str.$factory(M)},l.__getattribute__=function(M,P){switch(P){case"__annotations__":for(var fe=0,ye=(ie=[M].concat(M.__mro__)).length;fe<ye;fe++)if(ie[fe].__dict__){var ne=ie[fe].__dict__.$string_dict.__annotations__[0];if(ne)if(void 0===R)R=ne;else if(R.__class__===o.dict&&ne.__class__===o.dict)for(var ue in ne.$string_dict)R.$string_dict[ue]=ne.$string_dict[ue]}return void 0===R&&(R=n.empty_dict()),R;case"__bases__":return(R=M.__bases__||o.tuple.$factory()).__class__=o.tuple,0==R.length&&R.push(o.object),R;case"__class__":return M.__class__;case"__doc__":return M.__doc__||o.None;case"__setattr__":if(void 0!==M.__setattr__)var me=M.__setattr__;else me=function(Le,K,be){Le[K]=be};return B.$factory(P,M,me);case"__delattr__":return void 0!==M.__delattr__?M.__delattr__:B.$factory(P,M,function(Le){delete M[Le]})}if(void 0===(R=M[P])&&M.__slots__&&M.__slots__.indexOf(P)>-1)return D.$factory(P,M);if(M.__class__&&M.__class__[P]&&M.__class__[P].__get__&&M.__class__[P].__set__)return M.__class__[P].__get__(M);if(void 0===R){var ie;if(void 0===(W=M[P]))for(void 0===(ie=M.__mro__)&&console.log("pas de mro pour",M),fe=0;fe<ie.length;fe++){var W;if(void 0!==(W=ie[fe][P])){R=W;break}}else R=W;if(void 0===R){var Q=M.__class__||n.get_class(M);if(void 0===(R=Q[P])){var A=Q.__mro__;for(fe=0;fe<A.length;fe++){var R;if(void 0!==(R=A[fe][P]))break}}if(void 0!==R){if(R.__class__===o.property)return R.fget(M);if("function"==typeof R){var X=R.bind(null,M);return X.__class__=n.method,X.$infos={__self__:M,__func__:R,__name__:P,__qualname__:M.$infos.__name__+"."+P,__module__:R.$infos?R.$infos.__module__:""},X}}if(void 0===R){var he=Q.__getattr__;if(void 0===he)for(fe=0;fe<A.length;fe++)if(void 0!==A[fe].__getattr__){he=A[fe].__getattr__;break}if(void 0!==he)return he(M,P)}}}if(void 0!==R){if(R.__class__===o.property)return R;if(R.__get__){if(R.__class__===G){var z=R.__get__(R.__func__,M);z.$infos={__func__:R,__name__:R.$infos.__name__,__qualname__:M.$infos.__name__+"."+R.$infos.__name__,__self__:M}}else z=R.__get__(M);return z}return!R.__class__||!R.__class__.__get__||P.startsWith("__")&&P.endsWith("__")?"function"==typeof R?(void 0===R.$infos&&n.debug>1&&console.log("warning: no attribute $infos for",R,"klass",M,"attr",P),"__new__"==P&&(R.$type="staticmethod"),"__class_getitem__"==P&&R.__class__!==n.method&&(R=o.classmethod.$factory(R)),"__init_subclass__"==P&&(R=o.classmethod.$factory(R)),R.__class__===n.method?R.__get__(null,M):R):R:R.__class__.__get__(R,o.None,M)}},l.__hash__=function(M){return o.hash(M)},l.__init__=function(){},l.__init_subclass__=function(){var M=n.args("__init_subclass__",1,{},[],arguments,{},"args","kwargs");if(void 0!==M.kwargs&&(M.kwargs.__class__!==o.dict||Object.keys(M.kwargs.$string_dict).length>0))throw o.TypeError.$factory("__init_subclass__() takes no keyword arguments");return o.None},l.__instancecheck__=function(M,P){var fe=P.__class__||n.get_class(P);if(fe===M)return!0;for(var ye=0;ye<fe.__mro__.length;ye++)if(fe.__mro__[ye]===M)return!0;return!1},l.__instancecheck__.$type="staticmethod",l.__name__={__get__:function(M){return M.$infos.__name__},__set__:function(M,P){M.$infos.__name__=P},__str__:function(M){return"type"},__eq__:function(M,P){return M.$infos.__name__==P}},l.__new__=function(M,P,fe,ye){var ne=ye.$string_dict.__module__;ne&&(ne=ne[0]);var ue={__class__:M,__bases__:fe,__dict__:ye,$infos:{__name__:P.replace("$$",""),__module__:ne},$is_class:!0,$has_setattr:ye.$has_setattr};ue.__mro__=l.mro(ue).slice(1);for(var me=n.dict_to_list(ye),ie=0;ie<me.length;ie++){var W=n.to_alias(me[ie][0]),Q=me[ie][1];if("__module__"!==W&&void 0!==Q){if(ue[W]=Q,Q.__class__){var A=n.$getattr(Q.__class__,"__set_name__",o.None);A!==o.None&&A(Q,ue,W)}"function"==typeof Q&&(void 0===Q.$infos&&(console.log("type new",Q,Q+""),console.log(n.frames_stack.slice())),Q.$infos.$class=ue,Q.$infos.__qualname__=P+"."+Q.$infos.__name__,Q.$infos.$defaults)&&n.Function.__setattr__(Q,"__defaults__",Q.$infos.$defaults)}}return ue},l.__repr__=l.__str__=function(M){void 0===M.$infos&&console.log("no $infos",M);var P=M.$infos.__qualname__;return M.$infos.__module__&&"builtins"!=M.$infos.__module__&&!M.$infos.__module__.startsWith("$")&&(P=M.$infos.__module__+"."+P),"<class '"+P+"'>"},l.__prepare__=function(){return n.empty_dict()},l.__qualname__={__get__:function(M){return M.$infos.__qualname__||M.$infos.__name__},__set__:function(M,P){M.$infos.__qualname__=P},__str__:function(M){console.log("type.__qualname__")},__eq__:function(M,P){return M.$infos.__qualname__==P}},l.mro=function(M){for(var P=M.__bases__,fe=[],ye=0,ne=0;ne<P.length;ne++){P[ne]===o.str&&(P[ne]=n.StringSubclass);var ue=[],me=0;if(void 0===P[ne]||void 0===P[ne].__mro__){if(void 0===P[ne].__class__)return[o.object];throw o.TypeError.$factory("Object passed as base class is not a class")}ue[me++]=P[ne];var ie=P[ne].__mro__;ie[0]===P[ne]&&ie.splice(0,1);for(var W=0;W<ie.length;W++)ue[me++]=ie[W];fe[ye++]=ue}-1==P.indexOf(o.object)&&(P=P.concat(o.tuple.$factory([o.object]))),fe[ye++]=P.slice();for(var Q=[M],A=1;;){var R=[];for(me=0,ne=0;ne<fe.length;ne++)fe[ne].length>0&&(R[me++]=fe[ne]);if(0==R.length)break;for(ne=0;ne<R.length;ne++){for(var X=R[ne][0],he=[],z=(me=0,0);z<R.length;z++){var Le=R[z];Le.slice(1).indexOf(X)>-1&&(he[me++]=Le)}if(!(he.length>0))break;X=null}if(null===X)throw o.TypeError.$factory("inconsistent hierarchy, no C3 MRO is possible");for(Q[A++]=X,ne=0;ne<fe.length;ne++)fe[ne][0]===X&&fe[ne].shift()}return Q[Q.length-1]!==o.object&&(Q[A++]=o.object),Q},l.__subclasscheck__=function(M,P){var fe=M;return fe===o.str?fe=n.StringSubclass:fe===o.float&&(fe=n.FloatSubclass),void 0===P.__bases__?M===o.object:P.__bases__.indexOf(fe)>-1},n.set_func_names(l,"builtins"),o.type=l;var x=n.make_class("wrapper_descriptor");n.set_func_names(x,"builtins"),l.__call__.__class__=x,n.$instance_creator=function(M){if(void 0!==M.$instanciable)return function(){throw o.TypeError.$factory("Can't instantiate abstract class interface with abstract methods")};var P,fe=M.__class__;if(fe!==o.type||M.__bases__&&0!=M.__bases__.length){P=o.type.__getattribute__(fe,"__call__");var ye=function(){return P.bind(null,M).apply(null,arguments)}}else ye=M.hasOwnProperty("__new__")?M.hasOwnProperty("__init__")?function(){var ne=M.__new__.bind(null,M).apply(null,arguments);return M.__init__.bind(null,ne).apply(null,arguments),ne}:function(){return M.__new__.bind(null,M).apply(null,arguments)}:M.hasOwnProperty("__init__")?function(){var ne={__class__:M,__dict__:n.empty_dict()};return M.__init__.bind(null,ne).apply(null,arguments),ne}:function(){if(arguments.length>0&&(1!=arguments.length||!arguments[0].$nat||0!=Object.keys(arguments[0].kw).length))throw o.TypeError.$factory("object() takes no parameters");return{__class__:M,__dict__:n.empty_dict()}};return ye.__class__=n.Function,ye.$infos={__name__:M.$infos.__name__,__module__:M.$infos.__module__},ye};var B=n.method_wrapper=n.make_class("method_wrapper",function(M,P,fe){var ye=function(){return fe.apply(null,arguments)};return ye.$infos={__name__:M,__module__:P.__module__},ye});B.__str__=B.__repr__=function(M){return"<method '"+M.$infos.__name__+"' of function object>"};var D=n.make_class("member_descriptor",function(M,P){return{__class__:D,cls:P,attr:M}});D.__str__=D.__repr__=function(M){return"<member '"+M.attr+"' of '"+M.cls.$infos.__name__+"' objects>"},n.set_func_names(D,"builtins");var G=n.method=n.make_class("method",function(M,P){var fe=function(){return n.$call(M).bind(null,P).apply(null,arguments)};return fe.__class__=G,fe.$infos=M.$infos,fe});G.__eq__=function(M,P){return void 0!==M.$infos&&void 0!==P.$infos&&M.$infos.__func__===P.$infos.__func__&&M.$infos.__self__===P.$infos.__self__},G.__ne__=function(M,P){return!n.method.__eq__(M,P)},G.__get__=function(M){var P=function(){return M(arguments)};return P.__class__=n.method_wrapper,P.$infos=G.$infos,P},G.__getattribute__=function(M,P){var fe=M.$infos;if(fe&&fe[P]){if("__code__"==P){var ye={__class__:n.Code};for(var P in fe.__code__)ye[P]=fe.__code__[P];return ye}return fe[P]}return G.hasOwnProperty(P)?o.object.__getattribute__(M,P):n.Function.__getattribute__(M.$infos.__func__,P)},G.__repr__=G.__str__=function(M){return"<bound method "+M.$infos.__qualname__+" of "+o.str.$factory(M.$infos.__self__)+">"},G.__setattr__=function(M,P,fe){throw"__class__"==P?o.TypeError.$factory("__class__ assignment only supported for heap types or ModuleType subclasses"):o.AttributeError.$factory("'method' object has no attribute '"+P+"'")},n.set_func_names(G,"builtins"),n.method_descriptor=n.make_class("method_descriptor"),n.classmethod_descriptor=n.make_class("classmethod_descriptor"),n.GenericAlias=n.make_class("GenericAlias",function(M,P){return{__class__:n.GenericAlias,origin_class:M,items:P}}),n.GenericAlias.__args__={__get__:function(M){return n.fast_tuple(M.items)}},n.GenericAlias.__call__=function(M,...P){return M.origin_class.$factory.apply(null,P)},n.GenericAlias.__eq__=function(M,P){return n.rich_comp("__eq__",M.origin_class,P.origin_class)&&n.rich_comp("__eq__",M.items,P.items)},n.GenericAlias.__getitem__=function(M,P){throw o.TypeError.$factory("descriptor '__getitem__' for '"+M.origin_class.$infos.__name__+"' objects doesn't apply to a '"+n.class_name(P)+"' object")},n.GenericAlias.__origin__={__get__:function(M){return M.origin_class}},n.GenericAlias.__parameters__={__get__:function(M){return n.fast_tuple([])}},n.GenericAlias.__repr__=function(M){for(var P=M.items,fe=0,ye=P.length;fe<ye;fe++)P[fe]=P[fe]===o.Ellipsis?"...":P[fe].$infos.__name__;return M.origin_class.$infos.__qualname__+"["+P.join(", ")+"]"},o.object.__class__=l}(__BRYTHON__),function($B){var _b_=$B.builtins,_window=self,isWebWorker=typeof WorkerGlobalScope<"u"&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator;function index_error(n){throw _b_.IndexError.$factory(("string"==typeof n?"string":"list")+" index out of range")}$B.args=function(n,o,l,x,B,D,G,M){n.startsWith("lambda_"+$B.lambda_magic)&&(n="<lambda>");var P,fe,ye=!1,ne=B.length,ue=0,me=x.indexOf("/");if(-1!=me&&(x.splice(me,1),fe=x.slice(0,me)),ne>0&&B[ne-1].$nat&&(ne--,Object.keys(B[ne].kw).length>0)){ye=!0;var ie=B[ne].kw;if(Array.isArray(ie)){for(var W=ie[0],Q=1,A=ie.length;Q<A;Q++){var R=ie[Q];if(R.__class__===_b_.dict){for(var X in R.$numeric_dict)throw _b_.TypeError.$factory(n+"() keywords must be strings");for(var X in R.$object_dict)throw _b_.TypeError.$factory(n+"() keywords must be strings");for(var X in R.$string_dict){if(void 0!==W[X])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+X+"'");W[X]=R.$string_dict[X][0]}}else for(var he=_b_.iter(R),z=$B.$getattr(R,"__getitem__");;)try{if("string"!=typeof(X=_b_.next(he)))throw _b_.TypeError.$factory(n+"() keywords must be strings");if(void 0!==W[X])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+X+"'");W[X]=z(X)}catch(qe){if($B.is_exc(qe,[_b_.StopIteration]))break;throw qe}}ie=W}}if(G&&(l[G]=[],l[G].__class__=_b_.tuple),M&&(P=$B.empty_dict()),ne>o){if(null===G||"*"==G)throw _b_.TypeError.$factory(Te=n+"() takes "+o+" positional argument"+(o>1?"s":"")+" but more were given");for(Q=o;Q<ne;Q++)l[G].push(B[Q]);ne=o}for(Q=0;Q<ne;Q++)l[x[Q]]=B[Q],ue++;if(ue==o&&o===x.length&&!ye)return M&&(l[M]=P),l;if(ye)for(var Le in ie){var K=ie[Le],be=$B.to_alias(Le);if(void 0===l[be]){if(!M)throw _b_.TypeError.$factory(n+"() got an unexpected keyword argument '"+Le+"'");"$$"==Le.substr(0,2)&&(Le=Le.substr(2)),P.$string_dict[Le]=[K,P.$order++]}else{if(null!==l[be])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+Le+"'");if(fe&&fe.indexOf(be)>-1)throw _b_.TypeError.$factory(n+"() got an unexpected keyword argument '"+Le+"'");l[be]=K}}var Ne=[];for(var je in l)null===l[je]&&(void 0!==D[je]?l[je]=D[je]:Ne.push("'"+je+"'"));if(Ne.length>0){if(1==Ne.length)throw _b_.TypeError.$factory(n+" missing 1 positional argument: "+Ne[0]);var Te=n+" missing "+Ne.length+" positional arguments: ";throw Te+=Ne.join(" and "),_b_.TypeError.$factory(Te)}return M&&(l[M]=P),l},$B.wrong_nb_args=function(n,o,l,x){if(o<l){var B=l-o;throw _b_.TypeError.$factory(n+"() missing "+B+" positional argument"+(B>1?"s":"")+": "+x.slice(o))}throw _b_.TypeError.$factory(n+"() takes "+l+" positional argument"+(l>1?"s":"")+" but more were given")},$B.get_class=function(n){if(null===n)return $B.$NoneDict;if(void 0===n)return $B.UndefinedClass;var o=n.__class__;if(void 0===o)switch(typeof n){case"number":return n%1==0?_b_.int:_b_.float;case"string":return _b_.str;case"boolean":return _b_.bool;case"function":return n.$is_js_func?$B.JSObj:(n.__class__=$B.Function,$B.Function);case"object":if(Array.isArray(n)){if(Object.getPrototypeOf(n)===Array.prototype)return n.__class__=_b_.list,_b_.list}else{if(n.constructor===Number)return _b_.float;if(typeof Node<"u"&&n instanceof Node)return $B.DOMNode}}return void 0===o?$B.JSObj:o},$B.class_name=function(n){var o=$B.get_class(n);return o===$B.JSObj?"Javascript "+n.constructor.name:o.$infos.__name__},$B.$list_comp=function(n){for(var o=$B.UUID(),l="x"+o+" = []\n",x=0,B=1,D=n.length;B<D;B++){var G=n[B].replace(/\s+$/,"").replace(/\n/g,"");l+=" ".repeat(x)+G+":\n",x+=4}return l+=" ".repeat(x),[l+="x"+o+".append("+n[0]+")\n",o]},$B.$dict_comp=function(n,o,l,x){for(var B=$B.UUID(),D="comp_result_"+$B.lambda_magic+B,G=D+" = {}\n",M=0,P=1,fe=l.length;P<fe;P++){var ye=l[P].replace(/\s+$/,"").replace(/\n/g,"");G+="    ".repeat(M)+ye+":\n",M++}G+="    ".repeat(M)+D+".update({"+l[0]+"})";var ue="dc"+B,me=$B.py2js({src:G,is_comp:!0,line_info:x+","+n},n,ue,o,x),ie=me.outermost_expr.to_js(),W=me.to_js();return W="(function(expr){"+(W+="\nreturn "+D+"\n")+"})("+ie+")",$B.clear_ns(ue),delete $B.$py_src[ue],W},$B.$gen_expr=function(n,o,l,x,B){for(var D=$B.UUID(),G=(B?"set_comp"+$B.lambda_magic:"__ge")+D,M=`def ${G}(expr):\n`,P=1,fe=1,ye=l.length;fe<ye;fe++){var ne=l[fe].replace(/\s+$/,"").replace(/\n/g,"");M+=" ".repeat(P)+ne+":\n",P+=4}M+=" ".repeat(P);var me=$B.py2js({src:M+="yield ("+l[0]+")",is_comp:!0,line_info:x+","+n,ix:D},G,G,o,x),ie=me.to_js(),W=ie.split("\n");void 0===me.outermost_expr&&console.log("no outermost",n,o);var Q=me.outermost_expr.to_js();return ie=W.join("\n"),"(function($locals_"+G+"){"+(ie+="\nvar $res = $B.generator.$factory("+G+")("+Q+");\nreturn $res\n")+"})($locals)\n"},$B.copy_namespace=function(){var n={};for(const l of $B.frames_stack)for(const x of[l[1],l[3]])for(var o in x)!o.startsWith("$$")&&o.startsWith("$")||(n[o]=x[o]);return n},$B.clear_ns=function(n){n.startsWith("__ge")&&console.log("clear ns",n);var o=n.length;for(var l in $B.$py_module_path)l.substr(0,o)==n&&($B.$py_module_path[l]=null,delete $B.$py_module_path[l]);$B.$py_src[n]=null,delete $B.$py_src[n];var x=n.replace(/\./g,"_");x!=n&&$B.clear_ns(x)},$B.from_alias=function(n){return"$$"==n.substr(0,2)&&$B.aliased_names[n.substr(2)]?n.substr(2):n},$B.$search=function(n,o){var l=$B.last($B.frames_stack);if(void 0!==l[1][n])return l[1][n];if(void 0!==l[3][n])return l[3][n];if(void 0!==_b_[n])return _b_[n];throw l[0]==l[2]||"class"==l[1].$type||l[1].$exec_locals?_b_.NameError.$factory("name '"+n+"' is not defined"):_b_.UnboundLocalError.$factory("local variable '"+n+"' referenced before assignment")},$B.$global_search=function(n,o){for(var l=0;l<$B.frames_stack.length;l++){var x=$B.frames_stack[l];if(o.indexOf(x[0])>-1&&void 0!==x[1][n])return x[1][n];if(o.indexOf(x[2])>-1&&void 0!==x[3][n])return x[3][n]}for(l=0;l<o.length;l++){var B=o[l];if($B.imported[B]&&$B.imported[B][n])return $B.imported[B][n]}throw _b_.NameError.$factory("name '"+$B.from_alias(n)+"' is not defined")},$B.$local_search=function(n){var o=$B.last($B.frames_stack);if(void 0!==o[1][n])return o[1][n];throw _b_.UnboundLocalError.$factory("local variable '"+$B.from_alias(n)+"' referenced before assignment")},$B.$check_def=function(n,o){if(void 0!==o)return o;if(void 0!==_b_[n])return _b_[n];var l=$B.last($B.frames_stack);if(void 0!==l[3][n])return l[3][n];throw _b_.NameError.$factory("name '"+$B.from_alias(n)+"' is not defined")},$B.$check_def_local=function(n,o){if(void 0!==o)return o;throw _b_.UnboundLocalError.$factory("local variable '"+$B.from_alias(n)+"' referenced before assignment")},$B.$check_def_free=function(n,o){if(void 0!==o)return o;for(var l,x=$B.frames_stack.length-1;x>=0;x--)if(void 0!==(l=$B.frames_stack[x][1][n])||void 0!==(l=$B.frames_stack[x][3][n]))return l;throw _b_.NameError.$factory("free variable '"+$B.from_alias(n)+"' referenced before assignment in enclosing scope")},$B.$check_def_free1=function(n,o){for(var l,x=$B.frames_stack.length-1;x>=0;x--){var B=$B.frames_stack[x];if(void 0!==(l=B[1][n])||B[1].$parent&&void 0!==(l=B[1].$parent[n])||B[2]==o&&void 0!==(l=B[3][n]))return l}throw _b_.NameError.$factory("free variable '"+$B.from_alias(n)+"' referenced before assignment in enclosing scope")},$B.$JS2Py=function(n){return"number"==typeof n?n%1==0?n:_b_.float.$factory(n):null==n?_b_.None:(Array.isArray(n)&&Object.getPrototypeOf(n)===Array.prototype&&(n.$brython_class="js"),n)},$B.list_key=function(n,o){(o=$B.$GetInt(o))<0&&(o+=n.length);var l=n[o];if(void 0===l)throw _b_.IndexError.$factory("list index out of range");return l},$B.list_slice=function(n,o,l){return null===o?o=0:(o=$B.$GetInt(o))<0&&(o=Math.max(0,o+n.length)),null===l?n.slice(o):((l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length)),n.slice(o,l))},$B.list_slice_step=function(n,o,l,x){if(null===x||1==x)return $B.list_slice(n,o,l);if(0==x)throw _b_.ValueError.$factory("slice step cannot be zero");x=$B.$GetInt(x),null===o?o=x>=0?0:n.length-1:(o=$B.$GetInt(o))<0&&(o=Math.min(0,o+n.length)),null===l?l=x>=0?n.length:-1:(l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length));var B=[];if(x>0)for(var D=o;D<l;D+=x)B.push(n[D]);else for(D=o;D>l;D+=x)B.push(n[D]);return B},$B.$getitem=function(n,o){var l=Array.isArray(n)&&n.__class__===_b_.list;if("number"==typeof o&&(l||"string"==typeof n)){if(void 0!==n[o=o>=0?o:n.length+o])return n[o];index_error(n)}try{o=$B.$GetInt(o)}catch{}if((l||"string"==typeof n)&&"number"==typeof o){if(void 0!==n[o=o>=0?o:n.length+o])return n[o];index_error(n)}if(n.$is_class){var x=$B.$getattr(n,"__class_getitem__",_b_.None);if(x!==_b_.None)return x(o);if(n.__class__&&(x=$B.$getattr(n.__class__,"__getitem__",_b_.None))!==_b_.None)return x(n,o)}if(l)return _b_.list.$getitem(n,o);var B=$B.$getattr(n,"__getitem__",_b_.None);if(B!==_b_.None)return B(o);throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not subscriptable")},$B.getitem_slice=function(n,o){var l;return Array.isArray(n)?(o.start===_b_.None&&o.stop===_b_.None?o.step===_b_.None||1==o.step?l=n.slice():-1==o.step&&(l=n.slice().reverse()):o.step===_b_.None&&(o.start===_b_.None&&(o.start=0),o.stop===_b_.None&&(o.stop=n.length),"number"==typeof o.start&&"number"==typeof o.stop&&(o.start<0&&(o.start+=n.length),o.stop<0&&(o.stop+=n.length),l=n.slice(o.start,o.stop))),l?(l.__class__=n.__class__,l):_b_.list.$getitem(n,o)):$B.$getattr(n,"__getitem__")(o)},$B.set_list_key=function(n,o,l){try{o=$B.$GetInt(o)}catch{if(_b_.isinstance(o,_b_.slice)){var x=_b_.slice.$conv_for_seq(o,n.length);return $B.set_list_slice_step(n,x.start,x.stop,x.step,l)}}if(o<0&&(o+=n.length),void 0===n[o])throw console.log(n,o),_b_.IndexError.$factory("list assignment index out of range");n[o]=l},$B.set_list_slice=function(n,o,l,x){null===o?o=0:(o=$B.$GetInt(o))<0&&(o=Math.max(0,o+n.length)),null===l&&(l=n.length),(l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length));var B=_b_.list.$factory(x);n.splice.apply(n,[o,l-o].concat(B))},$B.set_list_slice_step=function(n,o,l,x,B){if(null===x||1==x)return $B.set_list_slice(n,o,l,B);if(0==x)throw _b_.ValueError.$factory("slice step cannot be zero");x=$B.$GetInt(x),o=null===o?x>0?0:n.length-1:$B.$GetInt(o),l=null===l?x>0?n.length:-1:$B.$GetInt(l);var D,G=_b_.list.$factory(B),M=0,P=0;D=x>0?function(ye){return ye<l}:function(ye){return ye>l};for(var fe=o;D(fe);fe+=x)P++;if(P!=G.length)throw _b_.ValueError.$factory("attempt to assign sequence of size "+G.length+" to extended slice of size "+P);for(fe=o;D(fe);fe+=x)n[fe]=G[M],M++},$B.$setitem=function(n,o,l){if(!Array.isArray(n)||void 0!==n.__class__||"number"!=typeof o||_b_.isinstance(n,_b_.tuple)){if(n.__class__!==_b_.dict)return n.__class__===_b_.list?_b_.list.$setitem(n,o,l):void $B.$getattr(n,"__setitem__")(o,l);_b_.dict.$setitem(n,o,l)}else{if(o<0&&(o+=n.length),void 0===n[o])throw _b_.IndexError.$factory("list assignment index out of range");n[o]=l}},$B.augm_item_add=function(n,o,l){if(Array.isArray(n)&&"number"==typeof o&&void 0!==n[o]){if(Array.isArray(n[o])&&Array.isArray(l)){for(var x=0,B=l.length;x<B;x++)n[o].push(l[x]);return}if("string"==typeof n[o]&&"string"==typeof l)return void(n[o]+=l)}var D=$B.$getattr;try{var G=D(D(n,"__getitem__")(o),"__iadd__")}catch{return void D(n,"__setitem__")(o,D(D(n,"__getitem__")(o),"__add__")(l))}G(l)};for(var augm_item_src=""+$B.augm_item_add,augm_ops=[["-=","sub"],["*=","mul"]],i=0,len=augm_ops.length;i<len;i++){var augm_code=augm_item_src.replace(/add/g,augm_ops[i][1]);augm_code=augm_code.replace(/\+=/g,augm_ops[i][0]),eval("$B.augm_item_"+augm_ops[i][1]+"="+augm_code)}$B.extend=function(n,o){for(var l=2;l<arguments.length;l++)for(var x=arguments[l],B=_b_.iter(x),D=$B.$getattr(x,"__getitem__");;)try{var G=_b_.next(B);if("string"!=typeof G)throw _b_.TypeError.$factory(n+"() keywords must be strings");if(void 0!==o[G])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+G+"'");o[G]=D(G)}catch(M){if(_b_.isinstance(M,[_b_.StopIteration]))break;throw M}return o},$B.extend_list=function(){for(var n=Array.prototype.slice.call(arguments,0,arguments.length-1),o=$B.last(arguments),l=_b_.iter(o);;)try{n.push(_b_.next(l))}catch(x){if(_b_.isinstance(x,[_b_.StopIteration]))break;throw x}return n},$B.$test_item=function(n){return $B.$test_result=n,_b_.bool.$factory(n)},$B.$test_expr=function(){return $B.$test_result},$B.$is=function(n,o){return n instanceof Number&&o instanceof Number?n.valueOf()==o.valueOf():n===_b_.int&&o==$B.long_int||n===$B.long_int&&o===_b_.int||n===o},$B.$is_member=function(n,o){var l,x,B;try{B=$B.$getattr(o.__class__||$B.get_class(o),"__contains__")}catch{}if(B)return $B.$call(B)(o,n);try{x=_b_.iter(o)}catch{}if(x)for(;;)try{var D=_b_.next(x);if($B.rich_comp("__eq__",D,n))return!0}catch{return!1}try{l=$B.$getattr(o,"__getitem__")}catch{throw _b_.TypeError.$factory("'"+$B.class_name(o)+"' object is not iterable")}if(l)for(var G=-1;;){G++;try{if(D=l(G),$B.rich_comp("__eq__",D,n))return!0}catch(M){if(M.__class__===_b_.IndexError)return!1;throw M}}},$B.$call=function(n){if(n.__class__===$B.method||n.$is_func||"function"==typeof n)return n;if(n.$factory)return n.$factory;if(n.$is_class)return n.$factory=$B.$instance_creator(n);try{return $B.$getattr(n,"__call__")}catch{throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not callable")}};var $io=$B.make_class("io",function(n){return{__class__:$io,out:n}});function $err(n,o,l){var x="unsupported operand type(s) for "+n+" : '"+o.$infos.__name__+"' and '"+$B.class_name(l)+"'";throw _b_.TypeError.$factory(x)}$io.flush=function(){},$io.write=function(n,o){return console[n.out](o),_b_.None},$B.stderr=void 0!==console.error?$io.$factory("error"):$io.$factory("log"),$B.stdout=$io.$factory("log"),$B.stdin={__class__:$io,__original__:!0,closed:!1,len:1,pos:0,read:function(){return""},readline:function(){return""}},$B.make_iterator_class=function(n){var o={__class__:_b_.type,__mro__:[_b_.object],$factory:function(l){return{__class__:o,__dict__:$B.empty_dict(),counter:-1,items:l,len:l.length}},$infos:{__name__:n},$is_class:!0,__iter__:function(l){return l.counter=void 0===l.counter?-1:l.counter,l.len=l.items.length,l},__len__:function(l){return l.items.length},__next__:function(l){if("function"==typeof l.len_func&&l.len_func()!=l.len)throw _b_.RuntimeError.$factory("dictionary changed size during iteration");if(l.counter++,l.counter<l.items.length){var x=l.items[l.counter];return"js"==l.items.$brython_class&&(x=$B.$JS2Py(x)),x}throw _b_.StopIteration.$factory("StopIteration")},__reduce_ex__:function(l,x){return $B.fast_tuple([_b_.iter,_b_.tuple.$factory([l.items])])}};return $B.set_func_names(o,"builtins"),o};var ropnames=["add","sub","mul","truediv","floordiv","mod","pow","lshift","rshift","and","xor","or"],ropsigns=["+","-","*","/","//","%","**","<<",">>","&","^","|"];function exit_ctx_managers_in_generators(n){for(key in n[1])n[1][key]&&n[1][key].__class__==$B.generator&&n[1][key].return()}$B.make_rmethods=function(n){for(var o=0,l=ropnames.length;o<l;o++)void 0===n["__"+ropnames[o]+"__"]&&(n["__"+ropnames[o]+"__"]=function(x,B){return function(D,G){try{return $B.$getattr(G,"__r"+x+"__")(D)}catch{$err(B,n,G)}}}(ropnames[o],ropsigns[o]))},$B.UUID=function(){return $B.$py_UUID++},$B.InjectBuiltins=function(){var n=["var _b_ = $B.builtins"],o=1;for(var l in $B.builtins)n[o++]="var "+l+'=_b_["'+l+'"]';return n.join(";")},$B.$GetInt=function(n){if("number"==typeof n||n.constructor===Number)return n;if("boolean"==typeof n)return n?1:0;if(_b_.isinstance(n,_b_.int))return n;if(_b_.isinstance(n,_b_.float))return n.valueOf();if(!n.$is_class){try{return $B.$getattr(n,"__int__")()}catch{}try{return $B.$getattr(n,"__index__")()}catch{}}throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")},$B.to_num=function(n,o){for(var l={__complex__:_b_.complex,__float__:_b_.float,__index__:_b_.int,__int__:_b_.int},x=n.__class__||$B.get_class(n),B=0;B<o.length;B++){var D={},G=$B.$getattr(x,o[B],D);if(G!==D){var M=G(n);if(!_b_.isinstance(M,l[o[B]]))throw console.log(M,o[B],l[o[B]]),_b_.TypeError.$factory(o[B]+"returned non-"+l[o[B]].$infos.__name__+"(type "+$B.get_class(M)+")");return M}}return null},$B.PyNumber_Index=function(n){switch(typeof n){case"boolean":return n?1:0;case"number":return n;case"object":if(n.__class__===$B.long_int)return n;if(_b_.isinstance(n,_b_.int))return n.$brython_value;var o=$B.$getattr(n,"__index__",_b_.None);if(o!==_b_.None)return o="function"==typeof o?o:$B.$getattr(o,"__call__"),$B.int_or_bool(o());default:throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")}},$B.int_or_bool=function(n){switch(typeof n){case"boolean":return n?1:0;case"number":return n;case"object":if(n.__class__===$B.long_int)return n;throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer");default:throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")}},$B.enter_frame=function(n){if($B.frames_stack.push(n),$B.tracefunc&&$B.tracefunc!==_b_.None){if(n[4]===$B.tracefunc||$B.tracefunc.$infos&&n[4]&&n[4]===$B.tracefunc.$infos.__func__)return $B.tracefunc.$frame_id=n[0],_b_.None;for(var o=$B.frames_stack.length-1;o>=0;o--)if($B.frames_stack[o][0]==$B.tracefunc.$frame_id)return _b_.None;return $B.tracefunc($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"call",_b_.None)}return _b_.None},$B.trace_exception=function(){var n=$B.last($B.frames_stack);if(n[0]==$B.tracefunc.$current_frame_id)return _b_.None;var l=n[1].$current_exception;return(0,n[1].$f_trace)($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"exception",$B.fast_tuple([l.__class__,l,$B.traceback.$factory(l)]))},$B.trace_line=function(){var n=$B.last($B.frames_stack);return n[0]==$B.tracefunc.$current_frame_id?_b_.None:(0,n[1].$f_trace)($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"line",_b_.None)},$B.set_line=function(n){var o=$B.last($B.frames_stack);if($B.tracefunc&&o[0]==$B.tracefunc.$current_frame_id)return _b_.None;o[1].$line_info=n;var l=o[1].$f_trace;if(l!==_b_.None){var x=$B._frame.$factory($B.frames_stack,$B.frames_stack.length-1);o[1].$ftrace=l(x,"line",_b_.None)}return!0},$B.trace_return=function(n){var o=$B.last($B.frames_stack),l=o[1].$f_trace,x=$B._frame.$factory($B.frames_stack,$B.frames_stack.length-1);if(o[0]==$B.tracefunc.$current_frame_id)return _b_.None;l(x,"return",n)},$B.set_cm_in_generator=function(n){void 0!==n&&$B.frames_stack.forEach(function(o){o[1].$cm_in_gen=o[1].$cm_in_gen||new Set,o[1].$cm_in_gen.add(n)})},$B.leave_frame=function(n){if(0!=$B.frames_stack.length){n&&void 0!==n.value&&$B.tracefunc&&(void 0===$B.last($B.frames_stack)[1].$f_trace&&($B.last($B.frames_stack)[1].$f_trace=$B.tracefunc),$B.last($B.frames_stack)[1].$f_trace!==_b_.None&&$B.trace_return(n.value));var o=$B.frames_stack.pop();if(o[1].$current_exception=void 0,o[1].$close_generators)for(var l=0,x=o[1].$close_generators.length;l<x;l++){var B=o[1].$close_generators[l];B.$has_run&&B.return()}return _b_.None}console.log("empty stack")},$B.leave_frame_exec=function(n){if($B.profile>0&&$B.$profile.return(),0!=$B.frames_stack.length){var o=$B.frames_stack.pop();exit_ctx_managers_in_generators(o);for(var l=$B.frames_stack.length-1;l>=0;l--)$B.frames_stack[l][2]==o[2]&&($B.frames_stack[l][3]=o[3])}else console.log("empty stack")};var min_int=Math.pow(-2,53),max_int=Math.pow(2,53)-1;$B.is_safe_int=function(){for(var n=0;n<arguments.length;n++){var o=arguments[n];if(o<min_int||o>max_int)return!1}return!0},$B.add=function(n,o){if("number"==typeof n.valueOf()&&"number"==typeof o.valueOf()){if("number"==typeof n&&"number"==typeof o){var l=n+o;return l<$B.max_int&&l>$B.min_int?l:l===1/0?_b_.float.$factory("inf"):l===-1/0?_b_.float.$factory("-inf"):isNaN(l)?_b_.float.$factory("nan"):$B.long_int.__add__($B.long_int.$factory(n),$B.long_int.$factory(o))}return new Number(n+o)}if("string"==typeof n&&"string"==typeof o)return n+o;try{var x=$B.$getattr(n.__class__||$B.get_class(n),"__add__")}catch(D){throw D.__class__===_b_.AttributeError?_b_.TypeError.$factory("unsupported operand type(s) for +: '"+$B.class_name(n)+"' and '"+$B.class_name(o)+"'"):D}var B=$B.$call(x)(n,o);return B===_b_.NotImplemented?$B.rich_op("add",n,o):B},$B.div=function(n,o){var l=n/o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int?l:$B.long_int.__truediv__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.eq=function(n,o){return n>min_int&&n<max_int&&o>min_int&&o<max_int?n==o:$B.long_int.__eq__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.floordiv=function(n,o){var l=n/o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int?Math.floor(l):$B.long_int.__floordiv__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.mul=function(n,o){var l="number"!=typeof n||"number"!=typeof o?new Number(n*o):n*o;if(n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int||"number"!=typeof n&&n.__class__!==$B.long_int||"number"!=typeof o&&o.__class__!==$B.long_int)return l;if("number"==typeof n&&isNaN(n)||"number"==typeof o&&isNaN(o))return _b_.float.$factory("nan");switch(n){case 1/0:case-1/0:return 0==o?_b_.float.$factory("nan"):o>0?n:-n}return $B.long_int.__mul__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.sub=function(n,o){var l="number"!=typeof n||"number"!=typeof o?new Number(n-o):n-o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int||"number"!=typeof n&&n.__class__!==$B.long_int||"number"!=typeof o&&o.__class__!==$B.long_int?l:"number"==typeof n&&isNaN(n)||"number"==typeof o&&isNaN(o)?_b_.float.$factory("nan"):$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.ge=function(n,o){return"number"==typeof n&&"number"==typeof o?n>=o:"number"==typeof n&&"number"!=typeof o?!o.pos:"number"!=typeof n&&"number"==typeof o?!0===n.pos:$B.long_int.__ge__(n,o)},$B.gt=function(n,o){return"number"==typeof n&&"number"==typeof o?n>o:"number"==typeof n&&"number"!=typeof o?!o.pos:"number"!=typeof n&&"number"==typeof o?!0===n.pos:$B.long_int.__gt__(n,o)};var reversed_op={__lt__:"__gt__",__le__:"__ge__",__gt__:"__lt__",__ge__:"__le__"},method2comp={__lt__:"<",__le__:"<=",__gt__:">",__ge__:">="};$B.rich_comp=function(n,o,l){var x,B,D=o.valueOf(),G=l.valueOf();if("number"==typeof D&&"number"==typeof G&&void 0===o.__class__&&void 0===l.__class__)switch(n){case"__eq__":return D==G;case"__ne__":return D!=G;case"__le__":return D<=G;case"__lt__":return D<G;case"__ge__":return D>=G;case"__gt__":return D>G}if(o.$is_class||o.$factory){if("__eq__"==n)return o===l;if("__ne__"==n)return o!==l;throw _b_.TypeError.$factory("'"+method2comp[n]+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}if(o.__class__&&l.__class__&&l.__class__.__mro__.indexOf(o.__class__)>-1&&($B.$getattr(l,B=reversed_op[n]||n),(x=$B.$call($B.$getattr(l,B))(o))!==_b_.NotImplemented)||(x=$B.$call($B.$getattr(o,n))(l))!==_b_.NotImplemented||(x=$B.$call($B.$getattr(l,B=reversed_op[n]||n))(o))!==_b_.NotImplemented)return x;if("__eq__"==n)return _b_.False;if("__ne__"==n)return _b_.True;throw _b_.TypeError.$factory("'"+method2comp[n]+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")};var opname2opsign={sub:"-",xor:"^",mul:"*"};$B.rich_op=function(n,o,l){var x,B,D=o.__class__||$B.get_class(o);if(D===(l.__class__||$B.get_class(l))){if(D===_b_.int)return _b_.int["__"+n+"__"](o,l);try{x=$B.$call($B.$getattr(o,"__"+n+"__"))}catch(M){if(M.__class__===_b_.AttributeError){var G=$B.class_name(o);throw _b_.TypeError.$factory("unsupported operand type(s) for "+opname2opsign[n]+" : '"+G+"' and '"+G+"'")}throw M}return x(l)}try{x=$B.$call($B.$getattr(o,"__"+n+"__"))}catch(M){if(M.__class__!==_b_.AttributeError)throw M;if((B=$B.$call($B.$getattr(l,"__r"+n+"__"))(o))!==_b_.NotImplemented)return B;throw _b_.TypeError.$factory("'"+(opname2opsign[n]||n)+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}if((B=x(l))===_b_.NotImplemented){if((B=$B.$call($B.$getattr(l,"__r"+n+"__"))(o))!==_b_.NotImplemented)return B;throw _b_.TypeError.$factory("'"+(opname2opsign[n]||n)+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}return B},$B.is_none=function(n){return null==n||n==_b_.None};var repr_stack=new Set;$B.repr={enter:function(n){if(repr_stack.has(n))return!0;repr_stack.add(n)},leave:function(n){repr_stack.delete(n)}}}(__BRYTHON__),function($B){var _b_=$B.builtins;_b_.__debug__=!1,$B.$comps={">":"gt",">=":"ge","<":"lt","<=":"le"},$B.$inv_comps={">":"lt",">=":"le","<":"gt","<=":"ge"};var check_nb_args=$B.check_nb_args=function(n,o,l){var x=l.length,B=l[x-1];if(B&&"kw"==B.$nat){var D=B.kw;Array.isArray(D)&&D[1]&&D[1].__class__===_b_.dict&&0==Object.keys(D[1].$string_dict).length&&x--}if(x!=o)throw _b_.TypeError.$factory(0==o?n+"() takes no argument ("+x+" given)":n+"() takes exactly "+o+" argument"+(o<2?"":"s")+" ("+x+" given)")},check_no_kw=$B.check_no_kw=function(n,o,l){if(void 0===o&&console.log("x undef",n,o,l),o.$nat&&o.kw&&o.kw[0]&&o.kw[0].length>0||void 0!==l&&l.$nat)throw _b_.TypeError.$factory(n+"() takes no keyword arguments")},NoneType={$factory:function(){return None},$infos:{__name__:"NoneType",__module__:"builtins"},__bool__:function(n){return False},__class__:_b_.type,__hash__:function(n){return 0},__mro__:[_b_.object],__repr__:function(n){return"None"},__str__:function(n){return"None"},$is_class:!0,__setattr__:function(n,o){return no_set_attr(NoneType,o)}},None={__class__:NoneType};for(var $op in $B.$comps){var key=$B.$comps[$op];switch(key){case"ge":case"gt":case"le":case"lt":NoneType["__"+key+"__"]=function(n){return _b_.NotImplemented}}}for(var $func in None)"function"==typeof None[$func]&&(None[$func].__str__=function(n){return function(){return"<method-wrapper "+n+" of NoneType object>"}}($func));function abs(n){if(check_nb_args("abs",1,arguments),check_no_kw("abs",n),isinstance(n,_b_.int))return n.__class__===$B.long_int?{__class__:$B.long_int,value:n.value,pos:!0}:_b_.int.$factory(Math.abs(n));if(isinstance(n,_b_.float))return _b_.float.$factory(Math.abs(_b_.float.numerator(n)));var o=n.__class__||$B.get_class(n);try{var l=$B.$getattr(o,"__abs__")}catch(x){throw x.__class__===_b_.AttributeError?_b_.TypeError.$factory("Bad operand type for abs(): '"+$B.class_name(n)+"'"):x}return $B.$call(l)(n)}function all(n){check_nb_args("all",1,arguments),check_no_kw("all",n);for(var o=iter(n);;)try{var l=next(o);if(!$B.$bool(l))return!1}catch{return!0}}function any(n){check_nb_args("any",1,arguments),check_no_kw("any",n);for(var o=iter(n);;)try{var l=next(o);if($B.$bool(l))return!0}catch{return!1}}function ascii(n){check_nb_args("ascii",1,arguments),check_no_kw("ascii",n);for(var o,l=repr(n),x="",B=0;B<l.length;B++)if((o=l.charCodeAt(B))<128)x+=l.charAt(B);else if(o<256)x+="\\x"+o.toString(16);else{var D=o.toString(16);D.length%2==1&&(D="0"+D),x+="\\u"+D}return x}function $builtin_base_convert_helper(n,o){var l="";switch(o){case 2:l="0b";break;case 8:l="0o";break;case 16:l="0x";break;default:console.log("invalid base:"+o)}if(n.__class__===$B.long_int){var x=l+$B.long_int.to_base(n,o);return n.pos||(x="-"+x),x}var B=$B.$GetInt(n);if(void 0===B)throw _b_.TypeError.$factory("Error, argument must be an integer or contains an __index__ function");return B>=0?l+B.toString(o):"-"+l+(-B).toString(o)}function bin_hex_oct(n,o){if(isinstance(o,_b_.int))return $builtin_base_convert_helper(o,n);try{var l=o.__class__||$B.get_class(o),x=$B.$getattr(l,"__index__")}catch(B){throw B.__class__===_b_.AttributeError?_b_.TypeError.$factory("'"+$B.class_name(o)+"' object cannot be interpreted as an integer"):B}return $builtin_base_convert_helper($B.$call(x)(o),n)}function bin(n){return check_nb_args("bin",1,arguments),check_no_kw("bin",n),bin_hex_oct(2,n)}function breakpoint(){$B.$import("sys",[]);var n={},o=$B.$getattr($B.imported.sys,"breakpointhook",n);if(o===n)throw _b_.RuntimeError.$factory("lost sys.breakpointhook");return $B.$call(o).apply(null,arguments)}function callable(n){return check_nb_args("callable",1,arguments),check_no_kw("callable",n),hasattr(n,"__call__")}function chr(n){if(check_nb_args("chr",1,arguments),check_no_kw("chr",n),n<0||n>1114111)throw _b_.ValueError.$factory("Outside valid range");return String.fromCodePoint(n)}$B.set_func_names(NoneType,"builtins");var classmethod=$B.make_class("classmethod",function(n){check_nb_args("classmethod",1,arguments),check_no_kw("classmethod",n);var o=function(){return n.apply(null,arguments)};if(o.__class__=$B.method,n.$attrs)for(var l in n.$attrs)o[l]=n.$attrs[l];return o.$infos={__func__:n,__name__:n.$infos.__name__},o.__get__=function(x,B){var D=function(){return o(B,...arguments)};return D.__class__=$B.method,D.$infos={__self__:B,__func__:o,__name__:n.$infos.__name__,__qualname__:B.$infos.__name__+"."+n.$infos.__name__},D},o.__get__.__class__=$B.method_wrapper,o.__get__.$infos=n.$infos,o});$B.set_func_names(classmethod,"builtins");var code=$B.code=$B.make_class("code");function compile(){var n=$B.args("compile",6,{source:null,filename:null,mode:null,flags:null,dont_inherit:null,optimize:null,_feature_version:null},["source","filename","mode","flags","dont_inherit","optimize","_feature_version"],arguments,{flags:0,dont_inherit:!1,optimize:-1,_feature_version:0},null,null),o="$exec_"+$B.UUID();if($B.clear_ns(o),n.__class__=code,n.co_flags=n.flags,n.name="<module>","single"==n.mode&&512&n.flags&&!n.source.endsWith("\n")){var l=n.source.split("\n");if($B.last(l).startsWith(" "))throw _b_.SyntaxError.$factory("unexpected EOF while parsing")}return $B.py2js(n.source,o,o),n}code.__repr__=code.__str__=function(n){return"<code object "+n.co_name+", file "+n.co_filename+">"},code.__getattribute__=function(n,o){return n[o]},$B.set_func_names(code,"builtins");var __debug__=$B.debug>0;function delattr(n,o){if(check_no_kw("delattr",n,o),check_nb_args("delattr",2,arguments),"string"!=typeof o)throw _b_.TypeError.$factory("attribute name must be string, not '"+$B.class_name(o)+"'");return $B.$getattr(n,"__delattr__")(o)}function dir(n){if(void 0===n){var o=$B.last($B.frames_stack);for(var l in locals_obj=o[1],B=_b_.list.$factory(),D=0,locals_obj)"$"==l.charAt(0)&&"$"!=l.charAt(1)||(B[D++]=l);return _b_.list.sort(B),B}if(check_nb_args("dir",1,arguments),check_no_kw("dir",n),n.__class__||$B.get_class(n),n.$is_class){var x=$B.$getattr(n.__class__,"__dir__");return $B.$call(x)(n)}try{var B=$B.$call($B.$getattr(n,"__dir__"))();return _b_.list.$factory(B)}catch{}B=[];var D=0;for(var l in n)"$"!==l.charAt(0)&&"__class__"!==l&&void 0!==n[l]&&(B[D++]=l);return B.sort(),B}function divmod(n,o){check_no_kw("divmod",n,o),check_nb_args("divmod",2,arguments);var l=n.__class__||$B.get_class(n),x=$B.$getattr(l,"__divmod__",_b_.None);return x!==_b_.None?x(n,o):_b_.tuple.$factory([$B.$getattr(l,"__floordiv__")(n,o),$B.$getattr(l,"__mod__")(n,o)])}$B.$delete=function(n,o){function l(D){D.__class__===$B.generator&&D.return()}var x=!1,B=$B.last($B.frames_stack);if(o?B[2]!=B[0]&&void 0!==B[3][n]&&(x=!0,l(B[3][n]),delete B[3][n]):void 0!==B[1][n]&&(x=!0,l(B[1][n]),delete B[1][n]),!x)throw _b_.NameError.$factory(n)};var enumerate=$B.make_class("enumerate",function(){var n=$B.args("enumerate",2,{iterable:null,start:null},["iterable","start"],arguments,{start:0},null,null),o=iter(n.iterable),l=n.start;return{__class__:enumerate,__name__:"enumerate iterator",counter:l-1,iter:o,start:l}});function $$eval(src,_globals,_locals){var $=$B.args("eval",4,{src:null,globals:null,locals:null,mode:null},["src","globals","locals","mode"],arguments,{globals:_b_.None,locals:_b_.None,mode:"eval"},null,null),src=$.src,_globals=$.globals,_locals=$.locals,mode=$.mode;$.src.mode&&"single"==$.src.mode&&["<console>","<stdin>"].indexOf($.src.filename)>-1&&_b_.print(">",$.src.source.trim());var current_frame=$B.frames_stack[$B.frames_stack.length-1];if(void 0!==current_frame)var current_locals_id=current_frame[0].replace(/\./g,"_"),current_globals_id=current_frame[2].replace(/\./g,"_");var stack_len=$B.frames_stack.length;if(src.__class__===code)mode=src.mode,src=src.source;else if("string"!=typeof src)throw _b_.TypeError.$factory("eval() arg 1 must be a string, bytes or code object");var globals_id="$exec_"+$B.UUID(),globals_name=globals_id,locals_id="$exec_"+$B.UUID(),parent_scope;if(_globals===_b_.None){current_locals_id==current_globals_id&&(locals_id=globals_id);var local_scope={module:globals_id,id:locals_id,binding:{},bindings:{}};for(var attr in current_frame[1])local_scope.binding[attr]=!0,local_scope.bindings[attr]=!0;var global_scope={module:globals_id,id:globals_id,binding:{},bindings:{}};for(var attr in current_frame[3])global_scope.binding[attr]=!0,global_scope.bindings[attr]=!0;local_scope.parent_block=global_scope,global_scope.parent_block=$B.builtins_scope,parent_scope=local_scope,eval("$locals_"+parent_scope.id+" = current_frame[1]")}else{if(_globals.__class__!=_b_.dict)throw _b_.TypeError.$factory("exec() globals must be a dict, not "+$B.class_name(_globals));if(_globals.globals_id&&(globals_id=globals_name=_globals.globals_id),_globals.globals_id=globals_id,_locals===_globals||_locals===_b_.None)locals_id=globals_id,parent_scope=$B.builtins_scope;else{var grandparent_scope={id:globals_id,parent_block:$B.builtins_scope,binding:{}};for(var attr in parent_scope={id:locals_id,parent_block:grandparent_scope,binding:{}},_globals.$string_dict)grandparent_scope.binding[attr]=!0;for(var attr in _locals.$string_dict)parent_scope.binding[attr]=!0}}if($B.$py_module_path[globals_id]=$B.$py_module_path[current_globals_id],eval("var $locals_"+globals_id+" = {}\nvar $locals_"+locals_id+" = {}"),_globals===_b_.None){var gobj=current_frame[3],ex="var $locals_"+globals_id+" = gobj;",obj={};for(var attr in eval(ex),gobj)attr.startsWith("$")&&!attr.startsWith("$$")||(obj[attr]=gobj[attr]);eval("$locals_"+globals_id+" = obj")}else{var globals_is_dict=!1;if(_globals.$jsobj)var items=_globals.$jsobj;else{var items=_b_.dict.$to_obj(_globals);_globals.$jsobj=items,globals_is_dict=!0}for(var item in eval("$locals_"+globals_id+" = _globals.$jsobj"),items){var item1=$B.to_alias(item);try{eval("$locals_"+globals_id+'["'+item+'"] = items.'+item)}catch(n){console.log(n),console.log("error setting",item);break}}}if(_globals.$is_namespace=!0,_locals===_b_.None)if(_globals!==_b_.None)eval("var $locals_"+locals_id+" = $locals_"+globals_id);else{var lobj=current_frame[1],ex="",obj={};for(var attr in current_frame[1])attr.startsWith("$")&&!attr.startsWith("$$")||(obj[attr]=lobj[attr]);eval("$locals_"+locals_id+" = obj")}else{var locals_is_dict=!1;if(_locals.$jsobj)var items=_locals.$jsobj;else{locals_id_dict=!0;var items=_b_.dict.$to_obj(_locals);_locals.$jsobj=items}for(var item in items){var item1=$B.to_alias(item);try{eval("$locals_"+locals_id+'["'+item+'"] = items.'+item)}catch(n){console.log(n),console.log("error setting",item);break}}eval("$locals_"+locals_id+".$exec_locals = true")}_locals.$is_namespace=!0,_globals===_b_.None&&_locals===_b_.None&&current_frame[0]==current_frame[2]||eval("$locals_"+locals_id+".$src = src");var root=$B.py2js(src,globals_id,locals_id,parent_scope),js,gns,lns;if(_globals!==_b_.None&&_locals==_b_.None)for(var attr in _globals.$string_dict)root.binding[attr]=!0;try{var try_node=root.children[root.children.length-2],instr=try_node.children[try_node.children.length-2],type=instr.C.tree[0].type;switch(type){case"expr":case"list_or_tuple":case"op":case"ternary":var children=try_node.children;root.children.splice(root.children.length-2,2);for(var i=0;i<children.length-1;i++)root.add(children[i]);break;default:if("eval"==mode)throw _b_.SyntaxError.$factory("eval() argument must be an expression","<string>",1,1,src)}if("eval"!=mode){var last=$B.last(root.children),js=last.to_js();-1==["node_js"].indexOf(last.C.type)&&(last.to_js=function(){for(;js.endsWith("\n");)js=js.substr(0,js.length-1);for(;js.endsWith(";");)js=js.substr(0,js.length-1);return"return ("+js+")"}),js=root.to_js();var locals_obj=eval("$locals_"+locals_id),globals_obj=eval("$locals_"+globals_id);if(_globals===_b_.None)var res=new Function("$locals_"+globals_id,"$locals_"+locals_id,js)(globals_obj,locals_obj);else{current_globals_obj=current_frame[3],current_locals_obj=current_frame[1];var res=new Function("$locals_"+globals_id,"$locals_"+locals_id,"$locals_"+current_globals_id,"$locals_"+current_locals_id,js)(globals_obj,locals_obj,current_globals_obj,current_locals_obj)}$.src.mode&&"single"==$.src.mode&&"<stdin>"==$.src.filename&&res!==_b_.None&&void 0!==res&&_b_.print(_b_.repr(res))}else{js=root.to_js();var res=eval(js)}if("<console>"==$.src.filename&&"single"==$.src.mode&&void 0!==res&&res!==_b_.None&&_b_.print(res),gns=eval("$locals_"+globals_id),$B.frames_stack[$B.frames_stack.length-1][2]==globals_id&&(gns=$B.frames_stack[$B.frames_stack.length-1][3]),_locals!==_b_.None)for(var attr in lns=eval("$locals_"+locals_id),lns){var attr1=$B.from_alias(attr);"$"!=attr1.charAt(0)&&(_locals.$jsobj?_locals.$jsobj[attr]=lns[attr]:_b_.dict.$setitem(_locals,attr1,lns[attr]))}else for(var attr in lns)"$src"!==attr&&(current_frame[1][attr]=lns[attr]);if(_globals!==_b_.None){if(globals_is_dict){var jsobj=_globals.$jsobj;delete _globals.$jsobj}for(var attr in gns)attr1=$B.from_alias(attr),"$"!=attr1.charAt(0)&&(globals_is_dict?_b_.dict.$setitem(_globals,attr,gns[attr]):_globals.$jsobj[attr1]=gns[attr]);for(var attr in _globals.$string_dict)attr.startsWith("$")&&!attr.startsWith("$$")&&delete _globals.$string_dict[attr]}else for(var attr in gns)"$src"!==attr&&(current_frame[3][attr]=gns[attr]);return void 0===res?_b_.None:res}catch(n){throw n.src=src,n.module=globals_id,void 0===n.$py_error?$B.exception(n):n}finally{$B.frames_stack.length==stack_len+1&&$B.frames_stack.pop(),root=null,js=null,gns=null,lns=null,$B.clear_ns(globals_id),$B.clear_ns(locals_id)}}function exec(n,o,l){var x=$B.args("exec",3,{src:null,globals:null,locals:null},["src","globals","locals"],arguments,{globals:_b_.None,locals:_b_.None},null,null);return $$eval(x.src,x.globals,x.locals,"exec")||_b_.None}function exit(){throw _b_.SystemExit}enumerate.__iter__=function(n){return n.counter=n.start-1,n},enumerate.__next__=function(n){return n.counter++,$B.fast_tuple([n.counter,next(n.iter)])},$B.set_func_names(enumerate,"builtins"),$B.from_alias=function(n){return"$$"==n.substr(0,2)&&$B.aliased_names[n.substr(2)]?n.substr(2):n},$B.to_alias=function(n){return $B.aliased_names[n]?"$$"+n:n},$$eval.$is_func=!0,exec.$is_func=!0,exit.__repr__=exit.__str__=function(){return"Use exit() or Ctrl-Z plus Return to exit"};var filter=$B.make_class("filter",function(n,o){return check_no_kw("filter",n,o),check_nb_args("filter",2,arguments),o=iter(o),n===_b_.None&&(n=$B.$bool),{__class__:filter,func:n,iterable:o}});function format(n,o){var l=$B.args("format",2,{value:null,format_spec:null},["value","format_spec"],arguments,{format_spec:""},null,null),x=n.__class__||$B.get_class(n);try{var B=$B.$getattr(x,"__format__")}catch(D){throw D.__class__===_b_.AttributeError?_b_.NotImplementedError("__format__ is not implemented for object '"+_b_.str.$factory(n)+"'"):D}return $B.$call(B)(n,l.format_spec)}function attr_error(n,o){var l="bad operand type for unary #: '"+o+"'";switch(n){case"__neg__":throw _b_.TypeError.$factory(l.replace("#","-"));case"__pos__":throw _b_.TypeError.$factory(l.replace("#","+"));case"__invert__":throw _b_.TypeError.$factory(l.replace("#","~"));case"__call__":throw _b_.TypeError.$factory("'"+o+"' object is not callable");default:for(;"$"==n.charAt(0);)n=n.substr(1);throw _b_.AttributeError.$factory("'"+o+"' object has no attribute '"+n+"'")}}function getattr(){var n={},o=$B.args("getattr",3,{obj:null,attr:null,_default:null},["obj","attr","_default"],arguments,{_default:n},null,null);return $B.$getattr(o.obj,o.attr,o._default===n?void 0:o._default)}function in_mro(n,o){if(void 0===n)return!1;if(n.hasOwnProperty(o))return n[o];for(var l=n.__mro__,x=0,B=l.length;x<B;x++)if(l[x].hasOwnProperty(o))return l[x][o];return!1}function globals(){check_nb_args("globals",0,arguments);var n=$B.obj_dict($B.last($B.frames_stack)[3]);return n.$jsobj.__BRYTHON__=$B.JSObj.$factory($B),n.$is_namespace=!0,n}function hasattr(n,o){check_no_kw("hasattr",n,o),check_nb_args("hasattr",2,arguments);try{return $B.$getattr(n,o),!0}catch{return!1}}filter.__iter__=function(n){return n},filter.__next__=function(n){for(;;){var o=next(n.iterable);if(n.func(o))return o}},$B.set_func_names(filter,"builtins"),$B.$getattr=function(n,o,l){if(o=$B.to_alias(o),n.$method_cache&&n.$method_cache[o]&&n.__class__&&n.__class__[o]==n.$method_cache[o][1])return n.$method_cache[o][0];var x=o;void 0===n&&console.log("get attr",o,"of undefined");var B,D=n.$is_class||n.$factory,G=n.__class__;if(void 0!==G&&G.__bases__&&(0==G.__bases__.length||1==G.__bases__.length&&G.__bases__[0]===_b_.object)){if(n.hasOwnProperty(o))return n[o];if(n.__dict__&&n.__dict__.$string_dict.hasOwnProperty(o)&&(!G.hasOwnProperty(o)||!G[o].__get__))return n.__dict__.$string_dict[o][0];if(G.hasOwnProperty(o)&&"function"!=typeof G[o]&&"__dict__"!=o&&void 0===G[o].__get__&&!in_mro(G[o].__class__,"__get__"))return G[o]}if(void 0===G)if("string"==typeof n)G=_b_.str;else if("number"==typeof n)G=n%1==0?_b_.int:_b_.float;else if(n instanceof Number)G=_b_.float;else if(void 0===(G=$B.get_class(n))){if(void 0!==(P=n[o])){if("function"==typeof P){var M=function(){return P.apply(n,arguments)};return M.$infos={__name__:o,__qualname__:o},M}return $B.$JS2Py(P)}if(void 0!==l)return l;throw _b_.AttributeError.$factory("object has no attribute "+x)}switch(o){case"__call__":if("function"==typeof n){var P=function(){return n.apply(null,arguments)};return P.__class__=method_wrapper,P.$infos={__name__:"__call__"},P}break;case"__class__":return G;case"__dict__":if(D){var fe={};for(var ye in n){var ne=$B.from_alias(ye);ne.startsWith("$")||(fe[ne]=n[ye])}return fe.__dict__=$B.getset_descriptor.$factory(n,"__dict__"),$B.mappingproxy.$factory(fe)}if(n.hasOwnProperty(o))return n[o];if(n.$infos){if(n.$infos.hasOwnProperty("__dict__"))return n.$infos.__dict__;if(n.$infos.hasOwnProperty("__func__"))return n.$infos.__func__.$infos.__dict__}return $B.obj_dict(n);case"__doc__":for(var ue=0;ue<builtin_names.length;ue++)if(n===_b_[builtin_names[ue]])return _get_builtins_doc(),$B.builtins_doc[builtin_names[ue]];break;case"__mro__":if(n.$is_class)return _b_.tuple.$factory([n].concat(n.__mro__));if(n.__dict__&&void 0!==n.__dict__.$string_dict.__mro__)return n.__dict__.$string_dict.__mro__;throw _b_.AttributeError.$factory(o);case"__subclasses__":if(G.$factory||G.$is_class){var me=n.$subclasses||[];return function(){return me}}}if("function"==typeof n){var ie=n[o];if(void 0!==ie&&"__module__"==o)return ie}if(!D&&G.$native){if(n.$method_cache&&n.$method_cache[o])return n.$method_cache[o];if("__doc__"==o&&void 0===G[o]&&G.$infos&&(_get_builtins_doc(),G[o]=$B.builtins_doc[G.$infos.__name__]),void 0===G[o]){var W=_b_.object[o];if(void 0===W){var Q=n.__dict__;return Q&&void 0!==(W=Q.$string_dict[o])?W[0]:(void 0===l&&attr_error(o,G.$infos.__name__),l)}G[o]=W}if(G.$descriptors&&void 0!==G.$descriptors[o])return G[o](n);if("function"==typeof G[o]){var A=G[o];if("__new__"==o&&(A.$type="staticmethod"),"staticmethod"==A.$type)return A;var R=G[o].__class__==$B.method?G:n,X=G[o].bind(null,R);return X.__class__=$B.method,X.$infos={__func__:A,__name__:o,__self__:R,__qualname__:G.$infos.__name__+"."+o},"object"==typeof n&&(n.__class__=G,n.$method_cache=n.$method_cache||{},n.$method_cache[o]=X),X}if(void 0!==G[o])return G[o];attr_error(x,G.$infos.__name__)}if(D)B=_b_.type.__getattribute__;else if(void 0===(B=G.__getattribute__)){var he;void 0===(he=G.__mro__)&&console.log(n,o,"no mro, klass",G),ue=0;for(var z=he.length;ue<z&&void 0===(B=he[ue].__getattribute__);ue++);}if("function"!=typeof B&&console.log(o+" is not a function "+B,G),B===_b_.object.__getattribute__){if(P=n[o],Array.isArray(n)&&void 0!==Array.prototype[o]&&(P=void 0),null===P)return null;if(void 0===P&&n.hasOwnProperty(o)||void 0!==P&&(void 0===P.__set__||P.$is_class))return P}try{P=B(n,o)}catch(K){if(void 0!==l)return l;throw K}if(void 0!==P)return P;if(void 0!==l)return l;var Le=G.$infos.__name__;D&&(Le=n.$infos.__name__),attr_error(x,Le)};var hash_cache={};function hash(n){if(check_no_kw("hash",n),check_nb_args("hash",1,arguments),void 0!==n.__hashvalue__)return n.__hashvalue__;if(isinstance(n,_b_.bool))return _b_.int.$factory(n);if(isinstance(n,_b_.int))return void 0===n.$brython_value?n.valueOf():n.__hashvalue__=n.$brython_value;if(n.$is_class||n.__class__===_b_.type||n.__class__===$B.Function)return n.__hashvalue__=$B.$py_next_hash--;if("string"==typeof n){var o=hash_cache[n];return void 0!==o?o:hash_cache[n]=_b_.str.__hash__(n)}var l=n.__class__||$B.get_class(n);if(void 0===l)throw _b_.TypeError.$factory("unhashable type: '"+_b_.str.$factory($B.JSObj.$factory(n))+"'");var x=$B.$getattr(l,"__hash__",_b_.None);if(x===_b_.None)throw _b_.TypeError.$factory("unhashable type: '"+$B.class_name(n)+"'");if(x.$infos.__func__===_b_.object.__hash__){if($B.$getattr(n,"__eq__").$infos.__func__!==_b_.object.__eq__)throw _b_.TypeError.$factory("unhashable type: '"+$B.class_name(n)+"'","hash");return n.__hashvalue__=_b_.object.__hash__(n)}return $B.$call(x)(n)}function _get_builtins_doc(){if(void 0===$B.builtins_doc){var url=$B.brython_path;"/"==url.charAt(url.length-1)&&(url=url.substr(0,url.length-1)),url+="/builtins_docstrings.js";var f=_b_.open(url);eval(f.$string),$B.builtins_doc=docs}}function help(n){if(void 0===n&&(n="help"),"string"==typeof n&&void 0!==_b_[n]){_get_builtins_doc();var o=$B.builtins_doc[n];if(void 0!==o&&""!=o)return void _b_.print(o)}for(var l=0;l<builtin_names.length;l++)n===_b_[builtin_names[l]]&&(_get_builtins_doc(),_b_.print(o=$B.builtins_doc[builtin_names[l]]));if("string"!=typeof n)try{return $B.$getattr(n,"__doc__")}catch{return""}else $B.$import("pydoc"),$B.$getattr($B.$getattr($B.imported.pydoc,"help"),"__call__")(n)}function hex(n){return check_no_kw("hex",n),check_nb_args("hex",1,arguments),bin_hex_oct(16,n)}function id(n){return check_no_kw("id",n),check_nb_args("id",1,arguments),isinstance(n,[_b_.str,_b_.int,_b_.float])&&!isinstance(n,$B.long_int)?$B.$getattr(_b_.str.$factory(n),"__hash__")():void 0!==n.$id?n.$id:n.$id=$B.UUID()}function __import__(n,o,l,x,B){var D=$B.args("__import__",5,{name:null,globals:null,locals:null,fromlist:null,level:null},["name","globals","locals","fromlist","level"],arguments,{globals:None,locals:None,fromlist:_b_.tuple.$factory(),level:0},null,null);return $B.$__import__(D.name,D.globals,D.locals,D.fromlist)}function input(n){var o=prompt(n||"")||"";return $B.imported.sys&&$B.imported.sys.ps1&&(n!=$B.imported.sys.ps1&&n!=$B.imported.sys.ps2||console.log(n,o)),o}function isinstance(n,o){if(check_no_kw("isinstance",n,o),check_nb_args("isinstance",2,arguments),null===n)return o===None;if(void 0===n)return!1;if(o.constructor===Array){for(var l=0;l<o.length;l++)if(isinstance(n,o[l]))return!0;return!1}if(o.__class__===$B.GenericAlias)throw _b_.TypeError.$factory("isinstance() arg 2 cannot be a parameterized generic");if(!o.__class__||void 0===o.$factory&&void 0===o.$is_class)throw _b_.TypeError.$factory("isinstance() arg 2 must be a type or tuple of types");if(o===_b_.int&&(n===True||n===False))return True;if(o===_b_.bool)switch(typeof n){case"string":case"number":return!1;case"boolean":return!0}var x=n.__class__;if(null==x){if("string"==typeof n){if(o==_b_.str)return!0;if($B.builtin_classes.indexOf(o)>-1)return!1}else if(n.contructor===Number&&Number.isFinite(n)){if(o==_b_.float)return!0}else if("number"==typeof n&&Number.isFinite(n)&&Number.isFinite(n)&&o==_b_.int)return!0;x=$B.get_class(n)}if(void 0===x)return!1;function B(M,P){return M===P||P===_b_.str&&M===$B.StringSubclass||P===_b_.int&&M===$B.IntSubclass||void 0}if(B(x,o))return!0;var D=x.__mro__;for(l=0;l<D.length;l++)if(B(D[l],o))return!0;var G=$B.$getattr(o.__class__||$B.get_class(o),"__instancecheck__",_b_.None);return G!==_b_.None&&G(o,n)}function issubclass(n,o){if(check_no_kw("issubclass",n,o),check_nb_args("issubclass",2,arguments),!n.__class__||void 0===n.$factory&&void 0===n.$is_class)throw _b_.TypeError.$factory("issubclass() arg 1 must be a class");if(isinstance(o,_b_.tuple)){for(var l=0;l<o.length;l++)if(issubclass(n,o[l]))return!0;return!1}if(o.__class__===$B.GenericAlias)throw _b_.TypeError.$factory("issubclass() arg 2 cannot be a parameterized generic");if((o.$factory||o.$is_class)&&(n===o||n.__mro__.indexOf(o)>-1))return!0;var x=$B.$getattr(o.__class__||$B.get_class(o),"__subclasscheck__",_b_.None);return x!=_b_.None&&x(o,n)}help.__repr__=help.__str__=function(){return"Type help() for interactive help, or help(object) for help about object."};var iterator_class=$B.make_class("iterator",function(n,o){return{__class__:iterator_class,getitem:n,len:o,counter:-1}});function iter(){var n=$B.args("iter",1,{obj:null},["obj"],arguments,{},"args","kw");if(n.args.length>0)var o=n.args[0];return $B.$iter(n.obj,o)}function len(n){check_no_kw("len",n),check_nb_args("len",1,arguments);var o=n.__class__||$B.get_class(n);try{var l=$B.$getattr(o,"__len__")}catch{throw _b_.TypeError.$factory("object of type '"+$B.class_name(n)+"' has no len()")}return $B.$call(l)(n)}function locals(){check_nb_args("locals",0,arguments);var n=$B.obj_dict($B.last($B.frames_stack)[1]);return n.$is_namespace=!0,delete n.$jsobj.__annotations__,n}iterator_class.__next__=function(n){if(n.counter++,null!==n.len&&n.counter==n.len)throw _b_.StopIteration.$factory("");try{return n.getitem(n.counter)}catch{throw _b_.StopIteration.$factory("")}},callable_iterator=$B.make_class("callable_iterator",function(n,o){return{__class__:callable_iterator,func:n,sentinel:o}}),callable_iterator.__iter__=function(n){return n},callable_iterator.__next__=function(n){var o=n.func();if($B.rich_comp("__eq__",o,n.sentinel))throw _b_.StopIteration.$factory();return o},$B.$iter=function(n,o){if(void 0===o){var l=n.__class__||$B.get_class(n);try{var x=$B.$call($B.$getattr(l,"__iter__"))}catch(G){if(G.__class__===_b_.AttributeError)try{var B=$B.$call($B.$getattr(l,"__getitem__"));return len(n),iterator_class.$factory(function(M){return B(n,M)},len)}catch{throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not iterable")}throw G}var D=$B.$call(x)(n);try{$B.$getattr(D,"__next__")}catch(G){if(isinstance(G,_b_.AttributeError))throw _b_.TypeError.$factory("iter() returned non-iterator of type '"+$B.class_name(D)+"'")}return D}return callable_iterator.$factory(n,o)};var map=$B.make_class("map",function(){var n=$B.args("map",2,{func:null,it1:null},["func","it1"],arguments,{},"args",null),o=$B.$call(n.func),l=[$B.$iter(n.it1)];return n.args.forEach(function(x){l.push($B.$iter(x))}),{__class__:map,args:l,func:o}});function $extreme(n,o){var l="min";if("__gt__"===o&&(l="max"),0==n.length)throw _b_.TypeError.$factory(l+" expected 1 arguments, got 0");var x=n[n.length-1],B=n.length,D=!1,G=!1;if("kw"==x.$nat)for(var M in B--,x=x.kw)switch(M){case"key":G=x[M];break;case"$$default":var P=x[M];D=!0;break;default:throw _b_.TypeError.$factory("'"+M+"' is an invalid keyword argument for this function")}if(G||(G=function(me){return me}),0==B)throw _b_.TypeError.$factory(l+" expected 1 argument, got 0");if(1!=B){if(D)throw _b_.TypeError.$factory("Cannot specify a default for "+l+"() with multiple positional arguments");ne=null;for(var fe=0;fe<B;fe++)ue=n[fe],(null===ne||$B.$bool($B.$getattr(G(ue),o)(G(ne))))&&(ne=ue);return ne}for(var ye=iter(n[0]),ne=null;;)try{var ue=next(ye);(null===ne||$B.$bool($B.$getattr(G(ue),o)(G(ne))))&&(ne=ue)}catch(me){if(me.__class__==_b_.StopIteration){if(null===ne){if(D)return P;throw _b_.ValueError.$factory(l+"() arg is an empty sequence")}return ne}throw me}}function max(){return $extreme(arguments,"__gt__")}map.__iter__=function(n){return n},map.__next__=function(n){for(var o=[],l=0;l<n.args.length;l++)o.push(next(n.args[l]));return n.func.apply(null,o)},$B.set_func_names(map,"builtins");var memoryview=$B.make_class("memoryview",function(n){if(check_no_kw("memoryview",n),check_nb_args("memoryview",1,arguments),n.__class__===memoryview)return n;if($B.get_class(n).$buffer_protocol)return{__class__:memoryview,obj:n,format:"B",itemsize:1,ndim:1,shape:_b_.tuple.$factory([_b_.len(n)]),strides:_b_.tuple.$factory([1]),suboffsets:_b_.tuple.$factory([]),c_contiguous:!0,f_contiguous:!0,contiguous:!0};throw _b_.TypeError.$factory("memoryview: a bytes-like object is required, not '"+$B.class_name(n)+"'")});function min(){return $extreme(arguments,"__lt__")}function next(n){check_no_kw("next",n);var o={},l=$B.args("next",2,{obj:null,def:null},["obj","def"],arguments,{def:o},null,null),x=n.__class__||$B.get_class(n),B=$B.$call($B.$getattr(x,"__next__"));if(void 0!==B)try{return $B.$call(B)(n)}catch(D){if(D.__class__===_b_.StopIteration&&l.def!==o)return l.def;throw D}throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not an iterator")}memoryview.__eq__=function(n,o){return o.__class__===memoryview&&$B.$getattr(n.obj,"__eq__")(o.obj)},memoryview.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o*n.itemsize;if("I"==n.format){for(var x=n.obj.source[l],B=256,D=1;D<4;D++)x+=n.obj.source[l+D]*B,B*=256;return x}if("B".indexOf(n.format)>-1){if(o>n.obj.source.length-1)throw _b_.KeyError.$factory(o);return n.obj.source[o]}return n.obj.source[o]}if(x=n.obj.__class__.__getitem__(n.obj,o),o.__class__===_b_.slice)return memoryview.$factory(x)},memoryview.__len__=function(n){return len(n.obj)/n.itemsize},memoryview.cast=function(n,o){switch(o){case"B":return memoryview.$factory(n.obj);case"I":var l=memoryview.$factory(n.obj),x=len(n.obj);if(l.itemsize=4,l.format="I",x%4!=0)throw _b_.TypeError.$factory("memoryview: length is not a multiple of itemsize");return l}},memoryview.hex=function(n){var o="";return _b_.bytes.$factory(n).source.forEach(function(l){o+=l.toString(16)}),o},memoryview.tobytes=function(n){return _b_.bytes.$factory(n.obj)},memoryview.tolist=function(n){if(1==n.itemsize)return _b_.list.$factory(_b_.bytes.$factory(n.obj));if(4==n.itemsize&&"I"==n.format){for(var o=[],l=0;l<n.obj.source.length;l+=4){for(var x=n.obj.source[l],B=256,D=1;D<4;D++)x+=B*n.obj.source[l+D],B*=256;o.push(x)}return o}},$B.set_func_names(memoryview,"builtins");var NotImplementedType=$B.make_class("NotImplementedType",function(){return NotImplemented});NotImplementedType.__repr__=NotImplementedType.__str__=function(n){return"NotImplemented"};var NotImplemented={__class__:NotImplementedType};function $not(n){return!$B.$bool(n)}function oct(n){return check_no_kw("oct",n),check_nb_args("oct",1,arguments),bin_hex_oct(8,n)}function ord(n){if(check_no_kw("ord",n),check_nb_args("ord",1,arguments),"string"==typeof n){if(1==n.length)return n.charCodeAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.length+" found")}switch($B.get_class(n)){case _b_.str:if(1==n.length)return n.charCodeAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.length+" found");case _b_.str.$surrogate:if(1==n.items.length)return n.items[0].codePointAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.items.length+" found");case _b_.bytes:case _b_.bytearray:if(1==n.source.length)return n.source[0];throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.source.length+" found");default:throw _b_.TypeError.$factory("ord() expected a character, but "+$B.class_name(n)+" was found")}}function pow(){var n=$B.args("pow",3,{x:null,y:null,mod:null},["x","y","mod"],arguments,{mod:None},null,null),o=n.x,l=n.y,x=n.mod,B=o.__class__||$B.get_class(o);if(x===_b_.None)return $B.$call($B.$getattr(B,"__pow__"))(o,l);if(o!=_b_.int.$factory(o)||l!=_b_.int.$factory(l))throw _b_.TypeError.$factory("pow() 3rd argument not allowed unless all arguments are integers");return $B.$call($B.$getattr(B,"__pow__"))(o,l,x)}function $print(){var n=$B.args("print",0,{},[],arguments,{},"args","kw"),o=n.kw.$string_dict,l=void 0===o.end||o.end===None?"\n":o.end[0],x=void 0===o.sep||o.sep===None?" ":o.sep[0],B=void 0===o.file?$B.stdout:o.file[0],G=[];n.args.forEach(function(fe){G.push(_b_.str.$factory(fe))});var M=G.join(x)+l;M=M.replace(new RegExp("\x07","g"),"").replace(new RegExp("(.)\b","g"),""),$B.$getattr(B,"write")(M);var P=$B.$getattr(B,"flush",None);return P!==None&&P(),None}$print.__name__="print",$print.is_func=!0;var property=$B.make_class("property",function(n,o,l,x){var B={__class__:property};return property.__init__(B,n,o,l,x),B});function quit(){throw _b_.SystemExit}function repr(n){check_no_kw("repr",n),check_nb_args("repr",1,arguments);var o=n.__class__||$B.get_class(n);return $B.$call($B.$getattr(o,"__repr__"))(n)}property.__init__=function(n,o,l,x,B){if(n.__doc__=B||"",n.$type=o.$type,n.fget=o,n.fset=l,n.fdel=x,o&&o.$attrs)for(var D in o.$attrs)n[D]=o.$attrs[D];n.__get__=function(G,M,P){if(void 0===M)return G;if(void 0===G.fget)throw _b_.AttributeError.$factory("unreadable attribute");return $B.$call(G.fget)(M)},void 0!==l&&(n.__set__=function(G,M,P){if(void 0===G.fset)throw _b_.AttributeError.$factory("can't set attribute");$B.$getattr(G.fset,"__call__")(M,P)}),n.__delete__=x,n.getter=function(G){return property.$factory(G,n.fset,n.fdel,n.__doc__)},n.setter=function(G){return property.$factory(n.fget,G,n.fdel,n.__doc__)},n.deleter=function(G){return property.$factory(n.fget,n.fset,G,n.__doc__)}},property.__repr__=function(n){return _b_.repr(n.fget(n))},property.__str__=function(n){return _b_.str.$factory(n.fget(n))},$B.set_func_names(property,"builtins"),quit.__repr__=quit.__str__=function(){return"Use quit() or Ctrl-Z plus Return to exit"};var reversed=$B.make_class("reversed",function(n){check_no_kw("reversed",n),check_nb_args("reversed",1,arguments);var o=n.__class__||$B.get_class(n),l=$B.$getattr(o,"__reversed__",null);if(null!==l)return $B.$call(l)(n);try{var x=$B.$getattr(o,"__getitem__")}catch{throw _b_.TypeError.$factory("argument to reversed() must be a sequence")}return{__class__:reversed,$counter:_b_.len(n),getter:function(D){return $B.$call(x)(n,D)}}});function round(){var n=$B.args("round",2,{number:null,ndigits:null},["number","ndigits"],arguments,{ndigits:None},null,null),o=n.number,l=n.ndigits===None?0:n.ndigits;if(!isinstance(o,[_b_.int,_b_.float])){var x=o.__class__||$B.get_class(o);try{return $B.$call($B.$getattr(x,"__round__")).apply(null,arguments)}catch(P){throw P.__class__===_b_.AttributeError?_b_.TypeError.$factory("type "+$B.class_name(o)+" doesn't define __round__ method"):P}}if(isinstance(o,_b_.float)&&(o.value===1/0||o.value===-1/0))throw _b_.OverflowError.$factory("cannot convert float infinity to integer");if(!isinstance(l,_b_.int))throw _b_.TypeError.$factory("'"+$B.class_name(l)+"' object cannot be interpreted as an integer");var B,D=Math.pow(10,l),G=o*D,M=Math.floor(G);return.5==Math.abs(G-M)?(M%2&&(M+=1),B=_b_.int.__truediv__(M,D)):B=_b_.int.__truediv__(Math.round(G),D),n.ndigits===None?B.valueOf():o instanceof Number?new Number(B):B.valueOf()}function setattr(){var n=$B.args("setattr",3,{obj:null,attr:null,value:null},["obj","attr","value"],arguments,{},null,null),o=n.obj,l=n.attr,x=n.value;if("string"!=typeof l)throw _b_.TypeError.$factory("setattr(): attribute name must be string");return $B.$setattr(o,l,x)}function sorted(){for(var n=$B.args("sorted",1,{iterable:null},["iterable"],arguments,{},null,"kw"),o=_b_.list.$factory(iter(n.iterable)),l=[o],x=1;x<arguments.length;x++)l.push(arguments[x]);return _b_.list.sort.apply(null,l),o}reversed.__iter__=function(n){return n},reversed.__next__=function(n){if(n.$counter--,n.$counter<0)throw _b_.StopIteration.$factory("");return n.getter(n.$counter)},$B.set_func_names(reversed,"builtins"),$B.$setattr=function(n,o,l){if($B.aliased_names[o])o="$$"+o;else{if("__dict__"==o){if(!isinstance(l,_b_.dict))throw _b_.TypeError.$factory("__dict__ must be set to a dictionary, not a '"+$B.class_name(l)+"'");return n.$infos?(n.$infos.__dict__=l,None):(n.__dict__=l,None)}if("__class__"==o){let A=function(R){throw _b_.TypeError.$factory(R)};if(l.__class__)if("builtins"==l.__module__)A("__class__ assignement only supported for heap types or ModuleType subclasses");else if(Array.isArray(l.__bases__))for(var x=0;x<l.__bases__.length;x++)"builtins"==l.__bases__[x].__module__&&A("__class__ assignment: '"+$B.class_name(n)+"' object layout differs from '"+$B.class_name(l)+"'");return n.__class__=l,None}"__doc__"==o&&n.__class__===_b_.property&&(n[o]=l)}if(n.$factory||n.$is_class){var B=n.__class__;return B&&B[o]&&B[o].__get__&&B[o].__set__?(B[o].__set__(n,l),None):(n[o]=l,"__init__"==o||"__new__"==o?n.$factory=$B.$instance_creator(n):"__bases__"==o&&(n.__mro__=_b_.type.mro(n)),None)}var D=n[o],G=n.__class__||$B.get_class(n);if(void 0===D&&G&&void 0===(D=G[o])){var M=(ue=G.__mro__).length;for(x=0;x<M&&void 0===(D=ue[x][o]);x++);}if(null!=D){if(void 0!==D.__set__)return D.__set__(D,n,l),None;var P,fe=D.__class__;if(void 0!==fe&&void 0===(P=fe.__set__))for(x=0,M=(ue=fe.__mro__).length;x<M&&!(P=ue[x].__set__);x++);if(void 0!==P){var ye=$B.$getattr(D,"__set__",null);if(ye&&"function"==typeof ye)return ye.apply(D,[n,l]),None}else if(G&&void 0!==G.$descriptors&&void 0!==G[o]){var ne=G[o].setter;if("function"==typeof ne)return ne(n,l),None;throw _b_.AttributeError.$factory("readonly attribute")}}var ue,me=!1;if(void 0!==G&&void 0===(me=G.__setattr__))for(x=0,M=(ue=G.__mro__).length-1;x<M&&!(me=ue[x].__setattr__);x++);if(G&&G.__slots__&&-1==["__module__"].indexOf(o)&&!me){let A=function(R){return R.__slots__?Array.isArray(R.__slots__)?R.__slots__.map(function(X){return X.startsWith("__")&&!X.endsWith("_")?"_"+R.$infos.__name__+X:X}):R.__slots__:[]};var ie=!1;if(A(G).indexOf(o)>-1)ie=!0;else for(x=0;x<G.__mro__.length;x++)if(A(G.__mro__[x]).indexOf(o)>-1){ie=!0;break}if(!ie)throw _b_.AttributeError.$factory("'"+G.$infos.__name__+"' object has no attribute '"+o+"'")}return me?me(n,o,l):void 0===n.__dict__?n[o]=l:_b_.dict.$setitem(n.__dict__,o,l),None};var staticmethod=$B.make_class("staticmethod",function(n){var o={$infos:n.$infos,__get__:function(){return n}};return o.__get__.__class__=$B.method_wrapper,o.__get__.$infos=n.$infos,o});function sum(n,o){var l=$B.args("sum",2,{iterable:null,start:null},["iterable","start"],arguments,{start:0},null,null);if(n=l.iterable,_b_.isinstance(o=l.start,[_b_.str,_b_.bytes]))throw _b_.TypeError.$factory("TypeError: sum() can't sum bytes [use b''.join(seq) instead]");var x=o;for(n=iter(n);;)try{var B=next(n);x=$B.$getattr(x,"__add__")(B)}catch(D){if(D.__class__===_b_.StopIteration)break;throw D}return x}$B.set_func_names(staticmethod,"builtins"),$B.missing_super2=function(n){return n.$missing=!0,n};var $$super=$B.make_class("super",function(n,o){if(void 0===n&&void 0===o){var l=$B.last($B.frames_stack),x=$B.imported._sys.Getframe();if(!x.f_code||!x.f_code.co_varnames||void 0===(n=l[1].__class__))throw _b_.RuntimeError.$factory("super(): no arguments");o=l[1][x.f_code.co_varnames[0]]}return Array.isArray(o)&&(o=o[0]),{__class__:$$super,__thisclass__:n,__self_class__:o}});function vars(){var n={},o=$B.args("vars",1,{obj:null},["obj"],arguments,{obj:n},null,null);if(o.obj===n)return _b_.locals();try{return $B.$getattr(o.obj,"__dict__")}catch(l){throw l.__class__===_b_.AttributeError?_b_.TypeError.$factory("vars() argument must have __dict__ attribute"):l}}$$super.__get__=function(n,o,l){return $$super.$factory(n.__thisclass__,o)},$$super.__getattribute__=function(n,o){var l=n.__thisclass__.__mro__,x=n.__self_class__;if(void 0!==x){x.$is_class||(x=x.__class__||$B.get_class(x));for(var B=[x].concat(x.__mro__),D=0;D<B.length;D++)if(B[D]===n.__thisclass__){l=B.slice(D+1);break}}D=0;for(var G,M,P=l.length;D<P;D++)if(void 0!==l[D][o]){G=l[D][o];break}if(void 0===G){if(void 0!==$$super[o])return M=n,function(){for(var ue=[M],me=0,ie=arguments.length;me<ie;me++)ue.push(arguments[me]);return $$super[o].apply(null,ue)};throw _b_.AttributeError.$factory(o)}if("staticmethod"==G.$type||"__new__"==o||"function"!=typeof G)return G;G.__class__===$B.method&&(G=G.$infos.__func__);var fe,ye=$B.$call(G),ne=function(){return ye(n.__self_class__,...arguments)};return ne.__class__=$B.method,void 0!==G.$infos?fe=G.$infos.__module__:G.__class__===property?fe=G.fget.$infos.__module:G.$is_class&&(fe=G.__module__),ne.$infos={__self__:n.__self_class__,__func__:G,__name__:o,__module__:fe,__qualname__:n.__thisclass__.$infos.__name__+"."+o},ne},$$super.__repr__=$$super.__str__=function(n){var o="<super: <class '"+n.__thisclass__.$infos.__name__+"'>";return(o+=void 0!==n.__self_class__?", <"+n.__self_class__.__class__.$infos.__name__+" object>":", NULL")+">"},$B.set_func_names($$super,"builtins");var $Reader=$B.make_class("Reader");function make_content(n){n.$binary&&void 0===n.$bytes?n.$bytes=_b_.str.encode(n.$string,n.encoding):n.$binary||void 0!==n.$string||(n.$string=_b_.bytes.decode(n.$bytes,n.encoding))}function make_lines(n){if(void 0===n.$lines)if(make_content(n),n.$binary){console.log("make lines, binary");for(var o=[],l=n.$bytes.source;;){var x=l.indexOf(10);if(-1==x){o.push({__class__:_b_.bytes,source:l});break}o.push({__class__:_b_.bytes,source:l.slice(0,x+1)}),l=l.slice(x+1)}n.$lines=o}else n.$lines=n.$string.split("\n")}$Reader.__enter__=function(n){return n},$Reader.__exit__=function(n){return!1},$Reader.__iter__=function(n){return iter($Reader.readlines(n))},$Reader.__len__=function(n){return n.lines.length},$Reader.close=function(n){n.closed=!0},$Reader.flush=function(n){return None},$Reader.read=function(){var n=$B.args("read",2,{self:null,size:null},["self","size"],arguments,{size:-1},null,null),o=n.self,l=$B.$GetInt(n.size);if(!0===o.closed)throw _b_.ValueError.$factory("I/O operation on closed file");return make_content(o),l<0&&(l=(o.$binary?o.$bytes.source.length:o.$string.length)-o.$counter),res=o.$binary?_b_.bytes.$factory(o.$bytes.source.slice(o.$counter,o.$counter+l)):o.$string.substr(o.$counter,l),o.$counter+=l,res},$Reader.readable=function(n){return!0},$Reader.readline=function(n,o){var l=$B.args("readline",2,{self:null,size:null},["self","size"],arguments,{size:-1},null,null);if(n=l.self,o=$B.$GetInt(l.size),n.$lc=void 0===n.$lc?-1:n.$lc,!0===n.closed)throw _b_.ValueError.$factory("I/O operation on closed file");if(make_content(n),n.$binary){var x;if(-1==(x=n.$bytes.source.indexOf(10,n.$counter)))return _b_.bytes.$factory();var B={__class__:_b_.bytes,source:n.$bytes.source.slice(n.$counter,x+1)};return n.$counter=x+1,B}return-1==(x=n.$string.indexOf("\n",n.$counter))?"":(B=n.$string.substring(n.$counter,x+1),n.$counter=x+1,n.$lc+=1,B)},$Reader.readlines=function(){var n=$B.args("readlines",2,{self:null,hint:null},["self","hint"],arguments,{hint:-1},null,null),o=n.self,l=$B.$GetInt(n.hint);if(!0===o.closed)throw _b_.ValueError.$factory("I/O operation on closed file");if(o.$lc=void 0===o.$lc?-1:o.$lc,make_lines(o),l<0)var x=o.$lines.slice(o.$lc+1);else for(x=[];o.$lc<o.$lines.length&&0<l;)o.$lc++,x.push(o.$lines[o.$lc]);for(;""==x[x.length-1];)x.pop();return x},$Reader.seek=function(n,o,l){if(n.closed===True)throw _b_.ValueError.$factory("I/O operation on closed file");void 0===l&&(l=0),0===l?n.$counter=o:1===l?n.$counter+=o:2===l&&(n.$counter=n.$content.length+o)},$Reader.seekable=function(n){return!0},$Reader.tell=function(n){return n.$counter},$Reader.writable=function(n){return!1},$B.set_func_names($Reader,"builtins");var $BufferedReader=$B.make_class("_io.BufferedReader");$BufferedReader.__mro__=[$Reader,_b_.object];var $TextIOWrapper=$B.make_class("_io.TextIOWrapper",function(){var n=$B.args("TextIOWrapper",6,{buffer:null,encoding:null,errors:null,newline:null,line_buffering:null,write_through:null},["buffer","encoding","errors","newline","line_buffering","write_through"],arguments,{encoding:"utf-8",errors:_b_.None,newline:_b_.None,line_buffering:_b_.False,write_through:_b_.False},null,null);return{__class__:$TextIOWrapper,$bytes:n.buffer.$bytes,encoding:n.encoding,errors:n.errors,newline:n.newline}});function $url_open(){var $ns=$B.args("open",3,{file:null,mode:null,encoding:null},["file","mode","encoding"],arguments,{mode:"r",encoding:"utf-8"},"args","kw"),$bytes,$string,$res;for(var attr in $ns)eval("var "+attr+'=$ns["'+attr+'"]');if(args.length>0)var mode=args[0];if(args.length>1)var encoding=args[1];if(mode.search("w")>-1)throw _b_.IOError.$factory("Browsers cannot write on disk");if(-1==["r","rb"].indexOf(mode))throw _b_.ValueError.$factory("Invalid mode '"+mode+"'");if(isinstance(file,_b_.str)){var is_binary=mode.search("b")>-1;if($B.file_cache.hasOwnProperty($ns.file))$string=$B.file_cache[$ns.file];else if($B.files&&$B.files.hasOwnProperty($ns.file)){$res=atob($B.files[$ns.file].content);var source=[];for(const n of $res)source.push(n.charCodeAt(0));$bytes=_b_.bytes.$factory(),$bytes.source=source}else{if("file"==$B.protocol)throw _b_.FileNotFoundError.$factory("cannot use 'open()' with protocol 'file'");if(is_binary)throw _b_.IOError.$factory("open() in binary mode is not supported");var req=new XMLHttpRequest;req.onreadystatechange=function(){try{var n=this.status;$res=404==n?_b_.FileNotFoundError.$factory(file):200!=n?_b_.IOError.$factory("Could not open file "+file+" : status "+n):this.responseText}catch(o){$res=_b_.IOError.$factory("Could not open file "+file+" : error "+o)}};var fake_qs=$B.$options.cache?"":"?foo="+(new Date).getTime();if(req.open("GET",file+fake_qs,!1),req.overrideMimeType("text/plain; charset=utf-8"),req.send(),$res.constructor===Error)throw $res;$string=$res}if(void 0===$string&&void 0===$bytes)throw _b_.FileNotFoundError.$factory($ns.file);var res={$binary:is_binary,$string,$bytes,$counter:0,closed:False,encoding,mode,name:file};return res.__class__=is_binary?$BufferedReader:$TextIOWrapper,res}throw _b_.TypeError.$factory("invalid argument for open(): "+_b_.str.$factory(file))}$TextIOWrapper.__mro__=[$Reader,_b_.object],$B.set_func_names($TextIOWrapper,"builtins"),$B.Reader=$Reader,$B.TextIOWrapper=$TextIOWrapper,$B.BufferedReader=$BufferedReader;var zip=$B.make_class("zip",function(){var n={__class__:zip,items:[]};if(0==arguments.length)return n;for(var o=$B.args("zip",0,{},[],arguments,{},"args","kw").args,l=[],x=0;x<o.length;x++)l.push(iter(o[x]));for(var B=0,D=[];;){var G=[],M=!0;for(x=0;x<l.length;x++)try{G.push(next(l[x]))}catch(P){if(P.__class__==_b_.StopIteration){M=!1;break}throw P}if(!M)break;D[B++]=_b_.tuple.$factory(G)}return n.items=D,n}),zip_iterator=$B.make_iterator_class("zip_iterator");function no_set_attr(n,o){throw _b_.AttributeError.$factory(void 0!==n[o]?"'"+n.$infos.__name__+"' object attribute '"+o+"' is read-only":"'"+n.$infos.__name__+"' object has no attribute '"+o+"'")}zip.__iter__=function(n){return zip_iterator.$factory(n.items)},$B.set_func_names(zip,"builtins");var True=!0,False=!1,ellipsis=$B.make_class("ellipsis",function(){return Ellipsis}),Ellipsis={__class__:ellipsis,__bool__:function(){return True}};for(var $key in $B.$comps)switch($B.$comps[$key]){case"ge":case"gt":case"le":case"lt":ellipsis["__"+$B.$comps[$key]+"__"]=function(n){return function(o){throw _b_.TypeError.$factory("unorderable types: ellipsis() "+n+" "+$B.class_name(o))}}($key)}for(var $func in Ellipsis)"function"==typeof Ellipsis[$func]&&(Ellipsis[$func].__str__=function(o){return function(){return"<method-wrapper "+o+" of Ellipsis object>"}}($func));$B.set_func_names(ellipsis);var FunctionCode=$B.make_class("function code"),FunctionGlobals=$B.make_class("function globals");$B.Function={__class__:_b_.type,__code__:{__class__:FunctionCode,__name__:"function code"},__globals__:{__class__:FunctionGlobals,__name__:"function globals"},__mro__:[_b_.object],$infos:{__name__:"function",__module__:"builtins"},$is_class:!0},$B.Function.__delattr__=function(n,o){if("__dict__"==o)throw _b_.TypeError.$factory("can't deleted function __dict__")},$B.Function.__dir__=function(n){var l=n.$attrs||{};return Object.keys(n.$infos||{}).concat(Object.keys(l))},$B.Function.__eq__=function(n,o){return n===o},$B.Function.__get__=function(n,o){if(o===_b_.None)return n;var l=function(){return n(o,...arguments)};return l.__class__=$B.method,void 0===n.$infos&&(console.log("no $infos",n),console.log($B.last($B.frames_stack))),l.$infos={__name__:n.$infos.__name__,__qualname__:$B.class_name(o)+"."+n.$infos.__name__,__self__:o,__func__:n},l},$B.Function.__getattribute__=function(n,o){if(!n.$infos||void 0===n.$infos[o]){if(n.$infos&&n.$infos.__dict__&&void 0!==n.$infos.__dict__.$string_dict[o])return n.$infos.__dict__.$string_dict[o][0];if("__closure__"==o){var l=n.$infos.__code__.co_freevars;if(0==l.length)return None;for(var x=[],B=0;B<l.length;B++)try{x.push($B.cell.$factory($B.$check_def_free(l[B])))}catch{x.push($B.cell.$factory(None))}return _b_.tuple.$factory(x)}return"__globals__"==o?$B.obj_dict($B.imported[n.$infos.__module__]):n.$attrs&&void 0!==n.$attrs[o]?n.$attrs[o]:_b_.object.__getattribute__(n,o)}if("__code__"==o){var D={__class__:code};for(var o in n.$infos.__code__)D[o]=n.$infos.__code__[o];return D.name=n.$infos.__name__,D.filename=n.$infos.__code__.co_filename,D.co_code=n+"",D}return"__annotations__"==o?$B.obj_dict(n.$infos[o]):n.$infos.hasOwnProperty(o)?n.$infos[o]:void 0},$B.Function.__repr__=$B.Function.__str__=function(n){return void 0===n.$infos?"<function "+n.name+">":"<function "+n.$infos.__qualname__+">"},$B.Function.__mro__=[_b_.object],$B.Function.__setattr__=function(n,o,l){if("__closure__"==o)throw _b_.AttributeError.$factory("readonly attribute");if("__defaults__"==o){if(l===_b_.None)l=[];else if(!isinstance(l,_b_.tuple))throw _b_.TypeError.$factory("__defaults__ must be set to a tuple object");var x=n.$set_defaults;if(void 0===x||!n.$infos||!n.$infos.__code__)throw _b_.AttributeError.$factory("cannot set attribute "+o+" of "+_b_.str.$factory(n));for(var D=n.$infos.__code__.co_varnames.slice(0,n.$infos.__code__.co_argcount),G={},M=l.length-1;M>=0;M--){var P=D.length-l.length+M;if(P<0)break;G[D[P]]=l[M]}var fe=n.$infos.$class,ye=x(G);return ye.$set_defaults=x,fe?(fe[n.$infos.__name__]=ye,ye.$infos.$class=fe,ye.$infos.__defaults__=l):(n.$infos.$defaults=l,n.$infos.__defaults__=l),_b_.None}void 0!==n.$infos[o]?n.$infos[o]=l:(n.$attrs=n.$attrs||{},n.$attrs[o]=l)},$B.Function.$factory=function(){},$B.set_func_names($B.Function,"builtins"),_b_.__BRYTHON__=__BRYTHON__,$B.builtin_funcs=["abs","all","any","ascii","bin","breakpoint","callable","chr","compile","delattr","dir","divmod","eval","exec","exit","format","getattr","globals","hasattr","hash","help","hex","id","input","isinstance","issubclass","iter","len","locals","max","min","next","oct","open","ord","pow","print","quit","repr","round","setattr","sorted","sum","vars"];var builtin_function=$B.builtin_function=$B.make_class("builtin_function_or_method");builtin_function.__getattribute__=$B.Function.__getattribute__,builtin_function.__reduce_ex__=builtin_function.__reduce__=function(n){return n.$infos.__name__},builtin_function.__repr__=builtin_function.__str__=function(n){return"<built-in function "+n.$infos.__name__+">"},$B.set_func_names(builtin_function,"builtins");var method_wrapper=$B.make_class("method_wrapper");method_wrapper.__repr__=method_wrapper.__str__=function(n){return"<method wrapper '"+n.$infos.__name__+"' of function object>"},$B.set_func_names(method_wrapper,"builtins");var wrapper_descriptor=$B.wrapper_descriptor=$B.make_class("wrapper_descriptor");wrapper_descriptor.__getattribute__=$B.Function.__getattribute__,wrapper_descriptor.__repr__=wrapper_descriptor.__str__=function(n){return"<slot wrapper '"+n.$infos.__name__+"' of '"+n.__objclass__.$infos.__name__+"' object>"},$B.set_func_names(wrapper_descriptor,"builtins"),$B.builtin_classes=["bool","bytearray","bytes","classmethod","complex","dict","enumerate","filter","float","frozenset","int","list","map","memoryview","object","property","range","reversed","set","slice","staticmethod","str","super","tuple","type","zip"];for(var other_builtins=["Ellipsis","False","None","True","__debug__","__import__","copyright","credits","license","NotImplemented"],builtin_names=$B.builtin_funcs.concat($B.builtin_classes).concat(other_builtins),i=0;i<builtin_names.length;i++){var name=builtin_names[i],orig_name=name,name1=name;"open"==name&&(name1="$url_open"),"super"==name&&(name=name1="$$super"),"eval"==name&&(name=name1="$$eval"),"print"==name&&(name1="$print");try{_b_[name]=eval(name1),$B.builtin_funcs.indexOf(orig_name)>-1&&(_b_[name].__class__=builtin_function,_b_[name].$infos={__module__:"builtins",__name__:orig_name,__qualname__:orig_name})}catch(n){}}_b_.open=$url_open,_b_.print=$print,_b_.$$super=$$super,_b_.object.__init__.__class__=wrapper_descriptor,_b_.object.__new__.__class__=builtin_function}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns),$B.del_exc=function(){$B.last($B.frames_stack)[1].$current_exception=void 0},$B.set_exc=function(n){var o=$B.last($B.frames_stack);void 0===o&&console.log("no frame",n),o[1].$current_exception=$B.exception(n)},$B.get_exc=function(){return $B.last($B.frames_stack)[1].$current_exception},$B.$raise=function(n){if(void 0===n){var o=$B.get_exc();throw void 0!==o?o:_b_.RuntimeError.$factory("No active exception to reraise")}throw isinstance(n,BaseException)?(n.__class__===_b_.StopIteration&&$B.last($B.frames_stack)[1].$is_generator&&(n=_b_.RuntimeError.$factory("generator raised StopIteration")),n):n.$is_class&&issubclass(n,BaseException)?n===_b_.StopIteration&&$B.last($B.frames_stack)[1].$is_generator?_b_.RuntimeError.$factory("generator raised StopIteration"):$B.$call(n)():_b_.TypeError.$factory("exceptions must derive from BaseException")},$B.$syntax_err_line=function(n,o,l,x,B){var D={},G=1;if(o="$"==o.charAt(0)?"<string>":o,void 0===l)n.$line_info=B+","+o,n.args=_b_.tuple.$factory([$B.$getitem(n.args,0),o,B,0,0]);else{for(var M={1:0},P=0,fe=l.length;P<fe;P++)D[P]=G,"\n"==l.charAt(P)&&(M[++G]=P);for(;void 0===B;)B=D[x],x--;n.$line_info=B+","+o;var ye=l.split("\n")[B-1],ne=x-M[B];for(fe=ye.length,n.text=ye,(ne-=fe-ye.length)<0&&(ne=0);" "==ye.charAt(0);)ye=ye.substr(1),ne>0&&ne--;n.offset=ne,n.args=_b_.tuple.$factory([$B.$getitem(n.args,0),o,B,ne,ye])}n.lineno=B,n.msg=n.args[0],n.filename=o},$B.$SyntaxError=function(n,o,l,x,B,D){void 0!==D&&void 0!==D.line_info&&(B=D.line_info);var G=_b_.SyntaxError.$factory(o);throw $B.$syntax_err_line(G,n,l,x,B),G},$B.$IndentationError=function(n,o,l,x,B,D){$B.frames_stack.push([n,{$line_info:B+","+n},n,{$src:l}]),void 0!==D&&void 0!==D.line_info&&(B=D.line_info);var G=_b_.IndentationError.$factory(o);throw $B.$syntax_err_line(G,n,l,x,B),G},$B.print_stack=function(n){var o=[];return(n=n||$B.frames_stack).forEach(function(l){var x=l[1].$line_info;if(void 0!==x){var B=x.split(",");B[1].startsWith("$exec")&&(B[1]="<module>"),o.push(B[1]+" line "+B[0]);var D=$B.file_cache[l[3].__file__];if(D){var G=D.split("\n")[parseInt(B[0])-1];o.push("  "+G.trim())}}}),console.log("print stack ok",o),o.join("\n")};var traceback=$B.traceback=$B.make_class("traceback",function(n,o){return $B.last($B.frames_stack),void 0===o&&(o=n.$stack),{__class__:traceback,$stack:o,exc:n}});traceback.__getattribute__=function(n,o){var l;if("tb_frame"===o||"tb_lineno"===o||"tb_lasti"===o||"tb_next"===o){0==n.$stack.length&&console.log("no stack",o);var x=n.$stack[0];l=n.exc.$line_infos[n.exc.$line_infos.length-n.$stack.length]}switch(o){case"tb_frame":return frame.$factory(n.$stack);case"tb_lineno":return void 0===l||x[0].startsWith($B.lambda_magic)?x[4]&&x[4].$infos&&x[4].$infos.__code__?x[4].$infos.__code__.co_firstlineno:-1:parseInt(l.split(",")[0]);case"tb_lasti":if(void 0===l)return console.log("no line info",n.$stack),"";for(var B,D,G=l.split(","),M=n.$stack.length-1;M>=0;M--){var P=n.$stack[M];if(P[2]==G[1].replace(/\./g,"_")){D=P[3].__file__;break}}if(void 0===B&&($B.file_cache.hasOwnProperty(D)?B=$B.file_cache[D]:$B.imported[G[1]]&&$B.imported[G[1]].__file__&&(B=$B.file_cache[$B.imported[G[1]].__file__],console.log("from filecache",l,$B.imported[G[1]].__file__))),void 0===B)return console.log(D),console.log("no src for",G),"";try{return B.split("\n")[parseInt(G[0]-1)].trim()}catch(fe){throw console.log("error in attr tb_lasti of",n),console.log(B,G),fe}case"tb_next":return n.$stack.length<=1?None:traceback.$factory(n.exc,n.$stack.slice(1));default:return _b_.object.__getattribute__(n,o)}},$B.set_func_names(traceback,"builtins");var frame=$B.make_class("frame",function(n,o){var l=n,x={__class__:frame,f_builtins:{},$stack:n.slice()};if(void 0===o&&(o=0),x.$pos=o,l.length){var B,D=l[o],G=D[0];try{x.f_locals=$B.obj_dict(D[1])}catch(ye){throw console.log("err "+ye),ye}if(x.f_globals=$B.obj_dict(D[3]),void 0!==D[3].__file__&&(B=D[3].__file__),G.startsWith("$exec")&&(B="<string>"),void 0===D[1].$line_info)x.f_lineno=-1;else{var M=D[1].$line_info.split(",");x.f_lineno=parseInt(M[0]);var P=M[1];$B.imported.hasOwnProperty(P)&&(B=$B.imported[P].__file__),x.f_lineno=parseInt(D[1].$line_info.split(",")[0])}var fe=G.startsWith("$exec")?"<module>":G;G==D[2]?fe="<module>":G.startsWith("lc"+$B.lambda_magic)?fe="<listcomp>":D[1].$name?fe=D[1].$name:D[1].$dict_comp?fe="<dictcomp>":D[1].$list_comp?fe="<listcomp>":D.length>4&&(fe=D[4].$infos?D[4].$infos.__name__:D[4].name,void 0===D[4].$infos?D[4].name.startsWith("__ge")?fe="<genexpr>":D[4].name.startsWith("set_comp"+$B.lambda_magic)?fe="<setcomp>":D[4].name.startsWith("lambda"+$B.lambda_magic)&&(fe="<lambda>"):void 0===B&&D[4].$infos.__code__&&(void 0===(B=D[4].$infos.__code__.co_filename)&&(B=D[4].$infos.__module__),x.f_lineno=D[4].$infos.__code__.co_firstlineno)),x.f_code=D.length>4&&void 0!==D[4].$infos?D[4].$infos.__code__:{co_name:fe,co_filename:B},x.f_code.__class__=$B.code,x.f_code.co_code=_b_.None,void 0===B&&(x.f_code.co_filename="<string>")}return x});frame.__delattr__=function(n,o){"f_trace"==o&&($B.last(n.$stack)[1].$f_trace=_b_.None)},frame.__getattr__=function(n,o){if("f_back"==o)return n.$pos>0?frame.$factory(n.$stack.slice(0,n.$stack.length-1),n.$pos-1):_b_.None;if("clear"==o)return function(){};if("f_trace"==o){var l=$B.last(n.$stack)[1];return void 0===l.$f_trace?_b_.None:l.$f_trace}},frame.__setattr__=function(n,o,l){"f_trace"==o&&($B.last(n.$stack)[1].$f_trace=l)},frame.__str__=frame.__repr__=function(n){return"<frame object, file "+n.f_code.co_filename+", line "+n.f_lineno+", code "+n.f_code.co_name+">"},$B.set_func_names(frame,"builtins"),$B._frame=frame;var BaseException=_b_.BaseException={__class__:_b_.type,__bases__:[_b_.object],__mro__:[_b_.object],args:[],$infos:{__name__:"BaseException",__module__:"builtins"},$is_class:!0};BaseException.__init__=function(n){n.args=_b_.tuple.$factory(void 0===arguments[1]?[]:[arguments[1]])},BaseException.__repr__=function(n){var o=n.__class__.$infos.__name__;return n.args[0]&&(o+="("+repr(n.args[0])),n.args.length>1&&(o+=", "+repr($B.fast_tuple(n.args.slice(1)))),o+")"},BaseException.__str__=function(n){return n.args.length>0?_b_.str.$factory(n.args[0]):n.__class__.$infos.__name__},BaseException.__new__=function(n){var o=_b_.BaseException.$factory();return o.__class__=n,o.__dict__=$B.empty_dict(),o};var getExceptionTrace=function(n,o){if(void 0===n.__class__)return $B.debug>1&&console.log("no class",n),n+"";var l="";void 0!==n.$js_exc&&o&&(l+="\nJS stack:\n"+n.$js_exc.stack+"\n"),l+="Traceback (most recent call last):";for(var x=n.$line_info,B=0;B<n.$stack.length;B++){var D=n.$stack[B];if(D[1]&&D[1].$line_info){var G;if(x=D[1].$line_info.split(","),n.module==x[1]&&(G=n.src),!o&&void 0===(G=D[3].$src))if($B.VFS&&$B.VFS.hasOwnProperty(D[2]))G=$B.VFS[D[2]][1];else if(!(G=$B.file_cache[D[3].__file__]))continue;var M=D[3].__file__||"<string>",P=x[1],fe="$"==P.charAt(0);if(fe&&(P="<module>"),l+="\n  File "+M+" line "+x[0],D.length>4)if(D[4].$infos){var ye=D[4].$infos.__name__;ye.startsWith("lc"+$B.lambda_magic)?l+=",in <listcomp>":l+=", in "+ye}else D[4].name.startsWith("__ge")?l+=", in <genexpr>":D[4].name.startsWith("set_comp"+$B.lambda_magic)?l+=", in <setcomp>":D[4].name.startsWith("lc"+$B.lambda_magic)?l+=", in <listcomp>":console.log("frame[4]",D[4]);else l+=D[1].$list_comp?", in <listcomp>":D[1].$dict_comp?", in <dictcomp>":", in <module>";if(void 0!==G&&!fe){var ne=G.split("\n")[parseInt(x[0])-1];ne&&(ne=ne.replace(/^[ ]+/g,"")),l+="\n    "+ne}}}return n.__class__===_b_.SyntaxError&&(l+="\n  File "+n.args[1]+", line "+n.args[2]+"\n    "+n.args[4]),l};BaseException.__getattr__=function(n,o){if("info"==o)return getExceptionTrace(n,!1);if("infoWithInternal"==o)return getExceptionTrace(n,!0);if("__traceback__"==o)return void 0!==n.$traceback?n.$traceback:traceback.$factory(n);throw _b_.AttributeError.$factory(n.__class__.$infos.__name__+" has no attribute '"+o+"'")},BaseException.with_traceback=function(n,o){return n.$traceback=o,n},$B.deep_copy=function(n){var o=[];for(const B of n){var l=[B[0],{},B[2],{}];void 0!==B[4]&&l.push(B[4]);for(const D of[1,3])for(var x in B[D])l[D][x]=B[D][x];o.push(l)}return o},$B.save_stack=function(){return $B.deep_copy($B.frames_stack)},$B.restore_stack=function(n,o){$B.frames_stack=n,$B.frames_stack[$B.frames_stack.length-1][1]=o},$B.freeze=function(n){if(void 0===n.$stack){n.$line_infos=[];for(var o=0,l=$B.frames_stack.length;o<l;o++)n.$line_infos.push($B.frames_stack[o][1].$line_info);n.$stack=$B.frames_stack.slice(),$B.frames_stack.length&&(n.$line_info=$B.last($B.frames_stack)[1].$line_info)}};var show_stack=$B.show_stack=function(n){n=n||$B.frames_stack;for(const o of n)console.log(o[0],o[1].$line_info)};function $make_exc(names,parent){for(var _str=[],pos=0,i=0;i<names.length;i++){var name=names[i],code="";if(Array.isArray(name))var code=name[1],name=name[0];$B.builtins_scope[name]=!0;var $exc=(BaseException.$factory+"").replace(/BaseException/g,name);$exc=$exc.replace("//placeholder//",code),_str[pos++]="_b_."+name+" = {__class__:_b_.type, __mro__: [_b_."+parent.$infos.__name__+"].concat(parent.__mro__), $is_class: true,$infos: {__name__:'"+name+"'}}",_str[pos++]="_b_."+name+".$factory = "+$exc,_str[pos++]="_b_."+name+'.$factory.$infos = {__name__: "'+name+'", __qualname__: "'+name+'"}',_str[pos++]="$B.set_func_names(_b_."+name+", 'builtins')"}try{eval(_str.join(";"))}catch(n){throw console.log("--err"+n),n}}BaseException.$factory=function(){var err=Error();return err.args=$B.fast_tuple(Array.prototype.slice.call(arguments)),err.__class__=_b_.BaseException,err.$py_error=!0,$B.freeze(err),eval("//placeholder//"),err.__cause__=_b_.None,err.__context__=_b_.None,err.__suppress_context__=!1,err},BaseException.$factory.$infos={__name__:"BaseException",__qualname__:"BaseException"},$B.set_func_names(BaseException),_b_.BaseException=BaseException,$B.exception=function(n,o){if(n.__class__){if($B.freeze(D=n),o)for(var l=$B.last($B.frames_stack)[0],x=0,B=D.$stack.length;x<B;x++)if(D.$stack[x][0]==l){D.$stack=D.$stack.slice(x),D.$traceback=traceback.$factory(D);break}}else{var D;if(console.log("Javascript exception:",n),console.log($B.last($B.frames_stack)),console.log("recursion error ?",$B.is_recursion_error(n)),(D=Error()).__name__="Internal Javascript error: "+(n.__name__||n.name),D.__class__=_b_.Exception,D.$js_exc=n,$B.is_recursion_error(n))return _b_.RecursionError.$factory("too much recursion");"ReferenceError"==n.name?(D.__name__="NameError",D.__class__=_b_.NameError,n.message=n.message.replace("$$","")):"InternalError"==n.name&&(D.__name__="RuntimeError",D.__class__=_b_.RuntimeError),D.__cause__=_b_.None,D.__context__=_b_.None,D.__suppress_context__=!1,D.args=_b_.tuple.$factory(["<Javascript "+n.name+">: "+(n.message||"<"+n+">")]),D.$py_error=!0,$B.freeze(D)}return D},$B.is_exc=function(n,o){void 0===n.__class__&&(n=$B.exception(n));for(var l=n.$is_class?n:n.__class__,x=0;x<o.length;x++){var B=o[x];if(void 0===l&&console.log("exc class undefined",n),issubclass(l,B))return!0}return!1},$B.is_recursion_error=function(n){console.log("test is js exc is recursion error",n,n+"");var o=(n+"").split(":"),l=o[0].trim(),x=o[1].trim();return"InternalError"==l&&"too much recursion"==x||"Error"==l&&"Out of stack space"==x||"RangeError"==l&&"Maximum call stack size exceeded"==x},$make_exc(["SystemExit","KeyboardInterrupt","GeneratorExit","Exception"],BaseException),$make_exc([["StopIteration","err.value = arguments[0]"],["StopAsyncIteration","err.value = arguments[0]"],"ArithmeticError","AssertionError","AttributeError","BufferError","EOFError",["ImportError","err.name = arguments[0]"],"LookupError","MemoryError","NameError","OSError","ReferenceError","RuntimeError",["SyntaxError","err.msg = arguments[0]"],"SystemError","TypeError","ValueError","Warning"],_b_.Exception),$make_exc(["FloatingPointError","OverflowError","ZeroDivisionError"],_b_.ArithmeticError),$make_exc([["ModuleNotFoundError","err.name = arguments[0]"]],_b_.ImportError),$make_exc(["IndexError","KeyError"],_b_.LookupError),$make_exc(["UnboundLocalError"],_b_.NameError),$make_exc(["BlockingIOError","ChildProcessError","ConnectionError","FileExistsError","FileNotFoundError","InterruptedError","IsADirectoryError","NotADirectoryError","PermissionError","ProcessLookupError","TimeoutError"],_b_.OSError),$make_exc(["BrokenPipeError","ConnectionAbortedError","ConnectionRefusedError","ConnectionResetError"],_b_.ConnectionError),$make_exc(["NotImplementedError","RecursionError"],_b_.RuntimeError),$make_exc(["IndentationError"],_b_.SyntaxError),$make_exc(["TabError"],_b_.IndentationError),$make_exc(["UnicodeError"],_b_.ValueError),$make_exc(["UnicodeDecodeError","UnicodeEncodeError","UnicodeTranslateError"],_b_.UnicodeError),$make_exc(["DeprecationWarning","PendingDeprecationWarning","RuntimeWarning","SyntaxWarning","UserWarning","FutureWarning","ImportWarning","UnicodeWarning","BytesWarning","ResourceWarning"],_b_.Warning),$make_exc(["EnvironmentError","IOError","VMSError","WindowsError"],_b_.OSError),$B.$TypeError=function(n){throw _b_.TypeError.$factory(n)};var se=_b_.SyntaxError.$factory;_b_.SyntaxError.$factory=function(){var n=arguments[0];if(n.__class__===_b_.SyntaxError)return n;var o=se.apply(null,arguments),l=$B.last($B.frames_stack);if(l){line_info=l[1].$line_info,o.filename=l[3].__file__,o.lineno=parseInt(line_info.split(",")[0]);var x=$B.file_cache[l[3].__file__];x&&(lines=x.split("\n"),o.text=lines[o.lineno-1]),o.offset=n.offset}return o},_b_}(__BRYTHON__),function(n){var o=n.builtins,l=o.None,x={__class__:o.type,__mro__:[o.object],$infos:{__module__:"builtins",__name__:"range"},$is_class:!0,$native:!0,$descriptors:{start:!0,step:!0,stop:!0}};function B(P,fe){var ye=x.__len__(P);return 0==ye?P.start:fe>ye?P.stop:n.add(P.start,n.mul(P.step,fe))}x.__contains__=function(P,fe){if(0==x.__len__(P))return!1;try{fe=n.int_or_bool(fe)}catch{try{return x.index(P,fe),!0}catch{return!1}}var ye=n.sub(fe,P.start),ne=n.floordiv(ye,P.step),ue=n.mul(P.step,ne);return!!n.eq(ue,ye)&&(n.gt(P.stop,P.start)?n.ge(fe,P.start)&&n.gt(P.stop,fe):n.ge(P.start,fe)&&n.gt(fe,P.stop))},x.__delattr__=function(P,fe,ye){throw o.AttributeError.$factory("readonly attribute")},x.__eq__=function(P,fe){if(o.isinstance(fe,x)){var ye=x.__len__(P);return!!n.eq(ye,x.__len__(fe))&&(0==ye||!!n.eq(P.start,fe.start)&&(1==ye||n.eq(P.step,fe.step)))}return!1},x.__getitem__=function(P,fe){if(o.isinstance(fe,o.slice)){var ye=o.slice.$conv_for_seq(fe,x.__len__(P)),ne=n.mul(P.step,ye.step),ue=B(P,ye.start),me=B(P,ye.stop);return x.$factory(ue,me,ne)}"number"!=typeof fe&&(fe=n.$GetInt(fe)),n.gt(0,fe)&&(fe=n.add(fe,x.__len__(P)));var ie=n.add(P.start,n.mul(fe,P.step));if(n.gt(P.step,0)&&(n.ge(ie,P.stop)||n.gt(P.start,ie))||n.gt(0,P.step)&&(n.ge(P.stop,ie)||n.gt(ie,P.start)))throw o.IndexError.$factory("range object index out of range");return ie},x.__hash__=function(P){var fe=x.__len__(P);return o.hash(o.tuple.$factory(0==fe?[0,l,l]:1==fe?[1,P.start,l]:[fe,P.start,P.step]))};var D={__class__:o.type,__mro__:[o.object],__iter__:function(P){return P},__next__:function(P){return o.next(P.obj)},$infos:{__name__:"range_iterator",__module__:"builtins"},$is_class:!0,$factory:function(P){return{__class__:D,obj:P}}};n.set_func_names(D,"builtins"),x.__iter__=function(P){var fe={__class__:x,start:P.start,stop:P.stop,step:P.step};return fe.$counter=P.$safe?P.start-P.step:n.sub(P.start,P.step),D.$factory(fe)},x.__len__=function(P){var fe;if(n.gt(P.step,0)){if(n.ge(P.start,P.stop))return 0;var ye=n.sub(P.stop,n.add(1,P.start)),ne=n.floordiv(ye,P.step);fe=n.add(1,ne)}else{if(n.ge(P.stop,P.start))return 0;ye=n.sub(P.start,n.add(1,P.stop)),ne=n.floordiv(ye,n.mul(-1,P.step)),fe=n.add(1,ne)}return void 0===n.maxsize&&(n.maxsize=n.long_int.__pow__(n.long_int.$factory(2),63),n.maxsize=n.long_int.__sub__(n.maxsize,1)),fe},x.__next__=function(P){if(P.$safe){if(P.$counter+=P.step,P.step>0&&P.$counter>=P.stop||P.step<0&&P.$counter<=P.stop)throw o.StopIteration.$factory("")}else if(P.$counter=n.add(P.$counter,P.step),n.gt(P.step,0)&&n.ge(P.$counter,P.stop)||n.gt(0,P.step)&&n.ge(P.stop,P.$counter))throw o.StopIteration.$factory("");return P.$counter},x.__reversed__=function(P){var fe=n.sub(x.__len__(P),1);return x.$factory(n.add(P.start,n.mul(fe,P.step)),n.sub(P.start,P.step),n.mul(-1,P.step))},x.__repr__=x.__str__=function(P){var fe="range("+o.str.$factory(P.start)+", "+o.str.$factory(P.stop);return 1!=P.step&&(fe+=", "+o.str.$factory(P.step)),fe+")"},x.__setattr__=function(P,fe,ye){throw o.AttributeError.$factory("readonly attribute")},x.start=function(P){return P.start},x.step=function(P){return P.step},x.stop=function(P){return P.stop},x.count=function(P,fe){if(o.isinstance(fe,[o.int,o.float,o.bool]))return o.int.$factory(x.__contains__(P,fe));for(var ye=x.__iter__(P),ne=D.__next__,ue=0;;)try{me=ne(ye),n.rich_comp("__eq__",fe,me)&&ue++}catch(ie){if(o.isinstance(ie,o.StopIteration))return ue;throw ie}var me},x.index=function(P,fe){var ye,ne=n.args("index",2,{self:null,other:null},["self","other"],arguments,{},null,null);P=ne.self,fe=ne.other;try{fe=n.int_or_bool(fe)}catch{for(var ue=x.__iter__(P),me=D.__next__,ie=0;;)try{if(ye=me(ue),n.rich_comp("__eq__",fe,ye))return ie;ie++}catch(X){throw o.isinstance(X,o.StopIteration)?o.ValueError.$factory(o.str.$factory(fe)+" not in range"):X}}var W=n.sub(fe,P.start),Q=n.floordiv(W,P.step),A=n.mul(P.step,Q);if(n.eq(A,W)){if(n.gt(P.stop,P.start)&&n.ge(fe,P.start)&&n.gt(P.stop,fe)||n.ge(P.start,P.stop)&&n.ge(P.start,fe)&&n.gt(fe,P.stop))return Q;throw o.ValueError.$factory(o.str.$factory(fe)+" not in range")}throw o.ValueError.$factory(o.str.$factory(fe)+" not in range")},x.$factory=function(){var P=n.args("range",3,{start:null,stop:null,step:null},["start","stop","step"],arguments,{start:null,stop:null,step:null},null,null),fe=P.start,ye=P.stop,ne=P.step;if(null===ye&&null===ne){if(null==fe)throw o.TypeError.$factory("range expected 1 arguments, got 0");return ye=n.PyNumber_Index(fe),{__class__:x,start:0,stop:ye,step:1,$is_range:!0,$safe:"number"==typeof ye}}if(null===ne&&(ne=1),fe=n.PyNumber_Index(fe),ye=n.PyNumber_Index(ye),0==(ne=n.PyNumber_Index(ne)))throw o.ValueError.$factory("range arg 3 must not be zero");return{__class__:x,start:fe,stop:ye,step:ne,$is_range:!0,$safe:"number"==typeof fe&&"number"==typeof ye&&"number"==typeof ne}},n.set_func_names(x,"builtins");var G={__class__:o.type,__mro__:[o.object],$infos:{__module__:"builtins",__name__:"slice"},$is_class:!0,$native:!0,$descriptors:{start:!0,step:!0,stop:!0}};function M(P){for(var fe=["start","stop","step"],ye=[],ne=0;ne<fe.length;ne++){var ue=P[fe[ne]];if(ue===o.None)ye.push(ue);else try{ye.push(n.PyNumber_Index(ue))}catch{throw o.TypeError.$factory("slice indices must be integers or None or have an __index__ method")}}return ye}G.__eq__=function(P,fe){var ye=M(P),ne=M(fe);return ye[0]==ne[0]&&ye[1]==ne[1]&&ye[2]==ne[2]},G.__repr__=G.__str__=function(P){return"slice("+o.str.$factory(P.start)+", "+o.str.$factory(P.stop)+", "+o.str.$factory(P.step)+")"},G.__setattr__=function(P,fe,ye){throw o.AttributeError.$factory("readonly attribute")},G.$conv_for_seq=function(P,fe){var ye,ne=P.step===l?1:n.PyNumber_Index(P.step),ue=n.gt(0,ne),me=n.sub(fe,1);if(0==ne)throw o.ValueError.$factory("slice step cannot be zero");return P.start===l?ye=ue?me:0:(ye=n.PyNumber_Index(P.start),n.gt(0,ye)&&(ye=n.add(ye,fe),n.gt(0,ye)&&(ye=0)),n.ge(ye,fe)&&(ye=ne<0?me:fe)),P.stop===l?stop=ue?-1:fe:(stop=n.PyNumber_Index(P.stop),n.gt(0,stop)&&(stop=n.add(stop,fe)),n.ge(stop,fe)&&(stop=ue?me:fe)),{start:ye,stop,step:ne}},G.start=function(P){return P.start},G.step=function(P){return P.step},G.stop=function(P){return P.stop},G.indices=function(P,fe){var ye=n.args("indices",2,{self:null,length:null},["self","length"],arguments,{},null,null),ne=n.$GetInt(ye.length);ne<0&&o.ValueError.$factory("length should not be negative");var ue=P.step==o.None?1:P.step;if(ue<0){var me=P.start,ie=P.stop;me=me==o.None?ne-1:me<0?o.max(-1,me+ne):o.min(ne-1,P.start),ie=P.stop==o.None?-1:ie<0?o.max(-1,ie+ne):o.min(ne-1,P.stop)}else me=P.start==o.None?0:o.min(ne,P.start),ie=P.stop==o.None?ne:o.min(ne,P.stop),me<0&&(me=o.max(0,me+ne)),ie<0&&(ie=o.max(0,ie+ne));return o.tuple.$factory([me,ie,ue])},G.$factory=function(){var P,fe,ye,ne=n.args("slice",3,{start:null,stop:null,step:null},["start","stop","step"],arguments,{stop:null,step:null},null,null);null===ne.stop&&null===ne.step?(P=o.None,fe=ne.start,ye=o.None):(P=ne.start,fe=ne.stop,ye=null===ne.step?o.None:ne.step);var ue={__class__:G,start:P,stop:fe,step:ye};return M(ue),ue},n.set_func_names(G,"builtins"),o.range=x,o.slice=G}(__BRYTHON__),function(n){var o=n.builtins,l={},x={};function B(W,Q,A){if(void 0===Q){Q=[];for(var R=0,X=4;R<X;R++)Q.push("\r\n \t".charCodeAt(R))}else{if(!o.isinstance(Q,P))throw o.TypeError.$factory("Type str doesn't support the buffer API");Q=Q.source}if("l"==A){for(R=0,X=W.source.length;R<X&&-1!=Q.indexOf(W.source[R]);R++);return P.$factory(W.source.slice(R))}for(R=W.source.length-1;R>=0&&-1!=Q.indexOf(W.source[R]);R--);return P.$factory(W.source.slice(0,R+1))}function D(W){return!o.isinstance(W,[P,G])}n.to_bytes=function(W){var Q;if(o.isinstance(W,[P,G]))Q=W.source;else{var A=n.$getattr(W,"tobytes",null);if(null===A)throw o.TypeError.$factory("object doesn't support the buffer protocol");Q=n.$call(A)().source}return Q};var G={__class__:o.type,__mro__:[o.object],$buffer_protocol:!0,$infos:{__module__:"builtins",__name__:"bytearray"},$is_class:!0};["__delitem__","clear","copy","count","index","pop","remove","reverse","sort"].forEach(function(W){var Q;G[W]=(Q=W,function(A){for(var R=[A.source],X=1,he=1,z=arguments.length;he<z;he++)R[X++]=arguments[he];return o.list[Q].apply(null,R)})});var M=n.make_iterator_class("bytearray_iterator");G.__iter__=function(W){return M.$factory(W.source)},G.__mro__=[o.object],G.__repr__=G.__str__=function(W){return"bytearray("+P.__repr__(W)+")"},G.__setitem__=function(W,Q,A){if(o.isinstance(Q,o.int)){if(!o.isinstance(A,o.int))throw o.TypeError.$factory("an integer is required");if(A>255)throw o.ValueError.$factory("byte must be in range(0, 256)");var R=Q;if(Q<0&&(R=W.source.length+R),!(R>=0&&R<W.source.length))throw o.IndexError.$factory("list index out of range");W.source[R]=A}else{if(!o.isinstance(Q,o.slice))throw o.TypeError.$factory("list indices must be integer, not "+n.class_name(Q));var X=Q.start===o.None?0:Q.start,he=Q.stop===o.None?W.source.length:Q.stop;X<0&&(X=W.source.length+X),he<0&&(he=W.source.length+he),W.source.splice(X,he-X);try{for(var z=o.list.$factory(A),Le=z.length-1;Le>=0;Le--){if(!o.isinstance(z[Le],o.int))throw o.TypeError.$factory("an integer is required");if(z[Le]>255)throw ValueError.$factory("byte must be in range(0, 256)");W.source.splice(X,0,z[Le])}}catch{throw o.TypeError.$factory("can only assign an iterable")}}},G.append=function(W,Q){if(2!=arguments.length)throw o.TypeError.$factory("append takes exactly one argument ("+(arguments.length-1)+" given)");if(!o.isinstance(Q,o.int))throw o.TypeError.$factory("an integer is required");if(Q>255)throw ValueError.$factory("byte must be in range(0, 256)");W.source[W.source.length]=Q},G.extend=function(W,Q){if(Q.__class__===G||Q.__class__===P)return Q.source.forEach(function(R){W.source.push(R)}),o.None;for(var A=o.iter(Q);;)try{G.__add__(W,o.next(A))}catch(R){if(R===o.StopIteration)break;throw R}return o.None},G.insert=function(W,Q,A){if(3!=arguments.length)throw o.TypeError.$factory("insert takes exactly 2 arguments ("+(arguments.length-1)+" given)");if(!o.isinstance(A,o.int))throw o.TypeError.$factory("an integer is required");if(A>255)throw ValueError.$factory("byte must be in range(0, 256)");o.list.insert(W.source,Q,A)},G.$factory=function(){for(var W=[G],Q=0,A=arguments.length;Q<A;Q++)W.push(arguments[Q]);return G.__new__.apply(null,W)};var P={__class__:o.type,__mro__:[o.object],$buffer_protocol:!0,$infos:{__module__:"builtins",__name__:"bytes"},$is_class:!0,__add__:function(W,Q){if(o.isinstance(Q,P))return W.__class__.$factory(W.source.concat(Q.source));if(o.isinstance(Q,G))return W.__class__.$factory(P.__add__(W,P.$factory(Q)));if(o.isinstance(Q,o.memoryview))return W.__class__.$factory(P.__add__(W,o.memoryview.tobytes(Q)));throw o.TypeError.$factory("can't concat bytes to "+o.str.$factory(Q))},__contains__:function(W,Q){if("number"==typeof Q)return W.source.indexOf(Q)>-1;if(W.source.length<Q.source.length)return!1;for(var A=Q.source.length,R=0;R<W.source.length-Q.source.length+1;R++){for(var X=!0,he=0;he<A;he++)if(Q.source[R+he]!=W.source[he]){X=!1;break}if(X)return!0}return!1}},fe=n.make_iterator_class("bytes_iterator");function ye(W,Q,A){throw o.UnicodeEncodeError.$factory("'"+W+"' codec can't encode character "+o.hex(Q)+" in position "+A)}function ne(W){var Q=W.toLowerCase();return"windows"==Q.substr(0,7)&&(Q="cp"+Q.substr(7)),(Q.startsWith("cp")||Q.startsWith("iso"))&&(Q=Q.replace("-","")),Q.replace(/-/g,"_")}P.__iter__=function(W){return fe.$factory(W.source)},P.__eq__=function(W,Q){return!D(Q)&&n.$getattr(W.source,"__eq__")(Q.source)},P.__ge__=function(W,Q){return D(Q)?o.NotImplemented:o.list.__ge__(W.source,Q.source)},P.__getitem__=function(W,Q){if(o.isinstance(Q,o.int)){var A=Q;if(Q<0&&(A=W.source.length+A),A>=0&&A<W.source.length)return W.source[A];throw o.IndexError.$factory("index out of range")}if(o.isinstance(Q,o.slice)){var R=o.slice.$conv_for_seq(Q,W.source.length),X=R.start,he=R.stop,z=R.step,Le=[],K=null;if(A=0,z>0){if((he=Math.min(he,W.source.length))<=X)return P.$factory([]);for(K=X;K<he;K+=z)Le[A++]=W.source[K]}else{if(he>=X)return P.$factory([]);for(he=Math.max(0,he),K=X;K>=he;K+=z)Le[A++]=W.source[K]}return P.$factory(Le)}if(o.isinstance(Q,o.bool))return W.source.__getitem__(o.int.$factory(Q))},P.__gt__=function(W,Q){return D(Q)?o.NotImplemented:o.list.__gt__(W.source,Q.source)},P.__hash__=function(W){if(void 0===W)return P.__hashvalue__||n.$py_next_hash--;for(var Q=1,A=0,R=W.source.length;A<R;A++)Q=101*Q+W.source[A]&4294967295;return Q},P.__init__=function(){return o.None},P.__le__=function(W,Q){return D(Q)?o.NotImplemented:o.list.__le__(W.source,Q.source)},P.__len__=function(W){return W.source.length},P.__lt__=function(W,Q){return D(Q)?o.NotImplemented:o.list.__lt__(W.source,Q.source)},P.__mod__=function(W,Q){var A=ue(W,"ascii","strict"),R=o.str.__mod__(A,Q);return o.str.encode(R,"ascii")},P.__mul__=function(){for(var W=n.args("__mul__",2,{self:null,other:null},["self","other"],arguments,{},null,null),Q=n.PyNumber_Index(W.other),A=[],R=W.self.source,X=R.length,he=0;he<Q;he++)for(var z=0;z<X;z++)A.push(R[z]);var Le=P.$factory();return Le.source=A,Le},P.__ne__=function(W,Q){return!P.__eq__(W,Q)},P.__new__=function(W,Q,A,R){var X=n.args("__new__",4,{cls:null,source:null,encoding:null,errors:null},["cls","source","encoding","errors"],arguments,{source:[],encoding:"utf-8",errors:"strict"},null,null);return P.$new(X.cls,X.source,X.encoding,X.errors)},P.$new=function(W,Q,A,R){var X={__class__:W},he=[],z=0;if(void 0!==Q)if("number"==typeof Q||o.isinstance(Q,o.int))for(var Le=Q;Le--;)he[z++]=0;else if("string"==typeof Q||o.isinstance(Q,o.str)){if(void 0===A)throw o.TypeError.$factory("string argument without an encoding");he=me(Q,A||"utf-8",R||"strict")}else for(he=o.list.$factory(Q),Le=0;Le<he.length;Le++){try{var K=o.int.$factory(he[Le])}catch{throw o.TypeError.$factory("'"+n.class_name(he[Le])+"' object cannot be interpreted as an integer")}if(K<0||K>255)throw o.ValueError.$factory("bytes must be in range(0, 256)")}return X.source=he,X.encoding=A,X.errors=R,X},P.__repr__=P.__str__=function(W){for(var Q="",A=0,R=W.source.length;A<R;A++){var X=W.source[A];if(10==X)Q+="\\n";else if(X<32||X>=128){var he=X.toString(16);Q+="\\x"+(he=(1==he.length?"0":"")+he)}else Q+=92==X?"\\\\":String.fromCharCode(X)}return Q.indexOf("'")>-1&&-1==Q.indexOf('"')?'b"'+Q+'"':"b'"+Q.replace(new RegExp("'","g"),"\\'")+"'"},P.__reduce_ex__=function(W){return P.__repr__(W)},P.capitalize=function(W){var Q=W.source,A=Q.length,R=Q.slice();R[0]>96&&R[0]<123&&(R[0]-=32);for(var X=1;X<A;++X)R[X]>64&&R[X]<91&&(R[X]+=32);return P.$factory(R)},P.center=function(){var W=n.args("center",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null),Q=W.width-W.self.source.length;if(Q<=0)return P.$factory(W.self.source);var A=P.ljust(W.self,W.self.source.length+Math.floor(Q/2),W.fillbyte);return P.rjust(A,W.width,W.fillbyte)},P.count=function(){var W=n.args("count",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),Q=0,A=-1,R=0;if("number"==typeof W.sub){if(W.sub<0||W.sub>255)throw o.ValueError.$factory("byte must be in range(0, 256)");R=1}else{if(!W.sub.__class__||!W.sub.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(W.sub)+"'");R=W.sub.source.length}do{-1!=(A=P.find(W.self,W.sub,Math.max(A+R,W.start),W.end))&&Q++}while(-1!=A);return Q},P.decode=function(W,Q,A){var R=n.args("decode",3,{self:null,encoding:null,errors:null},["self","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);switch(R.errors){case"strict":case"ignore":case"replace":case"surrogateescape":case"surrogatepass":case"xmlcharrefreplace":case"backslashreplace":return ue(R.self,R.encoding,R.errors)}},P.endswith=function(){var W=n.args("endswith",4,{self:null,suffix:null,start:null,end:null},["self","suffix","start","end"],arguments,{start:-1,end:-1},null,null);if(o.isinstance(W.suffix,P)){for(var Q=-1==W.start?W.self.source.length-W.suffix.source.length:Math.min(W.self.source.length-W.suffix.source.length,W.start),A=-1==W.end?-1==W.start?W.self.source.length:Q+W.suffix.source.length:Math.min(W.self.source.length-1,W.end),R=!0,X=W.suffix.source.length-1,he=W.suffix.source.length;X>=0&&R;--X)R=W.self.source[A-he+X]==W.suffix.source[X];return R}if(o.isinstance(W.suffix,o.tuple)){for(X=0;X<W.suffix.length;++X){if(!o.isinstance(W.suffix[X],P))throw o.TypeError.$factory("endswith first arg must be bytes or a tuple of bytes, not "+n.class_name(W.suffix));if(P.endswith(W.self,W.suffix[X],W.start,W.end))return!0}return!1}throw o.TypeError.$factory("endswith first arg must be bytes or a tuple of bytes, not "+n.class_name(W.suffix))},P.expandtabs=function(){var W=n.args("expandtabs",2,{self:null,tabsize:null},["self","tabsize"],arguments,{tabsize:8},null,null),Q=[];for(let R=0;R<W.tabsize;++R)Q.push(32);var A=W.self.source.slice();for(let R=0;R<A.length;++R)9===A[R]&&A.splice.apply(A,[R,1].concat(Q));return o.bytes.$factory(A)},P.find=function(W,Q){if(2!=arguments.length)var A=n.args("find",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),R=(Q=A.sub,A.start),X=A.end;else R=0,X=-1;if("number"==typeof Q){if(Q<0||Q>255)throw o.ValueError.$factory("byte must be in range(0, 256)");return W.source.slice(0,-1==X?void 0:X).indexOf(Q,R)}if(!Q.__class__||!Q.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(Q)+"'");X=-1==X?W.source.length:Math.min(W.source.length,X);for(var he=Q.source.length,z=R;z<=X-he;z++){for(var Le=W.source.slice(z,z+he),K=!0,be=0;be<he;be++)if(Le[be]!=Q.source[be]){K=!1;break}if(K)return z}return-1},P.fromhex=function(){for(var W=n.args("fromhex",2,{cls:null,string:null},["cls","string"],arguments,{},null,null),Q=W.string.replace(/\s/g,""),A=[],R=0;R<Q.length;R+=2){if(R+2>Q.length)throw o.ValueError.$factory("non-hexadecimal number found in fromhex() arg");A.push(o.int.$factory(Q.substr(R,2),16))}return W.cls.$factory(A)},P.hex=function(){for(var W=n.args("hex",1,{self:null},["self"],arguments,{},null,null).self,Q="",A=0,R=W.source.length;A<R;A++){var X=W.source[A].toString(16);X.length<2&&(X="0"+X),Q+=X}return Q},P.index=function(){var W=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),Q=P.find(W.self,W.sub,W.start,W.end);if(-1==Q)throw o.ValueError.$factory("subsection not found");return Q},P.isalnum=function(W){for(var Q=W.source,A=Q.length,R=A>0,X=0;X<A&&R;++X)R=Q[X]>96&&Q[X]<123||Q[X]>64&&Q[X]<91||Q[X]>47&&Q[X]<58;return R},P.isalpha=function(W){for(var Q=W.source,A=Q.length,R=A>0,X=0;X<A&&R;++X)R=Q[X]>96&&Q[X]<123||Q[X]>64&&Q[X]<91;return R},P.isdigit=function(W){var Q=W.source,A=Q.length,R=A>0;for(let X=0;X<A&&R;++X)R=Q[X]>47&&Q[X]<58;return R},P.islower=function(W){var Q=W.source,A=Q.length,R=!1;for(let X=0;X<A;++X)if(R=R||Q[X]>96&&Q[X]<123,Q[X]>64&&Q[X]<91)return!1;return R},P.isspace=function(W){var Q=W.source,A=Q.length;for(let R=0;R<A;++R)switch(Q[R]){case 9:case 10:case 11:case 12:case 13:case 32:break;default:return!1}return!0},P.isupper=function(W){var Q=W.source,A=Q.length,R=!1;for(let X=0;X<A;++X)if(R=R||Q[X]>64&&Q[X]<91,Q[X]>96&&Q[X]<123)return!1;return R},P.istitle=function(W){for(var Q=W.source,A=Q.length,R=!1,X=!1,he=!1,z=!1,Le=0;Le<A;++Le){if(he=Q[Le]>64&&Q[Le]<91,(R=(z=Q[Le]>96&&Q[Le]<123)||he)&&X&&he||!X&&z)return!1;X=R}return!0},P.join=function(){for(var W=n.args("join",2,{self:null,iterable:null},["self","iterable"],arguments,{}),Q=W.self,R=n.$getattr(o.iter(W.iterable),"__next__"),X=Q.__class__.$factory(),he=!0;;)try{var z=R();he?he=!1:X=P.__add__(X,Q),X=P.__add__(X,z)}catch(Le){if(o.isinstance(Le,o.StopIteration))break;throw Le}return X},P.lower=function(W){for(var Q,A=[],R=0,X=0,he=W.source.length;X<he;X++)W.source[X]&&(A[R++]=(Q=W.source[X])>=65&&Q<=90?Q+32:Q);return P.$factory(A)},P.ljust=function(){var W=n.args("ljust",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null);if(!W.fillbyte.__class__||!W.fillbyte.__class__.$buffer_protocol)throw o.TypeError.$factory("argument 2 must be a byte string of length 1, not '"+n.class_name(W.fillbyte)+"'");for(var Q=[],A=W.width-W.self.source.length,R=0;R<A;++R)Q.push(W.fillbyte.source[0]);return P.$factory(W.self.source.concat(Q))},P.lstrip=function(W,Q){return B(W,Q,"l")},P.maketrans=function(W,Q){for(var A=[],R=(Q=n.to_bytes(Q),0);R<256;R++)A[R]=R;R=0;for(var X=W.source.length;R<X;R++)A[W.source[R]]=Q[R];return P.$factory(A)},P.partition=function(){var W=n.args("partition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(!W.sep.__class__||!W.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(W.sep)+"'");var Q=W.sep.source.length,A=W.self.source,R=P.find(W.self,W.sep);return o.tuple.$factory([P.$factory(A.slice(0,R)),P.$factory(A.slice(R,R+Q)),P.$factory(A.slice(R+Q))])},P.removeprefix=function(){var W=n.args("removeprefix",2,{self:null,prefix:null},["self","prefix"],arguments,{},null,null);if(!o.isinstance(W.prefix,[P,G]))throw o.ValueError.$factory(`prefix should be bytes, not '${n.class_name(W.prefix)}'`);return P.startswith(W.self,W.prefix)?P.__getitem__(W.self,o.slice.$factory(W.prefix.source.length,o.None)):P.__getitem__(W.self,o.slice.$factory(0,o.None))},P.removesuffix=function(){var W=n.args("removesuffix",2,{self:null,prefix:null},["self","suffix"],arguments,{},null,null);if(!o.isinstance(W.suffix,[P,G]))throw o.ValueError.$factory(`suffix should be bytes, not '${n.class_name(W.suffix)}'`);return P.endswith(W.self,W.suffix)?P.__getitem__(W.self,o.slice.$factory(0,W.suffix.source.length+1)):P.__getitem__(W.self,o.slice.$factory(0,o.None))},P.replace=function(){var W=n.args("replace",4,{self:null,old:null,new:null,count:null},["self","old","new","count"],arguments,{count:-1},null,null),Q=[],A=W.self,R=A.source,X=R.length,he=W.old,z=W.new,Le=W.count>=0?W.count:R.length;if(!W.old.__class__)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(W.old)+"'");if(!W.old.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(W.sep)+"'");if(!W.new.__class__)throw o.TypeError.$factory("second argument must be a bytes-like object, not '"+n.class_name(W.old)+"'");if(!W.new.__class__.$buffer_protocol)throw o.TypeError.$factory("second argument must be a bytes-like object, not '"+n.class_name(W.sep)+"'");for(var K=0;K<X;K++)if(P.startswith(A,he,K)&&Le){for(var be=0;be<z.source.length;be++)Q.push(z.source[be]);K+=he.source.length-1,Le--}else Q.push(R[K]);return P.$factory(Q)},P.rfind=function(W,Q){if(2==arguments.length&&Q.__class__===P)var A=Q,R=0,X=-1;else{var he=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null);W=he.self,A=he.sub,R=he.start,X=he.end}if("number"==typeof A){if(A<0||A>255)throw o.ValueError.$factory("byte must be in range(0, 256)");return he.self.source.slice(R,-1==he.end?void 0:he.end).lastIndexOf(A)+R}if(!A.__class__)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(he.sub)+"'");if(!A.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(A)+"'");X=-1==X?W.source.length:Math.min(W.source.length,X);for(var z=A.source.length,Le=X-z;Le>=R;--Le){for(var K=W.source.slice(Le,Le+z),be=!0,Ne=0;Ne<z;Ne++)if(K[Ne]!=A.source[Ne]){be=!1;break}if(be)return Le}return-1},P.rindex=function(){var W=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),Q=P.rfind(W.self,W.sub,W.start,W.end);if(-1==Q)throw o.ValueError.$factory("subsection not found");return Q},P.rjust=function(){var W=n.args("rjust",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null);if(!W.fillbyte.__class__||!W.fillbyte.__class__.$buffer_protocol)throw o.TypeError.$factory("argument 2 must be a byte string of length 1, not '"+n.class_name(W.fillbyte)+"'");for(var Q=[],A=W.width-W.self.source.length,R=0;R<A;++R)Q.push(W.fillbyte.source[0]);return P.$factory(Q.concat(W.self.source))},P.rpartition=function(){var W=n.args("rpartition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(!W.sep.__class__||!W.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(W.sep)+"'");var Q=W.sep.source.length,A=W.self.source,R=P.rfind(W.self,W.sep);return o.tuple.$factory([P.$factory(A.slice(0,R)),P.$factory(A.slice(R,R+Q)),P.$factory(A.slice(R+Q))])},P.rstrip=function(W,Q){return B(W,Q,"r")},P.split=function(){var W=n.args("split",2,{self:null,sep:null},["self","sep"],arguments,{},null,null),Q=[],A=0,R=0;if(!W.sep.__class__||!W.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(W.sep)+"'");for(var X=W.sep.source,he=X.length,z=W.self.source,Le=z.length;R<Le;){for(var K=!0,be=0;be<he&&K;be++)z[R+be]!=X[be]&&(K=!1);K?(Q.push(P.$factory(z.slice(A,R))),R=A=R+he):R++}return(K||R>A)&&Q.push(P.$factory(z.slice(A,R))),Q},P.splitlines=function(W){var Q=n.args("splitlines",2,{self:null,keepends:null},["self","keepends"],arguments,{keepends:!1},null,null);if(!o.isinstance(Q.keepends,[o.bool,o.int]))throw o.TypeError("integer argument expected, got "+n.get_class(Q.keepends).__name);var A=o.int.$factory(Q.keepends),R=[],X=Q.self.source,he=0,z=0;if(!X.length)return R;for(;z<X.length;)z<X.length-1&&13==X[z]&&10==X[z+1]?(R.push(P.$factory(X.slice(he,A?z+2:z))),he=z+=2):13==X[z]||10==X[z]?(R.push(P.$factory(X.slice(he,A?z+1:z))),he=z+=1):z++;return he<X.length&&R.push(P.$factory(X.slice(he))),R},P.startswith=function(){var W=n.args("startswith",3,{self:null,prefix:null,start:null},["self","prefix","start"],arguments,{start:0},null,null),Q=W.start;if(o.isinstance(W.prefix,P)){for(var A=!0,R=0;R<W.prefix.source.length&&A;R++)A=W.self.source[Q+R]==W.prefix.source[R];return A}if(o.isinstance(W.prefix,o.tuple)){var X=[];for(R=0;R<W.prefix.length;R++){if(!o.isinstance(W.prefix[R],P))throw o.TypeError.$factory("startswith first arg must be bytes or a tuple of bytes, not "+n.class_name(W.prefix));X=X.concat(W.prefix[R].source)}var he=P.$factory(X);return P.startswith(W.self,he,Q)}throw o.TypeError.$factory("startswith first arg must be bytes or a tuple of bytes, not "+n.class_name(W.prefix))},P.strip=function(W,Q){var A=P.lstrip(W,Q);return P.rstrip(A,Q)},P.swapcase=function(W){for(var Q=W.source,A=Q.length,R=Q.slice(),X=0;X<A;++X)R[X]>96&&R[X]<123?R[X]-=32:R[X]>64&&R[X]<91&&(R[X]+=32);return P.$factory(R)},P.title=function(W){var Q=W.source,A=Q.length;buffer=Q.slice(),current_char_is_letter=!1,prev_char_was_letter=!1,is_uppercase=!1,is_lowercase=!1;for(var R=0;R<A;++R)is_lowercase=buffer[R]>96&&buffer[R]<123,is_uppercase=buffer[R]>64&&buffer[R]<91,current_char_is_letter=is_lowercase||is_uppercase,current_char_is_letter&&(prev_char_was_letter&&is_uppercase?buffer[R]+=32:!prev_char_was_letter&&is_lowercase&&(buffer[R]-=32)),prev_char_was_letter=current_char_is_letter;return P.$factory(buffer)},P.translate=function(W,Q,A){if(void 0===A)A=[];else{if(!o.isinstance(A,P))throw o.TypeError.$factory("Type "+n.get_class(A).__name+" doesn't support the buffer API");A=A.source}var R=[],X=0;if(o.isinstance(Q,P)&&256==Q.source.length)for(var he=0,z=W.source.length;he<z;he++)A.indexOf(W.source[he])>-1||(R[X++]=Q.source[W.source[he]]);return P.$factory(R)},P.upper=function(W){for(var Q,A=[],R=0,X=0,he=W.source.length;X<he;X++)W.source[X]&&(A[R++]=(Q=W.source[X])>=97&&Q<=122?Q-32:Q);return P.$factory(A)},P.zfill=function(W,Q){for(var A=W.source.slice(),R=43==A[0]||45==A[0]?1:0,X=Q-W.source.length,he=[],z=0;z<X;++z)he.push(48);return A.splice.apply(A,[R,0].concat(he)),P.$factory(A)};var ue=n.decode=function(W,Q,A){var R="",X=W.source,he=ne(Q),z=!1;switch(he){case"utf_8":case"utf-8":case"utf8":case"U8":case"UTF":var Le,K=0;for(R="";K<X.length;){var be=X[K];if(Le=null,128&be)if(be>>5==6)if(void 0===X[K+1]?Le=[be,K,"end"]:128!=(192&X[K+1])&&(Le=[be,K,"continuation"]),null!==Le){if("ignore"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Le[0].toString(16)+"  in position "+Le[1]+("end"==Le[2]?": unexpected end of data":": invalid continuation byte"));K++}else{var Ne=31&be;Ne<<=6,Ne+=63&X[K+1],R+=String.fromCodePoint(Ne),K+=2}else if(be>>4==14)if(void 0===X[K+1]?Le=[be,K,"end",K+1]:128!=(192&X[K+1])?Le=[be,K,"continuation",K+2]:void 0===X[K+2]?Le=[be,K+"-"+(K+1),"end",K+2]:128!=(192&X[K+2])&&(Le=[be,K,"continuation",K+3]),null!==Le)if("ignore"==A)K=Le[3];else{if("surrogateescape"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Le[0].toString(16)+"  in position "+Le[1]+("end"==Le[2]?": unexpected end of data":": invalid continuation byte"));for(var je=K;je<Le[3];je++)R+=String.fromCodePoint(56448+X[je]-128);K=Le[3]}else Ne=15&be,Ne<<=12,Ne+=(63&X[K+1])<<6,Ne+=63&X[K+2],R+=String.fromCodePoint(Ne),K+=3;else if(be>>3==30)if(z=!0,void 0===X[K+1]?Le=[be,K,"end",K+1]:128!=(192&X[K+1])?Le=[be,K,"continuation",K+2]:void 0===X[K+2]?Le=[be,K+"-"+(K+1),"end",K+2]:128!=(192&X[K+2])?Le=[be,K,"continuation",K+3]:void 0===X[K+3]?Le=[be,K+"-"+(K+1)+"-"+(K+2),"end",K+3]:128!=(192&X[K+2])&&(Le=[be,K,"continuation",K+3]),null!==Le)if("ignore"==A)K=Le[3];else{if("surrogateescape"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Le[0].toString(16)+"  in position "+Le[1]+("end"==Le[2]?": unexpected end of data":": invalid continuation byte"));for(je=K;je<Le[3];je++)R+=String.fromCodePoint(56448+X[je]-128);K=Le[3]}else Ne=15&be,Ne<<=18,Ne+=(63&X[K+1])<<12,Ne+=(63&X[K+2])<<6,Ne+=63&X[K+3],R+=String.fromCodePoint(Ne),K+=4;else if("ignore"==A)K++;else{if("surrogateescape"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+be.toString(16)+" in position "+K+": invalid start byte");R+=String.fromCodePoint(56448+X[K]-128),K++}else R+=String.fromCodePoint(be),K++}return z?o.str.$surrogate.$factory(R):R;case"latin_1":case"windows1252":case"iso-8859-1":case"iso8859-1":case"8859":case"cp819":case"latin":case"latin1":case"L1":X.forEach(function(Ke){R+=String.fromCharCode(Ke)});break;case"unicode_escape":return W.__class__!==P&&W.__class__!==G||(W=ue(W,"latin-1","strict")),W.replace(/\\n/g,"\n").replace(/\\a/g,"\x07").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\t/g,"\t").replace(/\\'/g,"'").replace(/\\"/g,'"');case"raw_unicode_escape":return W.__class__!==P&&W.__class__!==G||(W=ue(W,"latin-1","strict")),W.replace(/\\u([a-fA-F0-9]{4})/g,function(Ke){var vt=parseInt(Ke.substr(2),16);return String.fromCharCode(vt)});case"ascii":je=0;for(var Te=X.length;je<Te;je++)if((Ne=X[je])<=127)R+=String.fromCharCode(Ne);else if("ignore"!=A){var qe="'ascii' codec can't decode byte 0x"+Ne.toString(16)+" in position "+je+": ordinal not in range(128)";throw o.UnicodeDecodeError.$factory(qe)}break;default:try{!function(Ke){if(void 0===x[Ke]){var vt=o.__import__("encodings."+Ke);vt[Ke].getregentry&&(x[Ke]=n.$getattr(vt[Ke].getregentry(),"decode"))}}(he)}catch(Ke){throw console.log(X,Q,"error load_decoder",Ke),o.LookupError.$factory("unknown encoding: "+he)}return x[he](W)[0]}return R},me=n.encode=function(){var W=n.args("encode",3,{s:null,encoding:null,errors:null},["s","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null),Q=W.s,A=W.encoding,R=W.errors,X=[],he=0,z=ne(A);switch(z){case"utf-8":case"utf_8":case"utf8":for(var Le=[],K=0,be=Q.length;K<be;K++)(Ne=Q.charCodeAt(K))<127?Le.push(Ne):Ne<2047?Le.push(192+(Ne>>6),128+(63&Ne)):Ne<65535?Le.push(224+(Ne>>12),128+((4095&Ne)>>6),128+(63&Ne)):console.log("4 bytes");return Le;case"latin":case"latin1":case"latin-1":case"latin_1":case"L1":case"iso8859_1":case"iso_8859_1":case"8859":case"cp819":case"windows1252":for(K=0,be=Q.length;K<be;K++)(Ne=Q.charCodeAt(K))<=255?X[he++]=Ne:"ignore"!=R&&ye(A,K);break;case"ascii":for(K=0,be=Q.length;K<be;K++)(Ne=Q.charCodeAt(K))<=127?X[he++]=Ne:"ignore"!=R&&ye(A,K);break;case"raw_unicode_escape":for(K=0,be=Q.length;K<be;K++){var Ne;if((Ne=Q.charCodeAt(K))<256)X[he++]=Ne;else{var je=Ne.toString(16);je.length%2&&(je="0"+je),je="\\u"+je;for(var Te=0;Te<je.length;Te++)X[he++]=je.charCodeAt(Te)}}break;default:try{!function(qe){if(void 0===l[qe]){var Ke=o.__import__("encodings."+qe);Ke[qe].getregentry&&(l[qe]=n.$getattr(Ke[qe].getregentry(),"encode"))}}(z)}catch{throw o.LookupError.$factory("unknown encoding: "+A)}X=l[z](Q)[0].source}return X};for(var ie in P.$factory=function(W,Q,A){var R=n.args("bytes",3,{source:null,encoding:null,errors:null},["source","encoding","errors"],arguments,{source:[],encoding:"utf-8",errors:"strict"},null,null);return P.$new(P,R.source,R.encoding,R.errors)},P.__class__=o.type,P.$is_class=!0,P)void 0===G[ie]&&"function"==typeof P[ie]&&(G[ie]=function(W){return function(){return P[W].apply(null,arguments)}}(ie));n.set_func_names(P,"builtins"),P.fromhex=o.classmethod.$factory(P.fromhex),n.set_func_names(G,"builtins"),G.fromhex=o.classmethod.$factory(G.fromhex),o.bytes=P,o.bytearray=G}(__BRYTHON__),function($B){var _b_=$B.builtins,object=_b_.object,$N=_b_.None;function create_type(n){return $B.get_class(n).$factory()}function clone(n){var o=create_type(n);for(key in o.$items=n.$items.slice(),n.$hashes)o.$hashes[key]=n.$hashes[key];return o}var set={__class__:_b_.type,$infos:{__module__:"builtins",__name__:"set"},$is_class:!0,$native:!0,__add__:function(n,o){throw _b_.TypeError.$factory("unsupported operand type(s) for +: 'set' and "+typeof o)},__and__:function(n,o,l){try{$test(l,o)}catch{return _b_.NotImplemented}for(var x=create_type(n),B=0,D=n.$items.length;B<D;B++)_b_.getattr(o,"__contains__")(n.$items[B])&&set.add(x,n.$items[B]);return x},__class_getitem__:function(n,o){return Array.isArray(o)||(o=[o]),$B.GenericAlias.$factory(n,o)},__contains__:function(n,o){if(n.$simple){if("number"==typeof o||o instanceof Number){if(isNaN(o)){for(var l=n.$items.length-1;l>=0;l--)if(isNaN(n.$items[l]))return!0;return!1}return o instanceof Number?n.$numbers.indexOf(o.valueOf())>-1:n.$items.indexOf(o)>-1}if("string"==typeof o)return n.$items.indexOf(o)>-1}_b_.isinstance(o,set)||$B.$getattr(o,"__hash__");var x=_b_.hash(o);if(n.$hashes[x]){l=0;for(var B=n.$hashes[x].length;l<B;l++)if($B.rich_comp("__eq__",n.$hashes[x][l],o))return!0}return!1},__eq__:function(n,o){if(void 0===o)return n===set;if(_b_.isinstance(o,[_b_.set,_b_.frozenset])){if(o.$items.length==n.$items.length){for(var l=0,x=n.$items.length;l<x;l++)if(!1===set.__contains__(n,o.$items[l]))return!1;return!0}return!1}return _b_.NotImplemented},__format__:function(n,o){return set.__str__(n)},__ge__:function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__le__(o,n):_b_.NotImplemented},__gt__:function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__lt__(o,n):_b_.NotImplemented}};set.__hash__=_b_.None,set.__init__=function(n,o,l){if(void 0===l&&Array.isArray(o)){for(var x=0,B=o.length;x<B;x++)$add(n,o[x]);return $N}var D=$B.args("__init__",2,{self:null,iterable:null},["self","iterable"],arguments,{iterable:[]},null,null);if(n=D.self,_b_.isinstance(o=D.iterable,[set,frozenset])){for(var G in n.$items=o.$items.slice(),n.$hashes={},o.$hashes)n.$hashes[G]=o.$hashes[G];return $N}for(var M=$B.$iter(o);;)try{$add(n,_b_.next(M))}catch(P){if(_b_.isinstance(P,_b_.StopIteration))break;throw P}return $N};var set_iterator=$B.make_iterator_class("set iterator");function $test(n,o,l){if(void 0===n&&!_b_.isinstance(o,[set,frozenset]))throw _b_.TypeError.$factory("unsupported operand type(s) for "+l+": 'set' and '"+$B.class_name(o)+"'")}function $add(n,o){var x=!1;if(("string"==typeof o||"number"==typeof o||o instanceof Number)&&(x=!0),x){var B=n.$items.indexOf(o);if(-1==B){if(!(o instanceof Number&&n.$numbers.indexOf(o.valueOf())>-1||"number"==typeof o&&n.$numbers.indexOf(o)>-1)){n.$items.push(o);var D=o.valueOf();"number"==typeof D&&n.$numbers.push(D)}}else o!==n.$items[B]&&n.$items.push(o)}else{var G=_b_.hash(o);if(void 0===(M=n.$hashes[G]))n.$hashes[G]=[o],n.$items.push(o);else{for(var M,P=0,fe=(M=n.$hashes[G]).length;P<fe;P++)if($B.rich_comp("__eq__",o,M[P]))return $N;n.$hashes[G].push(o),n.$items.push(o)}}return $N}set.__iter__=function(n){return n.$items.sort(),set_iterator.$factory(n.$items)},set.__le__=function(n,o){if(_b_.isinstance(o,[set,frozenset])){for(var l=_b_.getattr(o,"__contains__"),x=0,B=n.$items.length;x<B;x++)if(!l(n.$items[x]))return!1;return!0}return _b_.NotImplemented},set.__len__=function(n){return n.$items.length},set.__lt__=function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__le__(n,o)&&set.__len__(n)<_b_.getattr(o,"__len__")():_b_.NotImplemented},set.__mro__=[_b_.object],set.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("set.__new__(): not enough arguments");return{__class__:n,$simple:!0,$items:[],$numbers:[],$hashes:{}}},set.__or__=function(n,o,l){for(var x=clone(n),B=_b_.getattr($B.$iter(o),"__next__");;)try{set.add(x,B())}catch(D){if(_b_.isinstance(D,_b_.StopIteration))break;throw D}return x.__class__=n.__class__,x},set.__rand__=function(n,o){return set.__and__(n,o)},set.__reduce__=function(n){return _b_.tuple.$factory([n.__class__,_b_.tuple.$factory([n.$items]),$N])},set.__reduce_ex__=function(n,o){return set.__reduce__(n)},set.__rsub__=function(n,o){return set.__sub__(n,o)},set.__rxor__=function(n,o){return set.__xor__(n,o)},set.__str__=set.__repr__=function(n){var o=$B.class_name(n);if(0===n.$items.length)return o+"()";var l=o+"({",x="})";"set({"==l&&(l="{",x="}");var B=[];if($B.repr.enter(n))return o+"(...)";n.$items.sort();for(var D=0,G=n.$items.length;D<G;D++){var M=_b_.repr(n.$items[D]);B.push(M===n||M===n.$items[D]?"{...}":M)}return B=B.join(", "),$B.repr.leave(n),l+B+x},set.__sub__=function(n,o,l){try{$test(l,o,"-")}catch{return _b_.NotImplemented}for(var x=create_type(n),B=_b_.getattr(o,"__contains__"),D=[],G=0,M=n.$items.length;G<M;G++)B(n.$items[G])||D.push(n.$items[G]);return set.__init__.call(null,x,D),x},set.__xor__=function(n,o,l){try{$test(l,o,"^")}catch{return _b_.NotImplemented}for(var x=create_type(n),B=_b_.getattr(o,"__contains__"),D=0,G=n.$items.length;D<G;D++)B(n.$items[D])||set.add(x,n.$items[D]);for(D=0,G=o.$items.length;D<G;D++)set.__contains__(n,o.$items[D])||set.add(x,o.$items[D]);return x},$B.make_rmethods(set),set.add=function(){var n=$B.args("add",2,{self:null,item:null},["self","item"],arguments,{},null,null);return $add(n.self,n.item)},set.clear=function(){var n=$B.args("clear",1,{self:null},["self"],arguments,{},null,null);return n.self.$items=[],n.self.$hashes={},$N},set.copy=function(){var n=$B.args("copy",1,{self:null},["self"],arguments,{},null,null);if(_b_.isinstance(n.self,frozenset))return n.self;var o=set.$factory();for(key in n.self.$items.forEach(function(l){o.$items.push(l)}),n.self.$numbers.forEach(function(l){o.$numbers.push(l)}),self.$hashes)o.$hashes[key]=self.$hashes[key];return o},set.difference_update=function(n){for(var o=$B.args("difference_update",1,{self:null},["self"],arguments,{},"args",null),l=0;l<o.args.length;l++)for(var x,B=set.$factory(o.args[l]),D=_b_.getattr($B.$iter(B),"__next__");;)try{var G=typeof(x=D());if("string"==G||"number"==G){var M=n.$items.indexOf(x);M>-1&&n.$items.splice(M,1)}else for(var P=0;P<n.$items.length;P++)if($B.rich_comp("__eq__",n.$items[P],x)){n.$items.splice(P,1);var fe=_b_.hash(x);if(n.$hashes[fe])for(var ye=0;ye<n.$hashes[fe].length;ye++)if($B.rich_comp("__eq__",n.$hashes[fe][ye],x)){n.$hashes[fe].splice(ye,1);break}}}catch(ne){if(_b_.isinstance(ne,_b_.StopIteration))break;throw ne}return $N},set.discard=function(){var n=$B.args("discard",2,{self:null,item:null},["self","item"],arguments,{},null,null);try{set.remove(n.self,n.item)}catch(o){if(!_b_.isinstance(o,[_b_.KeyError,_b_.LookupError]))throw o}return $N},set.intersection_update=function(){for(var n=$B.args("intersection_update",1,{self:null},["self"],arguments,{},"args",null),o=n.self,l=0;l<n.args.length;l++){for(var x=[],B=set.$factory(n.args[l]),D=0;D<o.$items.length;D++){var G=o.$items[D],M=typeof G;if("string"==M||"number"==M)-1==B.$items.indexOf(G)&&x.push(D);else{var P=!1,fe=_b_.hash(G);if(B.$hashes[fe]){for(var ye=B.$hashes[fe],ne=0;!P&&ne<ye.length;ne++)$B.rich_comp("__eq__",ye[ne],G)&&(P=!0);if(!P)for(x.push(D),ye=o.$hashes[fe],ne=0;!P&&ne<ye.length;ne++)$B.rich_comp("__eq__",ye[ne],G)&&o.$hashes.splice(ne,1)}}}for(x.sort(function(ue,me){return ue-me}).reverse(),D=0;D<x.length;D++)o.$items.splice(x[D],1)}return $N},set.isdisjoint=function(){for(var n=$B.args("is_disjoint",2,{self:null,other:null},["self","other"],arguments,{},null,null),o=0,l=n.self.$items.length;o<l;o++)if(_b_.getattr(n.other,"__contains__")(n.self.$items[o]))return!1;return!0},set.pop=function(n){if(0===n.$items.length)throw _b_.KeyError.$factory("pop from an empty set");var o=n.$items.pop();if("string"!=typeof o&&"number"!=typeof o)for(var l=_b_.hash(o),x=n.$hashes[l],B=0;B<x.length;B++)if($B.rich_comp("__eq__",x[B],o)){n.$hashes[l].splice(B,1);break}return o},set.remove=function(n,o){var l=$B.args("remove",2,{self:null,item:null},["self","item"],arguments,{},null,null);if(n=l.self,_b_.isinstance(o=l.item,set)||_b_.hash(o),"string"==typeof o||"number"==typeof o){var x=n.$items.indexOf(o);if(-1==x)throw _b_.KeyError.$factory(o);return n.$items.splice(x,1),"number"==typeof o&&n.$numbers.splice(n.$numbers.indexOf(o),1),$N}var B=_b_.hash(o);if(n.$hashes[B]){for(var D=0,G=n.$items.length;D<G;D++)if($B.rich_comp("__eq__",n.$items[D],o)){n.$items.splice(D,1),o instanceof Number&&n.$numbers.splice(n.$numbers.indexOf(o.valueOf()),1);break}for(D=0,G=n.$hashes[B].length;D<G;D++)if($B.rich_comp("__eq__",n.$hashes[B][D],o)){n.$hashes[B].splice(D,1);break}return $N}throw _b_.KeyError.$factory(o)},set.symmetric_difference_update=function(n,o){for(var l,x=$B.args("symmetric_difference_update",2,{self:null,s:null},["self","s"],arguments,{},null,null),B=(n=x.self,_b_.getattr($B.$iter(o=x.s),"__next__")),D=[],G=[];;)try{var M=typeof(l=B());if("string"==M||"number"==M){var P=n.$items.indexOf(l);P>-1?D.push(P):G.push(l)}else{for(var fe=!1,ye=0;!fe&&ye<n.$items.length;ye++)$B.rich_comp("__eq__",n.$items[ye],l)&&(D.push(ye),fe=!0);fe||G.push(l)}}catch(ue){if(_b_.isinstance(ue,_b_.StopIteration))break;throw ue}D.sort(function(ue,me){return ue-me}).reverse();for(var ne=0;ne<D.length;ne++)D[ne]!=D[ne-1]&&n.$items.splice(D[ne],1);for(ne=0;ne<G.length;ne++)set.add(n,G[ne]);return $N},set.update=function(n){for(var o=$B.args("update",1,{self:null},["self"],arguments,{},"args",null),l=0;l<o.args.length;l++)for(var x=set.$factory(o.args[l]),B=0,D=x.$items.length;B<D;B++)$add(n,x.$items[B]);return $N},set.difference=function(){var n=$B.args("difference",1,{self:null},["self"],arguments,{},"args",null);if(0==n.args.length)return set.copy(n.self);for(var o=clone(n.self),l=0;l<n.args.length;l++)o=set.__sub__(o,set.$factory(n.args[l]),!0);return o};var fc=set.difference+"";function $accept_only_set(n,o){return function(l,x,B){return $test(B,x,o),n(l,x),l}}eval("set.intersection = "+fc.replace(/difference/g,"intersection").replace("__sub__","__and__")),eval("set.symmetric_difference = "+fc.replace(/difference/g,"symmetric_difference").replace("__sub__","__xor__")),eval("set.union = "+fc.replace(/difference/g,"union").replace("__sub__","__or__")),set.issubset=function(){for(var n=$B.args("issubset",2,{self:null,other:null},["self","other"],arguments,{},"args",null),o=_b_.getattr(n.other,"__contains__"),l=0,x=n.self.$items.length;l<x;l++)if(!o(n.self.$items[l]))return!1;return!0},set.issuperset=function(){for(var n=$B.args("issuperset",2,{self:null,other:null},["self","other"],arguments,{},"args",null),o=_b_.getattr(n.self,"__contains__"),l=$B.$iter(n.other);;)try{if(!o(_b_.next(l)))return!1}catch(x){if(_b_.isinstance(x,_b_.StopIteration))return!0;throw x}return!0},set.__iand__=$accept_only_set(set.intersection_update,"&="),set.__isub__=$accept_only_set(set.difference_update,"-="),set.__ixor__=$accept_only_set(set.symmetric_difference_update,"^="),set.__ior__=$accept_only_set(set.update,"|="),set.$factory=function(){var n={__class__:set,$simple:!0,$items:[],$numbers:[],$hashes:{}},o=[n].concat(Array.prototype.slice.call(arguments));return set.__init__.apply(null,o),n},$B.set_func_names(set,"builtins"),set.__class_getitem__=_b_.classmethod.$factory(set.__class_getitem__);var frozenset={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"frozenset"},$is_class:!0,$native:!0};for(var attr in set)switch(attr){case"add":case"clear":case"discard":case"pop":case"remove":case"update":break;default:null==frozenset[attr]&&(frozenset[attr]="function"==typeof set[attr]?function(n){return function(){return set[n].apply(null,arguments)}}(attr):set[attr])}frozenset.__hash__=function(n){if(void 0===n)return frozenset.__hashvalue__||$B.$py_next_hash--;if(void 0!==n.__hashvalue__)return n.__hashvalue__;var o=1927868237;o*=n.$items.length;for(var l=0,x=n.$items.length;l<x;l++){var B=_b_.hash(n.$items[l]);o^=3644798167*(89869747^B^B<<16)}return-1==(o=69069*o+907133923)&&(o=590923713),n.__hashvalue__=o},frozenset.__init__=function(){return $N},frozenset.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("frozenset.__new__(): not enough arguments");return{__class__:n,$simple:!0,$items:[],$numbers:[],$hashes:{}}};var singleton_id=Math.floor(Math.random()*Math.pow(2,40));function empty_frozenset(){var n=frozenset.__new__(frozenset);return n.$id=singleton_id,n}frozenset.$factory=function(){var n=$B.args("frozenset",1,{iterable:null},["iterable"],arguments,{iterable:null},null,null);if(null===n.iterable)return empty_frozenset();if(n.iterable.__class__==frozenset)return n.iterable;var o=set.$factory(n.iterable);return 0==o.$items.length?empty_frozenset():(o.__class__=frozenset,o)},$B.set_func_names(frozenset,"builtins"),_b_.set=set,_b_.frozenset=frozenset}(__BRYTHON__),function($B){var _b_=$B.builtins,object=_b_.object,_window=self;function to_simple(n){switch(typeof n){case"string":case"number":return n;case"boolean":return n?"true":"false";case"object":if(n===_b_.None)return"null";if(n instanceof Number)return n.valueOf();default:throw console.log("erreur",n),_b_.TypeError.$factory("keys must be str, int, float, bool or None, not "+$B.class_name(n))}}$B.pyobj2structuredclone=function(n,o){if(o=void 0===o||o,"boolean"==typeof n||"number"==typeof n||"string"==typeof n)return n;if(n instanceof Number)return n.valueOf();if(n===_b_.None)return null;if(Array.isArray(n)||n.__class__===_b_.list||n.__class__===_b_.tuple){for(var l=[],x=0,B=n.length;x<B;x++)l.push($B.pyobj2structuredclone(n[x]));return l}if(_b_.isinstance(n,_b_.dict)){if(o&&(Object.keys(n.$numeric_dict).length>0||Object.keys(n.$object_dict).length>0))throw _b_.TypeError.$factory("a dictionary with non-string keys does not support structured clone");var D=$B.dict_to_list(n);for(l={},x=0,B=D.length;x<B;x++)l[to_simple(D[x][0])]=$B.pyobj2structuredclone(D[x][1]);return l}return n},$B.structuredclone2pyobj=function(n){if(null===n)return _b_.None;if(void 0===n)return $B.Undefined;if("boolean"==typeof n||"number"==typeof n||"string"==typeof n)return n;if(n instanceof Number)return n.valueOf();if(Array.isArray(n)||n.__class__===_b_.list||n.__class__===_b_.tuple){for(var o=_b_.list.$factory(),l=0,x=n.length;l<x;l++)o.push($B.structuredclone2pyobj(n[l]));return o}if("object"==typeof n){for(var B in o=$B.empty_dict(),n)_b_.dict.$setitem(o,B,$B.structuredclone2pyobj(n[B]));return o}throw console.log(n,Array.isArray(n),n.__class__,_b_.list,n.__class__===_b_.list),_b_.TypeError.$factory(_b_.str.$factory(n)+" does not support the structured clone algorithm")};var JSConstructor={__class__:_b_.type,__mro__:[object],$infos:{__module__:"<javascript>",__name__:"JSConstructor"},$is_class:!0,__call__:function(n){return function(){for(var o=[null],l=0,x=arguments.length;l<x;l++)o.push(pyobj2jsobj(arguments[l]));var B=new(n.func.bind.apply(n.func,o));return $B.$JS2Py(B)}},__getattribute__:function(n,o){return"__call__"==o?function(){for(var l=[null],x=0,B=arguments.length;x<B;x++)l.push(pyobj2jsobj(arguments[x]));var D=new(n.func.bind.apply(n.func,l));return $B.$JS2Py(D)}:JSObject.__getattribute__(n,o)},$factory:function(n){return{__class__:JSConstructor,js:n,func:n.js_func}}},jsobj2pyobj=$B.jsobj2pyobj=function(n){switch(n){case!0:case!1:return n}return void 0===n?$B.Undefined:null===n?_b_.None:Array.isArray(n)?_b_.list.$factory(n.map(jsobj2pyobj)):"number"==typeof n?-1==n.toString().indexOf(".")?_b_.int.$factory(n):_b_.float.$factory(n):"kw"===n.$nat?n:$B.$isNode(n)?$B.DOMNode.$factory(n):$B.JSObj.$factory(n)},pyobj2jsobj=$B.pyobj2jsobj=function(n){if(!0===n||!1===n)return n;if(n===_b_.None)return null;if(n!==$B.Undefined){var o=$B.get_class(n);if(void 0===o)return n;if(o===JSConstructor)return void 0!==n.js_func?n.js_func:n.js;if(o===$B.DOMNode||o.__mro__.indexOf($B.DOMNode)>-1)return n;if([_b_.list,_b_.tuple].indexOf(o)>-1){var l=[];return n.forEach(function(B){l.push(pyobj2jsobj(B))}),l}if(o===_b_.dict||_b_.issubclass(o,_b_.dict)){var x={};return _b_.list.$factory(_b_.dict.items(n)).forEach(function(B){"function"==typeof B[1]&&B[1].bind(x),x[B[0]]=pyobj2jsobj(B[1])}),x}return o===_b_.float?n.valueOf():o===$B.Function||o===$B.method?function(){try{for(var B=[],D=0;D<arguments.length;D++)B.push(void 0===arguments[D]?_b_.None:jsobj2pyobj(arguments[D]));return pyobj2jsobj(n.apply(this,B))}catch(G){throw console.log(G),console.log($B.$getattr(G,"info")),console.log($B.class_name(G)+":",G.args.length>0?G.args[0]:""),G}}:n}};function pyargs2jsargs(n){for(var o=[],l=0,x=n.length;l<x;l++){var B=n[l];if(null!=B&&void 0!==B.$nat){var D=B.kw;if(Array.isArray(D)&&(D=$B.extend(js_attr.name,...D)),Object.keys(D).length>0)throw _b_.TypeError.$factory("A Javascript function can't take keyword arguments")}else o.push($B.pyobj2jsobj(B))}return o}$B.JSConstructor=JSConstructor,$B.JSObj=$B.make_class("JSObj",function(n){if(!Array.isArray(n))if("function"==typeof n)n.$is_js_func=!0;else if("number"==typeof n&&!Number.isInteger(n))return new Number(n);return n}),$B.JSObj.__sub__=function(n,o){if("bigint"==typeof n&&"bigint"==typeof o)return n-o;throw _b_.TypeError.$factory("unsupported operand type(s) for - : '"+$B.class_name(n)+"' and '"+$B.class_name(o)+"'")};var ops={"+":"__add__","*":"__mul__","**":"__pow__","%":"__mod__"};for(var op in ops)eval("$B.JSObj."+ops[op]+" = "+($B.JSObj.__sub__+"").replace(/-/g,op));$B.JSObj.__eq__=function(n,o){if("object"==typeof n){if(Object.keys(n).length!==Object.keys(o).length)return!1;for(var l in n)if(!$B.JSObj.__eq__(n[l],o[l]))return!1}return n===o},$B.JSObj.__ne__=function(n,o){return!$B.JSObj.__eq__(n,o)},$B.JSObj.__getattribute__=function(n,o){if("$$new"==o&&"function"==typeof n)return n.$js_func?function(){var G=pyargs2jsargs(arguments);return $B.JSObj.$factory(new n.$js_func(...G))}:function(){var G=pyargs2jsargs(arguments);return $B.JSObj.$factory(new n(...G))};"string"==typeof o&&(o=$B.from_alias(o));var l=n[o];if(null==l&&"function"==typeof n&&n.$js_func&&(l=n.$js_func[o]),void 0===l){if("function"==typeof n.getNamedItem&&void 0!==(D=n.getNamedItem(o)))return $B.JSObj.$factory(D);var x=$B.get_class(n);if(x&&x[o]){var B=x[o];return"function"==typeof B?function(){for(var G=[n],M=0,P=arguments.length;M<P;M++)G.push(arguments[M]);return $B.JSObj.$factory(B.apply(null,G))}:B}if("bind"==o&&"function"==typeof n.addEventListener)return function(G,M){return n.addEventListener(G,M)};throw _b_.AttributeError.$factory(o)}if("function"==typeof l){var D=function(){var G=pyargs2jsargs(arguments),M=n.$js_func||n;try{var P=l.apply(M,G)}catch(fe){throw console.log("error",fe),console.log("attribute",o,"of self",n,l,G,arguments),fe}return void 0===P?$B.Undefined:null===P?_b_.None:$B.JSObj.$factory(P)};return D.prototype=l.prototype,D.$js_func=l,D.__mro__=[_b_.object],D.$infos={__name__:l.name,__qualname__:l.name},$B.frames_stack.length>0&&(D.$infos.__module__=$B.last($B.frames_stack)[3].__name__),$B.JSObj.$factory(D)}return $B.JSObj.$factory(l)},$B.JSObj.__setattr__=function(n,o,l){return"string"==typeof o&&(o=$B.from_alias(o)),n[o]=$B.pyobj2structuredclone(l),_b_.None},$B.JSObj.__getitem__=function(n,o){if("string"==typeof o)return $B.JSObj.__getattribute__(n,o);if("number"==typeof o){if(void 0!==n[o])return $B.JSObj.$factory(n[o]);if("number"==typeof n.length&&("number"==typeof o||"boolean"==typeof o)&&"function"==typeof n.item){var l=_b_.int.$factory(o);l<0&&(l+=n.length);var x=n.item(l);if(null===x)throw _b_.IndexError.$factory(l);return $B.JSObj.$factory(x)}}throw _b_.KeyError.$factory(l)},$B.JSObj.__setitem__=$B.JSObj.__setattr__;var JSObj_iterator=$B.make_iterator_class("JS object iterator");$B.JSObj.__iter__=function(n){var o=[];if(_window.Symbol&&void 0!==n[Symbol.iterator]){if(o=[],void 0!==n.next)for(;;){var l=n.next();if(l.done)break;o.push($B.JSObj.$factory(l.value))}else if(void 0!==n.length&&void 0!==n.item)for(var x=0;x<n.length;x++)o.push($B.JSObj.$factory(n.item(x)));return JSObj_iterator.$factory(o)}if(void 0!==n.length&&void 0!==n.item){for(x=0;x<n.length;x++)o.push($B.JSObj.$factory(n.js.item(x)));return JSObj_iterator.$factory(o)}var B=$B.JSObj.to_dict(n);return _b_.dict.__iter__(B)},$B.JSObj.__len__=function(n){if("number"==typeof n.length)return n.length;throw _b_.AttributeError.$factory(n+" has no attribute __len__")},$B.JSObj.__repr__=$B.JSObj.__str__=function(n){return"<Javascript "+n.constructor.name+" object: "+n.toString()+">"},$B.JSObj.bind=function(n,o,l){return n.addEventListener(o,function(x){return l(jsobj2pyobj(x))}),_b_.None},$B.JSObj.to_dict=function(n){return $B.structuredclone2pyobj(n)},$B.set_func_names($B.JSObj,"builtins"),$B.JSMeta=$B.make_class("JSMeta"),$B.JSMeta.__call__=function(n){for(var o=[],l=1,x=arguments.length;l<x;l++)o.push(arguments[l]);return new n.__mro__[0].$js_func(...o)},$B.JSMeta.__mro__=[_b_.type,_b_.object],$B.JSMeta.__getattribute__=function(n,o){return void 0!==n[o]?n[o]:void 0!==$B.JSMeta[o]?$B.JSMeta[o]:_b_.type.__getattribute__(n,o)},$B.JSMeta.__init_subclass__=function(){},$B.set_func_names($B.JSMeta,"builtins")}(__BRYTHON__),function(n){n.stdlib={};for(var o=["VFS_import","__future__","_abcoll","_codecs","_collections","_collections_abc","_compat_pickle","_contextvars","_csv","_dummy_thread","_frozen_importlib","_functools","_imp","_io","_markupbase","_operator","_py_abc","_pydecimal","_queue","_random","_socket","_sre","_struct","_sysconfigdata","_sysconfigdata_0_brython_","_testcapi","_thread","_threading_local","_weakref","_weakrefset","abc","antigravity","argparse","atexit","base64","bdb","binascii","bisect","browser.aio","browser.ajax","browser.highlight","browser.html","browser.indexed_db","browser.local_storage","browser.markdown","browser.object_storage","browser.session_storage","browser.svg","browser.template","browser.timer","browser.webcomponent","browser.websocket","browser.webworker","browser.worker","calendar","cmath","cmd","code","codecs","codeop","colorsys","configparser","contextlib","contextvars","copy","copyreg","csv","dataclasses","datetime","decimal","difflib","doctest","enum","errno","external_import","faulthandler","fnmatch","formatter","fractions","functools","gc","genericpath","getopt","gettext","glob","heapq","hmac","imp","inspect","interpreter","io","ipaddress","itertools","json","keyword","linecache","locale","mimetypes","nntplib","ntpath","numbers","opcode","operator","optparse","os","pathlib","pdb","pickle","pkgutil","platform","posixpath","pprint","profile","pwd","py_compile","pydoc","queue","quopri","re","reprlib","select","selectors","shlex","shutil","signal","site","site-packages.__future__","site-packages.docs","site-packages.header","site-packages.test","site-packages.test_sp","socket","sre_compile","sre_constants","sre_parse","stat","string","stringprep","struct","subprocess","sys","sysconfig","tarfile","tb","tempfile","test.namespace_pkgs.module_and_namespace_package.a_test","textwrap","this","threading","time","timeit","token","tokenize","traceback","turtle","types","typing","uu","uuid","warnings","weakref","webbrowser","zipfile","zipimport","zlib"],l=0;l<o.length;l++)n.stdlib[o[l]]=["py"];var x=["_aio","_ajax","_base64","_binascii","_io_classes","_json","_jsre","_locale","_multiprocessing","_posixsubprocess","_profile","_sre_utils","_string","_strptime","_svg","_warnings","_webcomponent","_webworker","_zlib_utils","aes","array","builtins","dis","hashlib","hmac-md5","hmac-ripemd160","hmac-sha1","hmac-sha224","hmac-sha256","hmac-sha3","hmac-sha384","hmac-sha512","long_int","marshal","math","math1","md5","modulefinder","pbkdf2","posix","rabbit","rabbit-legacy","random","rc4","ripemd160","sha1","sha224","sha256","sha3","sha384","sha512","tripledes","unicodedata"];for(l=0;l<x.length;l++)n.stdlib[x[l]]=["js"];var B=["browser.widgets","collections","concurrent","concurrent.futures","email","email.mime","encodings","html","http","importlib","logging","multiprocessing","multiprocessing.dummy","pydoc_data","site-packages.foobar","site-packages.simpleaio","site-packages.simpy","site-packages.simpy.resources","site-packages.ui","test","test.encoded_modules","test.leakers","test.namespace_pkgs.not_a_namespace_pkg.foo","test.support","test.test_email","test.test_importlib","test.test_importlib.builtin","test.test_importlib.extension","test.test_importlib.frozen","test.test_importlib.import_","test.test_importlib.source","test.test_json","test.tracedmodules","unittest","unittest.test","unittest.test.testmock","urllib"];for(l=0;l<B.length;l++)n.stdlib[B[l]]=["py",!0]}(__BRYTHON__),function($B){var _b_=$B.builtins,_window=self,module=$B.module={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"module"},$is_class:!0};function parent_package(n){var o=n.split(".");return o.pop(),o.join(".")}function $download_module(n,o,l){var x=new XMLHttpRequest,B="?v="+(new Date).getTime(),D=null,G=n.__name__,M=_window.setTimeout(function(){x.abort()},5e3);if(x.open("GET",$B.$options.cache?o:o+B,!1),x.send(),$B.$CORS?D=200==x.status||0==x.status?x.responseText:_b_.ModuleNotFoundError.$factory("No module named '"+G+"'"):4==x.readyState&&(200==x.status?(D=x.responseText,n.$last_modified=x.getResponseHeader("Last-Modified")):(console.info("Error "+x.status+" means that Python module "+G+" was not found at url "+o),D=_b_.ModuleNotFoundError.$factory("No module named '"+G+"'"))),_window.clearTimeout(M),null==D)throw _b_.ModuleNotFoundError.$factory("No module named '"+G+"' (res is null)");if(D.constructor===Error)throw D;return D}function import_js(n,o){try{var l=$download_module(n,o,void 0)}catch{return null}return run_js(l,o,n),!0}function run_js(n,o,l){try{var x=new Function(n+";\nreturn $module")();$B.$options.store&&(l.$js=n)}catch(D){throw console.log(D),console.log(o,l),D}for(var B in x.__name__=l.__name__,x)"function"==typeof x[B]&&(x[B].$infos={__module__:l.__name__,__name__:B,__qualname__:B});if(void 0!==l){for(var B in x)l[B]=x[B];(x=l).__class__=module}else x.__class__=module,x.__name__=l.__name__,x.__repr__=x.__str__=function(){return $B.builtin_module_names.indexOf(l.name)>-1?"<module '"+l.__name__+"' (built-in)>":"<module '"+l.__name__+"' from "+o+" >"},"builtins"!=l.name&&(x.__file__=o);return $B.imported[l.__name__]=x,!0}function show_ns(){for(var kk=Object.keys(_window),i=0,len=kk.length;i<len;i++)console.log(kk[i]),"$"==kk[i].charAt(0)&&console.log(eval(kk[i]));console.log("---")}function import_py(n,o,l){var x=n.__name__,B=$download_module(n,o,l);if(n.$src=B,$B.imported[x].$is_package=n.$is_package,$B.imported[x].$last_modified=n.$last_modified,"/__init__.py"==o.substr(o.length-12))$B.imported[x].__package__=x,$B.imported[x].__path__=o,$B.imported[x].$is_package=n.$is_package=!0;else if(l)$B.imported[x].__package__=l;else{var D=x.split(".");D.pop(),$B.imported[x].__package__=D.join(".")}return $B.imported[x].__file__=o,run_py(B,o,n)}function run_py(module_contents,path,module,compiled){$B.file_cache[path]=module_contents;var root,js,mod_name=module.__name__;if(!compiled){var $Node=$B.$Node,$NodeJSCtx=$B.$NodeJSCtx;$B.$py_module_path[module.__name__]=path;var src={src:module_contents,has_annotations:!1};root=$B.py2js(src,module,module.__name__,$B.builtins_scope),void 0!==module.__package__&&(root.binding.__package__=!0)}try{js=compiled?module_contents:root.to_js(),10==$B.$options.debug&&(console.log("code for module "+module.__name__),console.log(js));var src=js;js="var $module = (function(){\n"+js+"return $locals_"+module.__name__.replace(/\./g,"_")+"})(__BRYTHON__)\nreturn $module";var module_id="$locals_"+module.__name__.replace(/\./g,"_"),$module=new Function(module_id,js)(module)}catch(n){for(var attr in console.log(n+" for module "+module.__name__),console.log("module",module),console.log(root),$B.debug>1&&console.log(js),n)console.log(attr,n[attr]);throw console.log(_b_.getattr(n,"info","[no info]")),console.log("message: "+n.$message),console.log("filename: "+n.fileName),console.log("linenum: "+n.lineNumber),$B.debug>0&&console.log("line info "+$B.line_info),n}finally{$B.clear_ns(module.__name__)}try{var mod=eval("$module");for(var attr in mod)module[attr]=mod[attr];return module.__initializing__=!1,$B.imported[module.__name__]=module,{content:src,name:mod_name,imports:Object.keys(root.imports).join(",")}}catch(n){for(var attr in console.log(n+"  for module "+module.__name__),n)console.log(attr+" "+n[attr]);throw $B.debug>0&&console.log("line info "+__BRYTHON__.line_info),n}}function new_spec(n){return n.__class__=module,n}module.__init__=function(){},module.__new__=function(n,o,l,x){return{__class__:n,__name__:o,__doc__:l||_b_.None,__package__:x||_b_.None}},module.__repr__=module.__str__=function(n){var o="<module "+n.__name__;return void 0===n.__file__&&(o+=" (built-in)"),o+">"},module.__setattr__=function(n,o,l){"__builtins__"==n.__name__?$B.builtins[o]=l:n[o]=l},module.$factory=function(n,o,l){return{__class__:module,__name__:n,__doc__:o||_b_.None,__package__:l||_b_.None}},$B.set_func_names(module,"builtins"),$B.$download_module=$download_module,$B.run_py=run_py;var finder_VFS={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"VFSFinder"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=o.__spec__.loader_state.stored,x=o.__spec__.loader_state.timestamp;delete o.__spec__.loader_state;var B=l[0],D=l[1];o.$is_package=l[3]||!1;var G="VFS."+o.__name__;if(o.__file__=G+=o.$is_package?"/__init__.py":B,$B.file_cache[o.__file__]=$B.VFS[o.__name__][1],".js"==B)run_js(D,o.__path__,o);else{if($B.precompiled.hasOwnProperty(o.__name__)){$B.debug>1&&console.info("load",o.__name__,"from precompiled");for(var M=o.__name__.split("."),P=0;P<M.length;P++){var fe=M.slice(0,P+1).join(".");if(!$B.imported.hasOwnProperty(fe)||!$B.imported[fe].__initialized__){var ye=$B.precompiled[fe],ne=o.$is_package;Array.isArray(ye)&&(ye=ye[0]);var ue=$B.imported[fe]=module.$factory(fe,void 0,ne);ue.__initialized__=!0,ne?(ue.__path__="<stdlib>",ue.__package__=fe):((R=fe.split(".")).pop(),ue.__package__=R.join(".")),ue.__file__=G;try{var me=fe.replace(/\./g,"_");ye+="return $locals_"+me;var ie=new Function("$locals_"+me,ye)(ue)}catch(he){if($B.debug>1){for(var W in console.log(he),he)console.log(W,he[W]);console.log(Object.keys($B.imported)),$B.debug>2&&console.log(o,"mod_js",ye)}throw he}for(var Q in ie)ue[Q]=ie[Q];ie.__file__=G,P>0&&$B.builtins.setattr($B.imported[M.slice(0,P).join(".")],M[P],ie)}}return ie}var A=o.__name__;$B.debug>1&&console.log("run Python code from VFS",A);var R,X=run_py(D,o.__path__,o);X.is_package=o.$is_package,X.timestamp=$B.timestamp,X.source_ts=x,$B.precompiled[A]=X.is_package?[X.content]:X.content,(R=A.split(".")).length>1&&R.pop(),$B.$options.indexedDB&&self.indexedDB&&$B.idb_name&&(indexedDB.open($B.idb_name).onsuccess=function(he){var z=he.target.result.transaction("modules","readwrite").objectStore("modules"),Le=(z.openCursor(),z.put(X));Le.onsuccess=function(){$B.debug>1&&console.info(o.__name__,"stored in db")},Le.onerror=function(){console.info("could not store "+o.__name__)}})}},find_module:function(n,o,l){return{__class__:Loader,load_module:function(x,B){var D=n.find_spec(n,x,B),G=module.$factory(x);$B.imported[x]=G,G.__spec__=D,n.exec_module(n,G)}}},find_spec:function(n,o,l,x){var B,D,G;return $B.use_VFS?void 0===(B=$B.VFS[o])?_b_.None:(D=B[3]||!1,G=B.timestamp,B?new_spec({name:o,loader:n,origin:$B.builtin_module_names.indexOf(o)>-1?"built-in":"brython_stdlib",submodule_search_locations:D?[]:_b_.None,loader_state:{stored:B,timestamp:G},cached:_b_.None,parent:D?o:parent_package(o),has_location:_b_.False}):void 0):_b_.None}};for(var method in $B.set_func_names(finder_VFS,"<import>"),finder_VFS)"function"==typeof finder_VFS[method]&&(finder_VFS[method]=_b_.classmethod.$factory(finder_VFS[method]));finder_VFS.$factory=function(){return{__class__:finder_VFS}};var finder_cpython={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"CPythonFinder"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){console.log("exec PYthon module",o);var l=o.__spec__.loader_state,x=l.content;delete o.__spec__.loader_state,o.$is_package=l.is_package,o.__file__=l.__file__,$B.file_cache[o.__file__]=x,$B.debug>1&&console.log("run Python code from CPython",o.__name__),run_py(x,o.__path__,o)},find_module:function(n,o,l){return{__class__:Loader,load_module:function(x,B){var D=n.find_spec(n,x,B),G=module.$factory(x);$B.imported[x]=G,G.__spec__=D,n.exec_module(n,G)}}},find_spec:function(n,o,l,x){console.log("finder cpython",o);var B,D=new XMLHttpRequest;return D.open("GET","/cpython_import?module="+o,!1),D.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var M=JSON.parse(this.responseText);B=new_spec({name:o,loader:n,origin:"CPython",submodule_search_locations:M.is_package?[]:_b_.None,loader_state:{content:M.content},cached:_b_.None,parent:M.is_package?o:parent_package(o),has_location:_b_.False})}},D.send(),B}};for(var method in $B.set_func_names(finder_cpython,"<import>"),finder_cpython)"function"==typeof finder_cpython[method]&&(finder_cpython[method]=_b_.classmethod.$factory(finder_cpython[method]));finder_cpython.$factory=function(){return{__class__:finder_cpython}};var finder_stdlib_static={$factory:finder_stdlib_static,__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"StdlibStatic"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=o.__spec__.loader_state;o.$is_package=l.is_package,"py"==l.ext?import_py(o,l.path,o.__package__):import_js(o,l.path),delete o.__spec__.loader_state},find_module:function(n,o,l){var x=n.find_spec(n,o,l);return x===_b_.None?_b_.None:{__class__:Loader,load_module:function(B,D){var G=module.$factory(B);$B.imported[B]=G,G.__spec__=x,G.__package__=x.parent,n.exec_module(n,G)}}},find_spec:function(n,o,l,x){if($B.stdlib&&$B.$options.static_stdlib_import){var B=$B.stdlib[o];if(void 0===B){var D=o.split(".");if(D.length>1){D.pop();var G=$B.stdlib[D.join(".")];G&&G[1]&&(B=["py"])}}if(void 0!==B){var M=B[0],P=void 0!==B[1],fe={ext:M,is_package:P,path:(l=$B.brython_path+("py"==M?"Lib/":"libs/")+o.replace(/\./g,"/"))+(P?"/__init__.py":"py"==M?".py":".js"),address:B};return new_spec({name:o,loader:n,origin:fe.path,submodule_search_locations:P?[l]:_b_.None,loader_state:fe,cached:_b_.None,parent:P?o:parent_package(o),has_location:_b_.True})}}return _b_.None}};for(var method in $B.set_func_names(finder_stdlib_static,"<import>"),finder_stdlib_static)"function"==typeof finder_stdlib_static[method]&&(finder_stdlib_static[method]=_b_.classmethod.$factory(finder_stdlib_static[method]));finder_stdlib_static.$factory=function(){return{__class__:finder_stdlib_static}};var finder_path={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"ImporterPath"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=$B.$getattr(o,"__spec__"),x=l.loader_state.code;o.$is_package=l.loader_state.is_package,delete l.loader_state.code;var B=l.loader_state.type;"py"==B||"pyc.js"==B?run_py(x,l.origin,o,"pyc.js"==B):"js"==l.loader_state.type&&run_js(x,l.origin,o)},find_module:function(n,o,l){return finder_path.find_spec(n,o,l)},find_spec:function(n,o,l,x){var B=$B.last($B.frames_stack)[2];if($B.VFS&&$B.VFS[B])return _b_.None;$B.is_none(l)&&(l=$B.path);for(var D=0,G=l.length;D<G;++D){var M=l[D];"/"!=M[M.length-1]&&(M+="/");var P=$B.path_importer_cache[M];if(void 0===P){for(var fe=!0,ye=0,ne=$B.path_hooks.length;ye<ne&&fe;++ye){var ue=$B.path_hooks[ye].$factory;try{P=("function"==typeof ue?ue:$B.$getattr(ue,"__call__"))(M),fe=!1}catch(W){if(W.__class__!==_b_.ImportError)throw W}}fe&&($B.path_importer_cache[M]=_b_.None)}if(!$B.is_none(P)){var me=$B.$getattr(P,"find_spec"),ie=("function"==typeof me?me:$B.$getattr(me,"__call__"))(o,x);if(!$B.is_none(ie))return ie}}return _b_.None}};for(var method in $B.set_func_names(finder_path,"<import>"),finder_path)"function"==typeof finder_path[method]&&(finder_path[method]=_b_.classmethod.$factory(finder_path[method]));finder_path.$factory=function(){return{__class__:finder_path}};var url_hook={__class__:_b_.type,__mro__:[_b_.object],__repr__:function(n){return"<UrlPathFinder"+(n.hint?" for '"+n.hint+"'":"(unbound)")+" at "+n.path_entry+">"},$infos:{__module__:"builtins",__name__:"UrlPathFinder"},find_spec:function(n,o,l){var x={},B=!0,D=n.hint,G=n.path_entry+o.match(/[^.]+$/g)[0],M=[];(void 0===D||"py"==D)&&(M=M.concat([[G+".py","py",!1],[G+"/__init__.py","py",!0]]));for(var P=0;B&&P<M.length;++P)try{var fe=M[P];x.code=$download_module({__name__:o,$is_package:!1},fe[0],void 0),B=!1,x.type=fe[1],x.is_package=fe[2],void 0===D&&(n.hint=fe[1],$B.path_importer_cache[n.path_entry]=n),x.is_package&&($B.path_importer_cache[G+"/"]=url_hook.$factory(G+"/",n.hint)),x.path=fe[0]}catch{}return B?_b_.None:new_spec({name:o,loader:finder_path,origin:x.path,submodule_search_locations:x.is_package?[G]:_b_.None,loader_state:x,cached:_b_.None,parent:x.is_package?o:parent_package(o),has_location:_b_.True})},invalidate_caches:function(n){},$factory:function(n,o){return{__class__:url_hook,path_entry:n.endsWith("/")?n:n+"/",hint:o}}};$B.set_func_names(url_hook,"<import>"),$B.path_importer_cache={};for(var _sys_paths=[[$B.script_dir+"/","py"],[$B.brython_path+"Lib/","py"],[$B.brython_path+"Lib/site-packages/","py"],[$B.brython_path+"libs/","js"]],i=0;i<_sys_paths.length;++i){var _path=_sys_paths[i],_type=_path[1];_path=_path[0],$B.path_importer_cache[_path]=url_hook.$factory(_path,_type)}function import_error(n){var o=_b_.ImportError.$factory(n);throw o.name=n,o}function optimize_import_for_path(n,o){"/"!=n.slice(-1)&&(n+="/");var l="none"==o?_b_.None:url_hook.$factory(n,o);$B.path_importer_cache[n]=l}$B.$__import__=function(n,o,l,x,B){var D=!1;if(o.$jsobj&&o.$jsobj.__file__){var G=o.$jsobj.__file__;(G.startsWith($B.brython_path+"Lib/")&&!G.startsWith($B.brython_path+"Lib/site-packages/")||G.startsWith($B.brython_path+"libs/")||G.startsWith("VFS."))&&(D=!0)}var M=$B.imported[n],P=n.split("."),fe=x.length>0;if(M==_b_.None&&import_error(n),void 0===M){$B.is_none(x)&&(x=[]);for(var ye=0,ne="",ue="",me=P.length-1,ie=_b_.None;ye<=me;++ye){var W=ue;if(ue+=ne+P[ye],ne=".",(M=$B.imported[ue])==_b_.None)import_error(ue);else if(void 0===M){try{$B.import_hooks(ue,ie,D)}catch(A){throw delete $B.imported[ue],A}$B.is_none($B.imported[ue])?import_error(ue):W&&_b_.setattr($B.imported[W],P[ye],$B.imported[ue])}else $B.imported[W]&&void 0===$B.imported[W][P[ye]]&&_b_.setattr($B.imported[W],P[ye],$B.imported[ue]);if(ye<me)try{ie=$B.$getattr($B.imported[ue],"__path__")}catch{if(ye==me-1&&$B.imported[ue][P[me]]&&$B.imported[ue][P[me]].__class__===module)return $B.imported[ue][P[me]];if(!fe){var Q=_b_.ModuleNotFoundError.$factory();throw Q.msg="No module named '"+n+"'; '"+ue+"' is not a package",Q.args=$B.fast_tuple([Q.msg]),Q.name=n,Q.path=_b_.None,Q}import_error(n)}}}else if($B.imported[P[0]]&&2==P.length)try{void 0===$B.imported[P[0]][P[1]]&&$B.$setattr($B.imported[P[0]],P[1],M)}catch(A){throw console.log("error",P,M),A}return x.length>0?$B.imported[n]:$B.imported[P[0]]},$B.$import=function(n,o,l,x){o=void 0===o?[]:o,l=void 0===l?{}:l,x=void 0===x?{}:x;var B=n.split(".");"."==n[n.length-1]&&B.pop();for(var D=[],G=!0,M=0,P=B.length;M<P;M++){var fe=B[M];if(G&&""==fe){if(elt=D.pop(),void 0===elt)throw _b_.ImportError.$factory("Parent module '' not loaded, cannot perform relative import")}else G=!1,D.push("$$"==fe.substr(0,2)?fe.substr(2):fe)}n=D.join("."),10==$B.$options.debug&&(console.log("$import "+n),console.log("use VFS ? "+$B.use_VFS),console.log("use static stdlib paths ? "+$B.static_stdlib_import));var ye=$B.frames_stack[$B.frames_stack.length-1],ne=ye[3],ue=ne.__import__,me=$B.obj_dict(ne);void 0===ue&&(ue=$B.$__import__);var ie=("function"==typeof ue?ue:$B.$getattr(ue,"__call__"))(n,me,void 0,o,0);if(o&&0!=o.length){var W=o,Q={};if(o&&"*"==o[0]&&(W=$B.$getattr(ie,"__all__",Q))!==Q&&(l={}),W===Q)for(var A in ie)"_"!==A[0]&&(x[A]=ie[A]);else{M=0;for(var R=W.length;M<R;++M){var X=W[M],he=l[X]||X;try{x[he]=$B.$getattr(ie,X)}catch{try{var z=$B.from_alias(X);$B.$getattr(ue,"__call__")(n+"."+z,me,void 0,[],0),x[he]=$B.$getattr(ie,z)}catch(je){if("__future__"===n){var Le=$B.last($B.frames_stack),K=Le[3].$line_info.split(","),be=parseInt(K[0]);$B.$SyntaxError(Le[2],"future feature "+X+" is not defined",ye[3].src,void 0,be)}throw je.$py_error?(je.__class__!==_b_.ImportError&&je.__class__!==_b_.ModuleNotFoundError&&$B.handle_error(je),_b_.ImportError.$factory("cannot import name '"+X+"'")):($B.debug>1&&(console.log(je),console.log($B.last($B.frames_stack))),_b_.ImportError.$factory("cannot import name '"+X+"'"))}}}}return x}(he=l[n])?x[he]=$B.imported[n]:x[$B.to_alias(D[0])]=ie},$B.import_all=function(n,o){for(var l in o)(l.startsWith("$$")||-1=="_$".indexOf(l.charAt(0)))&&(n[l]=o[l])},$B.$path_hooks=[url_hook],$B.$meta_path=[finder_VFS,finder_stdlib_static,finder_path],$B.finders={VFS:finder_VFS,stdlib_static:finder_stdlib_static,path:finder_path,CPython:finder_cpython};var Loader={__class__:$B.$type,__mro__:[_b_.object],__name__:"Loader"},_importlib_module={__class__:module,__name__:"_importlib",Loader,VFSFinder:finder_VFS,StdlibStatic:finder_stdlib_static,ImporterPath:finder_path,UrlPathFinder:url_hook,optimize_import_for_path};_importlib_module.__repr__=_importlib_module.__str__=function(){return"<module '_importlib' (built-in)>"},$B.imported._importlib=_importlib_module}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);var object=_b_.object;function $err(n,o){var l="unsupported operand type(s) for "+n+": 'float' and '"+$B.class_name(o)+"'";throw _b_.TypeError.$factory(l)}function float_value(n){return void 0!==n.$brython_value?n.$brython_value:n}var float={__class__:_b_.type,__dir__:object.__dir__,$infos:{__module__:"builtins",__name__:"float"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&-1=="eEfFgGn%".indexOf(o.type))throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'float'");if(isNaN(n))return"f"==o.type||"g"==o.type?"nan":"NAN";if(n==Number.POSITIVE_INFINITY)return"f"==o.type||"g"==o.type?"inf":"INF";if(void 0===o.precision&&void 0!==o.type&&(o.precision=6),"%"==o.type&&(n*=100),"e"==o.type){var l=n.toExponential(o.precision),x=parseInt(l.substr(l.search("e")+1));return Math.abs(x)<10&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),l}if(void 0!==o.precision){var B=o.precision;if(0==B)return Math.round(n)+"";var D=(l=n.toFixed(B)).indexOf(".");if(void 0===o.type||"%"!=o.type&&"f"!=o.type.toLowerCase()){if(o.type&&"g"==o.type.toLowerCase()){var G=preformat(n,{type:"e"}).split("e"),M=(l=-4<=(x=parseInt(G[1]))&&x<o.precision?preformat(n,{type:"f",precision:o.precision-1-x}):preformat(n,{type:"e",precision:o.precision-1})).split("e");if(o.alternate)-1==M[0].search(/\./)&&(M[0]+=".");else if(M[1]){for(var P=M[0];P.endsWith("0");)P=P.substr(0,P.length-1);P.endsWith(".")&&(P=P.substr(0,P.length-1)),M[0]=P}return l=M.join("e"),"G"==o.type&&(l=l.toUpperCase()),l}if(void 0===o.type)o.type="g",l=preformat(n,o),o.type=void 0;else{var fe=n.toExponential(o.precision-1);if((x=parseInt(fe.substr(fe.search("e")+1)))<-4||x>=o.precision-1){for(var ye=fe.split("e");ye[0].endsWith("0");)ye[0]=ye[0].substr(0,ye[0].length-1);l=ye.join("e")}}}else if(-1==D)l+="."+"0".repeat(o.precision);else{var ne=o.precision-l.length+D+1;ne>0&&(l+="0".repeat(ne))}}else l=_b_.str.$factory(n);if(void 0===o.type||-1!="gGn".indexOf(o.type)){if(-1==l.search("e"))for(;"0"==l.charAt(l.length-1);)l=l.substr(0,l.length-1);"."==l.charAt(l.length-1)&&(void 0===o.type?l+="0":l=l.substr(0,l.length-1))}return void 0!==o.sign&&(" "==o.sign||"+"==o.sign)&&n>0&&(l=o.sign+l),"%"==o.type&&(l+="%"),l}float.numerator=function(n){return float_value(n)},float.denominator=function(n){return _b_.int.$factory(1)},float.imag=function(n){return _b_.int.$factory(0)},float.real=function(n){return float_value(n)},float.__float__=function(n){return float_value(n)},float.as_integer_ratio=function(n){if((n=float_value(n)).valueOf()==Number.POSITIVE_INFINITY||n.valueOf()==Number.NEGATIVE_INFINITY)throw _b_.OverflowError.$factory("Cannot pass infinity to float.as_integer_ratio.");if(!Number.isFinite(n.valueOf()))throw _b_.ValueError.$factory("Cannot pass NaN to float.as_integer_ratio.");for(var o=_b_.$frexp(n.valueOf()),l=o[0],x=o[1],B=0;B<300&&l!=Math.floor(l);B++)l*=2,x--;return numerator=float.$factory(l),py_exponent=abs(x),denominator=1,py_exponent=_b_.getattr(_b_.int.$factory(denominator),"__lshift__")(py_exponent),x>0?numerator*=py_exponent:denominator=py_exponent,_b_.tuple.$factory([_b_.int.$factory(numerator),_b_.int.$factory(denominator)])},float.__bool__=function(n){return n=float_value(n),_b_.bool.$factory(n.valueOf())},float.__eq__=function(n,o){return n=float_value(n),o=float_value(o),(!isNaN(n)||!isNaN(o))&&(isinstance(o,_b_.int)?n==o:isinstance(o,float)?n.valueOf()==o.valueOf():isinstance(o,_b_.complex)?0==o.$imag&&n==o.$real:_b_.NotImplemented)},float.__floordiv__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,[_b_.int,float])){if(0==o.valueOf())throw ZeroDivisionError.$factory("division by zero");return float.$factory(Math.floor(n/o))}if(hasattr(o,"__rfloordiv__"))return getattr(o,"__rfloordiv__")(n);$err("//",o)},float.fromhex=function(n){if(!isinstance(n,_b_.str))throw _b_.ValueError.$factory("argument must be a string");var o,l=n.trim();switch(l.toLowerCase()){case"+inf":case"inf":case"+infinity":case"infinity":return $FloatClass(1/0);case"-inf":case"-infinity":return $FloatClass(-1/0);case"+nan":case"nan":return $FloatClass(Number.NaN);case"-nan":return $FloatClass(-Number.NaN);case"":throw _b_.ValueError.$factory("could not convert string to float")}if(null!==(o=/^(\d*\.?\d*)$/.exec(l)))return $FloatClass(parseFloat(o[1]));if(null==(o=/^(\+|-)?(0x)?([0-9A-F]+\.?)?(\.[0-9A-F]+)?(p(\+|-)?\d+)?$/i.exec(l)))throw _b_.ValueError.$factory("invalid hexadecimal floating-point string");var x=o[1],B=parseInt(o[3]||"0",16),D=o[4]||".0",G=o[5]||"p0";x="-"==x?-1:1;for(var M=B,P=1,fe=D.length;P<fe;P++)M+=parseInt(D.charAt(P),16)/Math.pow(16,P);return new Number(x*M*Math.pow(2,parseInt(G.substring(1))))},float.__getformat__=function(n){if("double"==n||"float"==n)return"IEEE, little-endian";throw _b_.ValueError.$factory("__getformat__() argument 1 must be 'double' or 'float'")},float.__format__=function(n,o){n=float_value(n);var l=new $B.parse_format_spec(o);l.align=l.align||">";var x=preformat(n,l).split("."),B=x[0];if(l.comma){for(var D=B.length,G=Math.ceil(B.length/3),M=[],P=0;P<G;P++)M.push(B.substring(D-3*P-3,D-3*P));M.reverse(),x[0]=M.join(",")}return $B.format_width(x.join("."),l)},float.__hash__=function(n){if(void 0===n)return float.__hashvalue__||$B.$py_next_hash--;var o=n.valueOf();if(o===1/0)return 314159;if(o===-1/0)return-271828;if(isNaN(o))return 0;if(o==Math.round(o))return Math.round(o);var l=_b_.$frexp(o);l[0]*=Math.pow(2,31);var x=_b_.int.$factory(l[0]);return l[0]=(l[0]-x)*Math.pow(2,31),4294967295&x+_b_.int.$factory(l[0])+(l[1]<<15)},_b_.$isninf=function(n){var o=n;return isinstance(n,float)&&(o=n.valueOf()),o==-1/0||o==Number.NEGATIVE_INFINITY},_b_.$isinf=function(n){var o=n;return isinstance(n,float)&&(o=n.valueOf()),o==1/0||o==-1/0||o==Number.POSITIVE_INFINITY||o==Number.NEGATIVE_INFINITY},_b_.$fabs=function(n){return float.$factory(n>0?n:-n)},_b_.$frexp=function(n){var o=n;if(isinstance(n,float)&&(o=n.valueOf()),isNaN(o)||_b_.$isinf(o))return[o,-1];if(0==o)return[0,0];var l=1,x=0,B=o;for(B<0&&(l=-l,B=-B);B<.5;)B*=2,x--;for(;B>=1;)B*=.5,x++;return[B*=l,x]},_b_.$ldexp=function(n,o){if(_b_.$isninf(n))return float.$factory("-inf");if(_b_.$isinf(n))return float.$factory("inf");var l=n;if(isinstance(n,float)&&(l=n.valueOf()),0==l)return l;var x=o;return isinstance(o,float)&&(x=o.valueOf()),l*Math.pow(2,x)},float.hex=function(n){switch((n=float_value(n)).valueOf()){case 1/0:case-1/0:case Number.NaN:case-Number.NaN:return n;case-0:return"-0x0.0p0";case 0:return"0x0.0p0"}var o=_b_.$frexp(_b_.$fabs(n.valueOf())),l=o[0],x=o[1],B=1-Math.max(-1021-x,0);l=_b_.$ldexp(l,B),x-=B;var D="0123456789ABCDEF".split(""),G=D[Math.floor(l)];G+=".",l-=Math.floor(l);for(var M=0;M<13;M++)l*=16,G+=D[Math.floor(l)],l-=Math.floor(l);var P="+";return x<0&&(P="-",x=-x),n.value<0?"-0x"+G+"p"+P+x:"0x"+G+"p"+P+x},float.__init__=function(n,o){return _b_.None},float.__int__=function(n){return parseInt(n)},float.is_integer=function(n){return _b_.int.$factory(n)==n},float.__mod__=function(n,o){if(n=float_value(n),0==(o=float_value(o)))throw ZeroDivisionError.$factory("float modulo");if(isinstance(o,_b_.int))return new Number((n%o+o)%o);if(isinstance(o,float)){var l=Math.floor(n/o);return new Number(n-o*l)}if(isinstance(o,_b_.bool)){var x=0;return o.valueOf()&&(x=1),new Number((n%x+x)%x)}if(hasattr(o,"__rmod__"))return getattr(o,"__rmod__")(n);$err("%",o)},float.__mro__=[object],float.__mul__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return new Number(o.__class__==$B.long_int?n*parseFloat(o.value):n*o);if(isinstance(o,float))return new Number(n*float_value(o));if(isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),new Number(n*l)}return isinstance(o,_b_.complex)?$B.make_complex(float.$factory(n*o.$real),float.$factory(n*o.$imag)):hasattr(o,"__rmul__")?getattr(o,"__rmul__")(n):void $err("*",o)},float.__ne__=function(n,o){var l=float.__eq__(n,o);return l===_b_.NotImplemented?l:!l},float.__neg__=function(n,o){return float.$factory(-float_value(n))},float.__new__=function(n,o){if(void 0===n)throw _b_.TypeError.$factory("float.__new__(): not enough arguments");if(!_b_.isinstance(n,_b_.type))throw _b_.TypeError.$factory("float.__new__(X): X is not a type object");return n===float?float.$factory(o):{__class__:n,__dict__:$B.empty_dict(),$brython_value:o||0}},float.__pos__=function(n){return float_value(n)},float.__pow__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int)||isinstance(o,float)){if(1==n)return n;if(0==o)return new Number(1);if(!(-1!=n||isFinite(o)&&o.__class__!==$B.long_int&&$B.is_safe_int(o)||isNaN(o)))return new Number(1);if(0==n&&isFinite(o)&&o<0)throw _b_.ZeroDivisionError.$factory("0.0 cannot be raised to a negative power");return n!=Number.NEGATIVE_INFINITY||isNaN(o)?n!=Number.POSITIVE_INFINITY||isNaN(o)?o!=Number.NEGATIVE_INFINITY||isNaN(n)?o!=Number.POSITIVE_INFINITY||isNaN(n)?n<0&&!_b_.getattr(o,"__eq__")(_b_.int.$factory(o))?_b_.complex.__pow__($B.make_complex(n,0),o):float.$factory(Math.pow(n,o)):Math.abs(n)<1?new Number(0):Number.POSITIVE_INFINITY:Math.abs(n)<1?Number.POSITIVE_INFINITY:new Number(0):o>0?n:new Number(0):o<0&&o%2==1?new Number(-0):o<0?new Number(0):o>0&&o%2==1?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY}if(isinstance(o,_b_.complex)){var l=Math.pow(n,o.$real),x=Math.log(n);return $B.make_complex(l*Math.cos(x),l*Math.sin(x))}if(hasattr(o,"__rpow__"))return getattr(o,"__rpow__")(n);$err("** or pow()",o)},float.__repr__=float.__str__=function(n){if((n=float_value(n)).valueOf()==1/0)return"inf";if(n.valueOf()==-1/0)return"-inf";if(isNaN(n.valueOf()))return"nan";var o,l,x=n.valueOf()+"";if(-1==x.indexOf(".")&&(x+=".0"),[o,l]=x.split("."),o.length>16){for(var B=o.length-1,D=o[0],G=o.substr(1)+l;G.endsWith("0");)G=G.substr(0,G.length-1);var M=D;return G.length>0&&(M+="."+G),M+"e+"+B}if("0"==o){for(B=0;B<l.length&&"0"==l.charAt(B);)B++;if(B>3){var P=l.substr(B);for(B=(B+1).toString();P.endsWith("0");)P=P.substr(0,x.length-1);return M=P[0],P.length>1&&(M+="."+P.substr(1)),1==B.length&&(B="0"+B),M+"e-"+B}}return _b_.str.$factory(x)},float.__setattr__=function(n,o,l){if(n.constructor===Number)throw void 0===float[o]?_b_.AttributeError.$factory("'float' object has no attribute '"+o+"'"):_b_.AttributeError.$factory("'float' object attribute '"+o+"' is read-only");return n[o]=l,_b_.None},float.__truediv__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,[_b_.int,float])){if(0==o.valueOf())throw ZeroDivisionError.$factory("division by zero");return float.$factory(n/o)}if(isinstance(o,_b_.complex)){var l=o.$real*o.$real+o.$imag*o.$imag;if(0==l)throw ZeroDivisionError.$factory("division by zero");return $B.make_complex(float.$factory(n*o.$real/l),float.$factory(-n*o.$imag/l))}if(hasattr(o,"__rtruediv__"))return getattr(o,"__rtruediv__")(n);$err("/",o)};var $op_func=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return"boolean"==typeof o?o?n-1:n:float.$factory(o.__class__===$B.long_int?n-parseInt(o.value):n-o);if(isinstance(o,float))return float.$factory(n-o);if(isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),float.$factory(n-l)}return isinstance(o,_b_.complex)?$B.make_complex(n-o.$real,-o.$imag):hasattr(o,"__rsub__")?getattr(o,"__rsub__")(n):void $err("-",o)};$op_func+="";var $ops={"+":"add","-":"sub"};for(var $op in $ops){var $opf=$op_func.replace(/-/gm,$op);$opf=$opf.replace(/__rsub__/gm,"__r"+$ops[$op]+"__"),eval("float.__"+$ops[$op]+"__ = "+$opf)}var $comp_func=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return o.__class__===$B.long_int?n>parseInt(o.value):n>o.valueOf();if(isinstance(o,float))return n>o;if(isinstance(o,_b_.bool))return n.valueOf()>_b_.bool.__hash__(o);if(hasattr(o,"__int__")||hasattr(o,"__index__"))return _b_.int.__gt__(n,$B.$GetInt(o));var l=getattr(o,"__le__",None);if(l!==None)return l(n);throw _b_.TypeError.$factory("unorderable types: float() > "+$B.class_name(o)+"()")};for(var $op in $comp_func+="",$B.$comps)eval("float.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op).replace(/__gt__/gm,"__"+$B.$comps[$op]+"__").replace(/__le__/,"__"+$B.$inv_comps[$op]+"__"));$B.make_rmethods(float);var $notimplemented=function(n,o){throw _b_.TypeError.$factory("unsupported operand types for OPERATOR: 'float' and '"+$B.class_name(o)+"'")};for(var $op in $notimplemented+="",$B.$operators)if(void 0===$B.augmented_assigns[$op]){var $opfunc="__"+$B.$operators[$op]+"__";void 0===float[$opfunc]&&eval("float."+$opfunc+"="+$notimplemented.replace(/OPERATOR/gm,$op))}function $FloatClass(n){return new Number(n)}function to_digits(n){for(var o="",l=0;l<n.length;l++){var x="\u0660\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669".indexOf(n[l]);o+=x>-1?x:n[l]}return o}float.$factory=function(value){switch(value){case void 0:return $FloatClass(0);case Number.MAX_VALUE:return $FloatClass(1/0);case-Number.MAX_VALUE:return $FloatClass(-1/0);case!0:return new Number(1);case!1:return new Number(0)}if("number"==typeof value)return new Number(value);if(isinstance(value,float))return float_value(value);if(isinstance(value,bytes)){var s=getattr(value,"decode")("latin-1");return float.$factory(getattr(value,"decode")("latin-1"))}if("string"==typeof value)switch(value=value.trim(),value.toLowerCase()){case"+inf":case"inf":case"+infinity":case"infinity":return Number.POSITIVE_INFINITY;case"-inf":case"-infinity":return Number.NEGATIVE_INFINITY;case"+nan":case"nan":return Number.NaN;case"-nan":return-Number.NaN;case"":throw _b_.ValueError.$factory("count not convert string to float");default:if(value=value.charAt(0)+value.substr(1).replace(/_/g,""),value=to_digits(value),isFinite(value))return $FloatClass(eval(value));throw _b_.str.encode(value,"latin-1"),_b_.ValueError.$factory("Could not convert to float(): '"+_b_.str.$factory(value)+"'")}var klass=value.__class__||$B.get_class(value),num_value=$B.to_num(value,["__float__","__index__"]);if(null!==num_value)return num_value;throw _b_.TypeError.$factory("float() argument must be a string or a number, not '"+$B.class_name(value)+"'")},$B.$FloatClass=$FloatClass,$B.set_func_names(float,"builtins");var FloatSubclass=$B.FloatSubclass={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"float"},$is_class:!0};for(var $attr in float)"function"==typeof float[$attr]&&(FloatSubclass[$attr]=function(n){return function(){var o=[],l=0;if(arguments.length>0){o=[arguments[0].valueOf()],l=1;for(var x=1,B=arguments.length;x<B;x++)o[l++]=arguments[x]}return float[n].apply(null,o)}}($attr));$B.set_func_names(FloatSubclass,"builtins"),_b_.float=float}(__BRYTHON__),function($B){var _b_=$B.builtins;function $err(n,o){var l="unsupported operand type(s) for "+n+" : 'int' and '"+$B.class_name(o)+"'";throw _b_.TypeError.$factory(l)}function int_value(n){return void 0!==n.$brython_value?n.$brython_value:n}var int={__class__:_b_.type,__dir__:_b_.object.__dir__,$infos:{__module__:"builtins",__name__:"int"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&-1=="bcdoxXn".indexOf(o.type))throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'int'");var l;switch(o.type){case void 0:case"d":l=n.toString();break;case"b":l=(o.alternate?"0b":"")+n.toString(2);break;case"c":l=_b_.chr(n);break;case"o":l=(o.alternate?"0o":"")+n.toString(8);break;case"x":l=(o.alternate?"0x":"")+n.toString(16);break;case"X":l=(o.alternate?"0X":"")+n.toString(16).toUpperCase();break;case"n":return n}return void 0!==o.sign&&(" "==o.sign||"+"==o.sign)&&n>=0&&(l=o.sign+l),l}function extended_euclidean(n,o){var l,x,B;return 0==o?[n,1,0]:([l,x,B]=extended_euclidean(o,n%o),[l,B,x-Math.floor(n/o)*B])}int.as_integer_ratio=function(){var n=$B.args("as_integer_ratio",1,{self:null},["self"],arguments,{},null,null);return $B.$list([n.self,1])},int.from_bytes=function(){var n,o,l=$B.args("from_bytes",3,{bytes:null,byteorder:null,signed:null},["bytes","byteorder","signed"],arguments,{signed:!1},null,null),x=l.bytes,B=l.byteorder,D=l.signed;if(_b_.isinstance(x,[_b_.bytes,_b_.bytearray]))n=x.source,o=x.source.length;else{o=(n=_b_.list.$factory(x)).length;for(var G=0;G<o;G++)_b_.bytes.$factory([n[G]])}switch(B){case"big":var M=n[o-1],P=256;for(G=o-2;G>=0;G--)M=$B.add($B.mul(P,n[G]),M),P=$B.mul(P,256);return D?n[0]<128?M:$B.sub(M,P):M;case"little":for((M=n[0])>=128&&(M-=256),P=256,G=1;G<o;G++)M=$B.add($B.mul(P,n[G]),M),P=$B.mul(P,256);return D?n[o-1]<128?M:$B.sub(M,P):M}throw _b_.ValueError.$factory("byteorder must be either 'little' or 'big'")},int.to_bytes=function(){var n=$B.args("to_bytes",3,{self:null,len:null,byteorder:null},["self","len","byteorder"],arguments,{},"args","kw"),o=n.self,l=n.len,x=n.byteorder,B=n.kw;if(!_b_.isinstance(l,_b_.int))throw _b_.TypeError.$factory("integer argument expected, got "+$B.class_name(l));if(-1==["little","big"].indexOf(x))throw _b_.ValueError.$factory("byteorder must be either 'little' or 'big'");var G=[];if(o<0){if(!B.$string_dict.signed)throw _b_.OverflowError.$factory("can't convert negative int to unsigned");o=Math.pow(256,l)+o}for(var M=o;;){var P=Math.floor(M/256);if(G.push(M-256*P),0==P)break;M=P}if(G.length>l)throw _b_.OverflowError.$factory("int too big to convert");for(;G.length<l;)G=G.concat([0]);return"big"==x&&(G=G.reverse()),{__class__:_b_.bytes,source:G}},int.__abs__=function(n){return _b_.abs(n)},int.__bool__=function(n){return 0!=int_value(n).valueOf()},int.__ceil__=function(n){return Math.ceil(int_value(n))},int.__divmod__=function(n,o){return $B.fast_tuple([int.__floordiv__(n,o),int.__mod__(n,o)])},int.__eq__=function(n,o){return void 0===o?n===int:_b_.isinstance(o,int)?n.valueOf()==int_value(o).valueOf():_b_.isinstance(o,_b_.float)?n.valueOf()==o.valueOf():_b_.isinstance(o,_b_.complex)?0!=o.$imag?False:n.valueOf()==o.$real:_b_.NotImplemented},int.__float__=function(n){return new Number(n)},int.__format__=function(n,o){var l=new $B.parse_format_spec(o);if(l.type&&-1!="eEfFgG%".indexOf(l.type))return _b_.float.__format__(n,o);l.align=l.align||">";var x=preformat(n,l);if(l.comma){for(var B="-"==x[0]?"-":"",D=x.substr(B.length),G=D.length,M=Math.ceil(D.length/3),P=[],fe=0;fe<M;fe++)P.push(D.substring(G-3*fe-3,G-3*fe));P.reverse(),x=B+P.join(",")}return $B.format_width(x,l)},int.__floordiv__=function(n,o){if(o.__class__===$B.long_int)return $B.long_int.__floordiv__($B.long_int.$factory(n),o);if(_b_.isinstance(o,int)){if(0==(o=int_value(o)))throw _b_.ZeroDivisionError.$factory("division by zero");return Math.floor(n/o)}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return Math.floor(n/o)}if(_b_.hasattr(o,"__rfloordiv__"))return $B.$getattr(o,"__rfloordiv__")(n);$err("//",o)},int.__hash__=function(n){return void 0===n?int.__hashvalue__||$B.$py_next_hash--:n.valueOf()},int.__index__=function(n){return int_value(n)},int.__init__=function(n,o){return void 0===o&&(o=0),n.toString=function(){return o},_b_.None},int.__int__=function(n){return n},int.__invert__=function(n){return~n},int.__lshift__=function(n,o){if(_b_.isinstance(o,int))return o=int_value(o),int.$factory($B.long_int.__lshift__($B.long_int.$factory(n),$B.long_int.$factory(o)));var l=$B.$getattr(o,"__rlshift__",_b_.None);if(l!==_b_.None)return l(n);$err("<<",o)},int.__mod__=function(n,o){if(_b_.isinstance(o,_b_.tuple)&&1==o.length&&(o=o[0]),o.__class__===$B.long_int)return $B.long_int.__mod__($B.long_int.$factory(n),o);if(_b_.isinstance(o,[int,_b_.float,bool])){if(!1===(o=int_value(o))?o=0:!0===o&&(o=1),0==o)throw _b_.ZeroDivisionError.$factory("integer division or modulo by zero");return(n%o+o)%o}if(_b_.hasattr(o,"__rmod__"))return $B.$getattr(o,"__rmod__")(n);$err("%",o)},int.__mro__=[_b_.object],int.__mul__=function(n,o){var l=n.valueOf();if("string"==typeof o)return o.repeat(l);if(_b_.isinstance(o,int))return(x=n*(o=int_value(o)))>$B.min_int&&x<$B.max_int?x:int.$factory($B.long_int.__mul__($B.long_int.$factory(n),$B.long_int.$factory(o)));if(_b_.isinstance(o,_b_.float))return new Number(n*o);if(_b_.isinstance(o,_b_.bool))return o.valueOf()?n:int.$factory(0);if(_b_.isinstance(o,_b_.complex))return $B.make_complex(int.__mul__(n,o.$real),int.__mul__(n,o.$imag));if(_b_.isinstance(o,[_b_.list,_b_.tuple])){for(var x=[],B=o.slice(0,o.length),D=0;D<l;D++)x=x.concat(B);return _b_.isinstance(o,_b_.tuple)&&(x=_b_.tuple.$factory(x)),x}if(_b_.hasattr(o,"__rmul__"))return $B.$getattr(o,"__rmul__")(n);$err("*",o)},int.__ne__=function(n,o){var l=int.__eq__(n,o);return l===_b_.NotImplemented?l:!l},int.__neg__=function(n){return-n},int.__new__=function(n,o){if(void 0===n)throw _b_.TypeError.$factory("int.__new__(): not enough arguments");if(!_b_.isinstance(n,_b_.type))throw _b_.TypeError.$factory("int.__new__(X): X is not a type object");return n===int?int.$factory(o):{__class__:n,__dict__:$B.empty_dict(),$brython_value:o||0}},int.__pos__=function(n){return n},$B.use_bigint=0,int.__pow__=function(n,o,l){if("number"==typeof o||_b_.isinstance(o,int)){switch((o=int_value(o)).valueOf()){case 0:return int.$factory(1);case 1:return int.$factory(n.valueOf())}if(void 0!==l&&l!==_b_.None){if(1==l)return 0;var x=1,B=n%l,D=o,G=$B.long_int;if(D<0){var M,P,fe;if([M,P,fe]=extended_euclidean(n,l),1!==M)throw _b_.ValueError.$factory("not relative primes: "+n+" and "+l);return int.__pow__(P,-D,l)}for(;D>0;)D%2==1&&(x*B>$B.max_int?(x=G.__mul__(G.$factory(x),G.$factory(B)),x=G.__mod__(x,l)):x=x*B%l),D>>=1,B*B>$B.max_int?(B=G.__mul__(G.$factory(B),G.$factory(B)),B=G.__mod__(B,l)):B=B*B%l;return x}var ye=Math.pow(n.valueOf(),o.valueOf());return ye>$B.min_int&&ye<$B.max_int?ye:ye===1/0||isFinite(ye)?$B.BigInt?($B.use_bigint++,{__class__:$B.long_int,value:($B.BigInt(n)**$B.BigInt(o)).toString(),pos:!0}):$B.long_int.__pow__($B.long_int.$from_int(n),$B.long_int.$from_int(o)):ye}if(_b_.isinstance(o,_b_.float))return n>=0?new Number(Math.pow(n,o.valueOf())):_b_.complex.__pow__($B.make_complex(n,0),o);if(_b_.isinstance(o,_b_.complex)){var ne=Math.pow(n,o.$real),ue=Math.log(n);return $B.make_complex(ne*Math.cos(ue),ne*Math.sin(ue))}var me=$B.$getattr(o,"__rpow__",_b_.None);if(me!==_b_.None)return me(n);$err("**",o)},int.__repr__=function(n){return n===int?"<class 'int'>":n.toString()},int.__rshift__=function(n,o){if(_b_.isinstance(o,int))return o=int_value(o),int.$factory($B.long_int.__rshift__($B.long_int.$factory(n),$B.long_int.$factory(o)));var l=$B.$getattr(o,"__rrshift__",_b_.None);if(l!==_b_.None)return l(n);$err(">>",o)},int.__setattr__=function(n,o,l){if("number"==typeof n)throw _b_.AttributeError.$factory(void 0===int.$factory[o]?"'int' object has no attribute '"+o+"'":"'int' object attribute '"+o+"' is read-only");return _b_.dict.$setitem(n.__dict__,o,l),_b_.None},int.__str__=int.__repr__,int.__truediv__=function(n,o){if(_b_.isinstance(o,int)){if(0==(o=int_value(o)))throw _b_.ZeroDivisionError.$factory("division by zero");return new Number(o.__class__===$B.long_int?n/parseInt(o.value):n/o)}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return new Number(n/o)}if(_b_.isinstance(o,_b_.complex)){var l=o.$real*o.$real+o.$imag*o.$imag;if(0==l)throw _b_.ZeroDivisionError.$factory("division by zero");return $B.make_complex(n*o.$real/l,-n*o.$imag/l)}if(_b_.hasattr(o,"__rtruediv__"))return $B.$getattr(o,"__rtruediv__")(n);$err("/",o)},int.bit_length=function(n){return s=_b_.bin(n),s=$B.$getattr(s,"lstrip")("-0b"),s.length},int.numerator=function(n){return n},int.denominator=function(n){return int.$factory(1)},int.imag=function(n){return int.$factory(0)},int.real=function(n){return n},$B.max_int32=2147483647,$B.min_int32=-$B.max_int32;var $op_func=function(n,o){if(_b_.isinstance(o,int))return o.__class__===$B.long_int?$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o)):(o=int_value(o),n>$B.max_int32||n<$B.min_int32||o>$B.max_int32||o<$B.min_int32?$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o)):n-o);if(_b_.isinstance(o,_b_.bool))return n-o;var l=$B.$getattr(o,"__rsub__",_b_.None);if(l!==_b_.None)return l(n);$err("-",o)};$op_func+="";var $ops={"&":"and","|":"or","^":"xor"};for(var $op in $ops){var opf=$op_func.replace(/-/gm,$op);opf=opf.replace(new RegExp("sub","gm"),$ops[$op]),eval("int.__"+$ops[$op]+"__ = "+opf)}var $op_func=function(n,o){if(_b_.isinstance(o,int)){if("number"==typeof(o=int_value(o))){var l=n.valueOf()-o.valueOf();return l>$B.min_int&&l<$B.max_int?l:$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))}return"boolean"==typeof o?o?n-1:n:$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))}if(_b_.isinstance(o,_b_.float))return new Number(n-o);if(_b_.isinstance(o,_b_.complex))return $B.make_complex(n-o.$real,-o.$imag);if(_b_.isinstance(o,_b_.bool)){var x=0;return o.valueOf()&&(x=1),n-x}if(_b_.isinstance(o,_b_.complex))return $B.make_complex(n.valueOf()-o.$real,o.$imag);var B=$B.$getattr(o,"__rsub__",_b_.None);if(B!==_b_.None)return B(n);throw console.log("err",n,o),console.log($B.frames_stack.slice()),$err("-",o)};$op_func+="";var $ops={"+":"add","-":"sub"};for(var $op in $ops){var opf=$op_func.replace(/-/gm,$op);opf=opf.replace(new RegExp("sub","gm"),$ops[$op]),eval("int.__"+$ops[$op]+"__ = "+opf)}var $comp_func=function(n,o){return o.__class__===$B.long_int?$B.long_int.__lt__(o,$B.long_int.$factory(n)):_b_.isinstance(o,int)?(o=int_value(o),n.valueOf()>o.valueOf()):_b_.isinstance(o,_b_.float)?n.valueOf()>o.valueOf():_b_.isinstance(o,_b_.bool)?n.valueOf()>_b_.bool.__hash__(o):_b_.hasattr(o,"__int__")||_b_.hasattr(o,"__index__")?int.__gt__(n,$B.$GetInt(o)):_b_.NotImplemented};for(var $op in $comp_func+="",$B.$comps)eval("int.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op).replace(/__gt__/gm,"__"+$B.$comps[$op]+"__").replace(/__lt__/,"__"+$B.$inv_comps[$op]+"__"));$B.make_rmethods(int);var $valid_digits=function(n){var o="";if(0===n)return"0";if(n<10){for(var l=0;l<n;l++)o+=String.fromCharCode(l+48);return o}for(o="0123456789",l=10;l<n;l++)o+=String.fromCharCode(l+55);return o};int.$factory=function(n,o){if(void 0===n)return 0;if("number"==typeof n&&(void 0===o||10==o))return parseInt(n);if(_b_.isinstance(n,_b_.complex))throw _b_.TypeError.$factory("can't convert complex to int");var l=$B.args("int",2,{x:null,base:null},["x","base"],arguments,{base:10},null,null);if(o=l.base,_b_.isinstance(n=l.x,_b_.float)&&10==o)return(n=_b_.float.numerator(n))<$B.min_int||n>$B.max_int?$B.long_int.$from_float(n):n>0?Math.floor(n):Math.ceil(n);if(!(o>=2&&o<=36)&&0!=o)throw _b_.ValueError.$factory("invalid base");if("number"==typeof n){if(10==o)return n<$B.min_int||n>$B.max_int?$B.long_int.$factory(n):n;if(n.toString().search("e")>-1)throw _b_.OverflowError.$factory("can't convert to base "+o);var x=parseInt(n,o);return n<$B.min_int||n>$B.max_int?$B.long_int.$factory(n,o):x}if(!0===n)return 1;if(!1===n)return 0;if(n.__class__===$B.long_int){var B=parseInt(n.value);return B>$B.min_int&&B<$B.max_int?B:n}function D(ye,ne){throw _b_.ValueError.$factory("invalid literal for int() with base "+ne+": '"+_b_.str.$factory(ye)+"'")}if(o=$B.$GetInt(o),_b_.isinstance(n,_b_.str)&&(n=n.valueOf()),"string"==typeof n){var G=n.trim();if(2==G.length&&0==o&&("0b"==G||"0o"==G||"0x"==G))throw _b_.ValueError.$factory("invalid value");if(G.length>2){var M=G.substr(0,2).toUpperCase();if(0==o?("0B"==M&&(o=2),"0O"==M&&(o=8),"0X"==M&&(o=16)):("0X"==M&&16!=o||"0O"==M&&8!=o)&&D(G,o),"0B"==M&&2==o||"0O"==M||"0X"==M)for(G=G.substr(2);G.startsWith("_");)G=G.substr(1)}else 0==o&&(o=10);var P=$valid_digits(o);return null===new RegExp("^[+-]?["+P+"]["+P+"_]*$","i").exec(G)?D(n,o):n=G.replace(/_/g,""),o<=10&&!isFinite(n)&&D(G,o),(x=parseInt(n,o))<$B.min_int||x>$B.max_int?$B.long_int.$factory(n,o):x}if(_b_.isinstance(n,[_b_.bytes,_b_.bytearray]))return int.$factory($B.$getattr(n,"decode")("latin-1"),o);var fe=$B.to_num(n,["__int__","__index__","__trunc__"]);if(null===fe)throw _b_.TypeError.$factory("int() argument must be a string, a bytes-like object or a number, not '"+$B.class_name(n)+"'");return fe},$B.set_func_names(int,"builtins"),_b_.int=int,$B.$bool=function(n){if(null==n)return!1;switch(typeof n){case"boolean":return n;case"number":case"string":return!!n;default:if(n.$is_class)return!0;var o=n.__class__||$B.get_class(n),l={},x=$B.$getattr(o,"__bool__",l);if(x!==l){var B=$B.$call(x)(n);if(!0!==B&&!1!==B)throw _b_.TypeError.$factory("__bool__ should return bool, returned "+$B.class_name(B));return B}try{return _b_.len(n)>0}catch{return!0}}};var bool={__bases__:[int],__class__:_b_.type,__mro__:[int,_b_.object],$infos:{__name__:"bool",__module__:"builtins"},$is_class:!0,$native:!0},methods=$B.op2method.subset("operations","binary","comparisons","boolean");for(var op in methods){var method="__"+methods[op]+"__";bool[method]=function(n){return function(o,l){if(void 0!==int[n])return int[n](o?1:0,l)}}(method)}bool.__and__=function(n,o){return _b_.isinstance(o,bool)?n&&o:_b_.isinstance(o,int)?int.__and__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.__hash__=bool.__index__=bool.__int__=function(n){return n.valueOf()?1:0},bool.__neg__=function(n){return-$B.int_or_bool(n)},bool.__or__=function(n,o){return _b_.isinstance(o,bool)?n||o:_b_.isinstance(o,int)?int.__or__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.__pos__=$B.int_or_bool,bool.__repr__=bool.__str__=function(n){return n?"True":"False"},bool.__setattr__=function(n,o){if(_b_.dir(n).indexOf(o)>-1)var l="attribute '"+o+"' of 'int' objects is not writable";else l="'bool' object has no attribute '"+o+"'";throw _b_.AttributeError.$factory(l)},bool.__xor__=function(n,o){return _b_.isinstance(o,bool)?!!(n^o):_b_.isinstance(o,int)?int.__xor__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.$factory=function(){var n=$B.args("bool",1,{x:null},["x"],arguments,{x:!1},null,null);return $B.$bool(n.x)},_b_.bool=bool,$B.set_func_names(bool,"builtins")}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);try{eval("window")}catch(n){window=self}var long_int={__class__:_b_.type,__mro__:[int,object],$infos:{__module__:"builtins",__name__:"int"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function add_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)+BigInt(o)).toString(),pos:!0};for(var l,x="",B=0,D=n.length,G=o.length-1;G>=0;G--)2==(l=(B+(--D<0?0:parseInt(n.charAt(D)))+parseInt(o.charAt(G))).toString()).length?(x=l.charAt(1)+x,B=parseInt(l.charAt(0))):(x=l+x,B=0);for(;D>0;)D--,2==(l=(B+parseInt(n.charAt(D))).toString()).length?(x=l.charAt(1)+x,B=parseInt(l.charAt(0))):(x=l+x,B=0);return B&&(x=B+x),{__class__:long_int,value:x,pos:!0}}var len=(Math.pow(2,53)-1+"").length-1;function binary_pos(n){for(var o,l,x,B,D=Math.ceil(n.length/len),G=[],M=[],P=0;P<D;P++)x=(o=n.length-(P+1)*len)-(l=Math.max(0,o)),G.push(n.substr(l,len+x));(G=G.reverse()).forEach(function(ye,ne){G[ne]=parseInt(ye)});for(var fe=Math.pow(10,15);G[G.length-1]>0;)G.forEach(function(ye,ne){B=ye%2,G[ne]=Math.floor(ye/2),B&&ne<G.length-1&&(G[ne+1]+=fe)}),M.push(B),0==G[0]&&G.shift();return M.reverse().join("")}function binary(n){var o=binary_pos(n.value);if(n.pos)return o;for(var l="",x=0,B=o.length;x<B;x++)l+="0"==o.charAt(x)?"1":"0";var D=add_pos(l,"1").value;return l.substr(0,l.length-D.length)+D}function check_shift(n){if(!isinstance(n,long_int))throw TypeError.$factory("shift must be int, not '"+$B.class_name(n)+"'");if(!n.pos)throw ValueError.$factory("negative shift count")}function clone(n){var o={};for(var l in n)o[l]=n[l];return o}function comp_pos(n,o){return n.length>o.length?1:n.length<o.length?-1:n>o?1:n<o?-1:0}function divmod_by_safe_int(n,o){if(1==o)return[n,0];for(var l,x,B,D=(Math.floor((Math.pow(2,53)-1)/o)+"").length-1,G=Math.ceil(n.length/D),M=[],P=0;P<G;P++)B=(l=n.length-(P+1)*D)-(x=Math.max(0,l)),M.push(n.substr(x,D+B));(M=M.reverse()).forEach(function(ue,me){M[me]=parseInt(ue)});var fe,ye,ne=Math.pow(10,D);for(M.forEach(function(ue,me){fe=ue%o,M[me]=Math.floor(ue/o),me<M.length-1&&(M[me+1]+=ne*fe)});0==M[0];)if(M.shift(),0==M.length)return[0,fe];return ye=M[0]+"",M.forEach(function(ue,me){me>0&&(ye+="0".repeat(D-ue.toString().length)+ue)}),[ye,fe]}function divmod_pos(n,o){if(window.BigInt)return[{__class__:long_int,value:(BigInt(n)/BigInt(o)).toString(),pos:!0},{__class__:long_int,value:(BigInt(n)%BigInt(o)).toString(),pos:!0}];var l,x=parseInt(n),B=parseInt(o);if(x<$B.max_int&&B<$B.max_int){var D=x%B,G=Math.floor(x/B).toString();return[{__class__:long_int,value:G.toString(),pos:!0},{__class__:long_int,value:D.toString(),pos:!0}]}if(B<$B.max_int){var M=divmod_by_safe_int(n,B);return[long_int.$factory(M[0]),long_int.$factory(M[1])]}if(-1==comp_pos(n,o))P="0",l=long_int.$factory(n);else if(o==n)P="1",l=long_int.$factory("0");else{var P="",fe=n.substr(0,o.length);n<o&&(fe=n.substr(0,o.length+1));for(var ye=n.substr(fe.length),ne={};;){var ue=Math.floor(parseInt(fe)/parseInt(o))+"";if("10"==ue&&(ue="9"),void 0===ne[ue]&&(ne[ue]=mul_pos(o,ue).value),-1==comp_pos(fe,ne[ue])&&void 0===ne[--ue]&&(ne[ue]=mul_pos(o,ue).value),P+=ue,fe=sub_pos(fe,ne[ue]).value,0==ye.length)break;fe+=ye.charAt(0),ye=ye.substr(1)}l=sub_pos(n,mul_pos(P,o).value)}return[long_int.$factory(P),l]}function split_chunks(n,o){for(var l=Math.ceil(n.length/o),x=[],B=n.length,D=0;D<l;D++){var G=B-o*(D+1);G<0&&(o+=G,G=0),x.push(parseInt(n.substr(G,o)))}return x}function mul_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)*BigInt(o)).toString(),pos:!0};var l,x=parseInt(n)*parseInt(o);if(x<$B.max_int)return{__class__:long_int,value:x.toString(),pos:!0};for(var B=split_chunks(n,6),D=split_chunks(o,6),G={},M=B.length+D.length,P=0;P<M-1;P++)G[P]=0;for(P=0;P<B.length;P++)for(var fe=0;fe<D.length;fe++)G[P+fe]+=B[P]*D[fe];for(P=0;P<M-1;P++){var ye=split_chunks(G[P].toString(),6);for(fe=1;fe<ye.length;fe++)void 0===G[l=P+fe]?G[l]=parseInt(ye[fe]):G[l]+=parseInt(ye[fe]);G[P]=ye[0]}var ne,ue="";for(P=0;void 0!==G[P];)ne=G[P].toString(),void 0!==G[P+1]&&(ne="0".repeat(6-ne.length)+ne),ue=ne+ue,P++;try{return long_int.$factory(ue)}catch(me){throw console.log(n,o,G,ue),me}}function sub_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)-BigInt(o)).toString(),pos:!0};for(var l,x="",B=0,D=n.length,G=0,M=o.length-1;M>=0;M--)D--,l=(G=parseInt(n.charAt(D)))-B-parseInt(o.charAt(M)),isNaN(l)&&console.log("x is NaN",n.length,o.length,M,D,G,B,M,o.charAt(M)),l<0?(x=10+l+x,B=1):(x=l+x,B=0);for(x.startsWith("NaN")&&alert(x);D>0;)D--,(l=parseInt(n.charAt(D))-B)<0?(x=10+l+x,B=1):(x=l+x,B=0);for(;"0"==x.charAt(0)&&x.length>1;)x=x.substr(1);return x.startsWith("NaN")&&console.log("hoho !!",n,o,n>=o,x),{__class__:long_int,value:x,pos:!0}}function to_BigInt(n){var o=$B.BigInt(n.value);return n.pos?o:-o}function from_BigInt(n){var o=n>=0;return n=(n=(n=n.toString()).endsWith("n")?n.substr(0,n.length-1):n).startsWith("-")?n.substr(1):n,intOrLong({__class__:long_int,value:n,pos:o})}function digits(n){for(var o={},l=0;l<n&&10!=l;l++)o[l]=!0;if(n>10)for(l=0;l<n-10;l++)o[String.fromCharCode(65+l)]=!0,o[String.fromCharCode(97+l)]=!0;return o}long_int.$from_float=function(n){var o=Math.abs(n).toString(),l=o;if(o.search("e")>-1){var x=/-?(\d)(\.\d+)?e([+-])(\d*)/.exec(o),B=x[1],D=x[2],M=x[4];"+"==x[3]&&(l=void 0===D?B+"0".repeat(M-1):B+D+"0".repeat(M-1-D.length))}return{__class__:long_int,value:l,pos:n>=0}},long_int.__abs__=function(n){return{__class__:long_int,value:n.value,pos:!0}},long_int.__add__=function(n,o){if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)+o.value);if("number"==typeof o)o=long_int.$factory(_b_.str.$factory(o));else if(o.__class__!==long_int)if(isinstance(o,_b_.bool))o=long_int.$factory(o?1:0);else{if(!isinstance(o,int))return _b_.NotImplemented;o=long_int.$factory(_b_.str.$factory(_b_.int.__index__(o)))}var l;if(n.pos&&o.pos)return add_pos(n.value,o.value);if(n.pos||o.pos){if(n.pos&&!o.pos){switch(comp_pos(n.value,o.value)){case 1:l=sub_pos(n.value,o.value);break;case 0:l={__class__:long_int,value:0,pos:!0};break;case-1:(l=sub_pos(o.value,n.value)).pos=!1}return intOrLong(l)}switch(comp_pos(n.value,o.value)){case 1:(l=sub_pos(n.value,o.value)).pos=!1;break;case 0:l={__class__:long_int,value:0,pos:!0};break;case-1:l=sub_pos(o.value,n.value)}return intOrLong(l)}return(l=add_pos(n.value,o.value)).pos=!1,intOrLong(l)},long_int.__and__=function(n,o){if("number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),$B.BigInt)return from_BigInt(to_BigInt(n)&to_BigInt(o));var l="",x=!n.pos&&!o.pos;x&&(n=long_int.__neg__(n),o=long_int.__neg__(o));var B,D,G=binary(n),M=G.length,P=binary(o),fe=P.length,ye=1;for(l="";!(ye>M&&ye>fe);)B=ye>M?n.pos?"0":"1":G.charAt(M-ye),D=ye>fe?o.pos?"0":"1":P.charAt(fe-ye),l="1"==B&&"1"==D?"1"+l:"0"+l,ye++;for(;"0"==l.charAt(0);)l=l.substr(1);return l=$B.long_int.$factory(l,2),x&&(l.pos=!1),intOrLong(l)},long_int.__divmod__=function(n,o){"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o)));var l=divmod_pos(n.value,o.value);return n.pos!==o.pos&&("0"!=l[0].value&&(l[0].pos=!1),"0"!=l[1].value&&(l[0]=long_int.__sub__(l[0],long_int.$factory("1")),l[1]=long_int.__sub__(n,long_int.__mul__(o,long_int.$factory(l[0]))))),$B.fast_tuple([intOrLong(l[0]),intOrLong(l[1])])},long_int.__eq__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.value==o.value&&n.pos==o.pos},long_int.__float__=function(n){return new Number(parseFloat(n.value))},long_int.__floordiv__=function(n,o){if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)/o);if("number"==typeof o){var l=divmod_by_safe_int(n.value,o);return{__class__:long_int,value:l[0],pos:o>0?n.pos:!n.pos}}return intOrLong(long_int.__divmod__(n,o)[0])},long_int.__ge__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos!=o.pos?!o.pos:n.value.length>o.value.length?n.pos:n.value.length<o.value.length?!n.pos:n.pos?n.value>=o.value:n.value<=o.value},long_int.__gt__=function(n,o){return!long_int.__le__(n,o)},long_int.__index__=function(n){for(var o,l="",x=n.value;l=(o=divmod_pos(x,"2"))[1].value+l,"0"!=(x=o[0].value););if(n.pos)l="0"+l;else{for(var B="",D=!1,G=l.length-1;G>=0;G--)"0"==l.charAt(G)?B=D?"1"+B:"0"+B:D?B="0"+B:(D=!0,B="1"+B);l=B="1"+B}return intOrLong(l)},long_int.__invert__=function(n){return long_int.__sub__(long_int.$factory("-1"),n)},long_int.__le__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos!==o.pos||n.value.length>o.value.length?!n.pos:n.value.length<o.value.length?n.pos:n.pos?n.value<=o.value:n.value>=o.value},long_int.__lt__=function(n,o){return!long_int.__ge__(n,o)},long_int.__lshift__=function(n,o){if(window.BigInt)return o.__class__==long_int&&(o=o.value),intOrLong({__class__:long_int,value:(BigInt(n.value)<<BigInt(o)).toString(),pos:n.pos});var l;if(o.__class__===long_int){var x=parseInt(o.value);if(x<0)throw _b_.ValueError.$factory("negative shift count");x<$B.max_int&&(l=!0,o=x)}if(l){if(0==x)return n}else if("0"==(o=long_int.$factory(o)).value)return n;for(var B=n.value;;){for(var D,G=0,M="",P=B.length-1;P>=0;P--)2==(D=(G+2*parseInt(B.charAt(P))).toString()).length?(M=D.charAt(1)+M,G=parseInt(D.charAt(0))):(M=D+M,G=0);if(G&&(M=G+M),B=M,l){if(0==--o)break}else if("0"==(o=sub_pos(o.value,"1")).value)break}return intOrLong({__class__:long_int,value:B,pos:n.pos})},long_int.__mod__=function(n,o){return intOrLong(long_int.__divmod__(n,o)[1])},long_int.__mro__=[_b_.int,_b_.object],long_int.__mul__=function(n,o){switch(n){case Number.NEGATIVE_INFINITY:case Number.POSITIVE_INFINITY:return $B.rich_comp("__eq__",o,0)?NaN:_b_.getattr(o,"__gt__")(0)?n:-n}if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)*o);if("number"==typeof o&&(o=long_int.$factory(o)),other_value=o.value,other_pos=o.pos,o.__class__!==long_int&&isinstance(o,int)){var l=int.__index__(o);other_value=_b_.str.$factory(l),other_pos=l>0}if($B.BigInt)return from_BigInt(to_BigInt(n)*to_BigInt(o));var x=mul_pos(n.value,other_value);return n.pos==other_pos||(x.pos=!1),intOrLong(x)},long_int.__neg__=function(n){return{__class__:long_int,value:n.value,pos:!n.pos}},long_int.__or__=function(n,o){o=long_int.$factory(o);var l=long_int.__index__(n),x=long_int.__index__(o);if(l.length<x.length){var B=x;x=l,l=B}for(var D=l.length-x.length,G=l.substr(0,D),M=0;M<x.length;M++)"1"==l.charAt(D+M)||"1"==x.charAt(M)?G+="1":G+="0";return intOrLong(long_int.$factory(G,2))},long_int.__pos__=function(n){return n},long_int.__pow__=function(n,o,l){if("number"==typeof o)o=long_int.$from_int(o);else if(isinstance(o,int))o=long_int.$factory(_b_.str.$factory(_b_.int.__index__(o)));else if(!isinstance(o,long_int))throw TypeError.$factory("power must be an integer, not '"+$B.class_name(o)+"'");if(!o.pos)return"1"==n.value?n:long_int.$factory("0");if("0"==o.value)return long_int.$factory("1");if($B.BigInt){var x=$B.BigInt(n.value),B=$B.BigInt(1),D=$B.BigInt(o.value);if(void 0===(l=void 0===l?l:$B.BigInt("number"==typeof l?l:l.value)))return{__class__:long_int,value:(x**D).toString(),pos:!0};for(;D>0;)D%$B.BigInt(2)==1&&(B*=x),(D/=$B.BigInt(2))>0&&(x*=x),void 0!==l&&(B%=l);return{__class__:long_int,value:B.toString(),pos:!0}}B={__class__:long_int,value:"1",pos:!0},x=n;for(var G,M=o.value;"string"==typeof M&&parseInt(M)<$B.max_int&&(M=parseInt(M)),0!=M;)"string"==typeof M?(parseInt(M.charAt(M.length-1))%2==1&&(B=long_int.__mul__(B,x)),M=long_int.__floordiv__(M,2)):(M%2==1&&(B="number"==typeof B&&"number"==typeof x&&(G=B*x)<$B.max_int?G:long_int.__mul__(long_int.$factory(B),long_int.$factory(x))),M=Math.floor(M/2)),M>0&&("number"==typeof x&&(G=x*x)<$B.max_int?x=G:(x=long_int.$factory(x),x=long_int.__mul__(x,x))),void 0!==l&&(B=long_int.__mod__(B,l));return intOrLong(B)},long_int.__rshift__=function(n,o){if(window.BigInt)return o.__class__===long_int&&(o=o.value),intOrLong({__class__:long_int,value:(BigInt(n.value)>>BigInt(o)).toString(),pos:n.pos});if("number"==typeof o){var l=Math.pow(2,o);if(l<$B.max_int){var x=divmod_by_safe_int(n.value,l);return intOrLong({__class__:long_int,value:x[0],pos:n.pos})}}if("0"==(o=long_int.$factory(o)).value)return n;for(x=n.value;"0"!=(x=divmod_pos(x,"2")[0].value).value&&"0"!=(o=sub_pos(o.value,"1")).value;);return intOrLong({__class__:long_int,value:x,pos:n.pos})},long_int.__str__=long_int.__repr__=function(n){var o="";return n.pos||(o+="-"),o+n.value},long_int.__sub__=function(n,o){if(isinstance(o,_b_.float))return o=o instanceof Number?o:o.$brython_value,_b_.float.$factory(parseInt(n.value)-o);var l;if("number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos&&o.pos){switch(comp_pos(n.value,o.value)){case 1:l=sub_pos(n.value,o.value);break;case 0:l={__class__:long_int,value:"0",pos:!0};break;case-1:(l=sub_pos(o.value,n.value)).pos=!1}return intOrLong(l)}if(n.pos||o.pos)return n.pos&&!o.pos?intOrLong(add_pos(n.value,o.value)):((l=add_pos(n.value,o.value)).pos=!1,intOrLong(l));switch(comp_pos(n.value,o.value)){case 1:(l=sub_pos(n.value,o.value)).pos=!1;break;case 0:l={__class__:long_int,value:"0",pos:!0};break;case-1:l=sub_pos(o.value,n.value)}return intOrLong(l)},long_int.__truediv__=function(n,o){if(isinstance(o,long_int))return _b_.float.$factory(parseInt(n.value)/parseInt(o.value));if(isinstance(o,_b_.int)||isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)/o);throw TypeError.$factory("unsupported operand type(s) for /: 'int' and '"+$B.class_name(o)+"'")},long_int.__xor__=function(n,o){o=long_int.$factory(o);var l=long_int.__index__(n),x=long_int.__index__(o);if(l.length<x.length){var B=x;x=l,l=B}for(var D=l.length-x.length,G=l.substr(0,D),M=0;M<x.length;M++)"1"==l.charAt(D+M)&&"0"==x.charAt(M)||"0"==l.charAt(D+M)&&"1"==x.charAt(M)?G+="1":G+="0";return intOrLong(long_int.$factory(G,2))},long_int.numerator=function(n){return n},long_int.denominator=function(n){return _b_.int.$factory(1)},long_int.imag=function(n){return _b_.int.$factory(0)},long_int.real=function(n){return n},long_int.to_base=function(n,o){if(2==o)return binary_pos(n.value);for(var l="",x=n.value;x>0;){var B=divmod_pos(x,o.toString());if(l=parseInt(B[1].value).toString(o)+l,0==(x=B[0].value))break}return l};var MAX_SAFE_INTEGER=Math.pow(2,53)-1,MIN_SAFE_INTEGER=-MAX_SAFE_INTEGER;function isSafeInteger(n){return"number"==typeof n&&Math.round(n)===n&&MIN_SAFE_INTEGER<=n&&n<=MAX_SAFE_INTEGER}function intOrLong(n){var o=parseInt(n.value)*(n.pos?1:-1);return o>MIN_SAFE_INTEGER&&o<MAX_SAFE_INTEGER?o:n}long_int.$from_int=function(n){return{__class__:long_int,value:n.toString(),pos:n>0}},long_int.$factory=function(n,o){if(arguments.length>2)throw _b_.TypeError.$factory("long_int takes at most 2 arguments ("+arguments.length+" given)");if(void 0===o)o=10;else if(!isinstance(o,int))throw TypeError.$factory("'"+$B.class_name(o)+"' object cannot be interpreted as an integer");if(o<0||1==o||o>36)throw ValueError.$factory("long_int.$factory() base must be >= 2 and <= 36");if("number"==typeof n){var l=n>0;if(isSafeInteger(n=Math.abs(n)))P=long_int.$from_int(n);else{if(n.constructor!=Number)throw ValueError.$factory("argument of long_int is not a safe integer");var x=n.toString(),B=x.search("e");if(B>-1){var D=x.substr(0,B),G=parseInt(x.substr(B+1));if((ue=D.search(/\./))>-1){var M=D.substr(ue+1).length;if(M>G){var P=D.substr(0,ue)+D.substr(ue+1).substr(0,G);P=long_int.$from_int(P)}else P=D.substr(0,ue)+D.substr(ue+1)+"0".repeat(G-M),P=long_int.$from_int(P)}else P=long_int.$from_int(D+"0".repeat(G))}else P=(ue=x.search(/\./))>-1?long_int.$from_int(x.substr(0,ue)):long_int.$from_int(x)}return P.pos=l,P}if(isinstance(n,_b_.float)){if(n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)return n;n=new Number(n>=0?Math.round(n.value):Math.ceil(n.value))}else{if(isinstance(n,_b_.bool))return n.valueOf()?int.$factory(1):int.$factory(0);if(n.__class__===long_int)return n;if(isinstance(n,int))n=n.$brython_value+"";else if(isinstance(n,_b_.bool))n=_b_.bool.__int__(n)+"";else if("string"!=typeof n)throw ValueError.$factory("argument of long_int must be a string, not "+$B.class_name(n))}for(var fe=!1,ye=(l=!0,0);" "==n.charAt(0)&&n.length;)n=n.substr(1);for(;" "==n.charAt(n.length-1)&&n.length;)n=n.substr(0,n.length-1);if("+"==n.charAt(0)?fe=!0:"-"==n.charAt(0)&&(fe=!0,l=!1),fe){if(1==n.length)throw ValueError.$factory('long_int argument is not a valid number: "'+n+'"');n=n.substr(1)}for(;ye<n.length-1&&"0"==n.charAt(ye);)ye++;n=n.substr(ye);for(var ne=digits(o),ue=-1,me=0;me<n.length;me++)if("."==n.charAt(me)&&-1==ue)ue=me;else if(!ne[n.charAt(me)])throw ValueError.$factory('long_int argument is not a valid number: "'+n+'"');if(-1!=ue&&(n=n.substr(0,ue)),10!=o){for(var ie="1",W=long_int.$factory(0),Q=n.length;Q--;){var A=mul_pos(ie,parseInt(n.charAt(Q),o).toString()).value;W=add_pos(W.value,A),ie=mul_pos(ie,o.toString()).value}return W}return{__class__:long_int,value:n,pos:l}},$B.set_func_names(long_int,"builtins"),$B.long_int=long_int}(__BRYTHON__),function($B){var _b_=$B.builtins;function $UnsupportedOpType(n,o,l){throw _b_.TypeError.$factory("unsupported operand type(s) for "+n+": '"+o+"' and '"+l+"'")}var complex={__class__:_b_.type,__dir__:_b_.object.__dir__,$infos:{__module__:"builtins",__name__:"complex"},$is_class:!0,$native:!0,$descriptors:{real:!0,imag:!0}};function complex2expo(n){var o=Math.sqrt(n.$real*n.$real+n.$imag*n.$imag),l=n.$imag/o,x=n.$real/o;return{norm:o,angle:0==x?1==l?Math.PI/2:3*Math.PI/2:0==l?1==x?0:Math.PI:Math.atan(l/x)}}complex.__abs__=function(n){var o=isFinite(n.$real),l=isFinite(n.$imag);if(o&&isNaN(n.$imag)||l&&isNaN(n.$real)||isNaN(n.$imag)&&isNaN(n.$real))return NaN;if(!o||!l)return 1/0;var x=Math.sqrt(Math.pow(n.$real,2)+Math.pow(n.$imag,2));if(!isFinite(x)&&o&&l)throw _b_.OverflowError.$factory("absolute value too large");return x},complex.__bool__=function(n){return 0!=n.$real||0!=n.$imag},complex.__eq__=function(n,o){return _b_.isinstance(o,complex)?n.$real.valueOf()==o.$real.valueOf()&&n.$imag.valueOf()==o.$imag.valueOf():_b_.isinstance(o,_b_.int)||_b_.isinstance(o,_b_.float)?0==n.$imag&&n.$real==o.valueOf():_b_.NotImplemented},complex.__floordiv__=function(n,o){$UnsupportedOpType("//","complex",$B.get_class(o))},complex.__hash__=function(n){return 1000003*n.$imag+n.$real},complex.__init__=function(){return _b_.None},complex.__invert__=function(n){return~n},complex.__mod__=function(n,o){throw _b_.TypeError.$factory("TypeError: can't mod complex numbers.")},complex.__mro__=[_b_.object],complex.__mul__=function(n,o){return _b_.isinstance(o,complex)?make_complex(n.$real*o.$real-n.$imag*o.$imag,n.$imag*o.$real+n.$real*o.$imag):_b_.isinstance(o,_b_.int)?make_complex(n.$real*o.valueOf(),n.$imag*o.valueOf()):_b_.isinstance(o,_b_.float)?make_complex(n.$real*o,n.$imag*o):_b_.isinstance(o,_b_.bool)?o.valueOf()?n:make_complex(0,0):void $UnsupportedOpType("*",complex,o)},complex.__ne__=function(n,o){var l=complex.__eq__(n,o);return l===_b_.NotImplemented?l:!l},complex.__neg__=function(n){return make_complex(-n.$real,-n.$imag)},complex.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("complex.__new__(): not enough arguments");var o={},l=$B.args("complex",3,{cls:null,real:null,imag:null},["cls","real","imag"],arguments,{real:0,imag:o},null,null),x=l.real,B=l.imag;if("string"==typeof x){if(B!==o)throw _b_.TypeError.$factory("complex() can't take second arg if first is a string");{let fe=function(ye){var ne=parseFloat(ye.charAt(0)+ye.substr(1).replace(/_/g,""));if(isNaN(ne))throw _b_.ValueError.$factory("could not convert string to complex: '"+D+"'");return ne};var D=x;(x=x.trim()).startsWith("(")&&x.endsWith(")")&&(x=(x=x.substr(1)).substr(0,x.length-1));var G=/^\s*([\+\-]*[0-9_]*\.?[0-9_]*(e[\+\-]*[0-9_]*)?)([\+\-]?)([0-9_]*\.?[0-9_]*(e[\+\-]*[0-9_]*)?)(j?)\s*$/i.exec(x);if(null===G||"."==G[_real]||"."==G[_imag]||".e"==G[_real]||".e"==G[_imag]||"e"==G[_real]||"e"==G[_imag])throw _b_.ValueError.$factory("complex() arg is a malformed string");return""!=G[_j]?""==G[_sign]?(x=0,B="+"==G[_real]||""==G[_real]?1:"-"==G[_real]?-1:fe(G[_real])):(x=fe(G[_real]),B=""==G[_imag]?1:fe(G[_imag]),B="-"==G[_sign]?-B:B):(x=fe(G[_real]),B=0),{__class__:complex,$real:x||0,$imag:B||0}}}if(B=B===o?0:B,1==arguments.length&&x.__class__===complex&&0==B)return x;if(_b_.isinstance(x,[_b_.float,_b_.int])&&_b_.isinstance(B,[_b_.float,_b_.int]))return{__class__:complex,$real:x,$imag:B};var M=$B.to_num(x,["__complex__","__float__","__index__"]);if(null===M)throw _b_.TypeError.$factory("complex() first argument must be a  string or a number, not '"+$B.class_name(x)+"'");if(x=M,B=_convert(B),!_b_.isinstance(x,_b_.float)&&!_b_.isinstance(x,_b_.int)&&!_b_.isinstance(x,_b_.complex))throw _b_.TypeError.$factory("complex() argument must be a string or a number");if("string"==typeof B)throw _b_.TypeError.$factory("complex() second arg can't be a string");if(!_b_.isinstance(B,_b_.float)&&!_b_.isinstance(B,_b_.int)&&!_b_.isinstance(B,_b_.complex)&&B!==o)throw _b_.TypeError.$factory("complex() argument must be a string or a number");return B=complex.__mul__(complex.$factory("1j"),B),complex.__add__(B,x)},complex.__pos__=function(n){return n},complex.__pow__=function(n,o){var l=complex2expo(n),x=l.angle,B=Math.pow(l.norm,o);if(_b_.isinstance(o,[_b_.int,_b_.float]))return make_complex(B*Math.cos(x*o),B*Math.sin(x*o));if(_b_.isinstance(o,complex)){var D=o.$real,G=o.$imag,M=Math.pow(l.norm,D)*Math.pow(Math.E,-G*x),P=G*Math.log(l.norm)-D*x;return make_complex(M*Math.cos(P),M*Math.sin(P))}throw _b_.TypeError.$factory("unsupported operand type(s) for ** or pow(): 'complex' and '"+$B.class_name(o)+"'")},complex.__str__=complex.__repr__=function(n){return 0==n.$real?1/n.$real<0?n.$imag<0?"(-0"+n.$imag+"j)":0==n.$imag&&1/n.$imag<0?"(-0-"+n.$imag+"j)":"(-0+"+n.$imag+"j)":0==n.$imag&&1/n.$imag<0?"-"+n.$imag+"j":n.$imag+"j":n.$imag>0?"("+n.$real+"+"+n.$imag+"j)":0==n.$imag?1/n.$imag<0?"("+n.$real+"-"+n.$imag+"j)":"("+n.$real+"+"+n.$imag+"j)":"("+n.$real+"-"+-n.$imag+"j)"},complex.__sqrt__=function(n){if(0==n.$imag)return complex(Math.sqrt(n.$real));var o=n.$real,l=n.$imag,x=Math.sqrt((o+sqrt)/2),B=Number.sign(l)*Math.sqrt((-o+sqrt)/2);return make_complex(x,B)},complex.__truediv__=function(n,o){if(_b_.isinstance(o,complex)){if(0==o.$real&&0==o.$imag)throw _b_.ZeroDivisionError.$factory("division by zero");var x=o.$real*o.$real+o.$imag*o.$imag;return make_complex((n.$real*o.$real+n.$imag*o.$imag)/x,(n.$imag*o.$real-n.$real*o.$imag)/x)}if(_b_.isinstance(o,_b_.int)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return complex.__truediv__(n,complex.$factory(o.valueOf()))}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return complex.__truediv__(n,complex.$factory(o.valueOf()))}$UnsupportedOpType("//","complex",o.__class__)},complex.conjugate=function(n){return make_complex(n.$real,-n.$imag)};var $op_func=function(n,o){throw _b_.TypeError.$factory("TypeError: unsupported operand type(s) for -: 'complex' and '"+$B.class_name(o)+"'")};$op_func+="";var $ops={"&":"and","|":"ior","<<":"lshift",">>":"rshift","^":"xor"};for(var $op in $ops)eval("complex.__"+$ops[$op]+"__ = "+$op_func.replace(/-/gm,$op));complex.__ior__=complex.__or__;var $op_func=function(n,o){if(_b_.isinstance(o,complex))return make_complex(n.$real-o.$real,n.$imag-o.$imag);if(_b_.isinstance(o,_b_.int))return make_complex($B.sub(n.$real,o.valueOf()),n.$imag);if(_b_.isinstance(o,_b_.float))return make_complex(n.$real-o.valueOf(),n.$imag);if(_b_.isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),make_complex(n.$real-l,n.$imag)}throw _b_.TypeError.$factory("unsupported operand type(s) for -: "+n.__repr__()+" and '"+$B.class_name(o)+"'")};complex.__sub__=$op_func,$op_func+="",$op_func=$op_func.replace(/-/gm,"+").replace(/sub/gm,"add"),eval("complex.__add__ = "+$op_func);var $comp_func=function(n,o){if(void 0===o||o==_b_.None)return _b_.NotImplemented;throw _b_.TypeError.$factory("TypeError: no ordering relation is defined for complex numbers")};for(var $op in $comp_func+="",$B.$comps)eval("complex.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op));$B.make_rmethods(complex),complex.real=function(n){return new Number(n.$real)},complex.real.setter=function(){throw _b_.AttributeError.$factory("readonly attribute")},complex.imag=function(n){return new Number(n.$imag)},complex.imag.setter=function(){throw _b_.AttributeError.$factory("readonly attribute")};var _real=1,_real_mantissa=2,_sign=3,_imag=4,_imag_mantissa=5,_j=6,type_conversions=["__complex__","__float__","__index__"],_convert=function(n){for(var o=n.__class__||$B.get_class(n),l=0;l<type_conversions.length;l++){var x={},B=$B.$getattr(o,type_conversions[l],x);if(B!==x)return B(n)}return null},make_complex=$B.make_complex=function(n,o){return{__class__:complex,$real:n,$imag:o}};complex.$factory=function(){return complex.__new__(complex,...arguments)},$B.set_func_names(complex,"builtins"),_b_.complex=complex}(__BRYTHON__),function(n){var o=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function l(ne){return ne<1e5?ne<100?ne<10?0:1:ne<1e4?ne<1e3?2:3:4:ne<1e7?ne<1e6?5:6:ne<1e9?ne<1e8?7:8:9}function x(ne,ue){if(ne===ue)return 0;if(~~ne===ne&&~~ue===ue){if(0===ne||0===ue)return ne<ue?-1:1;if(ne<0||ue<0){if(ue>=0)return-1;if(ne>=0)return 1;ne=-ne,ue=-ue}al=l(ne),bl=l(ue);var me=0;return al<bl?(ne*=o[bl-al-1],ue/=10,me=-1):al>bl&&(ue*=o[al-bl-1],ne/=10,me=1),ne===ue?me:ne<ue?-1:1}var ie=String(ne),W=String(ue);return ie===W?0:ie<W?-1:1}function B(ne,ue,me,ie){var W=ue+1;if(W===me)return 1;if(ie(ne[W++],ne[ue])<0){for(;W<me&&ie(ne[W],ne[W-1])<0;)W++;!function(Q,A,R){for(R--;A<R;){var X=Q[A];Q[A++]=Q[R],Q[R--]=X}}(ne,ue,W)}else for(;W<me&&ie(ne[W],ne[W-1])>=0;)W++;return W-ue}function D(ne,ue,me,ie,W){for(ie===ue&&ie++;ie<me;ie++){for(var Q=ne[ie],A=ue,R=ie;A<R;){var X=A+R>>>1;W(Q,ne[X])<0?R=X:A=X+1}var he=ie-A;switch(he){case 3:ne[A+3]=ne[A+2];case 2:ne[A+2]=ne[A+1];case 1:ne[A+1]=ne[A];break;default:for(;he>0;)ne[A+he]=ne[A+he-1],he--}ne[A]=Q}}function G(ne,ue,me,ie,W,Q){var A=0,R=0,X=1;if(Q(ne,ue[me+W])>0){for(R=ie-W;X<R&&Q(ne,ue[me+W+X])>0;)A=X,(X=1+(X<<1))<=0&&(X=R);X>R&&(X=R),A+=W,X+=W}else{for(R=W+1;X<R&&Q(ne,ue[me+W-X])<=0;)A=X,(X=1+(X<<1))<=0&&(X=R);X>R&&(X=R);var he=A;A=W-X,X=W-he}for(A++;A<X;){var z=A+(X-A>>>1);Q(ne,ue[me+z])>0?A=z+1:X=z}return X}function M(ne,ue,me,ie,W,Q){var A=0,R=0,X=1;if(Q(ne,ue[me+W])<0){for(R=W+1;X<R&&Q(ne,ue[me+W-X])<0;)A=X,(X=1+(X<<1))<=0&&(X=R);X>R&&(X=R);var he=A;A=W-X,X=W-he}else{for(R=ie-W;X<R&&Q(ne,ue[me+W+X])>=0;)A=X,(X=1+(X<<1))<=0&&(X=R);X>R&&(X=R),A+=W,X+=W}for(A++;A<X;){var z=A+(X-A>>>1);Q(ne,ue[me+z])<0?X=z:A=z+1}return X}var P="TimSortAssertion",fe=function(ne){this.name=P,this.message=ne},ye=function(ne,ue){var me={array:ne,compare:ue,minGallop:7,length:ne.length,tmpStorageLength:256,stackLength:0,runStart:null,runLength:null,stackSize:0,pushRun:function(ie,W){this.runStart[this.stackSize]=ie,this.runLength[this.stackSize]=W,this.stackSize+=1},mergeRuns:function(){for(;this.stackSize>1;){var ie=this.stackSize-2;if(ie>=1&&this.runLength[ie-1]<=this.runLength[ie]+this.runLength[ie+1]||ie>=2&&this.runLength[ie-2]<=this.runLength[ie]+this.runLength[ie-1])this.runLength[ie-1]<this.runLength[ie+1]&&ie--;else if(this.runLength[ie]>this.runLength[ie+1])break;this.mergeAt(ie)}},forceMergeRuns:function(){for(;this.stackSize>1;){var ie=this.stackSize-2;ie>0&&this.runLength[ie-1]<this.runLength[ie+1]&&ie--,this.mergeAt(ie)}},mergeAt:function(ie){var W=this.compare,Q=this.array,A=this.runStart[ie],R=this.runLength[ie],X=this.runStart[ie+1],he=this.runLength[ie+1];this.runLength[ie]=R+he,ie===this.stackSize-3&&(this.runStart[ie+1]=this.runStart[ie+2],this.runLength[ie+1]=this.runLength[ie+2]),this.stackSize--;var z=M(Q[X],Q,A,R,0,W);A+=z,0!=(R-=z)&&0!==(he=G(Q[A+R-1],Q,X,he,he-1,W))&&(R<=he?this.mergeLow(A,R,X,he):this.mergeHigh(A,R,X,he))},mergeLow:function(ie,W,Q,A){var R=this.compare,X=this.array,he=this.tmp,z=0;for(z=0;z<W;z++)he[z]=X[ie+z];var Le=0,K=Q,be=ie;if(X[be++]=X[K++],0!=--A)if(1!==W){for(var Ne=this.minGallop;;){var je=0,Te=0,qe=!1;do{if(R(X[K],he[Le])<0){if(X[be++]=X[K++],Te++,je=0,0==--A){qe=!0;break}}else if(X[be++]=he[Le++],je++,Te=0,1==--W){qe=!0;break}}while((je|Te)<Ne);if(qe)break;do{if(0!==(je=M(X[K],he,Le,W,0,R))){for(z=0;z<je;z++)X[be+z]=he[Le+z];if(be+=je,Le+=je,(W-=je)<=1){qe=!0;break}}if(X[be++]=X[K++],0==--A){qe=!0;break}if(0!==(Te=G(he[Le],X,K,A,0,R))){for(z=0;z<Te;z++)X[be+z]=X[K+z];if(be+=Te,K+=Te,0==(A-=Te)){qe=!0;break}}if(X[be++]=he[Le++],1==--W){qe=!0;break}Ne--}while(je>=7||Te>=7);if(qe)break;Ne<0&&(Ne=0),Ne+=2}if(this.minGallop=Ne,Ne<1&&(this.minGallop=1),1===W){for(z=0;z<A;z++)X[be+z]=X[K+z];X[be+A]=he[Le]}else{if(0===W)throw new fe("mergeLow preconditions were not respected");for(z=0;z<W;z++)X[be+z]=he[Le+z]}}else{for(z=0;z<A;z++)X[be+z]=X[K+z];X[be+A]=he[Le]}else for(z=0;z<W;z++)X[be+z]=he[Le+z]},mergeHigh:function(ie,W,Q,A){var R=this.compare,X=this.array,he=this.tmp,z=0;for(z=0;z<A;z++)he[z]=X[Q+z];var Le=ie+W-1,K=A-1,be=Q+A-1,Ne=0,je=0;if(X[be--]=X[Le--],0!=--W)if(1!==A){for(var Te=this.minGallop;;){var qe=0,Ke=0,vt=!1;do{if(R(he[K],X[Le])<0){if(X[be--]=X[Le--],qe++,Ke=0,0==--W){vt=!0;break}}else if(X[be--]=he[K--],Ke++,qe=0,1==--A){vt=!0;break}}while((qe|Ke)<Te);if(vt)break;do{if(0!=(qe=W-M(he[K],X,ie,W,W-1,R))){for(W-=qe,je=1+(be-=qe),Ne=1+(Le-=qe),z=qe-1;z>=0;z--)X[je+z]=X[Ne+z];if(0===W){vt=!0;break}}if(X[be--]=he[K--],1==--A){vt=!0;break}if(0!=(Ke=A-G(X[Le],he,0,A,A-1,R))){for(A-=Ke,je=1+(be-=Ke),Ne=1+(K-=Ke),z=0;z<Ke;z++)X[je+z]=he[Ne+z];if(A<=1){vt=!0;break}}if(X[be--]=X[Le--],0==--W){vt=!0;break}Te--}while(qe>=7||Ke>=7);if(vt)break;Te<0&&(Te=0),Te+=2}if(this.minGallop=Te,Te<1&&(this.minGallop=1),1===A){for(je=1+(be-=W),Ne=1+(Le-=W),z=W-1;z>=0;z--)X[je+z]=X[Ne+z];X[be]=he[K]}else{if(0==A)throw new fe("mergeHigh preconditions were not respected");for(Ne=be-(A-1),z=0;z<A;z++)X[Ne+z]=he[z]}}else{for(je=1+(be-=W),Ne=1+(Le-=W),z=W-1;z>=0;z--)X[je+z]=X[Ne+z];X[be]=he[K]}else for(Ne=be-(A-1),z=0;z<A;z++)X[Ne+z]=he[z]}};return me.length<512&&(me.tmpStorageLength=me.length>>>1),me.tmp=new Array(me.tmpStorageLength),me.stackLength=me.length<120?5:me.length<1542?10:me.length<119151?19:40,me.runStart=new Array(me.stackLength),me.runLength=new Array(me.stackLength),me};n.$TimSort=function(ne,ue){try{!function(me,ie,W,Q){if(!Array.isArray(me))throw TypeError.$factory("Can only sort arrays");ie?"function"!=typeof ie&&(Q=W,W=ie,ie=x):ie=x,W||(W=0),Q||(Q=me.length);var A=Q-W;if(!(A<2)){var R=0;if(A<32)D(me,W,Q,W+(R=B(me,W,Q,ie)),ie);else{var X=new ye(me,ie),he=function(Le){for(var K=0;Le>=32;)K|=1&Le,Le>>=1;return Le+K}(A);do{if((R=B(me,W,Q,ie))<he){var z=A;z>he&&(z=he),D(me,W,W+z,W+R,ie),R=z}X.pushRun(W,R),X.mergeRuns(),A-=R,W+=R}while(0!==A);X.forceMergeRuns()}}}(ne,ue,0,ne.length)}catch(me){if(me.name!=P)throw me;ne.sort(ue)}},n.$AlphabeticalCompare=x}(__BRYTHON__),function(n){var o=n.builtins,l=o.object,x=n.$getattr,B=o.isinstance,D=o.None;function G(ie,W){if(ie.__class__===ue)throw o.AttributeError.$factory("'tuple' object has no attribute '"+W+"'")}var M={__class__:o.type,__mro__:[l],$infos:{__module__:"builtins",__name__:"list"},$is_class:!0,$native:!0,__dir__:l.__dir__,__add__:function(ie,W){if(n.get_class(ie)!==n.get_class(W)){var Q=x(W,"__radd__",o.NotImplemented);if(Q!==o.NotImplemented)return Q(ie);throw o.TypeError.$factory('can only concatenate list (not "'+n.class_name(W)+'") to list')}var A=ie.slice(),R="js"==W.$brython_class;for(const X of W)A.push(R?n.$JS2Py(X):X);return A.__brython__=!0,B(ie,ue)&&(A=ue.$factory(A)),A},__class_getitem__:function(ie,W){return Array.isArray(W)||(W=[W]),n.GenericAlias.$factory(ie,W)},__contains__:function(ie,W){for(var A=n.args("__contains__",2,{self:null,item:null},["self","item"],arguments,{},null,null),R=(ie=A.self,W=A.item,0);R<ie.length;){if(n.rich_comp("__eq__",W,ie[R]))return!0;R++}return!1},__delitem__:function(ie,W){if(B(W,o.int)){var Q=W;if(W<0&&(Q=ie.length+Q),Q>=0&&Q<ie.length)return ie.splice(Q,1),D;throw o.IndexError.$factory(n.class_name(ie)+" index out of range")}if(B(W,o.slice)){var A=W.step;A===D&&(A=1);var R=W.start;R===D&&(R=A>0?0:ie.length);var X=W.stop;X===D&&(X=A>0?ie.length:0),R<0&&(R=ie.length+R),X<0&&(X=ie.length+X);var he=[],z=null;if(Q=0,A>0){if(X>R)for(z=R;z<X;z+=A)void 0!==ie[z]&&(he[Q++]=z)}else if(X<R){for(z=R;z>X;z+=A)void 0!==ie[z]&&(he[Q++]=z);he.reverse()}for(z=he.length;z--;)ie.splice(he[z],1);return D}if(o.hasattr(W,"__int__")||o.hasattr(W,"__index__"))return M.__delitem__(ie,o.int.$factory(W)),D;throw o.TypeError.$factory(n.class_name(ie)+" indices must be integer, not "+n.class_name(W))},__eq__:function(ie,W){if(B(ie,M))var Q=M;else Q=ue;if(B(W,Q)&&W.length==ie.length){for(var A=ie.length;A--;)if(!n.rich_comp("__eq__",ie[A],W[A]))return!1;return!0}return o.NotImplemented},__getitem__:function(ie,W){return n.check_no_kw("__getitem__",ie,W),n.check_nb_args("__getitem__",2,arguments),M.$getitem(ie,W)},$getitem:function(ie,W){var Q=(ie.__class__||n.get_class(ie)).$factory;if(B(W,o.int)){var A=ie.valueOf(),R=W;if(W<0&&(R=A.length+R),R>=0&&R<A.length)return A[R];throw o.IndexError.$factory(n.class_name(ie)+" index out of range")}if(W.__class__===o.slice||B(W,o.slice)){if(W.start===o.None&&W.stop===o.None&&W.step===o.None)return ie.slice();var X=o.slice.$conv_for_seq(W,ie.length),he=[],z=null,Le=(A=ie.valueOf(),R=0,X.start),K=X.stop,be=X.step;if(be>0){if(K<=Le)return Q(he);for(z=Le;z<K;z+=be)he[R++]=A[z];return Q(he)}if(K>Le)return Q(he);for(z=Le;z>K;z+=be)he[R++]=A[z];return Q(he)}if(o.hasattr(W,"__int__")||o.hasattr(W,"__index__"))return M.__getitem__(ie,o.int.$factory(W));throw o.TypeError.$factory(n.class_name(ie)+" indices must be integer, not "+n.class_name(W))},__ge__:function(ie,W){if(!B(W,[M,o.tuple]))return o.NotImplemented;for(var Q=0;Q<ie.length;){if(Q>=W.length)return!0;if(!n.rich_comp("__eq__",ie[Q],W[Q])){if(res=x(ie[Q],"__ge__")(W[Q]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(ie[Q])+"() >= "+n.class_name(W[Q])+"()");return res}Q++}return W.length==ie.length},__gt__:function(ie,W){if(!B(W,[M,o.tuple]))return o.NotImplemented;for(var Q=0;Q<ie.length;){if(Q>=W.length)return!0;if(!n.rich_comp("__eq__",ie[Q],W[Q])){if(res=x(ie[Q],"__gt__")(W[Q]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(ie[Q])+"() > "+n.class_name(W[Q])+"()");return res}Q++}return!1}};M.__hash__=D,M.__iadd__=function(){var ie=n.args("__iadd__",2,{self:null,x:null},["self","x"],arguments,{},null,null),W=x(ie.x,"__radd__",o.NotImplemented);if(W!==o.NotImplemented)return W(ie.self);for(var Q=M.$factory(n.$iter(ie.x)),A=0;A<Q.length;A++)ie.self.push(Q[A]);return ie.self},M.__imul__=function(){var ie=n.args("__imul__",2,{self:null,x:null},["self","x"],arguments,{},null,null),W=n.$GetInt(ie.x),Q=ie.self.length,A=Q;if(0==W)return M.clear(ie.self),ie.self;for(var R=1;R<W;R++)for(j=0;j<Q;j++)ie.self[A++]=ie.self[j];return ie.self},M.__init__=function(ie,W){var Q=n.$call(x(ie,"__len__")),A=x(ie,"pop",D);if(A!==D)for(A=n.$call(A);Q();)A();if(void 0===W)return D;W=n.$iter(W);for(var R=n.$call(x(W,"__next__")),X=Q();;)try{var he=R();ie[X++]=he}catch(z){if(z.__class__===o.StopIteration)break;throw z}return D};var P=n.make_iterator_class("list_iterator");P.__reduce__=P.__reduce_ex__=function(ie){return n.fast_tuple([o.iter,n.fast_tuple([M.$factory(ie)]),0])},M.__iter__=function(ie){return P.$factory(ie)},M.__le__=function(ie,W){var Q=M.__ge__(ie,W);return Q===o.NotImplemented?Q:!Q},M.__len__=function(ie){return ie.length},M.__lt__=function(ie,W){if(!B(W,[M,o.tuple]))return o.NotImplemented;for(var Q=0;Q<ie.length;){if(Q>=W.length)return!1;if(!n.rich_comp("__eq__",ie[Q],W[Q])){if(res=x(ie[Q],"__lt__")(W[Q]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(ie[Q])+"() >= "+n.class_name(W[Q])+"()");return res}Q++}return W.length>ie.length},M.__mul__=function(ie,W){if(B(W,o.int)){for(var Q=[],A=ie.slice(),R=A.length,X=0;X<W;X++)for(var he=0;he<R;he++)Q.push(A[he]);return Q.__class__=ie.__class__,Q}if(o.hasattr(W,"__int__")||o.hasattr(W,"__index__"))return M.__mul__(ie,o.int.$factory(W));var z=n.$getattr(W,"__rmul__",o.NotImplemented);if(z!==o.NotImplemented)return z(ie);throw o.TypeError.$factory("can't multiply sequence by non-int of type '"+n.class_name(W)+"'")},M.__new__=function(ie,...W){if(void 0===ie)throw o.TypeError.$factory("list.__new__(): not enough arguments");var Q=[];return Q.__class__=ie,Q.__brython__=!0,Q.__dict__=n.empty_dict(),Q},M.__repr__=function(ie){if(n.repr.enter(ie))return"[...]";for(var W,Q=[],A=0;A<ie.length;A++)Q.push(o.repr(ie[A]));return W=ie.__class__===ue?1==ie.length?"("+Q[0]+",)":"("+Q.join(", ")+")":"["+Q.join(", ")+"]",n.repr.leave(ie),W},M.__setattr__=function(ie,W,Q){if(ie.__class__===M)throw M.hasOwnProperty(W)?o.AttributeError.$factory("'list' object attribute '"+W+"' is read-only"):o.AttributeError.$factory("'list' object has no attribute '"+W+"'");return o.dict.$setitem(ie.__dict__,W,Q),D},M.__setitem__=function(){var ie=n.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);M.$setitem(ie.self,ie.key,ie.value)},M.$setitem=function(ie,W,Q){if("number"==typeof W||B(W,o.int)){var A=W;if(W<0&&(A=ie.length+A),!(A>=0&&A<ie.length))throw o.IndexError.$factory("list index out of range");return ie[A]=Q,D}if(B(W,o.slice)){var R=o.slice.$conv_for_seq(W,ie.length);return null===W.step?n.set_list_slice(ie,R.start,R.stop,Q):n.set_list_slice_step(ie,R.start,R.stop,R.step,Q),D}if(o.hasattr(W,"__int__")||o.hasattr(W,"__index__"))return M.__setitem__(ie,o.int.$factory(W),Q),D;throw o.TypeError.$factory("list indices must be integer, not "+n.class_name(W))},n.make_rmethods(M),M.append=function(ie,W){return n.check_no_kw("append",ie,W),n.check_nb_args("append",2,arguments),ie.push(W),D},M.clear=function(){for(var ie=n.args("clear",1,{self:null},["self"],arguments,{},null,null);ie.self.length;)ie.self.pop();return D},M.copy=function(){return n.args("copy",1,{self:null},["self"],arguments,{},null,null).self.slice()},M.count=function(){for(var W=n.args("count",2,{self:null,x:null},["self","x"],arguments,{},null,null),Q=0,A=W.self.length;A--;)n.rich_comp("__eq__",W.x,W.self[A])&&Q++;return Q},M.extend=function(){for(var ie=n.args("extend",2,{self:null,t:null},["self","t"],arguments,{},null,null),W=M.$factory(n.$iter(ie.t)),Q=0;Q<W.length;Q++)ie.self.push(W[Q]);return D},M.index=function(){var W={},Q=n.args("index",4,{self:null,x:null,start:null,stop:null},["self","x","start","stop"],arguments,{start:0,stop:W},null,null),A=Q.self,R=Q.start,X=Q.stop;R.__class__===n.long_int&&(R=parseInt(R.value)*(R.pos?1:-1)),R<0&&(R=Math.max(0,R+A.length)),X===W?X=A.length:(X.__class__===n.long_int&&(X=parseInt(X.value)*(X.pos?1:-1)),X<0&&(X=Math.min(A.length,X+A.length)),X=Math.min(X,A.length));for(var he=R;he<X;he++)if(n.rich_comp("__eq__",Q.x,A[he]))return he;throw o.ValueError.$factory(o.repr(Q.x)+" is not in "+n.class_name(A))},M.insert=function(){var ie=n.args("insert",3,{self:null,i:null,item:null},["self","i","item"],arguments,{},null,null);return ie.self.splice(ie.i,0,ie.item),D},M.pop=function(){var ie={},W=n.args("pop",2,{self:null,pos:null},["self","pos"],arguments,{pos:ie},null,null),Q=W.self,A=W.pos;G(Q,"pop"),A===ie&&(A=Q.length-1),(A=n.$GetInt(A))<0&&(A+=Q.length);var R=Q[A];if(void 0===R)throw o.IndexError.$factory("pop index out of range");return Q.splice(A,1),R},M.remove=function(){for(var ie=n.args("remove",2,{self:null,x:null},["self","x"],arguments,{},null,null),W=0,Q=ie.self.length;W<Q;W++)if(n.rich_comp("__eq__",ie.self[W],ie.x))return ie.self.splice(W,1),D;throw o.ValueError.$factory(o.str.$factory(ie.x)+" is not in list")},M.reverse=function(ie){for(var W=n.args("reverse",1,{self:null},["self"],arguments,{},null,null),Q=W.self.length-1,A=parseInt(W.self.length/2);A--;){var R=W.self[A];W.self[A]=W.self[Q-A],W.self[Q-A]=R}return D},M.sort=function(ie){var z,W=n.args("sort",1,{self:null},["self"],arguments,{},null,"kw");G(ie,"sort");for(var Q=D,A=!1,R=W.kw,X=o.list.$factory(o.dict.$$keys(R)),he=0;he<X.length;he++)if("key"==X[he])Q=R.$string_dict[X[he]][0];else{if("reverse"!=X[he])throw o.TypeError.$factory("'"+X[he]+"' is an invalid keyword argument for this function");A=R.$string_dict[X[he]][0]}if(0!=ie.length)return Q!==D&&(Q=n.$call(Q)),ie.$cl=function(Le){if(0==Le.length)return null;for(var K=n.get_class(Le[0]),be=Le.length;be--;)if(n.get_class(Le[be])!==K)return!1;return K}(ie),z=Q===D&&ie.$cl===o.str?A?function(Le,K){return n.$AlphabeticalCompare(K,Le)}:function(Le,K){return n.$AlphabeticalCompare(Le,K)}:Q===D&&ie.$cl===o.int?A?function(Le,K){return K-Le}:function(Le,K){return Le-K}:Q===D?A?function(Le,K){if(res=x(K,"__lt__")(Le),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Le)+"() < "+n.class_name(K)+"()");return res?K==Le?0:-1:1}:function(Le,K){if(res=x(Le,"__lt__")(K),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Le)+"() < "+n.class_name(K)+"()");return res?Le==K?0:-1:1}:A?function(Le,K){var be=Q(K),Ne=Q(Le);if(res=x(be,"__lt__")(Ne),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Le)+"() < "+n.class_name(K)+"()");return res?be==Ne?0:-1:1}:function(Le,K){var be=Q(Le),Ne=Q(K);if(res=n.$getattr(be,"__lt__")(Ne),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Le)+"() < "+n.class_name(K)+"()");return res?be==Ne?0:-1:1},n.$TimSort(ie,z),ie.__brython__?D:ie},n.$list=function(ie){return ie.__brython__=!0,ie},M.$factory=function(){if(0==arguments.length)return[];var ie=n.args("list",1,{obj:null},["obj"],arguments,{},null,null).obj;if(Array.isArray(ie))return(ie=ie.slice()).__brython__=!0,ie.__class__==ue?((W=ie.slice()).__class__=M,W):ie;for(var W=[],Q=0,A=n.$iter(ie),R=n.$call(x(A,"__next__"));;)try{W[Q++]=R()}catch(X){if(!B(X,o.StopIteration))throw X;break}return W.__brython__=!0,W},n.set_func_names(M,"builtins"),M.__class_getitem__=o.classmethod.$factory(M.__class_getitem__);var fe=n.JSArray=n.make_class("JSArray",function(ie){return{__class__:fe,js:ie}});function ye(ie){for(var W=[ie[0].js],Q=1,A=ie.length;Q<A;Q++)W.push(ie[Q]);return W}for(var ne in fe.__repr__=fe.__str__=function(){return"<JSArray object>"},M)void 0===n.JSArray[ne]&&"function"==typeof M[ne]&&(n.JSArray[ne]=function(ie){return function(){return n.$JS2Py(M[ie].apply(null,ye(arguments)))}}(ne));n.set_func_names(n.JSArray,"builtins");var ue={__class__:o.type,__mro__:[l],$infos:{__module__:"builtins",__name__:"tuple"},$is_class:!0,$native:!0},me=n.make_iterator_class("tuple_iterator");for(var ne in ue.__iter__=function(W){return me.$factory(W)},ue.$factory=function(){var W=M.$factory(...arguments);return W.__class__=ue,W},n.fast_tuple=function(W){return W.__class__=ue,W.__brython__=!0,W.__dict__=n.empty_dict(),W},M)switch(ne){case"__delitem__":case"__iadd__":case"__imul__":case"__setitem__":case"append":case"extend":case"insert":case"remove":case"reverse":break;default:void 0===ue[ne]&&"function"==typeof M[ne]&&(ue[ne]=function(W){return function(){return M[W].apply(null,arguments)}}(ne))}ue.__eq__=function(ie,W){return void 0===W?ie===ue:M.__eq__(ie,W)},ue.__hash__=function(ie){for(var W,Q=54880137,A=0,R=ie.length;A<R;A++){var X=o.hash(ie[A]);W=Q,s=(parseInt(1000003)*W&4294967295).toString(16),Q=parseInt(s.substr(0,s.length-1),16)^4294967295&X}return Q},ue.__init__=function(){return D},ue.__new__=function(ie,...W){if(void 0===ie)throw o.TypeError.$factory("list.__new__(): not enough arguments");var Q=[];Q.__class__=ie,Q.__brython__=!0,Q.__dict__=n.empty_dict();for(var A=n.$iter(W[0]),R=n.$call(x(A,"__next__"));;)try{var X=R();Q.push(X)}catch(he){if(he.__class__===o.StopIteration)break;throw he}return Q},n.set_func_names(ue,"builtins"),o.list=M,o.tuple=ue,o.object.__bases__=ue.$factory()}(__BRYTHON__);var $B=__BRYTHON__;for(var gc in $B.unicode={Cc:[[0,32],[127,33]],Zs:[32,160,5760,6158,[8192,11],8239,8287,12288],Po:[[33,3],[37,3],[42,3,2],47,58,59,63,64,92,161,183,191,894,903,[1370,6],1417,[1472,3,3],1523,1524,1545,1546,1548,1549,1563,1566,1567,[1642,4],1748,[1792,14],[2039,3],[2096,15],2404,2405,2416,3572,3663,3674,3675,[3844,15],3973,[4048,5],[4170,6],4347,[4961,8],5741,5742,[5867,3],5941,5942,[6100,3],[6104,3],[6144,6],[6151,4],6468,6469,6622,6623,6686,6687,[6816,7],[6824,6],[7002,7],[7227,5],7294,7295,7379,8214,8215,[8224,8],[8240,9],[8251,4],[8257,3],[8263,11],8275,[8277,10],[11513,4],11518,11519,11776,11777,[11782,3],11787,[11790,9],11800,11801,11803,11806,11807,[11818,5],11824,11825,[12289,3],12349,12539,42238,42239,[42509,3],42611,42622,[42738,6],[43124,4],43214,43215,[43256,3],43310,43311,43359,[43457,13],43486,43487,[43612,4],43742,43743,44011,[65040,7],65049,65072,65093,65094,[65097,4],[65104,3],[65108,4],[65119,3],65128,65130,65131,[65281,3],[65285,3],[65290,3,2],65295,65306,65307,65311,65312,65340,65377,65380,65381,65792,65793,66463,66512,67671,67871,67903,[68176,9],68223,[68409,7],69819,69820,[69822,4],[74864,4]],Sc:[36,[162,4],1547,2546,2547,2555,2801,3065,3647,6107,[8352,25],43064,65020,65129,65284,65504,65505,65509,65510],Ps:[40,91,123,3898,3900,5787,8218,8222,8261,8317,8333,9001,[10088,7,2],10181,[10214,5,2],[10627,11,2],10712,10714,10748,[11810,4,2],[12296,5,2],[12308,4,2],12317,64830,65047,[65077,8,2],65095,[65113,3,2],65288,65339,65371,65375,65378],Pe:[41,93,125,3899,3901,5788,8262,8318,8334,9002,[10089,7,2],10182,[10215,5,2],[10628,11,2],10713,10715,10749,[11811,4,2],[12297,5,2],[12309,4,2],12318,12319,64831,65048,[65078,8,2],65096,[65114,3,2],65289,65341,[65373,3,3]],Sm:[43,[60,3],124,126,172,177,215,247,1014,[1542,3],8260,8274,[8314,3],[8330,3],[8512,5],8523,[8592,5],8602,8603,[8608,3,3],8622,8654,8655,8658,8660,[8692,268],[8968,4],8992,8993,9084,[9115,25],[9180,6],9655,9665,[9720,8],9839,[10176,5],[10183,4],10188,[10192,22],[10224,16],[10496,131],[10649,63],[10716,32],[10750,258],[11056,21],[11079,6],64297,65122,[65124,3],65291,[65308,3],65372,65374,65506,[65513,4],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771],Pd:[45,1418,1470,5120,6150,[8208,6],11799,11802,12316,12336,12448,65073,65074,65112,65123,65293],Nd:[[48,10],[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2662,10],[2790,10],[2918,10],[3046,10],[3174,10],[3302,10],[3430,10],[3664,10],[3792,10],[3872,10],[4160,10],[4240,10],[6112,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],[42528,10],[43216,10],[43264,10],[43472,10],[43600,10],[44016,10],[65296,10],[66720,10],[120782,50]],Lu:[[65,26],[192,23],[216,7],[256,28,2],[313,8,2],[330,24,2],[377,3,2],385,[386,3,2],391,[393,3],[398,4],403,404,[406,3],412,413,415,[416,4,2],423,425,428,430,431,[433,3],437,439,440,444,[452,4,3],[463,7,2],[478,9,2],497,500,[502,3],[506,29,2],570,571,573,574,577,[579,4],[584,4,2],880,882,886,902,[904,3],908,910,911,[913,17],[931,9],975,[978,3],[984,12,2],1012,1015,1017,1018,[1021,51],[1120,17,2],[1162,28,2],[1217,7,2],[1232,43,2],[1329,38],[4256,38],[7680,75,2],[7838,49,2],[7944,8],[7960,6],[7976,8],[7992,8],[8008,6],[8025,4,2],[8040,8],[8120,4],[8136,4],[8152,4],[8168,5],[8184,4],8450,8455,[8459,3],[8464,3],8469,[8473,5],[8484,4,2],[8491,3],[8496,4],8510,8511,8517,8579,[11264,47],11360,[11362,3],[11367,4,2],[11374,3],11378,11381,[11390,3],[11394,49,2],11499,11501,[42560,16,2],[42594,6,2],[42624,12,2],[42786,7,2],[42802,31,2],[42873,3,2],[42878,5,2],42891,[65313,26],[66560,40],[119808,26],[119860,26],[119912,26],119964,119966,[119967,3,3],119974,[119977,4],[119982,8],[120016,26],120068,120069,[120071,4],[120077,8],[120086,7],120120,120121,[120123,4],[120128,5],120134,[120138,7],[120172,26],[120224,26],[120276,26],[120328,26],[120380,26],[120432,26],[120488,25],[120546,25],[120604,25],[120662,25],[120720,25],120778],Sk:[94,96,168,175,180,184,[706,4],[722,14],[741,7],749,[751,17],885,900,901,8125,[8127,3],[8141,3],[8157,3],[8173,3],8189,8190,12443,12444,[42752,23],42784,42785,42889,42890,65342,65344,65507],Pc:[95,8255,8256,8276,65075,65076,[65101,3],65343],Ll:[[97,26],170,181,186,[223,24],[248,8],[257,28,2],[312,9,2],[329,24,2],[378,3,2],383,384,387,389,392,396,397,402,405,[409,3],414,[417,3,2],424,426,427,429,432,436,438,441,442,[445,3],[454,3,3],[462,8,2],[477,10,2],496,499,501,[505,30,2],[564,6],572,575,576,578,[583,5,2],[592,68],[661,27],881,[883,3,4],892,893,912,[940,35],976,977,[981,3],[985,12,2],[1008,4],[1013,3,3],1020,[1072,48],[1121,17,2],[1163,27,2],[1218,7,2],[1231,44,2],[1377,39],[7424,44],[7522,22],[7545,34],[7681,75,2],[7830,8],[7839,49,2],[7936,8],[7952,6],[7968,8],[7984,8],[8e3,6],[8016,8],[8032,8],[8048,14],[8064,8],[8080,8],[8096,8],[8112,5],8118,8119,8126,[8130,3],8134,8135,[8144,4],8150,8151,[8160,8],[8178,3],8182,8183,8458,8462,8463,8467,[8495,3,5],8508,8509,[8518,4],8526,8580,[11312,47],11361,11365,[11366,4,2],11377,11379,11380,[11382,7],[11393,50,2],11492,11500,11502,[11520,38],[42561,16,2],[42595,6,2],[42625,12,2],[42787,7,2],42800,[42801,33,2],[42866,7],42874,42876,[42879,5,2],42892,[64256,7],[64275,5],[65345,26],[66600,40],[119834,26],[119886,7],[119894,18],[119938,26],[119990,4],119995,[119997,7],[120005,11],[120042,26],[120094,26],[120146,26],[120198,26],[120250,26],[120302,26],[120354,26],[120406,26],[120458,28],[120514,25],[120540,6],[120572,25],[120598,6],[120630,25],[120656,6],[120688,25],[120714,6],[120746,25],[120772,6],120779],So:[166,167,169,174,176,182,1154,1550,1551,1769,1789,1790,2038,2554,2928,[3059,6],3066,3199,3313,3314,3449,[3841,3],[3859,5],[3866,6],[3892,3,2],[4030,8],[4039,6],4046,4047,[4053,4],4254,4255,4960,[5008,10],6464,[6624,32],[7009,10],[7028,9],8448,8449,[8451,4],8456,8457,8468,[8470,3],[8478,6],[8485,3,2],8494,8506,8507,8522,8524,8525,8527,[8597,5],[8604,4],8609,8610,8612,8613,[8615,7],[8623,31],8656,[8657,3,2],[8662,30],[8960,8],[8972,20],[8994,7],[9003,81],[9085,30],[9140,40],[9186,7],[9216,39],[9280,11],[9372,78],[9472,183],[9656,9],[9666,54],[9728,111],[9840,94],[9935,19],9955,[9960,24],[9985,4],[9990,4],[9996,28],[10025,35],10061,[10063,4],[10070,9],[10081,7],10132,[10136,24],[10161,14],[10240,256],[11008,48],11077,11078,[11088,10],[11493,6],[11904,26],[11931,89],[12032,214],[12272,12],12292,12306,12307,12320,12342,12343,12350,12351,12688,12689,[12694,10],[12736,36],[12800,31],[12842,39],[12896,32],[12938,39],[12992,63],[13056,256],[19904,64],[42128,55],[43048,4],43062,43063,43065,[43639,3],65021,65508,65512,65517,65518,65532,65533,65794,[65847,9],[65913,17],[65936,12],[66e3,45],[118784,246],[119040,39],[119081,60],[119146,3],119171,119172,[119180,30],[119214,48],[119296,66],119365,[119552,87],[126976,44],[127024,100],[127248,31],127281,127293,127295,[127298,3,4],[127307,4],127319,127327,127353,127355,127356,127359,[127370,4],127376,127488,[127504,34],[127552,9]],Pi:[171,8216,8219,8220,8223,8249,11778,11780,11785,11788,11804,11808],Cf:[173,[1536,4],1757,1807,6068,6069,[8203,5],[8234,5],[8288,5],[8298,6],65279,[65529,3],69821,[119155,8],917505,[917536,96]],No:[178,179,185,[188,3],[2548,6],[3056,3],[3192,7],[3440,6],[3882,10],[4969,20],[6128,10],8304,[8308,6],[8320,10],[8528,16],8585,[9312,60],[9450,22],[10102,30],11517,[12690,4],[12832,10],[12881,15],[12928,10],[12977,15],[43056,6],[65799,45],[65909,4],65930,[66336,4],[67672,8],[67862,6],[68160,8],68221,68222,[68440,8],[68472,8],[69216,31],[119648,18],[127232,11]],Pf:[187,8217,8221,8250,11779,11781,11786,11789,11805,11809],Lo:[443,[448,4],660,[1488,27],[1520,3],[1569,31],[1601,10],1646,1647,[1649,99],1749,1774,1775,[1786,3],1791,1808,[1810,30],[1869,89],1969,[1994,33],[2048,22],[2308,54],2365,2384,[2392,10],2418,[2425,7],[2437,8],2447,2448,[2451,22],[2474,7],2482,[2486,4],2493,2510,2524,2525,[2527,3],2544,2545,[2565,6],2575,2576,[2579,22],[2602,7],2610,2611,2613,2614,2616,2617,[2649,4],2654,[2674,3],[2693,9],[2703,3],[2707,22],[2730,7],2738,2739,[2741,5],2749,2768,2784,2785,[2821,8],2831,2832,[2835,22],[2858,7],2866,2867,[2869,5],2877,2908,2909,[2911,3],2929,2947,[2949,6],[2958,3],[2962,4],2969,[2970,3,2],2975,2979,2980,[2984,3],[2990,12],3024,[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,3160,3161,3168,3169,[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3261,3294,3296,3297,[3333,8],[3342,3],[3346,23],[3370,16],3389,3424,3425,[3450,6],[3461,18],[3482,24],[3507,9],3517,[3520,7],[3585,48],3634,3635,[3648,6],3713,3714,3716,3719,3720,3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,3754,3755,[3757,4],3762,3763,3773,[3776,5],3804,3805,3840,[3904,8],[3913,36],[3976,4],[4096,43],4159,[4176,6],[4186,4],4193,4197,4198,[4206,3],[4213,13],4238,[4304,43],[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5888,13],[5902,4],[5920,18],[5952,18],[5984,13],[5998,3],[6016,52],6108,[6176,35],[6212,52],[6272,41],6314,[6320,70],[6400,29],[6480,30],[6512,5],[6528,44],[6593,7],[6656,23],[6688,53],[6917,47],[6981,7],[7043,30],7086,7087,[7168,36],[7245,3],[7258,30],[7401,4],[7406,4],[8501,4],[11568,54],[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],12294,12348,[12353,86],12447,[12449,90],12543,[12549,41],[12593,94],[12704,24],[12784,16],13312,19893,19968,40907,[40960,21],[40982,1143],[42192,40],[42240,268],[42512,16],42538,42539,42606,[42656,70],[43003,7],[43011,3],[43015,4],[43020,23],[43072,52],[43138,50],[43250,6],43259,[43274,28],[43312,23],[43360,29],[43396,47],[43520,41],[43584,3],[43588,8],[43616,16],[43633,6],43642,[43648,48],43697,43701,43702,[43705,5],43712,43714,43739,43740,[43968,35],44032,55203,[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],64285,[64287,10],[64298,13],[64312,5],64318,64320,64321,64323,64324,[64326,108],[64467,363],[64848,64],[64914,54],[65008,12],[65136,5],[65142,135],[65382,10],[65393,45],[65440,31],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],65596,65597,[65599,15],[65616,14],[65664,123],[66176,29],[66208,49],[66304,31],[66352,17],[66370,8],[66432,30],[66464,36],[66504,8],[66640,78],[67584,6],67592,[67594,44],67639,67640,67644,[67647,23],[67840,22],[67872,26],68096,[68112,4],[68117,3],[68121,27],[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69763,45],[73728,879],[77824,1071],131072,173782,173824,177972,[194560,542]],Lt:[[453,3,3],498,[8072,8],[8088,8],[8104,8],8124,8140,8188],Lm:[[688,18],[710,12],[736,5],748,750,884,890,1369,1600,1765,1766,2036,2037,2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,6],[7468,54],7544,[7579,37],8305,8319,[8336,5],11389,11631,11823,12293,[12337,5],12347,12445,12446,[12540,3],40981,[42232,6],42508,42623,[42775,9],42864,42888,43471,43632,43741,65392,65438,65439],Mn:[[768,112],[1155,5],[1425,45],1471,1473,1474,1476,1477,1479,[1552,11],[1611,20],1648,[1750,7],[1759,6],1767,1768,[1770,4],1809,[1840,27],[1958,11],[2027,9],[2070,4],[2075,9],[2085,3],[2089,5],[2304,3],2364,[2369,8],2381,[2385,5],2402,2403,2433,2492,[2497,4],2509,2530,2531,2561,2562,2620,2625,2626,2631,2632,[2635,3],2641,2672,2673,2677,2689,2690,2748,[2753,5],2759,2760,2765,2786,2787,2817,2876,2879,[2881,4],2893,2902,2914,2915,2946,3008,3021,[3134,3],[3142,3],[3146,4],3157,3158,3170,3171,3260,3263,3270,3276,3277,3298,3299,[3393,4],3405,3426,3427,3530,[3538,3],3542,3633,[3636,7],[3655,8],3761,[3764,6],3771,3772,[3784,6],3864,3865,[3893,3,2],[3953,14],[3968,5],3974,3975,[3984,8],[3993,36],4038,[4141,4],[4146,6],4153,4154,4157,4158,4184,4185,[4190,3],[4209,4],4226,4229,4230,4237,4253,4959,[5906,3],[5938,3],5970,5971,6002,6003,[6071,7],6086,[6089,11],6109,[6155,3],6313,[6432,3],6439,6440,6450,[6457,3],6679,6680,6742,[6744,7],6752,6754,[6757,8],[6771,10],6783,[6912,4],6964,[6966,5],6972,6978,[7019,9],7040,7041,[7074,4],7080,7081,[7212,8],7222,7223,[7376,3],[7380,13],[7394,7],7405,[7616,39],[7677,3],[8400,13],8417,[8421,12],[11503,3],[11744,32],[12330,6],12441,12442,42607,42620,42621,42736,42737,43010,43014,43019,43045,43046,43204,[43232,18],[43302,8],[43335,11],[43392,3],43443,[43446,4],43452,[43561,6],43569,43570,43573,43574,43587,43596,43696,[43698,3],43703,43704,43710,43711,43713,44005,44008,44013,64286,[65024,16],[65056,7],66045,[68097,3],68101,68102,[68108,4],[68152,3],68159,69760,69761,[69811,4],69817,69818,[119143,3],[119163,8],[119173,7],[119210,4],[119362,3],[917760,240]],Me:[1160,1161,1758,[8413,4],[8418,3],[42608,3]],Mc:[2307,[2366,3],[2377,4],2382,2434,2435,[2494,3],2503,2504,2507,2508,2519,2563,[2622,3],2691,[2750,3],2761,2763,2764,2818,2819,2878,2880,2887,2888,2891,2892,2903,3006,3007,3009,3010,[3014,3],[3018,3],3031,[3073,3],[3137,4],3202,3203,3262,[3264,5],3271,3272,3274,3275,3285,3286,3330,3331,[3390,3],[3398,3],[3402,3],3415,3458,3459,[3535,3],[3544,8],3570,3571,3902,3903,3967,4139,4140,4145,4152,4155,4156,4182,4183,[4194,3],[4199,7],4227,4228,[4231,6],4239,[4250,3],6070,[6078,8],6087,6088,[6435,4],[6441,3],6448,6449,[6451,6],[6576,17],6600,6601,[6681,3],6741,6743,6753,6755,6756,[6765,6],6916,6965,6971,[6973,5],6979,6980,7042,7073,7078,7079,7082,[7204,8],7220,7221,7393,7410,43043,43044,43047,43136,43137,[43188,16],43346,43347,43395,43444,43445,43450,43451,[43453,4],43567,43568,43571,43572,43597,43643,44003,44004,44006,44007,44009,44010,44012,69762,[69808,3],69815,69816,119141,119142,[119149,6]],Nl:[[5870,3],[8544,35],[8581,4],12295,[12321,9],[12344,3],[42726,10],[65856,53],66369,66378,[66513,5],[74752,99]],Zl:[8232],Zp:[8233],Cs:[55296,56191,56192,56319,56320,57343],Co:[57344,63743,983040,1048573,1048576,1114109],digits:[[48,10],178,179,185,[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2662,10],[2790,10],[2918,10],[3046,10],[3174,10],[3302,10],[3430,10],[3558,10],[3664,10],[3792,10],[3872,10],[4160,10],[4240,10],[4969,9],[6112,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],8304,[8308,6],[8320,10],[9312,9],[9332,9],[9352,9],9450,[9461,9],9471,[10102,9],[10112,9],[10122,9],[42528,10],[43216,10],[43264,10],[43472,10],[43504,10],[43600,10],[44016,10],[65296,10],[66720,10],[68160,4],[68912,10],[69216,9],[69714,9],[69734,10],[69872,10],[69942,10],[70096,10],[70384,10],[70736,10],[70864,10],[71248,10],[71360,10],[71472,10],[71904,10],[72784,10],[73040,10],[73120,10],[92768,10],[93008,10],[120782,50],[123200,10],[123632,10],[125264,10],[127232,11]],numeric:[[48,10],178,179,185,[188,3],[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2548,6],[2662,10],[2790,10],[2918,10],[2930,6],[3046,13],[3174,10],[3192,7],[3302,10],[3416,7],[3430,19],[3558,10],[3664,10],[3792,10],[3872,20],[4160,10],[4240,10],[4969,20],[5870,3],[6112,10],[6128,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],8304,[8308,6],[8320,10],[8528,51],[8581,5],[9312,60],[9450,22],[10102,30],11517,12295,[12321,9],[12344,3],[12690,4],[12832,10],[12872,8],[12881,15],[12928,10],[12977,15],13317,13443,14378,15181,19968,19971,19975,19977,20061,20108,20116,20118,20159,20160,20191,20200,20237,20336,20740,20806,[20841,3,2],21313,[21315,3],21324,[21441,4],22235,22769,22777,24186,24318,24319,[24332,3],24336,25342,25420,26578,28422,29590,30334,32902,33836,36014,36019,36144,38433,38470,38476,38520,38646,[42528,10],[42726,10],[43056,6],[43216,10],[43264,10],[43472,10],[43504,10],[43600,10],[44016,10],63851,63859,63864,63922,63953,63955,63997,[65296,10],[65799,45],[65856,57],65930,65931,[66273,27],[66336,4],66369,66378,[66513,5],[66720,10],[67672,8],[67705,7],[67751,9],[67835,5],[67862,6],68028,68029,[68032,16],[68050,46],[68160,9],68221,68222,[68253,3],[68331,5],[68440,8],[68472,8],[68521,7],[68858,6],[68912,10],[69216,31],[69405,10],[69457,4],[69714,30],[69872,10],[69942,10],[70096,10],[70113,20],[70384,10],[70736,10],[70864,10],[71248,10],[71360,10],[71472,12],[71904,19],[72784,29],[73040,10],[73120,10],[73664,21],[74752,111],[92768,10],[93008,10],[93019,7],[93824,23],[119520,20],[119648,25],[120782,50],[123200,10],[123632,10],[125127,9],[125264,10],[126065,59],[126125,3],[126129,4],[126209,45],[126255,15],[127232,13],131073,131172,131298,131361,133418,133507,133516,133532,133866,133885,133913,140176,141720,146203,156269,194704],Cn:[[888,2],[896,4],[907,1],[909,1],[930,1],[1328,1],[1367,2],[1419,2],[1424,1],[1480,8],[1515,4],[1525,11],[1565,1],[1806,1],[1867,2],[1970,14],[2043,2],[2094,2],[2111,1],[2140,2],[2143,1],[2155,53],[2229,1],[2238,21],[2436,1],[2445,2],[2449,2],[2473,1],[2481,1],[2483,3],[2490,2],[2501,2],[2505,2],[2511,8],[2520,4],[2526,1],[2532,2],[2559,2],[2564,1],[2571,4],[2577,2],[2601,1],[2609,1],[2612,1],[2615,1],[2618,2],[2621,1],[2627,4],[2633,2],[2638,3],[2642,7],[2653,1],[2655,7],[2679,10],[2692,1],[2702,1],[2706,1],[2729,1],[2737,1],[2740,1],[2746,2],[2758,1],[2762,1],[2766,2],[2769,15],[2788,2],[2802,7],[2816,1],[2820,1],[2829,2],[2833,2],[2857,1],[2865,1],[2868,1],[2874,2],[2885,2],[2889,2],[2894,8],[2904,4],[2910,1],[2916,2],[2936,10],[2948,1],[2955,3],[2961,1],[2966,3],[2971,1],[2973,1],[2976,3],[2981,3],[2987,3],[3002,4],[3011,3],[3017,1],[3022,2],[3025,6],[3032,14],[3067,5],[3085,1],[3089,1],[3113,1],[3130,3],[3141,1],[3145,1],[3150,7],[3159,1],[3163,5],[3172,2],[3184,7],[3213,1],[3217,1],[3241,1],[3252,1],[3258,2],[3269,1],[3273,1],[3278,7],[3287,7],[3295,1],[3300,2],[3312,1],[3315,13],[3332,1],[3341,1],[3345,1],[3397,1],[3401,1],[3408,4],[3428,2],[3456,2],[3460,1],[3479,3],[3506,1],[3516,1],[3518,2],[3527,3],[3531,4],[3541,1],[3543,1],[3552,6],[3568,2],[3573,12],[3643,4],[3676,37],[3715,1],[3717,1],[3723,1],[3748,1],[3750,1],[3774,2],[3781,1],[3783,1],[3790,2],[3802,2],[3808,32],[3912,1],[3949,4],[3992,1],[4029,1],[4045,1],[4059,37],[4294,1],[4296,5],[4302,2],[4681,1],[4686,2],[4695,1],[4697,1],[4702,2],[4745,1],[4750,2],[4785,1],[4790,2],[4799,1],[4801,1],[4806,2],[4823,1],[4881,1],[4886,2],[4955,2],[4989,3],[5018,6],[5110,2],[5118,2],[5789,3],[5881,7],[5901,1],[5909,11],[5943,9],[5972,12],[5997,1],[6001,1],[6004,12],[6110,2],[6122,6],[6138,6],[6159,1],[6170,6],[6265,7],[6315,5],[6390,10],[6431,1],[6444,4],[6460,4],[6465,3],[6510,2],[6517,11],[6572,4],[6602,6],[6619,3],[6684,2],[6751,1],[6781,2],[6794,6],[6810,6],[6830,2],[6847,65],[6988,4],[7037,3],[7156,8],[7224,3],[7242,3],[7305,7],[7355,2],[7368,8],[7419,5],[7674,1],[7958,2],[7966,2],[8006,2],[8014,2],[8024,1],[8026,1],[8028,1],[8030,1],[8062,2],[8117,1],[8133,1],[8148,2],[8156,1],[8176,2],[8181,1],[8191,1],[8293,1],[8306,2],[8335,1],[8349,3],[8384,16],[8433,15],[8588,4],[9255,25],[9291,21],[11124,2],[11158,2],[11311,1],[11359,1],[11508,5],[11558,1],[11560,5],[11566,2],[11624,7],[11633,14],[11671,9],[11687,1],[11695,1],[11703,1],[11711,1],[11719,1],[11727,1],[11735,1],[11743,1],[11856,48],[11930,1],[12020,12],[12246,26],[12284,4],[12352,1],[12439,2],[12544,5],[12592,1],[12687,1],[12731,5],[12772,12],[12831,1],[19894,10],[40944,16],[42125,3],[42183,9],[42540,20],[42744,8],[42944,2],[42951,48],[43052,4],[43066,6],[43128,8],[43206,8],[43226,6],[43348,11],[43389,3],[43470,1],[43482,4],[43519,1],[43575,9],[43598,2],[43610,2],[43715,24],[43767,10],[43783,2],[43791,2],[43799,9],[43815,1],[43823,1],[43880,8],[44014,2],[44026,6],[55204,12],[55239,4],[55292,4],[64110,2],[64218,38],[64263,12],[64280,5],[64311,1],[64317,1],[64319,1],[64322,1],[64325,1],[64450,17],[64832,16],[64912,2],[64968,40],[65022,2],[65050,6],[65107,1],[65127,1],[65132,4],[65141,1],[65277,2],[65280,1],[65471,3],[65480,2],[65488,2],[65496,2],[65501,3],[65511,1],[65519,10],[65534,2],[65548,1],[65575,1],[65595,1],[65598,1],[65614,2],[65630,34],[65787,5],[65795,4],[65844,3],[65935,1],[65948,4],[65953,47],[66046,130],[66205,3],[66257,15],[66300,4],[66340,9],[66379,5],[66427,5],[66462,1],[66500,4],[66518,42],[66718,2],[66730,6],[66772,4],[66812,4],[66856,8],[66916,11],[66928,144],[67383,9],[67414,10],[67432,152],[67590,2],[67593,1],[67638,1],[67641,3],[67645,2],[67670,1],[67743,8],[67760,48],[67827,1],[67830,5],[67868,3],[67898,5],[67904,64],[68024,4],[68048,2],[68100,1],[68103,5],[68116,1],[68120,1],[68150,2],[68155,4],[68169,7],[68185,7],[68256,32],[68327,4],[68343,9],[68406,3],[68438,2],[68467,5],[68498,7],[68509,12],[68528,80],[68681,55],[68787,13],[68851,7],[68904,8],[68922,294],[69247,129],[69416,8],[69466,134],[69623,9],[69710,4],[69744,15],[69826,11],[69838,2],[69865,7],[69882,6],[69941,1],[69959,9],[70007,9],[70094,2],[70112,1],[70133,11],[70162,1],[70207,65],[70279,1],[70281,1],[70286,1],[70302,1],[70314,6],[70379,5],[70394,6],[70404,1],[70413,2],[70417,2],[70441,1],[70449,1],[70452,1],[70458,1],[70469,2],[70473,2],[70478,2],[70481,6],[70488,5],[70500,2],[70509,3],[70517,139],[70746,1],[70748,1],[70752,32],[70856,8],[70874,166],[71094,2],[71134,34],[71237,11],[71258,6],[71277,19],[71353,7],[71370,54],[71451,2],[71468,4],[71488,192],[71740,100],[71923,12],[71936,160],[72104,2],[72152,2],[72165,27],[72264,8],[72355,29],[72441,263],[72713,1],[72759,1],[72774,10],[72813,3],[72848,2],[72872,1],[72887,73],[72967,1],[72970,1],[73015,3],[73019,1],[73022,1],[73032,8],[73050,6],[73062,1],[73065,1],[73103,1],[73106,1],[73113,7],[73130,310],[73465,199],[73714,13],[74650,102],[74863,1],[74869,11],[75076,2748],[78895,1],[78905,4039],[83527,8633],[92729,7],[92767,1],[92778,4],[92784,96],[92910,2],[92918,10],[92998,10],[93018,1],[93026,1],[93048,5],[93072,688],[93851,101],[94027,4],[94088,7],[94112,64],[94180,28],[100344,8],[101107,9485],[110879,49],[110931,17],[110952,8],[111356,2308],[113771,5],[113789,3],[113801,7],[113818,2],[113828,4956],[119030,10],[119079,2],[119273,23],[119366,154],[119540,12],[119639,9],[119673,135],[119893,1],[119965,1],[119968,2],[119971,2],[119975,2],[119981,1],[119994,1],[119996,1],[120004,1],[120070,1],[120075,2],[120085,1],[120093,1],[120122,1],[120127,1],[120133,1],[120135,3],[120145,1],[120486,2],[120780,2],[121484,15],[121504,1],[121520,1360],[122887,1],[122905,2],[122914,1],[122917,1],[122923,213],[123181,3],[123198,2],[123210,4],[123216,368],[123642,5],[123648,1280],[125125,2],[125143,41],[125260,4],[125274,4],[125280,785],[126133,76],[126270,194],[126468,1],[126496,1],[126499,1],[126501,2],[126504,1],[126515,1],[126520,1],[126522,1],[126524,6],[126531,4],[126536,1],[126538,1],[126540,1],[126544,1],[126547,1],[126549,2],[126552,1],[126554,1],[126556,1],[126558,1],[126560,1],[126563,1],[126565,2],[126571,1],[126579,1],[126584,1],[126589,1],[126591,1],[126602,1],[126620,5],[126628,1],[126634,1],[126652,52],[126706,270],[127020,4],[127124,12],[127151,2],[127168,1],[127184,1],[127222,10],[127245,3],[127341,3],[127405,57],[127491,13],[127548,4],[127561,7],[127570,14],[127590,154],[128726,10],[128749,3],[128763,5],[128884,12],[128985,7],[129004,20],[129036,4],[129096,8],[129114,6],[129160,8],[129198,82],[129292,1],[129394,1],[129399,3],[129443,2],[129451,3],[129483,2],[129620,12],[129646,2],[129652,4],[129659,5],[129667,13],[129686,1386],[173783,41],[177973,11],[178206,2],[183970,14],[191457,3103],[195102,722403],[917506,30],[917632,128],[918e3,65040],[1048574,2]]},$B.unicode_casefold={223:[115,115],304:[105,775],329:[700,110],496:[106,780],912:[953,776,769],944:[965,776,769],1415:[1381,1410],7830:[104,817],7831:[116,776],7832:[119,778],7833:[121,778],7834:[97,702],7838:[223],8016:[965,787],8018:[965,787,768],8020:[965,787,769],8022:[965,787,834],8064:[7936,953],8065:[7937,953],8066:[7938,953],8067:[7939,953],8068:[7940,953],8069:[7941,953],8070:[7942,953],8071:[7943,953],8072:[8064],8073:[8065],8074:[8066],8075:[8067],8076:[8068],8077:[8069],8078:[8070],8079:[8071],8080:[7968,953],8081:[7969,953],8082:[7970,953],8083:[7971,953],8084:[7972,953],8085:[7973,953],8086:[7974,953],8087:[7975,953],8088:[8080],8089:[8081],8090:[8082],8091:[8083],8092:[8084],8093:[8085],8094:[8086],8095:[8087],8096:[8032,953],8097:[8033,953],8098:[8034,953],8099:[8035,953],8100:[8036,953],8101:[8037,953],8102:[8038,953],8103:[8039,953],8104:[8096],8105:[8097],8106:[8098],8107:[8099],8108:[8100],8109:[8101],8110:[8102],8111:[8103],8114:[8048,953],8115:[945,953],8116:[940,953],8118:[945,834],8119:[945,834,953],8124:[8115],8130:[8052,953],8131:[951,953],8132:[942,953],8134:[951,834],8135:[951,834,953],8140:[8131],8146:[953,776,768],8147:[953,776,769],8150:[953,834],8151:[953,776,834],8162:[965,776,768],8163:[965,776,769],8164:[961,787],8166:[965,834],8167:[965,776,834],8178:[8060,953],8179:[969,953],8180:[974,953],8182:[969,834],8183:[969,834,953],8188:[8179],64256:[102,102],64257:[102,105],64258:[102,108],64259:[102,102,105],64260:[102,102,108],64261:[115,116],64262:[115,116],64275:[1396,1398],64276:[1396,1381],64277:[1396,1387],64278:[1406,1398],64279:[1396,1389]},$B.unicode_bidi_whitespace=[9,10,11,12,13,28,29,30,31,32,133,5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8287,12288],$B.unicode_identifiers={XID_Start:[95,[65,26],[97,26],170,181,186,[192,23],[216,31],[248,458],[710,12],[736,5],748,750,[880,5],[886,2],[891,3],902,[904,3],908,[910,20],[931,83],[1015,139],[1162,156],[1329,38],1369,[1377,39],[1488,27],[1520,3],[1569,42],[1646,2],[1649,99],1749,[1765,2],[1774,2],[1786,3],1791,1808,[1810,30],[1869,89],1969,[1994,33],[2036,2],2042,[2048,22],2074,2084,2088,[2308,54],2365,2384,[2392,10],2417,2418,[2425,7],[2437,8],[2447,2],[2451,22],[2474,7],2482,[2486,4],2493,2510,[2524,2],[2527,3],[2544,2],[2565,6],[2575,2],[2579,22],[2602,7],[2610,2],[2613,2],[2616,2],[2649,4],2654,[2674,3],[2693,9],[2703,3],[2707,22],[2730,7],[2738,2],[2741,5],2749,2768,[2784,2],[2821,8],[2831,2],[2835,22],[2858,7],[2866,2],[2869,5],2877,[2908,2],[2911,3],2929,2947,[2949,6],[2958,3],[2962,4],[2969,2],2972,[2974,2],[2979,2],[2984,3],[2990,12],3024,[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,[3160,2],[3168,2],[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3261,3294,[3296,2],[3333,8],[3342,3],[3346,23],[3370,16],3389,[3424,2],[3450,6],[3461,18],[3482,24],[3507,9],3517,[3520,7],[3585,48],3634,[3648,7],[3713,2],3716,[3719,2],3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,[3754,2],[3757,4],3762,3773,[3776,5],3782,[3804,2],3840,[3904,8],[3913,36],[3976,4],[4096,43],4159,[4176,6],[4186,4],4193,[4197,2],[4206,3],[4213,13],4238,[4256,38],[4304,43],4348,[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5870,3],[5888,13],[5902,4],[5920,18],[5952,18],[5984,13],[5998,3],[6016,52],6103,6108,[6176,88],[6272,41],6314,[6320,70],[6400,29],[6480,30],[6512,5],[6528,44],[6593,7],[6656,23],[6688,53],6823,[6917,47],[6981,7],[7043,30],[7086,2],[7168,36],[7245,3],[7258,36],[7401,4],[7406,4],[7424,192],[7680,278],[7960,6],[7968,38],[8008,6],[8016,8],8025,8027,8029,[8031,31],[8064,53],[8118,7],8126,[8130,3],[8134,7],[8144,4],[8150,6],[8160,13],[8178,3],[8182,7],8305,8319,[8336,5],8450,8455,[8458,10],8469,8472,[8473,5],8484,8486,8488,[8490,16],[8508,4],[8517,5],8526,[8544,41],[11264,47],[11312,47],[11360,133],[11499,4],[11520,38],[11568,54],11631,[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],12293,12294,12295,[12321,9],[12337,5],[12344,5],[12353,86],[12445,3],[12449,90],[12540,4],[12549,41],[12593,94],[12704,24],[12784,16],[13312,6582],[19968,20940],[40960,1165],[42192,46],[42240,269],[42512,16],[42538,2],[42560,32],[42594,13],42623,[42624,24],[42656,80],[42775,9],[42786,103],[42891,2],[43003,7],[43011,3],[43015,4],[43020,23],[43072,52],[43138,50],[43250,6],43259,[43274,28],[43312,23],[43360,29],[43396,47],43471,[43520,41],[43584,3],[43588,8],[43616,23],43642,[43648,48],43697,[43701,2],[43705,5],43712,43714,[43739,3],[43968,35],[44032,11172],[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],[64256,7],[64275,5],64285,[64287,10],[64298,13],[64312,5],64318,[64320,2],[64323,2],[64326,108],[64467,139],[64612,218],[64848,64],[64914,54],[65008,10],65137,65139,65143,65145,65147,65149,[65151,126],[65313,26],[65345,26],[65382,56],[65440,31],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],[65596,2],[65599,15],[65616,14],[65664,123],[65856,53],[66176,29],[66208,49],[66304,31],[66352,27],[66432,30],[66464,36],[66504,8],[66513,5],[66560,158],[67584,6],67592,[67594,44],[67639,2],67644,[67647,23],[67840,22],[67872,26],68096,[68112,4],[68117,3],[68121,27],[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69763,45],[73728,879],[74752,99],[77824,1071],[119808,85],[119894,71],[119966,2],119970,[119973,2],[119977,4],[119982,12],119995,[119997,7],[120005,65],[120071,4],[120077,8],[120086,7],[120094,28],[120123,4],[120128,5],120134,[120138,7],[120146,340],[120488,25],[120514,25],[120540,31],[120572,25],[120598,31],[120630,25],[120656,31],[120688,25],[120714,31],[120746,25],[120772,8],[131072,42711],[173824,4149],[194560,542]],XID_Continue:[[48,10],[65,26],95,[97,26],170,181,183,186,[192,23],[216,31],[248,458],[710,12],[736,5],748,750,[768,117],[886,2],[891,3],902,903,[904,3],908,[910,20],[931,83],[1015,139],[1155,5],[1162,156],[1329,38],1369,[1377,39],[1425,45],1471,[1473,2],[1476,2],1479,[1488,27],[1520,3],[1552,11],[1569,62],[1632,10],[1646,102],1749,[1750,7],[1759,10],[1770,19],1791,1808,1809,[1810,57],[1869,101],[1984,54],2042,[2048,46],[2304,58],2364,2365,[2366,17],2384,[2385,5],[2392,12],[2406,10],2417,2418,[2425,7],2433,[2434,2],[2437,8],[2447,2],[2451,22],[2474,7],2482,[2486,4],2492,2493,[2494,7],[2503,2],[2507,4],2519,[2524,2],[2527,5],[2534,12],[2561,3],[2565,6],[2575,2],[2579,22],[2602,7],[2610,2],[2613,2],[2616,2],2620,[2622,5],[2631,2],[2635,3],2641,[2649,4],2654,[2662,16],[2689,3],[2693,9],[2703,3],[2707,22],[2730,7],[2738,2],[2741,5],2748,2749,[2750,8],[2759,3],[2763,3],2768,[2784,4],[2790,10],2817,[2818,2],[2821,8],[2831,2],[2835,22],[2858,7],[2866,2],[2869,5],2876,2877,2878,2879,2880,[2881,4],[2887,2],[2891,3],2902,2903,[2908,2],[2911,5],[2918,10],2929,2946,2947,[2949,6],[2958,3],[2962,4],[2969,2],2972,[2974,2],[2979,2],[2984,3],[2990,12],[3006,5],[3014,3],[3018,4],3024,3031,[3046,10],[3073,3],[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,[3134,7],[3142,3],[3146,4],[3157,2],[3160,2],[3168,4],[3174,10],[3202,2],[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3260,3261,3262,3263,[3264,5],3270,[3271,2],[3274,4],[3285,2],3294,[3296,4],[3302,10],[3330,2],[3333,8],[3342,3],[3346,23],[3370,16],3389,[3390,7],[3398,3],[3402,4],3415,[3424,4],[3430,10],[3450,6],[3458,2],[3461,18],[3482,24],[3507,9],3517,[3520,7],3530,[3535,6],3542,[3544,8],[3570,2],[3585,58],[3648,15],[3664,10],[3713,2],3716,[3719,2],3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,[3754,2],[3757,13],[3771,3],[3776,5],3782,[3784,6],[3792,10],[3804,2],3840,[3864,2],[3872,10],3893,3895,3897,[3902,10],[3913,36],[3953,20],[3974,6],[3984,8],[3993,36],4038,[4096,74],[4176,78],[4256,38],[4304,43],4348,[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],4959,[4969,9],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5870,3],[5888,13],[5902,7],[5920,21],[5952,20],[5984,13],[5998,3],[6002,2],[6016,52],6070,[6071,29],6103,6108,6109,[6112,10],[6155,3],[6160,10],[6176,88],[6272,43],[6320,70],[6400,29],[6432,12],[6448,12],[6470,40],[6512,5],[6528,44],[6576,26],[6608,11],[6656,28],[6688,63],6752,6753,6754,[6755,26],6783,[6784,10],[6800,10],6823,[6912,76],[6992,10],[7019,9],[7040,43],[7086,12],[7168,56],[7232,10],[7245,49],[7376,3],[7380,31],[7424,231],[7677,281],[7960,6],[7968,38],[8008,6],[8016,8],8025,8027,8029,[8031,31],[8064,53],[8118,7],8126,[8130,3],[8134,7],[8144,4],[8150,6],[8160,13],[8178,3],[8182,7],[8255,2],8276,8305,8319,[8336,5],[8400,13],8417,[8421,12],8450,8455,[8458,10],8469,8472,[8473,5],8484,8486,8488,[8490,16],[8508,4],[8517,5],8526,[8544,41],[11264,47],[11312,47],[11360,133],[11499,7],[11520,38],[11568,54],11631,[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],[11744,32],12293,12294,12295,[12321,15],[12337,5],[12344,5],[12353,86],[12441,2],[12445,3],[12449,90],[12540,4],[12549,41],[12593,94],[12704,24],[12784,16],[13312,6582],[19968,20940],[40960,1165],[42192,46],[42240,269],[42512,28],[42560,32],[42594,14],[42620,2],42623,[42624,24],[42656,82],[42775,9],[42786,103],[42891,2],[43003,45],[43072,52],[43136,69],[43216,10],[43232,24],43259,[43264,46],[43312,36],[43360,29],[43392,65],43471,[43472,10],[43520,55],[43584,14],[43600,10],[43616,23],43642,43643,[43648,67],[43739,3],[43968,43],44012,44013,[44016,10],[44032,11172],[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],[64256,7],[64275,5],64285,64286,[64287,10],[64298,13],[64312,5],64318,[64320,2],[64323,2],[64326,108],[64467,139],[64612,218],[64848,64],[64914,54],[65008,10],[65024,16],[65056,7],[65075,2],[65101,3],65137,65139,65143,65145,65147,65149,[65151,126],[65296,10],[65313,26],65343,[65345,26],[65382,89],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],[65596,2],[65599,15],[65616,14],[65664,123],[65856,53],66045,[66176,29],[66208,49],[66304,31],[66352,27],[66432,30],[66464,36],[66504,8],[66513,5],[66560,158],[66720,10],[67584,6],67592,[67594,44],[67639,2],67644,[67647,23],[67840,22],[67872,26],68096,[68097,3],[68101,2],[68108,8],[68117,3],[68121,27],[68152,3],68159,[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69760,59],[73728,879],[74752,99],[77824,1071],[119141,5],[119149,6],[119163,8],[119173,7],[119210,4],[119362,3],[119808,85],[119894,71],[119966,2],119970,[119973,2],[119977,4],[119982,12],119995,[119997,7],[120005,65],[120071,4],[120077,8],[120086,7],[120094,28],[120123,4],[120128,5],120134,[120138,7],[120146,340],[120488,25],[120514,25],[120540,31],[120572,25],[120598,31],[120630,25],[120656,31],[120688,25],[120714,31],[120746,25],[120772,8],[120782,50],[131072,42711],[173824,4149],[194560,542],[917760,240]]},$B.unicode_tables={},$B.unicode)$B.unicode_tables[gc]={},$B.unicode[gc].forEach(function(n){if(Array.isArray(n))for(var o=n[2]||1,l=0,x=n[1];l<x;l+=1)$B.unicode_tables[gc][n[0]+l*o]=!0;else $B.unicode_tables[gc][n]=!0});for(var key in $B.unicode_identifiers){$B.unicode_tables[key]={};for(const n of $B.unicode_identifiers[key])if(Array.isArray(n))for(var i=0;i<n[1];i++)$B.unicode_tables[key][n[0]+i]=!0;else $B.unicode_tables[key][n]=!0}$B.is_unicode_cn=function(n){for(var o=$B.unicode.Cn,l=0,x=o.length;l<x;l++)return n>=o[l][0]&&n<o[l][0]+o[l][1];return!1},function($B){var bltns=$B.InjectBuiltins();eval(bltns);var unicode_tables=$B.unicode_tables,str={__class__:_b_.type,__dir__:object.__dir__,$infos:{__module__:"builtins",__name__:"str"},$is_class:!0,$native:!0};function normalize_start_end(n){if(null===n.start||n.start===_b_.None?n.start=0:n.start<0&&(n.start+=n.self.length,n.start=Math.max(0,n.start)),null===n.end||n.end===_b_.None?n.end=n.self.length:n.end<0&&(n.end+=n.self.length,n.end=Math.max(0,n.end)),!isinstance(n.start,_b_.int)||!isinstance(n.end,_b_.int))throw _b_.TypeError.$factory("slice indices must be integers or None or have an __index__ method")}function reverse(n){return n.split("").reverse().join("")}function check_str(n){if(!_b_.isinstance(n,str))throw _b_.TypeError.$factory("can't convert '"+$B.class_name(n)+"' object to str implicitly")}function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&"s"!=o.type)throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'str'");return n}str.__add__=function(n,o){if("string"!=typeof o)try{return getattr(o,"__radd__")(n)}catch{throw _b_.TypeError.$factory("Can't convert "+$B.class_name(o)+" to str implicitly")}return n+o},str.__contains__=function(n,o){if(!_b_.isinstance(o,str))throw _b_.TypeError.$factory("'in <string>' requires string as left operand, not "+o.__class__);if("string"==typeof o)var l=o.length;else l=_b_.len(o);if(0==l)return!0;if(0==n.length)return 0==l;for(var x=0,B=n.length;x<B;x++)if(n.substr(x,l)==o)return!0;return!1},str.__delitem__=function(){throw _b_.TypeError.$factory("'str' object doesn't support item deletion")},str.__dir__=object.__dir__,str.__eq__=function(n,o){return void 0===o?n===str:_b_.isinstance(o,_b_.str)?o.valueOf()==n.valueOf():_b_.NotImplemented},str.__format__=function(n,o){var l=new $B.parse_format_spec(o);if(void 0!==l.sign)throw _b_.ValueError.$factory("Sign not allowed in string format specifier");return l.precision&&(n=n.substr(0,l.precision)),l.align=l.align||"<",$B.format_width(preformat(n,l),l)},str.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o;if(o<0&&(l+=n.length),l>=0&&l<n.length)return n.charAt(l);throw _b_.IndexError.$factory("string index out of range")}if(isinstance(o,slice)){var x=_b_.slice.$conv_for_seq(o,n.length),B=x.start,D=x.stop,G=x.step,M="",P=null;if(G>0){if(D<=B)return"";for(P=B;P<D;P+=G)M+=n.charAt(P)}else{if(D>=B)return"";for(P=B;P>D;P+=G)M+=n.charAt(P)}return M}if(isinstance(o,_b_.bool))return n.__getitem__(_b_.int.$factory(o));throw _b_.TypeError.$factory("string indices must be integers")};var prefix=2,suffix=3,mask=2**32-1,str_hash_cache={};function fnv(n){if(0==n.length)return 0;var o=prefix;o=(o^n.charCodeAt(0)<<7)&mask;for(var l=0,x=n.length;l<x;l++)o=(1000003*o^n.charCodeAt(l))&mask;return-1==(o=((o=(o^n.length)&mask)^suffix)&mask)&&(o=-2),o}str.$nb_str_hash_cache=0,str.__hash__=function(n){return void 0!==str_hash_cache[n]?str_hash_cache[n]:(str.$nb_str_hash_cache++,str.$nb_str_hash_cache>1e5&&(str.$nb_str_hash_cache=0,str_hash_cache={}),str_hash_cache[n]=fnv(n))},str.__init__=function(n,o){return n.valueOf=function(){return o},n.toString=function(){return o},_b_.None};var str_iterator=$B.make_iterator_class("str_iterator");str.__iter__=function(n){var o=n.split("");return str_iterator.$factory(o)},str.__len__=function(n){return n.length};var kwarg_key=new RegExp("([^\\)]*)\\)"),NotANumber=function(){this.name="NotANumber"},number_check=function(n){if(!isinstance(n,[_b_.int,_b_.float]))throw new NotANumber},get_char_array=function(n,o){return n<=0?"":new Array(n+1).join(o)},format_padding=function(n,o,l){var x=o.padding;return x?(n=n.toString(),x=parseInt(x,10),l&&(x-=1),o.left?n+get_char_array(x-n.length,o.pad_char):get_char_array(x-n.length,o.pad_char)+n):n},format_int_precision=function(n,o){var l,x=o.precision;return x?(x=parseInt(x,10),"-"===(l=n.__class__===$B.long_int?$B.long_int.to_base(n,10):n.toString())[0]?"-"+get_char_array(x-l.length+1,"0")+l.slice(1):get_char_array(x-l.length,"0")+l):n.toString()},format_float_precision=function(n,o,l,x){var B=l.precision;return isFinite(n)?x(n,B,l,o):(n=n===1/0?"inf":n===-1/0?"-inf":"nan",o?n.toUpperCase():n)},format_sign=function(n,o){if(o.sign){if(n>=0)return"+"}else if(o.space&&n>=0)return" ";return""},str_format=function(n,o){return o.pad_char=" ",format_padding(str.$factory(n),o)},num_format=function(n,o){number_check(n),n=n.__class__===$B.long_int?$B.long_int.to_base(n,10):parseInt(n);var l=format_int_precision(n,o);if("0"===o.pad_char){if(n<0)return l=l.substring(1),"-"+format_padding(l,o,!0);var x=format_sign(n,o);if(""!==x)return x+format_padding(l,o,!0)}return format_padding(format_sign(n,o)+l,o)},repr_format=function(n,o){return o.pad_char=" ",format_padding(repr(n),o)},ascii_format=function(n,o){return o.pad_char=" ",format_padding(ascii(n),o)},_float_helper=function(n,o){return number_check(n),o.precision?(o.precision=parseInt(o.precision,10),validate_precision(o.precision)):o.precision=o.decimal_point?0:6,parseFloat(n)},trailing_zeros=/(.*?)(0+)([eE].*)/,leading_zeros=/\.(0*)/,trailing_dot=/\.$/,validate_precision=function(n){n>20&&(n=20)},floating_point_format=function(n,o,l){if(n=_float_helper(n,l),v=n.toString(),v_len=v.length,dot_idx=v.indexOf("."),dot_idx<0&&(dot_idx=v_len),n<1&&n>-1){var x,B=leading_zeros.exec(v);return(x=B?B[1].length:0)>=4?(n=format_sign(n,l)+format_float_precision(n,o,l,_floating_g_exp_helper),l.alternate?l.precision<=1&&(n=n[0]+"."+n.substring(1)):(D=trailing_zeros.exec(n))&&(n=D[1].replace(trailing_dot,"")+D[3]),format_padding(n,l)):(l.precision=(l.precision||0)+x,format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(G,M){return G.toFixed(min(M,v_len-dot_idx)+x)}),l))}var D;return dot_idx>l.precision?(n=format_sign(n,l)+format_float_precision(n,o,l,_floating_g_exp_helper),l.alternate?l.precision<=1&&(n=n[0]+"."+n.substring(1)):(D=trailing_zeros.exec(n))&&(n=D[1].replace(trailing_dot,"")+D[3]),format_padding(n,l)):format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(G,M){return l.decimal_point?M>v_len&&(l.alternate||(M=v_len)):M=min(v_len-1,6),M<dot_idx&&(M=dot_idx),G.toFixed(M-dot_idx)}),l)},_floating_g_exp_helper=function(n,o,l,x){o&&--o;var B=(n=n.toExponential(o)).lastIndexOf("e");return B>n.length-4&&(n=n.substring(0,B+2)+"0"+n.substring(B+2)),x?n.toUpperCase():n},floating_point_decimal_format=function(n,o,l){return n=_float_helper(n,l),format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(x,B,D){return x=x.toFixed(B),0===B&&D.alternate&&(x+="."),x}),l)},_floating_exp_helper=function(n,o,l,x){var B=(n=n.toExponential(o)).lastIndexOf("e");return B>n.length-4&&(n=n.substring(0,B+2)+"0"+n.substring(B+2)),x?n.toUpperCase():n},floating_point_exponential_format=function(n,o,l){return n=_float_helper(n,l),format_padding(format_sign(n,l)+format_float_precision(n,o,l,_floating_exp_helper),l)},signed_hex_format=function(n,o,l){var x;if(number_check(n),x=n.__class__===$B.long_int?$B.long_int.to_base(n,16):(x=parseInt(n)).toString(16),x=format_int_precision(x,l),o&&(x=x.toUpperCase()),"0"===l.pad_char){n<0&&(x=x.substring(1),x="-"+format_padding(x,l,!0));var B=format_sign(n,l);""!==B&&(x=B+format_padding(x,l,!0))}return l.alternate&&(x="-"===x.charAt(0)?o?"-0X"+x.slice(1):"-0x"+x.slice(1):o?"0X"+x:"0x"+x),format_padding(format_sign(n,l)+x,l)},octal_format=function(n,o){var l;if(number_check(n),l=n.__class__===$B.long_int?$B.long_int.to_base(8):(l=parseInt(n)).toString(8),l=format_int_precision(l,o),"0"===o.pad_char){n<0&&(l=l.substring(1),l="-"+format_padding(l,o,!0));var x=format_sign(n,o);""!==x&&(l=x+format_padding(l,o,!0))}return o.alternate&&(l="-"===l.charAt(0)?"-0o"+l.slice(1):"0o"+l),format_padding(l,o)};function series_of_bytes(n,o){if(n.__class__&&n.__class__.$buffer_protocol)for(var l=_b_.iter(n),x=[];;)try{x.push(_b_.next(l))}catch(D){if(D.__class__===_b_.StopIteration){var B=_b_.bytes.$factory(x);return format_padding(_b_.bytes.decode(B,"ascii"),o)}throw D}else try{return bytes_obj=$B.$getattr(n,"__bytes__"),format_padding(_b_.bytes.decode(bytes_obj),o)}catch(D){throw D.__class__===_b_.AttributeError?_b_.TypeError.$factory("%b does not accept '"+$B.class_name(n)+"'"):D}}var single_char_format=function(n,o){if(isinstance(n,str)&&1==n.length)return n;if(isinstance(n,bytes)&&1==n.source.length)n=n.source[0];else try{n=_b_.int.$factory(n)}catch{throw _b_.TypeError.$factory("%c requires int or char")}return format_padding(chr(n),o)},num_flag=function(n,o){"0"!==n||o.padding||o.decimal_point||o.left?o.decimal_point?o.precision=(o.precision||"")+n:o.padding=(o.padding||"")+n:o.pad_char="0"},decimal_point_flag=function(n,o){if(o.decimal_point)throw new UnsupportedChar;o.decimal_point=!0},neg_flag=function(n,o){o.pad_char=" ",o.left=!0},space_flag=function(n,o){o.space=!0},sign_flag=function(n,o){o.sign=!0},alternate_flag=function(n,o){o.alternate=!0},char_mapping={b:series_of_bytes,s:str_format,d:num_format,i:num_format,u:num_format,o:octal_format,r:repr_format,a:ascii_format,g:function(n,o){return floating_point_format(n,!1,o)},G:function(n,o){return floating_point_format(n,!0,o)},f:function(n,o){return floating_point_decimal_format(n,!1,o)},F:function(n,o){return floating_point_decimal_format(n,!0,o)},e:function(n,o){return floating_point_exponential_format(n,!1,o)},E:function(n,o){return floating_point_exponential_format(n,!0,o)},x:function(n,o){return signed_hex_format(n,!1,o)},X:function(n,o){return signed_hex_format(n,!0,o)},c:single_char_format,0:function(n,o){return num_flag("0",o)},1:function(n,o){return num_flag("1",o)},2:function(n,o){return num_flag("2",o)},3:function(n,o){return num_flag("3",o)},4:function(n,o){return num_flag("4",o)},5:function(n,o){return num_flag("5",o)},6:function(n,o){return num_flag("6",o)},7:function(n,o){return num_flag("7",o)},8:function(n,o){return num_flag("8",o)},9:function(n,o){return num_flag("9",o)},"-":neg_flag," ":space_flag,"+":sign_flag,".":decimal_point_flag,"#":alternate_flag},UnsupportedChar=function(){this.name="UnsupportedChar"};str.__mod__=function(n,o){var l,x=n.length,B=0,D=null;_b_.isinstance(o,_b_.tuple)?D=0:l=_b_.getattr(o,"__getitem__",_b_.None);var G="",M=function(ue){++B;var me=kwarg_key.exec(ue.substring(ne));if(!me)throw _b_.ValueError.$factory("incomplete format key");var ie=me[1];ne+=me[0].length;try{var W=l(ie)}catch(Q){throw"KeyError"===Q.name?Q:_b_.TypeError.$factory("format requires a mapping")}return fe(ue,W)},P=function(ue){var me;if(null===D)me=o;else if(void 0===(me=o[D++]))throw _b_.TypeError.$factory("not enough arguments for format string");return fe(ue,me)},fe=function(ue,me){for(var ie={pad_char:" "};;){var W=char_mapping[ue[ne]];try{if(void 0===W)throw new UnsupportedChar;var Q=W(me,ie);if(void 0!==Q)return Q;++ne}catch(X){if("UnsupportedChar"==X.name)throw invalid_char=ue[ne],void 0===invalid_char?_b_.ValueError.$factory("incomplete format"):_b_.ValueError.$factory("unsupported format character '"+invalid_char+"' (0x"+invalid_char.charCodeAt(0).toString(16)+") at index "+ne);if("NotANumber"===X.name){var R=me.__class__;throw R=R?R.$infos.__name__:"string"==typeof me?"str":typeof me,_b_.TypeError.$factory("%"+ue[ne]+" format: a number is required, not "+R)}throw X}}},ye=0;do{var ne=n.indexOf("%",B);if(ne<0){G+=n.substring(B);break}if(G+=n.substring(B,ne),!(++ne<x))throw _b_.ValueError.$factory("incomplete format");"%"===n[ne]?G+="%":(ye++,"("===n[ne]?(++ne,G+=M(n)):G+=P(n)),B=ne+1}while(B<x);if(null!==D){if(o.length>D)throw _b_.TypeError.$factory("not enough arguments for format string");if(o.length<D)throw _b_.TypeError.$factory("not all arguments converted during string formatting")}else if(0==ye)throw _b_.TypeError.$factory("not all arguments converted during string formatting");return G},str.__mro__=[object],str.__mul__=function(){var n=$B.args("__mul__",2,{self:null,other:null},["self","other"],arguments,{},null,null);if(!isinstance(n.other,_b_.int))throw _b_.TypeError.$factory("Can't multiply sequence by non-int of type '"+$B.class_name(n.other)+"'");for(var o="",l=0;l<n.other;l++)o+=n.self.valueOf();return o},str.__ne__=function(n,o){return o!==n.valueOf()},str.__repr__=function(n){var o=n;o=(o=(o=n.replace(/\\/g,"\\\\")).replace(new RegExp("\x07","g"),"\\x07").replace(new RegExp("\b","g"),"\\x08").replace(new RegExp("\v","g"),"\\x0b").replace(new RegExp("\f","g"),"\\x0c").replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r").replace(new RegExp("\t","g"),"\\t")).replace(combining_re,"\u200b$1");for(var l="",x=0;x<o.length;x++)if($B.is_unicode_cn(o.codePointAt(x))){for(var B=o.codePointAt(x).toString(16);B.length<4;)B="0"+B;l+="\\u"+B}else l+=o.charAt(x);if(-1==(o=l).search('"')&&-1==o.search("'"))return"'"+o+"'";if(-1==n.search('"'))return'"'+o+'"';var D=new RegExp("'","g");return"'"+o.replace(D,"\\'")+"'"},str.__setitem__=function(n,o,l){throw _b_.TypeError.$factory("'str' object does not support item assignment")};for(var combining=[],cp=768;cp<=879;cp++)combining.push(String.fromCharCode(cp));var combining_re=new RegExp("("+combining.join("|")+")");str.__str__=function(n){return n.replace(combining_re,"\u200b$1")},str.toString=function(){return"string!"};var $comp_func=function(n,o){return"string"!=typeof o?_b_.NotImplemented:n>o};$comp_func+="";var $comps={">":"gt",">=":"ge","<":"lt","<=":"le"};for(var $op in $comps)eval("str.__"+$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op));$B.make_rmethods(str);var $notimplemented=function(n,o){throw NotImplementedError.$factory("OPERATOR not implemented for class str")};str.capitalize=function(n){return $B.args("capitalize",1,{self:n},["self"],arguments,{},null,null),0==n.length?"":n.charAt(0).toUpperCase()+n.substr(1)},str.casefold=function(n){$B.args("casefold",1,{self:n},["self"],arguments,{},null,null);for(var o,l,x="",B=0,D=n.length;B<D;B++)o=n.charCodeAt(B),(l=$B.unicode_casefold[o])?l.forEach(function(G){x+=String.fromCharCode(G)}):x+=n.charAt(B).toLowerCase();return x},str.center=function(){var n=$B.args("center",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null),o=n.self;if(n.width<=o.length)return o;var l=parseInt((n.width-o.length)/2),x=n.fillchar.repeat(l);return(x+=o+x).length<n.width&&(x+=n.fillchar),x},str.count=function(){var n=$B.args("count",4,{self:null,sub:null,start:null,stop:null},["self","sub","start","stop"],arguments,{start:null,stop:null},null,null);if("string"!=typeof n.sub)throw _b_.TypeError.$factory("Can't convert '"+$B.class_name(n.sub)+"' object to str implicitly");var o,l=n.self;if(null!==n.start)o=null!==n.stop?_b_.slice.$factory(n.start,n.stop):_b_.slice.$factory(n.start,n.self.length),l=str.__getitem__.apply(null,[n.self].concat(o));else if(n.self.length+n.sub.length==0)return 1;if(0==n.sub.length)return n.start==n.self.length?1:0==l.length?0:l.length+1;for(var x=0,B=0;B<l.length&&(B=l.indexOf(n.sub,B))>=0;)x++,B+=n.sub.length;return x},str.encode=function(){var n=$B.args("encode",3,{self:null,encoding:null,errors:null},["self","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);if("rot13"==n.encoding||"rot_13"==n.encoding){for(var o="",l=0,x=n.self.length;l<x;l++){var B=n.self.charAt(l);o+="a"<=B&&B<="m"||"A"<=B&&B<="M"?String.fromCharCode(String.charCodeAt(B)+13):"m"<B&&B<="z"||"M"<B&&B<="Z"?String.fromCharCode(String.charCodeAt(B)-13):B}return o}return _b_.bytes.__new__(_b_.bytes,n.self,n.encoding,n.errors)},str.endswith=function(){var n=$B.args("endswith",4,{self:null,suffix:null,start:null,end:null},["self","suffix","start","end"],arguments,{start:0,end:null},null,null);normalize_start_end(n);var o=n.suffix;isinstance(o,_b_.tuple)||(o=[o]);for(var l=n.self.substring(n.start,n.end),x=0,B=o.length;x<B;x++){var D=o[x];if(!_b_.isinstance(D,str))throw _b_.TypeError.$factory("endswith first arg must be str or a tuple of str, not int");if(D.length<=l.length&&l.substr(l.length-D.length)==D)return!0}return!1},str.expandtabs=function(n,o){var l=$B.args("expandtabs",2,{self:null,tabsize:null},["self","tabsize"],arguments,{tabsize:8},null,null),x=$B.$GetInt(l.tabsize),B=0,D=0,G="";if(1==x)return n.replace(/\t/g," ");for(;D<n.length;){var M=n.charAt(D);switch(M){case"\t":for(;B%x>0;)G+=" ",B++;break;case"\r":case"\n":G+=M,B=0;break;default:G+=M,B++}D++}return G},str.find=function(){var n=$B.args("str.find",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:null},null,null);if(check_str(n.sub),normalize_start_end(n),!isinstance(n.start,_b_.int)||!isinstance(n.end,_b_.int))throw _b_.TypeError.$factory("slice indices must be integers or None or have an __index__ method");for(var o="",l=n.start;l<n.end;l++)o+=n.self.charAt(l);if(0==n.sub.length&&n.start==n.self.length)return n.self.length;if(o.length+n.sub.length==0)return-1;var x=o.length-n.sub.length;for(l=0;l<=x;l++)if(o.substr(l,n.sub.length)==n.sub)return n.start+l;return-1},$B.parse_format=function(n){var o,l,x,B=n.split(":"),D=[];return 1==B.length?o=n:(o=B[0],x=B.splice(1).join(":")),(B=o.split("!")).length>1&&(o=B[0],l=B[1]),void 0!==o&&(o=o.replace(/\.[_a-zA-Z][_a-zA-Z0-9]*|\[[_a-zA-Z][_a-zA-Z0-9]*\]|\[[0-9]+\]/g,function(G){return D.push(G),""})),{name:o,name_ext:D,conv:l,spec:x||"",string:n}},$B.split_format=function(n){for(var o,l=0,x=n.length,B="",D=[],G=0;l<x;)if("{"==(o=n.charAt(l))&&"{"==n.charAt(l+1))B+="{",l+=2;else if("}"==o&&"}"==n.charAt(l+1))B+="}",l+=2;else if("{"==o){D.push(B);for(var M=l+1,P=1;M<x;)if("{"==n.charAt(M))P++,M++;else if("}"==n.charAt(M)){if(M++,0==--P){var fe=n.substring(l+1,M-1),ye=$B.parse_format(fe);if(ye.raw_name=ye.name,ye.raw_spec=ye.spec,ye.name||(ye.name=G+"",G++),void 0!==ye.spec){ye.spec=ye.spec.replace(/\{(.*?)\}/g,function(me,ie){return""==ie?"{"+G+++"}":"{"+ie+"}"})}D.push(ye),B="";break}}else M++;if(P>0)throw ValueError.$factory("wrong format "+n);l=M}else B+=o,l++;return B&&D.push(B),D},str.format=function(n){for(var o,l=$B.args("format",1,{self:null},["self"],arguments,{},"$args","$kw"),x=$B.split_format(l.self),B="",D=0;D<x.length;D++)if("string"!=typeof x[D]){if(void 0!==(o=x[D]).spec){o.spec=o.spec.replace(/\{(.*?)\}/g,function(me,ie){return/\d+/.exec(ie)?_b_.tuple.__getitem__(l.$args,parseInt(ie)):_b_.dict.__getitem__(l.$kw,ie)})}if(o.name.charAt(0).search(/\d/)>-1)var G=parseInt(o.name),M=_b_.tuple.__getitem__(l.$args,G);else M=_b_.dict.__getitem__(l.$kw,o.name);for(var P=0;P<o.name_ext.length;P++){var fe=o.name_ext[P];if("."==fe.charAt(0))M=_b_.getattr(M,fe.substr(1));else{var ye=fe.substr(1,fe.length-2);ye.charAt(0).search(/\d/)>-1&&(ye=parseInt(ye)),M=_b_.getattr(M,"__getitem__")(ye)}}"a"==o.conv?M=_b_.ascii(M):"r"==o.conv?M=_b_.repr(M):"s"==o.conv&&(M=_b_.str.$factory(M)),B+=M.$is_class||M.$factory?M.__class__.__format__(M,o.spec):$B.$getattr(M,"__format__")(o.spec)}else B+=x[D];return B},str.format_map=function(n){throw NotImplementedError.$factory("function format_map not implemented yet")},str.index=function(n){var o=str.find.apply(null,arguments);if(-1===o)throw _b_.ValueError.$factory("substring not found");return o},str.isascii=function(n){for(var o=0,l=n.length;o<l;o++)if(n.charCodeAt(o)>127)return!1;return!0},str.isalnum=function(n){$B.args("isalnum",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!(unicode_tables.Ll[o]||unicode_tables.Lu[o]||unicode_tables.Lm[o]||unicode_tables.Lt[o]||unicode_tables.Lo[o]||unicode_tables.Nd[o]||unicode_tables.digits[o]||unicode_tables.numeric[o]))return!1;return!0},str.isalpha=function(n){$B.args("isalpha",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!(unicode_tables.Ll[o]||unicode_tables.Lu[o]||unicode_tables.Lm[o]||unicode_tables.Lt[o]||unicode_tables.Lo[o]))return!1;return!0},str.isdecimal=function(n){$B.args("isdecimal",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.Nd[o])return!1;return n.length>0},str.isdigit=function(n){$B.args("isdigit",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.digits[o])return!1;return n.length>0},str.isidentifier=function(n){if($B.args("isidentifier",1,{self:null},["self"],arguments,{},null,null),0==n.length||void 0===unicode_tables.XID_Start[n.charCodeAt(0)])return!1;for(var o=1,l=n.length;o<l;o++)if(void 0===unicode_tables.XID_Continue[n.charCodeAt(o)])return!1;return!0},str.islower=function(n){$B.args("islower",1,{self:null},["self"],arguments,{},null,null);for(var o,l=!1,x=0,B=n.length;x<B;x++)if(o=n.charCodeAt(x),unicode_tables.Ll[o])l=!0;else if(unicode_tables.Lu[o]||unicode_tables.Lt[o])return!1;return l},str.isnumeric=function(n){$B.args("isnumeric",1,{self:null},["self"],arguments,{},null,null);for(var o=0,l=n.length;o<l;o++)if(!unicode_tables.numeric[n.charCodeAt(o)])return!1;return n.length>0};var unprintable={},unprintable_gc=["Cc","Cf","Co","Cs","Zl","Zp","Zs"];function $re_escape(n){for(var o="[.*+?|()$^",l=0;l<10;l++){var x=new RegExp("\\"+o.charAt(l),"g");n=n.replace(x,"\\"+o.charAt(l))}return n}str.isprintable=function(n){if(0==Object.keys(unprintable).length){for(var o=0;o<unprintable_gc.length;o++){var l=unicode_tables[unprintable_gc[o]];for(var x in l)unprintable[x]=!0}unprintable[32]=!0}$B.args("isprintable",1,{self:null},["self"],arguments,{},null,null),o=0;for(var B=n.length;o<B;o++)if(unprintable[n.charCodeAt(o)])return!1;return!0},str.isspace=function(n){$B.args("isspace",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.Zs[o]&&-1==$B.unicode_bidi_whitespace.indexOf(o))return!1;return n.length>0},str.istitle=function(n){return $B.args("istitle",1,{self:null},["self"],arguments,{},null,null),n.length>0&&str.title(n)==n},str.isupper=function(n){$B.args("islower",1,{self:null},["self"],arguments,{},null,null);for(var o,l=!1,x=0,B=n.length;x<B;x++)if(o=n.charCodeAt(x),unicode_tables.Lu[o])l=!0;else if(unicode_tables.Ll[o]||unicode_tables.Lt[o])return!1;return l},str.join=function(){for(var n=$B.args("join",2,{self:null,iterable:null},["self","iterable"],arguments,{},null,null),o=_b_.iter(n.iterable),l=[];;)try{var x=_b_.next(o);if(!isinstance(x,str))throw _b_.TypeError.$factory("sequence item 0: expected str instance, "+$B.class_name(x)+" found");l.push(x)}catch(B){if(_b_.isinstance(B,_b_.StopIteration))break;throw B}return l.join(n.self)},str.ljust=function(n){var o=$B.args("ljust",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null);return o.width<=n.length?n:n+o.fillchar.repeat(o.width-n.length)},str.lower=function(n){return $B.args("lower",1,{self:null},["self"],arguments,{},null,null),n.toLowerCase()},str.lstrip=function(n,o){var l=$B.args("lstrip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(l.chars===_b_.None)return l.self.trimLeft();for(var x=0;x<l.self.length;x++)if(-1===l.chars.indexOf(l.self.charAt(x)))return l.self.substring(x);return""},str.maketrans=function(){var n=$B.args("maketrans",3,{x:null,y:null,z:null},["x","y","z"],arguments,{y:null,z:null},null,null),o=$B.empty_dict();if(null===n.y&&null===n.z){if(!_b_.isinstance(n.x,_b_.dict))throw _b_.TypeError.$factory("maketrans only argument must be a dict");for(var l=_b_.list.$factory(_b_.dict.items(n.x)),x=0,B=l.length;x<B;x++){var D=l[x][0],G=l[x][1];if(!_b_.isinstance(D,_b_.int)){if(!_b_.isinstance(D,_b_.str)||1!=D.length)throw _b_.TypeError.$factory("dictionary key "+D+" is not int or 1-char string");D=_b_.ord(D)}if(G!==_b_.None&&!_b_.isinstance(G,[_b_.int,_b_.str]))throw _b_.TypeError.$factory("dictionary value "+G+" is not None, integer or string");_b_.dict.$setitem(o,D,G)}return o}if(_b_.isinstance(n.x,_b_.str)&&_b_.isinstance(n.y,_b_.str)){if(n.x.length!==n.y.length)throw _b_.TypeError.$factory("maketrans arguments must be strings or same length");var M={};if(null!==n.z){if(!_b_.isinstance(n.z,_b_.str))throw _b_.TypeError.$factory("maketrans third argument must be a string");for(x=0,B=n.z.length;x<B;x++)M[_b_.ord(n.z.charAt(x))]=!0}for(x=0,B=n.x.length;x<B;x++){var P=_b_.ord(n.x.charAt(x)),fe=n.y.charCodeAt(x);_b_.dict.$setitem(o,P,fe)}for(var D in M)_b_.dict.$setitem(o,parseInt(D),_b_.None);return o}throw _b_.TypeError.$factory("maketrans arguments must be strings")},str.maketrans.$type="staticmethod",str.partition=function(){var n=$B.args("partition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(""==n.sep)throw _b_.ValueError.$factory("empty separator");check_str(n.sep);var o=n.self.indexOf(n.sep);return-1==o?_b_.tuple.$factory([n.self,"",""]):_b_.tuple.$factory([n.self.substring(0,o),n.sep,n.self.substring(o+n.sep.length)])},str.removeprefix=function(){var n=$B.args("removeprefix",2,{self:null,prefix:null},["self","prefix"],arguments,{},null,null);if(!_b_.isinstance(n.prefix,str))throw _b_.ValueError.$factory(`prefix should be str, not '${$B.class_name(n.prefix)}'`);return str.startswith(n.self,n.prefix)?n.self.substr(n.prefix.length):n.self.substr(0)},str.removesuffix=function(){var n=$B.args("removesuffix",2,{self:null,prefix:null},["self","suffix"],arguments,{},null,null);if(!_b_.isinstance(n.suffix,str))throw _b_.ValueError.$factory(`suffix should be str, not '${$B.class_name(n.prefix)}'`);return n.suffix.length>0&&str.endswith(n.self,n.suffix)?n.self.substr(0,n.self.length-n.suffix.length):n.self.substr(0)},str.replace=function(n,o,l,x){var B=$B.args("replace",4,{self:null,old:null,$$new:null,count:null},["self","old","$$new","count"],arguments,{count:-1},null,null);if(x=B.count,n=B.self,l=B.$$new,check_str(o=B.old),check_str(l),!isinstance(x,[_b_.int,_b_.float]))throw _b_.TypeError.$factory("'"+$B.class_name(x)+"' object cannot be interpreted as an integer");if(isinstance(x,_b_.float))throw _b_.TypeError.$factory("integer argument expected, got float");if(0==x)return n;if(x.__class__==$B.long_int&&(x=parseInt(x.value)),""==o){if(""==l)return n;if(""==n)return l;var D=n.split("");if(x>-1&&D.length>=x){var G=D.slice(x).join("");return l+D.slice(0,x).join(l)+G}return l+D.join(l)+l}D=str.split(n,o,x);var M=n,P=-1;if(0==o.length){M=l;for(var fe=0;fe<D.length;fe++)M+=D[fe]+l;return M+G}for(x<0&&(x=M.length);x>0&&!((P=M.indexOf(o,P))<0);)M=M.substr(0,P)+l+M.substr(P+o.length),P+=l.length,x--;return M},str.rfind=function(n,o){if(2==arguments.length&&"string"==typeof o)return n.lastIndexOf(o);var l=$B.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:null},null,null);if(normalize_start_end(l),check_str(l.sub),0==l.sub.length)return l.start>l.self.length?-1:l.self.length;for(var x=l.sub.length,B=l.end-x;B>=l.start;B--)if(l.self.substr(B,x)==l.sub)return B;return-1},str.rindex=function(){var n=str.rfind.apply(null,arguments);if(-1==n)throw _b_.ValueError.$factory("substring not found");return n},str.rjust=function(n){var o=$B.args("rjust",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null);return o.width<=n.length?n:o.fillchar.repeat(o.width-n.length)+n},str.rpartition=function(n,o){var l=$B.args("rpartition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);check_str(l.sep),n=reverse(l.self),o=reverse(l.sep);for(var x=str.partition(n,o).reverse(),B=0;B<x.length;B++)x[B]=x[B].split("").reverse().join("");return x},str.rsplit=function(n){var o=$B.args("rsplit",3,{self:null,sep:null,maxsplit:null},["self","sep","maxsplit"],arguments,{sep:_b_.None,maxsplit:-1},null,null),l=o.sep,x=reverse(o.self),B=l===_b_.None?l:reverse(o.sep),D=str.split(x,B,o.maxsplit);D.reverse();for(var G=0;G<D.length;G++)D[G]=reverse(D[G]);return D},str.rstrip=function(n,o){var l=$B.args("rstrip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(l.chars===_b_.None)return l.self.trimRight();for(var x=l.self.length-1;x>=0;x--)if(-1==l.chars.indexOf(l.self.charAt(x)))return l.self.substring(0,x+1);return""},str.split=function(){var n=$B.args("split",3,{self:null,sep:null,maxsplit:null},["self","sep","maxsplit"],arguments,{sep:_b_.None,maxsplit:-1},null,null),o=n.sep,l=n.maxsplit,x=n.self,B=0;if(l.__class__===$B.long_int&&(l=parseInt(l.value)),""==o)throw _b_.ValueError.$factory("empty separator");if(o===_b_.None){for(var D=[];B<x.length&&x.charAt(B).search(/\s/)>-1;)B++;if(B===x.length-1)return[x];for(var G="";;){if(-1==x.charAt(B).search(/\s/))""==G?G=x.charAt(B):G+=x.charAt(B);else if(""!==G){if(D.push(G),-1!==l&&D.length==l+1)return D.pop(),D.push(G+x.substr(B)),D;G=""}if(++B>x.length-1){G&&D.push(G);break}}return D}D=[];var M="",P=o.length;if(0==l)return[x];for(;B<x.length;)if(x.substr(B,P)==o){if(D.push(M),B+=P,l>-1&&D.length>=l)return D.push(x.substr(B)),D;M=""}else M+=x.charAt(B),B++;return D.push(M),D},str.splitlines=function(n){var o=$B.args("splitlines",2,{self:null,keepends:null},["self","keepends"],arguments,{keepends:!1},null,null);if(!_b_.isinstance(o.keepends,[_b_.bool,_b_.int]))throw _b_.TypeError("integer argument expected, got "+$B.get_class(o.keepends).__name);var l=_b_.int.$factory(o.keepends),x=[],B=0,D=0;if(!(n=o.self).length)return x;for(;D<n.length;)"\r\n"==n.substr(D,2)?(x.push(n.slice(B,l?D+2:D)),B=D+=2):"\r"==n[D]||"\n"==n[D]?(x.push(n.slice(B,l?D+1:D)),B=D+=1):D++;return B<n.length&&x.push(n.slice(B)),x},str.startswith=function(){var n=$B.args("startswith",4,{self:null,prefix:null,start:null,end:null},["self","prefix","start","end"],arguments,{start:0,end:null},null,null);normalize_start_end(n);var o=n.prefix;isinstance(o,_b_.tuple)||(o=[o]);for(var l=n.self.substring(n.start,n.end),x=0,B=o.length;x<B;x++){var D=o[x];if(!_b_.isinstance(D,str))throw _b_.TypeError.$factory("endswith first arg must be str or a tuple of str, not int");if(l.substr(0,D.length)==D)return!0}return!1},str.strip=function(){var n=$B.args("strip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(n.chars===_b_.None)return n.self.trim();for(var o=0;o<n.self.length&&-1!=n.chars.indexOf(n.self.charAt(o));o++);for(var l=n.self.length-1;l>=o&&-1!=n.chars.indexOf(n.self.charAt(l));l--);return n.self.substring(o,l+1)},str.swapcase=function(n){$B.args("swapcase",1,{self:n},["self"],arguments,{},null,null);for(var o,l="",x=0,B=n.length;x<B;x++)o=n.charCodeAt(x),l+=unicode_tables.Ll[o]?n.charAt(x).toUpperCase():unicode_tables.Lu[o]?n.charAt(x).toLowerCase():n.charAt(x);return l},str.title=function(n){$B.args("title",1,{self:n},["self"],arguments,{},null,null);for(var o,l,x="",B=0,D=n.length;B<D;B++)l=n.charCodeAt(B),unicode_tables.Ll[l]?o?x+=n.charAt(B):(x+=n.charAt(B).toUpperCase(),o="word"):unicode_tables.Lu[l]||unicode_tables.Lt[l]?(x+=o?n.charAt(B).toLowerCase():n.charAt(B),o="word"):(o=null,x+=n.charAt(B));return x},str.translate=function(n,o){for(var l=[],x=$B.$getattr(o,"__getitem__"),B=0,D=n.length;B<D;B++)try{var G=x(n.charCodeAt(B));G!==_b_.None&&("string"==typeof G?l.push(G):"number"==typeof G&&l.push(String.fromCharCode(G)))}catch{l.push(n.charAt(B))}return l.join("")},str.upper=function(n){return $B.args("upper",1,{self:null},["self"],arguments,{},null,null),n.toUpperCase()},str.zfill=function(n,o){var l=$B.args("zfill",2,{self:null,width:null},["self","width"],arguments,{},null,null);if(l.width<=n.length)return n;switch(n.charAt(0)){case"+":case"-":return n.charAt(0)+"0".repeat(l.width-n.length)+n.substr(1);default:return"0".repeat(o-n.length)+n}},str.$factory=function(n,o,l){if(0==arguments.length)return"";if(void 0===n)return $B.UndefinedClass.__str__();if(void 0!==o){var x=$B.args("str",3,{arg:null,encoding:null,errors:null},["arg","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);o=x.encoding,l=x.errors}switch(typeof n){case"string":return str.__str__(n);case"number":if(isFinite(n))return n.toString()}try{if(n.$is_class||n.$factory)return $B.$getattr(n.__class__,"__str__")(n);if(n.__class__&&n.__class__===_b_.bytes&&void 0!==o)return _b_.bytes.decode(n,x.encoding,x.errors);var B=n.__class__||$B.get_class(n);if(void 0===B)return $B.JSObj.__str__($B.JSObj.$factory(n));if(null===(D=$B.$getattr(B,"__str__",null))||n.__class__&&n.__class__!==_b_.object&&D.$infos&&D.$infos.__func__===_b_.object.__str__)var D=$B.$getattr(B,"__repr__")}catch(G){throw console.log("no __str__ for",n),console.log("err ",G),$B.debug>1&&console.log(G),console.log("Warning - no method __str__ or __repr__, default to toString",n),G}return $B.$call(D)(n)},str.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("str.__new__(): not enough arguments");return{__class__:n}},$B.set_func_names(str,"builtins");var StringSubclass=$B.StringSubclass={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"str"},$is_class:!0};for(var $attr in str)"function"==typeof str[$attr]&&(StringSubclass[$attr]=function(n){return function(){var o=[],l=0;if(arguments.length>0){o=[arguments[0].valueOf()],l=1;for(var x=1,B=arguments.length;x<B;x++)o[l++]=arguments[x]}return str[n].apply(null,o)}}($attr));function fstring_expression(){this.type="expression",this.expression="",this.conversion=null,this.fmt=null}StringSubclass.__new__=function(n){return{__class__:n}},$B.set_func_names(StringSubclass,"builtins"),_b_.str=str,$B.parse_format_spec=function(n){if(""==n)this.empty=!0;else{var o=0,l="<>=^",x="0123456789",B=l.indexOf(n.charAt(0));-1!=B?n.charAt(1)&&-1!=l.indexOf(n.charAt(1))?(this.fill=n.charAt(0),this.align=n.charAt(1),o=2):(this.align=l[B],this.fill=" ",o++):(B=l.indexOf(n.charAt(1)),n.charAt(1)&&-1!=B&&(this.align=l[B],this.fill=n.charAt(0),o=2));var D=n.charAt(o);for("+"!=D&&"-"!=D&&" "!=D||(this.sign=D,o++,D=n.charAt(o)),"#"==D&&(this.alternate=!0,o++,D=n.charAt(o)),"0"==D&&(this.fill="0",-1==B&&(this.align="="),o++,D=n.charAt(o));D&&x.indexOf(D)>-1;)void 0===this.width?this.width=D:this.width+=D,o++,D=n.charAt(o);if(void 0!==this.width&&(this.width=parseInt(this.width)),void 0===this.width&&"{"==D){var G=n.substr(o).search("}");this.width=n.substring(o,G),console.log("width","["+this.width+"]"),o+=G+1}if(","==D&&(this.comma=!0,o++,D=n.charAt(o)),"."==D){if(-1==x.indexOf(n.charAt(o+1)))throw _b_.ValueError.$factory("Missing precision in format spec");for(this.precision=n.charAt(o+1),D=n.charAt(o+=2);D&&x.indexOf(D)>-1;)this.precision+=D,o++,D=n.charAt(o);this.precision=parseInt(this.precision)}if(D&&"bcdeEfFgGnosxX%".indexOf(D)>-1&&(this.type=D,o++,D=n.charAt(o)),o!==n.length)throw _b_.ValueError.$factory("Invalid format specifier: "+n)}this.toString=function(){return(void 0===this.fill?"":_b_.str.$factory(this.fill))+(this.align||"")+(this.sign||"")+(this.alternate?"#":"")+(this.sign_aware?"0":"")+(this.width||"")+(this.comma?",":"")+(this.precision?"."+this.precision:"")+(this.type||"")}},$B.format_width=function(n,o){if(o.width&&n.length<o.width){var l=o.fill||" ",B=o.width-n.length;switch(o.align||"<"){case"<":return n+l.repeat(B);case">":return l.repeat(B)+n;case"=":return"+-".indexOf(n.charAt(0))>-1?n.charAt(0)+l.repeat(B)+n.substr(1):l.repeat(B)+n;case"^":var D=parseInt(B/2);return l.repeat(D)+n+l.repeat(B-D)}}return n},$B.parse_fstring=function(n){for(var o,l=[],x=0,B="",D=null,G=0;x<n.length;)if(null===D)if("{"==(o=n.charAt(x)))"{"==n.charAt(x+1)?(D="string",B="{",x+=2):(D="expression",G=1,x++);else if("}"==o){if(n.charAt(x+1)!=o)throw Error(" f-string: single '}' is not allowed");D="string",B="}",x+=2}else D="string",B=o,x++;else if("string"==D){for(var M=x;M<n.length;)if("{"==(o=n.charAt(M))){if("{"!=n.charAt(M+1)){l.push(B),D="expression",x=M+1;break}B+="{",M+=2}else if("}"==o){if(n.charAt(M+1)!=o)throw Error(" f-string: single '}' is not allowed");B+=o,M+=2}else B+=o,M++;x=M+1}else if("debug"==D){for(;" "==n.charAt(M);)M++;"}"==n.charAt(M)&&(l.push(B),D=null,B="",x=M+1)}else{M=x,G=1;var P=0;for(B=new fstring_expression;M<n.length;)if("{"==(o=n.charAt(M))&&0==P)G++,B.expression+=o,M++;else if("}"==o&&0==P){if(0==(G-=1)){l.push(B),D=null,B="",x=M+1;break}B.expression+=o,M++}else{if("\\"==o)throw Error("f-string expression part cannot include a backslash");if(0==P&&"!"==o&&null===B.fmt&&":}".indexOf(n.charAt(M+2))>-1){if(0==B.expression.length)throw Error("f-string: empty expression not allowed");if(-1=="ars".indexOf(n.charAt(M+1)))throw Error("f-string: invalid conversion character: expected 's', 'r', or 'a'");B.conversion=n.charAt(M+1),M+=2}else if("("==o)P++,B.expression+=o,M++;else if(")"==o)P--,B.expression+=o,M++;else if('"'==o)if('"""'==n.substr(M,3)){if(-1==(ye=n.indexOf('"""',M+3)))throw Error("f-string: unterminated string");var fe=n.substring(M,ye+3);fe=fe.replace("\n","\\n\\"),B.expression+=fe,M=ye+3}else{var ye;if(-1==(ye=n.indexOf('"',M+1)))throw Error("f-string: unterminated string");B.expression+=n.substring(M,ye+1),M=ye+1}else if(0==P&&":"==o)B.fmt=!0,B.expression+=o,M++;else if("="==o){var ne=B.expression,ue=ne.charAt(ne.length-1),me=("()".indexOf(ue)>-1?"\\":"")+ue;if(0==ne.length||"="==n.charAt(M+1)||"=!<>:".search(me)>-1)B.expression+=o+n.charAt(M+1),M+=2;else{for(tail=o;n.charAt(M+1).match(/\s/);)tail+=n.charAt(M+1),M++;for(l.push(B.expression+tail);ne.match(/\s$/);)ne=ne.substr(0,ne.length-1);B.expression=ne,D="debug",M++}}else B.expression+=o,M++}if(G>0)throw Error("f-string: expected '}'")}return B.length>0&&l.push(B),l};var surrogate=str.$surrogate=$B.make_class("surrogate_string",function(n){for(var o=[],l=0,x=n.length;l<x;l++){var B=n.charCodeAt(l);B>=55296&&B<=56319&&(l++,B=1024*(B-55296)+(n.charCodeAt(l)-56320)+65536),o.push(String.fromCodePoint(B))}return{__class__:str.$surrogate,items:o}});surrogate.__mro__=[str,object],surrogate.__contains__=function(n,o){return str.__contains__(n.items.join(""),o)},surrogate.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o;if(o<0&&(l+=n.items.length),l>=0&&l<n.items.length)return 2==n.items[l].length?surrogate.$factory(n.items[l]):n.items[l];throw _b_.IndexError.$factory("string index out of range")}if(isinstance(o,slice)){var x=_b_.slice.$conv_for_seq(o,n.items.length),B=x.start,D=x.stop,G=x.step,M="",P=null;if(G>0){if(D<=B)return"";for(P=B;P<D;P+=G)M+=n.items[P]}else{if(D>=B)return"";for(P=B;P>D;P+=G)M+=n.items[P]}return M}if(isinstance(o,_b_.bool))return surrogate.__getitem__(n,_b_.int.$factory(o));throw _b_.TypeError.$factory("string indices must be integers")},surrogate.__hash__=function(n){return str.__hash__(n.items.join(""))},surrogate.__iter__=function(n){return str_iterator.$factory(n.items)},surrogate.__len__=function(n){return n.items.length},surrogate.__repr__=function(n){return str.__repr__(n.items.join(""))},surrogate.__str__=function(n){return str.__str__(n.items.join(""))},$B.set_func_names(surrogate,"builtins")}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);var str_hash=_b_.str.__hash__,$N=_b_.None,set_ops=["eq","le","lt","ge","gt","sub","rsub","and","or","xor"];function is_sublist(n,o){for(var l=0,x=n.length;l<x;l++){for(var B=n[l],D=!1,G=0,M=o.length;G<M;G++)if($B.rich_comp("__eq__",B,o[G])){o.splice(G,1),D=!0;break}if(!D)return!1}return!0}dict_view_op={__eq__:function(n,o){return n.length==o.length&&is_sublist(n,o)},__ne__:function(n,o){return!dict_view_op.__eq__(n,o)},__lt__:function(n,o){return n.length<o.length&&is_sublist(n,o)},__gt__:function(n,o){return dict_view_op.__lt__(o,n)},__le__:function(n,o){return n.length<=o.length&&is_sublist(n,o)},__ge__:function(n,o){return dict_view_op.__le__(o,n)},__and__:function(n,o){for(var l=[],x=0,B=n.length;x<B;x++){var D=n[x];flag=!1;for(var G=0,M=o.length;G<M;G++)if($B.rich_comp("__eq__",D,o[G])){o.splice(G,1),l.push(D);break}}return l},__or__:function(n,o){for(var l=n,x=0,B=o.length;x<B;x++){for(var D=o[x],G=!1,M=0,P=n.length;M<P;M++)if($B.rich_comp("__eq__",D,n[M])){o.splice(x,1),G=!0;break}G||l.push(D)}return l}},$B.make_view=function(n){for(var o=$B.make_class(n,function(D,G){return{__class__:o,__dict__:$B.empty_dict(),counter:-1,items:D,len:D.length,set_like:G}}),l=0,x=set_ops.length;l<x;l++){var B="__"+set_ops[l]+"__";o[B]=function(D){return function(G,M){if(G.set_like)return _b_.set[D](_b_.set.$factory(G),_b_.set.$factory(M));if(M.__class__!==o)return!1;var P=_b_.list.$factory(M);return dict_view_op[D](G.items,P)}}(B)}return o.__iter__=function(D){var G=o.$iterator.$factory(D.items);return G.len_func=D.len_func,G},o.__len__=function(D){return D.len},o.__repr__=function(D){return o.$infos.__name__+"("+_b_.repr(D.items)+")"},$B.set_func_names(o,"builtins"),o};var dict={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"dict"},$is_class:!0,$native:!0};function to_list(n,o){var l=[];if(n.$jsobj){for(var x in l=[],n.$jsobj)if("$"!=x.charAt(0)){var B=n.$jsobj[x];void 0===B?B=_b_.NotImplemented:null===B&&(B=$N),l.push([x,B])}}else if(_b_.isinstance(n,_b_.dict)){for(var D in n.$numeric_dict)l.push([parseFloat(D),n.$numeric_dict[D]]);for(var D in n.$string_dict)l.push([D,n.$string_dict[D]]);for(var D in n.$object_dict)n.$object_dict[D].forEach(function(M){l.push(M)});l.sort(function(G,M){return G[1][1]-M[1][1]}),l=l.map(function(G){return[G[0],G[1][0]]})}return void 0!==o?l.map(function(G){return G[o]}):(l.__class__=_b_.tuple,l.map(function(G){return G.__class__=_b_.tuple,G}))}function dict_iterator_next(n){if(n.len_func()!=n.len)throw _b_.RuntimeError.$factory("dictionary changed size during iteration");if(n.counter++,n.counter<n.items.length)return n.items[n.counter];throw _b_.StopIteration.$factory("StopIteration")}dict.$to_obj=function(n){var o={};for(var l in n.$string_dict)o[l]=n.$string_dict[l][0];return o},$B.dict_to_list=to_list;var $copy_dict=function(n,o){var l=to_list(o),x=dict.$setitem;o.$version=o.$version||0;for(var B=o.$version||0,D=0,G=l.length;D<G;D++)if(x(n,l[D][0],l[D][1]),o.$version!=B)throw _b_.RuntimeError.$factory("dict mutated during update")};function rank(n,o,l){var x=n.$object_dict[o];if(void 0!==x)for(var B=0,D=x.length;B<D;B++)if($B.rich_comp("__eq__",l,x[B][0]))return B;return-1}function init_from_list(n,o){for(var l=-1,x=o.length-1,B=dict.__setitem__;l++<x;){var D=o[l];switch(typeof D[0]){case"string":n.$string_dict[D[0]]=[D[1],n.$order++],n.$str_hash[str_hash(D[0])]=D[0],n.$version++;break;case"number":if(0!=D[0]&&1!=D[0]){n.$numeric_dict[D[0]]=[D[1],n.$order++],n.$version++;break}default:B(n,D[0],D[1])}}}dict.__bool__=function(){var n=$B.args("__bool__",1,{self:null},["self"],arguments,{},null,null);return dict.__len__(n.self)>0},dict.__class_getitem__=function(n,o){return Array.isArray(o)||(o=[o]),$B.GenericAlias.$factory(n,o)},dict.__contains__=function(){var n=$B.args("__contains__",2,{self:null,key:null},["self","key"],arguments,{},null,null),o=n.self,l=n.key;if(o.$is_namespace&&(l=$B.to_alias(l)),o.$jsobj)return void 0!==o.$jsobj[l];switch(typeof l){case"string":return void 0!==o.$string_dict[l];case"number":return void 0!==o.$numeric_dict[l]}var x=_b_.hash(l);return!(void 0===o.$str_hash[x]||!$B.rich_comp("__eq__",l,o.$str_hash[x]))||!(void 0===o.$numeric_dict[x]||!$B.rich_comp("__eq__",l,x))||rank(o,x,l)>-1},dict.__delitem__=function(){var n=$B.args("__eq__",2,{self:null,arg:null},["self","arg"],arguments,{},null,null),o=n.self,l=n.arg;if(o.$jsobj){if(void 0===o.$jsobj[l])throw _b_.KeyError.$factory(l);return delete o.$jsobj[l],$N}switch(typeof l){case"string":if(void 0===o.$string_dict[l])throw _b_.KeyError.$factory(_b_.str.$factory(l));return delete o.$string_dict[l],delete o.$str_hash[str_hash(l)],o.$version++,$N;case"number":if(void 0===o.$numeric_dict[l])throw _b_.KeyError.$factory(_b_.str.$factory(l));return delete o.$numeric_dict[l],o.$version++,$N}var x,B=_b_.hash(l);if(!((x=rank(o,B,l))>-1))throw _b_.KeyError.$factory(_b_.str.$factory(l));return o.$object_dict[B].splice(x,1),o.$version++,$N},dict.__eq__=function(){var n=$B.args("__eq__",2,{self:null,other:null},["self","other"],arguments,{},null,null),o=n.self,l=n.other;if(!_b_.isinstance(l,dict)||(o.$jsobj&&(o=jsobj2dict(o.$jsobj)),l.$jsobj&&(l=jsobj2dict(l.$jsobj)),dict.__len__(o)!=dict.__len__(l))||o.$string_dict.length!=l.$string_dict.length)return!1;for(var x in o.$numeric_dict)if(l.$numeric_dict.hasOwnProperty(x)){if(!$B.rich_comp("__eq__",l.$numeric_dict[x][0],o.$numeric_dict[x][0]))return!1}else{if(!l.$object_dict.hasOwnProperty(x))return!1;for(var B=!1,D=0,G=(P=l.$object_dict[x]).length;D<G;D++)if($B.rich_comp("__eq__",x,P[D][0])&&$B.rich_comp("__eq__",o.$numeric_dict[x],P[D][1])){B=!0;break}if(!B)return!1}for(var x in o.$string_dict)if(!l.$string_dict.hasOwnProperty(x)||!$B.rich_comp("__eq__",l.$string_dict[x][0],o.$string_dict[x][0]))return!1;for(var M in o.$object_dict){var P=o.$object_dict[M],fe=[];if(void 0!==l.$numeric_dict[M]&&fe.push([M,l.$numeric_dict[M]]),void 0!==l.$object_dict[M]&&(fe=fe.concat(l.$object_dict[M])),0==fe.length)return!1;D=0;for(var ye=P.length;D<ye;D++){B=!1;for(var ne=P[D][0],ue=P[D][1][0],me=0,ie=fe.length;me<ie;me++)if($B.rich_comp("__eq__",ne,fe[me][0])&&$B.rich_comp("__eq__",ue,fe[me][1][0])){B=!0;break}if(!B)return!1}}return!0},dict.__getitem__=function(){var n=$B.args("__getitem__",2,{self:null,arg:null},["self","arg"],arguments,{},null,null);return dict.$getitem(n.self,n.arg)},dict.$getitem=function(n,o){if(n.$jsobj){if(void 0===n.$jsobj[o]){if(n.$jsobj.hasOwnProperty(o))return $B.Undefined;throw _b_.KeyError.$factory(o)}return n.$jsobj[o]}switch(typeof o){case"string":if(void 0!==n.$string_dict[o])return n.$string_dict[o][0];break;case"number":if(void 0!==n.$numeric_dict[o])return n.$numeric_dict[o][0]}var l=_b_.hash(o),x=function(P){return $B.rich_comp("__eq__",o,P)};"object"==typeof o&&(o.$hash=l);var B=n.$str_hash[l];if(void 0!==B&&x(B))return n.$string_dict[B][0];if(void 0!==n.$numeric_dict[l]&&x(l))return n.$numeric_dict[l][0];if(_b_.isinstance(o,_b_.str)){var D=n.$string_dict[o.valueOf()];if(void 0!==D)return D[0]}var G=rank(n,l,o);if(G>-1)return n.$object_dict[l][G][1][0];if(n.__class__!==dict){try{var M=getattr(n.__class__,"__missing__",_b_.None)}catch(P){console.log(P)}if(M!==_b_.None)return M(n,o)}throw _b_.KeyError.$factory(o)},dict.__hash__=_b_.None,dict.__init__=function(n,o,l){var x;if(void 0===o)return $N;if(void 0===l){if("kw"!=o.$nat&&$B.get_class(o)===$B.JSObj){for(var B in o)n.$string_dict[B]=[o[B],n.$order++];return _b_.None}if(o.$jsobj){for(var D in n.$jsobj={},o.$jsobj)n.$jsobj[D]=o.$jsobj[D];return $N}if(Array.isArray(o))return init_from_list(n,o),$N}var G=(x=x||$B.args("dict",1,{self:null},["self"],arguments,{},"first","second")).first;if(G.length>1)throw _b_.TypeError.$factory("dict expected at most 1 argument, got 2");if(1==G.length)if((G=G[0]).__class__===dict)["$string_dict","$str_hash","$numeric_dict","$object_dict"].forEach(function(ue){for(B in G[ue])n[ue][B]=G[ue][B]});else if(_b_.isinstance(G,dict))$copy_dict(n,G);else{var M=$B.$getattr(G,"keys",null);if(null!==M){var P=$B.$getattr(G,"__getitem__",null);if(null!==P){P=$B.$call(P);for(var fe=_b_.iter($B.$call(M)());;)try{var ye=P(B=_b_.next(fe));dict.__setitem__(n,B,ye)}catch(ue){if(ue.__class__===_b_.StopIteration)break;throw ue}return $N}}Array.isArray(G)||(G=_b_.list.$factory(G)),init_from_list(n,G)}var ne=x.second.$string_dict;for(var D in ne)switch(typeof D){case"string":n.$string_dict[D]=[ne[D][0],n.$order++],n.$str_hash[str_hash(D)]=D;break;case"number":n.$numeric_dict[D]=[ne[D][0],n.$order++];break;default:si(n,D,ne[D][0])}return $N},dict.__iter__=function(n){return _b_.iter(dict.$$keys(n))},dict.__ior__=function(n,o){return dict.update(n,o),n},dict.__len__=function(n){var o=0;if(n.$jsobj){for(var l in n.$jsobj)"$"!=l.charAt(0)&&o++;return o}for(var x in n.$numeric_dict)o++;for(var x in n.$string_dict)o++;for(var B in n.$object_dict)o+=n.$object_dict[B].length;return o},dict.__ne__=function(n,o){return!dict.__eq__(n,o)},dict.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("int.__new__(): not enough arguments");var o={__class__:n,$numeric_dict:{},$object_dict:{},$string_dict:{},$str_hash:{},$version:0,$order:0};return n!==dict&&(o.__dict__=$B.empty_dict()),o},dict.__or__=function(n,o){if(!_b_.isinstance(o,dict))return _b_.NotImplemented;var l=dict.copy(n);return dict.update(l,o),l},dict.__repr__=function(n){if(n.$jsobj)return dict.__repr__(jsobj2dict(n.$jsobj));if($B.repr.enter(n))return"{...}";var o=[];return to_list(n).forEach(function(l){try{o.push(repr(l[0])+": "+repr(l[1]))}catch(x){throw x}}),$B.repr.leave(n),"{"+o.join(", ")+"}"},dict.__ror__=function(n,o){if(!_b_.isinstance(o,dict))return _b_.NotImplemented;var l=dict.copy(o);return dict.update(l,n),l},dict.__setitem__=function(n,o,l){var x=$B.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);return dict.$setitem(x.self,x.key,x.value)},dict.$setitem=function(n,o,l,x){if(n.$jsobj)return n.$from_js&&(l=$B.pyobj2jsobj(l)),n.$jsobj.__class__===_b_.type?(n.$jsobj[o]=l,"__init__"!=o&&"__new__"!=o||(n.$jsobj.$factory=$B.$instance_creator(n.$jsobj))):n.$jsobj[o]=l,$N;switch(typeof o){case"string":return void 0===n.$string_dict&&console.log("pas de string dict",n,o,l),void 0!==n.$string_dict[o]?n.$string_dict[o][0]=l:(n.$string_dict[o]=[l,n.$order++],n.$str_hash[str_hash(o)]=o,n.$version++),$N;case"number":if(void 0!==n.$numeric_dict[o])n.$numeric_dict[o][0]=l;else{var B=!1;if((0==o||1==o)&&void 0!==n.$object_dict[o])for(const ne of n.$object_dict[o])(0==o&&!1===ne[0]||1==o&&!0===ne[0])&&(ne[1][0]=l,B=!0);B||(n.$numeric_dict[o]=[l,n.$order++]),n.$version++}return $N;case"boolean":var D=o?1:0;if(void 0!==n.$numeric_dict[D])return void(n.$numeric_dict[D]=[l,n.$numeric_dict[D][1]]);void 0!==n.$object_dict[D]?n.$object_dict[D].push([o,[l,n.$order++]]):n.$object_dict[D]=[[o,[l,n.$order++]]]}var M=void 0===x?_b_.hash(o):x,P=function(ne){return $B.rich_comp("__eq__",o,ne)};if(void 0!==n.$numeric_dict[M]&&P(M))return n.$numeric_dict[M]=[l,n.$numeric_dict[M][1]],n.$version++,$N;var fe=n.$str_hash[M];if(void 0!==fe&&P(fe))return n.$string_dict[fe]=[l,n.$string_dict[fe][1]],n.$version++,$N;if(x)return void 0!==n.$object_dict[x]?n.$object_dict[x].push([o,[l,n.$order++]]):n.$object_dict[x]=[[o,[l,n.$order++]]],n.$version++,$N;var ye=rank(n,M,o);return ye>-1?(n.$object_dict[M][ye][1]=[l,n.$object_dict[M][ye][1][1]],$N):(n.$object_dict.hasOwnProperty(M)?n.$object_dict[M].push([o,[l,n.$order++]]):n.$object_dict[M]=[[o,[l,n.$order++]]],n.$version++,$N)},dict.__str__=function(){return dict.__repr__.apply(null,arguments)},$B.make_rmethods(dict),dict.clear=function(){var n=$B.args("clear",1,{self:null},["self"],arguments,{},null,null).self;if(n.$numeric_dict={},n.$string_dict={},n.$str_hash={},n.$object_dict={},n.$jsobj)for(var o in n.$jsobj)"$"!==o.charAt(0)&&"__class__"!==o&&delete n.$jsobj[o];return n.$version++,n.$order=0,$N},dict.copy=function(n){n=$B.args("copy",1,{self:null},["self"],arguments,{},null,null).self;var o=$B.empty_dict();return $copy_dict(o,n),o},dict.fromkeys=function(){for(var n=$B.args("fromkeys",3,{cls:null,keys:null,value:null},["cls","keys","value"],arguments,{value:_b_.None},null,null),o=n.keys,l=n.value,x=n.cls,B=$B.$call(x)(),D=$B.$iter(o);;)try{var G=_b_.next(D);x===dict?dict.$setitem(B,G,l):$B.$getattr(B,"__setitem__")(G,l)}catch(M){if($B.is_exc(M,[_b_.StopIteration]))return B;throw M}},dict.get=function(){var n=$B.args("get",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:$N},null,null);try{return dict.__getitem__(n.self,n.key)}catch(o){if(_b_.isinstance(o,_b_.KeyError))return n._default;throw o}};var dict_items=$B.make_view("dict_items",!0);dict_items.$iterator=$B.make_iterator_class("dict_itemiterator"),dict.items=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("items() takes no arguments ("+(arguments.length-1)+" given)");for(var l=to_list(n),x=!0,B=0,D=l.length;B<D;B++)try{_b_.hash(l[B][1])}catch{x=!1;break}var G=dict_items.$factory(to_list(n),x);return G.len_func=function(){return dict.__len__(n)},G};var dict_keys=$B.make_view("dict_keys");dict_keys.$iterator=$B.make_iterator_class("dict_keyiterator"),dict.$$keys=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("keys() takes no arguments ("+(arguments.length-1)+" given)");var l=dict_keys.$factory(to_list(n,0),!0);return l.len_func=function(){return dict.__len__(n)},l},dict.pop=function(){var n={},o=$B.args("pop",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:n},null,null),l=o.self,x=o.key,B=o._default;try{var D=dict.__getitem__(l,x);return dict.__delitem__(l,x),D}catch(G){if(G.__class__===_b_.KeyError){if(B!==n)return B;throw G}throw G}},dict.popitem=function(n){try{var o=_b_.next(_b_.iter(dict.items(n)));return dict.__delitem__(n,o[0]),_b_.tuple.$factory(o)}catch(l){if(l.__class__==_b_.StopIteration)throw _b_.KeyError.$factory("'popitem(): dictionary is empty'")}},dict.setdefault=function(){var n=$B.args("setdefault",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:$N},null,null),o=n.self,l=n.key,x=n._default;try{return dict.__getitem__(o,l)}catch(D){if(D.__class__!==_b_.KeyError)throw D;void 0===x&&(x=$N);var B=l.$hash;return l.$hash=void 0,dict.$setitem(o,l,x,B),x}},dict.update=function(n){var o=$B.args("update",1,{self:null},["self"],arguments,{},"args","kw"),l=(n=o.self,o.args),x=o.kw;if(l.length>0){var B=l[0];if(_b_.isinstance(B,dict))B.$jsobj&&(B=jsobj2dict(B.$jsobj)),$copy_dict(n,B);else if(_b_.hasattr(B,"keys"))for(var D=_b_.list.$factory($B.$call($B.$getattr(B,"keys"))()),G=0,M=D.length;G<M;G++){var P=getattr(B,"__getitem__")(D[G]);dict.$setitem(n,D[G],P)}else{var fe=_b_.iter(B);for(G=0;;){try{var ye=_b_.next(fe)}catch(ne){if(ne.__class__===_b_.StopIteration)break;throw ne}try{key_value=_b_.list.$factory(ye)}catch{throw _b_.TypeError.$factory("cannot convert dictionary update sequence element #"+G+" to a sequence")}if(2!==key_value.length)throw _b_.ValueError.$factory("dictionary update sequence element #"+G+" has length "+key_value.length+"; 2 is required");dict.$setitem(n,key_value[0],key_value[1]),G++}}}return $copy_dict(n,x),n.$version++,$N};var dict_values=$B.make_view("dict_values");dict_values.$iterator=$B.make_iterator_class("dict_valueiterator"),dict.values=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("values() takes no arguments ("+(arguments.length-1)+" given)");to_list(n,1);var l=dict_values.$factory(to_list(n,1),!1);return l.len_func=function(){return dict.__len__(n)},l},dict.$factory=function(){for(var n=dict.__new__(dict),o=[n],l=0,x=arguments.length;l<x;l++)o.push(arguments[l]);return dict.__init__.apply(null,o),n},_b_.dict=dict,$B.set_func_names(dict,"builtins"),dict.__class_getitem__=_b_.classmethod.$factory(dict.__class_getitem__),$B.empty_dict=function(){return{__class__:dict,$numeric_dict:{},$object_dict:{},$string_dict:{},$str_hash:{},$version:0,$order:0}},dict.fromkeys=_b_.classmethod.$factory(dict.fromkeys),$B.getset_descriptor=$B.make_class("getset_descriptor",function(n,o){return{__class__:$B.getset_descriptor,__doc__:_b_.None,cls:n,attr:o}}),$B.getset_descriptor.__repr__=$B.getset_descriptor.__str__=function(n){return`<attribute '${n.attr}' of '${n.cls.$infos.__name__}' objects>`},$B.set_func_names($B.getset_descriptor,"builtins");var mappingproxy=$B.mappingproxy=$B.make_class("mappingproxy",function(n){if(_b_.isinstance(n,dict))var o=$B.obj_dict(dict.$to_obj(n));else o=$B.obj_dict(n);return o.__class__=mappingproxy,o});for(var attr in mappingproxy.__setitem__=function(){throw _b_.TypeError.$factory("'mappingproxy' object does not support item assignment")},dict)void 0!==mappingproxy[attr]||["__class__","__mro__","__new__","__init__","__delitem__","clear","fromkeys","pop","popitem","setdefault","update"].indexOf(attr)>-1||(mappingproxy[attr]="function"==typeof dict[attr]?function(n){return function(){return dict[n].apply(null,arguments)}}(attr):dict[attr]);function jsobj2dict(n){var o=$B.empty_dict();for(var l in n)if("$"!=l.charAt(0)&&"__class__"!==l)if(null===n[l])o.$string_dict[l]=[_b_.None,o.$order++];else{if(void 0===n[l])continue;o.$string_dict[l]=n[l].$jsobj===n?[o,o.$order++]:[$B.$JS2Py(n[l]),o.$order++]}return o}$B.set_func_names(mappingproxy,"builtins"),$B.obj_dict=function(n,o){var l=n.__class__||$B.get_class(n);if(void 0!==l&&l.$native)throw _b_.AttributeError.$factory(l.__name__+" has no attribute '__dict__'");var x=$B.empty_dict();return x.$jsobj=n,x.$from_js=o,x}}(__BRYTHON__),function(n){var o=n.builtins,l=o.object,x=self;function B(K){var be=0,Ne=0,je=K.width||K.offsetWidth,Te=K.height||K.offsetHeight;for(document;K.offsetParent;)be+=K.offsetLeft,Ne+=K.offsetTop,K=K.offsetParent;if(be+=K.offsetLeft||0,Ne+=K.offsetTop||0,K.parentElement){var qe=B(K.parentElement);be+=qe.left,Ne+=qe.top}return{left:be,top:Ne,width:je,height:Te}}function D(K){if(K.type.startsWith("touch"))return(be={}).x=o.int.$factory(K.touches[0].screenX),be.y=o.int.$factory(K.touches[0].screenY),be.__getattr__=function(Te){return this[Te]},be.__class__="MouseCoords",be;var be,Ne=0,je=0;return K||(K=x.event),K.pageX||K.pageY?(Ne=K.pageX,je=K.pageY):(K.clientX||K.clientY)&&(Ne=K.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,je=K.clientY+document.body.scrollTop+document.documentElement.scrollTop),(be={}).x=o.int.$factory(Ne),be.y=o.int.$factory(je),be.__getattr__=function(Te){return this[Te]},be.__class__="MouseCoords",be}n.$isNode=function(K){return"object"==typeof Node?K instanceof Node:K&&"object"==typeof K&&"number"==typeof K.nodeType&&"string"==typeof K.nodeName},n.$isNodeList=function(K){try{var be=Object.prototype.toString.call(K),Ne=new RegExp("^\\[object (HTMLCollection|NodeList)\\]$");return"object"==typeof K&&null!==Ne.exec(be)&&void 0!==K.length&&(0==K.length||"object"==typeof K[0]&&K[0].nodeType>0)}catch{return!1}};var G=["NONE","CAPTURING_PHASE","AT_TARGET","BUBBLING_PHASE","type","target","currentTarget","eventPhase","bubbles","cancelable","timeStamp","stopPropagation","preventDefault","initEvent"],M=["altKey","altLeft","button","cancelBubble","clientX","clientY","contentOverflow","ctrlKey","ctrlLeft","data","dataFld","dataTransfer","fromElement","keyCode","nextPage","offsetX","offsetY","origin","propertyName","reason","recordset","repeat","screenX","screenY","shiftKey","shiftLeft","source","srcElement","srcFilter","srcUrn","toElement","type","url","wheelDelta","x","y"];n.$isEvent=function(K){for(var be=!0,Ne=0;Ne<G.length;Ne++)if(void 0===K[G[Ne]]){be=!1;break}if(be)return!0;for(Ne=0;Ne<M.length;Ne++)if(void 0===K[M[Ne]])return!1;return!0};var P={1:"ELEMENT",2:"ATTRIBUTE",3:"TEXT",4:"CDATA_SECTION",5:"ENTITY_REFERENCE",6:"ENTITY",7:"PROCESSING_INSTRUCTION",8:"COMMENT",9:"DOCUMENT",10:"DOCUMENT_TYPE",11:"DOCUMENT_FRAGMENT",12:"NOTATION"},fe=n.make_class("Attributes",function(K){return{__class__:fe,elt:K}});fe.__contains__=function(){var K=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);return K.self.elt instanceof SVGElement?K.self.elt.hasAttributeNS(null,K.key):"function"==typeof K.self.elt.hasAttribute&&K.self.elt.hasAttribute(K.key)},fe.__delitem__=function(){var K=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);if(!fe.__contains__(K.self,K.key))throw o.KeyError.$factory(K.key);return K.self.elt instanceof SVGElement?(K.self.elt.removeAttributeNS(null,K.key),o.None):"function"==typeof K.self.elt.hasAttribute?(K.self.elt.removeAttribute(K.key),o.None):void 0},fe.__getitem__=function(){var K=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);if(K.self.elt instanceof SVGElement&&K.self.elt.hasAttributeNS(null,K.key))return K.self.elt.getAttributeNS(null,K.key);if("function"==typeof K.self.elt.hasAttribute&&K.self.elt.hasAttribute(K.key))return K.self.elt.getAttribute(K.key);throw o.KeyError.$factory(K.key)},fe.__iter__=function(K){K.$counter=0;for(var be=K.elt.attributes,Ne=[],je=0;je<be.length;je++)Ne.push(be[je].name);return K.$items=Ne,K},fe.__next__=function(){var K=n.args("__next__",1,{self:null},["self"],arguments,{},null,null);if(K.self.$counter<K.self.$items.length){var be=K.self.$items[K.self.$counter];return K.self.$counter++,be}throw o.StopIteration.$factory("")},fe.__setitem__=function(){var K=n.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);if(K.self.elt instanceof SVGElement&&"function"==typeof K.self.elt.setAttributeNS)return K.self.elt.setAttributeNS(null,K.key,K.value),o.None;if("function"==typeof K.self.elt.setAttribute)return K.self.elt.setAttribute(K.key,K.value),o.None;throw o.TypeError.$factory("Can't set attributes on element")},fe.__repr__=fe.__str__=function(K){for(var be=K.elt.attributes,Ne=[],je=0;je<be.length;je++)Ne.push(be[je].name+': "'+K.elt.getAttributeNS(null,be[je].name)+'"');return"{"+Ne.join(", ")+"}"},fe.get=function(){var K=n.args("get",3,{self:null,key:null,deflt:null},["self","key","deflt"],arguments,{deflt:o.None},null,null);try{return fe.__getitem__(K.self,K.key)}catch(be){if(be.__class__===o.KeyError)return K.deflt;throw be}},fe.keys=function(){return fe.__iter__.apply(null,arguments)},fe.items=function(){for(var K=n.args("values",1,{self:null},["self"],arguments,{},null,null).self.attributes,be=[],Ne=0;Ne<K.length;Ne++)be.push([K[Ne].name,K[Ne].value]);return o.list.__iter__(be)},fe.values=function(){for(var K=n.args("values",1,{self:null},["self"],arguments,{},null,null).self.attributes,be=[],Ne=0;Ne<K.length;Ne++)be.push(K[Ne].value);return o.list.__iter__(be)},n.set_func_names(fe,"<dom>");var ye=n.DOMEvent={__class__:o.type,__mro__:[l],$infos:{__name__:"DOMEvent"}};function ne(K,be){var Ne=K.createSVGPoint();return Ne.x=be.x,Ne.y=be.y,Ne.matrixTransform(K.getScreenCTM().inverse())}ye.__new__=function(K,be){var Ne=new Event(be);return Ne.__class__=ye,void 0===Ne.preventDefault&&(Ne.preventDefault=function(){Ne.returnValue=!1}),void 0===Ne.stopPropagation&&(Ne.stopPropagation=function(){Ne.cancelBubble=!0}),Ne},ye.__getattribute__=function(K,be){switch(be){case"__repr__":case"__str__":return function(){return"<DOMEvent object>"};case"x":return D(K).x;case"y":return D(K).y;case"data":return null!==K.dataTransfer?me.$factory(K.dataTransfer):n.$JS2Py(K.data);case"target":if(void 0!==K.target)return A.$factory(K.target);case"char":return String.fromCharCode(K.which);case"svgX":if(K.target instanceof SVGSVGElement)return Math.floor(ne(K.target,D(K)).x);throw o.AttributeError.$factory("event target is not an SVG element");case"svgY":if(K.target instanceof SVGSVGElement)return Math.floor(ne(K.target,D(K)).y);throw o.AttributeError.$factory("event target is not an SVG element")}var Ne=K[be];if(void 0!==Ne){if("function"==typeof Ne){var je=function(){for(var Te=[],qe=0;qe<arguments.length;qe++)Te.push(n.pyobj2jsobj(arguments[qe]));return Ne.apply(K,arguments)};return je.$infos={__name__:Ne.name,__qualname__:Ne.name},je}return n.$JS2Py(Ne)}throw o.AttributeError.$factory("object DOMEvent has no attribute '"+be+"'")},ye.$factory=function(K){return ye.__new__(ye,K)};var ue=n.$DOMEvent=function(K){return K.__class__=ye,K.$no_dict=!0,void 0===K.preventDefault&&(K.preventDefault=function(){K.returnValue=!1}),void 0===K.stopPropagation&&(K.stopPropagation=function(){K.cancelBubble=!0}),K};n.set_func_names(ye,"browser");var me={__class__:o.type,$infos:{__module__:"browser",__name__:"Clipboard"},__getitem__:function(K,be){return K.data.getData(be)}};me.__mro__=[l],me.__setitem__=function(K,be,Ne){K.data.setData(be,Ne)},me.$factory=function(K){return{__class__:me,__dict__:n.empty_dict(),data:K}},n.set_func_names(me,"<dom>");var ie=n.OpenFile={__class__:o.type,__mro__:[l],$infos:{__module__:"<pydom>",__name__:"OpenFile"}};ie.$factory=function(K,be,Ne){var je={__class__:$OpenFileDict,file:K,reader:new FileReader};return"r"===be?je.reader.readAsText(K,Ne):"rb"===be&&je.reader.readAsBinaryString(K),je},ie.__getattr__=function(K,be){return void 0!==K["get_"+be]?K["get_"+be]:K.reader[be]},ie.__setattr__=function(K,be,Ne){var je=K.reader;if("on"==be.substr(0,2))je.addEventListener(be.substr(2),function(Te){return Ne(ue(Te))});else{if("set_"+be in je)return je["set_"+be](Ne);be in je?je[be]=Ne:setattr(je,be,Ne)}},n.set_func_names(ie,"<dom>");var W={File:function(){},FileReader:function(){}};W.File.__class__=o.type,W.File.__str__=function(){return"<class 'File'>"},W.FileReader.__class__=o.type,W.FileReader.__str__=function(){return"<class 'FileReader'>"};var Q={__class__:o.type,__delitem__:function(K,be){K.parent.options.remove(be.elt)},__getitem__:function(K,be){return A.$factory(K.parent.options[be])},__len__:function(K){return K.parent.options.length},__mro__:[l],__setattr__:function(K,be,Ne){K.parent.options[be]=Ne},__setitem__:function(K,be,Ne){K.parent.options[be]=n.$JS2Py(Ne)},__str__:function(K){return"<object Options wraps "+K.parent.options+">"},append:function(K,be){K.parent.options.add(be.elt)},insert:function(K,be,Ne){void 0===be?K.parent.options.add(Ne.elt):K.parent.options.add(Ne.elt,be)},item:function(K,be){return K.parent.options.item(be)},namedItem:function(K,be){return K.parent.options.namedItem(be)},remove:function(K,be){K.parent.options.remove(be.elt)},$infos:{__module__:"<pydom>",__name__:"Options"},$factory:function(K){return{__class__:Q,parent:K}}};n.set_func_names(Q,"<dom>");var A={__class__:o.type,__mro__:[l],$infos:{__module__:"browser",__name__:"DOMNode"}};function R(K){for(var be=[],Ne=0;Ne<K.length;Ne++)be.push(A.$factory(K[Ne]));return be}A.$factory=function(K,be){if(K.__class__===A||"number"==typeof K||"boolean"==typeof K||"string"==typeof K)return K;if(void 0===be&&void 0!==A.tags){var Ne=A.tags.$string_dict;if(void 0!==Ne&&Ne.hasOwnProperty(K.tagName)){try{var je=Ne[K.tagName][0]}catch(Te){throw console.log("tdict",Ne,"tag name",K.tagName),Te}if(void 0!==je)return je.$elt_wrap=K,je.$factory()}}return void 0!==K.$brython_id&&9!=K.nodeType||(K.$brython_id="DOM-"+n.UUID()),K},A.__add__=function(K,be){var Ne=z.$factory();if(Ne.children=[K],pos=1,o.isinstance(be,z))Ne.children=Ne.children.concat(be.children);else if(o.isinstance(be,[o.str,o.int,o.float,o.list,o.dict,o.set,o.tuple]))Ne.children[pos++]=A.$factory(document.createTextNode(o.str.$factory(be)));else if(o.isinstance(be,A))Ne.children[pos++]=be;else try{Ne.children=Ne.children.concat(o.list.$factory(be))}catch{throw o.TypeError.$factory("can't add '"+n.class_name(be)+"' object to DOMNode instance")}return Ne},A.__bool__=function(K){return!0},A.__contains__=function(K,be){if(9==K.nodeType&&"string"==typeof be)return null!==document.getElementById(be);if(void 0!==K.length&&"function"==typeof K.item)for(var Ne=0,je=K.length;Ne<je;Ne++)if(K.item(Ne)===be)return!0;return!1},A.__del__=function(K){if(!K.parentNode)throw o.ValueError.$factory("can't delete "+o.str.$factory(K));K.parentNode.removeChild(K)},A.__delattr__=function(K,be){if(void 0===K[be])throw o.AttributeError.$factory(`cannot delete DOMNode attribute '${be}'`);return delete K[be],o.None},A.__delitem__=function(K,be){if(9==K.nodeType){var Ne=K.getElementById(be);if(!Ne)throw o.KeyError.$factory(be);Ne.parentNode.removeChild(Ne)}else K.parentNode.removeChild(K)},A.__dir__=function(K){var be=[];for(var Ne in K)"$"!=Ne.charAt(0)&&be.push(Ne);return be.sort(),be},A.__eq__=function(K,be){return K==be},A.__getattribute__=function(K,be){switch("$$"==be.substr(0,2)&&(be=be.substr(2)),be){case"attrs":return fe.$factory(K);case"class_name":case"html":case"id":case"parent":case"text":return A[be](K);case"height":case"left":case"top":case"width":if("CANVAS"==K.tagName&&K[be])return K[be];if(K instanceof SVGElement)return K[be].baseVal.value;if(K.style[be])return parseInt(K.style[be]);var Ne=window.getComputedStyle(K)[be];if(void 0!==Ne)return Math.floor(parseFloat(Ne)+.5);throw o.AttributeError.$factory("style."+be+" is not set for "+o.str.$factory(K));case"x":case"y":if(!(K instanceof SVGElement)){var je=B(K);return"x"==be?je.left:je.top}case"clear":case"closest":return function(){return A[be](K,arguments[0])};case"headers":if(9==K.nodeType){var Te=new XMLHttpRequest;Te.open("GET",document.location,!1),Te.send(null);var qe=Te.getAllResponseHeaders();qe=qe.split("\r\n");for(var Ke=n.empty_dict(),vt=0;vt<qe.length;vt++){var ht=qe[vt];0!=ht.strip().length&&(je=ht.search(":"),Ke.__setitem__(ht.substr(0,je),ht.substr(je+1).lstrip()))}return Ke}break;case"$$location":be="location"}if("select"==be&&1==K.nodeType&&["INPUT","TEXTAREA"].indexOf(K.tagName.toUpperCase())>-1)return function(fn){return void 0===fn?(K.select(),o.None):A.select(K,fn)};if("query"==be&&9==K.nodeType){Ke={__class__:X,_keys:[],_values:{}};var Bt=location.search.substr(1).split("&");if(""!=location.search)for(vt=0;vt<Bt.length;vt++){je=Bt[vt].search("=");var wt=[Bt[vt].substr(0,je),Bt[vt].substr(je+1)],Ft=decodeURIComponent(wt[0]),Ot=decodeURIComponent(wt[1]);Ke._keys.indexOf(Ft)>-1?Ke._values[Ft].push(Ot):(Ke._keys.push(Ft),Ke._values[Ft]=[Ot])}return Ke}var on=K[be];if(void 0===on&&n.aliased_names[be]&&(on=K["$$"+be]),void 0===on){if(K.tagName){var ft=customElements.get(K.tagName.toLowerCase());if(void 0!==ft&&void 0!==ft.$cls){var An=K.__class__;K.__class__=ft.$cls;try{return Ke=o.object.__getattribute__(K,be),K.__class__=An,Ke}catch(fn){if(K.__class__=An,!n.is_exc(fn,[o.AttributeError]))throw fn}}}return l.__getattribute__(K,be)}if(void 0!==(Ke=on)){if(null===Ke)return o.None;if("function"==typeof Ke){var Cn=function(fn,On){return function(){for(var $n=[],_n=0,ar=0;ar<arguments.length;ar++){var nr=arguments[ar];if("function"==typeof nr){if(nr.$cache)var lr=nr.$cache;else lr=function(ti){return function(){try{return ti.apply(null,arguments)}catch(Zr){n.handle_error(Zr)}}}(nr),nr.$cache=lr;$n[_n++]=lr}else o.isinstance(nr,A)?$n[_n++]=nr:$n[_n++]=nr===o.None?null:nr.__class__==o.dict?o.dict.$to_obj(nr):nr}var rr=fn.apply(On,$n);return n.$JS2Py(rr)}}(Ke,K);return Cn.$infos={__name__:be,__qualname__:be},Cn.$is_func=!0,Cn}return"options"==be?Q.$factory(K):"style"==be?n.JSObj.$factory(K[be]):Array.isArray(Ke)?Ke:n.$JS2Py(Ke)}return l.__getattribute__(K,be)},A.__getitem__=function(K,be){if(9==K.nodeType){if("string"==typeof be){if(je=K.getElementById(be))return A.$factory(je);throw o.KeyError.$factory(be)}try{for(var Ne=K.getElementsByTagName(be.$infos.__name__),je=[],Te=0;Te<Ne.length;Te++)je.push(A.$factory(Ne[Te]));return je}catch{throw o.KeyError.$factory(o.str.$factory(be))}}else{if(("number"==typeof be||"boolean"==typeof be)&&"function"==typeof K.item){var qe=o.int.$factory(be);if(qe<0&&(qe+=K.length),void 0===(je=A.$factory(K.item(qe))))throw o.KeyError.$factory(be);return je}if("string"==typeof be&&K.attributes&&"function"==typeof K.attributes.getNamedItem){var Ke=K.attributes.getNamedItem(be);if(Ke)return Ke.value;throw o.KeyError.$factory(be)}}},A.__hash__=function(K){return void 0===K.__hashvalue__?K.__hashvalue__=n.$py_next_hash--:K.__hashvalue__},A.__iter__=function(K){if(void 0!==K.length&&"function"==typeof K.item)for(var be=[],Ne=0,je=K.length;Ne<je;Ne++)be.push(A.$factory(K.item(Ne)));else if(void 0!==K.childNodes)for(be=[],Ne=0,je=K.childNodes.length;Ne<je;Ne++)be.push(A.$factory(K.childNodes[Ne]));return n.$iter(be)},A.__le__=function(K,be){if(9==K.nodeType&&(K=K.body),o.isinstance(be,z))for(var Ne=0;Ne<be.children.length;Ne++)K.appendChild(be.children[Ne]);else if("string"==typeof be||"number"==typeof be){var je=document.createTextNode(be.toString());K.appendChild(je)}else if(o.isinstance(be,A))K.appendChild(be);else try{o.list.$factory(be).forEach(function(Te){A.__le__(K,Te)})}catch{throw o.TypeError.$factory("can't add '"+n.class_name(be)+"' object to DOMNode instance")}return!0},A.__len__=function(K){return K.length},A.__mul__=function(K,be){if(o.isinstance(be,o.int)&&be.valueOf()>0){for(var Ne=z.$factory(),je=Ne.children.length,Te=0;Te<be.valueOf();Te++)Ne.children[je++]=A.clone(K)();return Ne}throw o.ValueError.$factory("can't multiply "+K.__class__+"by "+be)},A.__ne__=function(K,be){return!A.__eq__(K,be)},A.__next__=function(K){if(K.$counter++,K.$counter<K.childNodes.length)return A.$factory(K.childNodes[K.$counter]);throw o.StopIteration.$factory("StopIteration")},A.__radd__=function(K,be){var Ne=z.$factory(),je=A.$factory(document.createTextNode(be));return Ne.children=[je,K],Ne},A.__str__=A.__repr__=function(K){var be=K.attributes;if(void 0!==be)for(var Ne=[],je=0;je<be.length;je++)Ne.push(be[je].name+'="'+K.getAttributeNS(null,be[je].name)+'"');var Te=Object.getPrototypeOf(K);if(Te){var qe=Te.constructor.name;if(void 0===qe){var Ke=Te.constructor.toString();qe=Ke.substring(8,Ke.length-1)}return Ne.splice(0,0,qe),"<"+Ne.join(" ")+">"}return"<DOMNode object type '"+P[K.nodeType]+"' name '"+K.nodeName+"'>"},A.__setattr__=function(K,be,Ne){if("on"!=be.substr(0,2)){let vt=function(ht){console.log(ht);var Bt=n.last(n.frames_stack);if(n.debug>0){var wt=Bt[1].$line_info.split(",");console.log("module",wt[1],"line",wt[0]),n.$py_src.hasOwnProperty(wt[1])&&console.log(n.$py_src[wt[1]].split("\n")[parseInt(wt[0])-1])}else console.log("module",Bt[2])};switch(be){case"left":case"top":case"width":case"height":if(o.isinstance(Ne,o.int)&&1==K.nodeType)return K.style[be]=Ne+"px",o.None;throw o.ValueError.$factory(be+" value should be an integer, not "+n.class_name(Ne))}if(void 0!==A["set_"+be])return A["set_"+be](K,Ne);for(var je=Object.getPrototypeOf(K),Te=0;je&&je!==Object.prototype&&Te++<10;){var qe=Object.getOwnPropertyDescriptors(je);if(!qe||"function"!=typeof qe.hasOwnProperty)break;if(qe.hasOwnProperty(be)){qe[be].writable||void 0!==qe[be].set||vt("Warning: property '"+be+"' is not writable. Use element.attrs['"+be+"'] instead.");break}je=Object.getPrototypeOf(je)}return K.style&&void 0!==K.style[be]&&vt("Warning: '"+be+"' is a property of element.style"),K[be]=Ne,o.None}n.$bool(Ne)?A.bind(K,be.substr(2),Ne):A.unbind(K,be.substr(2))},A.__setitem__=function(K,be,Ne){"number"==typeof be?K.childNodes[be]=Ne:"string"==typeof be&&K.attributes&&(K instanceof SVGElement?K.setAttributeNS(null,be,Ne):"function"==typeof K.setAttribute&&K.setAttribute(be,Ne))},A.abs_left={__get__:function(K){return B(K).left},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'abs_left' is read-only")}},A.abs_top={__get__:function(K){return B(K).top},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'abs_top' is read-only")}},A.attach=A.__le__,A.bind=function(K,be){var Ne=n.args("bind",4,{self:null,event:null,func:null,options:null},["self","event","func","options"],arguments,{func:o.None,options:o.None},null,null),je=(K=Ne.self,be=Ne.event,Ne.func),Te=Ne.options;if(je===o.None)return function(vt){return A.bind(K,be,vt)};var qe,Ke=(qe=je,function(vt){try{return qe(ue(vt))}catch(ht){if(void 0!==ht.__class__)n.handle_error(ht);else try{n.$getattr(n.stderr,"write")(ht)}catch{console.log(ht)}}});return Ke.$infos=je.$infos,Ke.$attrs=je.$attrs||{},Ke.$func=je,"boolean"==typeof Te?K.addEventListener(be,Ke,Te):Te.__class__===o.dict?K.addEventListener(be,Ke,o.dict.$to_obj(Te)):Te===o.None&&K.addEventListener(be,Ke,!1),K.$events=K.$events||{},K.$events[be]=K.$events[be]||[],K.$events[be].push([je,Ke]),K},A.children=function(K){var be=[];return 9==K.nodeType&&(K=K.body),K.childNodes.forEach(function(Ne){be.push(A.$factory(Ne))}),be},A.clear=function(K){for(9==K.nodeType&&(K=K.body);K.firstChild;)K.removeChild(K.firstChild)},A.Class=function(K){return void 0!==K.className?K.className:o.None},A.class_name=function(K){return A.Class(K)},A.clone=function(K){var be=A.$factory(K.cloneNode(!0)),Ne=K.$events||{};for(var je in Ne)Ne[je].forEach(function(Te){A.bind(be,je,Te[0])});return be},A.closest=function(K,be){var Ne=K.closest(be);if(null===Ne)throw o.KeyError.$factory("no parent with selector "+be);return A.$factory(Ne)},A.events=function(K,be){K.$events=K.$events||{};var Ne=K.$events[be]=K.$events[be]||[],je=[];return Ne.forEach(function(Te){je.push(Te[1])}),je},A.focus=function(K){return be=K,function(){setTimeout(function(){be.focus()},10)};var be},A.get=function(K){for(var be=[],Ne=1;Ne<arguments.length;Ne++)be.push(arguments[Ne]);var je=n.args("get",0,{},[],be,{},null,"kw"),Te={};if(o.list.$factory(o.dict.items(je.kw)).forEach(function(Ke){Te[Ke[0]]=Ke[1]}),void 0!==Te.name){if(void 0===K.getElementsByName)throw o.TypeError.$factory("DOMNode object doesn't support selection by name");return R(K.getElementsByName(Te.name))}if(void 0!==Te.tag){if(void 0===K.getElementsByTagName)throw o.TypeError.$factory("DOMNode object doesn't support selection by tag name");return R(K.getElementsByTagName(Te.tag))}if(void 0!==Te.classname){if(void 0===K.getElementsByClassName)throw o.TypeError.$factory("DOMNode object doesn't support selection by class name");return R(K.getElementsByClassName(Te.classname))}if(void 0!==Te.id){if(void 0===K.getElementById)throw o.TypeError.$factory("DOMNode object doesn't support selection by id");var qe=document.getElementById(Te.id);return qe?[A.$factory(qe)]:[]}if(void 0!==Te.selector){if(void 0===K.querySelectorAll)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");return R(K.querySelectorAll(Te.selector))}return res},A.getContext=function(K){if(!("getContext"in K))throw o.AttributeError.$factory("object has no attribute 'getContext'");return function(be){return n.JSObj.$factory(K.getContext(be))}},A.getSelectionRange=function(K){if(void 0!==K.getSelectionRange)return K.getSelectionRange.apply(null,arguments)},A.html=function(K){var be=K.innerHTML;return void 0===be&&(be=9==K.nodeType?K.body.innerHTML:o.None),be},A.id=function(K){return void 0!==K.id?K.id:o.None},A.index=function(K,be){var Ne;Ne=void 0===be?K.parentElement.childNodes:K.parentElement.querySelectorAll(be);for(var je=-1,Te=0;Te<Ne.length;Te++)if(Ne[Te]===K){je=Te;break}return je},A.inside=function(K,be){for(var Ne=K;;){if(be===Ne)return!0;if(!(Ne=Ne.parentElement))return!1}},A.options=function(K){return new $OptionsClass(K)},A.parent=function(K){return K.parentElement?A.$factory(K.parentElement):o.None},A.reset=function(K){return function(){K.reset()}},A.scrolled_left={__get__:function(K){return B(K).left-document.scrollingElement.scrollLeft},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'scrolled_left' is read-only")}},A.scrolled_top={__get__:function(K){return B(K).top-document.scrollingElement.scrollTop},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'scrolled_top' is read-only")}},A.select=function(K,be){if(void 0===K.querySelectorAll)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");return R(K.querySelectorAll(be))},A.select_one=function(K,be){if(void 0===K.querySelector)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");var Ne=K.querySelector(be);return null===Ne?o.None:A.$factory(Ne)},A.style=function(K){return K.style.float=K.style.cssFloat||K.styleFloat,n.JSObj.$factory(K.style)},A.setSelectionRange=function(K){return void 0!==this.setSelectionRange?(be=this,function(){return be.setSelectionRange.apply(be,arguments)}):void 0!==this.createTextRange?function(Ne){return function(je,Te){null==Te&&(Te=je);var qe=Ne.createTextRange();qe.collapse(!0),qe.moveEnd("character",je),qe.moveStart("character",Te),qe.select()}}(this):void 0;var be},A.set_class_name=function(K,be){K.setAttribute("class",be)},A.set_html=function(K,be){9==K.nodeType&&(K=K.body),K.innerHTML=o.str.$factory(be)},A.set_style=function(K,be){if(!o.isinstance(be,o.dict))throw o.TypeError.$factory("style must be dict, not "+n.class_name(be));for(var Ne=o.list.$factory(o.dict.items(be)),je=0;je<Ne.length;je++){var Te=Ne[je][0],qe=Ne[je][1];if("float"==Te.toLowerCase())K.style.cssFloat=qe,K.style.styleFloat=qe;else{switch(Te){case"top":case"left":case"width":case"borderWidth":o.isinstance(qe,o.int)&&(qe+="px")}K.style[Te]=qe}}},A.set_text=function(K,be){9==K.nodeType&&(K=K.body),K.innerText=o.str.$factory(be),K.textContent=o.str.$factory(be)},A.set_value=function(K,be){K.value=o.str.$factory(be)},A.submit=function(K){return function(){K.submit()}},A.text=function(K){9==K.nodeType&&(K=K.body);var be=K.innerText||K.textContent;return null===be&&(be=o.None),be},A.toString=function(K){return void 0===K?"DOMNode":K.nodeName},A.trigger=function(K,be){if(K.fireEvent)K.fireEvent("on"+be);else{var Ne=document.createEvent("Events");Ne.initEvent(be,!0,!1),K.dispatchEvent(Ne)}},A.unbind=function(K,be){if(K.$events=K.$events||{},K.$events==={})return o.None;if(void 0===be){for(var be in K.$events)A.unbind(K,be);return o.None}if(void 0===K.$events[be]||0==K.$events[be].length)return o.None;var Ne=K.$events[be];if(2==arguments.length){for(var je=0;je<Ne.length;je++){var Te=Ne[je][1];K.removeEventListener(be,Te,!1)}return K.$events[be]=[],o.None}for(je=2;je<arguments.length;je++){var qe=!1;if(void 0===(ht=(Te=arguments[je]).$func)){for(var Ke=!1,vt=0;vt<Ne.length;vt++)if(Ne[vt][0]===Te){var ht=Te;Ke=!0;break}if(!Ke)throw o.TypeError.$factory("function is not an event callback")}for(vt=0;vt<Ne.length;vt++)if(n.$getattr(ht,"__eq__")(Ne[vt][0])){K.removeEventListener(be,Te=Ne[vt][1],!1),Ne.splice(vt,1),qe=!0;break}if(!qe)throw o.KeyError.$factory("missing callback for event "+be)}},n.set_func_names(A,"browser");var X={__class__:o.type,__mro__:[o.object],$infos:{__name__:"query"},__contains__:function(K,be){return K._keys.indexOf(be)>-1},__getitem__:function(K,be){var Ne=K._values[be];if(void 0===Ne)throw o.KeyError.$factory(be);return 1==Ne.length?Ne[0]:Ne}},he=n.make_iterator_class("query string iterator");X.__iter__=function(K){return he.$factory(K._keys)},X.__setitem__=function(K,be,Ne){return K._values[be]=[Ne],o.None},X.__str__=X.__repr__=function(K){var be=[];for(var Ne in K._values)for(const je of K._values[Ne])be.push(encodeURIComponent(Ne)+"="+encodeURIComponent(je));return 0==be.length?"":"?"+be.join("&")},X.getfirst=function(K,be,Ne){var je=K._values[be];return void 0===je?void 0===Ne?o.None:Ne:je[0]},X.getlist=function(K,be){var Ne=K._values[be];return void 0===Ne?[]:Ne},X.getvalue=function(K,be,Ne){try{return X.__getitem__(K,be)}catch{return void 0===Ne?o.None:Ne}},X.keys=function(K){return K._keys},n.set_func_names(X,"<dom>");var z={__class__:o.type,__mro__:[l],$infos:{__module__:"<pydom>",__name__:"TagSum"},appendChild:function(K,be){K.children.push(be)},__add__:function(K,be){return n.get_class(be)===z?K.children=K.children.concat(be.children):o.isinstance(be,[o.str,o.int,o.float,o.dict,o.set,o.list])?K.children=K.children.concat(A.$factory(document.createTextNode(be))):K.children.push(be),K},__radd__:function(K,be){var Ne=z.$factory();return Ne.children=K.children.concat(A.$factory(document.createTextNode(be))),Ne},__repr__:function(K){for(var be="<object TagSum> ",Ne=0;Ne<K.children.length;Ne++)be+=K.children[Ne],"[object Text]"==K.children[Ne].toString()&&(be+=" ["+K.children[Ne].textContent+"]\n");return be}};z.__str__=z.toString=z.__repr__,z.clone=function(K){for(var be=z.$factory(),Ne=0;Ne<K.children.length;Ne++)be.children.push(K.children[Ne].cloneNode(!0));return be},z.$factory=function(){return{__class__:z,children:[],toString:function(){return"(TagSum)"}}},n.set_func_names(z,"<dom>"),n.TagSum=z;var Le=n.JSObj.$factory(x);Le.get_postMessage=function(K,be){if(o.isinstance(K,dict)){var Ne={__class__:"dict"};o.list.$factory(o.dict.items(K)).forEach(function(je){Ne[je[0]]=je[1]}),K=Ne}return x.postMessage(K,be)},n.DOMNode=A,n.win=Le}(__BRYTHON__),function($B){var _b_=$B.builtins,bltns=$B.InjectBuiltins();eval(bltns);var $GeneratorReturn={};$B.generator_return=function(n){return{__class__:$GeneratorReturn,value:n}},$B.generator=$B.make_class("generator",function(n){var o=function(){var l=n.apply(null,arguments);if(l.$name=n.name,l.$func=n,l.$has_run=!1,l.__class__=$B.generator,n.$has_yield_in_cm){var x=$B.last($B.frames_stack)[1];x.$close_generators=x.$close_generators||[],x.$close_generators.push(l)}return l};return o.$infos=n.$infos,o.$is_genfunc=!0,o}),$B.generator.__iter__=function(n){return n},$B.generator.__next__=function(n){return $B.generator.send(n,_b_.None)},$B.generator.close=function(n){try{$B.generator.$$throw(n,_b_.GeneratorExit.$factory())}catch(o){if(!$B.is_exc(o,[_b_.GeneratorExit,_b_.StopIteration]))throw _b_.RuntimeError.$factory("generator ignored GeneratorExit")}},$B.generator.send=function(n,o){if(n.$has_run=!0,n.$finished)throw _b_.StopIteration.$factory(o);if(!0===n.gi_running)throw _b_.ValueError.$factory("generator already executing");n.gi_running=!0;try{var l=n.next(o)}catch(x){throw n.$finished=!0,x}if(l.value&&l.value.__class__===$GeneratorReturn)throw n.$finished=!0,_b_.StopIteration.$factory(l.value.value);if(n.gi_running=!1,l.done)throw _b_.StopIteration.$factory(l.value);return l.value},$B.generator.$$throw=function(n,o,l,x){var B=o;if(B.$is_class){if(!_b_.issubclass(o,_b_.BaseException))throw _b_.TypeError.$factory("exception value must be an instance of BaseException");void 0===l?B=$B.$call(B)():_b_.isinstance(l,o)&&(B=l)}else void 0===l?l=B:B=$B.$call(B)(l);void 0!==x&&(B.$traceback=x);var D=n.throw(B);if(D.done)throw _b_.StopIteration.$factory("StopIteration");return D.value},$B.set_func_names($B.generator,"builtins"),$B.async_generator=$B.make_class("async_generator",function(n){return function(){var o=n.apply(null,arguments);return o.__class__=$B.async_generator,o}});var ag_closed={};function rstrip(n,o){for(var l=o||" \t\n",x=0,B=n.length;x<B&&l.indexOf(n.charAt(B-1-x))>-1;)x++;return n.substr(0,B-x)}$B.async_generator.__aiter__=function(n){return n},$B.async_generator.__anext__=function(n){return $B.async_generator.asend(n,_b_.None)},$B.async_generator.aclose=function(n){return n.$finished=!0,_b_.None},$B.async_generator.asend=async function(n,o){if(n.$finished)throw _b_.StopAsyncIteration.$factory(o);if(!0===n.ag_running)throw _b_.ValueError.$factory("generator already executing");n.ag_running=!0;try{var l=await n.next(o)}catch(x){throw n.$finished=!0,x}if(l.done)throw _b_.StopAsyncIteration.$factory(o);if(l.value.__class__===$GeneratorReturn)throw n.$finished=!0,_b_.StopAsyncIteration.$factory(l.value.value);return n.ag_running=!1,l.value},$B.async_generator.athrow=async function(n,o,l,x){var B=o;if(B.$is_class){if(!_b_.issubclass(o,_b_.BaseException))throw _b_.TypeError.$factory("exception value must be an instance of BaseException");void 0===l&&(l=$B.$call(B)())}else void 0===l?l=B:B=$B.$call(B)(l);void 0!==x&&(B.$traceback=x),await n.throw(l)},$B.set_func_names($B.async_generator,"builtins")}(__BRYTHON__),function($B){var _b_=$B.builtins,update=function(n,o){for(attr in o)n[attr]=o[attr]},_window=self,modules={},browser={$package:!0,$is_package:!0,__initialized__:!0,__package__:"browser",__file__:$B.brython_path.replace(/\/*$/g,"")+"/Lib/browser/__init__.py",bind:function(){var n=$B.args("bind",3,{elt:null,evt:null,options:null},["elt","evt","options"],arguments,{options:_b_.None},null,null),o=n.options;return"boolean"==typeof o||o.__class__===_b_.dict&&(o=o.$string_dict),function(l){if($B.get_class(n.elt)===$B.JSObj)return n.elt.addEventListener(n.evt,function(M){try{return l($B.JSObj.$factory(M))}catch(P){$B.handle_error(P)}},o),l;if(_b_.isinstance(n.elt,$B.DOMNode))return $B.DOMNode.bind(n.elt,n.evt,l,o),l;if(_b_.isinstance(n.elt,_b_.str)){for(var x=document.querySelectorAll(n.elt),B=0;B<x.length;B++)$B.DOMNode.bind($B.DOMNode.$factory(x[B]),n.evt,l,o);return l}try{for(var D=$B.$iter(n.elt);;)try{var G=_b_.next(D);$B.DOMNode.bind(G,n.evt,l)}catch(M){if(_b_.isinstance(M,_b_.StopIteration))break;throw M}}catch(M){throw _b_.isinstance(M,_b_.AttributeError)&&$B.DOMNode.bind(n.elt,n.evt,l),M}return l}},console:self.console&&$B.JSObj.$factory(self.console),self:$B.win,win:$B.win,$$window:$B.win};browser.__path__=browser.__file__,$B.isNode?(delete browser.$$window,delete browser.win):$B.isWebWorker?(browser.is_webworker=!0,delete browser.$$window,delete browser.win,browser.self.send=self.postMessage):(browser.is_webworker=!1,update(browser,{$$alert:function(n){window.alert($B.builtins.str.$factory(n||""))},confirm:$B.JSObj.$factory(window.confirm),$$document:$B.DOMNode.$factory(document),doc:$B.DOMNode.$factory(document),DOMEvent:$B.DOMEvent,DOMNode:$B.DOMNode,load:function(script_url){var file_obj=$B.builtins.open(script_url),content=$B.$getattr(file_obj,"read")();eval(content)},mouseCoords:function(n){return $B.JSObj.$factory($mouseCoords(n))},prompt:function(n,o){return $B.JSObj.$factory(window.prompt(n,o||""))},reload:function(){var n=document.getElementsByTagName("script"),o=[];for(var l in n.forEach(function(x){void 0!==x.type&&"text/javascript"!=x.type||(o.push(x),x.src&&console.log(x.src))}),console.log(o),$B.imported)$B.imported[l].$last_modified?console.log("check",l,$B.imported[l].__file__,$B.imported[l].$last_modified):console.log("no date for mod",l)},run_script:function(){var n=$B.args("run_script",2,{src:null,name:null},["src","name"],arguments,{name:"script_"+$B.UUID()},null,null);$B.run_script(n.src,n.name,!0)},URLParameter:function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(location.search);return o=null===o?"":decodeURIComponent(o[1].replace(/\+/g," ")),$B.builtins.str.$factory(o)}}),modules["browser.html"]=function($B){var _b_=$B.builtins,TagSum=$B.TagSum;function makeTagDict(tagName){var dict={__class__:_b_.type,$infos:{__name__:tagName,__module__:"browser.html"},__init__:function(){var $ns=$B.args("pow",1,{self:null},["self"],arguments,{},"args","kw"),self=$ns.self,args=$ns.args;if(1==args.length){var first=args[0];if(_b_.isinstance(first,[_b_.str,_b_.int,_b_.float]))self.innerHTML=_b_.str.$factory(first);else if(first.__class__===TagSum)for(var i=0,len=first.children.length;i<len;i++)self.appendChild(first.children[i]);else if(_b_.isinstance(first,$B.DOMNode))self.appendChild(first);else try{var items=_b_.list.$factory(first);items.forEach(function(n){$B.DOMNode.__le__(self,n)})}catch(n){$B.debug>1&&(console.log(n,n.__class__,n.args),console.log("first",first),console.log(arguments)),$B.handle_error(n)}}for(var items=_b_.list.$factory(_b_.dict.items($ns.kw)),i=0,len=items.length;i<len;i++){var arg=items[i][0],value=items[i][1];if("on"==arg.toLowerCase().substr(0,2)){var js='$B.DOMNode.bind(self,"'+arg.toLowerCase().substr(2);eval(js+'",function(){'+value+"})")}else if("style"==arg.toLowerCase())$B.DOMNode.set_style(self,value);else if(!1!==value)try{arg=$B.imported["browser.html"].attribute_mapper(arg),self.setAttribute(arg,value)}catch(n){throw _b_.ValueError.$factory("can't set attribute "+arg)}}}};return dict.__mro__=[$B.DOMNode,$B.builtins.object],dict.__new__=function(n){if(void 0!==n.$elt_wrap){var o=n.$elt_wrap;n.$elt_wrap=void 0,(l=$B.DOMNode.$factory(o,!0))._wrapped=!0}else{var l;(l=$B.DOMNode.$factory(document.createElement(tagName),!0))._wrapped=!1}return l.__class__=n,l.__dict__=$B.empty_dict(),l},$B.set_func_names(dict,"browser.html"),dict}function makeFactory(n){return function(){if(void 0!==n.$elt_wrap){var o=n.$elt_wrap;n.$elt_wrap=void 0,(l=$B.DOMNode.$factory(o,!0))._wrapped=!0}else{if("SVG"==n.$infos.__name__)var l=$B.DOMNode.$factory(document.createElementNS("http://www.w3.org/2000/svg","svg"),!0);else o=document.createElement(n.$infos.__name__),l=$B.DOMNode.$factory(o,!0);l._wrapped=!1}return l.__class__=n,n.__init__(l,...arguments),l}}var tags=["A","ABBR","ACRONYM","ADDRESS","APPLET","AREA","B","BASE","BASEFONT","BDO","BIG","BLOCKQUOTE","BODY","BR","BUTTON","CAPTION","CENTER","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HEAD","HR","HTML","I","IFRAME","IMG","INPUT","INS","ISINDEX","KBD","LABEL","LEGEND","LI","LINK","MAP","MENU","META","NOFRAMES","NOSCRIPT","OBJECT","OL","OPTGROUP","OPTION","P","PARAM","PRE","Q","S","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRIKE","STRONG","STYLE","SUB","SUP","SVG","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL","VAR","ARTICLE","ASIDE","AUDIO","BDI","CANVAS","COMMAND","DATA","DATALIST","EMBED","FIGCAPTION","FIGURE","FOOTER","HEADER","KEYGEN","MAIN","MARK","MATH","METER","NAV","OUTPUT","PROGRESS","RB","RP","RT","RTC","RUBY","SECTION","SOURCE","TEMPLATE","TIME","TRACK","VIDEO","WBR","DETAILS","DIALOG","MENUITEM","PICTURE","SUMMARY"],obj={tags:$B.empty_dict()},dicts={};function maketag(n){if("string"!=typeof n)throw _b_.TypeError.$factory("html.maketag expects a string as argument");var o=dicts[n]=makeTagDict(n);return o.$factory=makeFactory(o),_b_.dict.$setitem(obj.tags,n,o),o}return $B.DOMNode.tags=obj.tags,tags.forEach(function(n){obj[n]=maketag(n)}),obj.maketag=maketag,obj.attribute_mapper=function(n){return n.replace(/_/g,"-")},obj}(__BRYTHON__)),modules.browser=browser,$B.UndefinedClass=$B.make_class("Undefined",function(){return $B.Undefined}),$B.UndefinedClass.__mro__=[_b_.object],$B.UndefinedClass.__bool__=function(n){return!1},$B.UndefinedClass.__repr__=$B.UndefinedClass.__str__=function(n){return"<Javascript undefined>"},$B.Undefined={__class__:$B.UndefinedClass},$B.set_func_names($B.UndefinedClass,"javascript"),modules.javascript={$$this:function(){return void 0===$B.js_this?$B.builtins.None:$B.JSObj.$factory($B.js_this)},$$Date:self.Date&&$B.JSObj.$factory(self.Date),$$extends:function(n){return function(o){if("function"==typeof o){var l=function(){n.call(this,...arguments),o.apply(this,arguments)};return l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.$is_js_func=!0,l}if(o.$is_class){for(var x in console.log("obj",o),"Named"==n.$js_func.name&&console.log("-- Named"),l=function(){if(console.log("call parent class",o.$parent_class),o.$parent_class.call(this,...arguments),o.$$constructor){for(var D=[this],G=0,M=arguments.length;G<M;G++)D.push(arguments[G]);o.$$constructor.apply(this,D)}},l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.$is_js_func=!0,l.$class=o,o.$parent_class=n,o.__dict__.$string_dict){var B=o.__dict__.$string_dict[x][0];l.prototype[x]="function"==typeof B?function(D){return function(){for(var G=[this],M=0,P=arguments.length;M<P;M++)G.push($B.pyobj2jsobj(arguments[M]));return D.apply(this,G)}}(B):$B.pyobj2jsobj(B)}return l}}},JSON:{__class__:$B.make_class("JSON"),parse:function(){return $B.structuredclone2pyobj(JSON.parse.apply(this,arguments))},stringify:function(n,o,l){return JSON.stringify($B.pyobj2structuredclone(n,!1),$B.JSObj.$factory(o),l)}},jsobj2pyobj:function(n){return $B.jsobj2pyobj(n)},load:function(script_url){console.log('"javascript.load" is deprecrated. Use browser.load instead.');var file_obj=$B.builtins.open(script_url),content=$B.$getattr(file_obj,"read")();eval(content)},$$Math:self.Math&&$B.JSObj.$factory(self.Math),NULL:null,$$Number:self.Number&&$B.JSObj.$factory(self.Number),py2js:function(n,o){return void 0===o&&(o="__main__"+$B.UUID()),$B.py2js(n,o,o,$B.builtins_scope).to_js()},pyobj2jsobj:function(n){return $B.pyobj2jsobj(n)},$$RegExp:self.RegExp&&$B.JSObj.$factory(self.RegExp),$$String:self.String&&$B.JSObj.$factory(self.String),UNDEFINED:$B.Undefined,UndefinedType:$B.UndefinedClass};var arraybuffers=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];arraybuffers.forEach(function(n){void 0!==self[n]&&(modules.javascript[n]=$B.JSObj.$factory(self[n]))});var _b_=$B.builtins;function load(n,o){for(var l in o.__class__=$B.module,o.__name__=n,$B.imported[n]=o,o)if("function"==typeof o[l]){var x=$B.from_alias(l);o[l].$infos={__module__:n,__name__:x,__qualname__:n+"."+x}}}for(var attr in modules._sys={Getframe:function(){var n=$B.args("_getframe",1,{depth:null},["depth"],arguments,{depth:0},null,null).depth;return $B._frame.$factory($B.frames_stack,$B.frames_stack.length-n-1)},breakpointhook:function(){var n,o,l,x,B=$B.$options.breakpoint;void 0===B&&(B="pdb.set_trace"),[n,o,l]=_b_.str.rpartition(B,"."),""==o&&(n="builtins");try{$B.$import(n),x=$B.$getattr($B.imported[n],l)}catch{return console.warn("cannot import breakpoint",B),_b_.None}return $B.$call(x).apply(null,arguments)},exc_info:function(){for(var n=$B.frames_stack.length-1;n>=0;n--){var o=$B.frames_stack[n][1].$current_exception;if(o)return _b_.tuple.$factory([o.__class__,o,$B.$getattr(o,"__traceback__")])}return _b_.tuple.$factory([_b_.None,_b_.None,_b_.None])},excepthook:function(n,o,l){$B.handle_error(o)},gettrace:function(){return $B.tracefunc||_b_.None},modules:_b_.property.$factory(function(){return $B.obj_dict($B.imported)},function(n,o,l){throw _b_.TypeError.$factory("Read only property 'sys.modules'")}),path:_b_.property.$factory(function(){return $B.path},function(n,o,l){$B.path=l}),meta_path:_b_.property.$factory(function(){return $B.meta_path},function(n,o,l){$B.meta_path=l}),path_hooks:_b_.property.$factory(function(){return $B.path_hooks},function(n,o,l){$B.path_hooks=l}),path_importer_cache:_b_.property.$factory(function(){return _b_.dict.$factory($B.JSObj.$factory($B.path_importer_cache))},function(n,o,l){throw _b_.TypeError.$factory("Read only property 'sys.path_importer_cache'")}),settrace:function(){var n=$B.args("settrace",1,{tracefunc:null},["tracefunc"],arguments,{},null,null);return $B.tracefunc=n.tracefunc,$B.last($B.frames_stack)[1].$f_trace=$B.tracefunc,$B.tracefunc.$current_frame_id=$B.last($B.frames_stack)[0],_b_.None},stderr:_b_.property.$factory(function(){return $B.stderr},function(n,o){$B.stderr=o}),stdout:_b_.property.$factory(function(){return $B.stdout},function(n,o){$B.stdout=o}),stdin:_b_.property.$factory(function(){return $B.stdin},function(n,o){$B.stdin=o}),vfs:_b_.property.$factory(function(){return $B.hasOwnProperty("VFS")?$B.obj_dict($B.VFS):_b_.None},function(){throw _b_.TypeError.$factory("Read only property 'sys.vfs'")})},modules._sys.__breakpointhook__=modules._sys.breakpointhook,modules._sys.stderr.write=function(n){return $B.$getattr(_sys.stderr.__get__(),"write")(n)},modules._sys.stdout.write=function(n){return $B.$getattr(_sys.stdout.__get__(),"write")(n)},modules)load(attr,modules[attr]);$B.isWebWorker||$B.isNode||(modules.browser.html=modules["browser.html"]);var _b_=$B.builtins;for(var attr in _b_.__builtins__=$B.module.$factory("__builtins__","Python builtins"),_b_)_b_.__builtins__[attr]=_b_[attr],$B.builtins_scope.binding[attr]=!0;for(var name in _b_.__builtins__.__setattr__=function(n,o){_b_[n]=o},$B.method_descriptor.__getattribute__=$B.Function.__getattribute__,$B.wrapper_descriptor.__getattribute__=$B.Function.__getattribute__,_b_)if(_b_[name].__class__===_b_.type)for(var key in $B.builtin_classes.push(_b_[name]),_b_[name]){var value=_b_[name][key];void 0!==value&&(value.__class__||"function"==typeof value&&(value.__class__="__new__"==key?$B.builtin_function:key.startsWith("__")?$B.wrapper_descriptor:$B.method_descriptor,value.__objclass__=_b_[name]))}for(var attr in $B)Array.isArray($B[attr])&&($B[attr].__class__=_b_.list);$B.cell=$B.make_class("cell",function(n){return{__class__:$B.cell,$cell_contents:n}}),$B.cell.cell_contents=$B.$call(_b_.property)(function(n){if(null===n.$cell_contents)throw _b_.ValueError.$factory("empty cell");return n.$cell_contents},function(n,o){n.$cell_contents=o});var $comps=Object.values($B.$comps).concat(["eq","ne"]);$comps.forEach(function(n){var o="__"+n+"__";$B.cell[o]=function(l){return function(x,B){return _b_.isinstance(B,$B.cell)?null===x.$cell_contents?null===B.$cell_contents?"__eq__"==l:["__ne__","__lt__","__le__"].indexOf(l)>-1:null===B.$cell_contents?["__ne__","__gt__","__ge__"].indexOf(l)>-1:$B.rich_comp(l,x.$cell_contents,B.$cell_contents):NotImplemented}}(o)}),$B.set_func_names($B.cell,"builtins")}(__BRYTHON__);var docs={ArithmeticError:"Base class for arithmetic errors.",AssertionError:"Assertion failed.",AttributeError:"Attribute not found.",BaseException:"Common base class for all exceptions",BlockingIOError:"I/O operation would block.",BrokenPipeError:"Broken pipe.",BufferError:"Buffer error.",BytesWarning:"Base class for warnings about bytes and buffer related problems, mostly\nrelated to conversion from str or comparing to str.",ChildProcessError:"Child process error.",ConnectionAbortedError:"Connection aborted.",ConnectionError:"Connection error.",ConnectionRefusedError:"Connection refused.",ConnectionResetError:"Connection reset.",DeprecationWarning:"Base class for warnings about deprecated features.",EOFError:"Read beyond end of file.",Ellipsis:"",EnvironmentError:"Base class for I/O related errors.",Exception:"Common base class for all non-exit exceptions.",False:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",FileExistsError:"File already exists.",FileNotFoundError:"File not found.",FloatingPointError:"Floating point operation failed.",FutureWarning:"Base class for warnings about constructs that will change semantically\nin the future.",GeneratorExit:"Request that a generator exit.",IOError:"Base class for I/O related errors.",ImportError:"Import can't find module, or can't find name in module.",ImportWarning:"Base class for warnings about probable mistakes in module imports",IndentationError:"Improper indentation.",IndexError:"Sequence index out of range.",InterruptedError:"Interrupted by signal.",IsADirectoryError:"Operation doesn't work on directories.",KeyError:"Mapping key not found.",KeyboardInterrupt:"Program interrupted by user.",LookupError:"Base class for lookup errors.",MemoryError:"Out of memory.",NameError:"Name not found globally.",None:"",NotADirectoryError:"Operation only works on directories.",NotImplemented:"",NotImplementedError:"Method or function hasn't been implemented yet.",OSError:"Base class for I/O related errors.",OverflowError:"Result too large to be represented.",PendingDeprecationWarning:"Base class for warnings about features which will be deprecated\nin the future.",PermissionError:"Not enough permissions.",ProcessLookupError:"Process not found.",ReferenceError:"Weak ref proxy used after referent went away.",ResourceWarning:"Base class for warnings about resource usage.",RuntimeError:"Unspecified run-time error.",RuntimeWarning:"Base class for warnings about dubious runtime behavior.",StopIteration:"Signal the end from iterator.__next__().",SyntaxError:"Invalid syntax.",SyntaxWarning:"Base class for warnings about dubious syntax.",SystemError:"Internal error in the Python interpreter.\n\nPlease report this to the Python maintainer, along with the traceback,\nthe Python version, and the hardware/OS platform and version.",SystemExit:"Request to exit from the interpreter.",TabError:"Improper mixture of spaces and tabs.",TimeoutError:"Timeout expired.",True:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",TypeError:"Inappropriate argument type.",UnboundLocalError:"Local name referenced but not bound to a value.",UnicodeDecodeError:"Unicode decoding error.",UnicodeEncodeError:"Unicode encoding error.",UnicodeError:"Unicode related error.",UnicodeTranslateError:"Unicode translation error.",UnicodeWarning:"Base class for warnings about Unicode related problems, mostly\nrelated to conversion problems.",UserWarning:"Base class for warnings generated by user code.",ValueError:"Inappropriate argument value (of correct type).",Warning:"Base class for warning categories.",WindowsError:"Base class for I/O related errors.",ZeroDivisionError:"Second argument to a division or modulo operation was zero.",__debug__:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",abs:"abs(number) -> number\n\nReturn the absolute value of the argument.",all:"all(iterable) -> bool\n\nReturn True if bool(x) is True for all values x in the iterable.\nIf the iterable is empty, return True.",any:"any(iterable) -> bool\n\nReturn True if bool(x) is True for any x in the iterable.\nIf the iterable is empty, return False.",ascii:"ascii(object) -> string\n\nAs repr(), return a string containing a printable representation of an\nobject, but escape the non-ASCII characters in the string returned by\nrepr() using \\x, \\u or \\U escapes.  This generates a string similar\nto that returned by repr() in Python 2.",bin:"bin(number) -> string\n\nReturn the binary representation of an integer.\n\n   >>> bin(2796202)\n   '0b1010101010101010101010'\n",bool:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",bytearray:"bytearray(iterable_of_ints) -> bytearray\nbytearray(string, encoding[, errors]) -> bytearray\nbytearray(bytes_or_buffer) -> mutable copy of bytes_or_buffer\nbytearray(int) -> bytes array of size given by the parameter initialized with null bytes\nbytearray() -> empty bytes array\n\nConstruct an mutable bytearray object from:\n  - an iterable yielding integers in range(256)\n  - a text string encoded using the specified encoding\n  - a bytes or a buffer object\n  - any object implementing the buffer API.\n  - an integer",bytes:"bytes(iterable_of_ints) -> bytes\nbytes(string, encoding[, errors]) -> bytes\nbytes(bytes_or_buffer) -> immutable copy of bytes_or_buffer\nbytes(int) -> bytes object of size given by the parameter initialized with null bytes\nbytes() -> empty bytes object\n\nConstruct an immutable array of bytes from:\n  - an iterable yielding integers in range(256)\n  - a text string encoded using the specified encoding\n  - any object implementing the buffer API.\n  - an integer",callable:"callable(object) -> bool\n\nReturn whether the object is callable (i.e., some kind of function).\nNote that classes are callable, as are instances of classes with a\n__call__() method.",chr:"chr(i) -> Unicode character\n\nReturn a Unicode string of one character with ordinal i; 0 <= i <= 0x10ffff.",classmethod:"classmethod(function) -> method\n\nConvert a function to be a class method.\n\nA class method receives the class as implicit first argument,\njust like an instance method receives the instance.\nTo declare a class method, use this idiom:\n\n  class C:\n      def f(cls, arg1, arg2, ...): ...\n      f = classmethod(f)\n\nIt can be called either on the class (e.g. C.f()) or on an instance\n(e.g. C().f()).  The instance is ignored except for its class.\nIf a class method is called for a derived class, the derived class\nobject is passed as the implied first argument.\n\nClass methods are different than C++ or Java static methods.\nIf you want those, see the staticmethod builtin.",compile:"compile(source, filename, mode[, flags[, dont_inherit]]) -> code object\n\nCompile the source (a Python module, statement or expression)\ninto a code object that can be executed by exec() or eval().\nThe filename will be used for run-time error messages.\nThe mode must be 'exec' to compile a module, 'single' to compile a\nsingle (interactive) statement, or 'eval' to compile an expression.\nThe flags argument, if present, controls which future statements influence\nthe compilation of the code.\nThe dont_inherit argument, if non-zero, stops the compilation inheriting\nthe effects of any future statements in effect in the code calling\ncompile; if absent or zero these statements do influence the compilation,\nin addition to any features explicitly specified.",complex:"complex(real[, imag]) -> complex number\n\nCreate a complex number from a real part and an optional imaginary part.\nThis is equivalent to (real + imag*1j) where imag defaults to 0.",copyright:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",credits:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",delattr:"delattr(object, name)\n\nDelete a named attribute on an object; delattr(x, 'y') is equivalent to\n``del x.y''.",dict:"dict() -> new empty dictionary\ndict(mapping) -> new dictionary initialized from a mapping object's\n    (key, value) pairs\ndict(iterable) -> new dictionary initialized as if via:\n    d = {}\n    for k, v in iterable:\n        d[k] = v\ndict(**kwargs) -> new dictionary initialized with the name=value pairs\n    in the keyword argument list.  For example:  dict(one=1, two=2)",dir:"dir([object]) -> list of strings\n\nIf called without an argument, return the names in the current scope.\nElse, return an alphabetized list of names comprising (some of) the attributes\nof the given object, and of attributes reachable from it.\nIf the object supplies a method named __dir__, it will be used; otherwise\nthe default dir() logic is used and returns:\n  for a module object: the module's attributes.\n  for a class object:  its attributes, and recursively the attributes\n    of its bases.\n  for any other object: its attributes, its class's attributes, and\n    recursively the attributes of its class's base classes.",divmod:"divmod(x, y) -> (div, mod)\n\nReturn the tuple ((x-x%y)/y, x%y).  Invariant: div*y + mod == x.",enumerate:"enumerate(iterable[, start]) -> iterator for index, value of iterable\n\nReturn an enumerate object.  iterable must be another object that supports\niteration.  The enumerate object yields pairs containing a count (from\nstart, which defaults to zero) and a value yielded by the iterable argument.\nenumerate is useful for obtaining an indexed list:\n    (0, seq[0]), (1, seq[1]), (2, seq[2]), ...",eval:"eval(source[, globals[, locals]]) -> value\n\nEvaluate the source in the C of globals and locals.\nThe source may be a string representing a Python expression\nor a code object as returned by compile().\nThe globals must be a dictionary and locals can be any mapping,\ndefaulting to the current globals and locals.\nIf only globals is given, locals defaults to it.\n",exec:"exec(object[, globals[, locals]])\n\nRead and execute code from an object, which can be a string or a code\nobject.\nThe globals and locals are dictionaries, defaulting to the current\nglobals and locals.  If only globals is given, locals defaults to it.",exit:"",filter:"filter(function or None, iterable) --\x3e filter object\n\nReturn an iterator yielding those items of iterable for which function(item)\nis true. If function is None, return the items that are true.",float:"float(x) -> floating point number\n\nConvert a string or number to a floating point number, if possible.",format:'format(value[, format_spec]) -> string\n\nReturns value.__format__(format_spec)\nformat_spec defaults to ""',frozenset:"frozenset()-> empty frozenset object\nfrozenset(iterable)-> frozenset object\n\nBuild an immutable unordered collection of unique elements.",getattr:"getattr(object,name[,default])-> value\n\nGet a named attribute from an object;getattr(x,'y')is equivalent to x.y.\nWhen a default argument is given,it is returned when the attribute doesn't\nexist; without it, an exception is raised in that case.",globals:"globals() -> dictionary\n\nReturn the dictionary containing the current scope's global variables.",hasattr:"hasattr(object,name)-> bool\n\nReturn whether the object has an attribute with the given name.\n(This is done by calling getattr(object,name)and catching AttributeError.)",hash:"hash(object)-> integer\n\nReturn a hash value for the object. Two objects with the same value have\nthe same hash value. The reverse is not necessarily true,but likely.",help:"Define the builtin 'help'.\n\n This is a wrapper around pydoc.help that provides a helpful message\n when 'help' is typed at the Python interactive prompt.\n\n Calling help()at the Python prompt starts an interactive help session.\n Calling help(thing)prints help for the python object 'thing'.\n ",hex:"hex(number)-> string\n\nReturn the hexadecimal representation of an integer.\n\n >>> hex(3735928559)\n '0xdeadbeef'\n",id:"id(object)-> integer\n\nReturn the identity of an object. This is guaranteed to be unique among\nsimultaneously existing objects.(Hint:it's the object's memory address.)",input:"input([prompt])-> string\n\nRead a string from standard input. The trailing newline is stripped.\nIf the user hits EOF(Unix:Ctl-D,Windows:Ctl-Z+Return),raise EOFError.\nOn Unix,GNU readline is used if enabled. The prompt string,if given,\nis printed without a trailing newline before reading.",int:"int(x=0)-> integer\nint(x,base=10)-> integer\n\nConvert a number or string to an integer,or return 0 if no arguments\nare given. If x is a number,return x.__int__(). For floating point\nnumbers,this truncates towards zero.\n\nIf x is not a number or if base is given,then x must be a string,\nbytes,or bytearray instance representing an integer literal in the\ngiven base. The literal can be preceded by '+' or '-' and be surrounded\nby whitespace. The base defaults to 10. Valid bases are 0 and 2-36.\nBase 0 means to interpret the base from the string as an integer literal.\n>>> int('0b100',base=0)\n4",isinstance:"isinstance(object,class-or-type-or-tuple)-> bool\n\nReturn whether an object is an instance of a class or of a subclass thereof.\nWith a type as second argument,return whether that is the object's type.\nThe form using a tuple, isinstance(x, (A, B, ...)), is a shortcut for\nisinstance(x, A) or isinstance(x, B) or ... (etc.).",issubclass:"issubclass(C, B) -> bool\n\nReturn whether class C is a subclass (i.e., a derived class) of class B.\nWhen using a tuple as the second argument issubclass(X, (A, B, ...)),\nis a shortcut for issubclass(X, A) or issubclass(X, B) or ... (etc.).",iter:"iter(iterable) -> iterator\niter(callable, sentinel) -> iterator\n\nGet an iterator from an object.  In the first form, the argument must\nsupply its own iterator, or be a sequence.\nIn the second form, the callable is called until it returns the sentinel.",len:"len(object)\n\nReturn the number of items of a sequence or collection.",license:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",list:"list() -> new empty list\nlist(iterable) -> new list initialized from iterable's items",locals:"locals()-> dictionary\n\nUpdate and return a dictionary containing the current scope's local variables.",map:"map(func, *iterables) --\x3e map object\n\nMake an iterator that computes the function using arguments from\neach of the iterables.  Stops when the shortest iterable is exhausted.",max:"max(iterable, *[, default=obj, key=func]) -> value\nmax(arg1, arg2, *args, *[, key=func]) -> value\n\nWith a single iterable argument, return its biggest item. The\ndefault keyword-only argument specifies an object to return if\nthe provided iterable is empty.\nWith two or more arguments, return the largest argument.",memoryview:"memoryview(object)\n\nCreate a new memoryview object which references the given object.",min:"min(iterable, *[, default=obj, key=func]) -> value\nmin(arg1, arg2, *args, *[, key=func]) -> value\n\nWith a single iterable argument, return its smallest item. The\ndefault keyword-only argument specifies an object to return if\nthe provided iterable is empty.\nWith two or more arguments, return the smallest argument.",next:"next(iterator[, default])\n\nReturn the next item from the iterator. If default is given and the iterator\nis exhausted, it is returned instead of raising StopIteration.",object:"The most base type",oct:"oct(number) -> string\n\nReturn the octal representation of an integer.\n\n   >>> oct(342391)\n   '0o1234567'\n",open:"open(file, mode='r', buffering=-1, encoding=None,\n     errors=None, newline=None, closefd=True, opener=None) -> file object\n\nOpen file and return a stream.  Raise IOError upon failure.\n\nfile is either a text or byte string giving the name (and the path\nif the file isn't in the current working directory)of the file to\nbe opened or an integer file descriptor of the file to be\nwrapped.(If a file descriptor is given,it is closed when the\nreturned I/O object is closed,unless closefd is set to False.)\n\nmode is an optional string that specifies the mode in which the file\nis opened. It defaults to 'r' which means open for reading in text\nmode. Other common values are 'w' for writing(truncating the file if\nit already exists),'x' for creating and writing to a new file,and\n'a' for appending(which on some Unix systems,means that all writes\nappend to the end of the file regardless of the current seek position).\nIn text mode,if encoding is not specified the encoding used is platform\ndependent:locale.getpreferredencoding(False)is called to get the\ncurrent locale encoding.(For reading and writing raw bytes use binary\nmode and leave encoding unspecified.)The available modes are:\n\n========================================================================\nCharacter Meaning\n------------------------------------------------------------------------\n'r' open for reading(default)\n'w' open for writing,truncating the file first\n'x' create a new file and open it for writing\n'a' open for writing,appending to the end of the file if it exists\n'b' binary mode\n't' text mode(default)\n'+' open a disk file for updating(reading and writing)\n'U' universal newline mode(deprecated)\n========================================================================\n\nThe default mode is 'rt'(open for reading text). For binary random\naccess,the mode 'w+b' opens and truncates the file to 0 bytes,while\n'r+b' opens the file without truncation. The 'x' mode implies 'w' and\nraises an `FileExistsError` if the file already exists.\n\nPython distinguishes between files opened in binary and text modes,\neven when the underlying operating system doesn't. Files opened in\nbinary mode (appending 'b' to the mode argument) return contents as\nbytes objects without any decoding. In text mode (the default, or when\n't' is appended to the mode argument), the contents of the file are\nreturned as strings, the bytes having been first decoded using a\nplatform-dependent encoding or using the specified encoding if given.\n\n'U' mode is deprecated and will raise an exception in future versions\nof Python.  It has no effect in Python 3.  Use newline to control\nuniversal newlines mode.\n\nbuffering is an optional integer used to set the buffering policy.\nPass 0 to switch buffering off (only allowed in binary mode), 1 to select\nline buffering (only usable in text mode), and an integer > 1 to indicate\nthe size of a fixed-size chunk buffer.  When no buffering argument is\ngiven, the default buffering policy works as follows:\n\n* Binary files are buffered in fixed-size chunks; the size of the buffer\n  is chosen using a heuristic trying to determine the underlying device's\n \"block size\" and falling back on `io.DEFAULT_BUFFER_SIZE`.\n  On many systems, the buffer will typically be 4096 or 8192 bytes long.\n\n* \"Interactive\" text files (files for which isatty() returns True)\n  use line buffering.  Other text files use the policy described above\n  for binary files.\n\nencoding is the name of the encoding used to decode or encode the\nfile. This should only be used in text mode. The default encoding is\nplatform dependent, but any encoding supported by Python can be\npassed.  See the codecs module for the list of supported encodings.\n\nerrors is an optional string that specifies how encoding errors are to\nbe handled---this argument should not be used in binary mode. Pass\n'strict' to raise a ValueError exception if there is an encoding error\n(the default of None has the same effect), or pass 'ignore' to ignore\nerrors. (Note that ignoring encoding errors can lead to data loss.)\nSee the documentation for codecs.register or run 'help(codecs.Codec)'\nfor a list of the permitted encoding error strings.\n\nnewline controls how universal newlines works (it only applies to text\nmode). It can be None, '', '\\n', '\\r', and '\\r\\n'.  It works as\nfollows:\n\n* On input, if newline is None, universal newlines mode is\n  enabled. Lines in the input can end in '\\n', '\\r', or '\\r\\n', and\n  these are translated into '\\n' before being returned to the\n  caller. If it is '', universal newline mode is enabled, but line\n  endings are returned to the caller untranslated. If it has any of\n  the other legal values, input lines are only terminated by the given\n  string, and the line ending is returned to the caller untranslated.\n\n* On output, if newline is None, any '\\n' characters written are\n  translated to the system default line separator, os.linesep. If\n  newline is '' or '\\n', no translation takes place. If newline is any\n  of the other legal values, any '\\n' characters written are translated\n  to the given string.\n\nIf closefd is False, the underlying file descriptor will be kept open\nwhen the file is closed. This does not work when a file name is given\nand must be True in that case.\n\nA custom opener can be used by passing a callable as *opener*. The\nunderlying file descriptor for the file object is then obtained by\ncalling *opener* with (*file*, *flags*). *opener* must return an open\nfile descriptor (passing os.open as *opener* results in functionality\nsimilar to passing None).\n\nopen() returns a file object whose type depends on the mode, and\nthrough which the standard file operations such as reading and writing\nare performed. When open() is used to open a file in a text mode ('w',\n'r', 'wt', 'rt', etc.), it returns a TextIOWrapper. When used to open\na file in a binary mode, the returned class varies: in read binary\nmode, it returns a BufferedReader; in write binary and append binary\nmodes, it returns a BufferedWriter, and in read/write mode, it returns\na BufferedRandom.\n\nIt is also possible to use a string or bytearray as a file for both\nreading and writing. For strings StringIO can be used like a file\nopened in a text mode, and for bytes a BytesIO can be used like a file\nopened in a binary mode.\n",ord:"ord(c) -> integer\n\nReturn the integer ordinal of a one-character string.",pow:"pow(x, y[, z]) -> number\n\nWith two arguments, equivalent to x**y.  With three arguments,\nequivalent to (x**y) % z, but may be more efficient (e.g. for ints).",print:"print(value, ..., sep=' ', end='\\n', file=sys.stdout, flush=False)\n\nPrints the values to a stream, or to sys.stdout by default.\nOptional keyword arguments:\nfile:  a file-like object (stream); defaults to the current sys.stdout.\nsep:   string inserted between values, default a space.\nend:   string appended after the last value, default a newline.\nflush: whether to forcibly flush the stream.",property:"property(fget=None, fset=None, fdel=None, doc=None) -> property attribute\n\nfget is a function to be used for getting an attribute value, and likewise\nfset is a function for setting, and fdel a function for del'ing, an\nattribute.  Typical use is to define a managed attribute x:\n\nclass C(object):\n    def getx(self): return self._x\n    def setx(self, value): self._x = value\n    def delx(self): del self._x\n    x = property(getx, setx, delx, \"I'm the 'x' property.\")\n\nDecorators make defining new properties or modifying existing ones easy:\n\nclass C(object):\n    @property\n    def x(self):\n        \"I am the 'x' property.\"\n        return self._x\n    @x.setter\n    def x(self, value):\n        self._x = value\n    @x.deleter\n    def x(self):\n        del self._x\n",quit:"",range:"range(stop) -> range object\nrange(start, stop[, step]) -> range object\n\nReturn a virtual sequence of numbers from start to stop by step.",repr:"repr(object) -> string\n\nReturn the canonical string representation of the object.\nFor most object types, eval(repr(object)) == object.",reversed:"reversed(sequence) -> reverse iterator over values of the sequence\n\nReturn a reverse iterator",round:"round(number[, ndigits]) -> number\n\nRound a number to a given precision in decimal digits (default 0 digits).\nThis returns an int when called with one argument, otherwise the\nsame type as the number. ndigits may be negative.",set:"set() -> new empty set object\nset(iterable) -> new set object\n\nBuild an unordered collection of unique elements.",setattr:"setattr(object, name, value)\n\nSet a named attribute on an object; setattr(x, 'y', v) is equivalent to\n``x.y = v''.",slice:"slice(stop)\nslice(start, stop[, step])\n\nCreate a slice object.  This is used for extended slicing (e.g. a[0:10:2]).",sorted:"sorted(iterable, key=None, reverse=False) --\x3e new sorted list",staticmethod:"staticmethod(function) -> method\n\nConvert a function to be a static method.\n\nA static method does not receive an implicit first argument.\nTo declare a static method, use this idiom:\n\n     class C:\n     def f(arg1, arg2, ...): ...\n     f = staticmethod(f)\n\nIt can be called either on the class (e.g. C.f()) or on an instance\n(e.g. C().f()).  The instance is ignored except for its class.\n\nStatic methods in Python are similar to those found in Java or C++.\nFor a more advanced concept, see the classmethod builtin.",str:"str(object='') -> str\nstr(bytes_or_buffer[, encoding[, errors]]) -> str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer\nthat will be decoded using the given encoding and error handler.\nOtherwise, returns the result of object.__str__() (if defined)\nor repr(object).\nencoding defaults to sys.getdefaultencoding().\nerrors defaults to 'strict'.",sum:"sum(iterable[, start]) -> value\n\nReturn the sum of an iterable of numbers (NOT strings) plus the value\nof parameter 'start' (which defaults to 0).  When the iterable is\nempty, return start.",super:"super() -> same as super(__class__, <first argument>)\nsuper(type) -> unbound super object\nsuper(type, obj) -> bound super object; requires isinstance(obj, type)\nsuper(type, type2) -> bound super object; requires issubclass(type2, type)\nTypical use to call a cooperative superclass method:\nclass C(B):\n    def meth(self, arg):\n        super().meth(arg)\nThis works for class methods too:\nclass C(B):\n    @classmethod\n    def cmeth(cls, arg):\n        super().cmeth(arg)\n",tuple:"tuple() -> empty tuple\ntuple(iterable) -> tuple initialized from iterable's items\n\nIf the argument is a tuple, the return value is the same object.",type:"type(object_or_name, bases, dict)\ntype(object) -> the object's type\ntype(name, bases, dict) -> a new type",vars:"vars([object]) -> dictionary\n\nWithout arguments, equivalent to locals().\nWith an argument, equivalent to object.__dict__.",zip:"zip(iter1 [,iter2 [...]]) --\x3e zip object\n\nReturn a zip object whose .__next__() method returns a tuple where\nthe i-th element comes from the i-th iterable argument.  The .__next__()\nmethod continues until the shortest iterable in the argument sequence\nis exhausted and then it raises StopIteration."},n,o;return __BRYTHON__.builtins_doc=docs,n=__BRYTHON__,o=n.builtins,n.import_hooks=function(l,x,B){var D,G,M=n.meta_path.slice(),P=n.imported;if(B){var fe=M.indexOf(n.finders.path);fe>-1&&M.splice(fe,1)}for(var ye=0,ne=M.length;ye<ne;ye++){var ue=M[ye],me=n.$getattr(ue,"find_spec",o.None);if(me==o.None){var ie=n.$getattr(ue,"find_module",o.None);if(ie!==o.None&&(D=ie(l,x))!==o.None){var W=n.$getattr(D,"load_module"),Q=n.$call(W)(l);return P[l]=Q,Q}}else if(G=me(l,x),!n.is_none(G)){if(void 0!==(Q=n.imported[G.name]))return P[G.name]=Q;D=o.getattr(G,"loader",o.None);break}}if(void 0===D){message=l,"file"==n.protocol&&(message+=" (warning: cannot import local files with protocol 'file')");var A=o.ModuleNotFoundError.$factory(message);throw A.name=l,A}if(n.is_none(Q)){if(G===o.None)throw o.ModuleNotFoundError.$factory(l);var R=o.getattr(G,"name");if(!n.is_none(D)){var X=o.getattr(D,"create_module",o.None);n.is_none(X)||(Q=n.$call(X)(G))}if(void 0===Q)throw o.ImportError.$factory(l);if(n.is_none(Q)){Q=n.module.$factory(l);var he=o.getattr(G,"origin");he=o.getattr(G,"has_location")?"from '"+he+"'":"("+he+")"}}Q.__name__=R,Q.__loader__=D,Q.__package__=o.getattr(G,"parent",""),Q.__spec__=G;var z=o.getattr(G,"submodule_search_locations");(Q.$is_package=!n.is_none(z))&&(Q.__path__=z),o.getattr(G,"has_location")&&(Q.__file__=o.getattr(G,"origin"),n.$py_module_path[Q.__name__]=Q.__file__);var Le=o.getattr(G,"cached");if(n.is_none(Le)||(Q.__cached__=Le),n.is_none(D)){if(n.is_none(z))throw o.ImportError.$factory(l);P[R]=Q}else{var K=o.getattr(D,"exec_module",o.None);if(n.is_none(K))Q=o.getattr(D,"load_module")(R);else{P[R]=Q;try{K(Q)}catch(be){throw delete P[R],be}}}return P[R]},function(n){var o=n.coroutine=n.make_class("coroutine");o.close=function(l){},o.send=function(l){return l.$func.apply(null,l.$args)},o.__repr__=o.__str__=function(l){return l.$func.$infos?"<coroutine "+l.$func.$infos.__name__+">":"<coroutine object>"},n.set_func_names(o,"builtins"),n.make_async=l=>{if(l.$is_genfunc)return l;var x=function(){var B=arguments,D=n.deep_copy(n.frames_stack);return{__class__:o,$args:B,$func:l,$stack:D}};return x.$infos=l.$infos,x},n.promise=function(l){return l.__class__===o?o.send(l):"function"==typeof l?l():l}}(__BRYTHON__),window.__BRYTHON__=__BRYTHON__,__BRYTHON__},__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},561:n=>{var o=Object.prototype.toString;n.exports=function(l){return l.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===o.call(l.buffer)||Array.isArray(l)}},355:n=>{n.exports=function(o,l){return"number"==typeof o?o:"number"==typeof l?l:0}},546:function(n,o,l){var x,B,D;B=[l(734)],x=function(G){"use strict";var M=function(A,R,X){if(void 0===A&&(A=M.DEFAULT_CAPACITY),void 0===R&&(R=M.DEFAULT_ENDIAN),void 0===X&&(X=M.DEFAULT_NOASSERT),!X){if((A|=0)<0)throw RangeError("Illegal capacity");R=!!R,X=!!X}this.buffer=0===A?fe:new ArrayBuffer(A),this.view=0===A?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=A,this.littleEndian=R,this.noAssert=X};M.VERSION="5.0.1",M.LITTLE_ENDIAN=!0,M.BIG_ENDIAN=!1,M.DEFAULT_CAPACITY=16,M.DEFAULT_ENDIAN=M.BIG_ENDIAN,M.DEFAULT_NOASSERT=!1,M.Long=G||null;var P=M.prototype;Object.defineProperty(P,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var fe=new ArrayBuffer(0),ye=String.fromCharCode;function ne(A){var R=0;return function(){return R<A.length?A.charCodeAt(R++):null}}function ue(){var A=[],R=[];return function(){if(0===arguments.length)return R.join("")+ye.apply(String,A);A.length+arguments.length>1024&&(R.push(ye.apply(String,A)),A.length=0),Array.prototype.push.apply(A,arguments)}}function me(A,R,X,he,z){var Le,K,be=8*z-he-1,Ne=(1<<be)-1,je=Ne>>1,Te=-7,qe=X?z-1:0,Ke=X?-1:1,vt=A[R+qe];for(qe+=Ke,Le=vt&(1<<-Te)-1,vt>>=-Te,Te+=be;Te>0;Le=256*Le+A[R+qe],qe+=Ke,Te-=8);for(K=Le&(1<<-Te)-1,Le>>=-Te,Te+=he;Te>0;K=256*K+A[R+qe],qe+=Ke,Te-=8);if(0===Le)Le=1-je;else{if(Le===Ne)return K?NaN:1/0*(vt?-1:1);K+=Math.pow(2,he),Le-=je}return(vt?-1:1)*K*Math.pow(2,Le-he)}function ie(A,R,X,he,z,Le){var K,be,Ne,je=8*Le-z-1,Te=(1<<je)-1,qe=Te>>1,Ke=23===z?Math.pow(2,-24)-Math.pow(2,-77):0,vt=he?0:Le-1,ht=he?1:-1,Bt=R<0||0===R&&1/R<0?1:0;for(R=Math.abs(R),isNaN(R)||R===1/0?(be=isNaN(R)?1:0,K=Te):(K=Math.floor(Math.log(R)/Math.LN2),R*(Ne=Math.pow(2,-K))<1&&(K--,Ne*=2),(R+=K+qe>=1?Ke/Ne:Ke*Math.pow(2,1-qe))*Ne>=2&&(K++,Ne/=2),K+qe>=Te?(be=0,K=Te):K+qe>=1?(be=(R*Ne-1)*Math.pow(2,z),K+=qe):(be=R*Math.pow(2,qe-1)*Math.pow(2,z),K=0));z>=8;A[X+vt]=255&be,vt+=ht,be/=256,z-=8);for(K=K<<z|be,je+=z;je>0;A[X+vt]=255&K,vt+=ht,K/=256,je-=8);A[X+vt-ht]|=128*Bt}M.accessor=function(){return Uint8Array},M.allocate=function(A,R,X){return new M(A,R,X)},M.concat=function(A,R,X,he){"boolean"!=typeof R&&"string"==typeof R||(he=X,X=R,R=void 0);for(var z,Le=0,K=0,be=A.length;K<be;++K)M.isByteBuffer(A[K])||(A[K]=M.wrap(A[K],R)),(z=A[K].limit-A[K].offset)>0&&(Le+=z);if(0===Le)return new M(0,X,he);var Ne,je=new M(Le,X,he);for(K=0;K<be;)(z=(Ne=A[K++]).limit-Ne.offset)<=0||(je.view.set(Ne.view.subarray(Ne.offset,Ne.limit),je.offset),je.offset+=z);return je.limit=je.offset,je.offset=0,je},M.isByteBuffer=function(A){return!0===(A&&A.__isByteBuffer__)},M.type=function(){return ArrayBuffer},M.wrap=function(A,R,X,he){if("string"!=typeof R&&(he=X,X=R,R=void 0),"string"==typeof A)switch(void 0===R&&(R="utf8"),R){case"base64":return M.fromBase64(A,X);case"hex":return M.fromHex(A,X);case"binary":return M.fromBinary(A,X);case"utf8":return M.fromUTF8(A,X);case"debug":return M.fromDebug(A,X);default:throw Error("Unsupported encoding: "+R)}if(null===A||"object"!=typeof A)throw TypeError("Illegal buffer");var z;if(M.isByteBuffer(A))return(z=P.clone.call(A)).markedOffset=-1,z;if(A instanceof Uint8Array)z=new M(0,X,he),A.length>0&&(z.buffer=A.buffer,z.offset=A.byteOffset,z.limit=A.byteOffset+A.byteLength,z.view=new Uint8Array(A.buffer));else if(A instanceof ArrayBuffer)z=new M(0,X,he),A.byteLength>0&&(z.buffer=A,z.offset=0,z.limit=A.byteLength,z.view=A.byteLength>0?new Uint8Array(A):null);else{if("[object Array]"!==Object.prototype.toString.call(A))throw TypeError("Illegal buffer");(z=new M(A.length,X,he)).limit=A.length;for(var Le=0;Le<A.length;++Le)z.view[Le]=A[Le]}return z},P.writeBitSet=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if(!(A instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he,z=R,Le=A.length,K=Le>>3,be=0;for(R+=this.writeVarint32(Le,R);K--;)he=1&!!A[be++]|(1&!!A[be++])<<1|(1&!!A[be++])<<2|(1&!!A[be++])<<3|(1&!!A[be++])<<4|(1&!!A[be++])<<5|(1&!!A[be++])<<6|(1&!!A[be++])<<7,this.writeByte(he,R++);if(be<Le){var Ne=0;for(he=0;be<Le;)he|=(1&!!A[be++])<<Ne++;this.writeByte(he,R++)}return X?(this.offset=R,this):R-z},P.readBitSet=function(A){var R=void 0===A;R&&(A=this.offset);var X,he=this.readVarint32(A),z=he.value,Le=z>>3,K=0,be=[];for(A+=he.length;Le--;)X=this.readByte(A++),be[K++]=!!(1&X),be[K++]=!!(2&X),be[K++]=!!(4&X),be[K++]=!!(8&X),be[K++]=!!(16&X),be[K++]=!!(32&X),be[K++]=!!(64&X),be[K++]=!!(128&X);if(K<z){var Ne=0;for(X=this.readByte(A++);K<z;)be[K++]=!!(X>>Ne++&1)}return R&&(this.offset=A),be},P.readBytes=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+A>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+"+A+") <= "+this.buffer.byteLength)}var he=this.slice(R,R+A);return X&&(this.offset+=A),he},P.writeBytes=P.append,P.writeInt8=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=1)>he&&this.resize((he*=2)>R?he:R),this.view[R-=1]=A,X&&(this.offset+=1),this},P.writeByte=P.writeInt8,P.readInt8=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=this.view[A];return 128&~X||(X=-(255-X+1)),R&&(this.offset+=1),X},P.readByte=P.readInt8,P.writeUint8=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=1)>he&&this.resize((he*=2)>R?he:R),this.view[R-=1]=A,X&&(this.offset+=1),this},P.writeUInt8=P.writeUint8,P.readUint8=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=this.view[A];return R&&(this.offset+=1),X},P.readUInt8=P.readUint8,P.writeInt16=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=2)>he&&this.resize((he*=2)>R?he:R),R-=2,this.littleEndian?(this.view[R+1]=(65280&A)>>>8,this.view[R]=255&A):(this.view[R]=(65280&A)>>>8,this.view[R+1]=255&A),X&&(this.offset+=2),this},P.writeShort=P.writeInt16,P.readInt16=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+2) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A],X|=this.view[A+1]<<8):(X=this.view[A]<<8,X|=this.view[A+1]),32768&~X||(X=-(65535-X+1)),R&&(this.offset+=2),X},P.readShort=P.readInt16,P.writeUint16=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=2)>he&&this.resize((he*=2)>R?he:R),R-=2,this.littleEndian?(this.view[R+1]=(65280&A)>>>8,this.view[R]=255&A):(this.view[R]=(65280&A)>>>8,this.view[R+1]=255&A),X&&(this.offset+=2),this},P.writeUInt16=P.writeUint16,P.readUint16=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+2) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A],X|=this.view[A+1]<<8):(X=this.view[A]<<8,X|=this.view[A+1]),R&&(this.offset+=2),X},P.readUInt16=P.readUint16,P.writeInt32=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=4)>he&&this.resize((he*=2)>R?he:R),R-=4,this.littleEndian?(this.view[R+3]=A>>>24&255,this.view[R+2]=A>>>16&255,this.view[R+1]=A>>>8&255,this.view[R]=255&A):(this.view[R]=A>>>24&255,this.view[R+1]=A>>>16&255,this.view[R+2]=A>>>8&255,this.view[R+3]=255&A),X&&(this.offset+=4),this},P.writeInt=P.writeInt32,P.readInt32=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0):(X=this.view[A+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0),X|=0,R&&(this.offset+=4),X},P.readInt=P.readInt32,P.writeUint32=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=4)>he&&this.resize((he*=2)>R?he:R),R-=4,this.littleEndian?(this.view[R+3]=A>>>24&255,this.view[R+2]=A>>>16&255,this.view[R+1]=A>>>8&255,this.view[R]=255&A):(this.view[R]=A>>>24&255,this.view[R+1]=A>>>16&255,this.view[R+2]=A>>>8&255,this.view[R+3]=255&A),X&&(this.offset+=4),this},P.writeUInt32=P.writeUint32,P.readUint32=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0):(X=this.view[A+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0),R&&(this.offset+=4),X},P.readUInt32=P.readUint32,G&&(P.writeInt64=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"==typeof A)A=G.fromNumber(A);else if("string"==typeof A)A=G.fromString(A);else if(!(A&&A instanceof G))throw TypeError("Illegal value: "+A+" (not an integer or Long)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}"number"==typeof A?A=G.fromNumber(A):"string"==typeof A&&(A=G.fromString(A));var he=this.buffer.byteLength;(R+=8)>he&&this.resize((he*=2)>R?he:R),R-=8;var z=A.low,Le=A.high;return this.littleEndian?(this.view[R+3]=z>>>24&255,this.view[R+2]=z>>>16&255,this.view[R+1]=z>>>8&255,this.view[R]=255&z,this.view[(R+=4)+3]=Le>>>24&255,this.view[R+2]=Le>>>16&255,this.view[R+1]=Le>>>8&255,this.view[R]=255&Le):(this.view[R]=Le>>>24&255,this.view[R+1]=Le>>>16&255,this.view[R+2]=Le>>>8&255,this.view[R+3]=255&Le,this.view[R+=4]=z>>>24&255,this.view[R+1]=z>>>16&255,this.view[R+2]=z>>>8&255,this.view[R+3]=255&z),X&&(this.offset+=8),this},P.writeLong=P.writeInt64,P.readInt64=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+8) <= "+this.buffer.byteLength)}var X=0,he=0;this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0,he=this.view[(A+=4)+2]<<16,he|=this.view[A+1]<<8,he|=this.view[A],he+=this.view[A+3]<<24>>>0):(he=this.view[A+1]<<16,he|=this.view[A+2]<<8,he|=this.view[A+3],he+=this.view[A]<<24>>>0,X=this.view[(A+=4)+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0);var z=new G(X,he,!1);return R&&(this.offset+=8),z},P.readLong=P.readInt64,P.writeUint64=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"==typeof A)A=G.fromNumber(A);else if("string"==typeof A)A=G.fromString(A);else if(!(A&&A instanceof G))throw TypeError("Illegal value: "+A+" (not an integer or Long)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}"number"==typeof A?A=G.fromNumber(A):"string"==typeof A&&(A=G.fromString(A));var he=this.buffer.byteLength;(R+=8)>he&&this.resize((he*=2)>R?he:R),R-=8;var z=A.low,Le=A.high;return this.littleEndian?(this.view[R+3]=z>>>24&255,this.view[R+2]=z>>>16&255,this.view[R+1]=z>>>8&255,this.view[R]=255&z,this.view[(R+=4)+3]=Le>>>24&255,this.view[R+2]=Le>>>16&255,this.view[R+1]=Le>>>8&255,this.view[R]=255&Le):(this.view[R]=Le>>>24&255,this.view[R+1]=Le>>>16&255,this.view[R+2]=Le>>>8&255,this.view[R+3]=255&Le,this.view[R+=4]=z>>>24&255,this.view[R+1]=z>>>16&255,this.view[R+2]=z>>>8&255,this.view[R+3]=255&z),X&&(this.offset+=8),this},P.writeUInt64=P.writeUint64,P.readUint64=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+8) <= "+this.buffer.byteLength)}var X=0,he=0;this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0,he=this.view[(A+=4)+2]<<16,he|=this.view[A+1]<<8,he|=this.view[A],he+=this.view[A+3]<<24>>>0):(he=this.view[A+1]<<16,he|=this.view[A+2]<<8,he|=this.view[A+3],he+=this.view[A]<<24>>>0,X=this.view[(A+=4)+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0);var z=new G(X,he,!0);return R&&(this.offset+=8),z},P.readUInt64=P.readUint64),P.writeFloat32=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A)throw TypeError("Illegal value: "+A+" (not a number)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=4)>he&&this.resize((he*=2)>R?he:R),ie(this.view,A,R-=4,this.littleEndian,23,4),X&&(this.offset+=4),this},P.writeFloat=P.writeFloat32,P.readFloat32=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=me(this.view,A,this.littleEndian,23,4);return R&&(this.offset+=4),X},P.readFloat=P.readFloat32,P.writeFloat64=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A)throw TypeError("Illegal value: "+A+" (not a number)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=8)>he&&this.resize((he*=2)>R?he:R),ie(this.view,A,R-=8,this.littleEndian,52,8),X&&(this.offset+=8),this},P.writeDouble=P.writeFloat64,P.readFloat64=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+8) <= "+this.buffer.byteLength)}var X=me(this.view,A,this.littleEndian,52,8);return R&&(this.offset+=8),X},P.readDouble=P.readFloat64,M.MAX_VARINT32_BYTES=5,M.calculateVarint32=function(A){return(A>>>=0)<128?1:A<16384?2:A<2097152?3:A<268435456?4:5},M.zigZagEncode32=function(A){return((A|=0)<<1^A>>31)>>>0},M.zigZagDecode32=function(A){return A>>>1^-(1&A)},P.writeVarint32=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var z=M.calculateVarint32(A),Le=this.buffer.byteLength;for((R+=z)>Le&&this.resize((Le*=2)>R?Le:R),R-=z,A>>>=0;A>=128;)this.view[R++]=127&A|128,A>>>=7;return this.view[R++]=A,X?(this.offset=R,this):z},P.writeVarint32ZigZag=function(A,R){return this.writeVarint32(M.zigZagEncode32(A),R)},P.readVarint32=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X,he=0,z=0;do{if(!this.noAssert&&A>this.limit){var Le=Error("Truncated");throw Le.truncated=!0,Le}X=this.view[A++],he<5&&(z|=(127&X)<<7*he),++he}while(128&X);return z|=0,R?(this.offset=A,z):{value:z,length:he}},P.readVarint32ZigZag=function(A){var R=this.readVarint32(A);return"object"==typeof R?R.value=M.zigZagDecode32(R.value):R=M.zigZagDecode32(R),R},G&&(M.MAX_VARINT64_BYTES=10,M.calculateVarint64=function(A){"number"==typeof A?A=G.fromNumber(A):"string"==typeof A&&(A=G.fromString(A));var R=A.toInt()>>>0,X=A.shiftRightUnsigned(28).toInt()>>>0,he=A.shiftRightUnsigned(56).toInt()>>>0;return 0==he?0==X?R<16384?R<128?1:2:R<2097152?3:4:X<16384?X<128?5:6:X<2097152?7:8:he<128?9:10},M.zigZagEncode64=function(A){return"number"==typeof A?A=G.fromNumber(A,!1):"string"==typeof A?A=G.fromString(A,!1):!1!==A.unsigned&&(A=A.toSigned()),A.shiftLeft(1).xor(A.shiftRight(63)).toUnsigned()},M.zigZagDecode64=function(A){return"number"==typeof A?A=G.fromNumber(A,!1):"string"==typeof A?A=G.fromString(A,!1):!1!==A.unsigned&&(A=A.toSigned()),A.shiftRightUnsigned(1).xor(A.and(G.ONE).toSigned().negate()).toSigned()},P.writeVarint64=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"==typeof A)A=G.fromNumber(A);else if("string"==typeof A)A=G.fromString(A);else if(!(A&&A instanceof G))throw TypeError("Illegal value: "+A+" (not an integer or Long)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}"number"==typeof A?A=G.fromNumber(A,!1):"string"==typeof A?A=G.fromString(A,!1):!1!==A.unsigned&&(A=A.toSigned());var he=M.calculateVarint64(A),z=A.toInt()>>>0,Le=A.shiftRightUnsigned(28).toInt()>>>0,K=A.shiftRightUnsigned(56).toInt()>>>0,be=this.buffer.byteLength;switch((R+=he)>be&&this.resize((be*=2)>R?be:R),R-=he,he){case 10:this.view[R+9]=K>>>7&1;case 9:this.view[R+8]=9!==he?128|K:127&K;case 8:this.view[R+7]=8!==he?Le>>>21|128:Le>>>21&127;case 7:this.view[R+6]=7!==he?Le>>>14|128:Le>>>14&127;case 6:this.view[R+5]=6!==he?Le>>>7|128:Le>>>7&127;case 5:this.view[R+4]=5!==he?128|Le:127&Le;case 4:this.view[R+3]=4!==he?z>>>21|128:z>>>21&127;case 3:this.view[R+2]=3!==he?z>>>14|128:z>>>14&127;case 2:this.view[R+1]=2!==he?z>>>7|128:z>>>7&127;case 1:this.view[R]=1!==he?128|z:127&z}return X?(this.offset+=he,this):he},P.writeVarint64ZigZag=function(A,R){return this.writeVarint64(M.zigZagEncode64(A),R)},P.readVarint64=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=A,he=0,z=0,Le=0,K=0;if(he=127&(K=this.view[A++]),128&K&&(he|=(127&(K=this.view[A++]))<<7,(128&K||this.noAssert&&void 0===K)&&(he|=(127&(K=this.view[A++]))<<14,(128&K||this.noAssert&&void 0===K)&&(he|=(127&(K=this.view[A++]))<<21,(128&K||this.noAssert&&void 0===K)&&(z=127&(K=this.view[A++]),(128&K||this.noAssert&&void 0===K)&&(z|=(127&(K=this.view[A++]))<<7,(128&K||this.noAssert&&void 0===K)&&(z|=(127&(K=this.view[A++]))<<14,(128&K||this.noAssert&&void 0===K)&&(z|=(127&(K=this.view[A++]))<<21,(128&K||this.noAssert&&void 0===K)&&(Le=127&(K=this.view[A++]),(128&K||this.noAssert&&void 0===K)&&(Le|=(127&(K=this.view[A++]))<<7,128&K||this.noAssert&&void 0===K))))))))))throw Error("Buffer overrun");var be=G.fromBits(he|z<<28,z>>>4|Le<<24,!1);return R?(this.offset=A,be):{value:be,length:A-X}},P.readVarint64ZigZag=function(A){var R=this.readVarint64(A);return R&&R.value instanceof G?R.value=M.zigZagDecode64(R.value):R=M.zigZagDecode64(R),R}),P.writeCString=function(A,R){var X=void 0===R;X&&(R=this.offset);var he,z=A.length;if(!this.noAssert){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");for(he=0;he<z;++he)if(0===A.charCodeAt(he))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}z=Q.calculateUTF16asUTF8(ne(A))[1];var Le=this.buffer.byteLength;return(R+=z+1)>Le&&this.resize((Le*=2)>R?Le:R),R-=z+1,Q.encodeUTF16toUTF8(ne(A),function(K){this.view[R++]=K}.bind(this)),this.view[R++]=0,X?(this.offset=R,this):z},P.readCString=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X,he=A,z=-1;return Q.decodeUTF8toUTF16(function(){if(0===z)return null;if(A>=this.limit)throw RangeError("Illegal range: Truncated data, "+A+" < "+this.limit);return 0===(z=this.view[A++])?null:z}.bind(this),X=ue(),!0),R?(this.offset=A,X()):{string:X(),length:A-he}},P.writeIString=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he,z=R;he=Q.calculateUTF16asUTF8(ne(A),this.noAssert)[1];var Le=this.buffer.byteLength;if((R+=4+he)>Le&&this.resize((Le*=2)>R?Le:R),R-=4+he,this.littleEndian?(this.view[R+3]=he>>>24&255,this.view[R+2]=he>>>16&255,this.view[R+1]=he>>>8&255,this.view[R]=255&he):(this.view[R]=he>>>24&255,this.view[R+1]=he>>>16&255,this.view[R+2]=he>>>8&255,this.view[R+3]=255&he),R+=4,Q.encodeUTF16toUTF8(ne(A),function(K){this.view[R++]=K}.bind(this)),R!==z+4+he)throw RangeError("Illegal range: Truncated data, "+R+" == "+(R+4+he));return X?(this.offset=R,this):R-z},P.readIString=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=A,he=this.readUint32(A),z=this.readUTF8String(he,M.METRICS_BYTES,A+=4);return A+=z.length,R?(this.offset=A,z.string):{string:z.string,length:A-X}},M.METRICS_CHARS="c",M.METRICS_BYTES="b",P.writeUTF8String=function(A,R){var X,he=void 0===R;if(he&&(R=this.offset),!this.noAssert){if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var z=R;X=Q.calculateUTF16asUTF8(ne(A))[1];var Le=this.buffer.byteLength;return(R+=X)>Le&&this.resize((Le*=2)>R?Le:R),R-=X,Q.encodeUTF16toUTF8(ne(A),function(K){this.view[R++]=K}.bind(this)),he?(this.offset=R,this):R-z},P.writeString=P.writeUTF8String,M.calculateUTF8Chars=function(A){return Q.calculateUTF16asUTF8(ne(A))[0]},M.calculateUTF8Bytes=function(A){return Q.calculateUTF16asUTF8(ne(A))[1]},M.calculateString=M.calculateUTF8Bytes,P.readUTF8String=function(A,R,X){"number"==typeof R&&(X=R,R=void 0);var he=void 0===X;if(he&&(X=this.offset),void 0===R&&(R=M.METRICS_CHARS),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal length: "+A+" (not an integer)");if(A|=0,"number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+0) <= "+this.buffer.byteLength)}var z,Le=0,K=X;if(R===M.METRICS_CHARS){if(z=ue(),Q.decodeUTF8(function(){return Le<A&&X<this.limit?this.view[X++]:null}.bind(this),function(Ne){++Le,Q.UTF8toUTF16(Ne,z)}),Le!==A)throw RangeError("Illegal range: Truncated data, "+Le+" == "+A);return he?(this.offset=X,z()):{string:z(),length:X-K}}if(R===M.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+A>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+"+A+") <= "+this.buffer.byteLength)}var be=X+A;if(Q.decodeUTF8toUTF16(function(){return X<be?this.view[X++]:null}.bind(this),z=ue(),this.noAssert),X!==be)throw RangeError("Illegal range: Truncated data, "+X+" == "+be);return he?(this.offset=X,z()):{string:z(),length:X-K}}throw TypeError("Unsupported metrics: "+R)},P.readString=P.readUTF8String,P.writeVString=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he,z,Le=R;he=Q.calculateUTF16asUTF8(ne(A),this.noAssert)[1],z=M.calculateVarint32(he);var K=this.buffer.byteLength;if((R+=z+he)>K&&this.resize((K*=2)>R?K:R),R-=z+he,R+=this.writeVarint32(he,R),Q.encodeUTF16toUTF8(ne(A),function(be){this.view[R++]=be}.bind(this)),R!==Le+he+z)throw RangeError("Illegal range: Truncated data, "+R+" == "+(R+he+z));return X?(this.offset=R,this):R-Le},P.readVString=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=A,he=this.readVarint32(A),z=this.readUTF8String(he.value,M.METRICS_BYTES,A+=he.length);return A+=z.length,R?(this.offset=A,z.string):{string:z.string,length:A-X}},P.append=function(A,R,X){"number"!=typeof R&&"string"==typeof R||(X=R,R=void 0);var he=void 0===X;if(he&&(X=this.offset),!this.noAssert){if("number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+0) <= "+this.buffer.byteLength)}A instanceof M||(A=M.wrap(A,R));var z=A.limit-A.offset;if(z<=0)return this;var Le=this.buffer.byteLength;return(X+=z)>Le&&this.resize((Le*=2)>X?Le:X),X-=z,this.view.set(A.view.subarray(A.offset,A.limit),X),A.offset+=z,he&&(this.offset+=z),this},P.appendTo=function(A,R){return A.append(this,R),this},P.assert=function(A){return this.noAssert=!A,this},P.capacity=function(){return this.buffer.byteLength},P.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},P.clone=function(A){var R=new M(0,this.littleEndian,this.noAssert);return A?(R.buffer=new ArrayBuffer(this.buffer.byteLength),R.view=new Uint8Array(R.buffer)):(R.buffer=this.buffer,R.view=this.view),R.offset=this.offset,R.markedOffset=this.markedOffset,R.limit=this.limit,R},P.compact=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}if(0===A&&R===this.buffer.byteLength)return this;var X=R-A;if(0===X)return this.buffer=fe,this.view=null,this.markedOffset>=0&&(this.markedOffset-=A),this.offset=0,this.limit=0,this;var he=new ArrayBuffer(X),z=new Uint8Array(he);return z.set(this.view.subarray(A,R)),this.buffer=he,this.view=z,this.markedOffset>=0&&(this.markedOffset-=A),this.offset=0,this.limit=X,this},P.copy=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}if(A===R)return new M(0,this.littleEndian,this.noAssert);var X=R-A,he=new M(X,this.littleEndian,this.noAssert);return he.offset=0,he.limit=X,he.markedOffset>=0&&(he.markedOffset-=A),this.copyTo(he,0,A,R),he},P.copyTo=function(A,R,X,he){var z,Le;if(!this.noAssert&&!M.isByteBuffer(A))throw TypeError("Illegal target: Not a ByteBuffer");if(R=(Le=void 0===R)?A.offset:0|R,X=(z=void 0===X)?this.offset:0|X,he=void 0===he?this.limit:0|he,R<0||R>A.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+R+" <= "+A.buffer.byteLength);if(X<0||he>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+X+" <= "+this.buffer.byteLength);var K=he-X;return 0===K?A:(A.ensureCapacity(R+K),A.view.set(this.view.subarray(X,he),R),z&&(this.offset+=K),Le&&(A.offset+=K),this)},P.ensureCapacity=function(A){var R=this.buffer.byteLength;return R<A?this.resize((R*=2)>A?R:A):this},P.fill=function(A,R,X){var he=void 0===R;if(he&&(R=this.offset),"string"==typeof A&&A.length>0&&(A=A.charCodeAt(0)),void 0===R&&(R=this.offset),void 0===X&&(X=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal begin: Not an integer");if(R>>>=0,"number"!=typeof X||X%1!=0)throw TypeError("Illegal end: Not an integer");if(X>>>=0,R<0||R>X||X>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+R+" <= "+X+" <= "+this.buffer.byteLength)}if(R>=X)return this;for(;R<X;)this.view[R++]=A;return he&&(this.offset=R),this},P.flip=function(){return this.limit=this.offset,this.offset=0,this},P.mark=function(A){if(A=void 0===A?this.offset:A,!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=A,this},P.order=function(A){if(!this.noAssert&&"boolean"!=typeof A)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!A,this},P.LE=function(A){return this.littleEndian=void 0===A||!!A,this},P.BE=function(A){return this.littleEndian=void 0!==A&&!A,this},P.prepend=function(A,R,X){"number"!=typeof R&&"string"==typeof R||(X=R,R=void 0);var he=void 0===X;if(he&&(X=this.offset),!this.noAssert){if("number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+0) <= "+this.buffer.byteLength)}A instanceof M||(A=M.wrap(A,R));var z=A.limit-A.offset;if(z<=0)return this;var Le=z-X;if(Le>0){var K=new ArrayBuffer(this.buffer.byteLength+Le),be=new Uint8Array(K);be.set(this.view.subarray(X,this.buffer.byteLength),z),this.buffer=K,this.view=be,this.offset+=Le,this.markedOffset>=0&&(this.markedOffset+=Le),this.limit+=Le,X+=Le}else new Uint8Array(this.buffer);return this.view.set(A.view.subarray(A.offset,A.limit),X-z),A.offset=A.limit,he&&(this.offset-=z),this},P.prependTo=function(A,R){return A.prepend(this,R),this},P.printDebug=function(A){"function"!=typeof A&&(A=console.log.bind(console)),A(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},P.remaining=function(){return this.limit-this.offset},P.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},P.resize=function(A){if(!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal capacity: "+A+" (not an integer)");if((A|=0)<0)throw RangeError("Illegal capacity: 0 <= "+A)}if(this.buffer.byteLength<A){var R=new ArrayBuffer(A),X=new Uint8Array(R);X.set(this.view),this.buffer=R,this.view=X}return this},P.reverse=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}return A===R||Array.prototype.reverse.call(this.view.subarray(A,R)),this},P.skip=function(A){if(!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal length: "+A+" (not an integer)");A|=0}var R=this.offset+A;if(!this.noAssert&&(R<0||R>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+A+" <= "+this.buffer.byteLength);return this.offset=R,this},P.slice=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}var X=this.clone();return X.offset=A,X.limit=R,X},P.toBuffer=function(A){var R=this.offset,X=this.limit;if(!this.noAssert){if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: Not an integer");if(R>>>=0,"number"!=typeof X||X%1!=0)throw TypeError("Illegal limit: Not an integer");if(X>>>=0,R<0||R>X||X>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+R+" <= "+X+" <= "+this.buffer.byteLength)}if(!A&&0===R&&X===this.buffer.byteLength)return this.buffer;if(R===X)return fe;var he=new ArrayBuffer(X-R);return new Uint8Array(he).set(new Uint8Array(this.buffer).subarray(R,X),0),he},P.toArrayBuffer=P.toBuffer,P.toString=function(A,R,X){if(void 0===A)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof A&&(X=R=A="utf8"),A){case"utf8":return this.toUTF8(R,X);case"base64":return this.toBase64(R,X);case"hex":return this.toHex(R,X);case"binary":return this.toBinary(R,X);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+A)}};var W=function(){for(var A={},R=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],X=[],he=0,z=R.length;he<z;++he)X[R[he]]=he;return A.encode=function(Le,K){for(var be,Ne;null!==(be=Le());)K(R[be>>2&63]),Ne=(3&be)<<4,null!==(be=Le())?(K(R[63&((Ne|=be>>4&15)|be>>4&15)]),Ne=(15&be)<<2,null!==(be=Le())?(K(R[63&(Ne|be>>6&3)]),K(R[63&be])):(K(R[63&Ne]),K(61))):(K(R[63&Ne]),K(61),K(61))},A.decode=function(Le,K){var be,Ne,je;function Te(qe){throw Error("Illegal character code: "+qe)}for(;null!==(be=Le());)if(void 0===(Ne=X[be])&&Te(be),null!==(be=Le())&&(void 0===(je=X[be])&&Te(be),K(Ne<<2>>>0|(48&je)>>4),null!==(be=Le()))){if(void 0===(Ne=X[be])){if(61===be)break;Te(be)}if(K((15&je)<<4>>>0|(60&Ne)>>2),null!==(be=Le())){if(void 0===(je=X[be])){if(61===be)break;Te(be)}K((3&Ne)<<6>>>0|je)}}},A.test=function(Le){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(Le)},A}();P.toBase64=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),R|=0,(A|=0)<0||R>this.capacity||A>R)throw RangeError("begin, end");var X;return W.encode(function(){return A<R?this.view[A++]:null}.bind(this),X=ue()),X()},M.fromBase64=function(A,R){if("string"!=typeof A)throw TypeError("str");var X=new M(A.length/4*3,R),he=0;return W.decode(ne(A),function(z){X.view[he++]=z}),X.limit=he,X},M.btoa=function(A){return M.fromBinary(A).toBase64()},M.atob=function(A){return M.fromBase64(A).toBinary()},P.toBinary=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),R|=0,(A|=0)<0||R>this.capacity()||A>R)throw RangeError("begin, end");if(A===R)return"";for(var X=[],he=[];A<R;)X.push(this.view[A++]),X.length>=1024&&(he.push(String.fromCharCode.apply(String,X)),X=[]);return he.join("")+String.fromCharCode.apply(String,X)},M.fromBinary=function(A,R){if("string"!=typeof A)throw TypeError("str");for(var X,he=0,z=A.length,Le=new M(z,R);he<z;){if((X=A.charCodeAt(he))>255)throw RangeError("illegal char code: "+X);Le.view[he++]=X}return Le.limit=z,Le},P.toDebug=function(A){for(var R,X=-1,he=this.buffer.byteLength,z="",Le="",K="";X<he;){if(-1!==X&&(z+=(R=this.view[X])<16?"0"+R.toString(16).toUpperCase():R.toString(16).toUpperCase(),A&&(Le+=R>32&&R<127?String.fromCharCode(R):".")),++X,A&&X>0&&X%16==0&&X!==he){for(;z.length<51;)z+=" ";K+=z+Le+"\n",z=Le=""}z+=X===this.offset&&X===this.limit?X===this.markedOffset?"!":"|":X===this.offset?X===this.markedOffset?"[":"<":X===this.limit?X===this.markedOffset?"]":">":X===this.markedOffset?"'":A||0!==X&&X!==he?" ":""}if(A&&" "!==z){for(;z.length<51;)z+=" ";K+=z+Le+"\n"}return A?K:z},M.fromDebug=function(A,R,X){for(var he,z,Le=A.length,K=new M((Le+1)/3|0,R,X),be=0,Ne=0,je=!1,Te=!1,qe=!1,Ke=!1,vt=!1;be<Le;){switch(he=A.charAt(be++)){case"!":if(!X){if(Te||qe||Ke){vt=!0;break}Te=qe=Ke=!0}K.offset=K.markedOffset=K.limit=Ne,je=!1;break;case"|":if(!X){if(Te||Ke){vt=!0;break}Te=Ke=!0}K.offset=K.limit=Ne,je=!1;break;case"[":if(!X){if(Te||qe){vt=!0;break}Te=qe=!0}K.offset=K.markedOffset=Ne,je=!1;break;case"<":if(!X){if(Te){vt=!0;break}Te=!0}K.offset=Ne,je=!1;break;case"]":if(!X){if(Ke||qe){vt=!0;break}Ke=qe=!0}K.limit=K.markedOffset=Ne,je=!1;break;case">":if(!X){if(Ke){vt=!0;break}Ke=!0}K.limit=Ne,je=!1;break;case"'":if(!X){if(qe){vt=!0;break}qe=!0}K.markedOffset=Ne,je=!1;break;case" ":je=!1;break;default:if(!X&&je){vt=!0;break}if(z=parseInt(he+A.charAt(be++),16),!X&&(isNaN(z)||z<0||z>255))throw TypeError("Illegal str: Not a debug encoded string");K.view[Ne++]=z,je=!0}if(vt)throw TypeError("Illegal str: Invalid symbol at "+be)}if(!X){if(!Te||!Ke)throw TypeError("Illegal str: Missing offset or limit");if(Ne<K.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+Ne+" < "+Le)}return K},P.toHex=function(A,R){if(A=void 0===A?this.offset:A,R=void 0===R?this.limit:R,!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}for(var X,he=new Array(R-A);A<R;)(X=this.view[A++])<16?he.push("0",X.toString(16)):he.push(X.toString(16));return he.join("")},M.fromHex=function(A,R,X){if(!X){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");if(A.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var he,z=A.length,Le=new M(z/2|0,R),K=0,be=0;K<z;K+=2){if(he=parseInt(A.substring(K,K+2),16),!X&&(!isFinite(he)||he<0||he>255))throw TypeError("Illegal str: Contains non-hex characters");Le.view[be++]=he}return Le.limit=be,Le};var Q=function(){var A={MAX_CODEPOINT:1114111,encodeUTF8:function(R,X){var he=null;for("number"==typeof R&&(he=R,R=function(){return null});null!==he||null!==(he=R());)he<128?X(127&he):he<2048?(X(he>>6&31|192),X(63&he|128)):he<65536?(X(he>>12&15|224),X(he>>6&63|128),X(63&he|128)):(X(he>>18&7|240),X(he>>12&63|128),X(he>>6&63|128),X(63&he|128)),he=null},decodeUTF8:function(R,X){for(var he,z,Le,K,be=function(Ne){Ne=Ne.slice(0,Ne.indexOf(null));var je=Error(Ne.toString());throw je.name="TruncatedError",je.bytes=Ne,je};null!==(he=R());)if(128&he)if(192==(224&he))null===(z=R())&&be([he,z]),X((31&he)<<6|63&z);else if(224==(240&he))(null===(z=R())||null===(Le=R()))&&be([he,z,Le]),X((15&he)<<12|(63&z)<<6|63&Le);else{if(240!=(248&he))throw RangeError("Illegal starting byte: "+he);(null===(z=R())||null===(Le=R())||null===(K=R()))&&be([he,z,Le,K]),X((7&he)<<18|(63&z)<<12|(63&Le)<<6|63&K)}else X(he)},UTF16toUTF8:function(R,X){for(var he,z=null;null!==(he=null!==z?z:R());)he>=55296&&he<=57343&&null!==(z=R())&&z>=56320&&z<=57343?(X(1024*(he-55296)+z-56320+65536),z=null):X(he);null!==z&&X(z)},UTF8toUTF16:function(R,X){var he=null;for("number"==typeof R&&(he=R,R=function(){return null});null!==he||null!==(he=R());)he<=65535?X(he):(X(55296+((he-=65536)>>10)),X(he%1024+56320)),he=null},encodeUTF16toUTF8:function(R,X){A.UTF16toUTF8(R,function(he){A.encodeUTF8(he,X)})},decodeUTF8toUTF16:function(R,X){A.decodeUTF8(R,function(he){A.UTF8toUTF16(he,X)})},calculateCodePoint:function(R){return R<128?1:R<2048?2:R<65536?3:4},calculateUTF8:function(R){for(var X,he=0;null!==(X=R());)he+=X<128?1:X<2048?2:X<65536?3:4;return he},calculateUTF16asUTF8:function(R){var X=0,he=0;return A.UTF16toUTF8(R,function(z){++X,he+=z<128?1:z<2048?2:z<65536?3:4}),[X,he]}};return A}();return P.toUTF8=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}var X;try{Q.decodeUTF8toUTF16(function(){return A<R?this.view[A++]:null}.bind(this),X=ue())}catch{if(A!==R)throw RangeError("Illegal range: Truncated data, "+A+" != "+R)}return X()},M.fromUTF8=function(A,R,X){if(!X&&"string"!=typeof A)throw TypeError("Illegal str: Not a string");var he=new M(Q.calculateUTF16asUTF8(ne(A),!0)[1],R,X),z=0;return Q.encodeUTF16toUTF8(ne(A),function(Le){he.view[z++]=Le}),he.limit=z,he},M},void 0===(D=x.apply(o,B))||(n.exports=D)},690:n=>{n.exports=function(o){switch(o){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},87:n=>{n.exports="function"==typeof Object.create?function(o,l){l&&(o.super_=l,o.prototype=Object.create(l.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:function(o,l){if(l){o.super_=l;var x=function(){};x.prototype=l.prototype,o.prototype=new x,o.prototype.constructor=o}}},809:n=>{function o(l){return!!l.constructor&&"function"==typeof l.constructor.isBuffer&&l.constructor.isBuffer(l)}n.exports=function(l){return null!=l&&(o(l)||"function"==typeof(x=l).readFloatLE&&"function"==typeof x.slice&&o(x.slice(0,0))||!!l._isBuffer);var x}},190:(n,o,l)=>{var x=l(408),B=l(720),D=l(355),G=["x","e","a","o","n","s","r","c","u","m","v","w","z"],M=["m","w"],P=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"];function ne(Q){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(Q)}function ue(Q){return new Function(["return function "+Q+"() {","  return this._"+Q,"}"].join("\n"))()}function me(Q,A){if(!Q.chars||0===Q.chars.length)return null;var R=W(Q.chars,A);return R>=0?Q.chars[R]:null}function ie(Q,A,R){if(!Q.kernings||0===Q.kernings.length)return 0;for(var X=Q.kernings,he=0;he<X.length;he++){var z=X[he];if(z.first===A&&z.second===R)return z.amount}return 0}function W(Q,A,R){for(var X=R=R||0;X<Q.length;X++)if(Q[X].id===A)return X;return-1}n.exports=function(Q){return new ne(Q)},ne.prototype.update=function(Q){if(Q=B({measure:this._measure},Q),this._opt=Q,this._opt.tabSize=D(this._opt.tabSize,4),!Q.font)throw new Error("must provide a valid bitmap font");var A=this.glyphs,R=Q.text||"",X=Q.font;this._setupSpaceGlyphs(X);var he=x.lines(R,Q),z=Q.width||0;A.length=0;var Le=he.reduce(function(Bt,wt){return Math.max(Bt,wt.width,z)},0),K=0,be=0,Ne=D(Q.lineHeight,X.common.lineHeight),je=X.common.base,Te=Ne-je,qe=Q.letterSpacing||0,Ke=Ne*he.length-Te,vt=function(Bt){return"center"===Bt?1:"right"===Bt?2:0}(this._opt.align);be-=Ke,this._width=Le,this._height=Ke,this._descender=Ne-je,this._baseline=je,this._xHeight=function(Bt){for(var wt=0;wt<G.length;wt++){var Ft=G[wt].charCodeAt(0),Ot=W(Bt.chars,Ft);if(Ot>=0)return Bt.chars[Ot].height}return 0}(X),this._capHeight=function(Bt){for(var wt=0;wt<P.length;wt++){var Ft=P[wt].charCodeAt(0),Ot=W(Bt.chars,Ft);if(Ot>=0)return Bt.chars[Ot].height}return 0}(X),this._lineHeight=Ne,this._ascender=Ne-Te-this._xHeight;var ht=this;he.forEach(function(Bt,wt){for(var Ft,on=Bt.end,ft=Bt.width,An=Bt.start;An<on;An++){var Cn=R.charCodeAt(An),fn=ht.getGlyph(X,Cn);if(fn){Ft&&(K+=ie(X,Ft.id,fn.id));var On=K;1===vt?On+=(Le-ft)/2:2===vt&&(On+=Le-ft),A.push({position:[On,be],data:fn,index:An,line:wt}),K+=fn.xadvance+qe,Ft=fn}}be+=Ne,K=0}),this._linesTotal=he.length},ne.prototype._setupSpaceGlyphs=function(Q){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,Q.chars&&0!==Q.chars.length){var A=me(Q,32)||function(X){for(var he=0;he<M.length;he++){var z=M[he].charCodeAt(0),Le=W(X.chars,z);if(Le>=0)return X.chars[Le]}return 0}(Q)||Q.chars[0],R=this._opt.tabSize*A.xadvance;this._fallbackSpaceGlyph=A,this._fallbackTabGlyph=B(A,{x:0,y:0,xadvance:R,id:9,xoffset:0,yoffset:0,width:0,height:0})}},ne.prototype.getGlyph=function(Q,A){return me(Q,A)||(9===A?this._fallbackTabGlyph:32===A?this._fallbackSpaceGlyph:null)},ne.prototype.computeMetrics=function(Q,A,R,X){var he,z=this._opt.letterSpacing||0,Le=this._opt.font,K=0,be=0,Ne=0;if(!Le.chars||0===Le.chars.length)return{start:A,end:A,width:0};R=Math.min(Q.length,R);for(var je=A;je<R;je++){var Te,qe=Q.charCodeAt(je);if(Te=this.getGlyph(Le,qe)){var Ke=(K+=he?ie(Le,he.id,Te.id):0)+Te.xadvance+z,vt=K+Te.width;if(vt>=X||Ke>=X)break;K=Ke,be=vt,he=Te}Ne++}return he&&(be+=he.xoffset),{start:A,end:A+Ne,width:be}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(function(Q){Object.defineProperty(ne.prototype,Q,{get:ue(Q),configurable:!0})})},734:function(n,o){var l,x;void 0===(x="function"==typeof(l=function(){"use strict";function B(Te,qe,Ke){this.low=0|Te,this.high=0|qe,this.unsigned=!!Ke}function D(Te){return!0===(Te&&Te.__isLong__)}Object.defineProperty(B.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),B.isLong=D;var G={},M={};function P(Te,qe){var Ke,vt,ht;return qe?(ht=0<=(Te>>>=0)&&Te<256)&&(vt=M[Te])?vt:(Ke=ye(Te,(0|Te)<0?-1:0,!0),ht&&(M[Te]=Ke),Ke):(ht=-128<=(Te|=0)&&Te<128)&&(vt=G[Te])?vt:(Ke=ye(Te,Te<0?-1:0,!1),ht&&(G[Te]=Ke),Ke)}function fe(Te,qe){if(isNaN(Te)||!isFinite(Te))return qe?X:R;if(qe){if(Te<0)return X;if(Te>=W)return be}else{if(Te<=-Q)return Ne;if(Te+1>=Q)return K}return Te<0?fe(-Te,qe).neg():ye(Te%ie|0,Te/ie|0,qe)}function ye(Te,qe,Ke){return new B(Te,qe,Ke)}B.fromInt=P,B.fromNumber=fe,B.fromBits=ye;var ne=Math.pow;function ue(Te,qe,Ke){if(0===Te.length)throw Error("empty string");if("NaN"===Te||"Infinity"===Te||"+Infinity"===Te||"-Infinity"===Te)return R;if("number"==typeof qe?(Ke=qe,qe=!1):qe=!!qe,(Ke=Ke||10)<2||36<Ke)throw RangeError("radix");var vt;if((vt=Te.indexOf("-"))>0)throw Error("interior hyphen");if(0===vt)return ue(Te.substring(1),qe,Ke).neg();for(var ht=fe(ne(Ke,8)),Bt=R,wt=0;wt<Te.length;wt+=8){var Ft=Math.min(8,Te.length-wt),Ot=parseInt(Te.substring(wt,wt+Ft),Ke);if(Ft<8){var on=fe(ne(Ke,Ft));Bt=Bt.mul(on).add(fe(Ot))}else Bt=(Bt=Bt.mul(ht)).add(fe(Ot))}return Bt.unsigned=qe,Bt}function me(Te){return Te instanceof B?Te:"number"==typeof Te?fe(Te):"string"==typeof Te?ue(Te):ye(Te.low,Te.high,Te.unsigned)}B.fromString=ue,B.fromValue=me;var ie=4294967296,W=ie*ie,Q=W/2,A=P(1<<24),R=P(0);B.ZERO=R;var X=P(0,!0);B.UZERO=X;var he=P(1);B.ONE=he;var z=P(1,!0);B.UONE=z;var Le=P(-1);B.NEG_ONE=Le;var K=ye(-1,2147483647,!1);B.MAX_VALUE=K;var be=ye(-1,-1,!0);B.MAX_UNSIGNED_VALUE=be;var Ne=ye(0,-2147483648,!1);B.MIN_VALUE=Ne;var je=B.prototype;return je.toInt=function(){return this.unsigned?this.low>>>0:this.low},je.toNumber=function(){return this.unsigned?(this.high>>>0)*ie+(this.low>>>0):this.high*ie+(this.low>>>0)},je.toString=function(Te){if((Te=Te||10)<2||36<Te)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Ne)){var qe=fe(Te),Ke=this.div(qe),vt=Ke.mul(qe).sub(this);return Ke.toString(Te)+vt.toInt().toString(Te)}return"-"+this.neg().toString(Te)}for(var ht=fe(ne(Te,6),this.unsigned),Bt=this,wt="";;){var Ft=Bt.div(ht),Ot=(Bt.sub(Ft.mul(ht)).toInt()>>>0).toString(Te);if((Bt=Ft).isZero())return Ot+wt;for(;Ot.length<6;)Ot="0"+Ot;wt=""+Ot+wt}},je.getHighBits=function(){return this.high},je.getHighBitsUnsigned=function(){return this.high>>>0},je.getLowBits=function(){return this.low},je.getLowBitsUnsigned=function(){return this.low>>>0},je.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ne)?64:this.neg().getNumBitsAbs();for(var Te=0!=this.high?this.high:this.low,qe=31;qe>0&&!(Te&1<<qe);qe--);return 0!=this.high?qe+33:qe+1},je.isZero=function(){return 0===this.high&&0===this.low},je.isNegative=function(){return!this.unsigned&&this.high<0},je.isPositive=function(){return this.unsigned||this.high>=0},je.isOdd=function(){return!(1&~this.low)},je.isEven=function(){return!(1&this.low)},je.equals=function(Te){return D(Te)||(Te=me(Te)),(this.unsigned===Te.unsigned||this.high>>>31!=1||Te.high>>>31!=1)&&this.high===Te.high&&this.low===Te.low},je.eq=je.equals,je.notEquals=function(Te){return!this.eq(Te)},je.neq=je.notEquals,je.lessThan=function(Te){return this.comp(Te)<0},je.lt=je.lessThan,je.lessThanOrEqual=function(Te){return this.comp(Te)<=0},je.lte=je.lessThanOrEqual,je.greaterThan=function(Te){return this.comp(Te)>0},je.gt=je.greaterThan,je.greaterThanOrEqual=function(Te){return this.comp(Te)>=0},je.gte=je.greaterThanOrEqual,je.compare=function(Te){if(D(Te)||(Te=me(Te)),this.eq(Te))return 0;var qe=this.isNegative(),Ke=Te.isNegative();return qe&&!Ke?-1:!qe&&Ke?1:this.unsigned?Te.high>>>0>this.high>>>0||Te.high===this.high&&Te.low>>>0>this.low>>>0?-1:1:this.sub(Te).isNegative()?-1:1},je.comp=je.compare,je.negate=function(){return!this.unsigned&&this.eq(Ne)?Ne:this.not().add(he)},je.neg=je.negate,je.add=function(Te){D(Te)||(Te=me(Te));var Ot=0,on=0,ft=0,An=0;return ft+=(An+=(65535&this.low)+(65535&Te.low))>>>16,on+=(ft+=(this.low>>>16)+(Te.low>>>16))>>>16,Ot+=(on+=(65535&this.high)+(65535&Te.high))>>>16,Ot+=(this.high>>>16)+(Te.high>>>16),ye((ft&=65535)<<16|(An&=65535),(Ot&=65535)<<16|(on&=65535),this.unsigned)},je.subtract=function(Te){return D(Te)||(Te=me(Te)),this.add(Te.neg())},je.sub=je.subtract,je.multiply=function(Te){if(this.isZero()||(D(Te)||(Te=me(Te)),Te.isZero()))return R;if(this.eq(Ne))return Te.isOdd()?Ne:R;if(Te.eq(Ne))return this.isOdd()?Ne:R;if(this.isNegative())return Te.isNegative()?this.neg().mul(Te.neg()):this.neg().mul(Te).neg();if(Te.isNegative())return this.mul(Te.neg()).neg();if(this.lt(A)&&Te.lt(A))return fe(this.toNumber()*Te.toNumber(),this.unsigned);var Ke=65535&this.high,vt=this.low>>>16,ht=65535&this.low,wt=65535&Te.high,Ft=Te.low>>>16,Ot=65535&Te.low,on=0,ft=0,An=0,Cn=0;return An+=(Cn+=ht*Ot)>>>16,ft+=(An+=vt*Ot)>>>16,An&=65535,ft+=(An+=ht*Ft)>>>16,on+=(ft+=Ke*Ot)>>>16,ft&=65535,on+=(ft+=vt*Ft)>>>16,ft&=65535,on+=(ft+=ht*wt)>>>16,on+=(this.high>>>16)*Ot+Ke*Ft+vt*wt+ht*(Te.high>>>16),ye((An&=65535)<<16|(Cn&=65535),(on&=65535)<<16|(ft&=65535),this.unsigned)},je.mul=je.multiply,je.divide=function(Te){if(D(Te)||(Te=me(Te)),Te.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?X:R;var qe,Ke,vt;if(this.unsigned){if(Te.unsigned||(Te=Te.toUnsigned()),Te.gt(this))return X;if(Te.gt(this.shru(1)))return z;vt=X}else{if(this.eq(Ne))return Te.eq(he)||Te.eq(Le)?Ne:Te.eq(Ne)?he:(qe=this.shr(1).div(Te).shl(1)).eq(R)?Te.isNegative()?he:Le:(Ke=this.sub(Te.mul(qe)),vt=qe.add(Ke.div(Te)));if(Te.eq(Ne))return this.unsigned?X:R;if(this.isNegative())return Te.isNegative()?this.neg().div(Te.neg()):this.neg().div(Te).neg();if(Te.isNegative())return this.div(Te.neg()).neg();vt=R}for(Ke=this;Ke.gte(Te);){qe=Math.max(1,Math.floor(Ke.toNumber()/Te.toNumber()));for(var ht=Math.ceil(Math.log(qe)/Math.LN2),Bt=ht<=48?1:ne(2,ht-48),wt=fe(qe),Ft=wt.mul(Te);Ft.isNegative()||Ft.gt(Ke);)Ft=(wt=fe(qe-=Bt,this.unsigned)).mul(Te);wt.isZero()&&(wt=he),vt=vt.add(wt),Ke=Ke.sub(Ft)}return vt},je.div=je.divide,je.modulo=function(Te){return D(Te)||(Te=me(Te)),this.sub(this.div(Te).mul(Te))},je.mod=je.modulo,je.not=function(){return ye(~this.low,~this.high,this.unsigned)},je.and=function(Te){return D(Te)||(Te=me(Te)),ye(this.low&Te.low,this.high&Te.high,this.unsigned)},je.or=function(Te){return D(Te)||(Te=me(Te)),ye(this.low|Te.low,this.high|Te.high,this.unsigned)},je.xor=function(Te){return D(Te)||(Te=me(Te)),ye(this.low^Te.low,this.high^Te.high,this.unsigned)},je.shiftLeft=function(Te){return D(Te)&&(Te=Te.toInt()),0==(Te&=63)?this:Te<32?ye(this.low<<Te,this.high<<Te|this.low>>>32-Te,this.unsigned):ye(0,this.low<<Te-32,this.unsigned)},je.shl=je.shiftLeft,je.shiftRight=function(Te){return D(Te)&&(Te=Te.toInt()),0==(Te&=63)?this:Te<32?ye(this.low>>>Te|this.high<<32-Te,this.high>>Te,this.unsigned):ye(this.high>>Te-32,this.high>=0?0:-1,this.unsigned)},je.shr=je.shiftRight,je.shiftRightUnsigned=function(Te){if(D(Te)&&(Te=Te.toInt()),0==(Te&=63))return this;var qe=this.high;return Te<32?ye(this.low>>>Te|qe<<32-Te,qe>>>Te,this.unsigned):ye(32===Te?qe:qe>>>Te-32,0,this.unsigned)},je.shru=je.shiftRightUnsigned,je.toSigned=function(){return this.unsigned?ye(this.low,this.high,!1):this},je.toUnsigned=function(){return this.unsigned?this:ye(this.low,this.high,!0)},je.toBytes=function(Te){return Te?this.toBytesLE():this.toBytesBE()},je.toBytesLE=function(){var Te=this.high,qe=this.low;return[255&qe,qe>>>8&255,qe>>>16&255,qe>>>24&255,255&Te,Te>>>8&255,Te>>>16&255,Te>>>24&255]},je.toBytesBE=function(){var Te=this.high,qe=this.low;return[Te>>>24&255,Te>>>16&255,Te>>>8&255,255&Te,qe>>>24&255,qe>>>16&255,qe>>>8&255,255&qe]},B})?l.apply(o,[]):l)||(n.exports=x)},166:(n,o,l)=>{var x=l(690),B=l(561),D=l(809),G=[0,2,3],M=[2,1,3];n.exports=function(P,fe){P&&(B(P)||D(P))||(fe=P||{},P=null);for(var ye="string"==typeof(fe="number"==typeof fe?{count:fe}:fe||{}).type?fe.type:"uint16",ue=fe.start||0,me=!1!==fe.clockwise?G:M,ie=me[0],W=me[1],Q=me[2],A=6*("number"==typeof fe.count?fe.count:1),R=P||new(x(ye))(A),X=0,he=0;X<A;X+=6,he+=4){var z=X+ue;R[z+0]=he+0,R[z+1]=he+1,R[z+2]=he+2,R[z+3]=he+ie,R[z+4]=he+W,R[z+5]=he+Q}return R}},573:(n,o,l)=>{var x=l(412),B=l(190),D=l(87),G=l(166),M=l(991),P=l(47),fe=x.BufferGeometry;function ye(ne){fe.call(this),"string"==typeof ne&&(ne={text:ne}),this._opt=Object.assign({},ne),ne&&this.update(ne)}n.exports=function(ne){return new ye(ne)},D(ye,fe),ye.prototype.update=function(ne){if("string"==typeof ne&&(ne={text:ne}),!(ne=Object.assign({},this._opt,ne)).font)throw new TypeError("must specify a { font } in options");this.layout=B(ne);var ue=!1!==ne.flipY,me=ne.font,ie=me.common.scaleW,W=me.common.scaleH,Q=this.layout.glyphs.filter(function(z){var Le=z.data;return Le.width*Le.height>0});this.visibleGlyphs=Q;var A=M.positions(Q),R=M.uvs(Q,ie,W,ue),X=G([],{clockwise:!0,type:"uint16",count:Q.length});if(this.setIndex(X),this.setAttribute("position",new x.BufferAttribute(A,2)),this.setAttribute("uv",new x.BufferAttribute(R,2)),!ne.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(ne.multipage){var he=M.pages(Q);this.setAttribute("page",new x.BufferAttribute(he,1))}},ye.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new x.Sphere);var ne=this.attributes.position.array;if(!ne||!this.attributes.position.itemSize||ne.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);P.computeSphere(ne,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},ye.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new x.Box3);var ne=this.boundingBox,ue=this.attributes.position.array;!ue||!this.attributes.position.itemSize||ue.length<2?ne.makeEmpty():P.computeBox(ue,ne)}},47:n=>{var o={min:[0,0],max:[0,0]};function l(x){var B=x.length/2;o.min[0]=x[0],o.min[1]=x[1],o.max[0]=x[0],o.max[1]=x[1];for(var D=0;D<B;D++){var G=x[2*D+0],M=x[2*D+1];o.min[0]=Math.min(G,o.min[0]),o.min[1]=Math.min(M,o.min[1]),o.max[0]=Math.max(G,o.max[0]),o.max[1]=Math.max(M,o.max[1])}}n.exports.computeBox=function(x,B){l(x),B.min.set(o.min[0],o.min[1],0),B.max.set(o.max[0],o.max[1],0)},n.exports.computeSphere=function(x,B){l(x);var D=o.min[0],G=o.min[1],M=o.max[0]-D,P=o.max[1]-G,fe=Math.sqrt(M*M+P*P);B.center.set(D+M/2,G+P/2,0),B.radius=fe/2}},991:n=>{n.exports.pages=function(o){var l=new Float32Array(4*o.length*1),x=0;return o.forEach(function(B){var D=B.data.page||0;l[x++]=D,l[x++]=D,l[x++]=D,l[x++]=D}),l},n.exports.uvs=function(o,l,x,B){var D=new Float32Array(4*o.length*2),G=0;return o.forEach(function(M){var P=M.data,ye=P.y+P.height,ne=P.x/l,ue=P.y/x,me=(P.x+P.width)/l,ie=ye/x;B&&(ue=(x-P.y)/x,ie=(x-ye)/x),D[G++]=ne,D[G++]=ue,D[G++]=ne,D[G++]=ie,D[G++]=me,D[G++]=ie,D[G++]=me,D[G++]=ue}),D},n.exports.positions=function(o){var l=new Float32Array(4*o.length*2),x=0;return o.forEach(function(B){var D=B.data,G=B.position[0]+D.xoffset,M=B.position[1]+D.yoffset,P=D.width,fe=D.height;l[x++]=G,l[x++]=M,l[x++]=G,l[x++]=M+fe,l[x++]=G+P,l[x++]=M+fe,l[x++]=G+P,l[x++]=M}),l}},412:(n,o,l)=>{"use strict";l.r(o),l.d(o,{ACESFilmicToneMapping:()=>Qr,AddEquation:()=>Ne,AddOperation:()=>tr,AdditiveAnimationBlendMode:()=>Wu,AdditiveBlending:()=>z,AlphaFormat:()=>pp,AlwaysDepth:()=>$n,AlwaysStencilFunc:()=>aa,AmbientLight:()=>Tt,AmbientLightProbe:()=>sp,AnimationClip:()=>rs,AnimationLoader:()=>Ul,AnimationMixer:()=>_m,AnimationObjectGroup:()=>jm,AnimationUtils:()=>ho,ArcCurve:()=>r,ArrayCamera:()=>Vd,ArrowHelper:()=>lp,Audio:()=>Ld,AudioAnalyser:()=>If,AudioContext:()=>ad,AudioListener:()=>Rf,AudioLoader:()=>Up,AxesHelper:()=>yf,AxisHelper:()=>D_,BackSide:()=>W,BasicDepthPacking:()=>q,BasicShadowMap:()=>ye,BinaryTextureLoader:()=>H_,Bone:()=>Cc,BooleanKeyframeTrack:()=>Nh,BoundingBoxHelper:()=>U_,Box2:()=>Wm,Box3:()=>mn,Box3Helper:()=>Gf,BoxBufferGeometry:()=>Ku,BoxGeometry:()=>Ls,BoxHelper:()=>jp,BufferAttribute:()=>Hr,BufferGeometry:()=>pn,BufferGeometryLoader:()=>Kn,ByteType:()=>zl,Cache:()=>ta,Camera:()=>Ai,CameraHelper:()=>vf,CanvasRenderer:()=>q_,CanvasTexture:()=>$u,CatmullRomCurve3:()=>k,CineonToneMapping:()=>Nr,CircleBufferGeometry:()=>Lh,CircleGeometry:()=>rp,ClampToEdgeWrapping:()=>Yr,Clock:()=>au,ClosedSplineCurve3:()=>g_,Color:()=>or,ColorKeyframeTrack:()=>ml,CompressedTexture:()=>Au,CompressedTextureLoader:()=>Md,ConeBufferGeometry:()=>Ch,ConeGeometry:()=>Bi,CubeCamera:()=>Fo,CubeGeometry:()=>Ls,CubeReflectionMapping:()=>Ti,CubeRefractionMapping:()=>$o,CubeTexture:()=>as,CubeTextureLoader:()=>Rh,CubeUVReflectionMapping:()=>Oi,CubeUVRefractionMapping:()=>Co,CubicBezierCurve:()=>le,CubicBezierCurve3:()=>ae,CubicInterpolant:()=>fl,CullFaceBack:()=>M,CullFaceFront:()=>P,CullFaceFrontBack:()=>fe,CullFaceNone:()=>G,Curve:()=>yr,CurvePath:()=>Oe,CustomBlending:()=>be,CustomToneMapping:()=>Vr,CylinderBufferGeometry:()=>Ho,CylinderGeometry:()=>Nn,Cylindrical:()=>o_,DataTexture:()=>ul,DataTexture2DArray:()=>Va,DataTexture3D:()=>Eu,DataTextureLoader:()=>Pc,DecrementStencilOp:()=>At,DecrementWrapStencilOp:()=>dn,DefaultLoadingManager:()=>Td,DepthFormat:()=>Lo,DepthStencilFormat:()=>qs,DepthTexture:()=>Cu,DirectionalLight:()=>ut,DirectionalLightHelper:()=>tf,DirectionalLightShadow:()=>Ct,DiscreteInterpolant:()=>ea,DodecahedronBufferGeometry:()=>La,DodecahedronGeometry:()=>Xa,DoubleSide:()=>Q,DstAlphaFactor:()=>on,DstColorFactor:()=>An,DynamicBufferAttribute:()=>C_,DynamicCopyUsage:()=>la,DynamicDrawUsage:()=>Lr,DynamicReadUsage:()=>Xi,EdgesGeometry:()=>$h,EdgesHelper:()=>z_,EllipseCurve:()=>a,EqualDepth:()=>nr,EqualStencilFunc:()=>wr,EquirectangularReflectionMapping:()=>Hs,EquirectangularRefractionMapping:()=>ia,Euler:()=>at,EventDispatcher:()=>ca,ExtrudeBufferGeometry:()=>ma,ExtrudeGeometry:()=>ou,Face3:()=>ha,Face4:()=>Em,FaceColors:()=>Tm,FileLoader:()=>Dl,FlatShading:()=>A,Float32Attribute:()=>k_,Float32BufferAttribute:()=>Dn,Float64Attribute:()=>F_,Float64BufferAttribute:()=>Al,FloatType:()=>qo,Fog:()=>Yd,FogExp2:()=>uf,Font:()=>hs,FontLoader:()=>ds,FrontSide:()=>ie,Frustum:()=>Yc,GammaEncoding:()=>ql,Geometry:()=>Fr,GeometryUtils:()=>W_,GreaterDepth:()=>rr,GreaterEqualDepth:()=>lr,GreaterEqualStencilFunc:()=>Qo,GreaterStencilFunc:()=>Tr,GridHelper:()=>Uf,Group:()=>tc,HalfFloatType:()=>ms,HemisphereLight:()=>it,HemisphereLightHelper:()=>gf,HemisphereLightProbe:()=>ip,IcosahedronBufferGeometry:()=>Ps,IcosahedronGeometry:()=>kl,ImageBitmapLoader:()=>Uo,ImageLoader:()=>Za,ImageUtils:()=>eo,ImmediateRenderObject:()=>kf,IncrementStencilOp:()=>Et,IncrementWrapStencilOp:()=>Yt,InstancedBufferAttribute:()=>Jn,InstancedBufferGeometry:()=>Rn,InstancedInterleavedBuffer:()=>Hm,InstancedMesh:()=>cs,Int16Attribute:()=>R_,Int16BufferAttribute:()=>Xh,Int32Attribute:()=>I_,Int32BufferAttribute:()=>Qn,Int8Attribute:()=>L_,Int8BufferAttribute:()=>ol,IntType:()=>Hp,InterleavedBuffer:()=>Ca,InterleavedBufferAttribute:()=>wh,Interpolant:()=>ga,InterpolateDiscrete:()=>Vl,InterpolateLinear:()=>Wl,InterpolateSmooth:()=>Hu,InvertStencilOp:()=>kn,JSONLoader:()=>X_,KeepStencilOp:()=>Ve,KeyframeTrack:()=>us,LOD:()=>Qd,LatheBufferGeometry:()=>Ah,LatheGeometry:()=>np,Layers:()=>gu,LensFlare:()=>J_,LessDepth:()=>_n,LessEqualDepth:()=>ar,LessEqualStencilFunc:()=>ei,LessStencilFunc:()=>wn,Light:()=>Qe,LightProbe:()=>gn,LightShadow:()=>ct,Line:()=>Di,Line3:()=>ym,LineBasicMaterial:()=>Ir,LineCurve:()=>ge,LineCurve3:()=>we,LineDashedMaterial:()=>Fl,LineLoop:()=>Pp,LinePieces:()=>E_,LineSegments:()=>Wi,LineStrip:()=>va,LinearEncoding:()=>Ki,LinearFilter:()=>ai,LinearInterpolant:()=>su,LinearMipMapLinearFilter:()=>Gp,LinearMipMapNearestFilter:()=>Ph,LinearMipmapLinearFilter:()=>Ka,LinearMipmapNearestFilter:()=>Fc,LinearToneMapping:()=>mi,Loader:()=>hi,LoaderUtils:()=>sr,LoadingManager:()=>Dp,LogLuvEncoding:()=>Gh,LoopOnce:()=>fu,LoopPingPong:()=>dc,LoopRepeat:()=>Fa,LuminanceAlphaFormat:()=>ku,LuminanceFormat:()=>Uc,MOUSE:()=>B,Material:()=>zr,MaterialLoader:()=>fr,Math:()=>er,MathUtils:()=>er,Matrix3:()=>jo,Matrix4:()=>ni,MaxEquation:()=>Ke,Mesh:()=>Li,MeshBasicMaterial:()=>ro,MeshDepthMaterial:()=>ep,MeshDistanceMaterial:()=>$a,MeshFaceMaterial:()=>T_,MeshLambertMaterial:()=>Ao,MeshMatcapMaterial:()=>Ba,MeshNormalMaterial:()=>qi,MeshPhongMaterial:()=>Jo,MeshPhysicalMaterial:()=>uo,MeshStandardMaterial:()=>Ja,MeshToonMaterial:()=>zs,MinEquation:()=>qe,MirroredRepeatWrapping:()=>os,MixOperation:()=>pi,MultiMaterial:()=>M_,MultiplyBlending:()=>K,MultiplyOperation:()=>Zr,NearestFilter:()=>Or,NearestMipMapLinearFilter:()=>Vs,NearestMipMapNearestFilter:()=>Iu,NearestMipmapLinearFilter:()=>fs,NearestMipmapNearestFilter:()=>Oa,NeverDepth:()=>On,NeverStencilFunc:()=>nn,NoBlending:()=>X,NoColors:()=>Pa,NoToneMapping:()=>mr,NormalAnimationBlendMode:()=>Vu,NormalBlending:()=>he,NotEqualDepth:()=>ti,NotEqualStencilFunc:()=>vs,NumberKeyframeTrack:()=>po,Object3D:()=>Zn,ObjectLoader:()=>vi,ObjectSpaceNormalMap:()=>Ce,OctahedronBufferGeometry:()=>Zs,OctahedronGeometry:()=>Mh,OneFactor:()=>ht,OneMinusDstAlphaFactor:()=>ft,OneMinusDstColorFactor:()=>Cn,OneMinusSrcAlphaFactor:()=>Ot,OneMinusSrcColorFactor:()=>wt,OrthographicCamera:()=>Lt,PCFShadowMap:()=>ne,PCFSoftShadowMap:()=>ue,PMREMGenerator:()=>Sm,ParametricBufferGeometry:()=>Lc,ParametricGeometry:()=>nu,Particle:()=>Mm,ParticleBasicMaterial:()=>m_,ParticleSystem:()=>Km,ParticleSystemMaterial:()=>__,Path:()=>Fe,PerspectiveCamera:()=>Ns,Plane:()=>Xo,PlaneBufferGeometry:()=>Ll,PlaneGeometry:()=>Ha,PlaneHelper:()=>Hf,PointCloud:()=>f_,PointCloudMaterial:()=>A_,PointLight:()=>Dt,PointLightHelper:()=>_f,Points:()=>tu,PointsMaterial:()=>Pl,PolarGridHelper:()=>bm,PolyhedronBufferGeometry:()=>Ds,PolyhedronGeometry:()=>Th,PositionalAudio:()=>ff,PropertyBinding:()=>lc,PropertyMixer:()=>pm,QuadraticBezierCurve:()=>Se,QuadraticBezierCurve3:()=>$e,Quaternion:()=>So,QuaternionKeyframeTrack:()=>ah,QuaternionLinearInterpolant:()=>sc,REVISION:()=>x,RGBADepthPacking:()=>pe,RGBAFormat:()=>mo,RGBAIntegerFormat:()=>dh,RGBA_ASTC_10x10_Format:()=>nl,RGBA_ASTC_10x5_Format:()=>zu,RGBA_ASTC_10x6_Format:()=>tl,RGBA_ASTC_10x8_Format:()=>Fh,RGBA_ASTC_12x10_Format:()=>Dh,RGBA_ASTC_12x12_Format:()=>ju,RGBA_ASTC_4x4_Format:()=>Du,RGBA_ASTC_5x4_Format:()=>mp,RGBA_ASTC_5x5_Format:()=>_p,RGBA_ASTC_6x5_Format:()=>zc,RGBA_ASTC_6x6_Format:()=>uc,RGBA_ASTC_8x5_Format:()=>mh,RGBA_ASTC_8x6_Format:()=>gp,RGBA_ASTC_8x8_Format:()=>Uu,RGBA_BPTC_Format:()=>hc,RGBA_ETC2_EAC_Format:()=>Gl,RGBA_PVRTC_2BPPV1_Format:()=>jl,RGBA_PVRTC_4BPPV1_Format:()=>xl,RGBA_S3TC_DXT1_Format:()=>cc,RGBA_S3TC_DXT3_Format:()=>Oh,RGBA_S3TC_DXT5_Format:()=>fh,RGBDEncoding:()=>mu,RGBEEncoding:()=>Hc,RGBEFormat:()=>ph,RGBFormat:()=>Is,RGBIntegerFormat:()=>fp,RGBM16Encoding:()=>qu,RGBM7Encoding:()=>mc,RGB_ETC1_Format:()=>Fu,RGB_ETC2_Format:()=>gs,RGB_PVRTC_2BPPV1_Format:()=>yl,RGB_PVRTC_4BPPV1_Format:()=>kh,RGB_S3TC_DXT1_Format:()=>Ih,RGFormat:()=>pu,RGIntegerFormat:()=>dp,RawShaderMaterial:()=>_a,Ray:()=>_o,Raycaster:()=>gm,RectAreaLight:()=>Qt,RedFormat:()=>Vp,RedIntegerFormat:()=>el,ReinhardToneMapping:()=>xo,RepeatWrapping:()=>wo,ReplaceStencilOp:()=>et,ReverseSubtractEquation:()=>Te,RingBufferGeometry:()=>oc,RingGeometry:()=>Ks,SRGB8_ALPHA8_ASTC_10x10_Format:()=>xp,SRGB8_ALPHA8_ASTC_10x5_Format:()=>yp,SRGB8_ALPHA8_ASTC_10x6_Format:()=>Uh,SRGB8_ALPHA8_ASTC_10x8_Format:()=>bp,SRGB8_ALPHA8_ASTC_12x10_Format:()=>zh,SRGB8_ALPHA8_ASTC_12x12_Format:()=>Wp,SRGB8_ALPHA8_ASTC_4x4_Format:()=>pc,SRGB8_ALPHA8_ASTC_5x4_Format:()=>_h,SRGB8_ALPHA8_ASTC_5x5_Format:()=>du,SRGB8_ALPHA8_ASTC_6x5_Format:()=>jc,SRGB8_ALPHA8_ASTC_6x6_Format:()=>vp,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Gc,SRGB8_ALPHA8_ASTC_8x6_Format:()=>Gu,SRGB8_ALPHA8_ASTC_8x8_Format:()=>Hl,Scene:()=>El,SceneUtils:()=>Y_,ShaderChunk:()=>Dr,ShaderLib:()=>Ac,ShaderMaterial:()=>go,ShadowMaterial:()=>oo,Shape:()=>De,ShapeBufferGeometry:()=>Xn,ShapeGeometry:()=>Nc,ShapePath:()=>Gs,ShapeUtils:()=>oh,ShortType:()=>ka,Skeleton:()=>ef,SkeletonHelper:()=>hd,SkinnedMesh:()=>Kd,SmoothShading:()=>R,Sphere:()=>zn,SphereBufferGeometry:()=>Ru,SphereGeometry:()=>Xr,Spherical:()=>i_,SphericalHarmonics3:()=>vn,Spline:()=>e_,SplineCurve:()=>Re,SplineCurve3:()=>v_,SpotLight:()=>$t,SpotLightHelper:()=>mf,SpotLightShadow:()=>_t,Sprite:()=>Wa,SpriteMaterial:()=>_i,SrcAlphaFactor:()=>Ft,SrcAlphaSaturateFactor:()=>fn,SrcColorFactor:()=>Bt,StaticCopyUsage:()=>_c,StaticDrawUsage:()=>yi,StaticReadUsage:()=>Vi,StereoCamera:()=>ap,StreamCopyUsage:()=>il,StreamDrawUsage:()=>Da,StreamReadUsage:()=>Hh,StringKeyframeTrack:()=>lh,SubtractEquation:()=>je,SubtractiveBlending:()=>Le,TOUCH:()=>D,TangentSpaceNormalMap:()=>Ee,TetrahedronBufferGeometry:()=>ih,TetrahedronGeometry:()=>Lu,TextBufferGeometry:()=>Cr,TextGeometry:()=>vo,Texture:()=>di,TextureLoader:()=>Si,TorusBufferGeometry:()=>Ip,TorusGeometry:()=>nd,TorusKnotBufferGeometry:()=>Zi,TorusKnotGeometry:()=>Bu,Triangle:()=>Pr,TriangleFanDrawMode:()=>Sp,TriangleStripDrawMode:()=>wp,TrianglesDrawMode:()=>jh,TubeBufferGeometry:()=>dl,TubeGeometry:()=>Bc,UVMapping:()=>gi,Uint16Attribute:()=>P_,Uint16BufferAttribute:()=>Ml,Uint32Attribute:()=>O_,Uint32BufferAttribute:()=>sl,Uint8Attribute:()=>B_,Uint8BufferAttribute:()=>Ec,Uint8ClampedAttribute:()=>N_,Uint8ClampedBufferAttribute:()=>Yu,Uniform:()=>Of,UniformsLib:()=>cr,UniformsUtils:()=>ko,UnsignedByteType:()=>oa,UnsignedInt248Type:()=>Ts,UnsignedIntType:()=>Ws,UnsignedShort4444Type:()=>Ou,UnsignedShort5551Type:()=>uu,UnsignedShort565Type:()=>hu,UnsignedShortType:()=>Dc,VSMShadowMap:()=>me,Vector2:()=>Sn,Vector3:()=>ot,Vector4:()=>bi,VectorKeyframeTrack:()=>ac,Vertex:()=>$_,VertexColors:()=>d_,VideoTexture:()=>Sd,WebGL1Renderer:()=>Xd,WebGLCubeRenderTarget:()=>Cl,WebGLMultisampleRenderTarget:()=>Vh,WebGLRenderTarget:()=>ks,WebGLRenderTargetCube:()=>V_,WebGLRenderer:()=>qd,WebGLUtils:()=>tp,WireframeGeometry:()=>Ol,WireframeHelper:()=>j_,WrapAroundEnding:()=>wl,XHRLoader:()=>G_,ZeroCurvatureEnding:()=>ba,ZeroFactor:()=>vt,ZeroSlopeEnding:()=>sa,ZeroStencilOp:()=>He,sRGBEncoding:()=>rl}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");const u=Object(t);for(let m=1;m<arguments.length;m++){const g=arguments[m];if(null!=g)for(const E in g)Object.prototype.hasOwnProperty.call(g,E)&&(u[E]=g[E])}return u});const x="119",B={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},D={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},G=0,M=1,P=2,fe=3,ye=0,ne=1,ue=2,me=3,ie=0,W=1,Q=2,A=1,R=2,X=0,he=1,z=2,Le=3,K=4,be=5,Ne=100,je=101,Te=102,qe=103,Ke=104,vt=200,ht=201,Bt=202,wt=203,Ft=204,Ot=205,on=206,ft=207,An=208,Cn=209,fn=210,On=0,$n=1,_n=2,ar=3,nr=4,lr=5,rr=6,ti=7,Zr=0,pi=1,tr=2,mr=0,mi=1,xo=2,Nr=3,Qr=4,Vr=5,gi=300,Ti=301,$o=302,Hs=303,ia=304,Oi=306,Co=307,wo=1e3,Yr=1001,os=1002,Or=1003,Oa=1004,Iu=1004,fs=1005,Vs=1005,ai=1006,Fc=1007,Ph=1007,Ka=1008,Gp=1008,oa=1009,zl=1010,ka=1011,Dc=1012,Hp=1013,Ws=1014,qo=1015,ms=1016,Ou=1017,uu=1018,hu=1019,Ts=1020,pp=1021,Is=1022,mo=1023,Uc=1024,ku=1025,ph=mo,Lo=1026,qs=1027,Vp=1028,el=1029,pu=1030,dp=1031,fp=1032,dh=1033,Ih=33776,cc=33777,Oh=33778,fh=33779,kh=35840,yl=35841,xl=35842,jl=35843,Fu=36196,gs=37492,Gl=37496,Du=37808,mp=37809,_p=37810,zc=37811,uc=37812,mh=37813,gp=37814,Uu=37815,zu=37816,tl=37817,Fh=37818,nl=37819,Dh=37820,ju=37821,hc=36492,pc=37840,_h=37841,du=37842,jc=37843,vp=37844,Gc=37845,Gu=37846,Hl=37847,yp=37848,Uh=37849,bp=37850,xp=37851,zh=37852,Wp=37853,fu=2200,Fa=2201,dc=2202,Vl=2300,Wl=2301,Hu=2302,ba=2400,sa=2401,wl=2402,Vu=2500,Wu=2501,jh=0,wp=1,Sp=2,Ki=3e3,rl=3001,ql=3007,Hc=3002,Gh=3003,mc=3004,qu=3005,mu=3006,q=3200,pe=3201,Ee=0,Ce=1,He=0,Ve=7680,et=7681,Et=7682,At=7683,Yt=34055,dn=34056,kn=5386,nn=512,wn=513,wr=514,ei=515,Tr=516,vs=517,Qo=518,aa=519,yi=35044,Lr=35048,Da=35040,Vi=35045,Xi=35049,Hh=35041,_c=35046,la=35050,il=35042;function ca(){}Object.assign(ca.prototype,{addEventListener:function(t,u){void 0===this._listeners&&(this._listeners={});const m=this._listeners;void 0===m[t]&&(m[t]=[]),-1===m[t].indexOf(u)&&m[t].push(u)},hasEventListener:function(t,u){if(void 0===this._listeners)return!1;const m=this._listeners;return void 0!==m[t]&&-1!==m[t].indexOf(u)},removeEventListener:function(t,u){if(void 0===this._listeners)return;const m=this._listeners[t];if(void 0!==m){const g=m.indexOf(u);-1!==g&&m.splice(g,1)}},dispatchEvent:function(t){if(void 0===this._listeners)return;const u=this._listeners[t.type];if(void 0!==u){t.target=this;const m=u.slice(0);for(let g=0,E=m.length;g<E;g++)m[g].call(this,t)}}});const ki=[];for(let t=0;t<256;t++)ki[t]=(t<16?"0":"")+t.toString(16);let Os=1234567;const er={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,u=4294967295*Math.random()|0,m=4294967295*Math.random()|0,g=4294967295*Math.random()|0;return(ki[255&t]+ki[t>>8&255]+ki[t>>16&255]+ki[t>>24&255]+"-"+ki[255&u]+ki[u>>8&255]+"-"+ki[u>>16&15|64]+ki[u>>24&255]+"-"+ki[63&m|128]+ki[m>>8&255]+"-"+ki[m>>16&255]+ki[m>>24&255]+ki[255&g]+ki[g>>8&255]+ki[g>>16&255]+ki[g>>24&255]).toUpperCase()},clamp:function(t,u,m){return Math.max(u,Math.min(m,t))},euclideanModulo:function(t,u){return(t%u+u)%u},mapLinear:function(t,u,m,g,E){return g+(t-u)*(E-g)/(m-u)},lerp:function(t,u,m){return(1-m)*t+m*u},smoothstep:function(t,u,m){return t<=u?0:t>=m?1:(t=(t-u)/(m-u))*t*(3-2*t)},smootherstep:function(t,u,m){return t<=u?0:t>=m?1:(t=(t-u)/(m-u))*t*t*(t*(6*t-15)+10)},randInt:function(t,u){return t+Math.floor(Math.random()*(u-t+1))},randFloat:function(t,u){return t+Math.random()*(u-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(Os=t%2147483647),Os=16807*Os%2147483647,(Os-1)/2147483646},degToRad:function(t){return t*er.DEG2RAD},radToDeg:function(t){return t*er.RAD2DEG},isPowerOfTwo:function(t){return!(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,u,m,g,E){const I=Math.cos,V=Math.sin,Z=I(m/2),J=V(m/2),ee=I((u+g)/2),_e=V((u+g)/2),S=I((u-g)/2),e=V((u-g)/2),c=I((g-u)/2),p=V((g-u)/2);switch(E){case"XYX":t.set(Z*_e,J*S,J*e,Z*ee);break;case"YZY":t.set(J*e,Z*_e,J*S,Z*ee);break;case"ZXZ":t.set(J*S,J*e,Z*_e,Z*ee);break;case"XZX":t.set(Z*_e,J*p,J*c,Z*ee);break;case"YXY":t.set(J*c,Z*_e,J*p,Z*ee);break;case"ZYZ":t.set(J*p,J*c,Z*_e,Z*ee);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+E)}}};function Sn(t=0,u=0){this.x=t,this.y=u}function jo(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}let ss;Object.defineProperties(Sn.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Sn.prototype,{isVector2:!0,set:function(t,u){return this.x=t,this.y=u,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){const u=this.x,m=this.y,g=t.elements;return this.x=g[0]*u+g[3]*m+g[6],this.y=g[1]*u+g[4]*m+g[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const u=this.x-t.x,m=this.y-t.y;return u*u+m*m},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this},rotateAround:function(t,u){const m=Math.cos(u),g=Math.sin(u),E=this.x-t.x,I=this.y-t.y;return this.x=E*m-I*g+t.x,this.y=E*g+I*m+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(jo.prototype,{isMatrix3:!0,set:function(t,u,m,g,E,I,V,Z,J){const ee=this.elements;return ee[0]=t,ee[1]=g,ee[2]=V,ee[3]=u,ee[4]=E,ee[5]=Z,ee[6]=m,ee[7]=I,ee[8]=J,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){const u=this.elements,m=t.elements;return u[0]=m[0],u[1]=m[1],u[2]=m[2],u[3]=m[3],u[4]=m[4],u[5]=m[5],u[6]=m[6],u[7]=m[7],u[8]=m[8],this},extractBasis:function(t,u,m){return t.setFromMatrix3Column(this,0),u.setFromMatrix3Column(this,1),m.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){const u=t.elements;return this.set(u[0],u[4],u[8],u[1],u[5],u[9],u[2],u[6],u[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,u){const m=t.elements,g=u.elements,E=this.elements,I=m[0],V=m[3],Z=m[6],J=m[1],ee=m[4],_e=m[7],S=m[2],e=m[5],c=m[8],p=g[0],_=g[3],w=g[6],L=g[1],O=g[4],F=g[7],U=g[2],te=g[5],ce=g[8];return E[0]=I*p+V*L+Z*U,E[3]=I*_+V*O+Z*te,E[6]=I*w+V*F+Z*ce,E[1]=J*p+ee*L+_e*U,E[4]=J*_+ee*O+_e*te,E[7]=J*w+ee*F+_e*ce,E[2]=S*p+e*L+c*U,E[5]=S*_+e*O+c*te,E[8]=S*w+e*F+c*ce,this},multiplyScalar:function(t){const u=this.elements;return u[0]*=t,u[3]*=t,u[6]*=t,u[1]*=t,u[4]*=t,u[7]*=t,u[2]*=t,u[5]*=t,u[8]*=t,this},determinant:function(){const t=this.elements,u=t[0],m=t[1],g=t[2],E=t[3],I=t[4],V=t[5],Z=t[6],J=t[7],ee=t[8];return u*I*ee-u*V*J-m*E*ee+m*V*Z+g*E*J-g*I*Z},getInverse:function(t,u){void 0!==u&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const m=t.elements,g=this.elements,E=m[0],I=m[1],V=m[2],Z=m[3],J=m[4],ee=m[5],_e=m[6],S=m[7],e=m[8],c=e*J-ee*S,p=ee*_e-e*Z,_=S*Z-J*_e,w=E*c+I*p+V*_;if(0===w)return this.set(0,0,0,0,0,0,0,0,0);const L=1/w;return g[0]=c*L,g[1]=(V*S-e*I)*L,g[2]=(ee*I-V*J)*L,g[3]=p*L,g[4]=(e*E-V*_e)*L,g[5]=(V*Z-ee*E)*L,g[6]=_*L,g[7]=(I*_e-S*E)*L,g[8]=(J*E-I*Z)*L,this},transpose:function(){let t;const u=this.elements;return t=u[1],u[1]=u[3],u[3]=t,t=u[2],u[2]=u[6],u[6]=t,t=u[5],u[5]=u[7],u[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){const u=this.elements;return t[0]=u[0],t[1]=u[3],t[2]=u[6],t[3]=u[1],t[4]=u[4],t[5]=u[7],t[6]=u[2],t[7]=u[5],t[8]=u[8],this},setUvTransform:function(t,u,m,g,E,I,V){const Z=Math.cos(E),J=Math.sin(E);this.set(m*Z,m*J,-m*(Z*I+J*V)+I+t,-g*J,g*Z,-g*(-J*I+Z*V)+V+u,0,0,1)},scale:function(t,u){const m=this.elements;return m[0]*=t,m[3]*=t,m[6]*=t,m[1]*=u,m[4]*=u,m[7]*=u,this},rotate:function(t){const u=Math.cos(t),m=Math.sin(t),g=this.elements,E=g[0],I=g[3],V=g[6],Z=g[1],J=g[4],ee=g[7];return g[0]=u*E+m*Z,g[3]=u*I+m*J,g[6]=u*V+m*ee,g[1]=-m*E+u*Z,g[4]=-m*I+u*J,g[7]=-m*V+u*ee,this},translate:function(t,u){const m=this.elements;return m[0]+=t*m[2],m[3]+=t*m[5],m[6]+=t*m[8],m[1]+=u*m[2],m[4]+=u*m[5],m[7]+=u*m[8],this},equals:function(t){const u=this.elements,m=t.elements;for(let g=0;g<9;g++)if(u[g]!==m[g])return!1;return!0},fromArray:function(t,u){void 0===u&&(u=0);for(let m=0;m<9;m++)this.elements[m]=t[m+u];return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.elements;return t[u]=m[0],t[u+1]=m[1],t[u+2]=m[2],t[u+3]=m[3],t[u+4]=m[4],t[u+5]=m[5],t[u+6]=m[6],t[u+7]=m[7],t[u+8]=m[8],t}});const eo={getDataURL:function(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let u;if(t instanceof HTMLCanvasElement)u=t;else{void 0===ss&&(ss=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),ss.width=t.width,ss.height=t.height;const m=ss.getContext("2d");t instanceof ImageData?m.putImageData(t,0,0):m.drawImage(t,0,0,t.width,t.height),u=ss}return u.width>2048||u.height>2048?u.toDataURL("image/jpeg",.6):u.toDataURL("image/png")}};let Gr=0;function di(t,u,m,g,E,I,V,Z,J,ee){Object.defineProperty(this,"id",{value:Gr++}),this.uuid=er.generateUUID(),this.name="",this.image=void 0!==t?t:di.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==u?u:di.DEFAULT_MAPPING,this.wrapS=void 0!==m?m:Yr,this.wrapT=void 0!==g?g:Yr,this.magFilter=void 0!==E?E:ai,this.minFilter=void 0!==I?I:Ka,this.anisotropy=void 0!==J?J:1,this.format=void 0!==V?V:mo,this.internalFormat=null,this.type=void 0!==Z?Z:oa,this.offset=new Sn(0,0),this.repeat=new Sn(1,1),this.center=new Sn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new jo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==ee?ee:Ki,this.version=0,this.onUpdate=null}function bi(t=0,u=0,m=0,g=1){this.x=t,this.y=u,this.z=m,this.w=g}function ks(t,u,m){this.width=t,this.height=u,this.scissor=new bi(0,0,t,u),this.scissorTest=!1,this.viewport=new bi(0,0,t,u),this.texture=new di(void 0,(m=m||{}).mapping,m.wrapS,m.wrapT,m.magFilter,m.minFilter,m.format,m.type,m.anisotropy,m.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=u,this.texture.generateMipmaps=void 0!==m.generateMipmaps&&m.generateMipmaps,this.texture.minFilter=void 0!==m.minFilter?m.minFilter:ai,this.depthBuffer=void 0===m.depthBuffer||m.depthBuffer,this.stencilBuffer=void 0===m.stencilBuffer||m.stencilBuffer,this.depthTexture=void 0!==m.depthTexture?m.depthTexture:null}function Vh(t,u,m){ks.call(this,t,u,m),this.samples=4}function So(t=0,u=0,m=0,g=1){this._x=t,this._y=u,this._z=m,this._w=g}di.DEFAULT_IMAGE=void 0,di.DEFAULT_MAPPING=gi,di.prototype=Object.assign(Object.create(ca.prototype),{constructor:di,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const u=void 0===t||"string"==typeof t;if(!u&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const m={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const g=this.image;if(void 0===g.uuid&&(g.uuid=er.generateUUID()),!u&&void 0===t.images[g.uuid]){let E;if(Array.isArray(g)){E=[];for(let I=0,V=g.length;I<V;I++)E.push(eo.getDataURL(g[I]))}else E=eo.getDataURL(g);t.images[g.uuid]={uuid:g.uuid,url:E}}m.image=g.uuid}return u||(t.textures[this.uuid]=m),m},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==gi)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case wo:t.x=t.x-Math.floor(t.x);break;case Yr:t.x=t.x<0?0:1;break;case os:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case wo:t.y=t.y-Math.floor(t.y);break;case Yr:t.y=t.y<0?0:1;break;case os:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(di.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(bi.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(bi.prototype,{isVector4:!0,set:function(t,u,m,g){return this.x=t,this.y=u,this.z=m,this.w=g,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;case 3:this.w=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this.z=t.z+u.z,this.w=t.w+u.w,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this.z+=t.z*u,this.w+=t.w*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this.z=t.z-u.z,this.w=t.w-u.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){const u=this.x,m=this.y,g=this.z,E=this.w,I=t.elements;return this.x=I[0]*u+I[4]*m+I[8]*g+I[12]*E,this.y=I[1]*u+I[5]*m+I[9]*g+I[13]*E,this.z=I[2]*u+I[6]*m+I[10]*g+I[14]*E,this.w=I[3]*u+I[7]*m+I[11]*g+I[15]*E,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);const u=Math.sqrt(1-t.w*t.w);return u<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/u,this.y=t.y/u,this.z=t.z/u),this},setAxisAngleFromRotationMatrix:function(t){let u,m,g,E;const Z=t.elements,J=Z[0],ee=Z[4],_e=Z[8],S=Z[1],e=Z[5],c=Z[9],p=Z[2],_=Z[6],w=Z[10];if(Math.abs(ee-S)<.01&&Math.abs(_e-p)<.01&&Math.abs(c-_)<.01){if(Math.abs(ee+S)<.1&&Math.abs(_e+p)<.1&&Math.abs(c+_)<.1&&Math.abs(J+e+w-3)<.1)return this.set(1,0,0,0),this;u=Math.PI;const O=(J+1)/2,F=(e+1)/2,U=(w+1)/2,te=(ee+S)/4,ce=(_e+p)/4,oe=(c+_)/4;return O>F&&O>U?O<.01?(m=0,g=.707106781,E=.707106781):(m=Math.sqrt(O),g=te/m,E=ce/m):F>U?F<.01?(m=.707106781,g=0,E=.707106781):(g=Math.sqrt(F),m=te/g,E=oe/g):U<.01?(m=.707106781,g=.707106781,E=0):(E=Math.sqrt(U),m=ce/E,g=oe/E),this.set(m,g,E,u),this}let L=Math.sqrt((_-c)*(_-c)+(_e-p)*(_e-p)+(S-ee)*(S-ee));return Math.abs(L)<.001&&(L=1),this.x=(_-c)/L,this.y=(_e-p)/L,this.z=(S-ee)/L,this.w=Math.acos((J+e+w-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this.z=Math.max(t.z,Math.min(u.z,this.z)),this.w=Math.max(t.w,Math.min(u.w,this.w)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this.z=Math.max(t,Math.min(u,this.z)),this.w=Math.max(t,Math.min(u,this.w)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this.z+=(t.z-this.z)*u,this.w+=(t.w-this.w)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this.z=t.z+(u.z-t.z)*m,this.w=t.w+(u.w-t.w)*m,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this.z=t[u+2],this.w=t[u+3],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t[u+2]=this.z,t[u+3]=this.w,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this.z=t.getZ(u),this.w=t.getW(u),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),ks.prototype=Object.assign(Object.create(ca.prototype),{constructor:ks,isWebGLRenderTarget:!0,setSize:function(t,u){this.width===t&&this.height===u||(this.width=t,this.height=u,this.texture.image.width=t,this.texture.image.height=u,this.dispose()),this.viewport.set(0,0,t,u),this.scissor.set(0,0,t,u)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Vh.prototype=Object.assign(Object.create(ks.prototype),{constructor:Vh,isWebGLMultisampleRenderTarget:!0,copy:function(t){return ks.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(So,{slerp:function(t,u,m,g){return m.copy(t).slerp(u,g)},slerpFlat:function(t,u,m,g,E,I,V){let Z=m[g+0],J=m[g+1],ee=m[g+2],_e=m[g+3];const S=E[I+0],e=E[I+1],c=E[I+2],p=E[I+3];if(_e!==p||Z!==S||J!==e||ee!==c){let _=1-V,w=Z*S+J*e+ee*c+_e*p,L=w>=0?1:-1,O=1-w*w;if(O>Number.EPSILON){const U=Math.sqrt(O),te=Math.atan2(U,w*L);_=Math.sin(_*te)/U,V=Math.sin(V*te)/U}const F=V*L;if(Z=Z*_+S*F,J=J*_+e*F,ee=ee*_+c*F,_e=_e*_+p*F,_===1-V){const U=1/Math.sqrt(Z*Z+J*J+ee*ee+_e*_e);Z*=U,J*=U,ee*=U,_e*=U}}t[u]=Z,t[u+1]=J,t[u+2]=ee,t[u+3]=_e},multiplyQuaternionsFlat:function(t,u,m,g,E,I){const V=m[g],Z=m[g+1],J=m[g+2],ee=m[g+3],_e=E[I],S=E[I+1],e=E[I+2],c=E[I+3];return t[u]=V*c+ee*_e+Z*e-J*S,t[u+1]=Z*c+ee*S+J*_e-V*e,t[u+2]=J*c+ee*e+V*S-Z*_e,t[u+3]=ee*c-V*_e-Z*S-J*e,t}}),Object.defineProperties(So.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(So.prototype,{isQuaternion:!0,set:function(t,u,m,g){return this._x=t,this._y=u,this._z=m,this._w=g,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,u){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const m=t._x,g=t._y,E=t._z,I=t.order,V=Math.cos,Z=Math.sin,J=V(m/2),ee=V(g/2),_e=V(E/2),S=Z(m/2),e=Z(g/2),c=Z(E/2);switch(I){case"XYZ":this._x=S*ee*_e+J*e*c,this._y=J*e*_e-S*ee*c,this._z=J*ee*c+S*e*_e,this._w=J*ee*_e-S*e*c;break;case"YXZ":this._x=S*ee*_e+J*e*c,this._y=J*e*_e-S*ee*c,this._z=J*ee*c-S*e*_e,this._w=J*ee*_e+S*e*c;break;case"ZXY":this._x=S*ee*_e-J*e*c,this._y=J*e*_e+S*ee*c,this._z=J*ee*c+S*e*_e,this._w=J*ee*_e-S*e*c;break;case"ZYX":this._x=S*ee*_e-J*e*c,this._y=J*e*_e+S*ee*c,this._z=J*ee*c-S*e*_e,this._w=J*ee*_e+S*e*c;break;case"YZX":this._x=S*ee*_e+J*e*c,this._y=J*e*_e+S*ee*c,this._z=J*ee*c-S*e*_e,this._w=J*ee*_e-S*e*c;break;case"XZY":this._x=S*ee*_e-J*e*c,this._y=J*e*_e-S*ee*c,this._z=J*ee*c+S*e*_e,this._w=J*ee*_e+S*e*c;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+I)}return!1!==u&&this._onChangeCallback(),this},setFromAxisAngle:function(t,u){const m=u/2,g=Math.sin(m);return this._x=t.x*g,this._y=t.y*g,this._z=t.z*g,this._w=Math.cos(m),this._onChangeCallback(),this},setFromRotationMatrix:function(t){const u=t.elements,m=u[0],g=u[4],E=u[8],I=u[1],V=u[5],Z=u[9],J=u[2],ee=u[6],_e=u[10],S=m+V+_e;if(S>0){const e=.5/Math.sqrt(S+1);this._w=.25/e,this._x=(ee-Z)*e,this._y=(E-J)*e,this._z=(I-g)*e}else if(m>V&&m>_e){const e=2*Math.sqrt(1+m-V-_e);this._w=(ee-Z)/e,this._x=.25*e,this._y=(g+I)/e,this._z=(E+J)/e}else if(V>_e){const e=2*Math.sqrt(1+V-m-_e);this._w=(E-J)/e,this._x=(g+I)/e,this._y=.25*e,this._z=(Z+ee)/e}else{const e=2*Math.sqrt(1+_e-m-V);this._w=(I-g)/e,this._x=(E+J)/e,this._y=(Z+ee)/e,this._z=.25*e}return this._onChangeCallback(),this},setFromUnitVectors:function(t,u){let m=t.dot(u)+1;return m<1e-6?(m=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=m):(this._x=0,this._y=-t.z,this._z=t.y,this._w=m)):(this._x=t.y*u.z-t.z*u.y,this._y=t.z*u.x-t.x*u.z,this._z=t.x*u.y-t.y*u.x,this._w=m),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(er.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,u){const m=this.angleTo(t);if(0===m)return this;const g=Math.min(1,u/m);return this.slerp(t,g),this},identity:function(){return this.set(0,0,0,1)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,u)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,u){const m=t._x,g=t._y,E=t._z,I=t._w,V=u._x,Z=u._y,J=u._z,ee=u._w;return this._x=m*ee+I*V+g*J-E*Z,this._y=g*ee+I*Z+E*V-m*J,this._z=E*ee+I*J+m*Z-g*V,this._w=I*ee-m*V-g*Z-E*J,this._onChangeCallback(),this},slerp:function(t,u){if(0===u)return this;if(1===u)return this.copy(t);const m=this._x,g=this._y,E=this._z,I=this._w;let V=I*t._w+m*t._x+g*t._y+E*t._z;if(V<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,V=-V):this.copy(t),V>=1)return this._w=I,this._x=m,this._y=g,this._z=E,this;const Z=1-V*V;if(Z<=Number.EPSILON){const e=1-u;return this._w=e*I+u*this._w,this._x=e*m+u*this._x,this._y=e*g+u*this._y,this._z=e*E+u*this._z,this.normalize(),this._onChangeCallback(),this}const J=Math.sqrt(Z),ee=Math.atan2(J,V),_e=Math.sin((1-u)*ee)/J,S=Math.sin(u*ee)/J;return this._w=I*_e+this._w*S,this._x=m*_e+this._x*S,this._y=g*_e+this._y*S,this._z=E*_e+this._z*S,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,u){return void 0===u&&(u=0),this._x=t[u],this._y=t[u+1],this._z=t[u+2],this._w=t[u+3],this._onChangeCallback(),this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this._x,t[u+1]=this._y,t[u+2]=this._z,t[u+3]=this._w,t},fromBufferAttribute:function(t,u){return this._x=t.getX(u),this._y=t.getY(u),this._z=t.getZ(u),this._w=t.getW(u),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});const _u=new ot,Un=new So;function ot(t=0,u=0,m=0){this.x=t,this.y=u,this.z=m}Object.assign(ot.prototype,{isVector3:!0,set:function(t,u,m){return void 0===m&&(m=this.z),this.x=t,this.y=u,this.z=m,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this.z=t.z+u.z,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this.z+=t.z*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this.z=t.z-u.z,this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,u)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,u){return this.x=t.x*u.x,this.y=t.y*u.y,this.z=t.z*u.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Un.setFromEuler(t))},applyAxisAngle:function(t,u){return this.applyQuaternion(Un.setFromAxisAngle(t,u))},applyMatrix3:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements;return this.x=E[0]*u+E[3]*m+E[6]*g,this.y=E[1]*u+E[4]*m+E[7]*g,this.z=E[2]*u+E[5]*m+E[8]*g,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements,I=1/(E[3]*u+E[7]*m+E[11]*g+E[15]);return this.x=(E[0]*u+E[4]*m+E[8]*g+E[12])*I,this.y=(E[1]*u+E[5]*m+E[9]*g+E[13])*I,this.z=(E[2]*u+E[6]*m+E[10]*g+E[14])*I,this},applyQuaternion:function(t){const u=this.x,m=this.y,g=this.z,E=t.x,I=t.y,V=t.z,Z=t.w,J=Z*u+I*g-V*m,ee=Z*m+V*u-E*g,_e=Z*g+E*m-I*u,S=-E*u-I*m-V*g;return this.x=J*Z+S*-E+ee*-V-_e*-I,this.y=ee*Z+S*-I+_e*-E-J*-V,this.z=_e*Z+S*-V+J*-I-ee*-E,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements;return this.x=E[0]*u+E[4]*m+E[8]*g,this.y=E[1]*u+E[5]*m+E[9]*g,this.z=E[2]*u+E[6]*m+E[10]*g,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this.z=Math.max(t.z,Math.min(u.z,this.z)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this.z=Math.max(t,Math.min(u,this.z)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this.z+=(t.z-this.z)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this.z=t.z+(u.z-t.z)*m,this},cross:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,u)):this.crossVectors(this,t)},crossVectors:function(t,u){const m=t.x,g=t.y,E=t.z,I=u.x,V=u.y,Z=u.z;return this.x=g*Z-E*V,this.y=E*I-m*Z,this.z=m*V-g*I,this},projectOnVector:function(t){const u=t.lengthSq();if(0===u)return this.set(0,0,0);const m=t.dot(this)/u;return this.copy(t).multiplyScalar(m)},projectOnPlane:function(t){return _u.copy(this).projectOnVector(t),this.sub(_u)},reflect:function(t){return this.sub(_u.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){const u=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===u)return Math.PI/2;const m=this.dot(t)/u;return Math.acos(er.clamp(m,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const u=this.x-t.x,m=this.y-t.y,g=this.z-t.z;return u*u+m*m+g*g},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,u,m){const g=Math.sin(u)*t;return this.x=g*Math.sin(m),this.y=Math.cos(u)*t,this.z=g*Math.cos(m),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,u,m){return this.x=t*Math.sin(u),this.y=m,this.z=t*Math.cos(u),this},setFromMatrixPosition:function(t){const u=t.elements;return this.x=u[12],this.y=u[13],this.z=u[14],this},setFromMatrixScale:function(t){const u=this.setFromMatrixColumn(t,0).length(),m=this.setFromMatrixColumn(t,1).length(),g=this.setFromMatrixColumn(t,2).length();return this.x=u,this.y=m,this.z=g,this},setFromMatrixColumn:function(t,u){return this.fromArray(t.elements,4*u)},setFromMatrix3Column:function(t,u){return this.fromArray(t.elements,3*u)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this.z=t[u+2],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t[u+2]=this.z,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this.z=t.getZ(u),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});const Sl=new ot,Ms=new ni,Ep=new ot(0,0,0),As=new ot(1,1,1),vc=new ot,ji=new ot,lo=new ot;function ni(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(ni.prototype,{isMatrix4:!0,set:function(t,u,m,g,E,I,V,Z,J,ee,_e,S,e,c,p,_){const w=this.elements;return w[0]=t,w[4]=u,w[8]=m,w[12]=g,w[1]=E,w[5]=I,w[9]=V,w[13]=Z,w[2]=J,w[6]=ee,w[10]=_e,w[14]=S,w[3]=e,w[7]=c,w[11]=p,w[15]=_,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new ni).fromArray(this.elements)},copy:function(t){const u=this.elements,m=t.elements;return u[0]=m[0],u[1]=m[1],u[2]=m[2],u[3]=m[3],u[4]=m[4],u[5]=m[5],u[6]=m[6],u[7]=m[7],u[8]=m[8],u[9]=m[9],u[10]=m[10],u[11]=m[11],u[12]=m[12],u[13]=m[13],u[14]=m[14],u[15]=m[15],this},copyPosition:function(t){const u=this.elements,m=t.elements;return u[12]=m[12],u[13]=m[13],u[14]=m[14],this},extractBasis:function(t,u,m){return t.setFromMatrixColumn(this,0),u.setFromMatrixColumn(this,1),m.setFromMatrixColumn(this,2),this},makeBasis:function(t,u,m){return this.set(t.x,u.x,m.x,0,t.y,u.y,m.y,0,t.z,u.z,m.z,0,0,0,0,1),this},extractRotation:function(t){const u=this.elements,m=t.elements,g=1/Sl.setFromMatrixColumn(t,0).length(),E=1/Sl.setFromMatrixColumn(t,1).length(),I=1/Sl.setFromMatrixColumn(t,2).length();return u[0]=m[0]*g,u[1]=m[1]*g,u[2]=m[2]*g,u[3]=0,u[4]=m[4]*E,u[5]=m[5]*E,u[6]=m[6]*E,u[7]=0,u[8]=m[8]*I,u[9]=m[9]*I,u[10]=m[10]*I,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const u=this.elements,m=t.x,g=t.y,E=t.z,I=Math.cos(m),V=Math.sin(m),Z=Math.cos(g),J=Math.sin(g),ee=Math.cos(E),_e=Math.sin(E);if("XYZ"===t.order){const S=I*ee,e=I*_e,c=V*ee,p=V*_e;u[0]=Z*ee,u[4]=-Z*_e,u[8]=J,u[1]=e+c*J,u[5]=S-p*J,u[9]=-V*Z,u[2]=p-S*J,u[6]=c+e*J,u[10]=I*Z}else if("YXZ"===t.order){const S=Z*ee,e=Z*_e,c=J*ee,p=J*_e;u[0]=S+p*V,u[4]=c*V-e,u[8]=I*J,u[1]=I*_e,u[5]=I*ee,u[9]=-V,u[2]=e*V-c,u[6]=p+S*V,u[10]=I*Z}else if("ZXY"===t.order){const S=Z*ee,e=Z*_e,c=J*ee,p=J*_e;u[0]=S-p*V,u[4]=-I*_e,u[8]=c+e*V,u[1]=e+c*V,u[5]=I*ee,u[9]=p-S*V,u[2]=-I*J,u[6]=V,u[10]=I*Z}else if("ZYX"===t.order){const S=I*ee,e=I*_e,c=V*ee,p=V*_e;u[0]=Z*ee,u[4]=c*J-e,u[8]=S*J+p,u[1]=Z*_e,u[5]=p*J+S,u[9]=e*J-c,u[2]=-J,u[6]=V*Z,u[10]=I*Z}else if("YZX"===t.order){const S=I*Z,e=I*J,c=V*Z,p=V*J;u[0]=Z*ee,u[4]=p-S*_e,u[8]=c*_e+e,u[1]=_e,u[5]=I*ee,u[9]=-V*ee,u[2]=-J*ee,u[6]=e*_e+c,u[10]=S-p*_e}else if("XZY"===t.order){const S=I*Z,e=I*J,c=V*Z,p=V*J;u[0]=Z*ee,u[4]=-_e,u[8]=J*ee,u[1]=S*_e+p,u[5]=I*ee,u[9]=e*_e-c,u[2]=c*_e-e,u[6]=V*ee,u[10]=p*_e+S}return u[3]=0,u[7]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Ep,t,As)},lookAt:function(t,u,m){const g=this.elements;return lo.subVectors(t,u),0===lo.lengthSq()&&(lo.z=1),lo.normalize(),vc.crossVectors(m,lo),0===vc.lengthSq()&&(1===Math.abs(m.z)?lo.x+=1e-4:lo.z+=1e-4,lo.normalize(),vc.crossVectors(m,lo)),vc.normalize(),ji.crossVectors(lo,vc),g[0]=vc.x,g[4]=ji.x,g[8]=lo.x,g[1]=vc.y,g[5]=ji.y,g[9]=lo.y,g[2]=vc.z,g[6]=ji.z,g[10]=lo.z,this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,u)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,u){const m=t.elements,g=u.elements,E=this.elements,I=m[0],V=m[4],Z=m[8],J=m[12],ee=m[1],_e=m[5],S=m[9],e=m[13],c=m[2],p=m[6],_=m[10],w=m[14],L=m[3],O=m[7],F=m[11],U=m[15],te=g[0],ce=g[4],oe=g[8],de=g[12],ve=g[1],Me=g[5],Be=g[9],Ae=g[13],ke=g[2],Je=g[6],We=g[10],rt=g[14],nt=g[3],gt=g[7],xt=g[11],Ut=g[15];return E[0]=I*te+V*ve+Z*ke+J*nt,E[4]=I*ce+V*Me+Z*Je+J*gt,E[8]=I*oe+V*Be+Z*We+J*xt,E[12]=I*de+V*Ae+Z*rt+J*Ut,E[1]=ee*te+_e*ve+S*ke+e*nt,E[5]=ee*ce+_e*Me+S*Je+e*gt,E[9]=ee*oe+_e*Be+S*We+e*xt,E[13]=ee*de+_e*Ae+S*rt+e*Ut,E[2]=c*te+p*ve+_*ke+w*nt,E[6]=c*ce+p*Me+_*Je+w*gt,E[10]=c*oe+p*Be+_*We+w*xt,E[14]=c*de+p*Ae+_*rt+w*Ut,E[3]=L*te+O*ve+F*ke+U*nt,E[7]=L*ce+O*Me+F*Je+U*gt,E[11]=L*oe+O*Be+F*We+U*xt,E[15]=L*de+O*Ae+F*rt+U*Ut,this},multiplyScalar:function(t){const u=this.elements;return u[0]*=t,u[4]*=t,u[8]*=t,u[12]*=t,u[1]*=t,u[5]*=t,u[9]*=t,u[13]*=t,u[2]*=t,u[6]*=t,u[10]*=t,u[14]*=t,u[3]*=t,u[7]*=t,u[11]*=t,u[15]*=t,this},determinant:function(){const t=this.elements,u=t[0],m=t[4],g=t[8],E=t[12],I=t[1],V=t[5],Z=t[9],J=t[13],ee=t[2],_e=t[6],S=t[10],e=t[14];return t[3]*(+E*Z*_e-g*J*_e-E*V*S+m*J*S+g*V*e-m*Z*e)+t[7]*(+u*Z*e-u*J*S+E*I*S-g*I*e+g*J*ee-E*Z*ee)+t[11]*(+u*J*_e-u*V*e-E*I*_e+m*I*e+E*V*ee-m*J*ee)+t[15]*(-g*V*ee-u*Z*_e+u*V*S+g*I*_e-m*I*S+m*Z*ee)},transpose:function(){const t=this.elements;let u;return u=t[1],t[1]=t[4],t[4]=u,u=t[2],t[2]=t[8],t[8]=u,u=t[6],t[6]=t[9],t[9]=u,u=t[3],t[3]=t[12],t[12]=u,u=t[7],t[7]=t[13],t[13]=u,u=t[11],t[11]=t[14],t[14]=u,this},setPosition:function(t,u,m){const g=this.elements;return t.isVector3?(g[12]=t.x,g[13]=t.y,g[14]=t.z):(g[12]=t,g[13]=u,g[14]=m),this},getInverse:function(t,u){void 0!==u&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const m=this.elements,g=t.elements,E=g[0],I=g[1],V=g[2],Z=g[3],J=g[4],ee=g[5],_e=g[6],S=g[7],e=g[8],c=g[9],p=g[10],_=g[11],w=g[12],L=g[13],O=g[14],F=g[15],U=c*O*S-L*p*S+L*_e*_-ee*O*_-c*_e*F+ee*p*F,te=w*p*S-e*O*S-w*_e*_+J*O*_+e*_e*F-J*p*F,ce=e*L*S-w*c*S+w*ee*_-J*L*_-e*ee*F+J*c*F,oe=w*c*_e-e*L*_e-w*ee*p+J*L*p+e*ee*O-J*c*O,de=E*U+I*te+V*ce+Z*oe;if(0===de)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ve=1/de;return m[0]=U*ve,m[1]=(L*p*Z-c*O*Z-L*V*_+I*O*_+c*V*F-I*p*F)*ve,m[2]=(ee*O*Z-L*_e*Z+L*V*S-I*O*S-ee*V*F+I*_e*F)*ve,m[3]=(c*_e*Z-ee*p*Z-c*V*S+I*p*S+ee*V*_-I*_e*_)*ve,m[4]=te*ve,m[5]=(e*O*Z-w*p*Z+w*V*_-E*O*_-e*V*F+E*p*F)*ve,m[6]=(w*_e*Z-J*O*Z-w*V*S+E*O*S+J*V*F-E*_e*F)*ve,m[7]=(J*p*Z-e*_e*Z+e*V*S-E*p*S-J*V*_+E*_e*_)*ve,m[8]=ce*ve,m[9]=(w*c*Z-e*L*Z-w*I*_+E*L*_+e*I*F-E*c*F)*ve,m[10]=(J*L*Z-w*ee*Z+w*I*S-E*L*S-J*I*F+E*ee*F)*ve,m[11]=(e*ee*Z-J*c*Z-e*I*S+E*c*S+J*I*_-E*ee*_)*ve,m[12]=oe*ve,m[13]=(e*L*V-w*c*V+w*I*p-E*L*p-e*I*O+E*c*O)*ve,m[14]=(w*ee*V-J*L*V-w*I*_e+E*L*_e+J*I*O-E*ee*O)*ve,m[15]=(J*c*V-e*ee*V+e*I*_e-E*c*_e-J*I*p+E*ee*p)*ve,this},scale:function(t){const u=this.elements,m=t.x,g=t.y,E=t.z;return u[0]*=m,u[4]*=g,u[8]*=E,u[1]*=m,u[5]*=g,u[9]*=E,u[2]*=m,u[6]*=g,u[10]*=E,u[3]*=m,u[7]*=g,u[11]*=E,this},getMaxScaleOnAxis:function(){const t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,u,m){return this.set(1,0,0,t,0,1,0,u,0,0,1,m,0,0,0,1),this},makeRotationX:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(1,0,0,0,0,u,-m,0,0,m,u,0,0,0,0,1),this},makeRotationY:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(u,0,m,0,0,1,0,0,-m,0,u,0,0,0,0,1),this},makeRotationZ:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(u,-m,0,0,m,u,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,u){const m=Math.cos(u),g=Math.sin(u),E=1-m,I=t.x,V=t.y,Z=t.z,J=E*I,ee=E*V;return this.set(J*I+m,J*V-g*Z,J*Z+g*V,0,J*V+g*Z,ee*V+m,ee*Z-g*I,0,J*Z-g*V,ee*Z+g*I,E*Z*Z+m,0,0,0,0,1),this},makeScale:function(t,u,m){return this.set(t,0,0,0,0,u,0,0,0,0,m,0,0,0,0,1),this},makeShear:function(t,u,m){return this.set(1,u,m,0,t,1,m,0,t,u,1,0,0,0,0,1),this},compose:function(t,u,m){const g=this.elements,E=u._x,I=u._y,V=u._z,Z=u._w,J=E+E,ee=I+I,_e=V+V,S=E*J,e=E*ee,c=E*_e,p=I*ee,_=I*_e,w=V*_e,L=Z*J,O=Z*ee,F=Z*_e,U=m.x,te=m.y,ce=m.z;return g[0]=(1-(p+w))*U,g[1]=(e+F)*U,g[2]=(c-O)*U,g[3]=0,g[4]=(e-F)*te,g[5]=(1-(S+w))*te,g[6]=(_+L)*te,g[7]=0,g[8]=(c+O)*ce,g[9]=(_-L)*ce,g[10]=(1-(S+p))*ce,g[11]=0,g[12]=t.x,g[13]=t.y,g[14]=t.z,g[15]=1,this},decompose:function(t,u,m){const g=this.elements;let E=Sl.set(g[0],g[1],g[2]).length(),I=Sl.set(g[4],g[5],g[6]).length(),V=Sl.set(g[8],g[9],g[10]).length();this.determinant()<0&&(E=-E),t.x=g[12],t.y=g[13],t.z=g[14],Ms.copy(this);const Z=1/E,J=1/I,ee=1/V;return Ms.elements[0]*=Z,Ms.elements[1]*=Z,Ms.elements[2]*=Z,Ms.elements[4]*=J,Ms.elements[5]*=J,Ms.elements[6]*=J,Ms.elements[8]*=ee,Ms.elements[9]*=ee,Ms.elements[10]*=ee,u.setFromRotationMatrix(Ms),m.x=E,m.y=I,m.z=V,this},makePerspective:function(t,u,m,g,E,I){void 0===I&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const V=this.elements,J=2*E/(m-g),ee=(u+t)/(u-t),_e=(m+g)/(m-g),S=-(I+E)/(I-E),e=-2*I*E/(I-E);return V[0]=2*E/(u-t),V[4]=0,V[8]=ee,V[12]=0,V[1]=0,V[5]=J,V[9]=_e,V[13]=0,V[2]=0,V[6]=0,V[10]=S,V[14]=e,V[3]=0,V[7]=0,V[11]=-1,V[15]=0,this},makeOrthographic:function(t,u,m,g,E,I){const V=this.elements,Z=1/(u-t),J=1/(m-g),ee=1/(I-E),_e=(u+t)*Z,S=(m+g)*J,e=(I+E)*ee;return V[0]=2*Z,V[4]=0,V[8]=0,V[12]=-_e,V[1]=0,V[5]=2*J,V[9]=0,V[13]=-S,V[2]=0,V[6]=0,V[10]=-2*ee,V[14]=-e,V[3]=0,V[7]=0,V[11]=0,V[15]=1,this},equals:function(t){const u=this.elements,m=t.elements;for(let g=0;g<16;g++)if(u[g]!==m[g])return!1;return!0},fromArray:function(t,u){void 0===u&&(u=0);for(let m=0;m<16;m++)this.elements[m]=t[m+u];return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.elements;return t[u]=m[0],t[u+1]=m[1],t[u+2]=m[2],t[u+3]=m[3],t[u+4]=m[4],t[u+5]=m[5],t[u+6]=m[6],t[u+7]=m[7],t[u+8]=m[8],t[u+9]=m[9],t[u+10]=m[10],t[u+11]=m[11],t[u+12]=m[12],t[u+13]=m[13],t[u+14]=m[14],t[u+15]=m[15],t}});const Vc=new ni,Ci=new So;function at(t=0,u=0,m=0,g=at.DefaultOrder){this._x=t,this._y=u,this._z=m,this._order=g}function gu(){this.mask=1}at.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],at.DefaultOrder="XYZ",Object.defineProperties(at.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(at.prototype,{isEuler:!0,set:function(t,u,m,g){return this._x=t,this._y=u,this._z=m,this._order=g||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,u,m){const g=er.clamp,E=t.elements,I=E[0],V=E[4],Z=E[8],J=E[1],ee=E[5],_e=E[9],S=E[2],e=E[6],c=E[10];switch(u=u||this._order){case"XYZ":this._y=Math.asin(g(Z,-1,1)),Math.abs(Z)<.9999999?(this._x=Math.atan2(-_e,c),this._z=Math.atan2(-V,I)):(this._x=Math.atan2(e,ee),this._z=0);break;case"YXZ":this._x=Math.asin(-g(_e,-1,1)),Math.abs(_e)<.9999999?(this._y=Math.atan2(Z,c),this._z=Math.atan2(J,ee)):(this._y=Math.atan2(-S,I),this._z=0);break;case"ZXY":this._x=Math.asin(g(e,-1,1)),Math.abs(e)<.9999999?(this._y=Math.atan2(-S,c),this._z=Math.atan2(-V,ee)):(this._y=0,this._z=Math.atan2(J,I));break;case"ZYX":this._y=Math.asin(-g(S,-1,1)),Math.abs(S)<.9999999?(this._x=Math.atan2(e,c),this._z=Math.atan2(J,I)):(this._x=0,this._z=Math.atan2(-V,ee));break;case"YZX":this._z=Math.asin(g(J,-1,1)),Math.abs(J)<.9999999?(this._x=Math.atan2(-_e,ee),this._y=Math.atan2(-S,I)):(this._x=0,this._y=Math.atan2(Z,c));break;case"XZY":this._z=Math.asin(-g(V,-1,1)),Math.abs(V)<.9999999?(this._x=Math.atan2(e,ee),this._y=Math.atan2(Z,I)):(this._x=Math.atan2(-_e,c),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+u)}return this._order=u,!1!==m&&this._onChangeCallback(),this},setFromQuaternion:function(t,u,m){return Vc.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Vc,u,m)},setFromVector3:function(t,u){return this.set(t.x,t.y,t.z,u||this._order)},reorder:function(t){return Ci.setFromEuler(this),this.setFromQuaternion(Ci,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this._x,t[u+1]=this._y,t[u+2]=this._z,t[u+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new ot(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(gu.prototype,{set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},disableAll:function(){this.mask=0},test:function(t){return!!(this.mask&t.mask)}});let Tp=0;const Gi=new ot,kr=new So,Wr=new ni,Ua=new ot,Eo=new ot,ua=new ot,vu=new So,yc=new ot(1,0,0),Wc=new ot(0,1,0),yu=new ot(0,0,1),gh={type:"added"},bc={type:"removed"};function Zn(){Object.defineProperty(this,"id",{value:Tp++}),this.uuid=er.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zn.DefaultUp.clone();const t=new ot,u=new at,m=new So,g=new ot(1,1,1);u._onChange(function(){m.setFromEuler(u,!1)}),m._onChange(function(){u.setFromQuaternion(m,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:u},quaternion:{configurable:!0,enumerable:!0,value:m},scale:{configurable:!0,enumerable:!0,value:g},modelViewMatrix:{value:new ni},normalMatrix:{value:new jo}}),this.matrix=new ni,this.matrixWorld=new ni,this.matrixAutoUpdate=Zn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new gu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function El(){Zn.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Zn.DefaultUp=new ot(0,1,0),Zn.DefaultMatrixAutoUpdate=!0,Zn.prototype=Object.assign(Object.create(ca.prototype),{constructor:Zn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,u){this.quaternion.setFromAxisAngle(t,u)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,u){return kr.setFromAxisAngle(t,u),this.quaternion.multiply(kr),this},rotateOnWorldAxis:function(t,u){return kr.setFromAxisAngle(t,u),this.quaternion.premultiply(kr),this},rotateX:function(t){return this.rotateOnAxis(yc,t)},rotateY:function(t){return this.rotateOnAxis(Wc,t)},rotateZ:function(t){return this.rotateOnAxis(yu,t)},translateOnAxis:function(t,u){return Gi.copy(t).applyQuaternion(this.quaternion),this.position.add(Gi.multiplyScalar(u)),this},translateX:function(t){return this.translateOnAxis(yc,t)},translateY:function(t){return this.translateOnAxis(Wc,t)},translateZ:function(t){return this.translateOnAxis(yu,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Wr.getInverse(this.matrixWorld))},lookAt:function(t,u,m){t.isVector3?Ua.copy(t):Ua.set(t,u,m);const g=this.parent;this.updateWorldMatrix(!0,!1),Eo.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Wr.lookAt(Eo,Ua,this.up):Wr.lookAt(Ua,Eo,this.up),this.quaternion.setFromRotationMatrix(Wr),g&&(Wr.extractRotation(g.matrixWorld),kr.setFromRotationMatrix(Wr),this.quaternion.premultiply(kr.inverse()))},add:function(t){if(arguments.length>1){for(let u=0;u<arguments.length;u++)this.add(arguments[u]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(gh)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(let m=0;m<arguments.length;m++)this.remove(arguments[m]);return this}const u=this.children.indexOf(t);return-1!==u&&(t.parent=null,this.children.splice(u,1),t.dispatchEvent(bc)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),Wr.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Wr.multiply(t.parent.matrixWorld)),t.applyMatrix4(Wr),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,u){if(this[t]===u)return this;for(let m=0,g=this.children.length;m<g;m++){const E=this.children[m].getObjectByProperty(t,u);if(void 0!==E)return E}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new ot),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new So),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Eo,t,ua),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new ot),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Eo,vu,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new ot),this.updateMatrixWorld(!0);const u=this.matrixWorld.elements;return t.set(u[8],u[9],u[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].traverse(t)},traverseVisible:function(t){if(!1===this.visible)return;t(this);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].traverseVisible(t)},traverseAncestors:function(t){const u=this.parent;null!==u&&(t(u),u.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].updateMatrixWorld(t)},updateWorldMatrix:function(t,u){const m=this.parent;if(!0===t&&null!==m&&m.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===u){const g=this.children;for(let E=0,I=g.length;E<I;E++)g[E].updateWorldMatrix(!1,!0)}},toJSON:function(t){const u=void 0===t||"string"==typeof t,m={};u&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},m.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const g={};function E(V,Z){return void 0===V[Z.uuid]&&(V[Z.uuid]=Z.toJSON(t)),Z.uuid}if(g.uuid=this.uuid,g.type=this.type,""!==this.name&&(g.name=this.name),!0===this.castShadow&&(g.castShadow=!0),!0===this.receiveShadow&&(g.receiveShadow=!0),!1===this.visible&&(g.visible=!1),!1===this.frustumCulled&&(g.frustumCulled=!1),0!==this.renderOrder&&(g.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(g.userData=this.userData),g.layers=this.layers.mask,g.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(g.matrixAutoUpdate=!1),this.isInstancedMesh&&(g.type="InstancedMesh",g.count=this.count,g.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){g.geometry=E(t.geometries,this.geometry);const V=this.geometry.parameters;if(void 0!==V&&void 0!==V.shapes){const Z=V.shapes;if(Array.isArray(Z))for(let J=0,ee=Z.length;J<ee;J++)E(t.shapes,Z[J]);else E(t.shapes,Z)}}if(void 0!==this.material)if(Array.isArray(this.material)){const V=[];for(let Z=0,J=this.material.length;Z<J;Z++)V.push(E(t.materials,this.material[Z]));g.material=V}else g.material=E(t.materials,this.material);if(this.children.length>0){g.children=[];for(let V=0;V<this.children.length;V++)g.children.push(this.children[V].toJSON(t).object)}if(u){const V=I(t.geometries),Z=I(t.materials),J=I(t.textures),ee=I(t.images),_e=I(t.shapes);V.length>0&&(m.geometries=V),Z.length>0&&(m.materials=Z),J.length>0&&(m.textures=J),ee.length>0&&(m.images=ee),_e.length>0&&(m.shapes=_e)}return m.object=g,m;function I(V){const Z=[];for(const J in V){const ee=V[J];delete ee.metadata,Z.push(ee)}return Z}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,u){if(void 0===u&&(u=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===u)for(let m=0;m<t.children.length;m++)this.add(t.children[m].clone());return this}}),El.prototype=Object.assign(Object.create(Zn.prototype),{constructor:El,isScene:!0,copy:function(t,u){return Zn.prototype.copy.call(this,t,u),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){const u=Zn.prototype.toJSON.call(this,t);return null!==this.background&&(u.object.background=this.background.toJSON(t)),null!==this.environment&&(u.object.environment=this.environment.toJSON(t)),null!==this.fog&&(u.object.fog=this.fog.toJSON()),u},dispose:function(){this.dispatchEvent({type:"dispose"})}});const za=[new ot,new ot,new ot,new ot,new ot,new ot,new ot,new ot],xa=new ot,Xl=new mn,bu=new ot,wa=new ot,To=new ot,Fs=new ot,xc=new ot,tt=new ot,bt=new ot,kt=new ot,yn=new ot,Xt=new ot;function mn(t,u){this.min=void 0!==t?t:new ot(1/0,1/0,1/0),this.max=void 0!==u?u:new ot(-1/0,-1/0,-1/0)}function Kt(t,u,m,g,E){for(let I=0,V=t.length-3;I<=V;I+=3){Xt.fromArray(t,I);const Z=E.x*Math.abs(Xt.x)+E.y*Math.abs(Xt.y)+E.z*Math.abs(Xt.z),J=u.dot(Xt),ee=m.dot(Xt),_e=g.dot(Xt);if(Math.max(-Math.max(J,ee,_e),Math.min(J,ee,_e))>Z)return!1}return!0}Object.assign(mn.prototype,{isBox3:!0,set:function(t,u){return this.min.copy(t),this.max.copy(u),this},setFromArray:function(t){let u=1/0,m=1/0,g=1/0,E=-1/0,I=-1/0,V=-1/0;for(let Z=0,J=t.length;Z<J;Z+=3){const ee=t[Z],_e=t[Z+1],S=t[Z+2];ee<u&&(u=ee),_e<m&&(m=_e),S<g&&(g=S),ee>E&&(E=ee),_e>I&&(I=_e),S>V&&(V=S)}return this.min.set(u,m,g),this.max.set(E,I,V),this},setFromBufferAttribute:function(t){let u=1/0,m=1/0,g=1/0,E=-1/0,I=-1/0,V=-1/0;for(let Z=0,J=t.count;Z<J;Z++){const ee=t.getX(Z),_e=t.getY(Z),S=t.getZ(Z);ee<u&&(u=ee),_e<m&&(m=_e),S<g&&(g=S),ee>E&&(E=ee),_e>I&&(I=_e),S>V&&(V=S)}return this.min.set(u,m,g),this.max.set(E,I,V),this},setFromPoints:function(t){this.makeEmpty();for(let u=0,m=t.length;u<m;u++)this.expandByPoint(t[u]);return this},setFromCenterAndSize:function(t,u){const m=xa.copy(u).multiplyScalar(.5);return this.min.copy(t).sub(m),this.max.copy(t).add(m),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new ot),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new ot),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);const u=t.geometry;void 0!==u&&(null===u.boundingBox&&u.computeBoundingBox(),Xl.copy(u.boundingBox),Xl.applyMatrix4(t.matrixWorld),this.union(Xl));const m=t.children;for(let g=0,E=m.length;g<E;g++)this.expandByObject(m[g]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,u){return void 0===u&&(console.warn("THREE.Box3: .getParameter() target is now required"),u=new ot),u.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,xa),xa.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){let u,m;return t.normal.x>0?(u=t.normal.x*this.min.x,m=t.normal.x*this.max.x):(u=t.normal.x*this.max.x,m=t.normal.x*this.min.x),t.normal.y>0?(u+=t.normal.y*this.min.y,m+=t.normal.y*this.max.y):(u+=t.normal.y*this.max.y,m+=t.normal.y*this.min.y),t.normal.z>0?(u+=t.normal.z*this.min.z,m+=t.normal.z*this.max.z):(u+=t.normal.z*this.max.z,m+=t.normal.z*this.min.z),u<=-t.constant&&m>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(bt),kt.subVectors(this.max,bt),bu.subVectors(t.a,bt),wa.subVectors(t.b,bt),To.subVectors(t.c,bt),Fs.subVectors(wa,bu),xc.subVectors(To,wa),tt.subVectors(bu,To);let u=[0,-Fs.z,Fs.y,0,-xc.z,xc.y,0,-tt.z,tt.y,Fs.z,0,-Fs.x,xc.z,0,-xc.x,tt.z,0,-tt.x,-Fs.y,Fs.x,0,-xc.y,xc.x,0,-tt.y,tt.x,0];return!!Kt(u,bu,wa,To,kt)&&(u=[1,0,0,0,1,0,0,0,1],!!Kt(u,bu,wa,To,kt)&&(yn.crossVectors(Fs,xc),u=[yn.x,yn.y,yn.z],Kt(u,bu,wa,To,kt)))},clampPoint:function(t,u){return void 0===u&&(console.warn("THREE.Box3: .clampPoint() target is now required"),u=new ot),u.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return xa.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(xa).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(za[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),za[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),za[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),za[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),za[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),za[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),za[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),za[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(za)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const qn=new mn;function zn(t,u){this.center=void 0!==t?t:new ot,this.radius=void 0!==u?u:-1}Object.assign(zn.prototype,{set:function(t,u){return this.center.copy(t),this.radius=u,this},setFromPoints:function(t,u){const m=this.center;void 0!==u?m.copy(u):qn.setFromPoints(t).getCenter(m);let g=0;for(let E=0,I=t.length;E<I;E++)g=Math.max(g,m.distanceToSquared(t[E]));return this.radius=Math.sqrt(g),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){const u=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=u*u},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,u){const m=this.center.distanceToSquared(t);return void 0===u&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),u=new ot),u.copy(t),m>this.radius*this.radius&&(u.sub(this.center).normalize(),u.multiplyScalar(this.radius).add(this.center)),u},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new mn),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});const xr=new ot,Mr=new ot,_r=new ot,qr=new ot,fi=new ot,Rr=new ot,Ko=new ot;function _o(t,u){this.origin=void 0!==t?t:new ot,this.direction=void 0!==u?u:new ot(0,0,-1)}Object.assign(_o.prototype,{set:function(t,u){return this.origin.copy(t),this.direction.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,u){return void 0===u&&(console.warn("THREE.Ray: .at() target is now required"),u=new ot),u.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,xr)),this},closestPointToPoint:function(t,u){void 0===u&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),u=new ot),u.subVectors(t,this.origin);const m=u.dot(this.direction);return m<0?u.copy(this.origin):u.copy(this.direction).multiplyScalar(m).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){const u=xr.subVectors(t,this.origin).dot(this.direction);return u<0?this.origin.distanceToSquared(t):(xr.copy(this.direction).multiplyScalar(u).add(this.origin),xr.distanceToSquared(t))},distanceSqToSegment:function(t,u,m,g){Mr.copy(t).add(u).multiplyScalar(.5),_r.copy(u).sub(t).normalize(),qr.copy(this.origin).sub(Mr);const E=.5*t.distanceTo(u),I=-this.direction.dot(_r),V=qr.dot(this.direction),Z=-qr.dot(_r),J=qr.lengthSq(),ee=Math.abs(1-I*I);let _e,S,e,c;if(ee>0)if(_e=I*Z-V,S=I*V-Z,c=E*ee,_e>=0)if(S>=-c)if(S<=c){const p=1/ee;_e*=p,S*=p,e=_e*(_e+I*S+2*V)+S*(I*_e+S+2*Z)+J}else S=E,_e=Math.max(0,-(I*S+V)),e=-_e*_e+S*(S+2*Z)+J;else S=-E,_e=Math.max(0,-(I*S+V)),e=-_e*_e+S*(S+2*Z)+J;else S<=-c?(_e=Math.max(0,-(-I*E+V)),S=_e>0?-E:Math.min(Math.max(-E,-Z),E),e=-_e*_e+S*(S+2*Z)+J):S<=c?(_e=0,S=Math.min(Math.max(-E,-Z),E),e=S*(S+2*Z)+J):(_e=Math.max(0,-(I*E+V)),S=_e>0?E:Math.min(Math.max(-E,-Z),E),e=-_e*_e+S*(S+2*Z)+J);else S=I>0?-E:E,_e=Math.max(0,-(I*S+V)),e=-_e*_e+S*(S+2*Z)+J;return m&&m.copy(this.direction).multiplyScalar(_e).add(this.origin),g&&g.copy(_r).multiplyScalar(S).add(Mr),e},intersectSphere:function(t,u){xr.subVectors(t.center,this.origin);const m=xr.dot(this.direction),g=xr.dot(xr)-m*m,E=t.radius*t.radius;if(g>E)return null;const I=Math.sqrt(E-g),V=m-I,Z=m+I;return V<0&&Z<0?null:this.at(V<0?Z:V,u)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){const u=t.normal.dot(this.direction);if(0===u)return 0===t.distanceToPoint(this.origin)?0:null;const m=-(this.origin.dot(t.normal)+t.constant)/u;return m>=0?m:null},intersectPlane:function(t,u){const m=this.distanceToPlane(t);return null===m?null:this.at(m,u)},intersectsPlane:function(t){const u=t.distanceToPoint(this.origin);return 0===u||t.normal.dot(this.direction)*u<0},intersectBox:function(t,u){let m,g,E,I,V,Z;const J=1/this.direction.x,ee=1/this.direction.y,_e=1/this.direction.z,S=this.origin;return J>=0?(m=(t.min.x-S.x)*J,g=(t.max.x-S.x)*J):(m=(t.max.x-S.x)*J,g=(t.min.x-S.x)*J),ee>=0?(E=(t.min.y-S.y)*ee,I=(t.max.y-S.y)*ee):(E=(t.max.y-S.y)*ee,I=(t.min.y-S.y)*ee),m>I||E>g?null:((E>m||m!=m)&&(m=E),(I<g||g!=g)&&(g=I),_e>=0?(V=(t.min.z-S.z)*_e,Z=(t.max.z-S.z)*_e):(V=(t.max.z-S.z)*_e,Z=(t.min.z-S.z)*_e),m>Z||V>g?null:((V>m||m!=m)&&(m=V),(Z<g||g!=g)&&(g=Z),g<0?null:this.at(m>=0?m:g,u)))},intersectsBox:function(t){return null!==this.intersectBox(t,xr)},intersectTriangle:function(t,u,m,g,E){fi.subVectors(u,t),Rr.subVectors(m,t),Ko.crossVectors(fi,Rr);let I,V=this.direction.dot(Ko);if(V>0){if(g)return null;I=1}else{if(!(V<0))return null;I=-1,V=-V}qr.subVectors(this.origin,t);const Z=I*this.direction.dot(Rr.crossVectors(qr,Rr));if(Z<0)return null;const J=I*this.direction.dot(fi.cross(qr));if(J<0||Z+J>V)return null;const ee=-I*qr.dot(Ko);return ee<0?null:this.at(ee/V,E)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});const Xs=new ot,Io=new ot,Yl=new jo;function Xo(t,u){this.normal=void 0!==t?t:new ot(1,0,0),this.constant=void 0!==u?u:0}Object.assign(Xo.prototype,{isPlane:!0,set:function(t,u){return this.normal.copy(t),this.constant=u,this},setComponents:function(t,u,m,g){return this.normal.set(t,u,m),this.constant=g,this},setFromNormalAndCoplanarPoint:function(t,u){return this.normal.copy(t),this.constant=-u.dot(this.normal),this},setFromCoplanarPoints:function(t,u,m){const g=Xs.subVectors(m,u).cross(Io.subVectors(t,u)).normalize();return this.setFromNormalAndCoplanarPoint(g,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,u){return void 0===u&&(console.warn("THREE.Plane: .projectPoint() target is now required"),u=new ot),u.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,u){void 0===u&&(console.warn("THREE.Plane: .intersectLine() target is now required"),u=new ot);const m=t.delta(Xs),g=this.normal.dot(m);if(0===g)return 0===this.distanceToPoint(t.start)?u.copy(t.start):void 0;const E=-(t.start.dot(this.normal)+this.constant)/g;return E<0||E>1?void 0:u.copy(m).multiplyScalar(E).add(t.start)},intersectsLine:function(t){const u=this.distanceToPoint(t.start),m=this.distanceToPoint(t.end);return u<0&&m>0||m<0&&u>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new ot),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,u){const m=u||Yl.getNormalMatrix(t),g=this.coplanarPoint(Xs).applyMatrix4(t),E=this.normal.applyMatrix3(m).normalize();return this.constant=-g.dot(E),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});const Yi=new ot,wc=new ot,Wh=new ot,Xu=new ot,Mp=new ot,vh=new ot,_d=new ot,yh=new ot,Fd=new ot,gd=new ot;function Pr(t,u,m){this.a=void 0!==t?t:new ot,this.b=void 0!==u?u:new ot,this.c=void 0!==m?m:new ot}Object.assign(Pr,{getNormal:function(t,u,m,g){void 0===g&&(console.warn("THREE.Triangle: .getNormal() target is now required"),g=new ot),g.subVectors(m,u),Yi.subVectors(t,u),g.cross(Yi);const E=g.lengthSq();return E>0?g.multiplyScalar(1/Math.sqrt(E)):g.set(0,0,0)},getBarycoord:function(t,u,m,g,E){Yi.subVectors(g,u),wc.subVectors(m,u),Wh.subVectors(t,u);const I=Yi.dot(Yi),V=Yi.dot(wc),Z=Yi.dot(Wh),J=wc.dot(wc),ee=wc.dot(Wh),_e=I*J-V*V;if(void 0===E&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),E=new ot),0===_e)return E.set(-2,-1,-1);const S=1/_e,e=(J*Z-V*ee)*S,c=(I*ee-V*Z)*S;return E.set(1-e-c,c,e)},containsPoint:function(t,u,m,g){return Pr.getBarycoord(t,u,m,g,Xu),Xu.x>=0&&Xu.y>=0&&Xu.x+Xu.y<=1},getUV:function(t,u,m,g,E,I,V,Z){return this.getBarycoord(t,u,m,g,Xu),Z.set(0,0),Z.addScaledVector(E,Xu.x),Z.addScaledVector(I,Xu.y),Z.addScaledVector(V,Xu.z),Z},isFrontFacing:function(t,u,m,g){return Yi.subVectors(m,u),wc.subVectors(t,u),Yi.cross(wc).dot(g)<0}}),Object.assign(Pr.prototype,{set:function(t,u,m){return this.a.copy(t),this.b.copy(u),this.c.copy(m),this},setFromPointsAndIndices:function(t,u,m,g){return this.a.copy(t[u]),this.b.copy(t[m]),this.c.copy(t[g]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Yi.subVectors(this.c,this.b),wc.subVectors(this.a,this.b),.5*Yi.cross(wc).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new ot),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)},getNormal:function(t){return Pr.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Xo),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,u){return Pr.getBarycoord(t,this.a,this.b,this.c,u)},getUV:function(t,u,m,g,E){return Pr.getUV(t,this.a,this.b,this.c,u,m,g,E)},containsPoint:function(t){return Pr.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Pr.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,u){void 0===u&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),u=new ot);const m=this.a,g=this.b,E=this.c;let I,V;Mp.subVectors(g,m),vh.subVectors(E,m),yh.subVectors(t,m);const Z=Mp.dot(yh),J=vh.dot(yh);if(Z<=0&&J<=0)return u.copy(m);Fd.subVectors(t,g);const ee=Mp.dot(Fd),_e=vh.dot(Fd);if(ee>=0&&_e<=ee)return u.copy(g);const S=Z*_e-ee*J;if(S<=0&&Z>=0&&ee<=0)return I=Z/(Z-ee),u.copy(m).addScaledVector(Mp,I);gd.subVectors(t,E);const e=Mp.dot(gd),c=vh.dot(gd);if(c>=0&&e<=c)return u.copy(E);const p=e*J-Z*c;if(p<=0&&J>=0&&c<=0)return V=J/(J-c),u.copy(m).addScaledVector(vh,V);const _=ee*c-e*_e;if(_<=0&&_e-ee>=0&&e-c>=0)return _d.subVectors(E,g),V=(_e-ee)/(_e-ee+(e-c)),u.copy(g).addScaledVector(_d,V);const w=1/(_+p+S);return I=p*w,V=S*w,u.copy(m).addScaledVector(Mp,I).addScaledVector(vh,V)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});const Sc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ys={h:0,s:0,l:0},Ap={h:0,s:0,l:0};function or(t,u,m){return void 0===u&&void 0===m?this.set(t):this.setRGB(t,u,m)}function Tl(t,u,m){return m<0&&(m+=1),m>1&&(m-=1),m<.16666666666666666?t+6*(u-t)*m:m<.5?u:m<.6666666666666666?t+6*(u-t)*(.6666666666666666-m):t}function bh(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function qh(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function ha(t,u,m,g,E,I){this.a=t,this.b=u,this.c=m,this.normal=g&&g.isVector3?g:new ot,this.vertexNormals=Array.isArray(g)?g:[],this.color=E&&E.isColor?E:new or,this.vertexColors=Array.isArray(E)?E:[],this.materialIndex=void 0!==I?I:0}Object.assign(or.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,u,m){return this.r=t,this.g=u,this.b=m,this},setHSL:function(t,u,m){if(t=er.euclideanModulo(t,1),u=er.clamp(u,0,1),m=er.clamp(m,0,1),0===u)this.r=this.g=this.b=m;else{const g=m<=.5?m*(1+u):m+u-m*u,E=2*m-g;this.r=Tl(E,g,t+.3333333333333333),this.g=Tl(E,g,t),this.b=Tl(E,g,t-.3333333333333333)}return this},setStyle:function(t){function u(g){void 0!==g&&parseFloat(g)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let m;if(m=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){let g;const I=m[2];switch(m[1]){case"rgb":case"rgba":if(g=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I))return this.r=Math.min(255,parseInt(g[1],10))/255,this.g=Math.min(255,parseInt(g[2],10))/255,this.b=Math.min(255,parseInt(g[3],10))/255,u(g[5]),this;if(g=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I))return this.r=Math.min(100,parseInt(g[1],10))/100,this.g=Math.min(100,parseInt(g[2],10))/100,this.b=Math.min(100,parseInt(g[3],10))/100,u(g[5]),this;break;case"hsl":case"hsla":if(g=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I)){const V=parseFloat(g[1])/360,Z=parseInt(g[2],10)/100,J=parseInt(g[3],10)/100;return u(g[5]),this.setHSL(V,Z,J)}}}else if(m=/^\#([A-Fa-f0-9]+)$/.exec(t)){const g=m[1],E=g.length;if(3===E)return this.r=parseInt(g.charAt(0)+g.charAt(0),16)/255,this.g=parseInt(g.charAt(1)+g.charAt(1),16)/255,this.b=parseInt(g.charAt(2)+g.charAt(2),16)/255,this;if(6===E)return this.r=parseInt(g.charAt(0)+g.charAt(1),16)/255,this.g=parseInt(g.charAt(2)+g.charAt(3),16)/255,this.b=parseInt(g.charAt(4)+g.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){const u=Sc[t];return void 0!==u?this.setHex(u):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,u){return void 0===u&&(u=2),this.r=Math.pow(t.r,u),this.g=Math.pow(t.g,u),this.b=Math.pow(t.b,u),this},copyLinearToGamma:function(t,u){void 0===u&&(u=2);const m=u>0?1/u:1;return this.r=Math.pow(t.r,m),this.g=Math.pow(t.g,m),this.b=Math.pow(t.b,m),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=bh(t.r),this.g=bh(t.g),this.b=bh(t.b),this},copyLinearToSRGB:function(t){return this.r=qh(t.r),this.g=qh(t.g),this.b=qh(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const u=this.r,m=this.g,g=this.b,E=Math.max(u,m,g),I=Math.min(u,m,g);let V,Z;const J=(I+E)/2;if(I===E)V=0,Z=0;else{const ee=E-I;switch(Z=J<=.5?ee/(E+I):ee/(2-E-I),E){case u:V=(m-g)/ee+(m<g?6:0);break;case m:V=(g-u)/ee+2;break;case g:V=(u-m)/ee+4}V/=6}return t.h=V,t.s=Z,t.l=J,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,u,m){return this.getHSL(Ys),Ys.h+=t,Ys.s+=u,Ys.l+=m,this.setHSL(Ys.h,Ys.s,Ys.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,u){return this.r=t.r+u.r,this.g=t.g+u.g,this.b=t.b+u.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,u){return this.r+=(t.r-this.r)*u,this.g+=(t.g-this.g)*u,this.b+=(t.b-this.b)*u,this},lerpHSL:function(t,u){this.getHSL(Ys),t.getHSL(Ap);const m=er.lerp(Ys.h,Ap.h,u),g=er.lerp(Ys.s,Ap.s,u),E=er.lerp(Ys.l,Ap.l,u);return this.setHSL(m,g,E),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,u){return void 0===u&&(u=0),this.r=t[u],this.g=t[u+1],this.b=t[u+2],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.r,t[u+1]=this.g,t[u+2]=this.b,t},fromBufferAttribute:function(t,u){return this.r=t.getX(u),this.g=t.getY(u),this.b=t.getZ(u),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},toJSON:function(){return this.getHex()}}),or.NAMES=Sc,Object.assign(ha.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let u=0,m=t.vertexNormals.length;u<m;u++)this.vertexNormals[u]=t.vertexNormals[u].clone();for(let u=0,m=t.vertexColors.length;u<m;u++)this.vertexColors[u]=t.vertexColors[u].clone();return this}});let vd=0;function zr(){Object.defineProperty(this,"id",{value:vd++}),this.uuid=er.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=he,this.side=ie,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Ft,this.blendDst=Ot,this.blendEquation=Ne,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ar,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=aa,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ve,this.stencilZFail=Ve,this.stencilZPass=Ve,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function ro(t){zr.call(this),this.type="MeshBasicMaterial",this.color=new or(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}zr.prototype=Object.assign(Object.create(ca.prototype),{constructor:zr,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(const u in t){const m=t[u];if(void 0===m){console.warn("THREE.Material: '"+u+"' parameter is undefined.");continue}if("shading"===u){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=m===A;continue}const g=this[u];void 0!==g?g&&g.isColor?g.set(m):g&&g.isVector3&&m&&m.isVector3?g.copy(m):this[u]=m:console.warn("THREE."+this.type+": '"+u+"' is not a property of this material.")}},toJSON:function(t){const u=void 0===t||"string"==typeof t;u&&(t={textures:{},images:{}});const m={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function g(E){const I=[];for(const V in E){const Z=E[V];delete Z.metadata,I.push(Z)}return I}if(m.uuid=this.uuid,m.type=this.type,""!==this.name&&(m.name=this.name),this.color&&this.color.isColor&&(m.color=this.color.getHex()),void 0!==this.roughness&&(m.roughness=this.roughness),void 0!==this.metalness&&(m.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(m.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(m.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(m.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(m.specular=this.specular.getHex()),void 0!==this.shininess&&(m.shininess=this.shininess),void 0!==this.clearcoat&&(m.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(m.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(m.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(m.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(m.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,m.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(m.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(m.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(m.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(m.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(m.aoMap=this.aoMap.toJSON(t).uuid,m.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(m.bumpMap=this.bumpMap.toJSON(t).uuid,m.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(m.normalMap=this.normalMap.toJSON(t).uuid,m.normalMapType=this.normalMapType,m.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(m.displacementMap=this.displacementMap.toJSON(t).uuid,m.displacementScale=this.displacementScale,m.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(m.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(m.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(m.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(m.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(m.envMap=this.envMap.toJSON(t).uuid,m.reflectivity=this.reflectivity,m.refractionRatio=this.refractionRatio,void 0!==this.combine&&(m.combine=this.combine),void 0!==this.envMapIntensity&&(m.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(m.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(m.size=this.size),void 0!==this.sizeAttenuation&&(m.sizeAttenuation=this.sizeAttenuation),this.blending!==he&&(m.blending=this.blending),!0===this.flatShading&&(m.flatShading=this.flatShading),this.side!==ie&&(m.side=this.side),this.vertexColors&&(m.vertexColors=!0),this.opacity<1&&(m.opacity=this.opacity),!0===this.transparent&&(m.transparent=this.transparent),m.depthFunc=this.depthFunc,m.depthTest=this.depthTest,m.depthWrite=this.depthWrite,m.stencilWrite=this.stencilWrite,m.stencilWriteMask=this.stencilWriteMask,m.stencilFunc=this.stencilFunc,m.stencilRef=this.stencilRef,m.stencilFuncMask=this.stencilFuncMask,m.stencilFail=this.stencilFail,m.stencilZFail=this.stencilZFail,m.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(m.rotation=this.rotation),!0===this.polygonOffset&&(m.polygonOffset=!0),0!==this.polygonOffsetFactor&&(m.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(m.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(m.linewidth=this.linewidth),void 0!==this.dashSize&&(m.dashSize=this.dashSize),void 0!==this.gapSize&&(m.gapSize=this.gapSize),void 0!==this.scale&&(m.scale=this.scale),!0===this.dithering&&(m.dithering=!0),this.alphaTest>0&&(m.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(m.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(m.wireframe=this.wireframe),this.wireframeLinewidth>1&&(m.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(m.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(m.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(m.morphTargets=!0),!0===this.morphNormals&&(m.morphNormals=!0),!0===this.skinning&&(m.skinning=!0),!1===this.visible&&(m.visible=!1),!1===this.toneMapped&&(m.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(m.userData=this.userData),u){const E=g(t.textures),I=g(t.images);E.length>0&&(m.textures=E),I.length>0&&(m.images=I)}return m},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const u=t.clippingPlanes;let m=null;if(null!==u){const g=u.length;m=new Array(g);for(let E=0;E!==g;++E)m[E]=u[E].clone()}return this.clippingPlanes=m,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(zr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),(ro.prototype=Object.create(zr.prototype)).constructor=ro,ro.prototype.isMeshBasicMaterial=!0,ro.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};const Oo=new ot,$s=new Sn;function Hr(t,u,m){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=u,this.count=void 0!==t?t.length/u:0,this.normalized=!0===m,this.usage=yi,this.updateRange={offset:0,count:-1},this.version=0}function ol(t,u,m){Hr.call(this,new Int8Array(t),u,m)}function Ec(t,u,m){Hr.call(this,new Uint8Array(t),u,m)}function Yu(t,u,m){Hr.call(this,new Uint8ClampedArray(t),u,m)}function Xh(t,u,m){Hr.call(this,new Int16Array(t),u,m)}function Ml(t,u,m){Hr.call(this,new Uint16Array(t),u,m)}function Qn(t,u,m){Hr.call(this,new Int32Array(t),u,m)}function sl(t,u,m){Hr.call(this,new Uint32Array(t),u,m)}function Dn(t,u,m){Hr.call(this,new Float32Array(t),u,m)}function Al(t,u,m){Hr.call(this,new Float64Array(t),u,m)}function Fi(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Dd(t){if(0===t.length)return-1/0;let u=t[0];for(let m=1,g=t.length;m<g;++m)t[m]>u&&(u=t[m]);return u}Object.defineProperty(Hr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Hr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,u,m){t*=this.itemSize,m*=u.itemSize;for(let g=0,E=this.itemSize;g<E;g++)this.array[t+g]=u.array[m+g];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",g),I=new or),u[m++]=I.r,u[m++]=I.g,u[m++]=I.b}return this},copyVector2sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",g),I=new Sn),u[m++]=I.x,u[m++]=I.y}return this},copyVector3sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",g),I=new ot),u[m++]=I.x,u[m++]=I.y,u[m++]=I.z}return this},copyVector4sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",g),I=new bi),u[m++]=I.x,u[m++]=I.y,u[m++]=I.z,u[m++]=I.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(let u=0,m=this.count;u<m;u++)$s.fromBufferAttribute(this,u),$s.applyMatrix3(t),this.setXY(u,$s.x,$s.y);else if(3===this.itemSize)for(let u=0,m=this.count;u<m;u++)Oo.fromBufferAttribute(this,u),Oo.applyMatrix3(t),this.setXYZ(u,Oo.x,Oo.y,Oo.z);return this},applyMatrix4:function(t){for(let u=0,m=this.count;u<m;u++)Oo.x=this.getX(u),Oo.y=this.getY(u),Oo.z=this.getZ(u),Oo.applyMatrix4(t),this.setXYZ(u,Oo.x,Oo.y,Oo.z);return this},applyNormalMatrix:function(t){for(let u=0,m=this.count;u<m;u++)Oo.x=this.getX(u),Oo.y=this.getY(u),Oo.z=this.getZ(u),Oo.applyNormalMatrix(t),this.setXYZ(u,Oo.x,Oo.y,Oo.z);return this},transformDirection:function(t){for(let u=0,m=this.count;u<m;u++)Oo.x=this.getX(u),Oo.y=this.getY(u),Oo.z=this.getZ(u),Oo.transformDirection(t),this.setXYZ(u,Oo.x,Oo.y,Oo.z);return this},set:function(t,u){return void 0===u&&(u=0),this.array.set(t,u),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,u){return this.array[t*this.itemSize]=u,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,u){return this.array[t*this.itemSize+1]=u,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,u){return this.array[t*this.itemSize+2]=u,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,u){return this.array[t*this.itemSize+3]=u,this},setXY:function(t,u,m){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this},setXYZ:function(t,u,m,g){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this.array[t+2]=g,this},setXYZW:function(t,u,m,g,E){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this.array[t+2]=g,this.array[t+3]=E,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(ol.prototype=Object.create(Hr.prototype)).constructor=ol,(Ec.prototype=Object.create(Hr.prototype)).constructor=Ec,(Yu.prototype=Object.create(Hr.prototype)).constructor=Yu,(Xh.prototype=Object.create(Hr.prototype)).constructor=Xh,(Ml.prototype=Object.create(Hr.prototype)).constructor=Ml,(Qn.prototype=Object.create(Hr.prototype)).constructor=Qn,(sl.prototype=Object.create(Hr.prototype)).constructor=sl,(Dn.prototype=Object.create(Hr.prototype)).constructor=Dn,(Al.prototype=Object.create(Hr.prototype)).constructor=Al,Object.assign(Fi.prototype,{computeGroups:function(t){const u=[];let m,g,E;const I=t.faces;for(g=0;g<I.length;g++){const V=I[g];V.materialIndex!==E&&(E=V.materialIndex,void 0!==m&&(m.count=3*g-m.start,u.push(m)),m={start:3*g,materialIndex:E})}void 0!==m&&(m.count=3*g-m.start,u.push(m)),this.groups=u},fromGeometry:function(t){const u=t.faces,m=t.vertices,g=t.faceVertexUvs,E=g[0]&&g[0].length>0,I=g[1]&&g[1].length>0,V=t.morphTargets,Z=V.length;let J;if(Z>0){J=[];for(let w=0;w<Z;w++)J[w]={name:V[w].name,data:[]};this.morphTargets.position=J}const ee=t.morphNormals,_e=ee.length;let S;if(_e>0){S=[];for(let w=0;w<_e;w++)S[w]={name:ee[w].name,data:[]};this.morphTargets.normal=S}const e=t.skinIndices,c=t.skinWeights,p=e.length===m.length,_=c.length===m.length;m.length>0&&0===u.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let w=0;w<u.length;w++){const L=u[w];this.vertices.push(m[L.a],m[L.b],m[L.c]);const O=L.vertexNormals;if(3===O.length)this.normals.push(O[0],O[1],O[2]);else{const U=L.normal;this.normals.push(U,U,U)}const F=L.vertexColors;if(3===F.length)this.colors.push(F[0],F[1],F[2]);else{const U=L.color;this.colors.push(U,U,U)}if(!0===E){const U=g[0][w];void 0!==U?this.uvs.push(U[0],U[1],U[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",w),this.uvs.push(new Sn,new Sn,new Sn))}if(!0===I){const U=g[1][w];void 0!==U?this.uvs2.push(U[0],U[1],U[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",w),this.uvs2.push(new Sn,new Sn,new Sn))}for(let U=0;U<Z;U++){const te=V[U].vertices;J[U].data.push(te[L.a],te[L.b],te[L.c])}for(let U=0;U<_e;U++){const te=ee[U].vertexNormals[w];S[U].data.push(te.a,te.b,te.c)}p&&this.skinIndices.push(e[L.a],e[L.b],e[L.c]),_&&this.skinWeights.push(c[L.a],c[L.b],c[L.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});let $p=1;const Sa=new ni,Ju=new Zn,Zu=new ot,Ea=new mn,li=new mn,Jr=new ot;function pn(){Object.defineProperty(this,"id",{value:$p+=2}),this.uuid=er.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}pn.prototype=Object.assign(Object.create(ca.prototype),{constructor:pn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=Array.isArray(t)?new(Dd(t)>65535?sl:Ml)(t,1):t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,u){return this.attributes[t]=u,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,u,m){this.groups.push({start:t,count:u,materialIndex:void 0!==m?m:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,u){this.drawRange.start=t,this.drawRange.count=u},applyMatrix4:function(t){const u=this.attributes.position;void 0!==u&&(u.applyMatrix4(t),u.needsUpdate=!0);const m=this.attributes.normal;if(void 0!==m){const E=(new jo).getNormalMatrix(t);m.applyNormalMatrix(E),m.needsUpdate=!0}const g=this.attributes.tangent;return void 0!==g&&(g.transformDirection(t),g.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Sa.makeRotationX(t),this.applyMatrix4(Sa),this},rotateY:function(t){return Sa.makeRotationY(t),this.applyMatrix4(Sa),this},rotateZ:function(t){return Sa.makeRotationZ(t),this.applyMatrix4(Sa),this},translate:function(t,u,m){return Sa.makeTranslation(t,u,m),this.applyMatrix4(Sa),this},scale:function(t,u,m){return Sa.makeScale(t,u,m),this.applyMatrix4(Sa),this},lookAt:function(t){return Ju.lookAt(t),Ju.updateMatrix(),this.applyMatrix4(Ju.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zu).negate(),this.translate(Zu.x,Zu.y,Zu.z),this},setFromObject:function(t){const u=t.geometry;if(t.isPoints||t.isLine){const m=new Dn(3*u.vertices.length,3),g=new Dn(3*u.colors.length,3);if(this.setAttribute("position",m.copyVector3sArray(u.vertices)),this.setAttribute("color",g.copyColorsArray(u.colors)),u.lineDistances&&u.lineDistances.length===u.vertices.length){const E=new Dn(u.lineDistances.length,1);this.setAttribute("lineDistance",E.copyArray(u.lineDistances))}null!==u.boundingSphere&&(this.boundingSphere=u.boundingSphere.clone()),null!==u.boundingBox&&(this.boundingBox=u.boundingBox.clone())}else t.isMesh&&u&&u.isGeometry&&this.fromGeometry(u);return this},setFromPoints:function(t){const u=[];for(let m=0,g=t.length;m<g;m++){const E=t[m];u.push(E.x,E.y,E.z||0)}return this.setAttribute("position",new Dn(u,3)),this},updateFromObject:function(t){let u=t.geometry;if(t.isMesh){let m=u.__directGeometry;if(!0===u.elementsNeedUpdate&&(m=void 0,u.elementsNeedUpdate=!1),void 0===m)return this.fromGeometry(u);m.verticesNeedUpdate=u.verticesNeedUpdate,m.normalsNeedUpdate=u.normalsNeedUpdate,m.colorsNeedUpdate=u.colorsNeedUpdate,m.uvsNeedUpdate=u.uvsNeedUpdate,m.groupsNeedUpdate=u.groupsNeedUpdate,u.verticesNeedUpdate=!1,u.normalsNeedUpdate=!1,u.colorsNeedUpdate=!1,u.uvsNeedUpdate=!1,u.groupsNeedUpdate=!1,u=m}if(!0===u.verticesNeedUpdate){const m=this.attributes.position;void 0!==m&&(m.copyVector3sArray(u.vertices),m.needsUpdate=!0),u.verticesNeedUpdate=!1}if(!0===u.normalsNeedUpdate){const m=this.attributes.normal;void 0!==m&&(m.copyVector3sArray(u.normals),m.needsUpdate=!0),u.normalsNeedUpdate=!1}if(!0===u.colorsNeedUpdate){const m=this.attributes.color;void 0!==m&&(m.copyColorsArray(u.colors),m.needsUpdate=!0),u.colorsNeedUpdate=!1}if(u.uvsNeedUpdate){const m=this.attributes.uv;void 0!==m&&(m.copyVector2sArray(u.uvs),m.needsUpdate=!0),u.uvsNeedUpdate=!1}if(u.lineDistancesNeedUpdate){const m=this.attributes.lineDistance;void 0!==m&&(m.copyArray(u.lineDistances),m.needsUpdate=!0),u.lineDistancesNeedUpdate=!1}return u.groupsNeedUpdate&&(u.computeGroups(t.geometry),this.groups=u.groups,u.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Fi).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){const u=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Hr(u,3).copyVector3sArray(t.vertices)),t.normals.length>0){const m=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Hr(m,3).copyVector3sArray(t.normals))}if(t.colors.length>0){const m=new Float32Array(3*t.colors.length);this.setAttribute("color",new Hr(m,3).copyColorsArray(t.colors))}if(t.uvs.length>0){const m=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Hr(m,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){const m=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Hr(m,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(const m in t.morphTargets){const g=[],E=t.morphTargets[m];for(let I=0,V=E.length;I<V;I++){const Z=E[I],J=new Dn(3*Z.data.length,3);J.name=Z.name,g.push(J.copyVector3sArray(Z.data))}this.morphAttributes[m]=g}if(t.skinIndices.length>0){const m=new Dn(4*t.skinIndices.length,4);this.setAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){const m=new Dn(4*t.skinWeights.length,4);this.setAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new mn);const t=this.attributes.position,u=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),u)for(let m=0,g=u.length;m<g;m++)Ea.setFromBufferAttribute(u[m]),this.morphTargetsRelative?(Jr.addVectors(this.boundingBox.min,Ea.min),this.boundingBox.expandByPoint(Jr),Jr.addVectors(this.boundingBox.max,Ea.max),this.boundingBox.expandByPoint(Jr)):(this.boundingBox.expandByPoint(Ea.min),this.boundingBox.expandByPoint(Ea.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new zn);const t=this.attributes.position,u=this.morphAttributes.position;if(t){const m=this.boundingSphere.center;if(Ea.setFromBufferAttribute(t),u)for(let E=0,I=u.length;E<I;E++)li.setFromBufferAttribute(u[E]),this.morphTargetsRelative?(Jr.addVectors(Ea.min,li.min),Ea.expandByPoint(Jr),Jr.addVectors(Ea.max,li.max),Ea.expandByPoint(Jr)):(Ea.expandByPoint(li.min),Ea.expandByPoint(li.max));Ea.getCenter(m);let g=0;for(let E=0,I=t.count;E<I;E++)Jr.fromBufferAttribute(t,E),g=Math.max(g,m.distanceToSquared(Jr));if(u)for(let E=0,I=u.length;E<I;E++){const V=u[E],Z=this.morphTargetsRelative;for(let J=0,ee=V.count;J<ee;J++)Jr.fromBufferAttribute(V,J),Z&&(Zu.fromBufferAttribute(t,J),Jr.add(Zu)),g=Math.max(g,m.distanceToSquared(Jr))}this.boundingSphere.radius=Math.sqrt(g),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const t=this.index,u=this.getAttribute("position");if(void 0!==u){let m=this.getAttribute("normal");if(void 0===m)m=new Hr(new Float32Array(3*u.count),3),this.setAttribute("normal",m);else for(let S=0,e=m.count;S<e;S++)m.setXYZ(S,0,0,0);const g=new ot,E=new ot,I=new ot,V=new ot,Z=new ot,J=new ot,ee=new ot,_e=new ot;if(t)for(let S=0,e=t.count;S<e;S+=3){const c=t.getX(S+0),p=t.getX(S+1),_=t.getX(S+2);g.fromBufferAttribute(u,c),E.fromBufferAttribute(u,p),I.fromBufferAttribute(u,_),ee.subVectors(I,E),_e.subVectors(g,E),ee.cross(_e),V.fromBufferAttribute(m,c),Z.fromBufferAttribute(m,p),J.fromBufferAttribute(m,_),V.add(ee),Z.add(ee),J.add(ee),m.setXYZ(c,V.x,V.y,V.z),m.setXYZ(p,Z.x,Z.y,Z.z),m.setXYZ(_,J.x,J.y,J.z)}else for(let S=0,e=u.count;S<e;S+=3)g.fromBufferAttribute(u,S+0),E.fromBufferAttribute(u,S+1),I.fromBufferAttribute(u,S+2),ee.subVectors(I,E),_e.subVectors(g,E),ee.cross(_e),m.setXYZ(S+0,ee.x,ee.y,ee.z),m.setXYZ(S+1,ee.x,ee.y,ee.z),m.setXYZ(S+2,ee.x,ee.y,ee.z);this.normalizeNormals(),m.needsUpdate=!0}},merge:function(t,u){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===u&&(u=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const m=this.attributes;for(const g in m){if(void 0===t.attributes[g])continue;const E=m[g].array,I=t.attributes[g],V=I.array,Z=I.itemSize*u,J=Math.min(V.length,E.length-Z);for(let ee=0,_e=Z;ee<J;ee++,_e++)E[_e]=V[ee]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let u=0,m=t.count;u<m;u++)Jr.fromBufferAttribute(t,u),Jr.normalize(),t.setXYZ(u,Jr.x,Jr.y,Jr.z)},toNonIndexed:function(){function t(V,Z){const J=V.array,ee=V.itemSize,_e=V.normalized,S=new J.constructor(Z.length*ee);let e=0,c=0;for(let p=0,_=Z.length;p<_;p++){e=Z[p]*ee;for(let w=0;w<ee;w++)S[c++]=J[e++]}return new Hr(S,ee,_e)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const u=new pn,m=this.index.array,g=this.attributes;for(const V in g){const Z=t(g[V],m);u.setAttribute(V,Z)}const E=this.morphAttributes;for(const V in E){const Z=[],J=E[V];for(let ee=0,_e=J.length;ee<_e;ee++){const S=t(J[ee],m);Z.push(S)}u.morphAttributes[V]=Z}u.morphTargetsRelative=this.morphTargetsRelative;const I=this.groups;for(let V=0,Z=I.length;V<Z;V++){const J=I[V];u.addGroup(J.start,J.count,J.materialIndex)}return u},toJSON:function(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const Z=this.parameters;for(const J in Z)void 0!==Z[J]&&(t[J]=Z[J]);return t}t.data={attributes:{}};const u=this.index;null!==u&&(t.data.index={type:u.array.constructor.name,array:Array.prototype.slice.call(u.array)});const m=this.attributes;for(const Z in m){const J=m[Z],ee=J.toJSON(t.data);""!==J.name&&(ee.name=J.name),t.data.attributes[Z]=ee}const g={};let E=!1;for(const Z in this.morphAttributes){const J=this.morphAttributes[Z],ee=[];for(let _e=0,S=J.length;_e<S;_e++){const e=J[_e],c=e.toJSON(t.data);""!==e.name&&(c.name=e.name),ee.push(c)}ee.length>0&&(g[Z]=ee,E=!0)}E&&(t.data.morphAttributes=g,t.data.morphTargetsRelative=this.morphTargetsRelative);const I=this.groups;I.length>0&&(t.data.groups=JSON.parse(JSON.stringify(I)));const V=this.boundingSphere;return null!==V&&(t.data.boundingSphere={center:V.center.toArray(),radius:V.radius}),t},clone:function(){return(new pn).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const u={};this.name=t.name;const m=t.index;null!==m&&this.setIndex(m.clone(u));const g=t.attributes;for(const J in g)this.setAttribute(J,g[J].clone(u));const E=t.morphAttributes;for(const J in E){const ee=[],_e=E[J];for(let S=0,e=_e.length;S<e;S++)ee.push(_e[S].clone(u));this.morphAttributes[J]=ee}this.morphTargetsRelative=t.morphTargetsRelative;const I=t.groups;for(let J=0,ee=I.length;J<ee;J++){const _e=I[J];this.addGroup(_e.start,_e.count,_e.materialIndex)}const V=t.boundingBox;null!==V&&(this.boundingBox=V.clone());const Z=t.boundingSphere;return null!==Z&&(this.boundingSphere=Z.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const qc=new ni,ci=new _o,pa=new zn,ja=new ot,Bn=new ot,xi=new ot,ys=new ot,bs=new ot,Cs=new ot,ri=new ot,Sr=new ot,gr=new ot,ll=new Sn,Tc=new Sn,Qu=new Sn,Ga=new ot,es=new ot;function Li(t,u){Zn.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new pn,this.material=void 0!==u?u:new ro,this.updateMorphTargets()}function Yh(t,u,m,g,E,I,V,Z){let J;if(J=u.side===W?g.intersectTriangle(V,I,E,!0,Z):g.intersectTriangle(E,I,V,u.side!==Q,Z),null===J)return null;es.copy(Z),es.applyMatrix4(t.matrixWorld);const ee=m.ray.origin.distanceTo(es);return ee<m.near||ee>m.far?null:{distance:ee,point:es.clone(),object:t}}function xh(t,u,m,g,E,I,V,Z,J,ee,_e,S){ja.fromBufferAttribute(E,ee),Bn.fromBufferAttribute(E,_e),xi.fromBufferAttribute(E,S);const e=t.morphTargetInfluences;if(u.morphTargets&&I&&e){ri.set(0,0,0),Sr.set(0,0,0),gr.set(0,0,0);for(let p=0,_=I.length;p<_;p++){const w=e[p],L=I[p];0!==w&&(ys.fromBufferAttribute(L,ee),bs.fromBufferAttribute(L,_e),Cs.fromBufferAttribute(L,S),V?(ri.addScaledVector(ys,w),Sr.addScaledVector(bs,w),gr.addScaledVector(Cs,w)):(ri.addScaledVector(ys.sub(ja),w),Sr.addScaledVector(bs.sub(Bn),w),gr.addScaledVector(Cs.sub(xi),w)))}ja.add(ri),Bn.add(Sr),xi.add(gr)}t.isSkinnedMesh&&(t.boneTransform(ee,ja),t.boneTransform(_e,Bn),t.boneTransform(S,xi));const c=Yh(t,u,m,g,ja,Bn,xi,Ga);if(c){Z&&(ll.fromBufferAttribute(Z,ee),Tc.fromBufferAttribute(Z,_e),Qu.fromBufferAttribute(Z,S),c.uv=Pr.getUV(Ga,ja,Bn,xi,ll,Tc,Qu,new Sn)),J&&(ll.fromBufferAttribute(J,ee),Tc.fromBufferAttribute(J,_e),Qu.fromBufferAttribute(J,S),c.uv2=Pr.getUV(Ga,ja,Bn,xi,ll,Tc,Qu,new Sn));const p=new ha(ee,_e,S);Pr.getNormal(ja,Bn,xi,p.normal),c.face=p}return c}Li.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Li,isMesh:!0,copy:function(t){return Zn.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const V=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[V]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,u){const m=this.geometry,g=this.material,E=this.matrixWorld;if(void 0===g||(null===m.boundingSphere&&m.computeBoundingSphere(),pa.copy(m.boundingSphere),pa.applyMatrix4(E),!1===t.ray.intersectsSphere(pa))||(qc.getInverse(E),ci.copy(t.ray).applyMatrix4(qc),null!==m.boundingBox&&!1===ci.intersectsBox(m.boundingBox)))return;let I;if(m.isBufferGeometry){const V=m.index,Z=m.attributes.position,J=m.morphAttributes.position,ee=m.morphTargetsRelative,_e=m.attributes.uv,S=m.attributes.uv2,e=m.groups,c=m.drawRange;if(null!==V)if(Array.isArray(g))for(let p=0,_=e.length;p<_;p++){const w=e[p],L=g[w.materialIndex];for(let O=Math.max(w.start,c.start),F=Math.min(w.start+w.count,c.start+c.count);O<F;O+=3){const U=V.getX(O),te=V.getX(O+1),ce=V.getX(O+2);I=xh(this,L,t,ci,Z,J,ee,_e,S,U,te,ce),I&&(I.faceIndex=Math.floor(O/3),I.face.materialIndex=w.materialIndex,u.push(I))}}else for(let p=Math.max(0,c.start),_=Math.min(V.count,c.start+c.count);p<_;p+=3){const w=V.getX(p),L=V.getX(p+1),O=V.getX(p+2);I=xh(this,g,t,ci,Z,J,ee,_e,S,w,L,O),I&&(I.faceIndex=Math.floor(p/3),u.push(I))}else if(void 0!==Z)if(Array.isArray(g))for(let p=0,_=e.length;p<_;p++){const w=e[p],L=g[w.materialIndex];for(let O=Math.max(w.start,c.start),F=Math.min(w.start+w.count,c.start+c.count);O<F;O+=3)I=xh(this,L,t,ci,Z,J,ee,_e,S,O,O+1,O+2),I&&(I.faceIndex=Math.floor(O/3),I.face.materialIndex=w.materialIndex,u.push(I))}else for(let p=Math.max(0,c.start),_=Math.min(Z.count,c.start+c.count);p<_;p+=3)I=xh(this,g,t,ci,Z,J,ee,_e,S,p,p+1,p+2),I&&(I.faceIndex=Math.floor(p/3),u.push(I))}else if(m.isGeometry){const V=Array.isArray(g),Z=m.vertices,J=m.faces;let ee;const _e=m.faceVertexUvs[0];_e.length>0&&(ee=_e);for(let S=0,e=J.length;S<e;S++){const c=J[S],p=V?g[c.materialIndex]:g;if(void 0===p)continue;const _=Z[c.a],w=Z[c.b],L=Z[c.c];if(I=Yh(this,p,t,ci,_,w,L,Ga),I){if(ee&&ee[S]){const O=ee[S];ll.copy(O[0]),Tc.copy(O[1]),Qu.copy(O[2]),I.uv=Pr.getUV(Ga,_,w,L,ll,Tc,Qu,new Sn)}I.face=c,I.faceIndex=S,u.push(I)}}}}});let Jh=0;const ur=new ni,Yo=new Zn,cl=new ot;function Fr(){Object.defineProperty(this,"id",{value:Jh+=2}),this.uuid=er.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Fr.prototype=Object.assign(Object.create(ca.prototype),{constructor:Fr,isGeometry:!0,applyMatrix4:function(t){const u=(new jo).getNormalMatrix(t);for(let m=0,g=this.vertices.length;m<g;m++)this.vertices[m].applyMatrix4(t);for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m];E.normal.applyMatrix3(u).normalize();for(let I=0,V=E.vertexNormals.length;I<V;I++)E.vertexNormals[I].applyMatrix3(u).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return ur.makeRotationX(t),this.applyMatrix4(ur),this},rotateY:function(t){return ur.makeRotationY(t),this.applyMatrix4(ur),this},rotateZ:function(t){return ur.makeRotationZ(t),this.applyMatrix4(ur),this},translate:function(t,u,m){return ur.makeTranslation(t,u,m),this.applyMatrix4(ur),this},scale:function(t,u,m){return ur.makeScale(t,u,m),this.applyMatrix4(ur),this},lookAt:function(t){return Yo.lookAt(t),Yo.updateMatrix(),this.applyMatrix4(Yo.matrix),this},fromBufferGeometry:function(t){const u=this,m=null!==t.index?t.index:void 0,g=t.attributes;if(void 0===g.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const E=g.position,I=g.normal,V=g.color,Z=g.uv,J=g.uv2;void 0!==J&&(this.faceVertexUvs[1]=[]);for(let S=0;S<E.count;S++)u.vertices.push((new ot).fromBufferAttribute(E,S)),void 0!==V&&u.colors.push((new or).fromBufferAttribute(V,S));function ee(S,e,c,p){const _=void 0===V?[]:[u.colors[S].clone(),u.colors[e].clone(),u.colors[c].clone()],w=new ha(S,e,c,void 0===I?[]:[(new ot).fromBufferAttribute(I,S),(new ot).fromBufferAttribute(I,e),(new ot).fromBufferAttribute(I,c)],_,p);u.faces.push(w),void 0!==Z&&u.faceVertexUvs[0].push([(new Sn).fromBufferAttribute(Z,S),(new Sn).fromBufferAttribute(Z,e),(new Sn).fromBufferAttribute(Z,c)]),void 0!==J&&u.faceVertexUvs[1].push([(new Sn).fromBufferAttribute(J,S),(new Sn).fromBufferAttribute(J,e),(new Sn).fromBufferAttribute(J,c)])}const _e=t.groups;if(_e.length>0)for(let S=0;S<_e.length;S++){const e=_e[S],c=e.start;for(let p=c,_=c+e.count;p<_;p+=3)void 0!==m?ee(m.getX(p),m.getX(p+1),m.getX(p+2),e.materialIndex):ee(p,p+1,p+2,e.materialIndex)}else if(void 0!==m)for(let S=0;S<m.count;S+=3)ee(m.getX(S),m.getX(S+1),m.getX(S+2));else for(let S=0;S<E.count;S+=3)ee(S,S+1,S+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(cl).negate(),this.translate(cl.x,cl.y,cl.z),this},normalize:function(){this.computeBoundingSphere();const t=this.boundingSphere.center,u=this.boundingSphere.radius,m=0===u?1:1/u,g=new ni;return g.set(m,0,0,-m*t.x,0,m,0,-m*t.y,0,0,m,-m*t.z,0,0,0,1),this.applyMatrix4(g),this},computeFaceNormals:function(){const t=new ot,u=new ot;for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m],I=this.vertices[E.a],V=this.vertices[E.b];t.subVectors(this.vertices[E.c],V),u.subVectors(I,V),t.cross(u),t.normalize(),E.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);const u=new Array(this.vertices.length);for(let m=0,g=this.vertices.length;m<g;m++)u[m]=new ot;if(t){const m=new ot,g=new ot;for(let E=0,I=this.faces.length;E<I;E++){const V=this.faces[E],Z=this.vertices[V.a],J=this.vertices[V.b];m.subVectors(this.vertices[V.c],J),g.subVectors(Z,J),m.cross(g),u[V.a].add(m),u[V.b].add(m),u[V.c].add(m)}}else{this.computeFaceNormals();for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m];u[E.a].add(E.normal),u[E.b].add(E.normal),u[E.c].add(E.normal)}}for(let m=0,g=this.vertices.length;m<g;m++)u[m].normalize();for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m],I=E.vertexNormals;3===I.length?(I[0].copy(u[E.a]),I[1].copy(u[E.b]),I[2].copy(u[E.c])):(I[0]=u[E.a].clone(),I[1]=u[E.b].clone(),I[2]=u[E.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let t=0,u=this.faces.length;t<u;t++){const m=this.faces[t],g=m.vertexNormals;3===g.length?(g[0].copy(m.normal),g[1].copy(m.normal),g[2].copy(m.normal)):(g[0]=m.normal.clone(),g[1]=m.normal.clone(),g[2]=m.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let u=0,m=this.faces.length;u<m;u++){const g=this.faces[u];g.__originalFaceNormal?g.__originalFaceNormal.copy(g.normal):g.__originalFaceNormal=g.normal.clone(),g.__originalVertexNormals||(g.__originalVertexNormals=[]);for(let E=0,I=g.vertexNormals.length;E<I;E++)g.__originalVertexNormals[E]?g.__originalVertexNormals[E].copy(g.vertexNormals[E]):g.__originalVertexNormals[E]=g.vertexNormals[E].clone()}const t=new Fr;t.faces=this.faces;for(let u=0,m=this.morphTargets.length;u<m;u++){if(!this.morphNormals[u]){this.morphNormals[u]={},this.morphNormals[u].faceNormals=[],this.morphNormals[u].vertexNormals=[];const E=this.morphNormals[u].faceNormals,I=this.morphNormals[u].vertexNormals;for(let V=0,Z=this.faces.length;V<Z;V++){const J=new ot,ee={a:new ot,b:new ot,c:new ot};E.push(J),I.push(ee)}}const g=this.morphNormals[u];t.vertices=this.morphTargets[u].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let E=0,I=this.faces.length;E<I;E++){const V=this.faces[E],J=g.vertexNormals[E];g.faceNormals[E].copy(V.normal),J.a.copy(V.vertexNormals[0]),J.b.copy(V.vertexNormals[1]),J.c.copy(V.vertexNormals[2])}}for(let u=0,m=this.faces.length;u<m;u++){const g=this.faces[u];g.normal=g.__originalFaceNormal,g.vertexNormals=g.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new mn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new zn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,u,m){if(!t||!t.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);let g,E=this.vertices.length,I=this.vertices,V=t.vertices,Z=this.faces,J=t.faces,ee=this.colors,_e=t.colors;void 0===m&&(m=0),void 0!==u&&(g=(new jo).getNormalMatrix(u));for(let S=0,e=V.length;S<e;S++){const c=V[S].clone();void 0!==u&&c.applyMatrix4(u),I.push(c)}for(let S=0,e=_e.length;S<e;S++)ee.push(_e[S].clone());for(let S=0,e=J.length;S<e;S++){let c,p,_,w=J[S],L=w.vertexNormals,O=w.vertexColors;c=new ha(w.a+E,w.b+E,w.c+E),c.normal.copy(w.normal),void 0!==g&&c.normal.applyMatrix3(g).normalize();for(let F=0,U=L.length;F<U;F++)p=L[F].clone(),void 0!==g&&p.applyMatrix3(g).normalize(),c.vertexNormals.push(p);c.color.copy(w.color);for(let F=0,U=O.length;F<U;F++)_=O[F],c.vertexColors.push(_.clone());c.materialIndex=w.materialIndex+m,Z.push(c)}for(let S=0,e=t.faceVertexUvs.length;S<e;S++){const c=t.faceVertexUvs[S];void 0===this.faceVertexUvs[S]&&(this.faceVertexUvs[S]=[]);for(let p=0,_=c.length;p<_;p++){const w=c[p],L=[];for(let O=0,F=w.length;O<F;O++)L.push(w[O].clone());this.faceVertexUvs[S].push(L)}}},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){const t={},u=[],m=[],g=Math.pow(10,4);for(let V=0,Z=this.vertices.length;V<Z;V++){const J=this.vertices[V],ee=Math.round(J.x*g)+"_"+Math.round(J.y*g)+"_"+Math.round(J.z*g);void 0===t[ee]?(t[ee]=V,u.push(this.vertices[V]),m[V]=u.length-1):m[V]=m[t[ee]]}const E=[];for(let V=0,Z=this.faces.length;V<Z;V++){const J=this.faces[V];J.a=m[J.a],J.b=m[J.b],J.c=m[J.c];const ee=[J.a,J.b,J.c];for(let _e=0;_e<3;_e++)if(ee[_e]===ee[(_e+1)%3]){E.push(V);break}}for(let V=E.length-1;V>=0;V--){const Z=E[V];this.faces.splice(Z,1);for(let J=0,ee=this.faceVertexUvs.length;J<ee;J++)this.faceVertexUvs[J].splice(Z,1)}const I=this.vertices.length-u.length;return this.vertices=u,I},setFromPoints:function(t){this.vertices=[];for(let u=0,m=t.length;u<m;u++){const g=t[u];this.vertices.push(new ot(g.x,g.y,g.z||0))}return this},sortFacesByMaterialIndex:function(){const t=this.faces,u=t.length;for(let V=0;V<u;V++)t[V]._id=V;t.sort(function(V,Z){return V.materialIndex-Z.materialIndex});const m=this.faceVertexUvs[0],g=this.faceVertexUvs[1];let E,I;m&&m.length===u&&(E=[]),g&&g.length===u&&(I=[]);for(let V=0;V<u;V++){const Z=t[V]._id;E&&E.push(m[Z]),I&&I.push(g[Z])}E&&(this.faceVertexUvs[0]=E),I&&(this.faceVertexUvs[1]=I)},toJSON:function(){const t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){const c=this.parameters;for(const p in c)void 0!==c[p]&&(t[p]=c[p]);return t}const u=[];for(let c=0;c<this.vertices.length;c++){const p=this.vertices[c];u.push(p.x,p.y,p.z)}const m=[],g=[],E={},I=[],V={},Z=[],J={};for(let c=0;c<this.faces.length;c++){const p=this.faces[c],_=!0,w=!1,L=void 0!==this.faceVertexUvs[0][c],O=p.normal.length()>0,F=p.vertexNormals.length>0,U=1!==p.color.r||1!==p.color.g||1!==p.color.b,te=p.vertexColors.length>0;let ce=0;if(ce=ee(ce,0,0),ce=ee(ce,1,_),ce=ee(ce,2,w),ce=ee(ce,3,L),ce=ee(ce,4,O),ce=ee(ce,5,F),ce=ee(ce,6,U),ce=ee(ce,7,te),m.push(ce),m.push(p.a,p.b,p.c),m.push(p.materialIndex),L){const oe=this.faceVertexUvs[0][c];m.push(e(oe[0]),e(oe[1]),e(oe[2]))}if(O&&m.push(_e(p.normal)),F){const oe=p.vertexNormals;m.push(_e(oe[0]),_e(oe[1]),_e(oe[2]))}if(U&&m.push(S(p.color)),te){const oe=p.vertexColors;m.push(S(oe[0]),S(oe[1]),S(oe[2]))}}function ee(c,p,_){return _?c|1<<p:c&~(1<<p)}function _e(c){const p=c.x.toString()+c.y.toString()+c.z.toString();return void 0!==E[p]||(E[p]=g.length/3,g.push(c.x,c.y,c.z)),E[p]}function S(c){const p=c.r.toString()+c.g.toString()+c.b.toString();return void 0!==V[p]||(V[p]=I.length,I.push(c.getHex())),V[p]}function e(c){const p=c.x.toString()+c.y.toString();return void 0!==J[p]||(J[p]=Z.length/2,Z.push(c.x,c.y)),J[p]}return t.data={},t.data.vertices=u,t.data.normals=g,I.length>0&&(t.data.colors=I),Z.length>0&&(t.data.uvs=[Z]),t.data.faces=m,t},clone:function(){return(new Fr).copy(this)},copy:function(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;const u=t.vertices;for(let S=0,e=u.length;S<e;S++)this.vertices.push(u[S].clone());const m=t.colors;for(let S=0,e=m.length;S<e;S++)this.colors.push(m[S].clone());const g=t.faces;for(let S=0,e=g.length;S<e;S++)this.faces.push(g[S].clone());for(let S=0,e=t.faceVertexUvs.length;S<e;S++){const c=t.faceVertexUvs[S];void 0===this.faceVertexUvs[S]&&(this.faceVertexUvs[S]=[]);for(let p=0,_=c.length;p<_;p++){const w=c[p],L=[];for(let O=0,F=w.length;O<F;O++)L.push(w[O].clone());this.faceVertexUvs[S].push(L)}}const E=t.morphTargets;for(let S=0,e=E.length;S<e;S++){const c={};if(c.name=E[S].name,void 0!==E[S].vertices){c.vertices=[];for(let p=0,_=E[S].vertices.length;p<_;p++)c.vertices.push(E[S].vertices[p].clone())}if(void 0!==E[S].normals){c.normals=[];for(let p=0,_=E[S].normals.length;p<_;p++)c.normals.push(E[S].normals[p].clone())}this.morphTargets.push(c)}const I=t.morphNormals;for(let S=0,e=I.length;S<e;S++){const c={};if(void 0!==I[S].vertexNormals){c.vertexNormals=[];for(let p=0,_=I[S].vertexNormals.length;p<_;p++){const w=I[S].vertexNormals[p],L={};L.a=w.a.clone(),L.b=w.b.clone(),L.c=w.c.clone(),c.vertexNormals.push(L)}}if(void 0!==I[S].faceNormals){c.faceNormals=[];for(let p=0,_=I[S].faceNormals.length;p<_;p++)c.faceNormals.push(I[S].faceNormals[p].clone())}this.morphNormals.push(c)}const V=t.skinWeights;for(let S=0,e=V.length;S<e;S++)this.skinWeights.push(V[S].clone());const Z=t.skinIndices;for(let S=0,e=Z.length;S<e;S++)this.skinIndices.push(Z[S].clone());const J=t.lineDistances;for(let S=0,e=J.length;S<e;S++)this.lineDistances.push(J[S]);const ee=t.boundingBox;null!==ee&&(this.boundingBox=ee.clone());const _e=t.boundingSphere;return null!==_e&&(this.boundingSphere=_e.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Ls extends Fr{constructor(u,m,g,E,I,V){super(),this.type="BoxGeometry",this.parameters={width:u,height:m,depth:g,widthSegments:E,heightSegments:I,depthSegments:V},this.fromBufferGeometry(new Ku(u,m,g,E,I,V)),this.mergeVertices()}}class Ku extends pn{constructor(u=1,m=1,g=1,E=1,I=1,V=1){super(),this.type="BoxBufferGeometry",this.parameters={width:u,height:m,depth:g,widthSegments:E,heightSegments:I,depthSegments:V};const Z=this;E=Math.floor(E),I=Math.floor(I),V=Math.floor(V);const J=[],ee=[],_e=[],S=[];let e=0,c=0;function p(_,w,L,O,F,U,te,ce,oe,de,ve){const Me=U/oe,Be=te/de,Ae=U/2,ke=te/2,Je=ce/2,We=oe+1,rt=de+1;let nt=0,gt=0;const xt=new ot;for(let Ut=0;Ut<rt;Ut++){const Ht=Ut*Be-ke;for(let Ye=0;Ye<We;Ye++)xt[_]=(Ye*Me-Ae)*O,xt[w]=Ht*F,xt[L]=Je,ee.push(xt.x,xt.y,xt.z),xt[_]=0,xt[w]=0,xt[L]=ce>0?1:-1,_e.push(xt.x,xt.y,xt.z),S.push(Ye/oe),S.push(1-Ut/de),nt+=1}for(let Ut=0;Ut<de;Ut++)for(let Ht=0;Ht<oe;Ht++){const pt=e+Ht+We*(Ut+1),Vt=e+(Ht+1)+We*(Ut+1),Rt=e+(Ht+1)+We*Ut;J.push(e+Ht+We*Ut,pt,Rt),J.push(pt,Vt,Rt),gt+=6}Z.addGroup(c,gt,ve),c+=gt,e+=nt}p("z","y","x",-1,-1,g,m,u,V,I,0),p("z","y","x",1,-1,g,m,-u,V,I,1),p("x","z","y",1,1,u,g,m,E,V,2),p("x","z","y",1,-1,u,g,-m,E,V,3),p("x","y","z",1,-1,u,m,g,E,I,4),p("x","y","z",-1,-1,u,m,-g,E,I,5),this.setIndex(J),this.setAttribute("position",new Dn(ee,3)),this.setAttribute("normal",new Dn(_e,3)),this.setAttribute("uv",new Dn(S,2))}}function Xc(t){const u={};for(const m in t){u[m]={};for(const g in t[m]){const E=t[m][g];u[m][g]=E&&(E.isColor||E.isMatrix3||E.isMatrix4||E.isVector2||E.isVector3||E.isVector4||E.isTexture)?E.clone():Array.isArray(E)?E.slice():E}}return u}function Bs(t){const u={};for(let m=0;m<t.length;m++){const g=Xc(t[m]);for(const E in g)u[E]=g[E]}return u}const ko={clone:Xc,merge:Bs};var Zh="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",Jl="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function go(t){zr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Zh,this.fragmentShader=Jl,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Ai(){Zn.call(this),this.type="Camera",this.matrixWorldInverse=new ni,this.projectionMatrix=new ni,this.projectionMatrixInverse=new ni}function Ns(t,u,m,g){Ai.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==m?m:.1,this.far=void 0!==g?g:2e3,this.focus=10,this.aspect=void 0!==u?u:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}(go.prototype=Object.create(zr.prototype)).constructor=go,go.prototype.isShaderMaterial=!0,go.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Xc(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this},go.prototype.toJSON=function(t){const u=zr.prototype.toJSON.call(this,t);u.uniforms={};for(const g in this.uniforms){const E=this.uniforms[g].value;u.uniforms[g]=E&&E.isTexture?{type:"t",value:E.toJSON(t).uuid}:E&&E.isColor?{type:"c",value:E.getHex()}:E&&E.isVector2?{type:"v2",value:E.toArray()}:E&&E.isVector3?{type:"v3",value:E.toArray()}:E&&E.isVector4?{type:"v4",value:E.toArray()}:E&&E.isMatrix3?{type:"m3",value:E.toArray()}:E&&E.isMatrix4?{type:"m4",value:E.toArray()}:{value:E}}Object.keys(this.defines).length>0&&(u.defines=this.defines),u.vertexShader=this.vertexShader,u.fragmentShader=this.fragmentShader;const m={};for(const g in this.extensions)!0===this.extensions[g]&&(m[g]=!0);return Object.keys(m).length>0&&(u.extensions=m),u},Ai.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Ai,isCamera:!0,copy:function(t,u){return Zn.prototype.copy.call(this,t,u),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new ot),this.updateMatrixWorld(!0);const u=this.matrixWorld.elements;return t.set(-u[8],-u[9],-u[10]).normalize()},updateMatrixWorld:function(t){Zn.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,u){Zn.prototype.updateWorldMatrix.call(this,t,u),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Ns.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Ns,isPerspectiveCamera:!0,copy:function(t,u){return Ai.prototype.copy.call(this,t,u),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){const u=.5*this.getFilmHeight()/t;this.fov=2*er.RAD2DEG*Math.atan(u),this.updateProjectionMatrix()},getFocalLength:function(){const t=Math.tan(.5*er.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*er.RAD2DEG*Math.atan(Math.tan(.5*er.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,u,m,g,E,I){this.aspect=t/u,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=u,this.view.offsetX=m,this.view.offsetY=g,this.view.width=E,this.view.height=I,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let t=this.near,u=t*Math.tan(.5*er.DEG2RAD*this.fov)/this.zoom,m=2*u,g=this.aspect*m,E=-.5*g,I=this.view;if(null!==this.view&&this.view.enabled){const Z=I.fullWidth,J=I.fullHeight;E+=I.offsetX*g/Z,u-=I.offsetY*m/J,g*=I.width/Z,m*=I.height/J}const V=this.filmOffset;0!==V&&(E+=t*V/this.getFilmWidth()),this.projectionMatrix.makePerspective(E,E+g,u,u-m,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const u=Zn.prototype.toJSON.call(this,t);return u.object.fov=this.fov,u.object.zoom=this.zoom,u.object.near=this.near,u.object.far=this.far,u.object.focus=this.focus,u.object.aspect=this.aspect,null!==this.view&&(u.object.view=Object.assign({},this.view)),u.object.filmGauge=this.filmGauge,u.object.filmOffset=this.filmOffset,u}});const Rs=90,$l=1;function Fo(t,u,m){if(Zn.call(this),this.type="CubeCamera",!0!==m.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=m;const g=new Ns(Rs,$l,t,u);g.layers=this.layers,g.up.set(0,-1,0),g.lookAt(new ot(1,0,0)),this.add(g);const E=new Ns(Rs,$l,t,u);E.layers=this.layers,E.up.set(0,-1,0),E.lookAt(new ot(-1,0,0)),this.add(E);const I=new Ns(Rs,$l,t,u);I.layers=this.layers,I.up.set(0,0,1),I.lookAt(new ot(0,1,0)),this.add(I);const V=new Ns(Rs,$l,t,u);V.layers=this.layers,V.up.set(0,0,-1),V.lookAt(new ot(0,-1,0)),this.add(V);const Z=new Ns(Rs,$l,t,u);Z.layers=this.layers,Z.up.set(0,-1,0),Z.lookAt(new ot(0,0,1)),this.add(Z);const J=new Ns(Rs,$l,t,u);J.layers=this.layers,J.up.set(0,-1,0),J.lookAt(new ot(0,0,-1)),this.add(J),this.update=function(ee,_e){null===this.parent&&this.updateMatrixWorld();const S=ee.xr.enabled,e=ee.getRenderTarget();ee.xr.enabled=!1;const c=m.texture.generateMipmaps;m.texture.generateMipmaps=!1,ee.setRenderTarget(m,0),ee.render(_e,g),ee.setRenderTarget(m,1),ee.render(_e,E),ee.setRenderTarget(m,2),ee.render(_e,I),ee.setRenderTarget(m,3),ee.render(_e,V),ee.setRenderTarget(m,4),ee.render(_e,Z),m.texture.generateMipmaps=c,ee.setRenderTarget(m,5),ee.render(_e,J),ee.setRenderTarget(e),ee.xr.enabled=S},this.clear=function(ee,_e,S,e){const c=ee.getRenderTarget();for(let p=0;p<6;p++)ee.setRenderTarget(m,p),ee.clear(_e,S,e);ee.setRenderTarget(c)}}function Cl(t,u,m){Number.isInteger(u)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),u=m),ks.call(this,t,t,u)}function ul(t,u,m,g,E,I,V,Z,J,ee,_e,S){di.call(this,null,I,V,Z,J,ee,g,E,_e,S),this.image={data:t||null,width:u||1,height:m||1},this.magFilter=void 0!==J?J:Or,this.minFilter=void 0!==ee?ee:Or,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}(Fo.prototype=Object.create(Zn.prototype)).constructor=Fo,(Cl.prototype=Object.create(ks.prototype)).constructor=Cl,Cl.prototype.isWebGLCubeRenderTarget=!0,Cl.prototype.fromEquirectangularTexture=function(t,u){this.texture.type=u.type,this.texture.format=mo,this.texture.encoding=u.encoding,this.texture.generateMipmaps=u.generateMipmaps,this.texture.minFilter=u.minFilter,this.texture.magFilter=u.magFilter;const m=new El,I=new go({name:"CubemapFromEquirect",uniforms:Xc({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t",fragmentShader:"\n\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t",side:W,blending:X});I.uniforms.tEquirect.value=u;const V=new Li(new Ku(5,5,5),I);return m.add(V),new Fo(1,10,this).update(t,m),V.geometry.dispose(),V.material.dispose(),this},(ul.prototype=Object.create(di.prototype)).constructor=ul,ul.prototype.isDataTexture=!0;const Zl=new zn,Mc=new ot;function Yc(t,u,m,g,E,I){this.planes=[void 0!==t?t:new Xo,void 0!==u?u:new Xo,void 0!==m?m:new Xo,void 0!==g?g:new Xo,void 0!==E?E:new Xo,void 0!==I?I:new Xo]}Object.assign(Yc.prototype,{set:function(t,u,m,g,E,I){const V=this.planes;return V[0].copy(t),V[1].copy(u),V[2].copy(m),V[3].copy(g),V[4].copy(E),V[5].copy(I),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){const u=this.planes;for(let m=0;m<6;m++)u[m].copy(t.planes[m]);return this},setFromProjectionMatrix:function(t){const u=this.planes,m=t.elements,g=m[0],E=m[1],I=m[2],V=m[3],Z=m[4],J=m[5],ee=m[6],_e=m[7],S=m[8],e=m[9],c=m[10],p=m[11],_=m[12],w=m[13],L=m[14],O=m[15];return u[0].setComponents(V-g,_e-Z,p-S,O-_).normalize(),u[1].setComponents(V+g,_e+Z,p+S,O+_).normalize(),u[2].setComponents(V+E,_e+J,p+e,O+w).normalize(),u[3].setComponents(V-E,_e-J,p-e,O-w).normalize(),u[4].setComponents(V-I,_e-ee,p-c,O-L).normalize(),u[5].setComponents(V+I,_e+ee,p+c,O+L).normalize(),this},intersectsObject:function(t){const u=t.geometry;return null===u.boundingSphere&&u.computeBoundingSphere(),Zl.copy(u.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Zl)},intersectsSprite:function(t){return Zl.center.set(0,0,0),Zl.radius=.7071067811865476,Zl.applyMatrix4(t.matrixWorld),this.intersectsSphere(Zl)},intersectsSphere:function(t){const u=this.planes,m=t.center,g=-t.radius;for(let E=0;E<6;E++)if(u[E].distanceToPoint(m)<g)return!1;return!0},intersectsBox:function(t){const u=this.planes;for(let m=0;m<6;m++){const g=u[m];if(Mc.x=g.normal.x>0?t.max.x:t.min.x,Mc.y=g.normal.y>0?t.max.y:t.min.y,Mc.z=g.normal.z>0?t.max.z:t.min.z,g.distanceToPoint(Mc)<0)return!1}return!0},containsPoint:function(t){const u=this.planes;for(let m=0;m<6;m++)if(u[m].distanceToPoint(t)<0)return!1;return!0}});const cr={common:{diffuse:{value:new or(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new jo},uv2Transform:{value:new jo},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Sn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new or(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new or(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new jo}},sprite:{diffuse:{value:new or(15658734)},opacity:{value:1},center:{value:new Sn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new jo}}};function Cp(){let t=null,u=!1,m=null,g=null;function E(I,V){m(I,V),g=t.requestAnimationFrame(E)}return{start:function(){!0!==u&&null!==m&&(g=t.requestAnimationFrame(E),u=!0)},stop:function(){t.cancelAnimationFrame(g),u=!1},setAnimationLoop:function(I){m=I},setContext:function(I){t=I}}}function Ta(t,u){const m=u.isWebGL2,g=new WeakMap;return{get:function(E){return E.isInterleavedBufferAttribute&&(E=E.data),g.get(E)},remove:function(E){E.isInterleavedBufferAttribute&&(E=E.data);const I=g.get(E);I&&(t.deleteBuffer(I.buffer),g.delete(E))},update:function(E,I){E.isInterleavedBufferAttribute&&(E=E.data);const V=g.get(E);void 0===V?g.set(E,function(Z,J){const ee=Z.array,_e=Z.usage,S=t.createBuffer();t.bindBuffer(J,S),t.bufferData(J,ee,_e),Z.onUploadCallback();let e=5126;return ee instanceof Float32Array?e=5126:ee instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):ee instanceof Uint16Array?e=5123:ee instanceof Int16Array?e=5122:ee instanceof Uint32Array?e=5125:ee instanceof Int32Array?e=5124:ee instanceof Int8Array?e=5120:ee instanceof Uint8Array&&(e=5121),{buffer:S,type:e,bytesPerElement:ee.BYTES_PER_ELEMENT,version:Z.version}}(E,I)):V.version<E.version&&(function(Z,J,ee){const _e=J.array,S=J.updateRange;t.bindBuffer(ee,Z),-1===S.count?t.bufferSubData(ee,0,_e):(m?t.bufferSubData(ee,S.offset*_e.BYTES_PER_ELEMENT,_e,S.offset,S.count):t.bufferSubData(ee,S.offset*_e.BYTES_PER_ELEMENT,_e.subarray(S.offset,S.offset+S.count)),S.count=-1)}(V.buffer,E,I),V.version=E.version)}}}function Ha(t,u,m,g){Fr.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:u,widthSegments:m,heightSegments:g},this.fromBufferGeometry(new Ll(t,u,m,g)),this.mergeVertices()}function Ll(t,u,m,g){pn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:u,widthSegments:m,heightSegments:g};const E=(t=t||1)/2,I=(u=u||1)/2,V=Math.floor(m)||1,Z=Math.floor(g)||1,J=V+1,ee=Z+1,_e=t/V,S=u/Z,e=[],c=[],p=[],_=[];for(let w=0;w<ee;w++){const L=w*S-I;for(let O=0;O<J;O++)c.push(O*_e-E,-L,0),p.push(0,0,1),_.push(O/V),_.push(1-w/Z)}for(let w=0;w<Z;w++)for(let L=0;L<V;L++){const F=L+J*(w+1),U=L+1+J*(w+1),te=L+1+J*w;e.push(L+J*w,F,te),e.push(F,U,te)}this.setIndex(e),this.setAttribute("position",new Dn(c,3)),this.setAttribute("normal",new Dn(p,3)),this.setAttribute("uv",new Dn(_,2))}(Ha.prototype=Object.create(Fr.prototype)).constructor=Ha,(Ll.prototype=Object.create(pn.prototype)).constructor=Ll;const Dr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Ac={basic:{uniforms:Bs([cr.common,cr.specularmap,cr.envmap,cr.aomap,cr.lightmap,cr.fog]),vertexShader:Dr.meshbasic_vert,fragmentShader:Dr.meshbasic_frag},lambert:{uniforms:Bs([cr.common,cr.specularmap,cr.envmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.fog,cr.lights,{emissive:{value:new or(0)}}]),vertexShader:Dr.meshlambert_vert,fragmentShader:Dr.meshlambert_frag},phong:{uniforms:Bs([cr.common,cr.specularmap,cr.envmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.fog,cr.lights,{emissive:{value:new or(0)},specular:{value:new or(1118481)},shininess:{value:30}}]),vertexShader:Dr.meshphong_vert,fragmentShader:Dr.meshphong_frag},standard:{uniforms:Bs([cr.common,cr.envmap,cr.aomap,cr.lightmap,cr.emissivemap,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.roughnessmap,cr.metalnessmap,cr.fog,cr.lights,{emissive:{value:new or(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Dr.meshphysical_vert,fragmentShader:Dr.meshphysical_frag},toon:{uniforms:Bs([cr.common,cr.aomap,cr.lightmap,cr.emissivemap,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.gradientmap,cr.fog,cr.lights,{emissive:{value:new or(0)}}]),vertexShader:Dr.meshtoon_vert,fragmentShader:Dr.meshtoon_frag},matcap:{uniforms:Bs([cr.common,cr.bumpmap,cr.normalmap,cr.displacementmap,cr.fog,{matcap:{value:null}}]),vertexShader:Dr.meshmatcap_vert,fragmentShader:Dr.meshmatcap_frag},points:{uniforms:Bs([cr.points,cr.fog]),vertexShader:Dr.points_vert,fragmentShader:Dr.points_frag},dashed:{uniforms:Bs([cr.common,cr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Dr.linedashed_vert,fragmentShader:Dr.linedashed_frag},depth:{uniforms:Bs([cr.common,cr.displacementmap]),vertexShader:Dr.depth_vert,fragmentShader:Dr.depth_frag},normal:{uniforms:Bs([cr.common,cr.bumpmap,cr.normalmap,cr.displacementmap,{opacity:{value:1}}]),vertexShader:Dr.normal_vert,fragmentShader:Dr.normal_frag},sprite:{uniforms:Bs([cr.sprite,cr.fog]),vertexShader:Dr.sprite_vert,fragmentShader:Dr.sprite_frag},background:{uniforms:{uvTransform:{value:new jo},t2D:{value:null}},vertexShader:Dr.background_vert,fragmentShader:Dr.background_frag},cube:{uniforms:Bs([cr.envmap,{opacity:{value:1}}]),vertexShader:Dr.cube_vert,fragmentShader:Dr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Dr.equirect_vert,fragmentShader:Dr.equirect_frag},distanceRGBA:{uniforms:Bs([cr.common,cr.displacementmap,{referencePosition:{value:new ot},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Dr.distanceRGBA_vert,fragmentShader:Dr.distanceRGBA_frag},shadow:{uniforms:Bs([cr.lights,cr.fog,{color:{value:new or(0)},opacity:{value:1}}]),vertexShader:Dr.shadow_vert,fragmentShader:Dr.shadow_frag}};function qp(t,u,m,g){const E=new or(0);let I,V,Z=0,J=null,ee=0,_e=null;function S(e,c){u.buffers.color.setClear(e.r,e.g,e.b,c,g)}return{getClearColor:function(){return E},setClearColor:function(e,c){E.set(e),Z=void 0!==c?c:1,S(E,Z)},getClearAlpha:function(){return Z},setClearAlpha:function(e){Z=e,S(E,Z)},render:function(e,c,p,_){let w=!0===c.isScene?c.background:null;const L=t.xr,O=L.getSession&&L.getSession();if(O&&"additive"===O.environmentBlendMode&&(w=null),null===w?S(E,Z):w&&w.isColor&&(S(w,1),_=!0),(t.autoClear||_)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),w&&(w.isCubeTexture||w.isWebGLCubeRenderTarget||w.mapping===Oi)){void 0===V&&(V=new Li(new Ku(1,1,1),new go({name:"BackgroundCubeMaterial",uniforms:Xc(Ac.cube.uniforms),vertexShader:Ac.cube.vertexShader,fragmentShader:Ac.cube.fragmentShader,side:W,depthTest:!1,depthWrite:!1,fog:!1})),V.geometry.deleteAttribute("normal"),V.geometry.deleteAttribute("uv"),V.onBeforeRender=function(U,te,ce){this.matrixWorld.copyPosition(ce.matrixWorld)},Object.defineProperty(V.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),m.update(V));const F=w.isWebGLCubeRenderTarget?w.texture:w;V.material.uniforms.envMap.value=F,V.material.uniforms.flipEnvMap.value=F.isCubeTexture?-1:1,J===w&&ee===F.version&&_e===t.toneMapping||(V.material.needsUpdate=!0,J=w,ee=F.version,_e=t.toneMapping),e.unshift(V,V.geometry,V.material,0,0,null)}else w&&w.isTexture&&(void 0===I&&(I=new Li(new Ll(2,2),new go({name:"BackgroundMaterial",uniforms:Xc(Ac.background.uniforms),vertexShader:Ac.background.vertexShader,fragmentShader:Ac.background.fragmentShader,side:ie,depthTest:!1,depthWrite:!1,fog:!1})),I.geometry.deleteAttribute("normal"),Object.defineProperty(I.material,"map",{get:function(){return this.uniforms.t2D.value}}),m.update(I)),I.material.uniforms.t2D.value=w,!0===w.matrixAutoUpdate&&w.updateMatrix(),I.material.uniforms.uvTransform.value.copy(w.matrix),J===w&&ee===w.version&&_e===t.toneMapping||(I.material.needsUpdate=!0,J=w,ee=w.version,_e=t.toneMapping),e.unshift(I,I.geometry,I.material,0,0,null))}}}function xu(t,u,m,g){const E=t.getParameter(34921),I=g.isWebGL2?null:u.get("OES_vertex_array_object"),V=g.isWebGL2||null!==I,Z={},J=e(null);let ee=J;function _e(U){return g.isWebGL2?t.bindVertexArray(U):I.bindVertexArrayOES(U)}function S(U){return g.isWebGL2?t.deleteVertexArray(U):I.deleteVertexArrayOES(U)}function e(U){const te=[],ce=[],oe=[];for(let de=0;de<E;de++)te[de]=0,ce[de]=0,oe[de]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:te,enabledAttributes:ce,attributeDivisors:oe,object:U,attributes:{}}}function c(){const U=ee.newAttributes;for(let te=0,ce=U.length;te<ce;te++)U[te]=0}function p(U){_(U,0)}function _(U,te){const oe=ee.enabledAttributes,de=ee.attributeDivisors;ee.newAttributes[U]=1,0===oe[U]&&(t.enableVertexAttribArray(U),oe[U]=1),de[U]!==te&&((g.isWebGL2?t:u.get("ANGLE_instanced_arrays"))[g.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](U,te),de[U]=te)}function w(){const U=ee.newAttributes,te=ee.enabledAttributes;for(let ce=0,oe=te.length;ce<oe;ce++)te[ce]!==U[ce]&&(t.disableVertexAttribArray(ce),te[ce]=0)}function L(U,te,ce,oe,de,ve){!0!==g.isWebGL2||5124!==ce&&5125!==ce?t.vertexAttribPointer(U,te,ce,oe,de,ve):t.vertexAttribIPointer(U,te,ce,de,ve)}function O(){F(),ee!==J&&(ee=J,_e(ee.object))}function F(){J.geometry=null,J.program=null,J.wireframe=!1}return{setup:function(U,te,ce,oe,de){let ve=!1;if(V){const Me=function(Be,Ae,ke){const Je=!0===ke.wireframe;let We=Z[Be.id];void 0===We&&(We={},Z[Be.id]=We);let rt=We[Ae.id];void 0===rt&&(rt={},We[Ae.id]=rt);let nt=rt[Je];return void 0===nt&&(nt=e(g.isWebGL2?t.createVertexArray():I.createVertexArrayOES()),rt[Je]=nt),nt}(oe,ce,te);ee!==Me&&(ee=Me,_e(ee.object)),ve=function(Be){const Ae=ee.attributes,ke=Be.attributes;if(Object.keys(Ae).length!==Object.keys(ke).length)return!0;for(const Je in ke){const We=Ae[Je],rt=ke[Je];if(We.attribute!==rt||We.data!==rt.data)return!0}return!1}(oe),ve&&function(Be){const Ae={},ke=Be.attributes;for(const Je in ke){const We=ke[Je],rt={};rt.attribute=We,We.data&&(rt.data=We.data),Ae[Je]=rt}ee.attributes=Ae}(oe)}else{const Me=!0===te.wireframe;ee.geometry===oe.id&&ee.program===ce.id&&ee.wireframe===Me||(ee.geometry=oe.id,ee.program=ce.id,ee.wireframe=Me,ve=!0)}!0===U.isInstancedMesh&&(ve=!0),null!==de&&m.update(de,34963),ve&&(function(Me,Be,Ae,ke){if(!1===g.isWebGL2&&(Me.isInstancedMesh||ke.isInstancedBufferGeometry)&&null===u.get("ANGLE_instanced_arrays"))return;c();const Je=ke.attributes,We=Ae.getAttributes(),rt=Be.defaultAttributeValues;for(const nt in We){const gt=We[nt];if(gt>=0){const xt=Je[nt];if(void 0!==xt){const Ut=xt.normalized,Ht=xt.itemSize,Ye=m.get(xt);if(void 0===Ye)continue;const pt=Ye.buffer,Vt=Ye.type,Rt=Ye.bytesPerElement;if(xt.isInterleavedBufferAttribute){const lt=xt.data,Jt=lt.stride,St=xt.offset;lt&&lt.isInstancedInterleavedBuffer?(_(gt,lt.meshPerAttribute),void 0===ke._maxInstanceCount&&(ke._maxInstanceCount=lt.meshPerAttribute*lt.count)):p(gt),t.bindBuffer(34962,pt),L(gt,Ht,Vt,Ut,Jt*Rt,St*Rt)}else xt.isInstancedBufferAttribute?(_(gt,xt.meshPerAttribute),void 0===ke._maxInstanceCount&&(ke._maxInstanceCount=xt.meshPerAttribute*xt.count)):p(gt),t.bindBuffer(34962,pt),L(gt,Ht,Vt,Ut,0,0)}else if("instanceMatrix"===nt){const Ut=m.get(Me.instanceMatrix);if(void 0===Ut)continue;const Ht=Ut.buffer,Ye=Ut.type;_(gt+0,1),_(gt+1,1),_(gt+2,1),_(gt+3,1),t.bindBuffer(34962,Ht),t.vertexAttribPointer(gt+0,4,Ye,!1,64,0),t.vertexAttribPointer(gt+1,4,Ye,!1,64,16),t.vertexAttribPointer(gt+2,4,Ye,!1,64,32),t.vertexAttribPointer(gt+3,4,Ye,!1,64,48)}else if(void 0!==rt){const Ut=rt[nt];if(void 0!==Ut)switch(Ut.length){case 2:t.vertexAttrib2fv(gt,Ut);break;case 3:t.vertexAttrib3fv(gt,Ut);break;case 4:t.vertexAttrib4fv(gt,Ut);break;default:t.vertexAttrib1fv(gt,Ut)}}}}w()}(U,te,ce,oe),null!==de&&t.bindBuffer(34963,m.get(de).buffer))},reset:O,resetDefaultState:F,dispose:function(){O();for(const U in Z){const te=Z[U];for(const ce in te){const oe=te[ce];for(const de in oe)S(oe[de].object),delete oe[de];delete te[ce]}delete Z[U]}},releaseStatesOfGeometry:function(U){if(void 0===Z[U.id])return;const te=Z[U.id];for(const ce in te){const oe=te[ce];for(const de in oe)S(oe[de].object),delete oe[de];delete te[ce]}delete Z[U.id]},releaseStatesOfProgram:function(U){for(const te in Z){const ce=Z[te];if(void 0===ce[U.id])continue;const oe=ce[U.id];for(const de in oe)S(oe[de].object),delete oe[de];delete ce[U.id]}},initAttributes:c,enableAttribute:p,disableUnusedAttributes:w}}function ui(t,u,m,g){const E=g.isWebGL2;let I;this.setMode=function(V){I=V},this.render=function(V,Z){t.drawArrays(I,V,Z),m.update(Z,I,1)},this.renderInstances=function(V,Z,J){if(0===J)return;let ee,_e;if(E)ee=t,_e="drawArraysInstanced";else if(ee=u.get("ANGLE_instanced_arrays"),_e="drawArraysInstancedANGLE",null===ee)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");ee[_e](I,V,Z,J),m.update(Z,I,J)}}function ir(t,u,m){let g;function E(F){if("highp"===F){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";F="mediump"}return"mediump"===F&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const I=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&t instanceof WebGL2ComputeRenderingContext;let V=void 0!==m.precision?m.precision:"highp";const Z=E(V);Z!==V&&(console.warn("THREE.WebGLRenderer:",V,"not supported, using",Z,"instead."),V=Z);const J=!0===m.logarithmicDepthBuffer,ee=t.getParameter(34930),_e=t.getParameter(35660),S=t.getParameter(3379),e=t.getParameter(34076),c=t.getParameter(34921),p=t.getParameter(36347),_=t.getParameter(36348),w=t.getParameter(36349),L=_e>0,O=I||!!u.get("OES_texture_float");return{isWebGL2:I,getMaxAnisotropy:function(){if(void 0!==g)return g;const F=u.get("EXT_texture_filter_anisotropic");return g=null!==F?t.getParameter(F.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,g},getMaxPrecision:E,precision:V,logarithmicDepthBuffer:J,maxTextures:ee,maxVertexTextures:_e,maxTextureSize:S,maxCubemapSize:e,maxAttributes:c,maxVertexUniforms:p,maxVaryings:_,maxFragmentUniforms:w,vertexTextures:L,floatFragmentTextures:O,floatVertexTextures:L&&O,maxSamples:I?t.getParameter(36183):0}}function Bl(){const t=this;let u=null,m=0,g=!1,E=!1;const I=new Xo,V=new jo,Z={value:null,needsUpdate:!1};function J(){Z.value!==u&&(Z.value=u,Z.needsUpdate=m>0),t.numPlanes=m,t.numIntersection=0}function ee(_e,S,e,c){let p=null!==_e?_e.length:0,_=null;if(0!==p){if(_=Z.value,!0!==c||null===_){const w=e+4*p,L=S.matrixWorldInverse;V.getNormalMatrix(L),(null===_||_.length<w)&&(_=new Float32Array(w));for(let O=0,F=e;O!==p;++O,F+=4)I.copy(_e[O]).applyMatrix4(L,V),I.normal.toArray(_,F),_[F+3]=I.constant}Z.value=_,Z.needsUpdate=!0}return t.numPlanes=p,t.numIntersection=0,_}this.uniform=Z,this.numPlanes=0,this.numIntersection=0,this.init=function(_e,S,e){const c=0!==_e.length||S||0!==m||g;return g=S,u=ee(_e,e,0),m=_e.length,c},this.beginShadows=function(){E=!0,ee(null)},this.endShadows=function(){E=!1,J()},this.setState=function(_e,S,e,c,p,_){if(!g||null===_e||0===_e.length||E&&!e)E?ee(null):J();else{const w=E?0:m,L=4*w;let O=p.clippingState||null;Z.value=O,O=ee(_e,c,L,_);for(let F=0;F!==L;++F)O[F]=u[F];p.clippingState=O,this.numIntersection=S?this.numPlanes:0,this.numPlanes+=w}}}function Jc(t){const u={};return{has:function(m){if(void 0!==u[m])return u[m];let g;switch(m){case"WEBGL_depth_texture":g=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":g=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":g=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":g=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:g=t.getExtension(m)}return u[m]=g,!!g},get:function(m){return this.has(m)||console.warn("THREE.WebGLRenderer: "+m+" extension not supported."),u[m]}}}function Bo(t,u,m,g){const E=new WeakMap,I=new WeakMap;function V(J){const ee=J.target,_e=E.get(ee);null!==_e.index&&u.remove(_e.index);for(const e in _e.attributes)u.remove(_e.attributes[e]);ee.removeEventListener("dispose",V),E.delete(ee);const S=I.get(_e);S&&(u.remove(S),I.delete(_e)),g.releaseStatesOfGeometry(ee),!0===ee.isInstancedBufferGeometry&&delete ee._maxInstanceCount,m.memory.geometries--}function Z(J){const ee=[],_e=J.index,S=J.attributes.position;let e=0;if(null!==_e){const _=_e.array;e=_e.version;for(let w=0,L=_.length;w<L;w+=3){const O=_[w+0],F=_[w+1],U=_[w+2];ee.push(O,F,F,U,U,O)}}else{e=S.version;for(let w=0,L=S.array.length/3-1;w<L;w+=3){const O=w+0,F=w+1,U=w+2;ee.push(O,F,F,U,U,O)}}const c=new(Dd(ee)>65535?sl:Ml)(ee,1);c.version=e;const p=I.get(J);p&&u.remove(p),I.set(J,c)}return{get:function(J,ee){let _e=E.get(ee);return _e||(ee.addEventListener("dispose",V),ee.isBufferGeometry?_e=ee:ee.isGeometry&&(void 0===ee._bufferGeometry&&(ee._bufferGeometry=(new pn).setFromObject(J)),_e=ee._bufferGeometry),E.set(ee,_e),m.memory.geometries++,_e)},update:function(J){const ee=J.attributes;for(const S in ee)u.update(ee[S],34962);const _e=J.morphAttributes;for(const S in _e){const e=_e[S];for(let c=0,p=e.length;c<p;c++)u.update(e[c],34962)}},getWireframeAttribute:function(J){const ee=I.get(J);if(ee){const _e=J.index;null!==_e&&ee.version<_e.version&&Z(J)}else Z(J);return I.get(J)}}}function Wn(t,u,m,g){const E=g.isWebGL2;let I,V,Z;this.setMode=function(J){I=J},this.setIndex=function(J){V=J.type,Z=J.bytesPerElement},this.render=function(J,ee){t.drawElements(I,ee,V,J*Z),m.update(ee,I,1)},this.renderInstances=function(J,ee,_e){if(0===_e)return;let S,e;if(E)S=t,e="drawElementsInstanced";else if(S=u.get("ANGLE_instanced_arrays"),e="drawElementsInstancedANGLE",null===S)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");S[e](I,ee,V,J*Z,_e),m.update(ee,I,_e)}}function Zc(t){const u={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:u,programs:null,autoReset:!0,reset:function(){u.frame++,u.calls=0,u.triangles=0,u.points=0,u.lines=0},update:function(m,g,E){switch(u.calls++,g){case 4:u.triangles+=E*(m/3);break;case 1:u.lines+=E*(m/2);break;case 3:u.lines+=E*(m-1);break;case 2:u.lines+=E*m;break;case 0:u.points+=E*m;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",g)}}}}function wu(t,u){return t[0]-u[0]}function hl(t,u){return Math.abs(u[1])-Math.abs(t[1])}function Ql(t){const u={},m=new Float32Array(8),g=[];for(let E=0;E<8;E++)g[E]=[E,0];return{update:function(E,I,V,Z){const J=E.morphTargetInfluences,ee=void 0===J?0:J.length;let _e=u[I.id];if(void 0===_e){_e=[];for(let _=0;_<ee;_++)_e[_]=[_,0];u[I.id]=_e}for(let _=0;_<ee;_++){const w=_e[_];w[0]=_,w[1]=J[_]}_e.sort(hl);for(let _=0;_<8;_++)_<ee&&_e[_][1]?(g[_][0]=_e[_][0],g[_][1]=_e[_][1]):(g[_][0]=Number.MAX_SAFE_INTEGER,g[_][1]=0);g.sort(wu);const S=V.morphTargets&&I.morphAttributes.position,e=V.morphNormals&&I.morphAttributes.normal;let c=0;for(let _=0;_<8;_++){const w=g[_],L=w[0],O=w[1];L!==Number.MAX_SAFE_INTEGER&&O?(S&&I.getAttribute("morphTarget"+_)!==S[L]&&I.setAttribute("morphTarget"+_,S[L]),e&&I.getAttribute("morphNormal"+_)!==e[L]&&I.setAttribute("morphNormal"+_,e[L]),m[_]=O,c+=O):(S&&void 0!==I.getAttribute("morphTarget"+_)&&I.deleteAttribute("morphTarget"+_),e&&void 0!==I.getAttribute("morphNormal"+_)&&I.deleteAttribute("morphNormal"+_),m[_]=0)}const p=I.morphTargetsRelative?1:1-c;Z.getUniforms().setValue(t,"morphTargetBaseInfluence",p),Z.getUniforms().setValue(t,"morphTargetInfluences",m)}}}function Su(t,u,m,g){let E=new WeakMap;return{update:function(I){const V=g.render.frame,Z=I.geometry,J=u.get(I,Z);return E.get(J)!==V&&(Z.isGeometry&&J.updateFromObject(I),u.update(J),E.set(J,V)),I.isInstancedMesh&&m.update(I.instanceMatrix,34962),J},dispose:function(){E=new WeakMap}}}function as(t,u,m,g,E,I,V,Z,J,ee){di.call(this,t=void 0!==t?t:[],u=void 0!==u?u:Ti,m,g,E,I,V=void 0!==V?V:Is,Z,J,ee),this.flipY=!1}function Va(t,u,m,g){di.call(this,null),this.image={data:t||null,width:u||1,height:m||1,depth:g||1},this.magFilter=Or,this.minFilter=Or,this.wrapR=Yr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Eu(t,u,m,g){di.call(this,null),this.image={data:t||null,width:u||1,height:m||1,depth:g||1},this.magFilter=Or,this.minFilter=Or,this.wrapR=Yr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Ac.physical={uniforms:Bs([Ac.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Sn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new or(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Dr.meshphysical_vert,fragmentShader:Dr.meshphysical_frag},(as.prototype=Object.create(di.prototype)).constructor=as,as.prototype.isCubeTexture=!0,Object.defineProperty(as.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),(Va.prototype=Object.create(di.prototype)).constructor=Va,Va.prototype.isDataTexture2DArray=!0,(Eu.prototype=Object.create(di.prototype)).constructor=Eu,Eu.prototype.isDataTexture3D=!0;const Ma=new di,Xp=new Va,Lp=new Eu,Qh=new as,Qc=[],eh=[],Aa=new Float32Array(16),io=new Float32Array(9),ts=new Float32Array(4);function Ie(t,u,m){const g=t[0];if(g<=0||g>0)return t;let E=u*m,I=Qc[E];if(void 0===I&&(I=new Float32Array(E),Qc[E]=I),0!==u){g.toArray(I,0);for(let V=1,Z=0;V!==u;++V)Z+=m,t[V].toArray(I,Z)}return I}function Ue(t,u){if(t.length!==u.length)return!1;for(let m=0,g=t.length;m<g;m++)if(t[m]!==u[m])return!1;return!0}function Ge(t,u){for(let m=0,g=u.length;m<g;m++)t[m]=u[m]}function xe(t,u){let m=eh[u];void 0===m&&(m=new Int32Array(u),eh[u]=m);for(let g=0;g!==u;++g)m[g]=t.allocateTextureUnit();return m}function ze(t,u){const m=this.cache;m[0]!==u&&(t.uniform1f(this.addr,u),m[0]=u)}function Xe(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y||(t.uniform2f(this.addr,u.x,u.y),m[0]=u.x,m[1]=u.y);else{if(Ue(m,u))return;t.uniform2fv(this.addr,u),Ge(m,u)}}function yt(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y&&m[2]===u.z||(t.uniform3f(this.addr,u.x,u.y,u.z),m[0]=u.x,m[1]=u.y,m[2]=u.z);else if(void 0!==u.r)m[0]===u.r&&m[1]===u.g&&m[2]===u.b||(t.uniform3f(this.addr,u.r,u.g,u.b),m[0]=u.r,m[1]=u.g,m[2]=u.b);else{if(Ue(m,u))return;t.uniform3fv(this.addr,u),Ge(m,u)}}function Nt(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y&&m[2]===u.z&&m[3]===u.w||(t.uniform4f(this.addr,u.x,u.y,u.z,u.w),m[0]=u.x,m[1]=u.y,m[2]=u.z,m[3]=u.w);else{if(Ue(m,u))return;t.uniform4fv(this.addr,u),Ge(m,u)}}function qt(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(Ue(m,u))return;t.uniformMatrix2fv(this.addr,!1,u),Ge(m,u)}else{if(Ue(m,g))return;ts.set(g),t.uniformMatrix2fv(this.addr,!1,ts),Ge(m,g)}}function Pn(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(Ue(m,u))return;t.uniformMatrix3fv(this.addr,!1,u),Ge(m,u)}else{if(Ue(m,g))return;io.set(g),t.uniformMatrix3fv(this.addr,!1,io),Ge(m,g)}}function En(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(Ue(m,u))return;t.uniformMatrix4fv(this.addr,!1,u),Ge(m,u)}else{if(Ue(m,g))return;Aa.set(g),t.uniformMatrix4fv(this.addr,!1,Aa),Ge(m,g)}}function Gn(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.safeSetTexture2D(u||Ma,E)}function Ar(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.setTexture2DArray(u||Xp,E)}function Ur(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.setTexture3D(u||Lp,E)}function $r(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.safeSetTextureCube(u||Qh,E)}function Zt(t,u){const m=this.cache;m[0]!==u&&(t.uniform1i(this.addr,u),m[0]=u)}function No(t,u){const m=this.cache;Ue(m,u)||(t.uniform2iv(this.addr,u),Ge(m,u))}function pl(t,u){const m=this.cache;Ue(m,u)||(t.uniform3iv(this.addr,u),Ge(m,u))}function da(t,u){const m=this.cache;Ue(m,u)||(t.uniform4iv(this.addr,u),Ge(m,u))}function Kr(t,u){const m=this.cache;m[0]!==u&&(t.uniform1ui(this.addr,u),m[0]=u)}function Ln(t,u){t.uniform1fv(this.addr,u)}function sf(t,u){t.uniform1iv(this.addr,u)}function Xf(t,u){t.uniform2iv(this.addr,u)}function dr(t,u){t.uniform3iv(this.addr,u)}function af(t,u){t.uniform4iv(this.addr,u)}function lf(t,u){const m=Ie(u,this.size,2);t.uniform2fv(this.addr,m)}function Sf(t,u){const m=Ie(u,this.size,3);t.uniform3fv(this.addr,m)}function Tu(t,u){const m=Ie(u,this.size,4);t.uniform4fv(this.addr,m)}function Yp(t,u){const m=Ie(u,this.size,4);t.uniformMatrix2fv(this.addr,!1,m)}function co(t,u){const m=Ie(u,this.size,9);t.uniformMatrix3fv(this.addr,!1,m)}function ls(t,u){const m=Ie(u,this.size,16);t.uniformMatrix4fv(this.addr,!1,m)}function th(t,u,m){const g=u.length,E=xe(m,g);t.uniform1iv(this.addr,E);for(let I=0;I!==g;++I)m.safeSetTexture2D(u[I]||Ma,E[I])}function Ef(t,u,m){const g=u.length,E=xe(m,g);t.uniform1iv(this.addr,E);for(let I=0;I!==g;++I)m.safeSetTextureCube(u[I]||Qh,E[I])}function Tf(t,u,m){this.id=t,this.addr=m,this.cache=[],this.setValue=function(g){switch(g){case 5126:return ze;case 35664:return Xe;case 35665:return yt;case 35666:return Nt;case 35674:return qt;case 35675:return Pn;case 35676:return En;case 5124:case 35670:return Zt;case 35667:case 35671:return No;case 35668:case 35672:return pl;case 35669:case 35673:return da;case 5125:return Kr;case 35678:case 36198:case 36298:case 36306:case 35682:return Gn;case 35679:case 36299:case 36307:return Ur;case 35680:case 36300:case 36308:case 36293:return $r;case 36289:case 36303:case 36311:case 36292:return Ar}}(u.type)}function Yf(t,u,m){this.id=t,this.addr=m,this.cache=[],this.size=u.size,this.setValue=function(g){switch(g){case 5126:return Ln;case 35664:return lf;case 35665:return Sf;case 35666:return Tu;case 35674:return Yp;case 35675:return co;case 35676:return ls;case 5124:case 35670:return sf;case 35667:case 35671:return Xf;case 35668:case 35672:return dr;case 35669:case 35673:return af;case 35678:case 36198:case 36298:case 36306:case 35682:return th;case 35680:case 36300:case 36308:case 36293:return Ef}}(u.type)}function Jf(t){this.id=t,this.seq=[],this.map={}}Yf.prototype.updateCache=function(t){let u=this.cache;t instanceof Float32Array&&u.length!==t.length&&(this.cache=new Float32Array(t.length)),Ge(u,t)},Jf.prototype.setValue=function(t,u,m){const g=this.seq;for(let E=0,I=g.length;E!==I;++E){const V=g[E];V.setValue(t,u[V.id],m)}};const Mf=/([\w\d_]+)(\])?(\[|\.)?/g;function Zf(t,u){t.seq.push(u),t.map[u.id]=u}function Am(t,u,m){const g=t.name,E=g.length;for(Mf.lastIndex=0;;){const I=Mf.exec(g);let Z=I[1],ee=I[3];if("]"===I[2]&&(Z|=0),void 0===ee||"["===ee&&Mf.lastIndex+2===E){Zf(m,void 0===ee?new Tf(Z,t,u):new Yf(Z,t,u));break}{let _e=m.map[Z];void 0===_e&&(_e=new Jf(Z),Zf(m,_e)),m=_e}}}function Bp(t,u){this.seq=[],this.map={};const m=t.getProgramParameter(u,35718);for(let g=0;g<m;++g){const E=t.getActiveUniform(u,g);Am(E,t.getUniformLocation(u,E.name),this)}}function Qf(t,u,m){const g=t.createShader(u);return t.shaderSource(g,m),t.compileShader(g),g}Bp.prototype.setValue=function(t,u,m,g){const E=this.map[u];void 0!==E&&E.setValue(t,m,g)},Bp.prototype.setOptional=function(t,u,m){const g=u[m];void 0!==g&&this.setValue(t,m,g)},Bp.upload=function(t,u,m,g){for(let E=0,I=u.length;E!==I;++E){const V=u[E],Z=m[V.id];!1!==Z.needsUpdate&&V.setValue(t,Z.value,g)}},Bp.seqWithValue=function(t,u){const m=[];for(let g=0,E=t.length;g!==E;++g){const I=t[g];I.id in u&&m.push(I)}return m};let $m=0;function Kf(t){switch(t){case Ki:return["Linear","( value )"];case rl:return["sRGB","( value )"];case Hc:return["RGBE","( value )"];case mc:return["RGBM","( value, 7.0 )"];case qu:return["RGBM","( value, 16.0 )"];case mu:return["RGBD","( value, 256.0 )"];case ql:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Gh:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function em(t,u,m){const g=t.getShaderParameter(u,35713),E=t.getShaderInfoLog(u).trim();return g&&""===E?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+m+"\n"+E+function(I){const V=I.split("\n");for(let Z=0;Z<V.length;Z++)V[Z]=Z+1+": "+V[Z];return V.join("\n")}(t.getShaderSource(u))}function Ud(t,u){const m=Kf(u);return"vec4 "+t+"( vec4 value ) { return "+m[0]+"ToLinear"+m[1]+"; }"}function Cm(t,u){const m=Kf(u);return"vec4 "+t+"( vec4 value ) { return LinearTo"+m[0]+m[1]+"; }"}function Lm(t,u){let m;switch(u){case mi:m="Linear";break;case xo:m="Reinhard";break;case Nr:m="OptimizedCineon";break;case Qr:m="ACESFilmic";break;case Vr:m="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",u),m="Linear"}return"vec3 "+t+"( vec3 color ) { return "+m+"ToneMapping( color ); }"}function zd(t){return""!==t}function yd(t,u){return t.replace(/NUM_DIR_LIGHTS/g,u.numDirLights).replace(/NUM_SPOT_LIGHTS/g,u.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,u.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,u.numPointLights).replace(/NUM_HEMI_LIGHTS/g,u.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,u.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,u.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,u.numPointLightShadows)}function tm(t,u){return t.replace(/NUM_CLIPPING_PLANES/g,u.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,u.numClippingPlanes-u.numClipIntersection)}const jd=/^[ \t]*#include +<([\w\d./]+)>/gm;function Kh(t){return t.replace(jd,Bm)}function Bm(t,u){const m=Dr[u];if(void 0===m)throw new Error("Can not resolve #include <"+u+">");return Kh(m)}const Nm=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Rm=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function nm(t){return t.replace(Rm,Gd).replace(Nm,Pm)}function Pm(t,u,m,g){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Gd(0,u,m,g)}function Gd(t,u,m,g){let E="";for(let I=parseInt(u);I<parseInt(m);I++)E+=g.replace(/\[ i \]/g,"[ "+I+" ]").replace(/UNROLLED_LOOP_INDEX/g,I);return E}function rm(t){let u="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?u+="\n#define HIGH_PRECISION":"mediump"===t.precision?u+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(u+="\n#define LOW_PRECISION"),u}function Im(t,u,m,g){const E=t.getContext(),I=m.defines;let V=m.vertexShader,Z=m.fragmentShader;const J=function(oe){let de="SHADOWMAP_TYPE_BASIC";return oe.shadowMapType===ne?de="SHADOWMAP_TYPE_PCF":oe.shadowMapType===ue?de="SHADOWMAP_TYPE_PCF_SOFT":oe.shadowMapType===me&&(de="SHADOWMAP_TYPE_VSM"),de}(m),ee=function(oe){let de="ENVMAP_TYPE_CUBE";if(oe.envMap)switch(oe.envMapMode){case Ti:case $o:de="ENVMAP_TYPE_CUBE";break;case Oi:case Co:de="ENVMAP_TYPE_CUBE_UV";break;case Hs:case ia:de="ENVMAP_TYPE_EQUIREC"}return de}(m),_e=function(oe){let de="ENVMAP_MODE_REFLECTION";if(oe.envMap)switch(oe.envMapMode){case $o:case ia:case Co:de="ENVMAP_MODE_REFRACTION"}return de}(m),S=function(oe){let de="ENVMAP_BLENDING_NONE";if(oe.envMap)switch(oe.combine){case Zr:de="ENVMAP_BLENDING_MULTIPLY";break;case pi:de="ENVMAP_BLENDING_MIX";break;case tr:de="ENVMAP_BLENDING_ADD"}return de}(m),e=t.gammaFactor>0?t.gammaFactor:1,c=m.isWebGL2?"":[(oe=m).extensionDerivatives||oe.envMapCubeUV||oe.bumpMap||oe.tangentSpaceNormalMap||oe.clearcoatNormalMap||oe.flatShading||"physical"===oe.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(oe.extensionFragDepth||oe.logarithmicDepthBuffer)&&oe.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",oe.extensionDrawBuffers&&oe.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(oe.extensionShaderTextureLOD||oe.envMap)&&oe.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(zd).join("\n"),p=function(oe){const de=[];for(const ve in oe){const Me=oe[ve];!1!==Me&&de.push("#define "+ve+" "+Me)}return de.join("\n")}(I),_=E.createProgram();var oe;let w,L;m.isRawShaderMaterial?(w=[p].filter(zd).join("\n"),w.length>0&&(w+="\n"),L=[c,p].filter(zd).join("\n"),L.length>0&&(L+="\n")):(w=[rm(m),"#define SHADER_NAME "+m.shaderName,p,m.instancing?"#define USE_INSTANCING":"",m.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+e,"#define MAX_BONES "+m.maxBones,m.useFog&&m.fog?"#define USE_FOG":"",m.useFog&&m.fogExp2?"#define FOG_EXP2":"",m.map?"#define USE_MAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+_e:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.normalMap&&m.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",m.normalMap&&m.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",m.clearcoatMap?"#define USE_CLEARCOATMAP":"",m.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",m.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",m.displacementMap&&m.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.transmissionMap?"#define USE_TRANSMISSIONMAP":"",m.vertexTangents?"#define USE_TANGENT":"",m.vertexColors?"#define USE_COLOR":"",m.vertexUvs?"#define USE_UV":"",m.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",m.flatShading?"#define FLAT_SHADED":"",m.skinning?"#define USE_SKINNING":"",m.useVertexTexture?"#define BONE_TEXTURE":"",m.morphTargets?"#define USE_MORPHTARGETS":"",m.morphNormals&&!1===m.flatShading?"#define USE_MORPHNORMALS":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"",m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+J:"",m.sizeAttenuation?"#define USE_SIZEATTENUATION":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&m.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(zd).join("\n"),L=[c,rm(m),"#define SHADER_NAME "+m.shaderName,p,m.alphaTest?"#define ALPHATEST "+m.alphaTest+(m.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+e,m.useFog&&m.fog?"#define USE_FOG":"",m.useFog&&m.fogExp2?"#define FOG_EXP2":"",m.map?"#define USE_MAP":"",m.matcap?"#define USE_MATCAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+ee:"",m.envMap?"#define "+_e:"",m.envMap?"#define "+S:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.normalMap&&m.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",m.normalMap&&m.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",m.clearcoatMap?"#define USE_CLEARCOATMAP":"",m.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",m.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.sheen?"#define USE_SHEEN":"",m.transmissionMap?"#define USE_TRANSMISSIONMAP":"",m.vertexTangents?"#define USE_TANGENT":"",m.vertexColors?"#define USE_COLOR":"",m.vertexUvs?"#define USE_UV":"",m.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",m.gradientMap?"#define USE_GRADIENTMAP":"",m.flatShading?"#define FLAT_SHADED":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"",m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+J:"",m.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",m.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&m.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(m.extensionShaderTextureLOD||m.envMap)&&m.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",m.toneMapping!==mr?"#define TONE_MAPPING":"",m.toneMapping!==mr?Dr.tonemapping_pars_fragment:"",m.toneMapping!==mr?Lm("toneMapping",m.toneMapping):"",m.dithering?"#define DITHERING":"",Dr.encodings_pars_fragment,m.map?Ud("mapTexelToLinear",m.mapEncoding):"",m.matcap?Ud("matcapTexelToLinear",m.matcapEncoding):"",m.envMap?Ud("envMapTexelToLinear",m.envMapEncoding):"",m.emissiveMap?Ud("emissiveMapTexelToLinear",m.emissiveMapEncoding):"",m.lightMap?Ud("lightMapTexelToLinear",m.lightMapEncoding):"",Cm("linearToOutputTexel",m.outputEncoding),m.depthPacking?"#define DEPTH_PACKING "+m.depthPacking:"","\n"].filter(zd).join("\n")),V=Kh(V),V=yd(V,m),V=tm(V,m),Z=Kh(Z),Z=yd(Z,m),Z=tm(Z,m),V=nm(V),Z=nm(Z),m.isWebGL2&&!m.isRawShaderMaterial&&(w=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+w,L=["#version 300 es\n","#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+L);const O=L+Z,F=Qf(E,35633,w+V),U=Qf(E,35632,O);if(E.attachShader(_,F),E.attachShader(_,U),void 0!==m.index0AttributeName?E.bindAttribLocation(_,0,m.index0AttributeName):!0===m.morphTargets&&E.bindAttribLocation(_,0,"position"),E.linkProgram(_),t.debug.checkShaderErrors){const oe=E.getProgramInfoLog(_).trim(),de=E.getShaderInfoLog(F).trim(),ve=E.getShaderInfoLog(U).trim();let Me=!0,Be=!0;if(!1===E.getProgramParameter(_,35714)){Me=!1;const Ae=em(E,F,"vertex"),ke=em(E,U,"fragment");console.error("THREE.WebGLProgram: shader error: ",E.getError(),"35715",E.getProgramParameter(_,35715),"gl.getProgramInfoLog",oe,Ae,ke)}else""!==oe?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",oe):""!==de&&""!==ve||(Be=!1);Be&&(this.diagnostics={runnable:Me,programLog:oe,vertexShader:{log:de,prefix:w},fragmentShader:{log:ve,prefix:L}})}let te,ce;return E.deleteShader(F),E.deleteShader(U),this.getUniforms=function(){return void 0===te&&(te=new Bp(E,_)),te},this.getAttributes=function(){return void 0===ce&&(ce=function(oe,de){const ve={},Me=oe.getProgramParameter(de,35721);for(let Be=0;Be<Me;Be++){const Ae=oe.getActiveAttrib(de,Be).name;ve[Ae]=oe.getAttribLocation(de,Ae)}return ve}(E,_)),ce},this.destroy=function(){g.releaseStatesOfProgram(this),E.deleteProgram(_),this.program=void 0},this.name=m.shaderName,this.id=$m++,this.cacheKey=u,this.usedTimes=1,this.program=_,this.vertexShader=F,this.fragmentShader=U,this}function $c(t,u,m,g){const E=[],I=m.isWebGL2,V=m.logarithmicDepthBuffer,Z=m.floatVertexTextures,J=m.maxVertexUniforms,ee=m.vertexTextures;let _e=m.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},e=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function c(p){let _;return p?p.isTexture?_=p.encoding:p.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),_=p.texture.encoding):_=Ki,_}return{getParameters:function(p,_,w,L,O,F,U){const te=L.fog,oe=p.envMap||(p.isMeshStandardMaterial?L.environment:null),de=S[p.type],ve=U.isSkinnedMesh?function(ke){const Je=ke.skeleton.bones;if(Z)return 1024;{const rt=Math.floor((J-20)/4),nt=Math.min(rt,Je.length);return nt<Je.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Je.length+" bones. This GPU supports "+nt+"."),0):nt}}(U):0;let Me,Be;if(null!==p.precision&&(_e=m.getMaxPrecision(p.precision),_e!==p.precision&&console.warn("THREE.WebGLProgram.getParameters:",p.precision,"not supported, using",_e,"instead.")),de){const ke=Ac[de];Me=ke.vertexShader,Be=ke.fragmentShader}else Me=p.vertexShader,Be=p.fragmentShader;const Ae=t.getRenderTarget();return{isWebGL2:I,shaderID:de,shaderName:p.type,vertexShader:Me,fragmentShader:Be,defines:p.defines,isRawShaderMaterial:p.isRawShaderMaterial,isShaderMaterial:p.isShaderMaterial,precision:_e,instancing:!0===U.isInstancedMesh,supportsVertexTextures:ee,outputEncoding:null!==Ae?c(Ae.texture):t.outputEncoding,map:!!p.map,mapEncoding:c(p.map),matcap:!!p.matcap,matcapEncoding:c(p.matcap),envMap:!!oe,envMapMode:oe&&oe.mapping,envMapEncoding:c(oe),envMapCubeUV:!!oe&&(oe.mapping===Oi||oe.mapping===Co),lightMap:!!p.lightMap,lightMapEncoding:c(p.lightMap),aoMap:!!p.aoMap,emissiveMap:!!p.emissiveMap,emissiveMapEncoding:c(p.emissiveMap),bumpMap:!!p.bumpMap,normalMap:!!p.normalMap,objectSpaceNormalMap:p.normalMapType===Ce,tangentSpaceNormalMap:p.normalMapType===Ee,clearcoatMap:!!p.clearcoatMap,clearcoatRoughnessMap:!!p.clearcoatRoughnessMap,clearcoatNormalMap:!!p.clearcoatNormalMap,displacementMap:!!p.displacementMap,roughnessMap:!!p.roughnessMap,metalnessMap:!!p.metalnessMap,specularMap:!!p.specularMap,alphaMap:!!p.alphaMap,gradientMap:!!p.gradientMap,sheen:!!p.sheen,transmissionMap:!!p.transmissionMap,combine:p.combine,vertexTangents:p.normalMap&&p.vertexTangents,vertexColors:p.vertexColors,vertexUvs:!!(p.map||p.bumpMap||p.normalMap||p.specularMap||p.alphaMap||p.emissiveMap||p.roughnessMap||p.metalnessMap||p.clearcoatMap||p.clearcoatRoughnessMap||p.clearcoatNormalMap||p.displacementMap||p.transmissionMap),uvsVertexOnly:!(p.map||p.bumpMap||p.normalMap||p.specularMap||p.alphaMap||p.emissiveMap||p.roughnessMap||p.metalnessMap||p.clearcoatNormalMap||p.transmissionMap||!p.displacementMap),fog:!!te,useFog:p.fog,fogExp2:te&&te.isFogExp2,flatShading:p.flatShading,sizeAttenuation:p.sizeAttenuation,logarithmicDepthBuffer:V,skinning:p.skinning&&ve>0,maxBones:ve,useVertexTexture:Z,morphTargets:p.morphTargets,morphNormals:p.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:_.directional.length,numPointLights:_.point.length,numSpotLights:_.spot.length,numRectAreaLights:_.rectArea.length,numHemiLights:_.hemi.length,numDirLightShadows:_.directionalShadowMap.length,numPointLightShadows:_.pointShadowMap.length,numSpotLightShadows:_.spotShadowMap.length,numClippingPlanes:O,numClipIntersection:F,dithering:p.dithering,shadowMapEnabled:t.shadowMap.enabled&&w.length>0,shadowMapType:t.shadowMap.type,toneMapping:p.toneMapped?t.toneMapping:mr,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:p.premultipliedAlpha,alphaTest:p.alphaTest,doubleSided:p.side===Q,flipSided:p.side===W,depthPacking:void 0!==p.depthPacking&&p.depthPacking,index0AttributeName:p.index0AttributeName,extensionDerivatives:p.extensions&&p.extensions.derivatives,extensionFragDepth:p.extensions&&p.extensions.fragDepth,extensionDrawBuffers:p.extensions&&p.extensions.drawBuffers,extensionShaderTextureLOD:p.extensions&&p.extensions.shaderTextureLOD,rendererExtensionFragDepth:I||null!==u.get("EXT_frag_depth"),rendererExtensionDrawBuffers:I||null!==u.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:I||null!==u.get("EXT_shader_texture_lod"),customProgramCacheKey:p.customProgramCacheKey()}},getProgramCacheKey:function(p){const _=[];if(p.shaderID?_.push(p.shaderID):(_.push(p.fragmentShader),_.push(p.vertexShader)),void 0!==p.defines)for(const w in p.defines)_.push(w),_.push(p.defines[w]);if(void 0===p.isRawShaderMaterial){for(let w=0;w<e.length;w++)_.push(p[e[w]]);_.push(t.outputEncoding),_.push(t.gammaFactor)}return _.push(p.customProgramCacheKey),_.join()},getUniforms:function(p){const _=S[p.type];let w;return w=_?ko.clone(Ac[_].uniforms):p.uniforms,w},acquireProgram:function(p,_){let w;for(let L=0,O=E.length;L<O;L++){const F=E[L];if(F.cacheKey===_){w=F,++w.usedTimes;break}}return void 0===w&&(w=new Im(t,_,p,g),E.push(w)),w},releaseProgram:function(p){if(0==--p.usedTimes){const _=E.indexOf(p);E[_]=E[E.length-1],E.pop(),p.destroy()}},programs:E}}function Af(){let t=new WeakMap;return{get:function(u){let m=t.get(u);return void 0===m&&(m={},t.set(u,m)),m},remove:function(u){t.delete(u)},update:function(u,m,g){t.get(u)[m]=g},dispose:function(){t=new WeakMap}}}function im(t,u){return t.groupOrder!==u.groupOrder?t.groupOrder-u.groupOrder:t.renderOrder!==u.renderOrder?t.renderOrder-u.renderOrder:t.program!==u.program?t.program.id-u.program.id:t.material.id!==u.material.id?t.material.id-u.material.id:t.z!==u.z?t.z-u.z:t.id-u.id}function om(t,u){return t.groupOrder!==u.groupOrder?t.groupOrder-u.groupOrder:t.renderOrder!==u.renderOrder?t.renderOrder-u.renderOrder:t.z!==u.z?u.z-t.z:t.id-u.id}function cf(t){const u=[];let m=0;const g=[],E=[],I={id:-1};function V(Z,J,ee,_e,S,e){let c=u[m];const p=t.get(ee);return void 0===c?(c={id:Z.id,object:Z,geometry:J,material:ee,program:p.program||I,groupOrder:_e,renderOrder:Z.renderOrder,z:S,group:e},u[m]=c):(c.id=Z.id,c.object=Z,c.geometry=J,c.material=ee,c.program=p.program||I,c.groupOrder=_e,c.renderOrder=Z.renderOrder,c.z=S,c.group=e),m++,c}return{opaque:g,transparent:E,init:function(){m=0,g.length=0,E.length=0},push:function(Z,J,ee,_e,S,e){const c=V(Z,J,ee,_e,S,e);(!0===ee.transparent?E:g).push(c)},unshift:function(Z,J,ee,_e,S,e){const c=V(Z,J,ee,_e,S,e);(!0===ee.transparent?E:g).unshift(c)},finish:function(){for(let Z=m,J=u.length;Z<J;Z++){const ee=u[Z];if(null===ee.id)break;ee.id=null,ee.object=null,ee.geometry=null,ee.material=null,ee.program=null,ee.group=null}},sort:function(Z,J){g.length>1&&g.sort(Z||im),E.length>1&&E.sort(J||om)}}}function Om(t){let u=new WeakMap;function m(g){const E=g.target;E.removeEventListener("dispose",m),u.delete(E)}return{get:function(g,E){const I=u.get(g);let V;return void 0===I?(V=new cf(t),u.set(g,new WeakMap),u.get(g).set(E,V),g.addEventListener("dispose",m)):(V=I.get(E),void 0===V&&(V=new cf(t),I.set(E,V))),V},dispose:function(){u=new WeakMap}}}function sm(){const t={};return{get:function(u){if(void 0!==t[u.id])return t[u.id];let m;switch(u.type){case"DirectionalLight":m={direction:new ot,color:new or};break;case"SpotLight":m={position:new ot,direction:new ot,color:new or,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":m={position:new ot,color:new or,distance:0,decay:0};break;case"HemisphereLight":m={direction:new ot,skyColor:new or,groundColor:new or};break;case"RectAreaLight":m={color:new or,position:new ot,halfWidth:new ot,halfHeight:new ot}}return t[u.id]=m,m}}}let km=0;function $f(t,u){return(u.castShadow?1:0)-(t.castShadow?1:0)}function am(){const t=new sm,u=function(){const V={};return{get:function(Z){if(void 0!==V[Z.id])return V[Z.id];let J;switch(Z.type){case"DirectionalLight":case"SpotLight":J={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Sn};break;case"PointLight":J={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Sn,shadowCameraNear:1,shadowCameraFar:1e3}}return V[Z.id]=J,J}}}(),m={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let V=0;V<9;V++)m.probe.push(new ot);const g=new ot,E=new ni,I=new ni;return{setup:function(V,Z,J){let ee=0,_e=0,S=0;for(let ce=0;ce<9;ce++)m.probe[ce].set(0,0,0);let e=0,c=0,p=0,_=0,w=0,L=0,O=0,F=0;const U=J.matrixWorldInverse;V.sort($f);for(let ce=0,oe=V.length;ce<oe;ce++){const de=V[ce],ve=de.color,Me=de.intensity,Be=de.distance,Ae=de.shadow&&de.shadow.map?de.shadow.map.texture:null;if(de.isAmbientLight)ee+=ve.r*Me,_e+=ve.g*Me,S+=ve.b*Me;else if(de.isLightProbe)for(let ke=0;ke<9;ke++)m.probe[ke].addScaledVector(de.sh.coefficients[ke],Me);else if(de.isDirectionalLight){const ke=t.get(de);if(ke.color.copy(de.color).multiplyScalar(de.intensity),ke.direction.setFromMatrixPosition(de.matrixWorld),g.setFromMatrixPosition(de.target.matrixWorld),ke.direction.sub(g),ke.direction.transformDirection(U),de.castShadow){const Je=de.shadow,We=u.get(de);We.shadowBias=Je.bias,We.shadowNormalBias=Je.normalBias,We.shadowRadius=Je.radius,We.shadowMapSize=Je.mapSize,m.directionalShadow[e]=We,m.directionalShadowMap[e]=Ae,m.directionalShadowMatrix[e]=de.shadow.matrix,L++}m.directional[e]=ke,e++}else if(de.isSpotLight){const ke=t.get(de);if(ke.position.setFromMatrixPosition(de.matrixWorld),ke.position.applyMatrix4(U),ke.color.copy(ve).multiplyScalar(Me),ke.distance=Be,ke.direction.setFromMatrixPosition(de.matrixWorld),g.setFromMatrixPosition(de.target.matrixWorld),ke.direction.sub(g),ke.direction.transformDirection(U),ke.coneCos=Math.cos(de.angle),ke.penumbraCos=Math.cos(de.angle*(1-de.penumbra)),ke.decay=de.decay,de.castShadow){const Je=de.shadow,We=u.get(de);We.shadowBias=Je.bias,We.shadowNormalBias=Je.normalBias,We.shadowRadius=Je.radius,We.shadowMapSize=Je.mapSize,m.spotShadow[p]=We,m.spotShadowMap[p]=Ae,m.spotShadowMatrix[p]=de.shadow.matrix,F++}m.spot[p]=ke,p++}else if(de.isRectAreaLight){const ke=t.get(de);ke.color.copy(ve).multiplyScalar(Me),ke.position.setFromMatrixPosition(de.matrixWorld),ke.position.applyMatrix4(U),I.identity(),E.copy(de.matrixWorld),E.premultiply(U),I.extractRotation(E),ke.halfWidth.set(.5*de.width,0,0),ke.halfHeight.set(0,.5*de.height,0),ke.halfWidth.applyMatrix4(I),ke.halfHeight.applyMatrix4(I),m.rectArea[_]=ke,_++}else if(de.isPointLight){const ke=t.get(de);if(ke.position.setFromMatrixPosition(de.matrixWorld),ke.position.applyMatrix4(U),ke.color.copy(de.color).multiplyScalar(de.intensity),ke.distance=de.distance,ke.decay=de.decay,de.castShadow){const Je=de.shadow,We=u.get(de);We.shadowBias=Je.bias,We.shadowNormalBias=Je.normalBias,We.shadowRadius=Je.radius,We.shadowMapSize=Je.mapSize,We.shadowCameraNear=Je.camera.near,We.shadowCameraFar=Je.camera.far,m.pointShadow[c]=We,m.pointShadowMap[c]=Ae,m.pointShadowMatrix[c]=de.shadow.matrix,O++}m.point[c]=ke,c++}else if(de.isHemisphereLight){const ke=t.get(de);ke.direction.setFromMatrixPosition(de.matrixWorld),ke.direction.transformDirection(U),ke.direction.normalize(),ke.skyColor.copy(de.color).multiplyScalar(Me),ke.groundColor.copy(de.groundColor).multiplyScalar(Me),m.hemi[w]=ke,w++}}m.ambient[0]=ee,m.ambient[1]=_e,m.ambient[2]=S;const te=m.hash;te.directionalLength===e&&te.pointLength===c&&te.spotLength===p&&te.rectAreaLength===_&&te.hemiLength===w&&te.numDirectionalShadows===L&&te.numPointShadows===O&&te.numSpotShadows===F||(m.directional.length=e,m.spot.length=p,m.rectArea.length=_,m.point.length=c,m.hemi.length=w,m.directionalShadow.length=L,m.directionalShadowMap.length=L,m.pointShadow.length=O,m.pointShadowMap.length=O,m.spotShadow.length=F,m.spotShadowMap.length=F,m.directionalShadowMatrix.length=L,m.pointShadowMatrix.length=O,m.spotShadowMatrix.length=F,te.directionalLength=e,te.pointLength=c,te.spotLength=p,te.rectAreaLength=_,te.hemiLength=w,te.numDirectionalShadows=L,te.numPointShadows=O,te.numSpotShadows=F,m.version=km++)},state:m}}function Hd(){const t=new am,u=[],m=[];return{init:function(){u.length=0,m.length=0},state:{lightsArray:u,shadowsArray:m,lights:t},setupLights:function(g){t.setup(u,m,g)},pushLight:function(g){u.push(g)},pushShadow:function(g){m.push(g)}}}function bd(){let t=new WeakMap;function u(m){const g=m.target;g.removeEventListener("dispose",u),t.delete(g)}return{get:function(m,g){let E;return!1===t.has(m)?(E=new Hd,t.set(m,new WeakMap),t.get(m).set(g,E),m.addEventListener("dispose",u)):!1===t.get(m).has(g)?(E=new Hd,t.get(m).set(g,E)):E=t.get(m).get(g),E},dispose:function(){t=new WeakMap}}}function ep(t){zr.call(this),this.type="MeshDepthMaterial",this.depthPacking=q,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function $a(t){zr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new ot,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}(ep.prototype=Object.create(zr.prototype)).constructor=ep,ep.prototype.isMeshDepthMaterial=!0,ep.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},($a.prototype=Object.create(zr.prototype)).constructor=$a,$a.prototype.isMeshDistanceMaterial=!0,$a.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};var Nl="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",Kl="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function Np(t,u,m){let g=new Yc;const E=new Sn,I=new Sn,V=new bi,Z=[],J=[],ee={},_e={0:W,1:ie,2:Q},S=new go({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Sn},radius:{value:4}},vertexShader:Kl,fragmentShader:Nl}),e=S.clone();e.defines.HORIZONAL_PASS=1;const c=new pn;c.setAttribute("position",new Hr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new Li(c,S),_=this;function w(te,ce){const oe=u.update(p);S.uniforms.shadow_pass.value=te.map.texture,S.uniforms.resolution.value=te.mapSize,S.uniforms.radius.value=te.radius,t.setRenderTarget(te.mapPass),t.clear(),t.renderBufferDirect(ce,null,oe,S,p,null),e.uniforms.shadow_pass.value=te.mapPass.texture,e.uniforms.resolution.value=te.mapSize,e.uniforms.radius.value=te.radius,t.setRenderTarget(te.map),t.clear(),t.renderBufferDirect(ce,null,oe,e,p,null)}function L(te,ce,oe){const de=te|ce<<1|oe<<2;let ve=Z[de];return void 0===ve&&(ve=new ep({depthPacking:pe,morphTargets:te,skinning:ce}),Z[de]=ve),ve}function O(te,ce,oe){const de=te|ce<<1|oe<<2;let ve=J[de];return void 0===ve&&(ve=new $a({morphTargets:te,skinning:ce}),J[de]=ve),ve}function F(te,ce,oe,de,ve,Me,Be){let Ae=null,ke=L,Je=te.customDepthMaterial;if(!0===de.isPointLight&&(ke=O,Je=te.customDistanceMaterial),void 0===Je){let We=!1;!0===oe.morphTargets&&(We=ce.morphAttributes&&ce.morphAttributes.position&&ce.morphAttributes.position.length>0);let rt=!1;!0===te.isSkinnedMesh&&(!0===oe.skinning?rt=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",te)),Ae=ke(We,rt,!0===te.isInstancedMesh)}else Ae=Je;if(t.localClippingEnabled&&!0===oe.clipShadows&&0!==oe.clippingPlanes.length){const We=Ae.uuid,rt=oe.uuid;let nt=ee[We];void 0===nt&&(nt={},ee[We]=nt);let gt=nt[rt];void 0===gt&&(gt=Ae.clone(),nt[rt]=gt),Ae=gt}return Ae.visible=oe.visible,Ae.wireframe=oe.wireframe,Ae.side=Be===me?null!==oe.shadowSide?oe.shadowSide:oe.side:null!==oe.shadowSide?oe.shadowSide:_e[oe.side],Ae.clipShadows=oe.clipShadows,Ae.clippingPlanes=oe.clippingPlanes,Ae.clipIntersection=oe.clipIntersection,Ae.wireframeLinewidth=oe.wireframeLinewidth,Ae.linewidth=oe.linewidth,!0===de.isPointLight&&!0===Ae.isMeshDistanceMaterial&&(Ae.referencePosition.setFromMatrixPosition(de.matrixWorld),Ae.nearDistance=ve,Ae.farDistance=Me),Ae}function U(te,ce,oe,de,ve){if(!1===te.visible)return;if(te.layers.test(ce.layers)&&(te.isMesh||te.isLine||te.isPoints)&&(te.castShadow||te.receiveShadow&&ve===me)&&(!te.frustumCulled||g.intersectsObject(te))){te.modelViewMatrix.multiplyMatrices(oe.matrixWorldInverse,te.matrixWorld);const Be=u.update(te),Ae=te.material;if(Array.isArray(Ae)){const ke=Be.groups;for(let Je=0,We=ke.length;Je<We;Je++){const rt=ke[Je],nt=Ae[rt.materialIndex];if(nt&&nt.visible){const gt=F(te,Be,nt,de,oe.near,oe.far,ve);t.renderBufferDirect(oe,null,Be,gt,te,rt)}}}else if(Ae.visible){const ke=F(te,Be,Ae,de,oe.near,oe.far,ve);t.renderBufferDirect(oe,null,Be,ke,te,null)}}const Me=te.children;for(let Be=0,Ae=Me.length;Be<Ae;Be++)U(Me[Be],ce,oe,de,ve)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ne,this.render=function(te,ce,oe){if(!1===_.enabled||!1===_.autoUpdate&&!1===_.needsUpdate||0===te.length)return;const de=t.getRenderTarget(),ve=t.getActiveCubeFace(),Me=t.getActiveMipmapLevel(),Be=t.state;Be.setBlending(X),Be.buffers.color.setClear(1,1,1,1),Be.buffers.depth.setTest(!0),Be.setScissorTest(!1);for(let Ae=0,ke=te.length;Ae<ke;Ae++){const Je=te[Ae],We=Je.shadow;if(!1===We.autoUpdate&&!1===We.needsUpdate)continue;if(void 0===We){console.warn("THREE.WebGLShadowMap:",Je,"has no shadow.");continue}E.copy(We.mapSize);const rt=We.getFrameExtents();if(E.multiply(rt),I.copy(We.mapSize),(E.x>m||E.y>m)&&(E.x>m&&(I.x=Math.floor(m/rt.x),E.x=I.x*rt.x,We.mapSize.x=I.x),E.y>m&&(I.y=Math.floor(m/rt.y),E.y=I.y*rt.y,We.mapSize.y=I.y)),null===We.map&&!We.isPointLightShadow&&this.type===me){const gt={minFilter:ai,magFilter:ai,format:mo,stencilBuffer:!1};We.map=new ks(E.x,E.y,gt),We.map.texture.name=Je.name+".shadowMap",We.mapPass=new ks(E.x,E.y,gt),We.camera.updateProjectionMatrix()}null===We.map&&(We.map=new ks(E.x,E.y,{minFilter:Or,magFilter:Or,format:mo,stencilBuffer:!1}),We.map.texture.name=Je.name+".shadowMap",We.camera.updateProjectionMatrix()),t.setRenderTarget(We.map),t.clear();const nt=We.getViewportCount();for(let gt=0;gt<nt;gt++){const xt=We.getViewport(gt);V.set(I.x*xt.x,I.y*xt.y,I.x*xt.z,I.y*xt.w),Be.viewport(V),We.updateMatrices(Je,gt),g=We.getFrustum(),U(ce,oe,We.camera,Je,this.type)}We.isPointLightShadow||this.type!==me||w(We,oe),We.needsUpdate=!1}_.needsUpdate=!1,t.setRenderTarget(de,ve,Me)}}function ec(t,u,m){const g=m.isWebGL2,E=new function(){let lt=!1;const Jt=new bi;let St=null;const jt=new bi(0,0,0,0);return{setMask:function(It){St===It||lt||(t.colorMask(It,It,It,It),St=It)},setLocked:function(It){lt=It},setClear:function(It,ln,Ze,st,Pt){!0===Pt&&(It*=st,ln*=st,Ze*=st),Jt.set(It,ln,Ze,st),!1===jt.equals(Jt)&&(t.clearColor(It,ln,Ze,st),jt.copy(Jt))},reset:function(){lt=!1,St=null,jt.set(-1,0,0,0)}}},I=new function(){let lt=!1,Jt=null,St=null,jt=null;return{setTest:function(It){It?nt(2929):gt(2929)},setMask:function(It){Jt===It||lt||(t.depthMask(It),Jt=It)},setFunc:function(It){if(St!==It){if(It)switch(It){case On:t.depthFunc(512);break;case $n:t.depthFunc(519);break;case _n:t.depthFunc(513);break;case ar:t.depthFunc(515);break;case nr:t.depthFunc(514);break;case lr:t.depthFunc(518);break;case rr:t.depthFunc(516);break;case ti:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);St=It}},setLocked:function(It){lt=It},setClear:function(It){jt!==It&&(t.clearDepth(It),jt=It)},reset:function(){lt=!1,Jt=null,St=null,jt=null}}},V=new function(){let lt=!1,Jt=null,St=null,jt=null,It=null,ln=null,Ze=null,st=null,Pt=null;return{setTest:function(Gt){lt||(Gt?nt(2960):gt(2960))},setMask:function(Gt){Jt===Gt||lt||(t.stencilMask(Gt),Jt=Gt)},setFunc:function(Gt,tn,Mn){St===Gt&&jt===tn&&It===Mn||(t.stencilFunc(Gt,tn,Mn),St=Gt,jt=tn,It=Mn)},setOp:function(Gt,tn,Mn){ln===Gt&&Ze===tn&&st===Mn||(t.stencilOp(Gt,tn,Mn),ln=Gt,Ze=tn,st=Mn)},setLocked:function(Gt){lt=Gt},setClear:function(Gt){Pt!==Gt&&(t.clearStencil(Gt),Pt=Gt)},reset:function(){lt=!1,Jt=null,St=null,jt=null,It=null,ln=null,Ze=null,st=null,Pt=null}}};let Z={},J=null,ee=null,_e=null,S=null,e=null,c=null,p=null,_=null,w=null,L=!1,O=null,F=null,U=null,te=null,ce=null;const oe=t.getParameter(35661);let de=!1,ve=0;const Me=t.getParameter(7938);-1!==Me.indexOf("WebGL")?(ve=parseFloat(/^WebGL\ ([0-9])/.exec(Me)[1]),de=ve>=1):-1!==Me.indexOf("OpenGL ES")&&(ve=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Me)[1]),de=ve>=2);let Be=null,Ae={};const ke=new bi,Je=new bi;function We(lt,Jt,St){const jt=new Uint8Array(4),It=t.createTexture();t.bindTexture(lt,It),t.texParameteri(lt,10241,9728),t.texParameteri(lt,10240,9728);for(let ln=0;ln<St;ln++)t.texImage2D(Jt+ln,0,6408,1,1,0,6408,5121,jt);return It}const rt={};function nt(lt){!0!==Z[lt]&&(t.enable(lt),Z[lt]=!0)}function gt(lt){!1!==Z[lt]&&(t.disable(lt),Z[lt]=!1)}rt[3553]=We(3553,3553,1),rt[34067]=We(34067,34069,6),E.setClear(0,0,0,1),I.setClear(1),V.setClear(0),nt(2929),I.setFunc(ar),Ye(!1),pt(M),nt(2884),Ht(X);const xt={[Ne]:32774,[je]:32778,[Te]:32779};if(g)xt[qe]=32775,xt[Ke]=32776;else{const lt=u.get("EXT_blend_minmax");null!==lt&&(xt[qe]=lt.MIN_EXT,xt[Ke]=lt.MAX_EXT)}const Ut={[vt]:0,[ht]:1,[Bt]:768,[Ft]:770,[fn]:776,[An]:774,[on]:772,[wt]:769,[Ot]:771,[Cn]:775,[ft]:773};function Ht(lt,Jt,St,jt,It,ln,Ze,st){if(lt!==X){if(ee||(nt(3042),ee=!0),lt===be)It=It||Jt,ln=ln||St,Ze=Ze||jt,Jt===S&&It===p||(t.blendEquationSeparate(xt[Jt],xt[It]),S=Jt,p=It),St===e&&jt===c&&ln===_&&Ze===w||(t.blendFuncSeparate(Ut[St],Ut[jt],Ut[ln],Ut[Ze]),e=St,c=jt,_=ln,w=Ze),_e=lt,L=null;else if(lt!==_e||st!==L){if(S===Ne&&p===Ne||(t.blendEquation(32774),S=Ne,p=Ne),st)switch(lt){case he:t.blendFuncSeparate(1,771,1,771);break;case z:t.blendFunc(1,1);break;case Le:t.blendFuncSeparate(0,0,769,771);break;case K:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",lt)}else switch(lt){case he:t.blendFuncSeparate(770,771,1,771);break;case z:t.blendFunc(770,1);break;case Le:t.blendFunc(0,769);break;case K:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",lt)}e=null,c=null,_=null,w=null,_e=lt,L=st}}else ee&&(gt(3042),ee=!1)}function Ye(lt){O!==lt&&(t.frontFace(lt?2304:2305),O=lt)}function pt(lt){lt!==G?(nt(2884),lt!==F&&t.cullFace(lt===M?1029:lt===P?1028:1032)):gt(2884),F=lt}function Vt(lt,Jt,St){lt?(nt(32823),te===Jt&&ce===St||(t.polygonOffset(Jt,St),te=Jt,ce=St)):gt(32823)}function Rt(lt){void 0===lt&&(lt=33984+oe-1),Be!==lt&&(t.activeTexture(lt),Be=lt)}return{buffers:{color:E,depth:I,stencil:V},enable:nt,disable:gt,useProgram:function(lt){return J!==lt&&(t.useProgram(lt),J=lt,!0)},setBlending:Ht,setMaterial:function(lt,Jt){lt.side===Q?gt(2884):nt(2884);let St=lt.side===W;Jt&&(St=!St),Ye(St),lt.blending===he&&!1===lt.transparent?Ht(X):Ht(lt.blending,lt.blendEquation,lt.blendSrc,lt.blendDst,lt.blendEquationAlpha,lt.blendSrcAlpha,lt.blendDstAlpha,lt.premultipliedAlpha),I.setFunc(lt.depthFunc),I.setTest(lt.depthTest),I.setMask(lt.depthWrite),E.setMask(lt.colorWrite);const jt=lt.stencilWrite;V.setTest(jt),jt&&(V.setMask(lt.stencilWriteMask),V.setFunc(lt.stencilFunc,lt.stencilRef,lt.stencilFuncMask),V.setOp(lt.stencilFail,lt.stencilZFail,lt.stencilZPass)),Vt(lt.polygonOffset,lt.polygonOffsetFactor,lt.polygonOffsetUnits)},setFlipSided:Ye,setCullFace:pt,setLineWidth:function(lt){lt!==U&&(de&&t.lineWidth(lt),U=lt)},setPolygonOffset:Vt,setScissorTest:function(lt){lt?nt(3089):gt(3089)},activeTexture:Rt,bindTexture:function(lt,Jt){null===Be&&Rt();let St=Ae[Be];void 0===St&&(St={type:void 0,texture:void 0},Ae[Be]=St),St.type===lt&&St.texture===Jt||(t.bindTexture(lt,Jt||rt[lt]),St.type=lt,St.texture=Jt)},unbindTexture:function(){const lt=Ae[Be];void 0!==lt&&void 0!==lt.type&&(t.bindTexture(lt.type,null),lt.type=void 0,lt.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(lt){console.error("THREE.WebGLState:",lt)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(lt){console.error("THREE.WebGLState:",lt)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(lt){console.error("THREE.WebGLState:",lt)}},scissor:function(lt){!1===ke.equals(lt)&&(t.scissor(lt.x,lt.y,lt.z,lt.w),ke.copy(lt))},viewport:function(lt){!1===Je.equals(lt)&&(t.viewport(lt.x,lt.y,lt.z,lt.w),Je.copy(lt))},reset:function(){Z={},Be=null,Ae={},J=null,_e=null,O=null,F=null,E.reset(),I.reset(),V.reset()}}}function Jp(t,u,m,g,E,I,V){const Z=E.isWebGL2,J=E.maxTextures,ee=E.maxCubemapSize,_e=E.maxTextureSize,S=E.maxSamples,e=new WeakMap;let c,p=!1;try{p=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function _(Ye,pt){return p?new OffscreenCanvas(Ye,pt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function w(Ye,pt,Vt,Rt){let lt=1;if((Ye.width>Rt||Ye.height>Rt)&&(lt=Rt/Math.max(Ye.width,Ye.height)),lt<1||!0===pt){if(typeof HTMLImageElement<"u"&&Ye instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ye instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ye instanceof ImageBitmap){const Jt=pt?er.floorPowerOfTwo:Math.floor,St=Jt(lt*Ye.width),jt=Jt(lt*Ye.height);void 0===c&&(c=_(St,jt));const It=Vt?_(St,jt):c;return It.width=St,It.height=jt,It.getContext("2d").drawImage(Ye,0,0,St,jt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ye.width+"x"+Ye.height+") to ("+St+"x"+jt+")."),It}return"data"in Ye&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ye.width+"x"+Ye.height+")."),Ye}return Ye}function L(Ye){return er.isPowerOfTwo(Ye.width)&&er.isPowerOfTwo(Ye.height)}function O(Ye,pt){return Ye.generateMipmaps&&pt&&Ye.minFilter!==Or&&Ye.minFilter!==ai}function F(Ye,pt,Vt,Rt){t.generateMipmap(Ye),g.get(pt).__maxMipLevel=Math.log(Math.max(Vt,Rt))*Math.LOG2E}function U(Ye,pt,Vt){if(!1===Z)return pt;if(null!==Ye){if(void 0!==t[Ye])return t[Ye];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ye+"'")}let Rt=pt;return 6403===pt&&(5126===Vt&&(Rt=33326),5131===Vt&&(Rt=33325),5121===Vt&&(Rt=33321)),6407===pt&&(5126===Vt&&(Rt=34837),5131===Vt&&(Rt=34843),5121===Vt&&(Rt=32849)),6408===pt&&(5126===Vt&&(Rt=34836),5131===Vt&&(Rt=34842),5121===Vt&&(Rt=32856)),33325!==Rt&&33326!==Rt&&34842!==Rt&&34836!==Rt||u.get("EXT_color_buffer_float"),Rt}function te(Ye){return Ye===Or||Ye===Oa||Ye===fs?9728:9729}function ce(Ye){const pt=Ye.target;pt.removeEventListener("dispose",ce),function(Vt){const Rt=g.get(Vt);void 0!==Rt.__webglInit&&(t.deleteTexture(Rt.__webglTexture),g.remove(Vt))}(pt),pt.isVideoTexture&&e.delete(pt),V.memory.textures--}function oe(Ye){const pt=Ye.target;pt.removeEventListener("dispose",oe),function(Vt){const Rt=g.get(Vt),lt=g.get(Vt.texture);if(Vt){if(void 0!==lt.__webglTexture&&t.deleteTexture(lt.__webglTexture),Vt.depthTexture&&Vt.depthTexture.dispose(),Vt.isWebGLCubeRenderTarget)for(let Jt=0;Jt<6;Jt++)t.deleteFramebuffer(Rt.__webglFramebuffer[Jt]),Rt.__webglDepthbuffer&&t.deleteRenderbuffer(Rt.__webglDepthbuffer[Jt]);else t.deleteFramebuffer(Rt.__webglFramebuffer),Rt.__webglDepthbuffer&&t.deleteRenderbuffer(Rt.__webglDepthbuffer),Rt.__webglMultisampledFramebuffer&&t.deleteFramebuffer(Rt.__webglMultisampledFramebuffer),Rt.__webglColorRenderbuffer&&t.deleteRenderbuffer(Rt.__webglColorRenderbuffer),Rt.__webglDepthRenderbuffer&&t.deleteRenderbuffer(Rt.__webglDepthRenderbuffer);g.remove(Vt.texture),g.remove(Vt)}}(pt),V.memory.textures--}let de=0;function ve(Ye,pt){const Vt=g.get(Ye);if(Ye.isVideoTexture&&function(Rt){const lt=V.render.frame;e.get(Rt)!==lt&&(e.set(Rt,lt),Rt.update())}(Ye),Ye.version>0&&Vt.__version!==Ye.version){const Rt=Ye.image;if(void 0===Rt)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==Rt.complete)return void rt(Vt,Ye,pt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}m.activeTexture(33984+pt),m.bindTexture(3553,Vt.__webglTexture)}function Me(Ye,pt){if(6!==Ye.image.length)return;const Vt=g.get(Ye);if(Ye.version>0&&Vt.__version!==Ye.version){We(Vt,Ye),m.activeTexture(33984+pt),m.bindTexture(34067,Vt.__webglTexture),t.pixelStorei(37440,Ye.flipY);const Rt=Ye&&(Ye.isCompressedTexture||Ye.image[0].isCompressedTexture),lt=Ye.image[0]&&Ye.image[0].isDataTexture,Jt=[];for(let Pt=0;Pt<6;Pt++)Jt[Pt]=Rt||lt?lt?Ye.image[Pt].image:Ye.image[Pt]:w(Ye.image[Pt],!1,!0,ee);const St=Jt[0],jt=L(St)||Z,It=I.convert(Ye.format),ln=I.convert(Ye.type),Ze=U(Ye.internalFormat,It,ln);let st;if(Je(34067,Ye,jt),Rt){for(let Pt=0;Pt<6;Pt++){st=Jt[Pt].mipmaps;for(let Gt=0;Gt<st.length;Gt++){const tn=st[Gt];Ye.format!==mo&&Ye.format!==Is?null!==It?m.compressedTexImage2D(34069+Pt,Gt,Ze,tn.width,tn.height,0,tn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):m.texImage2D(34069+Pt,Gt,Ze,tn.width,tn.height,0,It,ln,tn.data)}}Vt.__maxMipLevel=st.length-1}else{st=Ye.mipmaps;for(let Pt=0;Pt<6;Pt++)if(lt){m.texImage2D(34069+Pt,0,Ze,Jt[Pt].width,Jt[Pt].height,0,It,ln,Jt[Pt].data);for(let Gt=0;Gt<st.length;Gt++){const tn=st[Gt].image[Pt].image;m.texImage2D(34069+Pt,Gt+1,Ze,tn.width,tn.height,0,It,ln,tn.data)}}else{m.texImage2D(34069+Pt,0,Ze,It,ln,Jt[Pt]);for(let Gt=0;Gt<st.length;Gt++)m.texImage2D(34069+Pt,Gt+1,Ze,It,ln,st[Gt].image[Pt])}Vt.__maxMipLevel=st.length}O(Ye,jt)&&F(34067,Ye,St.width,St.height),Vt.__version=Ye.version,Ye.onUpdate&&Ye.onUpdate(Ye)}else m.activeTexture(33984+pt),m.bindTexture(34067,Vt.__webglTexture)}function Be(Ye,pt){m.activeTexture(33984+pt),m.bindTexture(34067,g.get(Ye).__webglTexture)}const Ae={[wo]:10497,[Yr]:33071,[os]:33648},ke={[Or]:9728,[Oa]:9984,[fs]:9986,[ai]:9729,[Fc]:9985,[Ka]:9987};function Je(Ye,pt,Vt){Vt?(t.texParameteri(Ye,10242,Ae[pt.wrapS]),t.texParameteri(Ye,10243,Ae[pt.wrapT]),32879!==Ye&&35866!==Ye||t.texParameteri(Ye,32882,Ae[pt.wrapR]),t.texParameteri(Ye,10240,ke[pt.magFilter]),t.texParameteri(Ye,10241,ke[pt.minFilter])):(t.texParameteri(Ye,10242,33071),t.texParameteri(Ye,10243,33071),32879!==Ye&&35866!==Ye||t.texParameteri(Ye,32882,33071),pt.wrapS===Yr&&pt.wrapT===Yr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(Ye,10240,te(pt.magFilter)),t.texParameteri(Ye,10241,te(pt.minFilter)),pt.minFilter!==Or&&pt.minFilter!==ai&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const Rt=u.get("EXT_texture_filter_anisotropic");if(Rt){if(pt.type===qo&&null===u.get("OES_texture_float_linear")||pt.type===ms&&null===(Z||u.get("OES_texture_half_float_linear")))return;(pt.anisotropy>1||g.get(pt).__currentAnisotropy)&&(t.texParameterf(Ye,Rt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(pt.anisotropy,E.getMaxAnisotropy())),g.get(pt).__currentAnisotropy=pt.anisotropy)}}function We(Ye,pt){void 0===Ye.__webglInit&&(Ye.__webglInit=!0,pt.addEventListener("dispose",ce),Ye.__webglTexture=t.createTexture(),V.memory.textures++)}function rt(Ye,pt,Vt){let Rt=3553;pt.isDataTexture2DArray&&(Rt=35866),pt.isDataTexture3D&&(Rt=32879),We(Ye,pt),m.activeTexture(33984+Vt),m.bindTexture(Rt,Ye.__webglTexture),t.pixelStorei(37440,pt.flipY),t.pixelStorei(37441,pt.premultiplyAlpha),t.pixelStorei(3317,pt.unpackAlignment);const lt=(Pt=pt,!Z&&(Pt.wrapS!==Yr||Pt.wrapT!==Yr||Pt.minFilter!==Or&&Pt.minFilter!==ai)&&!1===L(pt.image)),Jt=w(pt.image,lt,!1,_e),St=L(Jt)||Z,jt=I.convert(pt.format);var Pt;let It,ln=I.convert(pt.type),Ze=U(pt.internalFormat,jt,ln);Je(Rt,pt,St);const st=pt.mipmaps;if(pt.isDepthTexture)Ze=6402,Z?Ze=pt.type===qo?36012:pt.type===Ws?33190:pt.type===Ts?35056:33189:pt.type===qo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),pt.format===Lo&&6402===Ze&&pt.type!==Dc&&pt.type!==Ws&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),pt.type=Dc,ln=I.convert(pt.type)),pt.format===qs&&6402===Ze&&(Ze=34041,pt.type!==Ts&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),pt.type=Ts,ln=I.convert(pt.type))),m.texImage2D(3553,0,Ze,Jt.width,Jt.height,0,jt,ln,null);else if(pt.isDataTexture)if(st.length>0&&St){for(let Pt=0,Gt=st.length;Pt<Gt;Pt++)It=st[Pt],m.texImage2D(3553,Pt,Ze,It.width,It.height,0,jt,ln,It.data);pt.generateMipmaps=!1,Ye.__maxMipLevel=st.length-1}else m.texImage2D(3553,0,Ze,Jt.width,Jt.height,0,jt,ln,Jt.data),Ye.__maxMipLevel=0;else if(pt.isCompressedTexture){for(let Pt=0,Gt=st.length;Pt<Gt;Pt++)It=st[Pt],pt.format!==mo&&pt.format!==Is?null!==jt?m.compressedTexImage2D(3553,Pt,Ze,It.width,It.height,0,It.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):m.texImage2D(3553,Pt,Ze,It.width,It.height,0,jt,ln,It.data);Ye.__maxMipLevel=st.length-1}else if(pt.isDataTexture2DArray)m.texImage3D(35866,0,Ze,Jt.width,Jt.height,Jt.depth,0,jt,ln,Jt.data),Ye.__maxMipLevel=0;else if(pt.isDataTexture3D)m.texImage3D(32879,0,Ze,Jt.width,Jt.height,Jt.depth,0,jt,ln,Jt.data),Ye.__maxMipLevel=0;else if(st.length>0&&St){for(let Pt=0,Gt=st.length;Pt<Gt;Pt++)It=st[Pt],m.texImage2D(3553,Pt,Ze,jt,ln,It);pt.generateMipmaps=!1,Ye.__maxMipLevel=st.length-1}else m.texImage2D(3553,0,Ze,jt,ln,Jt),Ye.__maxMipLevel=0;O(pt,St)&&F(Rt,pt,Jt.width,Jt.height),Ye.__version=pt.version,pt.onUpdate&&pt.onUpdate(pt)}function nt(Ye,pt,Vt,Rt){const lt=I.convert(pt.texture.format),Jt=I.convert(pt.texture.type),St=U(pt.texture.internalFormat,lt,Jt);m.texImage2D(Rt,0,St,pt.width,pt.height,0,lt,Jt,null),t.bindFramebuffer(36160,Ye),t.framebufferTexture2D(36160,Vt,Rt,g.get(pt.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function gt(Ye,pt,Vt){if(t.bindRenderbuffer(36161,Ye),pt.depthBuffer&&!pt.stencilBuffer){let Rt=33189;if(Vt){const lt=pt.depthTexture;lt&&lt.isDepthTexture&&(lt.type===qo?Rt=36012:lt.type===Ws&&(Rt=33190));const Jt=xt(pt);t.renderbufferStorageMultisample(36161,Jt,Rt,pt.width,pt.height)}else t.renderbufferStorage(36161,Rt,pt.width,pt.height);t.framebufferRenderbuffer(36160,36096,36161,Ye)}else if(pt.depthBuffer&&pt.stencilBuffer){if(Vt){const Rt=xt(pt);t.renderbufferStorageMultisample(36161,Rt,35056,pt.width,pt.height)}else t.renderbufferStorage(36161,34041,pt.width,pt.height);t.framebufferRenderbuffer(36160,33306,36161,Ye)}else{const Rt=I.convert(pt.texture.format),lt=I.convert(pt.texture.type),Jt=U(pt.texture.internalFormat,Rt,lt);if(Vt){const St=xt(pt);t.renderbufferStorageMultisample(36161,St,Jt,pt.width,pt.height)}else t.renderbufferStorage(36161,Jt,pt.width,pt.height)}t.bindRenderbuffer(36161,null)}function xt(Ye){return Z&&Ye.isWebGLMultisampleRenderTarget?Math.min(S,Ye.samples):0}let Ut=!1,Ht=!1;this.allocateTextureUnit=function(){const Ye=de;return Ye>=J&&console.warn("THREE.WebGLTextures: Trying to use "+Ye+" texture units while this GPU supports only "+J),de+=1,Ye},this.resetTextureUnits=function(){de=0},this.setTexture2D=ve,this.setTexture2DArray=function(Ye,pt){const Vt=g.get(Ye);Ye.version>0&&Vt.__version!==Ye.version?rt(Vt,Ye,pt):(m.activeTexture(33984+pt),m.bindTexture(35866,Vt.__webglTexture))},this.setTexture3D=function(Ye,pt){const Vt=g.get(Ye);Ye.version>0&&Vt.__version!==Ye.version?rt(Vt,Ye,pt):(m.activeTexture(33984+pt),m.bindTexture(32879,Vt.__webglTexture))},this.setTextureCube=Me,this.setTextureCubeDynamic=Be,this.setupRenderTarget=function(Ye){const pt=g.get(Ye),Vt=g.get(Ye.texture);Ye.addEventListener("dispose",oe),Vt.__webglTexture=t.createTexture(),V.memory.textures++;const Rt=!0===Ye.isWebGLCubeRenderTarget,lt=!0===Ye.isWebGLMultisampleRenderTarget,Jt=L(Ye)||Z;if(!Z||Ye.texture.format!==Is||Ye.texture.type!==qo&&Ye.texture.type!==ms||(Ye.texture.format=mo,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Rt){pt.__webglFramebuffer=[];for(let St=0;St<6;St++)pt.__webglFramebuffer[St]=t.createFramebuffer()}else if(pt.__webglFramebuffer=t.createFramebuffer(),lt)if(Z){pt.__webglMultisampledFramebuffer=t.createFramebuffer(),pt.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,pt.__webglColorRenderbuffer);const St=I.convert(Ye.texture.format),jt=I.convert(Ye.texture.type),It=U(Ye.texture.internalFormat,St,jt),ln=xt(Ye);t.renderbufferStorageMultisample(36161,ln,It,Ye.width,Ye.height),t.bindFramebuffer(36160,pt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,pt.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),Ye.depthBuffer&&(pt.__webglDepthRenderbuffer=t.createRenderbuffer(),gt(pt.__webglDepthRenderbuffer,Ye,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Rt){m.bindTexture(34067,Vt.__webglTexture),Je(34067,Ye.texture,Jt);for(let St=0;St<6;St++)nt(pt.__webglFramebuffer[St],Ye,36064,34069+St);O(Ye.texture,Jt)&&F(34067,Ye.texture,Ye.width,Ye.height),m.bindTexture(34067,null)}else m.bindTexture(3553,Vt.__webglTexture),Je(3553,Ye.texture,Jt),nt(pt.__webglFramebuffer,Ye,36064,3553),O(Ye.texture,Jt)&&F(3553,Ye.texture,Ye.width,Ye.height),m.bindTexture(3553,null);Ye.depthBuffer&&function(St){const jt=g.get(St),It=!0===St.isWebGLCubeRenderTarget;if(St.depthTexture){if(It)throw new Error("target.depthTexture not supported in Cube render targets");!function(ln,Ze){if(Ze&&Ze.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,ln),!Ze.depthTexture||!Ze.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");g.get(Ze.depthTexture).__webglTexture&&Ze.depthTexture.image.width===Ze.width&&Ze.depthTexture.image.height===Ze.height||(Ze.depthTexture.image.width=Ze.width,Ze.depthTexture.image.height=Ze.height,Ze.depthTexture.needsUpdate=!0),ve(Ze.depthTexture,0);const st=g.get(Ze.depthTexture).__webglTexture;if(Ze.depthTexture.format===Lo)t.framebufferTexture2D(36160,36096,3553,st,0);else{if(Ze.depthTexture.format!==qs)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,st,0)}}(jt.__webglFramebuffer,St)}else if(It){jt.__webglDepthbuffer=[];for(let ln=0;ln<6;ln++)t.bindFramebuffer(36160,jt.__webglFramebuffer[ln]),jt.__webglDepthbuffer[ln]=t.createRenderbuffer(),gt(jt.__webglDepthbuffer[ln],St,!1)}else t.bindFramebuffer(36160,jt.__webglFramebuffer),jt.__webglDepthbuffer=t.createRenderbuffer(),gt(jt.__webglDepthbuffer,St,!1);t.bindFramebuffer(36160,null)}(Ye)},this.updateRenderTargetMipmap=function(Ye){const pt=Ye.texture;if(O(pt,L(Ye)||Z)){const Vt=Ye.isWebGLCubeRenderTarget?34067:3553,Rt=g.get(pt).__webglTexture;m.bindTexture(Vt,Rt),F(Vt,pt,Ye.width,Ye.height),m.bindTexture(Vt,null)}},this.updateMultisampleRenderTarget=function(Ye){if(Ye.isWebGLMultisampleRenderTarget)if(Z){const pt=g.get(Ye);t.bindFramebuffer(36008,pt.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,pt.__webglFramebuffer);const Vt=Ye.width,Rt=Ye.height;let lt=16384;Ye.depthBuffer&&(lt|=256),Ye.stencilBuffer&&(lt|=1024),t.blitFramebuffer(0,0,Vt,Rt,0,0,Vt,Rt,lt,9728),t.bindFramebuffer(36160,pt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Ye,pt){Ye&&Ye.isWebGLRenderTarget&&(!1===Ut&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ut=!0),Ye=Ye.texture),ve(Ye,pt)},this.safeSetTextureCube=function(Ye,pt){Ye&&Ye.isWebGLCubeRenderTarget&&(!1===Ht&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Ht=!0),Ye=Ye.texture),Ye&&Ye.isCubeTexture||Array.isArray(Ye.image)&&6===Ye.image.length?Me(Ye,pt):Be(Ye,pt)}}function tp(t,u,m){const g=m.isWebGL2;return{convert:function(E){let I;if(E===oa)return 5121;if(E===Ou)return 32819;if(E===uu)return 32820;if(E===hu)return 33635;if(E===zl)return 5120;if(E===ka)return 5122;if(E===Dc)return 5123;if(E===Hp)return 5124;if(E===Ws)return 5125;if(E===qo)return 5126;if(E===ms)return g?5131:(I=u.get("OES_texture_half_float"),null!==I?I.HALF_FLOAT_OES:null);if(E===pp)return 6406;if(E===Is)return 6407;if(E===mo)return 6408;if(E===Uc)return 6409;if(E===ku)return 6410;if(E===Lo)return 6402;if(E===qs)return 34041;if(E===Vp)return 6403;if(E===el)return 36244;if(E===pu)return 33319;if(E===dp)return 33320;if(E===fp)return 36248;if(E===dh)return 36249;if(E===Ih||E===cc||E===Oh||E===fh){if(I=u.get("WEBGL_compressed_texture_s3tc"),null===I)return null;if(E===Ih)return I.COMPRESSED_RGB_S3TC_DXT1_EXT;if(E===cc)return I.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(E===Oh)return I.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(E===fh)return I.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(E===kh||E===yl||E===xl||E===jl){if(I=u.get("WEBGL_compressed_texture_pvrtc"),null===I)return null;if(E===kh)return I.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(E===yl)return I.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(E===xl)return I.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(E===jl)return I.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(E===Fu)return I=u.get("WEBGL_compressed_texture_etc1"),null!==I?I.COMPRESSED_RGB_ETC1_WEBGL:null;if((E===gs||E===Gl)&&(I=u.get("WEBGL_compressed_texture_etc"),null!==I)){if(E===gs)return I.COMPRESSED_RGB8_ETC2;if(E===Gl)return I.COMPRESSED_RGBA8_ETC2_EAC}return E===Du||E===mp||E===_p||E===zc||E===uc||E===mh||E===gp||E===Uu||E===zu||E===tl||E===Fh||E===nl||E===Dh||E===ju||E===pc||E===_h||E===du||E===jc||E===vp||E===Gc||E===Gu||E===Hl||E===yp||E===Uh||E===bp||E===xp||E===zh||E===Wp?(I=u.get("WEBGL_compressed_texture_astc"),null!==I?E:null):E===hc?(I=u.get("EXT_texture_compression_bptc"),null!==I?E:null):E===Ts?g?34042:(I=u.get("WEBGL_depth_texture"),null!==I?I.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function Vd(t){Ns.call(this),this.cameras=t||[]}function tc(){Zn.call(this),this.type="Group"}function Mu(){this._targetRay=null,this._grip=null,this._hand=null}function Wd(t,u){const m=this;let g=null,E=1,I=null,V="local-floor",Z=null;const J=[],ee=new Map,_e=new Ns;_e.layers.enable(1),_e.viewport=new bi;const S=new Ns;S.layers.enable(2),S.viewport=new bi;const e=[_e,S],c=new Vd;c.layers.enable(1),c.layers.enable(2);let p=null,_=null;function w(ve){const Me=ee.get(ve.inputSource);Me&&Me.dispatchEvent({type:ve.type})}function L(){ee.forEach(function(ve,Me){ve.disconnect(Me)}),ee.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),de.stop(),m.isPresenting=!1,m.dispatchEvent({type:"sessionend"})}function O(ve){I=ve,de.setContext(g),de.start(),m.isPresenting=!0,m.dispatchEvent({type:"sessionstart"})}function F(ve){const Me=g.inputSources;for(let Be=0;Be<J.length;Be++)ee.set(Me[Be],J[Be]);for(let Be=0;Be<ve.removed.length;Be++){const Ae=ve.removed[Be],ke=ee.get(Ae);ke&&(ke.dispatchEvent({type:"disconnected",data:Ae}),ee.delete(Ae))}for(let Be=0;Be<ve.added.length;Be++){const Ae=ve.added[Be],ke=ee.get(Ae);ke&&ke.dispatchEvent({type:"connected",data:Ae})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(ve){let Me=J[ve];return void 0===Me&&(Me=new Mu,J[ve]=Me),Me.getTargetRaySpace()},this.getControllerGrip=function(ve){let Me=J[ve];return void 0===Me&&(Me=new Mu,J[ve]=Me),Me.getGripSpace()},this.getHand=function(ve){let Me=J[ve];return void 0===Me&&(Me=new Mu,J[ve]=Me),Me.getHandSpace()},this.setFramebufferScaleFactor=function(ve){E=ve,!0===m.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ve){V=ve,!0===m.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return I},this.getSession=function(){return g},this.setSession=function(ve){if(g=ve,null!==g){g.addEventListener("select",w),g.addEventListener("selectstart",w),g.addEventListener("selectend",w),g.addEventListener("squeeze",w),g.addEventListener("squeezestart",w),g.addEventListener("squeezeend",w),g.addEventListener("end",L);const Me=u.getContextAttributes();!0!==Me.xrCompatible&&u.makeXRCompatible();const Ae=new XRWebGLLayer(g,u,{antialias:Me.antialias,alpha:Me.alpha,depth:Me.depth,stencil:Me.stencil,framebufferScaleFactor:E});g.updateRenderState({baseLayer:Ae}),g.requestReferenceSpace(V).then(O),g.addEventListener("inputsourceschange",F)}};const U=new ot,te=new ot;function ce(ve,Me){null===Me?ve.matrixWorld.copy(ve.matrix):ve.matrixWorld.multiplyMatrices(Me.matrixWorld,ve.matrix),ve.matrixWorldInverse.getInverse(ve.matrixWorld)}this.getCamera=function(ve){c.near=S.near=_e.near=ve.near,c.far=S.far=_e.far=ve.far,p===c.near&&_===c.far||(g.updateRenderState({depthNear:c.near,depthFar:c.far}),p=c.near,_=c.far);const Me=ve.parent,Be=c.cameras;ce(c,Me);for(let ke=0;ke<Be.length;ke++)ce(Be[ke],Me);ve.matrixWorld.copy(c.matrixWorld);const Ae=ve.children;for(let ke=0,Je=Ae.length;ke<Je;ke++)Ae[ke].updateMatrixWorld(!0);return 2===Be.length?function(ke,Je,We){U.setFromMatrixPosition(Je.matrixWorld),te.setFromMatrixPosition(We.matrixWorld);const rt=U.distanceTo(te),nt=Je.projectionMatrix.elements,gt=We.projectionMatrix.elements,xt=nt[14]/(nt[10]-1),Ut=nt[14]/(nt[10]+1),Ht=(nt[9]+1)/nt[5],Ye=(nt[9]-1)/nt[5],pt=(nt[8]-1)/nt[0],Vt=(gt[8]+1)/gt[0],Rt=xt*pt,lt=xt*Vt,Jt=rt/(-pt+Vt),St=Jt*-pt;Je.matrixWorld.decompose(ke.position,ke.quaternion,ke.scale),ke.translateX(St),ke.translateZ(Jt),ke.matrixWorld.compose(ke.position,ke.quaternion,ke.scale),ke.matrixWorldInverse.getInverse(ke.matrixWorld);const jt=xt+Jt,It=Ut+Jt;ke.projectionMatrix.makePerspective(Rt-St,lt+(rt-St),Ht*Ut/It*jt,Ye*Ut/It*jt,jt,It)}(c,_e,S):c.projectionMatrix.copy(_e.projectionMatrix),c};let oe=null;const de=new Cp;de.setAnimationLoop(function(ve,Me){if(Z=Me.getViewerPose(I),null!==Z){const Ae=Z.views,ke=g.renderState.baseLayer;t.setFramebuffer(ke.framebuffer);let Je=!1;Ae.length!==c.cameras.length&&(c.cameras.length=0,Je=!0);for(let We=0;We<Ae.length;We++){const rt=Ae[We],nt=ke.getViewport(rt),gt=e[We];gt.matrix.fromArray(rt.transform.matrix),gt.projectionMatrix.fromArray(rt.projectionMatrix),gt.viewport.set(nt.x,nt.y,nt.width,nt.height),0===We&&c.matrix.copy(gt.matrix),!0===Je&&c.cameras.push(gt)}}const Be=g.inputSources;for(let Ae=0;Ae<J.length;Ae++)J[Ae].update(Be[Ae],Me,I);oe&&oe(ve,Me)}),this.setAnimationLoop=function(ve){oe=ve},this.dispose=function(){}}function lm(t){function u(g,E,I){g.opacity.value=E.opacity,E.color&&g.diffuse.value.copy(E.color),E.emissive&&g.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(g.map.value=E.map),E.alphaMap&&(g.alphaMap.value=E.alphaMap),E.specularMap&&(g.specularMap.value=E.specularMap);const V=E.envMap||I;if(V){g.envMap.value=V,g.flipEnvMap.value=V.isCubeTexture?-1:1,g.reflectivity.value=E.reflectivity,g.refractionRatio.value=E.refractionRatio;var Z=t.get(V).__maxMipLevel;void 0!==Z&&(g.maxMipLevel.value=Z)}let J,ee;E.lightMap&&(g.lightMap.value=E.lightMap,g.lightMapIntensity.value=E.lightMapIntensity),E.aoMap&&(g.aoMap.value=E.aoMap,g.aoMapIntensity.value=E.aoMapIntensity),E.map?J=E.map:E.specularMap?J=E.specularMap:E.displacementMap?J=E.displacementMap:E.normalMap?J=E.normalMap:E.bumpMap?J=E.bumpMap:E.roughnessMap?J=E.roughnessMap:E.metalnessMap?J=E.metalnessMap:E.alphaMap?J=E.alphaMap:E.emissiveMap&&(J=E.emissiveMap),void 0!==J&&(J.isWebGLRenderTarget&&(J=J.texture),!0===J.matrixAutoUpdate&&J.updateMatrix(),g.uvTransform.value.copy(J.matrix)),E.aoMap?ee=E.aoMap:E.lightMap&&(ee=E.lightMap),void 0!==ee&&(ee.isWebGLRenderTarget&&(ee=ee.texture),!0===ee.matrixAutoUpdate&&ee.updateMatrix(),g.uv2Transform.value.copy(ee.matrix))}function m(g,E,I){g.roughness.value=E.roughness,g.metalness.value=E.metalness,E.roughnessMap&&(g.roughnessMap.value=E.roughnessMap),E.metalnessMap&&(g.metalnessMap.value=E.metalnessMap),E.emissiveMap&&(g.emissiveMap.value=E.emissiveMap),E.bumpMap&&(g.bumpMap.value=E.bumpMap,g.bumpScale.value=E.bumpScale,E.side===W&&(g.bumpScale.value*=-1)),E.normalMap&&(g.normalMap.value=E.normalMap,g.normalScale.value.copy(E.normalScale),E.side===W&&g.normalScale.value.negate()),E.displacementMap&&(g.displacementMap.value=E.displacementMap,g.displacementScale.value=E.displacementScale,g.displacementBias.value=E.displacementBias),(E.envMap||I)&&(g.envMapIntensity.value=E.envMapIntensity)}return{refreshFogUniforms:function(g,E){g.fogColor.value.copy(E.color),E.isFog?(g.fogNear.value=E.near,g.fogFar.value=E.far):E.isFogExp2&&(g.fogDensity.value=E.density)},refreshMaterialUniforms:function(g,E,I,V,Z){var ee;E.isMeshBasicMaterial?u(g,E):E.isMeshLambertMaterial?(u(g,E),(ee=E).emissiveMap&&(g.emissiveMap.value=ee.emissiveMap)):E.isMeshToonMaterial?(u(g,E),function(J,ee){ee.gradientMap&&(J.gradientMap.value=ee.gradientMap),ee.emissiveMap&&(J.emissiveMap.value=ee.emissiveMap),ee.bumpMap&&(J.bumpMap.value=ee.bumpMap,J.bumpScale.value=ee.bumpScale,ee.side===W&&(J.bumpScale.value*=-1)),ee.normalMap&&(J.normalMap.value=ee.normalMap,J.normalScale.value.copy(ee.normalScale),ee.side===W&&J.normalScale.value.negate()),ee.displacementMap&&(J.displacementMap.value=ee.displacementMap,J.displacementScale.value=ee.displacementScale,J.displacementBias.value=ee.displacementBias)}(g,E)):E.isMeshPhongMaterial?(u(g,E),function(J,ee){J.specular.value.copy(ee.specular),J.shininess.value=Math.max(ee.shininess,1e-4),ee.emissiveMap&&(J.emissiveMap.value=ee.emissiveMap),ee.bumpMap&&(J.bumpMap.value=ee.bumpMap,J.bumpScale.value=ee.bumpScale,ee.side===W&&(J.bumpScale.value*=-1)),ee.normalMap&&(J.normalMap.value=ee.normalMap,J.normalScale.value.copy(ee.normalScale),ee.side===W&&J.normalScale.value.negate()),ee.displacementMap&&(J.displacementMap.value=ee.displacementMap,J.displacementScale.value=ee.displacementScale,J.displacementBias.value=ee.displacementBias)}(g,E)):E.isMeshStandardMaterial?(u(g,E,I),E.isMeshPhysicalMaterial?function(J,ee,_e){m(J,ee,_e),J.reflectivity.value=ee.reflectivity,J.clearcoat.value=ee.clearcoat,J.clearcoatRoughness.value=ee.clearcoatRoughness,ee.sheen&&J.sheen.value.copy(ee.sheen),ee.clearcoatMap&&(J.clearcoatMap.value=ee.clearcoatMap),ee.clearcoatRoughnessMap&&(J.clearcoatRoughnessMap.value=ee.clearcoatRoughnessMap),ee.clearcoatNormalMap&&(J.clearcoatNormalScale.value.copy(ee.clearcoatNormalScale),J.clearcoatNormalMap.value=ee.clearcoatNormalMap,ee.side===W&&J.clearcoatNormalScale.value.negate()),J.transmission.value=ee.transmission,ee.transmissionMap&&(J.transmissionMap.value=ee.transmissionMap)}(g,E,I):m(g,E,I)):E.isMeshMatcapMaterial?(u(g,E),function(J,ee){ee.matcap&&(J.matcap.value=ee.matcap),ee.bumpMap&&(J.bumpMap.value=ee.bumpMap,J.bumpScale.value=ee.bumpScale,ee.side===W&&(J.bumpScale.value*=-1)),ee.normalMap&&(J.normalMap.value=ee.normalMap,J.normalScale.value.copy(ee.normalScale),ee.side===W&&J.normalScale.value.negate()),ee.displacementMap&&(J.displacementMap.value=ee.displacementMap,J.displacementScale.value=ee.displacementScale,J.displacementBias.value=ee.displacementBias)}(g,E)):E.isMeshDepthMaterial?(u(g,E),function(J,ee){ee.displacementMap&&(J.displacementMap.value=ee.displacementMap,J.displacementScale.value=ee.displacementScale,J.displacementBias.value=ee.displacementBias)}(g,E)):E.isMeshDistanceMaterial?(u(g,E),function(J,ee){ee.displacementMap&&(J.displacementMap.value=ee.displacementMap,J.displacementScale.value=ee.displacementScale,J.displacementBias.value=ee.displacementBias),J.referencePosition.value.copy(ee.referencePosition),J.nearDistance.value=ee.nearDistance,J.farDistance.value=ee.farDistance}(g,E)):E.isMeshNormalMaterial?(u(g,E),function(J,ee){ee.bumpMap&&(J.bumpMap.value=ee.bumpMap,J.bumpScale.value=ee.bumpScale,ee.side===W&&(J.bumpScale.value*=-1)),ee.normalMap&&(J.normalMap.value=ee.normalMap,J.normalScale.value.copy(ee.normalScale),ee.side===W&&J.normalScale.value.negate()),ee.displacementMap&&(J.displacementMap.value=ee.displacementMap,J.displacementScale.value=ee.displacementScale,J.displacementBias.value=ee.displacementBias)}(g,E)):E.isLineBasicMaterial?(function(J,ee){J.diffuse.value.copy(ee.color),J.opacity.value=ee.opacity}(g,E),E.isLineDashedMaterial&&function(J,ee){J.dashSize.value=ee.dashSize,J.totalSize.value=ee.dashSize+ee.gapSize,J.scale.value=ee.scale}(g,E)):E.isPointsMaterial?function(J,ee,_e,S){let e;J.diffuse.value.copy(ee.color),J.opacity.value=ee.opacity,J.size.value=ee.size*_e,J.scale.value=.5*S,ee.map&&(J.map.value=ee.map),ee.alphaMap&&(J.alphaMap.value=ee.alphaMap),ee.map?e=ee.map:ee.alphaMap&&(e=ee.alphaMap),void 0!==e&&(!0===e.matrixAutoUpdate&&e.updateMatrix(),J.uvTransform.value.copy(e.matrix))}(g,E,V,Z):E.isSpriteMaterial?function(J,ee){let _e;J.diffuse.value.copy(ee.color),J.opacity.value=ee.opacity,J.rotation.value=ee.rotation,ee.map&&(J.map.value=ee.map),ee.alphaMap&&(J.alphaMap.value=ee.alphaMap),ee.map?_e=ee.map:ee.alphaMap&&(_e=ee.alphaMap),void 0!==_e&&(!0===_e.matrixAutoUpdate&&_e.updateMatrix(),J.uvTransform.value.copy(_e.matrix))}(g,E):E.isShadowMaterial?(g.color.value.copy(E.color),g.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}}}function qd(t){const u=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),m=void 0!==t.context?t.context:null,g=void 0!==t.alpha&&t.alpha,E=void 0===t.depth||t.depth,I=void 0===t.stencil||t.stencil,V=void 0!==t.antialias&&t.antialias,Z=void 0===t.premultipliedAlpha||t.premultipliedAlpha,J=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,ee=void 0!==t.powerPreference?t.powerPreference:"default",_e=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let S=null,e=null;this.domElement=u,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ki,this.physicallyCorrectLights=!1,this.toneMapping=mr,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const c=this;let p=!1,_=null,w=0,L=0,O=null,F=null,U=-1,te=null,ce=null;const oe=new bi,de=new bi;let ve=null,Me=u.width,Be=u.height,Ae=1,ke=null,Je=null;const We=new bi(0,0,Me,Be),rt=new bi(0,0,Me,Be);let nt=!1;const gt=new Yc,xt=new Bl;let Ut=!1,Ht=!1;const Ye=new ni,pt=new ot,Vt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Rt(){return null===O?Ae:1}let lt,Jt,St,jt,It,ln,Ze,st,Pt,Gt,tn,Mn,Yn,Vn,sn,dt,an,Tn,un,Wt=m;function vr(Mt,In){for(let hn=0;hn<Mt.length;hn++){const pr=u.getContext(Mt[hn],In);if(null!==pr)return pr}return null}try{const Mt={alpha:g,depth:E,stencil:I,antialias:V,premultipliedAlpha:Z,preserveDrawingBuffer:J,powerPreference:ee,failIfMajorPerformanceCaveat:_e};if(u.addEventListener("webglcontextlost",bo,!1),u.addEventListener("webglcontextrestored",_l,!1),null===Wt){const In=["webgl2","webgl","experimental-webgl"];if(!0===c.isWebGL1Renderer&&In.shift(),Wt=vr(In,Mt),null===Wt)throw vr(In)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Wt.getShaderPrecisionFormat&&(Wt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Mt){throw console.error("THREE.WebGLRenderer: "+Mt.message),Mt}function hr(){lt=new Jc(Wt),Jt=new ir(Wt,lt,t),!1===Jt.isWebGL2&&(lt.get("WEBGL_depth_texture"),lt.get("OES_texture_float"),lt.get("OES_texture_half_float"),lt.get("OES_texture_half_float_linear"),lt.get("OES_standard_derivatives"),lt.get("OES_element_index_uint"),lt.get("OES_vertex_array_object"),lt.get("ANGLE_instanced_arrays")),lt.get("OES_texture_float_linear"),Tn=new tp(Wt,lt,Jt),St=new ec(Wt,lt,Jt),St.scissor(de.copy(rt).multiplyScalar(Ae).floor()),St.viewport(oe.copy(We).multiplyScalar(Ae).floor()),jt=new Zc(Wt),It=new Af,ln=new Jp(Wt,lt,St,It,Jt,Tn,jt),Ze=new Ta(Wt,Jt),un=new xu(Wt,lt,Ze,Jt),st=new Bo(Wt,Ze,jt,un),Pt=new Su(Wt,st,Ze,jt),sn=new Ql(Wt),Gt=new $c(c,lt,Jt,un),tn=new lm(It),Mn=new Om(It),Yn=new bd,Vn=new qp(c,St,Pt,Z),dt=new ui(Wt,lt,jt,Jt),an=new Wn(Wt,lt,jt,Jt),jt.programs=Gt.programs,c.capabilities=Jt,c.extensions=lt,c.properties=It,c.renderLists=Mn,c.state=St,c.info=jt}hr();const Br=new Wd(c,Wt);this.xr=Br;const zi=new Np(c,Pt,Jt.maxTextureSize);function bo(Mt){Mt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),p=!0}function _l(){console.log("THREE.WebGLRenderer: Context Restored."),p=!1,hr()}function Wo(Mt){const In=Mt.target;var hn;In.removeEventListener("dispose",Wo),gl(hn=In),It.remove(hn)}function gl(Mt){const In=It.get(Mt).program;void 0!==In&&Gt.releaseProgram(In)}this.shadowMap=zi,this.getContext=function(){return Wt},this.getContextAttributes=function(){return Wt.getContextAttributes()},this.forceContextLoss=function(){const Mt=lt.get("WEBGL_lose_context");Mt&&Mt.loseContext()},this.forceContextRestore=function(){const Mt=lt.get("WEBGL_lose_context");Mt&&Mt.restoreContext()},this.getPixelRatio=function(){return Ae},this.setPixelRatio=function(Mt){void 0!==Mt&&(Ae=Mt,this.setSize(Me,Be,!1))},this.getSize=function(Mt){return void 0===Mt&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Mt=new Sn),Mt.set(Me,Be)},this.setSize=function(Mt,In,hn){Br.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Me=Mt,Be=In,u.width=Math.floor(Mt*Ae),u.height=Math.floor(In*Ae),!1!==hn&&(u.style.width=Mt+"px",u.style.height=In+"px"),this.setViewport(0,0,Mt,In))},this.getDrawingBufferSize=function(Mt){return void 0===Mt&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Mt=new Sn),Mt.set(Me*Ae,Be*Ae).floor()},this.setDrawingBufferSize=function(Mt,In,hn){Me=Mt,Be=In,Ae=hn,u.width=Math.floor(Mt*hn),u.height=Math.floor(In*hn),this.setViewport(0,0,Mt,In)},this.getCurrentViewport=function(Mt){return void 0===Mt&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Mt=new bi),Mt.copy(oe)},this.getViewport=function(Mt){return Mt.copy(We)},this.setViewport=function(Mt,In,hn,Fn){Mt.isVector4?We.set(Mt.x,Mt.y,Mt.z,Mt.w):We.set(Mt,In,hn,Fn),St.viewport(oe.copy(We).multiplyScalar(Ae).floor())},this.getScissor=function(Mt){return Mt.copy(rt)},this.setScissor=function(Mt,In,hn,Fn){Mt.isVector4?rt.set(Mt.x,Mt.y,Mt.z,Mt.w):rt.set(Mt,In,hn,Fn),St.scissor(de.copy(rt).multiplyScalar(Ae).floor())},this.getScissorTest=function(){return nt},this.setScissorTest=function(Mt){St.setScissorTest(nt=Mt)},this.setOpaqueSort=function(Mt){ke=Mt},this.setTransparentSort=function(Mt){Je=Mt},this.getClearColor=function(){return Vn.getClearColor()},this.setClearColor=function(){Vn.setClearColor.apply(Vn,arguments)},this.getClearAlpha=function(){return Vn.getClearAlpha()},this.setClearAlpha=function(){Vn.setClearAlpha.apply(Vn,arguments)},this.clear=function(Mt,In,hn){let Fn=0;(void 0===Mt||Mt)&&(Fn|=16384),(void 0===In||In)&&(Fn|=256),(void 0===hn||hn)&&(Fn|=1024),Wt.clear(Fn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){u.removeEventListener("webglcontextlost",bo,!1),u.removeEventListener("webglcontextrestored",_l,!1),Mn.dispose(),Yn.dispose(),It.dispose(),Pt.dispose(),un.dispose(),Br.dispose(),hp.stop()},this.renderBufferImmediate=function(Mt,In){un.initAttributes();const hn=It.get(Mt);Mt.hasPositions&&!hn.position&&(hn.position=Wt.createBuffer()),Mt.hasNormals&&!hn.normal&&(hn.normal=Wt.createBuffer()),Mt.hasUvs&&!hn.uv&&(hn.uv=Wt.createBuffer()),Mt.hasColors&&!hn.color&&(hn.color=Wt.createBuffer());const Fn=In.getAttributes();Mt.hasPositions&&(Wt.bindBuffer(34962,hn.position),Wt.bufferData(34962,Mt.positionArray,35048),un.enableAttribute(Fn.position),Wt.vertexAttribPointer(Fn.position,3,5126,!1,0,0)),Mt.hasNormals&&(Wt.bindBuffer(34962,hn.normal),Wt.bufferData(34962,Mt.normalArray,35048),un.enableAttribute(Fn.normal),Wt.vertexAttribPointer(Fn.normal,3,5126,!1,0,0)),Mt.hasUvs&&(Wt.bindBuffer(34962,hn.uv),Wt.bufferData(34962,Mt.uvArray,35048),un.enableAttribute(Fn.uv),Wt.vertexAttribPointer(Fn.uv,2,5126,!1,0,0)),Mt.hasColors&&(Wt.bindBuffer(34962,hn.color),Wt.bufferData(34962,Mt.colorArray,35048),un.enableAttribute(Fn.color),Wt.vertexAttribPointer(Fn.color,3,5126,!1,0,0)),un.disableUnusedAttributes(),Wt.drawArrays(4,0,Mt.count),Mt.count=0},this.renderBufferDirect=function(Mt,In,hn,Fn,pr,Mi){null===In&&(In=Vt);const Ni=pr.isMesh&&pr.matrixWorld.determinant()<0,oi=Hn(Mt,In,Fn,pr);St.setMaterial(Fn,Ni);let ws=hn.index;const is=hn.attributes.position;if(null===ws){if(void 0===is||0===is.count)return}else if(0===ws.count)return;let ra,Ss=1;!0===Fn.wireframe&&(ws=st.getWireframeAttribute(hn),Ss=2),(Fn.morphTargets||Fn.morphNormals)&&sn.update(pr,hn,Fn,oi),un.setup(pr,Fn,oi,hn,ws);let Ri=dt;null!==ws&&(ra=Ze.get(ws),Ri=an,Ri.setIndex(ra));const ya=null!==ws?ws.count:is.count,Ia=hn.drawRange.start*Ss,Zo=hn.drawRange.count*Ss,cu=null!==Mi?Mi.start*Ss:0,mt=null!==Mi?Mi.count*Ss:1/0,xn=Math.max(Ia,cu),en=Math.min(ya,Ia+Zo,cu+mt)-1,bn=Math.max(0,en-xn+1);if(0!==bn){if(pr.isMesh)!0===Fn.wireframe?(St.setLineWidth(Fn.wireframeLinewidth*Rt()),Ri.setMode(1)):Ri.setMode(4);else if(pr.isLine){let jn=Fn.linewidth;void 0===jn&&(jn=1),St.setLineWidth(jn*Rt()),Ri.setMode(pr.isLineSegments?1:pr.isLineLoop?2:3)}else pr.isPoints?Ri.setMode(0):pr.isSprite&&Ri.setMode(4);if(pr.isInstancedMesh)Ri.renderInstances(xn,bn,pr.count);else if(hn.isInstancedBufferGeometry){const jn=Math.min(hn.instanceCount,hn._maxInstanceCount);Ri.renderInstances(xn,bn,jn)}else Ri.render(xn,bn)}},this.compile=function(Mt,In){e=Yn.get(Mt,In),e.init(),Mt.traverse(function(Fn){Fn.isLight&&(e.pushLight(Fn),Fn.castShadow&&e.pushShadow(Fn))}),e.setupLights(In);const hn=new WeakMap;Mt.traverse(function(Fn){let pr=Fn.material;if(pr)if(Array.isArray(pr))for(let Mi=0;Mi<pr.length;Mi++){let Ni=pr[Mi];!1===hn.has(Ni)&&(vl(Ni,Mt,Fn),hn.set(Ni))}else!1===hn.has(pr)&&(vl(pr,Mt,Fn),hn.set(pr))})};let lu=null;const hp=new Cp;function Id(Mt,In,hn,Fn){if(!1===Mt.visible)return;if(Mt.layers.test(In.layers))if(Mt.isGroup)hn=Mt.renderOrder;else if(Mt.isLOD)!0===Mt.autoUpdate&&Mt.update(In);else if(Mt.isLight)e.pushLight(Mt),Mt.castShadow&&e.pushShadow(Mt);else if(Mt.isSprite){if(!Mt.frustumCulled||gt.intersectsSprite(Mt)){Fn&&pt.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(Ye);const Mi=Pt.update(Mt),Ni=Mt.material;Ni.visible&&S.push(Mt,Mi,Ni,hn,pt.z,null)}}else if(Mt.isImmediateRenderObject)Fn&&pt.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(Ye),S.push(Mt,null,Mt.material,hn,pt.z,null);else if((Mt.isMesh||Mt.isLine||Mt.isPoints)&&(Mt.isSkinnedMesh&&Mt.skeleton.frame!==jt.render.frame&&(Mt.skeleton.update(),Mt.skeleton.frame=jt.render.frame),!Mt.frustumCulled||gt.intersectsObject(Mt))){Fn&&pt.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(Ye);const Mi=Pt.update(Mt),Ni=Mt.material;if(Array.isArray(Ni)){const oi=Mi.groups;for(let ws=0,is=oi.length;ws<is;ws++){const ra=oi[ws],Ss=Ni[ra.materialIndex];Ss&&Ss.visible&&S.push(Mt,Mi,Ss,hn,pt.z,ra)}}else Ni.visible&&S.push(Mt,Mi,Ni,hn,pt.z,null)}const pr=Mt.children;for(let Mi=0,Ni=pr.length;Mi<Ni;Mi++)Id(pr[Mi],In,hn,Fn)}function Od(Mt,In,hn){const Fn=!0===In.isScene?In.overrideMaterial:null;for(let pr=0,Mi=Mt.length;pr<Mi;pr++){const Ni=Mt[pr],oi=Ni.object,ws=Ni.geometry,is=null===Fn?Ni.material:Fn,ra=Ni.group;if(hn.isArrayCamera){ce=hn;const Ss=hn.cameras;for(let Ri=0,ya=Ss.length;Ri<ya;Ri++){const Ia=Ss[Ri];oi.layers.test(Ia.layers)&&(St.viewport(oe.copy(Ia.viewport)),e.setupLights(Ia),hh(oi,In,Ia,ws,is,ra))}}else ce=null,hh(oi,In,hn,ws,is,ra)}}function hh(Mt,In,hn,Fn,pr,Mi){if(Mt.onBeforeRender(c,In,hn,Fn,pr,Mi),e=Yn.get(In,ce||hn),Mt.modelViewMatrix.multiplyMatrices(hn.matrixWorldInverse,Mt.matrixWorld),Mt.normalMatrix.getNormalMatrix(Mt.modelViewMatrix),Mt.isImmediateRenderObject){const Ni=Hn(hn,In,pr,Mt);St.setMaterial(pr),un.reset(),ws=Ni,Mt.render(function(is){c.renderBufferImmediate(is,ws)})}else c.renderBufferDirect(hn,In,Fn,pr,Mt,Mi);var ws;Mt.onAfterRender(c,In,hn,Fn,pr,Mi),e=Yn.get(In,ce||hn)}function vl(Mt,In,hn){!0!==In.isScene&&(In=Vt);const Fn=It.get(Mt),pr=e.state.lights,Ni=pr.state.version,oi=Gt.getParameters(Mt,pr.state,e.state.shadowsArray,In,xt.numPlanes,xt.numIntersection,hn),ws=Gt.getProgramCacheKey(oi);let is=Fn.program,ra=!0;if(void 0===is)Mt.addEventListener("dispose",Wo);else if(is.cacheKey!==ws)gl(Mt);else if(Fn.lightsStateVersion!==Ni)Fn.lightsStateVersion=Ni,ra=!1;else{if(void 0!==oi.shaderID)return;ra=!1}ra&&(oi.uniforms=Gt.getUniforms(Mt,oi),Mt.onBeforeCompile(oi,c),is=Gt.acquireProgram(oi,ws),Fn.program=is,Fn.uniforms=oi.uniforms,Fn.outputEncoding=oi.outputEncoding);const Ss=is.getAttributes();if(Mt.morphTargets){Mt.numSupportedMorphTargets=0;for(let Zo=0;Zo<c.maxMorphTargets;Zo++)Ss["morphTarget"+Zo]>=0&&Mt.numSupportedMorphTargets++}if(Mt.morphNormals){Mt.numSupportedMorphNormals=0;for(let Zo=0;Zo<c.maxMorphNormals;Zo++)Ss["morphNormal"+Zo]>=0&&Mt.numSupportedMorphNormals++}const Ri=Fn.uniforms;var Zo;(Mt.isShaderMaterial||Mt.isRawShaderMaterial)&&!0!==Mt.clipping||(Fn.numClippingPlanes=xt.numPlanes,Fn.numIntersection=xt.numIntersection,Ri.clippingPlanes=xt.uniform),Fn.environment=Mt.isMeshStandardMaterial?In.environment:null,Fn.fog=In.fog,Fn.needsLights=(Zo=Mt).isMeshLambertMaterial||Zo.isMeshToonMaterial||Zo.isMeshPhongMaterial||Zo.isMeshStandardMaterial||Zo.isShadowMaterial||Zo.isShaderMaterial&&!0===Zo.lights,Fn.lightsStateVersion=Ni,Fn.needsLights&&(Ri.ambientLightColor.value=pr.state.ambient,Ri.lightProbe.value=pr.state.probe,Ri.directionalLights.value=pr.state.directional,Ri.directionalLightShadows.value=pr.state.directionalShadow,Ri.spotLights.value=pr.state.spot,Ri.spotLightShadows.value=pr.state.spotShadow,Ri.rectAreaLights.value=pr.state.rectArea,Ri.pointLights.value=pr.state.point,Ri.pointLightShadows.value=pr.state.pointShadow,Ri.hemisphereLights.value=pr.state.hemi,Ri.directionalShadowMap.value=pr.state.directionalShadowMap,Ri.directionalShadowMatrix.value=pr.state.directionalShadowMatrix,Ri.spotShadowMap.value=pr.state.spotShadowMap,Ri.spotShadowMatrix.value=pr.state.spotShadowMatrix,Ri.pointShadowMap.value=pr.state.pointShadowMap,Ri.pointShadowMatrix.value=pr.state.pointShadowMatrix);const ya=Fn.program.getUniforms(),Ia=Bp.seqWithValue(ya.seq,Ri);Fn.uniformsList=Ia}function Hn(Mt,In,hn,Fn){!0!==In.isScene&&(In=Vt),ln.resetTextureUnits();const pr=In.fog,Mi=hn.isMeshStandardMaterial?In.environment:null,Ni=null===O?c.outputEncoding:O.texture.encoding,oi=It.get(hn),ws=e.state.lights;!0!==Ut||!0!==Ht&&Mt===te||xt.setState(hn.clippingPlanes,hn.clipIntersection,hn.clipShadows,Mt,oi,Mt===te&&hn.id===U),hn.version===oi.__version?void 0===oi.program||hn.fog&&oi.fog!==pr||oi.environment!==Mi||oi.needsLights&&oi.lightsStateVersion!==ws.state.version?vl(hn,In,Fn):void 0===oi.numClippingPlanes||oi.numClippingPlanes===xt.numPlanes&&oi.numIntersection===xt.numIntersection?oi.outputEncoding!==Ni&&vl(hn,In,Fn):vl(hn,In,Fn):(vl(hn,In,Fn),oi.__version=hn.version);let is=!1,ra=!1,Ss=!1;const Ri=oi.program,ya=Ri.getUniforms(),Ia=oi.uniforms;if(St.useProgram(Ri.program)&&(is=!0,ra=!0,Ss=!0),hn.id!==U&&(U=hn.id,ra=!0),is||te!==Mt){if(ya.setValue(Wt,"projectionMatrix",Mt.projectionMatrix),Jt.logarithmicDepthBuffer&&ya.setValue(Wt,"logDepthBufFC",2/(Math.log(Mt.far+1)/Math.LN2)),te!==Mt&&(te=Mt,ra=!0,Ss=!0),hn.isShaderMaterial||hn.isMeshPhongMaterial||hn.isMeshToonMaterial||hn.isMeshStandardMaterial||hn.envMap){const mt=ya.map.cameraPosition;void 0!==mt&&mt.setValue(Wt,pt.setFromMatrixPosition(Mt.matrixWorld))}(hn.isMeshPhongMaterial||hn.isMeshToonMaterial||hn.isMeshLambertMaterial||hn.isMeshBasicMaterial||hn.isMeshStandardMaterial||hn.isShaderMaterial)&&ya.setValue(Wt,"isOrthographic",!0===Mt.isOrthographicCamera),(hn.isMeshPhongMaterial||hn.isMeshToonMaterial||hn.isMeshLambertMaterial||hn.isMeshBasicMaterial||hn.isMeshStandardMaterial||hn.isShaderMaterial||hn.isShadowMaterial||hn.skinning)&&ya.setValue(Wt,"viewMatrix",Mt.matrixWorldInverse)}if(hn.skinning){ya.setOptional(Wt,Fn,"bindMatrix"),ya.setOptional(Wt,Fn,"bindMatrixInverse");const mt=Fn.skeleton;if(mt)if(Jt.floatVertexTextures){if(void 0===mt.boneTexture){let en=Math.sqrt(4*mt.bones.length);en=er.ceilPowerOfTwo(en),en=Math.max(en,4);const bn=new Float32Array(en*en*4);bn.set(mt.boneMatrices);const jn=new ul(bn,en,en,mo,qo);mt.boneMatrices=bn,mt.boneTexture=jn,mt.boneTextureSize=en}ya.setValue(Wt,"boneTexture",mt.boneTexture,ln),ya.setValue(Wt,"boneTextureSize",mt.boneTextureSize)}else ya.setOptional(Wt,mt,"boneMatrices")}var Zo,cu;return(ra||oi.receiveShadow!==Fn.receiveShadow)&&(oi.receiveShadow=Fn.receiveShadow,ya.setValue(Wt,"receiveShadow",Fn.receiveShadow)),ra&&(ya.setValue(Wt,"toneMappingExposure",c.toneMappingExposure),oi.needsLights&&((Zo=Ia).ambientLightColor.needsUpdate=cu=Ss,Zo.lightProbe.needsUpdate=cu,Zo.directionalLights.needsUpdate=cu,Zo.directionalLightShadows.needsUpdate=cu,Zo.pointLights.needsUpdate=cu,Zo.pointLightShadows.needsUpdate=cu,Zo.spotLights.needsUpdate=cu,Zo.spotLightShadows.needsUpdate=cu,Zo.rectAreaLights.needsUpdate=cu,Zo.hemisphereLights.needsUpdate=cu),pr&&hn.fog&&tn.refreshFogUniforms(Ia,pr),tn.refreshMaterialUniforms(Ia,hn,Mi,Ae,Be),void 0!==Ia.ltc_1&&(Ia.ltc_1.value=cr.LTC_1),void 0!==Ia.ltc_2&&(Ia.ltc_2.value=cr.LTC_2),Bp.upload(Wt,oi.uniformsList,Ia,ln)),hn.isShaderMaterial&&!0===hn.uniformsNeedUpdate&&(Bp.upload(Wt,oi.uniformsList,Ia,ln),hn.uniformsNeedUpdate=!1),hn.isSpriteMaterial&&ya.setValue(Wt,"center",Fn.center),ya.setValue(Wt,"modelViewMatrix",Fn.modelViewMatrix),ya.setValue(Wt,"normalMatrix",Fn.normalMatrix),ya.setValue(Wt,"modelMatrix",Fn.matrixWorld),Ri}hp.setAnimationLoop(function(Mt){Br.isPresenting||lu&&lu(Mt)}),typeof window<"u"&&hp.setContext(window),this.setAnimationLoop=function(Mt){lu=Mt,Br.setAnimationLoop(Mt),null===Mt?hp.stop():hp.start()},this.render=function(Mt,In){let hn,Fn;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),hn=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),Fn=arguments[3]),void 0!==In&&!0!==In.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===p)return;un.resetDefaultState(),U=-1,te=null,!0===Mt.autoUpdate&&Mt.updateMatrixWorld(),null===In.parent&&In.updateMatrixWorld(),!0===Br.enabled&&!0===Br.isPresenting&&(In=Br.getCamera(In)),!0===Mt.isScene&&Mt.onBeforeRender(c,Mt,In,hn||O),e=Yn.get(Mt,In),e.init(),Ye.multiplyMatrices(In.projectionMatrix,In.matrixWorldInverse),gt.setFromProjectionMatrix(Ye),Ht=this.localClippingEnabled,Ut=xt.init(this.clippingPlanes,Ht,In),S=Mn.get(Mt,In),S.init(),Id(Mt,In,0,c.sortObjects),S.finish(),!0===c.sortObjects&&S.sort(ke,Je),!0===Ut&&xt.beginShadows(),zi.render(e.state.shadowsArray,Mt,In),e.setupLights(In),!0===Ut&&xt.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==hn&&this.setRenderTarget(hn),Vn.render(S,Mt,In,Fn);const Mi=S.opaque,Ni=S.transparent;Mi.length>0&&Od(Mi,Mt,In),Ni.length>0&&Od(Ni,Mt,In),!0===Mt.isScene&&Mt.onAfterRender(c,Mt,In),null!==O&&(ln.updateRenderTargetMipmap(O),ln.updateMultisampleRenderTarget(O)),St.buffers.depth.setTest(!0),St.buffers.depth.setMask(!0),St.buffers.color.setMask(!0),St.setPolygonOffset(!1),S=null,e=null},this.setFramebuffer=function(Mt){_!==Mt&&null===O&&Wt.bindFramebuffer(36160,Mt),_=Mt},this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return O},this.setRenderTarget=function(Mt,In,hn){O=Mt,w=In,L=hn,Mt&&void 0===It.get(Mt).__webglFramebuffer&&ln.setupRenderTarget(Mt);let Fn=_,pr=!1;if(Mt){const Mi=It.get(Mt).__webglFramebuffer;Mt.isWebGLCubeRenderTarget?(Fn=Mi[In||0],pr=!0):Fn=Mt.isWebGLMultisampleRenderTarget?It.get(Mt).__webglMultisampledFramebuffer:Mi,oe.copy(Mt.viewport),de.copy(Mt.scissor),ve=Mt.scissorTest}else oe.copy(We).multiplyScalar(Ae).floor(),de.copy(rt).multiplyScalar(Ae).floor(),ve=nt;if(F!==Fn&&(Wt.bindFramebuffer(36160,Fn),F=Fn),St.viewport(oe),St.scissor(de),St.setScissorTest(ve),pr){const Mi=It.get(Mt.texture);Wt.framebufferTexture2D(36160,36064,34069+(In||0),Mi.__webglTexture,hn||0)}},this.readRenderTargetPixels=function(Mt,In,hn,Fn,pr,Mi,Ni){if(!Mt||!Mt.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let oi=It.get(Mt).__webglFramebuffer;if(Mt.isWebGLCubeRenderTarget&&void 0!==Ni&&(oi=oi[Ni]),oi){let ws=!1;oi!==F&&(Wt.bindFramebuffer(36160,oi),ws=!0);try{const is=Mt.texture,ra=is.format,Ss=is.type;if(ra!==mo&&Tn.convert(ra)!==Wt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(Ss===oa||Tn.convert(Ss)===Wt.getParameter(35738)||Ss===qo&&(Jt.isWebGL2||lt.get("OES_texture_float")||lt.get("WEBGL_color_buffer_float"))||Ss===ms&&lt.get(Jt.isWebGL2?"EXT_color_buffer_float":"EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Wt.checkFramebufferStatus(36160)?In>=0&&In<=Mt.width-Fn&&hn>=0&&hn<=Mt.height-pr&&Wt.readPixels(In,hn,Fn,pr,Tn.convert(ra),Tn.convert(Ss),Mi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{ws&&Wt.bindFramebuffer(36160,F)}}},this.copyFramebufferToTexture=function(Mt,In,hn){void 0===hn&&(hn=0);const Fn=Math.pow(2,-hn),pr=Math.floor(In.image.width*Fn),Mi=Math.floor(In.image.height*Fn),Ni=Tn.convert(In.format);ln.setTexture2D(In,0),Wt.copyTexImage2D(3553,hn,Ni,Mt.x,Mt.y,pr,Mi,0),St.unbindTexture()},this.copyTextureToTexture=function(Mt,In,hn,Fn){void 0===Fn&&(Fn=0);const pr=In.image.width,Mi=In.image.height,Ni=Tn.convert(hn.format),oi=Tn.convert(hn.type);ln.setTexture2D(hn,0),Wt.pixelStorei(37440,hn.flipY),Wt.pixelStorei(37441,hn.premultiplyAlpha),Wt.pixelStorei(3317,hn.unpackAlignment),In.isDataTexture?Wt.texSubImage2D(3553,Fn,Mt.x,Mt.y,pr,Mi,Ni,oi,In.image.data):In.isCompressedTexture?Wt.compressedTexSubImage2D(3553,Fn,Mt.x,Mt.y,In.mipmaps[0].width,In.mipmaps[0].height,Ni,In.mipmaps[0].data):Wt.texSubImage2D(3553,Fn,Mt.x,Mt.y,Ni,oi,In.image),0===Fn&&hn.generateMipmaps&&Wt.generateMipmap(3553),St.unbindTexture()},this.initTexture=function(Mt){ln.setTexture2D(Mt,0),St.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Xd(t){qd.call(this,t)}function uf(t,u){this.name="",this.color=new or(t),this.density=void 0!==u?u:25e-5}function Yd(t,u,m){this.name="",this.color=new or(t),this.near=void 0!==u?u:1,this.far=void 0!==m?m:1e3}function Ca(t,u){this.array=t,this.stride=u,this.count=void 0!==t?t.length/u:0,this.usage=yi,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=er.generateUUID()}Vd.prototype=Object.assign(Object.create(Ns.prototype),{constructor:Vd,isArrayCamera:!0}),tc.prototype=Object.assign(Object.create(Zn.prototype),{constructor:tc,isGroup:!0}),Object.assign(Mu.prototype,{constructor:Mu,getHandSpace:function(){if(null===this._hand&&(this._hand=new tc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let t=0;t<=window.XRHand.LITTLE_PHALANX_TIP;t++){let u=new tc;u.matrixAutoUpdate=!1,u.visible=!1,this._hand.joints.push(u),this._hand.add(u)}return this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new tc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new tc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,u,m){let g=null,E=null,I=null;const V=this._targetRay,Z=this._grip,J=this._hand;if(t)if(t.hand){I=!0;for(let ee=0;ee<=window.XRHand.LITTLE_PHALANX_TIP;ee++)if(t.hand[ee]){let _e=u.getJointPose(t.hand[ee],m);const S=J.joints[ee];null!==_e&&(S.matrix.fromArray(_e.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=_e.radius),S.visible=null!==_e;const e=J.joints[window.XRHand.INDEX_PHALANX_TIP],c=J.joints[window.XRHand.THUMB_PHALANX_TIP],p=e.position.distanceTo(c.position),_=.02,w=.005;J.inputState.pinching&&p>_+w?(J.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!J.inputState.pinching&&p<=_-w&&(J.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}}else null!==V&&(g=u.getPose(t.targetRaySpace,m),null!==g&&(V.matrix.fromArray(g.transform.matrix),V.matrix.decompose(V.position,V.rotation,V.scale))),null!==Z&&t.gripSpace&&(E=u.getPose(t.gripSpace,m),null!==E&&(Z.matrix.fromArray(E.transform.matrix),Z.matrix.decompose(Z.position,Z.rotation,Z.scale)));return null!==V&&(V.visible=null!==g),null!==Z&&(Z.visible=null!==E),null!==J&&(J.visible=null!==I),this}}),Object.assign(Wd.prototype,ca.prototype),Xd.prototype=Object.assign(Object.create(qd.prototype),{constructor:Xd,isWebGL1Renderer:!0}),Object.assign(uf.prototype,{isFogExp2:!0,clone:function(){return new uf(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Yd.prototype,{isFog:!0,clone:function(){return new Yd(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Ca.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Ca.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,u,m){t*=this.stride,m*=u.stride;for(let g=0,E=this.stride;g<E;g++)this.array[t+g]=u.array[m+g];return this},set:function(t,u){return void 0===u&&(u=0),this.array.set(t,u),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=er.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const u=new Ca(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return u.setUsage(this.usage),u},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=er.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const Kc=new ot;function wh(t,u,m,g){this.name="",this.data=t,this.itemSize=u,this.offset=m,this.normalized=!0===g}function _i(t){zr.call(this),this.type="SpriteMaterial",this.color=new or(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}let Zp;Object.defineProperties(wh.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(wh.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(let u=0,m=this.data.count;u<m;u++)Kc.x=this.getX(u),Kc.y=this.getY(u),Kc.z=this.getZ(u),Kc.applyMatrix4(t),this.setXYZ(u,Kc.x,Kc.y,Kc.z);return this},setX:function(t,u){return this.data.array[t*this.data.stride+this.offset]=u,this},setY:function(t,u){return this.data.array[t*this.data.stride+this.offset+1]=u,this},setZ:function(t,u){return this.data.array[t*this.data.stride+this.offset+2]=u,this},setW:function(t,u){return this.data.array[t*this.data.stride+this.offset+3]=u,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,u,m){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this},setXYZ:function(t,u,m,g){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this.data.array[t+2]=g,this},setXYZW:function(t,u,m,g,E){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this.data.array[t+2]=g,this.data.array[t+3]=E,this},clone:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const u=[];for(let m=0;m<this.count;m++){const g=m*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)u.push(this.data.array[g+E])}return new Hr(new this.array.constructor(u),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new wh(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const u=[];for(let m=0;m<this.count;m++){const g=m*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)u.push(this.data.array[g+E])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:u,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),(_i.prototype=Object.create(zr.prototype)).constructor=_i,_i.prototype.isSpriteMaterial=!0,_i.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};const Jd=new ot,Qp=new ot,xd=new ot,Rp=new Sn,wd=new Sn,Rl=new ni,hf=new ot,Zd=new ot,pf=new ot,Cf=new Sn,Lf=new Sn,Bf=new Sn;function Wa(t){if(Zn.call(this),this.type="Sprite",void 0===Zp){Zp=new pn;const u=new Ca(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Zp.setIndex([0,1,2,0,2,3]),Zp.setAttribute("position",new wh(u,3,0,!1)),Zp.setAttribute("uv",new wh(u,2,3,!1))}this.geometry=Zp,this.material=void 0!==t?t:new _i,this.center=new Sn(.5,.5)}function Sh(t,u,m,g,E,I){Rp.subVectors(t,m).addScalar(.5).multiply(g),void 0!==E?(wd.x=I*Rp.x-E*Rp.y,wd.y=E*Rp.x+I*Rp.y):wd.copy(Rp),t.copy(u),t.x+=wd.x,t.y+=wd.y,t.applyMatrix4(Rl)}Wa.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Wa,isSprite:!0,raycast:function(t,u){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Qp.setFromMatrixScale(this.matrixWorld),Rl.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),xd.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Qp.multiplyScalar(-xd.z);const m=this.material.rotation;let g,E;0!==m&&(E=Math.cos(m),g=Math.sin(m));const I=this.center;Sh(hf.set(-.5,-.5,0),xd,I,Qp,g,E),Sh(Zd.set(.5,-.5,0),xd,I,Qp,g,E),Sh(pf.set(.5,.5,0),xd,I,Qp,g,E),Cf.set(0,0),Lf.set(1,0),Bf.set(1,1);let V=t.ray.intersectTriangle(hf,Zd,pf,!1,Jd);if(null===V&&(Sh(Zd.set(-.5,.5,0),xd,I,Qp,g,E),Lf.set(0,1),V=t.ray.intersectTriangle(hf,pf,Zd,!1,Jd),null===V))return;const Z=t.ray.origin.distanceTo(Jd);Z<t.near||Z>t.far||u.push({distance:Z,point:Jd.clone(),uv:Pr.getUV(Jd,hf,Zd,pf,Cf,Lf,Bf,new Sn),face:null,object:this})},copy:function(t){return Zn.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});const Kp=new ot,cm=new ot;function Qd(){Zn.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Kd(t,u){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Li.call(this,t,u),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ni,this.bindMatrixInverse=new ni}Qd.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Qd,isLOD:!0,copy:function(t){Zn.prototype.copy.call(this,t,!1);const u=t.levels;for(let m=0,g=u.length;m<g;m++){const E=u[m];this.addLevel(E.object.clone(),E.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,u){void 0===u&&(u=0),u=Math.abs(u);const m=this.levels;let g;for(g=0;g<m.length&&!(u<m[g].distance);g++);return m.splice(g,0,{distance:u,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){const u=this.levels;if(u.length>0){let m,g;for(m=1,g=u.length;m<g&&!(t<u[m].distance);m++);return u[m-1].object}return null},raycast:function(t,u){if(this.levels.length>0){Kp.setFromMatrixPosition(this.matrixWorld);const m=t.ray.origin.distanceTo(Kp);this.getObjectForDistance(m).raycast(t,u)}},update:function(t){const u=this.levels;if(u.length>1){Kp.setFromMatrixPosition(t.matrixWorld),cm.setFromMatrixPosition(this.matrixWorld);const m=Kp.distanceTo(cm)/t.zoom;let g,E;for(u[0].object.visible=!0,g=1,E=u.length;g<E&&m>=u[g].distance;g++)u[g-1].object.visible=!1,u[g].object.visible=!0;for(this._currentLevel=g-1;g<E;g++)u[g].object.visible=!1}},toJSON:function(t){const u=Zn.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(u.object.autoUpdate=!1),u.object.levels=[];const m=this.levels;for(let g=0,E=m.length;g<E;g++){const I=m[g];u.object.levels.push({object:I.object.uuid,distance:I.distance})}return u}}),Kd.prototype=Object.assign(Object.create(Li.prototype),{constructor:Kd,isSkinnedMesh:!0,copy:function(t){return Li.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,u){this.skeleton=t,void 0===u&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),u=this.matrixWorld),this.bindMatrix.copy(u),this.bindMatrixInverse.getInverse(u)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const t=new bi,u=this.geometry.attributes.skinWeight;for(let m=0,g=u.count;m<g;m++){t.x=u.getX(m),t.y=u.getY(m),t.z=u.getZ(m),t.w=u.getW(m);const E=1/t.manhattanLength();E!==1/0?t.multiplyScalar(E):t.set(1,0,0,0),u.setXYZW(m,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Li.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const t=new ot,u=new bi,m=new bi,g=new ot,E=new ni;return function(I,V){const Z=this.skeleton,J=this.geometry;u.fromBufferAttribute(J.attributes.skinIndex,I),m.fromBufferAttribute(J.attributes.skinWeight,I),t.fromBufferAttribute(J.attributes.position,I).applyMatrix4(this.bindMatrix),V.set(0,0,0);for(let ee=0;ee<4;ee++){const _e=m.getComponent(ee);if(0!==_e){const S=u.getComponent(ee);E.multiplyMatrices(Z.bones[S].matrixWorld,Z.boneInverses[S]),V.addScaledVector(g.copy(t).applyMatrix4(E),_e)}}return V.applyMatrix4(this.bindMatrixInverse)}}()});const um=new ni,Fm=new ni;function ef(t,u){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===u)this.calculateInverses();else if(this.bones.length===u.length)this.boneInverses=u.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let m=0,g=this.bones.length;m<g;m++)this.boneInverses.push(new ni)}}function Cc(){Zn.call(this),this.type="Bone"}Object.assign(ef.prototype,{calculateInverses:function(){this.boneInverses=[];for(let t=0,u=this.bones.length;t<u;t++){const m=new ni;this.bones[t]&&m.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(m)}},pose:function(){for(let t=0,u=this.bones.length;t<u;t++){const m=this.bones[t];m&&m.matrixWorld.getInverse(this.boneInverses[t])}for(let t=0,u=this.bones.length;t<u;t++){const m=this.bones[t];m&&(m.parent&&m.parent.isBone?(m.matrix.getInverse(m.parent.matrixWorld),m.matrix.multiply(m.matrixWorld)):m.matrix.copy(m.matrixWorld),m.matrix.decompose(m.position,m.quaternion,m.scale))}},update:function(){const t=this.bones,u=this.boneInverses,m=this.boneMatrices,g=this.boneTexture;for(let E=0,I=t.length;E<I;E++)um.multiplyMatrices(t[E]?t[E].matrixWorld:Fm,u[E]),um.toArray(m,16*E);void 0!==g&&(g.needsUpdate=!0)},clone:function(){return new ef(this.bones,this.boneInverses)},getBoneByName:function(t){for(let u=0,m=this.bones.length;u<m;u++){const g=this.bones[u];if(g.name===t)return g}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Cc.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Cc,isBone:!0});const Eh=new ni,Ji=new ni,cn=[],ed=new Li;function cs(t,u,m){Li.call(this,t,u),this.instanceMatrix=new Hr(new Float32Array(16*m),16),this.count=m,this.frustumCulled=!1}function Ir(t){zr.call(this),this.type="LineBasicMaterial",this.color=new or(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}cs.prototype=Object.assign(Object.create(Li.prototype),{constructor:cs,isInstancedMesh:!0,copy:function(t){return Li.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),this.count=t.count,this},getMatrixAt:function(t,u){u.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,u){const m=this.matrixWorld,g=this.count;if(ed.geometry=this.geometry,ed.material=this.material,void 0!==ed.material)for(let E=0;E<g;E++){this.getMatrixAt(E,Eh),Ji.multiplyMatrices(m,Eh),ed.matrixWorld=Ji,ed.raycast(t,cn);for(let I=0,V=cn.length;I<V;I++){const Z=cn[I];Z.instanceId=E,Z.object=this,u.push(Z)}cn.length=0}},setMatrixAt:function(t,u){u.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),(Ir.prototype=Object.create(zr.prototype)).constructor=Ir,Ir.prototype.isLineBasicMaterial=!0,Ir.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};const Nf=new ot,eu=new ot,nh=new ni,rh=new _o,Js=new zn;function Di(t,u,m){1===m&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Zn.call(this),this.type="Line",this.geometry=void 0!==t?t:new pn,this.material=void 0!==u?u:new Ir,this.updateMorphTargets()}Di.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Di,isLine:!0,copy:function(t){return Zn.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const u=t.attributes.position,m=[0];for(let g=1,E=u.count;g<E;g++)Nf.fromBufferAttribute(u,g-1),eu.fromBufferAttribute(u,g),m[g]=m[g-1],m[g]+=Nf.distanceTo(eu);t.setAttribute("lineDistance",new Dn(m,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const u=t.vertices,m=t.lineDistances;m[0]=0;for(let g=1,E=u.length;g<E;g++)m[g]=m[g-1],m[g]+=u[g-1].distanceTo(u[g])}return this},raycast:function(t,u){const m=this.geometry,g=this.matrixWorld,E=t.params.Line.threshold;if(null===m.boundingSphere&&m.computeBoundingSphere(),Js.copy(m.boundingSphere),Js.applyMatrix4(g),Js.radius+=E,!1===t.ray.intersectsSphere(Js))return;nh.getInverse(g),rh.copy(t.ray).applyMatrix4(nh);const I=E/((this.scale.x+this.scale.y+this.scale.z)/3),V=I*I,Z=new ot,J=new ot,ee=new ot,_e=new ot,S=this&&this.isLineSegments?2:1;if(m.isBufferGeometry){const e=m.index,c=m.attributes.position.array;if(null!==e){const p=e.array;for(let _=0,w=p.length-1;_<w;_+=S){const O=p[_+1];if(Z.fromArray(c,3*p[_]),J.fromArray(c,3*O),rh.distanceSqToSegment(Z,J,_e,ee)>V)continue;_e.applyMatrix4(this.matrixWorld);const F=t.ray.origin.distanceTo(_e);F<t.near||F>t.far||u.push({distance:F,point:ee.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else for(let p=0,_=c.length/3-1;p<_;p+=S){if(Z.fromArray(c,3*p),J.fromArray(c,3*p+3),rh.distanceSqToSegment(Z,J,_e,ee)>V)continue;_e.applyMatrix4(this.matrixWorld);const w=t.ray.origin.distanceTo(_e);w<t.near||w>t.far||u.push({distance:w,point:ee.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}}else if(m.isGeometry){const e=m.vertices,c=e.length;for(let p=0;p<c-1;p+=S){if(rh.distanceSqToSegment(e[p],e[p+1],_e,ee)>V)continue;_e.applyMatrix4(this.matrixWorld);const _=t.ray.origin.distanceTo(_e);_<t.near||_>t.far||u.push({distance:_,point:ee.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const V=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[V]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const nc=new ot,td=new ot;function Wi(t,u){Di.call(this,t,u),this.type="LineSegments"}function Pp(t,u){Di.call(this,t,u),this.type="LineLoop"}function Pl(t){zr.call(this),this.type="PointsMaterial",this.color=new or(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Wi.prototype=Object.assign(Object.create(Di.prototype),{constructor:Wi,isLineSegments:!0,computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const u=t.attributes.position,m=[];for(let g=0,E=u.count;g<E;g+=2)nc.fromBufferAttribute(u,g),td.fromBufferAttribute(u,g+1),m[g]=0===g?0:m[g-1],m[g+1]=m[g]+nc.distanceTo(td);t.setAttribute("lineDistance",new Dn(m,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const u=t.vertices,m=t.lineDistances;for(let g=0,E=u.length;g<E;g+=2)nc.copy(u[g]),td.copy(u[g+1]),m[g]=0===g?0:m[g-1],m[g+1]=m[g]+nc.distanceTo(td)}return this}}),Pp.prototype=Object.assign(Object.create(Di.prototype),{constructor:Pp,isLineLoop:!0}),(Pl.prototype=Object.create(zr.prototype)).constructor=Pl,Pl.prototype.isPointsMaterial=!0,Pl.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};const Do=new ni,Il=new _o,fa=new zn,rc=new ot;function tu(t,u){Zn.call(this),this.type="Points",this.geometry=void 0!==t?t:new pn,this.material=void 0!==u?u:new Pl,this.updateMorphTargets()}function qa(t,u,m,g,E,I,V){const Z=Il.distanceSqToPoint(t);if(Z<m){const J=new ot;Il.closestPointToPoint(t,J),J.applyMatrix4(g);const ee=E.ray.origin.distanceTo(J);if(ee<E.near||ee>E.far)return;I.push({distance:ee,distanceToRay:Math.sqrt(Z),point:J,index:u,face:null,object:V})}}function Sd(t,u,m,g,E,I,V,Z,J){di.call(this,t,u,m,g,E,I,V,Z,J),this.format=void 0!==V?V:Is,this.minFilter=void 0!==I?I:ai,this.magFilter=void 0!==E?E:ai,this.generateMipmaps=!1;const ee=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function _e(){ee.needsUpdate=!0,t.requestVideoFrameCallback(_e)})}function Au(t,u,m,g,E,I,V,Z,J,ee,_e,S){di.call(this,null,I,V,Z,J,ee,g,E,_e,S),this.image={width:u,height:m},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function $u(t,u,m,g,E,I,V,Z,J){di.call(this,t,u,m,g,E,I,V,Z,J),this.needsUpdate=!0}function Cu(t,u,m,g,E,I,V,Z,J,ee){if((ee=void 0!==ee?ee:Lo)!==Lo&&ee!==qs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===m&&ee===Lo&&(m=Dc),void 0===m&&ee===qs&&(m=Ts),di.call(this,null,g,E,I,V,Z,ee,m,J),this.image={width:t,height:u},this.magFilter=void 0!==V?V:Or,this.minFilter=void 0!==Z?Z:Or,this.flipY=!1,this.generateMipmaps=!1}function Ol(t){pn.call(this),this.type="WireframeGeometry";const u=[],m=[0,0],g={},E=["a","b","c"];if(t&&t.isGeometry){const I=t.faces;for(let V=0,Z=I.length;V<Z;V++){const J=I[V];for(let ee=0;ee<3;ee++){const _e=J[E[ee]],S=J[E[(ee+1)%3]];m[0]=Math.min(_e,S),m[1]=Math.max(_e,S);const e=m[0]+","+m[1];void 0===g[e]&&(g[e]={index1:m[0],index2:m[1]})}}for(const V in g){const Z=g[V];let J=t.vertices[Z.index1];u.push(J.x,J.y,J.z),J=t.vertices[Z.index2],u.push(J.x,J.y,J.z)}}else if(t&&t.isBufferGeometry){let I=new ot;if(null!==t.index){const V=t.attributes.position,Z=t.index;let J=t.groups;0===J.length&&(J=[{start:0,count:Z.count,materialIndex:0}]);for(let ee=0,_e=J.length;ee<_e;++ee){const S=J[ee],e=S.start;for(let c=e,p=e+S.count;c<p;c+=3)for(let _=0;_<3;_++){const w=Z.getX(c+_),L=Z.getX(c+(_+1)%3);m[0]=Math.min(w,L),m[1]=Math.max(w,L);const O=m[0]+","+m[1];void 0===g[O]&&(g[O]={index1:m[0],index2:m[1]})}}for(const ee in g){const _e=g[ee];I.fromBufferAttribute(V,_e.index1),u.push(I.x,I.y,I.z),I.fromBufferAttribute(V,_e.index2),u.push(I.x,I.y,I.z)}}else{const V=t.attributes.position;for(let Z=0,J=V.count/3;Z<J;Z++)for(let ee=0;ee<3;ee++)I.fromBufferAttribute(V,3*Z+ee),u.push(I.x,I.y,I.z),I.fromBufferAttribute(V,3*Z+(ee+1)%3),u.push(I.x,I.y,I.z)}}this.setAttribute("position",new Dn(u,3))}function nu(t,u,m){Fr.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:u,stacks:m},this.fromBufferGeometry(new Lc(t,u,m)),this.mergeVertices()}function Lc(t,u,m){pn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:u,stacks:m};const g=[],E=[],I=[],V=[],Z=1e-5,J=new ot,ee=new ot,_e=new ot,S=new ot,e=new ot;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const c=u+1;for(let p=0;p<=m;p++){const _=p/m;for(let w=0;w<=u;w++){const L=w/u;t(L,_,ee),E.push(ee.x,ee.y,ee.z),L-Z>=0?(t(L-Z,_,_e),S.subVectors(ee,_e)):(t(L+Z,_,_e),S.subVectors(_e,ee)),_-Z>=0?(t(L,_-Z,_e),e.subVectors(ee,_e)):(t(L,_+Z,_e),e.subVectors(_e,ee)),J.crossVectors(S,e).normalize(),I.push(J.x,J.y,J.z),V.push(L,_)}}for(let p=0;p<m;p++)for(let _=0;_<u;_++){const L=p*c+_+1,O=(p+1)*c+_+1,F=(p+1)*c+_;g.push(p*c+_,L,F),g.push(L,O,F)}this.setIndex(g),this.setAttribute("position",new Dn(E,3)),this.setAttribute("normal",new Dn(I,3)),this.setAttribute("uv",new Dn(V,2))}function Th(t,u,m,g){Fr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:u,radius:m,detail:g},this.fromBufferGeometry(new Ds(t,u,m,g)),this.mergeVertices()}function Ds(t,u,m,g){pn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:u,radius:m,detail:g},m=m||1;const E=[],I=[];function V(S,e,c,p){const _=Math.pow(2,p),w=[];for(let L=0;L<=_;L++){w[L]=[];const O=S.clone().lerp(c,L/_),F=e.clone().lerp(c,L/_),U=_-L;for(let te=0;te<=U;te++)w[L][te]=0===te&&L===_?O:O.clone().lerp(F,te/U)}for(let L=0;L<_;L++)for(let O=0;O<2*(_-L)-1;O++){const F=Math.floor(O/2);O%2==0?(Z(w[L][F+1]),Z(w[L+1][F]),Z(w[L][F])):(Z(w[L][F+1]),Z(w[L+1][F+1]),Z(w[L+1][F]))}}function Z(S){E.push(S.x,S.y,S.z)}function J(S,e){const c=3*S;e.x=t[c+0],e.y=t[c+1],e.z=t[c+2]}function ee(S,e,c,p){p<0&&1===S.x&&(I[e]=S.x-1),0===c.x&&0===c.z&&(I[e]=p/2/Math.PI+.5)}function _e(S){return Math.atan2(S.z,-S.x)}(function(S){const e=new ot,c=new ot,p=new ot;for(let _=0;_<u.length;_+=3)J(u[_+0],e),J(u[_+1],c),J(u[_+2],p),V(e,c,p,S)})(g=g||0),function(S){const e=new ot;for(let c=0;c<E.length;c+=3)e.x=E[c+0],e.y=E[c+1],e.z=E[c+2],e.normalize().multiplyScalar(S),E[c+0]=e.x,E[c+1]=e.y,E[c+2]=e.z}(m),function(){const S=new ot;for(let c=0;c<E.length;c+=3){S.x=E[c+0],S.y=E[c+1],S.z=E[c+2];const p=_e(S)/2/Math.PI+.5,_=(e=S,Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5);I.push(p,1-_)}var e;(function(){const c=new ot,p=new ot,_=new ot,w=new ot,L=new Sn,O=new Sn,F=new Sn;for(let U=0,te=0;U<E.length;U+=9,te+=6){c.set(E[U+0],E[U+1],E[U+2]),p.set(E[U+3],E[U+4],E[U+5]),_.set(E[U+6],E[U+7],E[U+8]),L.set(I[te+0],I[te+1]),O.set(I[te+2],I[te+3]),F.set(I[te+4],I[te+5]),w.copy(c).add(p).add(_).divideScalar(3);const ce=_e(w);ee(L,te+0,c,ce),ee(O,te+2,p,ce),ee(F,te+4,_,ce)}})(),function(){for(let c=0;c<I.length;c+=6){const p=I[c+0],_=I[c+2],w=I[c+4],L=Math.max(p,_,w),O=Math.min(p,_,w);L>.9&&O<.1&&(p<.2&&(I[c+0]+=1),_<.2&&(I[c+2]+=1),w<.2&&(I[c+4]+=1))}}()}(),this.setAttribute("position",new Dn(E,3)),this.setAttribute("normal",new Dn(E.slice(),3)),this.setAttribute("uv",new Dn(I,2)),0===g?this.computeVertexNormals():this.normalizeNormals()}function Lu(t,u){Fr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new ih(t,u)),this.mergeVertices()}function ih(t,u){Ds.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,u),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Mh(t,u){Fr.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new Zs(t,u)),this.mergeVertices()}function Zs(t,u){Ds.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,u),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:u}}function kl(t,u){Fr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new Ps(t,u)),this.mergeVertices()}function Ps(t,u){const m=(1+Math.sqrt(5))/2;Ds.call(this,[-1,m,0,1,m,0,-1,-m,0,1,-m,0,0,-1,m,0,1,m,0,-1,-m,0,1,-m,m,0,-1,m,0,1,-m,0,-1,-m,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,u),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Xa(t,u){Fr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new La(t,u)),this.mergeVertices()}function La(t,u){const m=(1+Math.sqrt(5))/2,g=1/m;Ds.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-g,-m,0,-g,m,0,g,-m,0,g,m,-g,-m,0,-g,m,0,g,-m,0,g,m,0,-m,0,-g,m,0,-g,-m,0,g,m,0,g],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,u),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Bc(t,u,m,g,E,I){Fr.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:u,radius:m,radialSegments:g,closed:E},void 0!==I&&console.warn("THREE.TubeGeometry: taper has been removed.");const V=new dl(t,u,m,g,E);this.tangents=V.tangents,this.normals=V.normals,this.binormals=V.binormals,this.fromBufferGeometry(V),this.mergeVertices()}function dl(t,u,m,g,E){pn.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:u,radius:m,radialSegments:g,closed:E},m=m||1,g=g||8;const I=t.computeFrenetFrames(u=u||64,E=E||!1);this.tangents=I.tangents,this.normals=I.normals,this.binormals=I.binormals;const V=new ot,Z=new ot,J=new Sn;let ee=new ot;const _e=[],S=[],e=[],c=[];function p(_){ee=t.getPointAt(_/u,ee);const w=I.normals[_],L=I.binormals[_];for(let O=0;O<=g;O++){const F=O/g*Math.PI*2,U=Math.sin(F),te=-Math.cos(F);Z.x=te*w.x+U*L.x,Z.y=te*w.y+U*L.y,Z.z=te*w.z+U*L.z,Z.normalize(),S.push(Z.x,Z.y,Z.z),V.x=ee.x+m*Z.x,V.y=ee.y+m*Z.y,V.z=ee.z+m*Z.z,_e.push(V.x,V.y,V.z)}}(function(){for(let _=0;_<u;_++)p(_);p(!1===E?u:0),function(){for(let _=0;_<=u;_++)for(let w=0;w<=g;w++)J.x=_/u,J.y=w/g,e.push(J.x,J.y)}(),function(){for(let _=1;_<=u;_++)for(let w=1;w<=g;w++){const O=(g+1)*_+(w-1),F=(g+1)*_+w,U=(g+1)*(_-1)+w;c.push((g+1)*(_-1)+(w-1),O,U),c.push(O,F,U)}}()})(),this.setIndex(c),this.setAttribute("position",new Dn(_e,3)),this.setAttribute("normal",new Dn(S,3)),this.setAttribute("uv",new Dn(e,2))}function Bu(t,u,m,g,E,I,V){Fr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:u,tubularSegments:m,radialSegments:g,p:E,q:I},void 0!==V&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Zi(t,u,m,g,E,I)),this.mergeVertices()}function Zi(t,u,m,g,E,I){pn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:u,tubularSegments:m,radialSegments:g,p:E,q:I},t=t||1,u=u||.4,m=Math.floor(m)||64,g=Math.floor(g)||8,E=E||2,I=I||3;const V=[],Z=[],J=[],ee=[],_e=new ot,S=new ot,e=new ot,c=new ot,p=new ot,_=new ot,w=new ot;for(let O=0;O<=m;++O){const F=O/m*E*Math.PI*2;L(F,E,I,t,e),L(F+.01,E,I,t,c),_.subVectors(c,e),w.addVectors(c,e),p.crossVectors(_,w),w.crossVectors(p,_),p.normalize(),w.normalize();for(let U=0;U<=g;++U){const te=U/g*Math.PI*2,ce=-u*Math.cos(te),oe=u*Math.sin(te);_e.x=e.x+(ce*w.x+oe*p.x),_e.y=e.y+(ce*w.y+oe*p.y),_e.z=e.z+(ce*w.z+oe*p.z),Z.push(_e.x,_e.y,_e.z),S.subVectors(_e,e).normalize(),J.push(S.x,S.y,S.z),ee.push(O/m),ee.push(U/g)}}for(let O=1;O<=m;O++)for(let F=1;F<=g;F++){const te=(g+1)*O+(F-1),ce=(g+1)*O+F,oe=(g+1)*(O-1)+F;V.push((g+1)*(O-1)+(F-1),te,oe),V.push(te,ce,oe)}function L(O,F,U,te,ce){const oe=Math.cos(O),de=Math.sin(O),ve=U/F*O,Me=Math.cos(ve);ce.x=te*(2+Me)*.5*oe,ce.y=te*(2+Me)*de*.5,ce.z=te*Math.sin(ve)*.5}this.setIndex(V),this.setAttribute("position",new Dn(Z,3)),this.setAttribute("normal",new Dn(J,3)),this.setAttribute("uv",new Dn(ee,2))}function nd(t,u,m,g,E){Fr.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:u,radialSegments:m,tubularSegments:g,arc:E},this.fromBufferGeometry(new Ip(t,u,m,g,E)),this.mergeVertices()}function Ip(t,u,m,g,E){pn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:u,radialSegments:m,tubularSegments:g,arc:E},t=t||1,u=u||.4,m=Math.floor(m)||8,g=Math.floor(g)||6,E=E||2*Math.PI;const I=[],V=[],Z=[],J=[],ee=new ot,_e=new ot,S=new ot;for(let e=0;e<=m;e++)for(let c=0;c<=g;c++){const p=c/g*E,_=e/m*Math.PI*2;_e.x=(t+u*Math.cos(_))*Math.cos(p),_e.y=(t+u*Math.cos(_))*Math.sin(p),_e.z=u*Math.sin(_),V.push(_e.x,_e.y,_e.z),ee.x=t*Math.cos(p),ee.y=t*Math.sin(p),S.subVectors(_e,ee).normalize(),Z.push(S.x,S.y,S.z),J.push(c/g),J.push(e/m)}for(let e=1;e<=m;e++)for(let c=1;c<=g;c++){const _=(g+1)*(e-1)+c-1,w=(g+1)*(e-1)+c,L=(g+1)*e+c;I.push((g+1)*e+c-1,_,L),I.push(_,w,L)}this.setIndex(I),this.setAttribute("position",new Dn(V,3)),this.setAttribute("normal",new Dn(Z,3)),this.setAttribute("uv",new Dn(J,2))}function Ed(t,u,m,g,E){let I,V;if(E===function(Z,J,ee,_e){let S=0;for(let e=J,c=ee-_e;e<ee;e+=_e)S+=(Z[c]-Z[e])*(Z[e+1]+Z[c+1]),c=e;return S}(t,u,m,g)>0)for(I=u;I<m;I+=g)V=Ya(I,t[I],t[I+1],V);else for(I=m-g;I>=u;I-=g)V=Ya(I,t[I],t[I+1],V);return V&&ns(V,V.next)&&(rd(V),V=V.next),V}function ic(t,u){if(!t)return t;u||(u=t);let m,g=t;do{if(m=!1,g.steiner||!ns(g,g.next)&&0!==br(g.prev,g,g.next))g=g.next;else{if(rd(g),g=u=g.prev,g===g.next)break;m=!0}}while(m||g!==u);return u}function Go(t,u,m,g,E,I,V){if(!t)return;!V&&I&&function(_e,S,e,c){let p=_e;do{null===p.z&&(p.z=Mo(p.x,p.y,S,e,c)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next}while(p!==_e);p.prevZ.nextZ=null,p.prevZ=null,function(_){let w,L,O,F,U,te,ce,oe,de=1;do{for(L=_,_=null,U=null,te=0;L;){for(te++,O=L,ce=0,w=0;w<de&&(ce++,O=O.nextZ,O);w++);for(oe=de;ce>0||oe>0&&O;)0!==ce&&(0===oe||!O||L.z<=O.z)?(F=L,L=L.nextZ,ce--):(F=O,O=O.nextZ,oe--),U?U.nextZ=F:_=F,F.prevZ=U,U=F;L=O}U.nextZ=null,de*=2}while(te>1)}(p)}(t,g,E,I);let Z,J,ee=t;for(;t.prev!==t.next;)if(Z=t.prev,J=t.next,I?ru(t,g,E,I):wi(t))u.push(Z.i/m),u.push(t.i/m),u.push(J.i/m),rd(t),t=J.next,ee=J.next;else if((t=J)===ee){V?1===V?Go(t=zt(ic(t),u,m),u,m,g,E,I,2):2===V&&Op(t,u,m,g,E,I):Go(ic(t),u,m,g,E,I,1);break}}function wi(t){let u=t.prev,m=t,g=t.next;if(br(u,m,g)>=0)return!1;let E=t.next.next;for(;E!==t.prev;){if(Qs(u.x,u.y,m.x,m.y,g.x,g.y,E.x,E.y)&&br(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function ru(t,u,m,g){let E=t.prev,I=t,V=t.next;if(br(E,I,V)>=0)return!1;let ee=E.x>I.x?E.x>V.x?E.x:V.x:I.x>V.x?I.x:V.x,_e=E.y>I.y?E.y>V.y?E.y:V.y:I.y>V.y?I.y:V.y,S=Mo(E.x<I.x?E.x<V.x?E.x:V.x:I.x<V.x?I.x:V.x,E.y<I.y?E.y<V.y?E.y:V.y:I.y<V.y?I.y:V.y,u,m,g),e=Mo(ee,_e,u,m,g),c=t.prevZ,p=t.nextZ;for(;c&&c.z>=S&&p&&p.z<=e;){if(c!==t.prev&&c!==t.next&&Qs(E.x,E.y,I.x,I.y,V.x,V.y,c.x,c.y)&&br(c.prev,c,c.next)>=0||(c=c.prevZ,p!==t.prev&&p!==t.next&&Qs(E.x,E.y,I.x,I.y,V.x,V.y,p.x,p.y)&&br(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;c&&c.z>=S;){if(c!==t.prev&&c!==t.next&&Qs(E.x,E.y,I.x,I.y,V.x,V.y,c.x,c.y)&&br(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;p&&p.z<=e;){if(p!==t.prev&&p!==t.next&&Qs(E.x,E.y,I.x,I.y,V.x,V.y,p.x,p.y)&&br(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function zt(t,u,m){let g=t;do{let E=g.prev,I=g.next.next;!ns(E,I)&&$i(E,g,g.next,I)&&Po(E,I)&&Po(I,E)&&(u.push(E.i/m),u.push(g.i/m),u.push(I.i/m),rd(g),rd(g.next),g=t=I),g=g.next}while(g!==t);return ic(g)}function Op(t,u,m,g,E,I){let V=t;do{let Z=V.next.next;for(;Z!==V.prev;){if(V.i!==Z.i&&df(V,Z)){let J=iu(V,Z);return V=ic(V,V.next),J=ic(J,J.next),Go(V,u,m,g,E,I),void Go(J,u,m,g,E,I)}Z=Z.next}V=V.next}while(V!==t)}function Ui(t,u){return t.x-u.x}function xs(t,u){if(u=function(m,g){let E,I=g,V=m.x,Z=m.y,J=-1/0;do{if(Z<=I.y&&Z>=I.next.y&&I.next.y!==I.y){let p=I.x+(Z-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(p<=V&&p>J){if(J=p,p===V){if(Z===I.y)return I;if(Z===I.next.y)return I.next}E=I.x<I.next.x?I:I.next}}I=I.next}while(I!==g);if(!E)return null;if(V===J)return E;let ee,_e=E,S=E.x,e=E.y,c=1/0;I=E;do{V>=I.x&&I.x>=S&&V!==I.x&&Qs(Z<e?V:J,Z,S,e,Z<e?J:V,Z,I.x,I.y)&&(ee=Math.abs(Z-I.y)/(V-I.x),Po(I,m)&&(ee<c||ee===c&&(I.x>E.x||I.x===E.x&&to(E,I)))&&(E=I,c=ee)),I=I.next}while(I!==_e);return E}(t,u)){const m=iu(u,t);ic(u,u.next),ic(m,m.next)}}function to(t,u){return br(t.prev,t,u.prev)<0&&br(u.next,t,t.next)<0}function Mo(t,u,m,g,E){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-m)*E)|t<<8))|t<<4))|t<<2))|t<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=32767*(u-g)*E)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function Nu(t){let u=t,m=t;do{(u.x<m.x||u.x===m.x&&u.y<m.y)&&(m=u),u=u.next}while(u!==t);return m}function Qs(t,u,m,g,E,I,V,Z){return(E-V)*(u-Z)-(t-V)*(I-Z)>=0&&(t-V)*(g-Z)-(m-V)*(u-Z)>=0&&(m-V)*(I-Z)-(E-V)*(g-Z)>=0}function df(t,u){return t.next.i!==u.i&&t.prev.i!==u.i&&!function(m,g){let E=m;do{if(E.i!==m.i&&E.next.i!==m.i&&E.i!==g.i&&E.next.i!==g.i&&$i(E,E.next,m,g))return!0;E=E.next}while(E!==m);return!1}(t,u)&&(Po(t,u)&&Po(u,t)&&function(m,g){let E=m,I=!1,V=(m.x+g.x)/2,Z=(m.y+g.y)/2;do{E.y>Z!=E.next.y>Z&&E.next.y!==E.y&&V<(E.next.x-E.x)*(Z-E.y)/(E.next.y-E.y)+E.x&&(I=!I),E=E.next}while(E!==m);return I}(t,u)&&(br(t.prev,t,u.prev)||br(t,u.prev,u))||ns(t,u)&&br(t.prev,t,t.next)>0&&br(u.prev,u,u.next)>0)}function br(t,u,m){return(u.y-t.y)*(m.x-u.x)-(u.x-t.x)*(m.y-u.y)}function ns(t,u){return t.x===u.x&&t.y===u.y}function $i(t,u,m,g){const E=ii(br(t,u,m)),I=ii(br(t,u,g)),V=ii(br(m,g,t)),Z=ii(br(m,g,u));return E!==I&&V!==Z||!(0!==E||!Ro(t,m,u))||!(0!==I||!Ro(t,g,u))||!(0!==V||!Ro(m,t,g))||!(0!==Z||!Ro(m,u,g))}function Ro(t,u,m){return u.x<=Math.max(t.x,m.x)&&u.x>=Math.min(t.x,m.x)&&u.y<=Math.max(t.y,m.y)&&u.y>=Math.min(t.y,m.y)}function ii(t){return t>0?1:t<0?-1:0}function Po(t,u){return br(t.prev,t,t.next)<0?br(t,u,t.next)>=0&&br(t,t.prev,u)>=0:br(t,u,t.prev)<0||br(t,t.next,u)<0}function iu(t,u){let m=new kp(t.i,t.x,t.y),g=new kp(u.i,u.x,u.y),E=t.next,I=u.prev;return t.next=u,u.prev=t,m.next=E,E.prev=m,g.next=m,m.prev=g,I.next=g,g.prev=I,g}function Ya(t,u,m,g){const E=new kp(t,u,m);return g?(E.next=g.next,E.prev=g,g.next.prev=E,g.next=E):(E.prev=E,E.next=E),E}function rd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function kp(t,u,m){this.i=t,this.x=u,this.y=m,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}tu.prototype=Object.assign(Object.create(Zn.prototype),{constructor:tu,isPoints:!0,copy:function(t){return Zn.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,u){const m=this.geometry,g=this.matrixWorld,E=t.params.Points.threshold;if(null===m.boundingSphere&&m.computeBoundingSphere(),fa.copy(m.boundingSphere),fa.applyMatrix4(g),fa.radius+=E,!1===t.ray.intersectsSphere(fa))return;Do.getInverse(g),Il.copy(t.ray).applyMatrix4(Do);const I=E/((this.scale.x+this.scale.y+this.scale.z)/3),V=I*I;if(m.isBufferGeometry){const Z=m.index,J=m.attributes.position.array;if(null!==Z){const ee=Z.array;for(let _e=0,S=ee.length;_e<S;_e++){const e=ee[_e];rc.fromArray(J,3*e),qa(rc,e,V,g,t,u,this)}}else for(let ee=0,_e=J.length/3;ee<_e;ee++)rc.fromArray(J,3*ee),qa(rc,ee,V,g,t,u,this)}else{const Z=m.vertices;for(let J=0,ee=Z.length;J<ee;J++)qa(Z[J],J,V,g,t,u,this)}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const V=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[V]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),Sd.prototype=Object.assign(Object.create(di.prototype),{constructor:Sd,isVideoTexture:!0,update:function(){const t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),(Au.prototype=Object.create(di.prototype)).constructor=Au,Au.prototype.isCompressedTexture=!0,($u.prototype=Object.create(di.prototype)).constructor=$u,$u.prototype.isCanvasTexture=!0,(Cu.prototype=Object.create(di.prototype)).constructor=Cu,Cu.prototype.isDepthTexture=!0,(Ol.prototype=Object.create(pn.prototype)).constructor=Ol,(nu.prototype=Object.create(Fr.prototype)).constructor=nu,(Lc.prototype=Object.create(pn.prototype)).constructor=Lc,(Th.prototype=Object.create(Fr.prototype)).constructor=Th,(Ds.prototype=Object.create(pn.prototype)).constructor=Ds,(Lu.prototype=Object.create(Fr.prototype)).constructor=Lu,(ih.prototype=Object.create(Ds.prototype)).constructor=ih,(Mh.prototype=Object.create(Fr.prototype)).constructor=Mh,(Zs.prototype=Object.create(Ds.prototype)).constructor=Zs,(kl.prototype=Object.create(Fr.prototype)).constructor=kl,(Ps.prototype=Object.create(Ds.prototype)).constructor=Ps,(Xa.prototype=Object.create(Fr.prototype)).constructor=Xa,(La.prototype=Object.create(Ds.prototype)).constructor=La,(Bc.prototype=Object.create(Fr.prototype)).constructor=Bc,(dl.prototype=Object.create(pn.prototype)).constructor=dl,dl.prototype.toJSON=function(){const t=pn.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},(Bu.prototype=Object.create(Fr.prototype)).constructor=Bu,(Zi.prototype=Object.create(pn.prototype)).constructor=Zi,(nd.prototype=Object.create(Fr.prototype)).constructor=nd,(Ip.prototype=Object.create(pn.prototype)).constructor=Ip;const oh={area:function(t){const u=t.length;let m=0;for(let g=u-1,E=0;E<u;g=E++)m+=t[g].x*t[E].y-t[E].x*t[g].y;return.5*m},isClockWise:function(t){return oh.area(t)<0},triangulateShape:function(t,u){const m=[],g=[],E=[];Fp(t),sh(m,t);let I=t.length;u.forEach(Fp);for(let Z=0;Z<u.length;Z++)g.push(I),I+=u[Z].length,sh(m,u[Z]);const V=function(Z,J,ee){ee=ee||2;let _e,S,e,c,p,_,w,L=J&&J.length,O=L?J[0]*ee:Z.length,F=Ed(Z,0,O,ee,!0),U=[];if(!F||F.next===F.prev)return U;if(L&&(F=function(te,ce,oe,de){let ve,Me,Be,Ae,ke,Je=[];for(ve=0,Me=ce.length;ve<Me;ve++)Be=ce[ve]*de,Ae=ve<Me-1?ce[ve+1]*de:te.length,ke=Ed(te,Be,Ae,de,!1),ke===ke.next&&(ke.steiner=!0),Je.push(Nu(ke));for(Je.sort(Ui),ve=0;ve<Je.length;ve++)xs(Je[ve],oe),oe=ic(oe,oe.next);return oe}(Z,J,F,ee)),Z.length>80*ee){_e=e=Z[0],S=c=Z[1];for(let te=ee;te<O;te+=ee)p=Z[te],_=Z[te+1],p<_e&&(_e=p),_<S&&(S=_),p>e&&(e=p),_>c&&(c=_);w=Math.max(e-_e,c-S),w=0!==w?1/w:0}return Go(F,U,ee,_e,S,w),U}(m,g);for(let Z=0;Z<V.length;Z+=3)E.push(V.slice(Z,Z+3));return E}};function Fp(t){const u=t.length;u>2&&t[u-1].equals(t[0])&&t.pop()}function sh(t,u){for(let m=0;m<u.length;m++)t.push(u[m].x),t.push(u[m].y)}function ou(t,u){Fr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:u},this.fromBufferGeometry(new ma(t,u)),this.mergeVertices()}function ma(t,u){pn.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:u},t=Array.isArray(t)?t:[t];const m=this,g=[],E=[];for(let V=0,Z=t.length;V<Z;V++)I(t[V]);function I(V){const Z=[],J=void 0!==u.curveSegments?u.curveSegments:12,ee=void 0!==u.steps?u.steps:1;let _e=void 0!==u.depth?u.depth:100,S=void 0===u.bevelEnabled||u.bevelEnabled,e=void 0!==u.bevelThickness?u.bevelThickness:6,c=void 0!==u.bevelSize?u.bevelSize:e-2,p=void 0!==u.bevelOffset?u.bevelOffset:0,_=void 0!==u.bevelSegments?u.bevelSegments:3;const w=u.extrudePath,L=void 0!==u.UVGenerator?u.UVGenerator:od;void 0!==u.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),_e=u.amount);let O,F,U,te,ce,oe=!1;w&&(O=w.getSpacedPoints(ee),oe=!0,S=!1,F=w.computeFrenetFrames(ee,!1),U=new ot,te=new ot,ce=new ot),S||(_=0,e=0,c=0,p=0);const de=V.extractPoints(J);let ve=de.shape;const Me=de.holes;if(!oh.isClockWise(ve)){ve=ve.reverse();for(let St=0,jt=Me.length;St<jt;St++){const It=Me[St];oh.isClockWise(It)&&(Me[St]=It.reverse())}}const Be=oh.triangulateShape(ve,Me),Ae=ve;for(let St=0,jt=Me.length;St<jt;St++)ve=ve.concat(Me[St]);function ke(St,jt,It){return jt||console.error("THREE.ExtrudeGeometry: vec does not exist"),jt.clone().multiplyScalar(It).add(St)}const Je=ve.length,We=Be.length;function rt(St,jt,It){let ln,Ze,st;const Pt=St.x-jt.x,Gt=St.y-jt.y,tn=It.x-St.x,Mn=It.y-St.y,Yn=Pt*Pt+Gt*Gt;if(Math.abs(Pt*Mn-Gt*tn)>Number.EPSILON){const sn=Math.sqrt(Yn),dt=Math.sqrt(tn*tn+Mn*Mn),an=jt.x-Gt/sn,Tn=jt.y+Pt/sn,un=((It.x-Mn/dt-an)*Mn-(It.y+tn/dt-Tn)*tn)/(Pt*Mn-Gt*tn);ln=an+Pt*un-St.x,Ze=Tn+Gt*un-St.y;const Wt=ln*ln+Ze*Ze;if(Wt<=2)return new Sn(ln,Ze);st=Math.sqrt(Wt/2)}else{let sn=!1;Pt>Number.EPSILON?tn>Number.EPSILON&&(sn=!0):Pt<-Number.EPSILON?tn<-Number.EPSILON&&(sn=!0):Math.sign(Gt)===Math.sign(Mn)&&(sn=!0),sn?(ln=-Gt,Ze=Pt,st=Math.sqrt(Yn)):(ln=Pt,Ze=Gt,st=Math.sqrt(Yn/2))}return new Sn(ln/st,Ze/st)}const nt=[];for(let St=0,jt=Ae.length,It=jt-1,ln=St+1;St<jt;St++,It++,ln++)It===jt&&(It=0),ln===jt&&(ln=0),nt[St]=rt(Ae[St],Ae[It],Ae[ln]);const gt=[];let xt,Ut=nt.concat();for(let St=0,jt=Me.length;St<jt;St++){const It=Me[St];xt=[];for(let ln=0,Ze=It.length,st=Ze-1,Pt=ln+1;ln<Ze;ln++,st++,Pt++)st===Ze&&(st=0),Pt===Ze&&(Pt=0),xt[ln]=rt(It[ln],It[st],It[Pt]);gt.push(xt),Ut=Ut.concat(xt)}for(let St=0;St<_;St++){const jt=St/_,It=e*Math.cos(jt*Math.PI/2),ln=c*Math.sin(jt*Math.PI/2)+p;for(let Ze=0,st=Ae.length;Ze<st;Ze++){const Pt=ke(Ae[Ze],nt[Ze],ln);pt(Pt.x,Pt.y,-It)}for(let Ze=0,st=Me.length;Ze<st;Ze++){const Pt=Me[Ze];xt=gt[Ze];for(let Gt=0,tn=Pt.length;Gt<tn;Gt++){const Mn=ke(Pt[Gt],xt[Gt],ln);pt(Mn.x,Mn.y,-It)}}}const Ht=c+p;for(let St=0;St<Je;St++){const jt=S?ke(ve[St],Ut[St],Ht):ve[St];oe?(te.copy(F.normals[0]).multiplyScalar(jt.x),U.copy(F.binormals[0]).multiplyScalar(jt.y),ce.copy(O[0]).add(te).add(U),pt(ce.x,ce.y,ce.z)):pt(jt.x,jt.y,0)}for(let St=1;St<=ee;St++)for(let jt=0;jt<Je;jt++){const It=S?ke(ve[jt],Ut[jt],Ht):ve[jt];oe?(te.copy(F.normals[St]).multiplyScalar(It.x),U.copy(F.binormals[St]).multiplyScalar(It.y),ce.copy(O[St]).add(te).add(U),pt(ce.x,ce.y,ce.z)):pt(It.x,It.y,_e/ee*St)}for(let St=_-1;St>=0;St--){const jt=St/_,It=e*Math.cos(jt*Math.PI/2),ln=c*Math.sin(jt*Math.PI/2)+p;for(let Ze=0,st=Ae.length;Ze<st;Ze++){const Pt=ke(Ae[Ze],nt[Ze],ln);pt(Pt.x,Pt.y,_e+It)}for(let Ze=0,st=Me.length;Ze<st;Ze++){const Pt=Me[Ze];xt=gt[Ze];for(let Gt=0,tn=Pt.length;Gt<tn;Gt++){const Mn=ke(Pt[Gt],xt[Gt],ln);oe?pt(Mn.x,Mn.y+O[ee-1].y,O[ee-1].x+It):pt(Mn.x,Mn.y,_e+It)}}}function Ye(St,jt){let It=St.length;for(;--It>=0;){const ln=It;let Ze=It-1;Ze<0&&(Ze=St.length-1);for(let st=0,Pt=ee+2*_;st<Pt;st++){const Gt=Je*st,tn=Je*(st+1);Rt(jt+ln+Gt,jt+Ze+Gt,jt+Ze+tn,jt+ln+tn)}}}function pt(St,jt,It){Z.push(St),Z.push(jt),Z.push(It)}function Vt(St,jt,It){lt(St),lt(jt),lt(It);const ln=g.length/3,Ze=L.generateTopUV(m,g,ln-3,ln-2,ln-1);Jt(Ze[0]),Jt(Ze[1]),Jt(Ze[2])}function Rt(St,jt,It,ln){lt(St),lt(jt),lt(ln),lt(jt),lt(It),lt(ln);const Ze=g.length/3,st=L.generateSideWallUV(m,g,Ze-6,Ze-3,Ze-2,Ze-1);Jt(st[0]),Jt(st[1]),Jt(st[3]),Jt(st[1]),Jt(st[2]),Jt(st[3])}function lt(St){g.push(Z[3*St+0]),g.push(Z[3*St+1]),g.push(Z[3*St+2])}function Jt(St){E.push(St.x),E.push(St.y)}(function(){const St=g.length/3;if(S){let jt=0,It=Je*jt;for(let ln=0;ln<We;ln++){const Ze=Be[ln];Vt(Ze[2]+It,Ze[1]+It,Ze[0]+It)}jt=ee+2*_,It=Je*jt;for(let ln=0;ln<We;ln++){const Ze=Be[ln];Vt(Ze[0]+It,Ze[1]+It,Ze[2]+It)}}else{for(let jt=0;jt<We;jt++){const It=Be[jt];Vt(It[2],It[1],It[0])}for(let jt=0;jt<We;jt++){const It=Be[jt];Vt(It[0]+Je*ee,It[1]+Je*ee,It[2]+Je*ee)}}m.addGroup(St,g.length/3-St,0)})(),function(){const St=g.length/3;let jt=0;Ye(Ae,jt),jt+=Ae.length;for(let It=0,ln=Me.length;It<ln;It++){const Ze=Me[It];Ye(Ze,jt),jt+=Ze.length}m.addGroup(St,g.length/3-St,1)}()}this.setAttribute("position",new Dn(g,3)),this.setAttribute("uv",new Dn(E,2)),this.computeVertexNormals()}(ou.prototype=Object.create(Fr.prototype)).constructor=ou,ou.prototype.toJSON=function(){const t=Fr.prototype.toJSON.call(this);return sd(this.parameters.shapes,this.parameters.options,t)},(ma.prototype=Object.create(pn.prototype)).constructor=ma,ma.prototype.toJSON=function(){const t=pn.prototype.toJSON.call(this);return sd(this.parameters.shapes,this.parameters.options,t)};const od={generateTopUV:function(t,u,m,g,E){const Z=u[3*g],J=u[3*g+1],ee=u[3*E],_e=u[3*E+1];return[new Sn(u[3*m],u[3*m+1]),new Sn(Z,J),new Sn(ee,_e)]},generateSideWallUV:function(t,u,m,g,E,I){const V=u[3*m],Z=u[3*m+1],J=u[3*m+2],ee=u[3*g],_e=u[3*g+1],S=u[3*g+2],e=u[3*E],c=u[3*E+1],p=u[3*E+2],_=u[3*I],w=u[3*I+1],L=u[3*I+2];return Math.abs(Z-_e)<.01?[new Sn(V,1-J),new Sn(ee,1-S),new Sn(e,1-p),new Sn(_,1-L)]:[new Sn(Z,1-J),new Sn(_e,1-S),new Sn(c,1-p),new Sn(w,1-L)]}};function sd(t,u,m){if(m.shapes=[],Array.isArray(t))for(let g=0,E=t.length;g<E;g++)m.shapes.push(t[g].uuid);else m.shapes.push(t.uuid);return void 0!==u.extrudePath&&(m.options.extrudePath=u.extrudePath.toJSON()),m}function vo(t,u){Fr.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:u},this.fromBufferGeometry(new Cr(t,u)),this.mergeVertices()}function Cr(t,u){const m=(u=u||{}).font;if(!m||!m.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Fr;const g=m.generateShapes(t,u.size);u.depth=void 0!==u.height?u.height:50,void 0===u.bevelThickness&&(u.bevelThickness=10),void 0===u.bevelSize&&(u.bevelSize=8),void 0===u.bevelEnabled&&(u.bevelEnabled=!1),ma.call(this,g,u),this.type="TextBufferGeometry"}function Xr(t,u,m,g,E,I,V){Fr.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:u,heightSegments:m,phiStart:g,phiLength:E,thetaStart:I,thetaLength:V},this.fromBufferGeometry(new Ru(t,u,m,g,E,I,V)),this.mergeVertices()}function Ru(t,u,m,g,E,I,V){pn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:u,heightSegments:m,phiStart:g,phiLength:E,thetaStart:I,thetaLength:V},t=t||1,u=Math.max(3,Math.floor(u)||8),m=Math.max(2,Math.floor(m)||6),g=void 0!==g?g:0,E=void 0!==E?E:2*Math.PI,I=void 0!==I?I:0,V=void 0!==V?V:Math.PI;const Z=Math.min(I+V,Math.PI);let J=0;const ee=[],_e=new ot,S=new ot,e=[],c=[],p=[],_=[];for(let w=0;w<=m;w++){const L=[],O=w/m;let F=0;0==w&&0==I?F=.5/u:w==m&&Z==Math.PI&&(F=-.5/u);for(let U=0;U<=u;U++){const te=U/u;_e.x=-t*Math.cos(g+te*E)*Math.sin(I+O*V),_e.y=t*Math.cos(I+O*V),_e.z=t*Math.sin(g+te*E)*Math.sin(I+O*V),c.push(_e.x,_e.y,_e.z),S.copy(_e).normalize(),p.push(S.x,S.y,S.z),_.push(te+F,1-O),L.push(J++)}ee.push(L)}for(let w=0;w<m;w++)for(let L=0;L<u;L++){const F=ee[w][L],U=ee[w+1][L],te=ee[w+1][L+1];(0!==w||I>0)&&e.push(ee[w][L+1],F,te),(w!==m-1||Z<Math.PI)&&e.push(F,U,te)}this.setIndex(e),this.setAttribute("position",new Dn(c,3)),this.setAttribute("normal",new Dn(p,3)),this.setAttribute("uv",new Dn(_,2))}function Ks(t,u,m,g,E,I){Fr.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:u,thetaSegments:m,phiSegments:g,thetaStart:E,thetaLength:I},this.fromBufferGeometry(new oc(t,u,m,g,E,I)),this.mergeVertices()}function oc(t,u,m,g,E,I){pn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:u,thetaSegments:m,phiSegments:g,thetaStart:E,thetaLength:I},t=t||.5,u=u||1,E=void 0!==E?E:0,I=void 0!==I?I:2*Math.PI,m=void 0!==m?Math.max(3,m):8;const V=[],Z=[],J=[],ee=[];let _e=t;const S=(u-t)/(g=void 0!==g?Math.max(1,g):1),e=new ot,c=new Sn;for(let p=0;p<=g;p++){for(let _=0;_<=m;_++){const w=E+_/m*I;e.x=_e*Math.cos(w),e.y=_e*Math.sin(w),Z.push(e.x,e.y,e.z),J.push(0,0,1),c.x=(e.x/u+1)/2,c.y=(e.y/u+1)/2,ee.push(c.x,c.y)}_e+=S}for(let p=0;p<g;p++){const _=p*(m+1);for(let w=0;w<m;w++){const L=w+_,F=L+m+1,U=L+m+2,te=L+1;V.push(L,F,te),V.push(F,U,te)}}this.setIndex(V),this.setAttribute("position",new Dn(Z,3)),this.setAttribute("normal",new Dn(J,3)),this.setAttribute("uv",new Dn(ee,2))}function np(t,u,m,g){Fr.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:u,phiStart:m,phiLength:g},this.fromBufferGeometry(new Ah(t,u,m,g)),this.mergeVertices()}function Ah(t,u,m,g){pn.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:u,phiStart:m,phiLength:g},u=Math.floor(u)||12,m=m||0,g=g||2*Math.PI,g=er.clamp(g,0,2*Math.PI);const E=[],I=[],V=[],Z=1/u,J=new ot,ee=new Sn;for(let _e=0;_e<=u;_e++){const S=m+_e*Z*g,e=Math.sin(S),c=Math.cos(S);for(let p=0;p<=t.length-1;p++)J.x=t[p].x*e,J.y=t[p].y,J.z=t[p].x*c,I.push(J.x,J.y,J.z),ee.x=_e/u,ee.y=p/(t.length-1),V.push(ee.x,ee.y)}for(let _e=0;_e<u;_e++)for(let S=0;S<t.length-1;S++){const e=S+_e*t.length,p=e+t.length,_=e+t.length+1,w=e+1;E.push(e,p,w),E.push(p,_,w)}if(this.setIndex(E),this.setAttribute("position",new Dn(I,3)),this.setAttribute("uv",new Dn(V,2)),this.computeVertexNormals(),g===2*Math.PI){const _e=this.attributes.normal.array,S=new ot,e=new ot,c=new ot,p=u*t.length*3;for(let _=0,w=0;_<t.length;_++,w+=3)S.x=_e[w+0],S.y=_e[w+1],S.z=_e[w+2],e.x=_e[p+w+0],e.y=_e[p+w+1],e.z=_e[p+w+2],c.addVectors(S,e).normalize(),_e[w+0]=_e[p+w+0]=c.x,_e[w+1]=_e[p+w+1]=c.y,_e[w+2]=_e[p+w+2]=c.z}}function Nc(t,u){Fr.call(this),this.type="ShapeGeometry","object"==typeof u&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),u=u.curveSegments),this.parameters={shapes:t,curveSegments:u},this.fromBufferGeometry(new Xn(t,u)),this.mergeVertices()}function Xn(t,u){pn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:u},u=u||12;const m=[],g=[],E=[],I=[];let V=0,Z=0;if(!1===Array.isArray(t))J(t);else for(let ee=0;ee<t.length;ee++)J(t[ee]),this.addGroup(V,Z,ee),V+=Z,Z=0;function J(ee){const _e=g.length/3,S=ee.extractPoints(u);let e=S.shape;const c=S.holes;!1===oh.isClockWise(e)&&(e=e.reverse());for(let _=0,w=c.length;_<w;_++){const L=c[_];!0===oh.isClockWise(L)&&(c[_]=L.reverse())}const p=oh.triangulateShape(e,c);for(let _=0,w=c.length;_<w;_++)e=e.concat(c[_]);for(let _=0,w=e.length;_<w;_++){const L=e[_];g.push(L.x,L.y,0),E.push(0,0,1),I.push(L.x,L.y)}for(let _=0,w=p.length;_<w;_++){const L=p[_];m.push(L[0]+_e,L[1]+_e,L[2]+_e),Z+=3}}this.setIndex(m),this.setAttribute("position",new Dn(g,3)),this.setAttribute("normal",new Dn(E,3)),this.setAttribute("uv",new Dn(I,2))}function Hi(t,u){if(u.shapes=[],Array.isArray(t))for(let m=0,g=t.length;m<g;m++)u.shapes.push(t[m].uuid);else u.shapes.push(t.uuid);return u}function $h(t,u){pn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:u},u=void 0!==u?u:1;const m=[],g=Math.cos(er.DEG2RAD*u),E=[0,0],I={};let V,Z,J;const ee=["a","b","c"];let _e;t.isBufferGeometry?(_e=new Fr,_e.fromBufferGeometry(t)):_e=t.clone(),_e.mergeVertices(),_e.computeFaceNormals();const S=_e.vertices,e=_e.faces;for(let c=0,p=e.length;c<p;c++){const _=e[c];for(let w=0;w<3;w++)V=_[ee[w]],Z=_[ee[(w+1)%3]],E[0]=Math.min(V,Z),E[1]=Math.max(V,Z),J=E[0]+","+E[1],void 0===I[J]?I[J]={index1:E[0],index2:E[1],face1:c,face2:void 0}:I[J].face2=c}for(J in I){const c=I[J];if(void 0===c.face2||e[c.face1].normal.dot(e[c.face2].normal)<=g){let p=S[c.index1];m.push(p.x,p.y,p.z),p=S[c.index2],m.push(p.x,p.y,p.z)}}this.setAttribute("position",new Dn(m,3))}function Nn(t,u,m,g,E,I,V,Z){Fr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:u,height:m,radialSegments:g,heightSegments:E,openEnded:I,thetaStart:V,thetaLength:Z},this.fromBufferGeometry(new Ho(t,u,m,g,E,I,V,Z)),this.mergeVertices()}function Ho(t,u,m,g,E,I,V,Z){pn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:u,height:m,radialSegments:g,heightSegments:E,openEnded:I,thetaStart:V,thetaLength:Z};const J=this;t=void 0!==t?t:1,u=void 0!==u?u:1,m=m||1,g=Math.floor(g)||8,E=Math.floor(E)||1,I=void 0!==I&&I,V=void 0!==V?V:0,Z=void 0!==Z?Z:2*Math.PI;const ee=[],_e=[],S=[],e=[];let c=0;const p=[],_=m/2;let w=0;function L(O){let F,U;const te=new Sn,ce=new ot;let oe=0;const de=!0===O?t:u,ve=!0===O?1:-1;F=c;for(let Me=1;Me<=g;Me++)_e.push(0,_*ve,0),S.push(0,ve,0),e.push(.5,.5),c++;U=c;for(let Me=0;Me<=g;Me++){const Be=Me/g*Z+V,Ae=Math.cos(Be),ke=Math.sin(Be);ce.x=de*ke,ce.y=_*ve,ce.z=de*Ae,_e.push(ce.x,ce.y,ce.z),S.push(0,ve,0),te.x=.5*Ae+.5,te.y=.5*ke*ve+.5,e.push(te.x,te.y),c++}for(let Me=0;Me<g;Me++){const Be=F+Me,Ae=U+Me;!0===O?ee.push(Ae,Ae+1,Be):ee.push(Ae+1,Ae,Be),oe+=3}J.addGroup(w,oe,!0===O?1:2),w+=oe}(function(){const O=new ot,F=new ot;let U=0;const te=(u-t)/m;for(let ce=0;ce<=E;ce++){const oe=[],de=ce/E,ve=de*(u-t)+t;for(let Me=0;Me<=g;Me++){const Be=Me/g,Ae=Be*Z+V,ke=Math.sin(Ae),Je=Math.cos(Ae);F.x=ve*ke,F.y=-de*m+_,F.z=ve*Je,_e.push(F.x,F.y,F.z),O.set(ke,te,Je).normalize(),S.push(O.x,O.y,O.z),e.push(Be,1-de),oe.push(c++)}p.push(oe)}for(let ce=0;ce<g;ce++)for(let oe=0;oe<E;oe++){const ve=p[oe+1][ce],Me=p[oe+1][ce+1],Be=p[oe][ce+1];ee.push(p[oe][ce],ve,Be),ee.push(ve,Me,Be),U+=6}J.addGroup(w,U,0),w+=U})(),!1===I&&(t>0&&L(!0),u>0&&L(!1)),this.setIndex(ee),this.setAttribute("position",new Dn(_e,3)),this.setAttribute("normal",new Dn(S,3)),this.setAttribute("uv",new Dn(e,2))}function Bi(t,u,m,g,E,I,V){Nn.call(this,0,t,u,m,g,E,I,V),this.type="ConeGeometry",this.parameters={radius:t,height:u,radialSegments:m,heightSegments:g,openEnded:E,thetaStart:I,thetaLength:V}}function Ch(t,u,m,g,E,I,V){Ho.call(this,0,t,u,m,g,E,I,V),this.type="ConeBufferGeometry",this.parameters={radius:t,height:u,radialSegments:m,heightSegments:g,openEnded:E,thetaStart:I,thetaLength:V}}function rp(t,u,m,g){Fr.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:u,thetaStart:m,thetaLength:g},this.fromBufferGeometry(new Lh(t,u,m,g)),this.mergeVertices()}function Lh(t,u,m,g){pn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:u,thetaStart:m,thetaLength:g},t=t||1,u=void 0!==u?Math.max(3,u):8,m=void 0!==m?m:0,g=void 0!==g?g:2*Math.PI;const E=[],I=[],V=[],Z=[],J=new ot,ee=new Sn;I.push(0,0,0),V.push(0,0,1),Z.push(.5,.5);for(let _e=0,S=3;_e<=u;_e++,S+=3){const e=m+_e/u*g;J.x=t*Math.cos(e),J.y=t*Math.sin(e),I.push(J.x,J.y,J.z),V.push(0,0,1),ee.x=(I[S]/t+1)/2,ee.y=(I[S+1]/t+1)/2,Z.push(ee.x,ee.y)}for(let _e=1;_e<=u;_e++)E.push(_e,_e+1,0);this.setIndex(E),this.setAttribute("position",new Dn(I,3)),this.setAttribute("normal",new Dn(V,3)),this.setAttribute("uv",new Dn(Z,2))}(vo.prototype=Object.create(Fr.prototype)).constructor=vo,(Cr.prototype=Object.create(ma.prototype)).constructor=Cr,(Xr.prototype=Object.create(Fr.prototype)).constructor=Xr,(Ru.prototype=Object.create(pn.prototype)).constructor=Ru,(Ks.prototype=Object.create(Fr.prototype)).constructor=Ks,(oc.prototype=Object.create(pn.prototype)).constructor=oc,(np.prototype=Object.create(Fr.prototype)).constructor=np,(Ah.prototype=Object.create(pn.prototype)).constructor=Ah,(Nc.prototype=Object.create(Fr.prototype)).constructor=Nc,Nc.prototype.toJSON=function(){const t=Fr.prototype.toJSON.call(this);return Hi(this.parameters.shapes,t)},(Xn.prototype=Object.create(pn.prototype)).constructor=Xn,Xn.prototype.toJSON=function(){const t=pn.prototype.toJSON.call(this);return Hi(this.parameters.shapes,t)},($h.prototype=Object.create(pn.prototype)).constructor=$h,(Nn.prototype=Object.create(Fr.prototype)).constructor=Nn,(Ho.prototype=Object.create(pn.prototype)).constructor=Ho,(Bi.prototype=Object.create(Nn.prototype)).constructor=Bi,(Ch.prototype=Object.create(Ho.prototype)).constructor=Ch,(rp.prototype=Object.create(Fr.prototype)).constructor=rp,(Lh.prototype=Object.create(pn.prototype)).constructor=Lh;var Us=Object.freeze({__proto__:null,WireframeGeometry:Ol,ParametricGeometry:nu,ParametricBufferGeometry:Lc,TetrahedronGeometry:Lu,TetrahedronBufferGeometry:ih,OctahedronGeometry:Mh,OctahedronBufferGeometry:Zs,IcosahedronGeometry:kl,IcosahedronBufferGeometry:Ps,DodecahedronGeometry:Xa,DodecahedronBufferGeometry:La,PolyhedronGeometry:Th,PolyhedronBufferGeometry:Ds,TubeGeometry:Bc,TubeBufferGeometry:dl,TorusKnotGeometry:Bu,TorusKnotBufferGeometry:Zi,TorusGeometry:nd,TorusBufferGeometry:Ip,TextGeometry:vo,TextBufferGeometry:Cr,SphereGeometry:Xr,SphereBufferGeometry:Ru,RingGeometry:Ks,RingBufferGeometry:oc,PlaneGeometry:Ha,PlaneBufferGeometry:Ll,LatheGeometry:np,LatheBufferGeometry:Ah,ShapeGeometry:Nc,ShapeBufferGeometry:Xn,ExtrudeGeometry:ou,ExtrudeBufferGeometry:ma,EdgesGeometry:$h,ConeGeometry:Bi,ConeBufferGeometry:Ch,CylinderGeometry:Nn,CylinderBufferGeometry:Ho,CircleGeometry:rp,CircleBufferGeometry:Lh,BoxGeometry:Ls,BoxBufferGeometry:Ku});function oo(t){zr.call(this),this.type="ShadowMaterial",this.color=new or(0),this.transparent=!0,this.setValues(t)}function _a(t){go.call(this,t),this.type="RawShaderMaterial"}function Ja(t){zr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new or(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function uo(t){Ja.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Sn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}function Jo(t){zr.call(this),this.type="MeshPhongMaterial",this.color=new or(16777215),this.specular=new or(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function zs(t){zr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new or(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function qi(t){zr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ao(t){zr.call(this),this.type="MeshLambertMaterial",this.color=new or(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Zr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ba(t){zr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new or(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ee,this.normalScale=new Sn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Fl(t){Ir.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}(oo.prototype=Object.create(zr.prototype)).constructor=oo,oo.prototype.isShadowMaterial=!0,oo.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this},(_a.prototype=Object.create(go.prototype)).constructor=_a,_a.prototype.isRawShaderMaterial=!0,(Ja.prototype=Object.create(zr.prototype)).constructor=Ja,Ja.prototype.isMeshStandardMaterial=!0,Ja.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},(uo.prototype=Object.create(Ja.prototype)).constructor=uo,uo.prototype.isMeshPhysicalMaterial=!0,uo.prototype.copy=function(t){return Ja.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new or).copy(t.sheen):null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},(Jo.prototype=Object.create(zr.prototype)).constructor=Jo,Jo.prototype.isMeshPhongMaterial=!0,Jo.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(zs.prototype=Object.create(zr.prototype)).constructor=zs,zs.prototype.isMeshToonMaterial=!0,zs.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(qi.prototype=Object.create(zr.prototype)).constructor=qi,qi.prototype.isMeshNormalMaterial=!0,qi.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Ao.prototype=Object.create(zr.prototype)).constructor=Ao,Ao.prototype.isMeshLambertMaterial=!0,Ao.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Ba.prototype=Object.create(zr.prototype)).constructor=Ba,Ba.prototype.isMeshMatcapMaterial=!0,Ba.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Fl.prototype=Object.create(Ir.prototype)).constructor=Fl,Fl.prototype.isLineDashedMaterial=!0,Fl.prototype.copy=function(t){return Ir.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Bh=Object.freeze({__proto__:null,ShadowMaterial:oo,SpriteMaterial:_i,RawShaderMaterial:_a,ShaderMaterial:go,PointsMaterial:Pl,MeshPhysicalMaterial:uo,MeshStandardMaterial:Ja,MeshPhongMaterial:Jo,MeshToonMaterial:zs,MeshNormalMaterial:qi,MeshLambertMaterial:Ao,MeshDepthMaterial:ep,MeshDistanceMaterial:$a,MeshBasicMaterial:ro,MeshMatcapMaterial:Ba,LineDashedMaterial:Fl,LineBasicMaterial:Ir,Material:zr});const ho={arraySlice:function(t,u,m){return ho.isTypedArray(t)?new t.constructor(t.subarray(u,void 0!==m?m:t.length)):t.slice(u,m)},convertArray:function(t,u,m){return!t||!m&&t.constructor===u?t:"number"==typeof u.BYTES_PER_ELEMENT?new u(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const u=t.length,m=new Array(u);for(let g=0;g!==u;++g)m[g]=g;return m.sort(function(g,E){return t[g]-t[E]}),m},sortedArray:function(t,u,m){const g=t.length,E=new t.constructor(g);for(let I=0,V=0;V!==g;++I){const Z=m[I]*u;for(let J=0;J!==u;++J)E[V++]=t[Z+J]}return E},flattenJSON:function(t,u,m,g){let E=1,I=t[0];for(;void 0!==I&&void 0===I[g];)I=t[E++];if(void 0===I)return;let V=I[g];if(void 0!==V)if(Array.isArray(V))do{V=I[g],void 0!==V&&(u.push(I.time),m.push.apply(m,V)),I=t[E++]}while(void 0!==I);else if(void 0!==V.toArray)do{V=I[g],void 0!==V&&(u.push(I.time),V.toArray(m,m.length)),I=t[E++]}while(void 0!==I);else do{V=I[g],void 0!==V&&(u.push(I.time),m.push(V)),I=t[E++]}while(void 0!==I)},subclip:function(t,u,m,g,E){E=E||30;const I=t.clone();I.name=u;const V=[];for(let J=0;J<I.tracks.length;++J){const ee=I.tracks[J],_e=ee.getValueSize(),S=[],e=[];for(let c=0;c<ee.times.length;++c){const p=ee.times[c]*E;if(!(p<m||p>=g)){S.push(ee.times[c]);for(let _=0;_<_e;++_)e.push(ee.values[c*_e+_])}}0!==S.length&&(ee.times=ho.convertArray(S,ee.times.constructor),ee.values=ho.convertArray(e,ee.values.constructor),V.push(ee))}I.tracks=V;let Z=1/0;for(let J=0;J<I.tracks.length;++J)Z>I.tracks[J].times[0]&&(Z=I.tracks[J].times[0]);for(let J=0;J<I.tracks.length;++J)I.tracks[J].shift(-1*Z);return I.resetDuration(),I},makeClipAdditive:function(t,u,m,g){void 0===u&&(u=0),void 0===m&&(m=t),(void 0===g||g<=0)&&(g=30);const E=t.tracks.length,I=u/g;for(let V=0;V<E;++V){const Z=m.tracks[V],J=Z.ValueTypeName;if("bool"===J||"string"===J)continue;const ee=t.tracks.find(function(p){return p.name===Z.name&&p.ValueTypeName===J});if(void 0===ee)continue;const _e=Z.getValueSize(),S=Z.times.length-1;let e;if(I<=Z.times[0])e=ho.arraySlice(Z.values,0,Z.valueSize);else if(I>=Z.times[S])e=ho.arraySlice(Z.values,S*_e);else{const p=Z.createInterpolant();p.evaluate(I),e=p.resultBuffer}"quaternion"===J&&new So(e[0],e[1],e[2],e[3]).normalize().conjugate().toArray(e);const c=ee.times.length;for(let p=0;p<c;++p){const _=p*_e;if("quaternion"===J)So.multiplyQuaternionsFlat(ee.values,_,e,0,ee.values,_);else for(let w=0;w<_e;++w)ee.values[_+w]-=e[w]}}return t.blendMode=Wu,t}};function ga(t,u,m,g){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==g?g:new u.constructor(m),this.sampleValues=u,this.valueSize=m}function fl(t,u,m,g){ga.call(this,t,u,m,g),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function su(t,u,m,g){ga.call(this,t,u,m,g)}function ea(t,u,m,g){ga.call(this,t,u,m,g)}function us(t,u,m,g){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===u||0===u.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=ho.convertArray(u,this.TimeBufferType),this.values=ho.convertArray(m,this.ValueBufferType),this.setInterpolation(g||this.DefaultInterpolation)}function Nh(t,u,m){us.call(this,t,u,m)}function ml(t,u,m,g){us.call(this,t,u,m,g)}function po(t,u,m,g){us.call(this,t,u,m,g)}function sc(t,u,m,g){ga.call(this,t,u,m,g)}function ah(t,u,m,g){us.call(this,t,u,m,g)}function lh(t,u,m,g){us.call(this,t,u,m,g)}function ac(t,u,m,g){us.call(this,t,u,m,g)}function rs(t,u,m,g){this.name=t,this.tracks=m,this.duration=void 0!==u?u:-1,this.blendMode=void 0!==g?g:Vu,this.uuid=er.generateUUID(),this.duration<0&&this.resetDuration()}function Qi(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const u=function(m){switch(m.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return po;case"vector":case"vector2":case"vector3":case"vector4":return ac;case"color":return ml;case"quaternion":return ah;case"bool":case"boolean":return Nh;case"string":return lh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+m)}(t.type);if(void 0===t.times){const m=[],g=[];ho.flattenJSON(t.keys,m,g,"value"),t.times=m,t.values=g}return void 0!==u.parse?u.parse(t):new u(t.name,t.times,t.values,t.interpolation)}Object.assign(ga.prototype,{evaluate:function(t){let u=this.parameterPositions,m=this._cachedIndex,g=u[m],E=u[m-1];e:{t:{let I;n:{r:if(!(t<g)){for(let V=m+2;;){if(void 0===g){if(t<E)break r;return m=u.length,this._cachedIndex=m,this.afterEnd_(m-1,t,E)}if(m===V)break;if(E=g,g=u[++m],t<g)break t}I=u.length;break n}if(t>=E)break e;{const V=u[1];t<V&&(m=2,E=V);for(let Z=m-2;;){if(void 0===E)return this._cachedIndex=0,this.beforeStart_(0,t,g);if(m===Z)break;if(g=E,E=u[--m-1],t>=E)break t}I=m,m=0}}for(;m<I;){const V=m+I>>>1;t<u[V]?I=V:m=V+1}if(g=u[m],E=u[m-1],void 0===E)return this._cachedIndex=0,this.beforeStart_(0,t,g);if(void 0===g)return m=u.length,this._cachedIndex=m,this.afterEnd_(m-1,E,t)}this._cachedIndex=m,this.intervalChanged_(m,E,g)}return this.interpolate_(m,E,t,g)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const u=this.resultBuffer,m=this.sampleValues,g=this.valueSize,E=t*g;for(let I=0;I!==g;++I)u[I]=m[E+I];return u},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(ga.prototype,{beforeStart_:ga.prototype.copySampleValue_,afterEnd_:ga.prototype.copySampleValue_}),fl.prototype=Object.assign(Object.create(ga.prototype),{constructor:fl,DefaultSettings_:{endingStart:ba,endingEnd:ba},intervalChanged_:function(t,u,m){let g=this.parameterPositions,E=t-2,I=t+1,V=g[E],Z=g[I];if(void 0===V)switch(this.getSettings_().endingStart){case sa:E=t,V=2*u-m;break;case wl:E=g.length-2,V=u+g[E]-g[E+1];break;default:E=t,V=m}if(void 0===Z)switch(this.getSettings_().endingEnd){case sa:I=t,Z=2*m-u;break;case wl:I=1,Z=m+g[1]-g[0];break;default:I=t-1,Z=u}const J=.5*(m-u),ee=this.valueSize;this._weightPrev=J/(u-V),this._weightNext=J/(Z-m),this._offsetPrev=E*ee,this._offsetNext=I*ee},interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,V=this.valueSize,Z=t*V,J=Z-V,ee=this._offsetPrev,_e=this._offsetNext,S=this._weightPrev,e=this._weightNext,c=(m-u)/(g-u),p=c*c,_=p*c,w=-S*_+2*S*p-S*c,L=(1+S)*_+(-1.5-2*S)*p+(-.5+S)*c+1,O=(-1-e)*_+(1.5+e)*p+.5*c,F=e*_-e*p;for(let U=0;U!==V;++U)E[U]=w*I[ee+U]+L*I[J+U]+O*I[Z+U]+F*I[_e+U];return E}}),su.prototype=Object.assign(Object.create(ga.prototype),{constructor:su,interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,V=this.valueSize,Z=t*V,J=Z-V,ee=(m-u)/(g-u),_e=1-ee;for(let S=0;S!==V;++S)E[S]=I[J+S]*_e+I[Z+S]*ee;return E}}),ea.prototype=Object.assign(Object.create(ga.prototype),{constructor:ea,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(us,{toJSON:function(t){const u=t.constructor;let m;if(void 0!==u.toJSON)m=u.toJSON(t);else{m={name:t.name,times:ho.convertArray(t.times,Array),values:ho.convertArray(t.values,Array)};const g=t.getInterpolation();g!==t.DefaultInterpolation&&(m.interpolation=g)}return m.type=t.ValueTypeName,m}}),Object.assign(us.prototype,{constructor:us,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Wl,InterpolantFactoryMethodDiscrete:function(t){return new ea(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new su(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new fl(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let u;switch(t){case Vl:u=this.InterpolantFactoryMethodDiscrete;break;case Wl:u=this.InterpolantFactoryMethodLinear;break;case Hu:u=this.InterpolantFactoryMethodSmooth}if(void 0===u){const m="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(m);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",m),this}return this.createInterpolant=u,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Vl;case this.InterpolantFactoryMethodLinear:return Wl;case this.InterpolantFactoryMethodSmooth:return Hu}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t){const u=this.times;for(let m=0,g=u.length;m!==g;++m)u[m]+=t}return this},scale:function(t){if(1!==t){const u=this.times;for(let m=0,g=u.length;m!==g;++m)u[m]*=t}return this},trim:function(t,u){const m=this.times,g=m.length;let E=0,I=g-1;for(;E!==g&&m[E]<t;)++E;for(;-1!==I&&m[I]>u;)--I;if(++I,0!==E||I!==g){E>=I&&(I=Math.max(I,1),E=I-1);const V=this.getValueSize();this.times=ho.arraySlice(m,E,I),this.values=ho.arraySlice(this.values,E*V,I*V)}return this},validate:function(){let t=!0;const u=this.getValueSize();u-Math.floor(u)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const m=this.times,g=this.values,E=m.length;0===E&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let I=null;for(let V=0;V!==E;V++){const Z=m[V];if("number"==typeof Z&&isNaN(Z)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,V,Z),t=!1;break}if(null!==I&&I>Z){console.error("THREE.KeyframeTrack: Out of order keys.",this,V,Z,I),t=!1;break}I=Z}if(void 0!==g&&ho.isTypedArray(g))for(let V=0,Z=g.length;V!==Z;++V){const J=g[V];if(isNaN(J)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,V,J),t=!1;break}}return t},optimize:function(){const t=ho.arraySlice(this.times),u=ho.arraySlice(this.values),m=this.getValueSize(),g=this.getInterpolation()===Hu,E=t.length-1;let I=1;for(let V=1;V<E;++V){let Z=!1;const J=t[V];if(J!==t[V+1]&&(1!==V||J!==J[0]))if(g)Z=!0;else{const ee=V*m,_e=ee-m,S=ee+m;for(let e=0;e!==m;++e){const c=u[ee+e];if(c!==u[_e+e]||c!==u[S+e]){Z=!0;break}}}if(Z){if(V!==I){t[I]=t[V];const ee=V*m,_e=I*m;for(let S=0;S!==m;++S)u[_e+S]=u[ee+S]}++I}}if(E>0){t[I]=t[E];for(let V=E*m,Z=I*m,J=0;J!==m;++J)u[Z+J]=u[V+J];++I}return I!==t.length?(this.times=ho.arraySlice(t,0,I),this.values=ho.arraySlice(u,0,I*m)):(this.times=t,this.values=u),this},clone:function(){const t=ho.arraySlice(this.times,0),u=ho.arraySlice(this.values,0),m=new this.constructor(this.name,t,u);return m.createInterpolant=this.createInterpolant,m}}),Nh.prototype=Object.assign(Object.create(us.prototype),{constructor:Nh,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Vl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ml.prototype=Object.assign(Object.create(us.prototype),{constructor:ml,ValueTypeName:"color"}),po.prototype=Object.assign(Object.create(us.prototype),{constructor:po,ValueTypeName:"number"}),sc.prototype=Object.assign(Object.create(ga.prototype),{constructor:sc,interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,V=this.valueSize,Z=(m-u)/(g-u);let J=t*V;for(let ee=J+V;J!==ee;J+=4)So.slerpFlat(E,0,I,J-V,I,J,Z);return E}}),ah.prototype=Object.assign(Object.create(us.prototype),{constructor:ah,ValueTypeName:"quaternion",DefaultInterpolation:Wl,InterpolantFactoryMethodLinear:function(t){return new sc(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),lh.prototype=Object.assign(Object.create(us.prototype),{constructor:lh,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Vl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ac.prototype=Object.assign(Object.create(us.prototype),{constructor:ac,ValueTypeName:"vector"}),Object.assign(rs,{parse:function(t){const u=[],m=t.tracks,g=1/(t.fps||1);for(let E=0,I=m.length;E!==I;++E)u.push(Qi(m[E]).scale(g));return new rs(t.name,t.duration,u,t.blendMode)},toJSON:function(t){const u=[],m=t.tracks,g={name:t.name,duration:t.duration,tracks:u,uuid:t.uuid,blendMode:t.blendMode};for(let E=0,I=m.length;E!==I;++E)u.push(us.toJSON(m[E]));return g},CreateFromMorphTargetSequence:function(t,u,m,g){const E=u.length,I=[];for(let V=0;V<E;V++){let Z=[],J=[];Z.push((V+E-1)%E,V,(V+1)%E),J.push(0,1,0);const ee=ho.getKeyframeOrder(Z);Z=ho.sortedArray(Z,1,ee),J=ho.sortedArray(J,1,ee),g||0!==Z[0]||(Z.push(E),J.push(J[0])),I.push(new po(".morphTargetInfluences["+u[V].name+"]",Z,J).scale(1/m))}return new rs(t,-1,I)},findByName:function(t,u){let m=t;Array.isArray(t)||(m=t.geometry&&t.geometry.animations||t.animations);for(let g=0;g<m.length;g++)if(m[g].name===u)return m[g];return null},CreateClipsFromMorphTargetSequences:function(t,u,m){const g={},E=/^([\w-]*?)([\d]+)$/;for(let V=0,Z=t.length;V<Z;V++){const J=t[V],ee=J.name.match(E);if(ee&&ee.length>1){const _e=ee[1];let S=g[_e];S||(g[_e]=S=[]),S.push(J)}}const I=[];for(const V in g)I.push(rs.CreateFromMorphTargetSequence(V,g[V],u,m));return I},parseAnimation:function(t,u){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const m=function(ee,_e,S,e,c){if(0!==S.length){const p=[],_=[];ho.flattenJSON(S,p,_,e),0!==p.length&&c.push(new ee(_e,p,_))}},g=[],E=t.name||"default",I=t.fps||30,V=t.blendMode;let Z=t.length||-1;const J=t.hierarchy||[];for(let ee=0;ee<J.length;ee++){const _e=J[ee].keys;if(_e&&0!==_e.length)if(_e[0].morphTargets){const S={};let e;for(e=0;e<_e.length;e++)if(_e[e].morphTargets)for(let c=0;c<_e[e].morphTargets.length;c++)S[_e[e].morphTargets[c]]=-1;for(const c in S){const p=[],_=[];for(let w=0;w!==_e[e].morphTargets.length;++w){const L=_e[e];p.push(L.time),_.push(L.morphTarget===c?1:0)}g.push(new po(".morphTargetInfluence["+c+"]",p,_))}Z=S.length*(I||1)}else{const S=".bones["+u[ee].name+"]";m(ac,S+".position",_e,"pos",g),m(ah,S+".quaternion",_e,"rot",g),m(ac,S+".scale",_e,"scl",g)}}return 0===g.length?null:new rs(E,Z,g,V)}}),Object.assign(rs.prototype,{resetDuration:function(){let t=0;for(let u=0,m=this.tracks.length;u!==m;++u){const g=this.tracks[u];t=Math.max(t,g.times[g.times.length-1])}return this.duration=t,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let u=0;u<this.tracks.length;u++)t=t&&this.tracks[u].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let u=0;u<this.tracks.length;u++)t.push(this.tracks[u].clone());return new rs(this.name,this.duration,t,this.blendMode)}});const ta={enabled:!1,files:{},add:function(t,u){!1!==this.enabled&&(this.files[t]=u)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Dp(t,u,m){const g=this;let E,I=!1,V=0,Z=0;const J=[];this.onStart=void 0,this.onLoad=t,this.onProgress=u,this.onError=m,this.itemStart=function(ee){Z++,!1===I&&void 0!==g.onStart&&g.onStart(ee,V,Z),I=!0},this.itemEnd=function(ee){V++,void 0!==g.onProgress&&g.onProgress(ee,V,Z),V===Z&&(I=!1,void 0!==g.onLoad&&g.onLoad())},this.itemError=function(ee){void 0!==g.onError&&g.onError(ee)},this.resolveURL=function(ee){return E?E(ee):ee},this.setURLModifier=function(ee){return E=ee,this},this.addHandler=function(ee,_e){return J.push(ee,_e),this},this.removeHandler=function(ee){const _e=J.indexOf(ee);return-1!==_e&&J.splice(_e,2),this},this.getHandler=function(ee){for(let _e=0,S=J.length;_e<S;_e+=2){const e=J[_e],c=J[_e+1];if(e.global&&(e.lastIndex=0),e.test(ee))return c}return null}}const Td=new Dp;function hi(t){this.manager=void 0!==t?t:Td,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(hi.prototype,{load:function(){},loadAsync:function(t,u){const m=this;return new Promise(function(g,E){m.load(t,g,u,E)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});const Rc={};function Dl(t){hi.call(this,t)}function Ul(t){hi.call(this,t)}function Md(t){hi.call(this,t)}function Pc(t){hi.call(this,t)}function Za(t){hi.call(this,t)}function Rh(t){hi.call(this,t)}function Si(t){hi.call(this,t)}function yr(){this.type="Curve",this.arcLengthDivisions=200}function a(t,u,m,g,E,I,V,Z){yr.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=u||0,this.xRadius=m||1,this.yRadius=g||1,this.aStartAngle=E||0,this.aEndAngle=I||2*Math.PI,this.aClockwise=V||!1,this.aRotation=Z||0}function r(t,u,m,g,E,I){a.call(this,t,u,m,m,g,E,I),this.type="ArcCurve"}function h(){let t=0,u=0,m=0,g=0;function E(I,V,Z,J){t=I,u=Z,m=-3*I+3*V-2*Z-J,g=2*I-2*V+Z+J}return{initCatmullRom:function(I,V,Z,J,ee){E(V,Z,ee*(Z-I),ee*(J-V))},initNonuniformCatmullRom:function(I,V,Z,J,ee,_e,S){let e=(V-I)/ee-(Z-I)/(ee+_e)+(Z-V)/_e,c=(Z-V)/_e-(J-V)/(_e+S)+(J-Z)/S;e*=_e,c*=_e,E(V,Z,e,c)},calc:function(I){const V=I*I;return t+u*I+m*V+g*(V*I)}}}Dl.prototype=Object.assign(Object.create(hi.prototype),{constructor:Dl,load:function(t,u,m,g){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=ta.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;if(void 0!==Rc[t])return void Rc[t].push({onLoad:u,onProgress:m,onError:g});const V=t.match(/^data:(.*?)(;base64)?,(.*)$/);let Z;if(V){const J=V[1],ee=!!V[2];let _e=V[3];_e=decodeURIComponent(_e),ee&&(_e=atob(_e));try{let S;const e=(this.responseType||"").toLowerCase();switch(e){case"arraybuffer":case"blob":const c=new Uint8Array(_e.length);for(let _=0;_<_e.length;_++)c[_]=_e.charCodeAt(_);S="blob"===e?new Blob([c.buffer],{type:J}):c.buffer;break;case"document":S=(new DOMParser).parseFromString(_e,J);break;case"json":S=JSON.parse(_e);break;default:S=_e}setTimeout(function(){u&&u(S),E.manager.itemEnd(t)},0)}catch(S){setTimeout(function(){g&&g(S),E.manager.itemError(t),E.manager.itemEnd(t)},0)}}else{Rc[t]=[],Rc[t].push({onLoad:u,onProgress:m,onError:g}),Z=new XMLHttpRequest,Z.open("GET",t,!0),Z.addEventListener("load",function(J){const ee=this.response,_e=Rc[t];if(delete Rc[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ta.add(t,ee);for(let S=0,e=_e.length;S<e;S++){const c=_e[S];c.onLoad&&c.onLoad(ee)}E.manager.itemEnd(t)}else{for(let S=0,e=_e.length;S<e;S++){const c=_e[S];c.onError&&c.onError(J)}E.manager.itemError(t),E.manager.itemEnd(t)}},!1),Z.addEventListener("progress",function(J){const ee=Rc[t];for(let _e=0,S=ee.length;_e<S;_e++){const e=ee[_e];e.onProgress&&e.onProgress(J)}},!1),Z.addEventListener("error",function(J){const ee=Rc[t];delete Rc[t];for(let _e=0,S=ee.length;_e<S;_e++){const e=ee[_e];e.onError&&e.onError(J)}E.manager.itemError(t),E.manager.itemEnd(t)},!1),Z.addEventListener("abort",function(J){const ee=Rc[t];delete Rc[t];for(let _e=0,S=ee.length;_e<S;_e++){const e=ee[_e];e.onError&&e.onError(J)}E.manager.itemError(t),E.manager.itemEnd(t)},!1),void 0!==this.responseType&&(Z.responseType=this.responseType),void 0!==this.withCredentials&&(Z.withCredentials=this.withCredentials),Z.overrideMimeType&&Z.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const J in this.requestHeader)Z.setRequestHeader(J,this.requestHeader[J]);Z.send(null)}return E.manager.itemStart(t),Z},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Ul.prototype=Object.assign(Object.create(hi.prototype),{constructor:Ul,load:function(t,u,m,g){const E=this,I=new Dl(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(V){try{u(E.parse(JSON.parse(V)))}catch(Z){g?g(Z):console.error(Z),E.manager.itemError(t)}},m,g)},parse:function(t){const u=[];for(let m=0;m<t.length;m++){const g=rs.parse(t[m]);u.push(g)}return u}}),Md.prototype=Object.assign(Object.create(hi.prototype),{constructor:Md,load:function(t,u,m,g){const E=this,I=[],V=new Au;V.image=I;const Z=new Dl(this.manager);Z.setPath(this.path),Z.setResponseType("arraybuffer"),Z.setRequestHeader(this.requestHeader);let J=0;function ee(_e){Z.load(t[_e],function(S){const e=E.parse(S,!0);I[_e]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},J+=1,6===J&&(1===e.mipmapCount&&(V.minFilter=ai),V.format=e.format,V.needsUpdate=!0,u&&u(V))},m,g)}if(Array.isArray(t))for(let _e=0,S=t.length;_e<S;++_e)ee(_e);else Z.load(t,function(_e){const S=E.parse(_e,!0);if(S.isCubemap){const e=S.mipmaps.length/S.mipmapCount;for(let c=0;c<e;c++){I[c]={mipmaps:[]};for(let p=0;p<S.mipmapCount;p++)I[c].mipmaps.push(S.mipmaps[c*S.mipmapCount+p]),I[c].format=S.format,I[c].width=S.width,I[c].height=S.height}}else V.image.width=S.width,V.image.height=S.height,V.mipmaps=S.mipmaps;1===S.mipmapCount&&(V.minFilter=ai),V.format=S.format,V.needsUpdate=!0,u&&u(V)},m,g);return V}}),Pc.prototype=Object.assign(Object.create(hi.prototype),{constructor:Pc,load:function(t,u,m,g){const E=this,I=new ul,V=new Dl(this.manager);return V.setResponseType("arraybuffer"),V.setRequestHeader(this.requestHeader),V.setPath(this.path),V.load(t,function(Z){const J=E.parse(Z);J&&(void 0!==J.image?I.image=J.image:void 0!==J.data&&(I.image.width=J.width,I.image.height=J.height,I.image.data=J.data),I.wrapS=void 0!==J.wrapS?J.wrapS:Yr,I.wrapT=void 0!==J.wrapT?J.wrapT:Yr,I.magFilter=void 0!==J.magFilter?J.magFilter:ai,I.minFilter=void 0!==J.minFilter?J.minFilter:ai,I.anisotropy=void 0!==J.anisotropy?J.anisotropy:1,void 0!==J.format&&(I.format=J.format),void 0!==J.type&&(I.type=J.type),void 0!==J.mipmaps&&(I.mipmaps=J.mipmaps,I.minFilter=Ka),1===J.mipmapCount&&(I.minFilter=ai),I.needsUpdate=!0,u&&u(I,J))},m,g),I}}),Za.prototype=Object.assign(Object.create(hi.prototype),{constructor:Za,load:function(t,u,m,g){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=ta.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;const V=document.createElementNS("http://www.w3.org/1999/xhtml","img");function Z(){V.removeEventListener("load",Z,!1),V.removeEventListener("error",J,!1),ta.add(t,this),u&&u(this),E.manager.itemEnd(t)}function J(ee){V.removeEventListener("load",Z,!1),V.removeEventListener("error",J,!1),g&&g(ee),E.manager.itemError(t),E.manager.itemEnd(t)}return V.addEventListener("load",Z,!1),V.addEventListener("error",J,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(V.crossOrigin=this.crossOrigin),E.manager.itemStart(t),V.src=t,V}}),Rh.prototype=Object.assign(Object.create(hi.prototype),{constructor:Rh,load:function(t,u,m,g){const E=new as,I=new Za(this.manager);I.setCrossOrigin(this.crossOrigin),I.setPath(this.path);let V=0;function Z(J){I.load(t[J],function(ee){E.images[J]=ee,V++,6===V&&(E.needsUpdate=!0,u&&u(E))},void 0,g)}for(let J=0;J<t.length;++J)Z(J);return E}}),Si.prototype=Object.assign(Object.create(hi.prototype),{constructor:Si,load:function(t,u,m,g){const E=new di,I=new Za(this.manager);return I.setCrossOrigin(this.crossOrigin),I.setPath(this.path),I.load(t,function(V){E.image=V;const Z=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);E.format=Z?Is:mo,E.needsUpdate=!0,void 0!==u&&u(E)},m,g),E}}),Object.assign(yr.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,u){const m=this.getUtoTmapping(t);return this.getPoint(m,u)},getPoints:function(t){void 0===t&&(t=5);const u=[];for(let m=0;m<=t;m++)u.push(this.getPoint(m/t));return u},getSpacedPoints:function(t){void 0===t&&(t=5);const u=[];for(let m=0;m<=t;m++)u.push(this.getPointAt(m/t));return u},getLength:function(){const t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const u=[];let m,g=this.getPoint(0),E=0;u.push(0);for(let I=1;I<=t;I++)m=this.getPoint(I/t),E+=m.distanceTo(g),u.push(E),g=m;return this.cacheArcLengths=u,u},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,u){const m=this.getLengths();let g,E=0,I=m.length;g=u||t*m[I-1];let V,Z=0,J=I-1;for(;Z<=J;)if(E=Math.floor(Z+(J-Z)/2),V=m[E]-g,V<0)Z=E+1;else{if(!(V>0)){J=E;break}J=E-1}if(E=J,m[E]===g)return E/(I-1);const ee=m[E];return(E+(g-ee)/(m[E+1]-ee))/(I-1)},getTangent:function(t,u){let g=t-1e-4,E=t+1e-4;g<0&&(g=0),E>1&&(E=1);const I=this.getPoint(g),V=this.getPoint(E),Z=u||(I.isVector2?new Sn:new ot);return Z.copy(V).sub(I).normalize(),Z},getTangentAt:function(t,u){const m=this.getUtoTmapping(t);return this.getTangent(m,u)},computeFrenetFrames:function(t,u){const m=new ot,g=[],E=[],I=[],V=new ot,Z=new ni;for(let e=0;e<=t;e++)g[e]=this.getTangentAt(e/t,new ot),g[e].normalize();E[0]=new ot,I[0]=new ot;let J=Number.MAX_VALUE;const ee=Math.abs(g[0].x),_e=Math.abs(g[0].y),S=Math.abs(g[0].z);ee<=J&&(J=ee,m.set(1,0,0)),_e<=J&&(J=_e,m.set(0,1,0)),S<=J&&m.set(0,0,1),V.crossVectors(g[0],m).normalize(),E[0].crossVectors(g[0],V),I[0].crossVectors(g[0],E[0]);for(let e=1;e<=t;e++){if(E[e]=E[e-1].clone(),I[e]=I[e-1].clone(),V.crossVectors(g[e-1],g[e]),V.length()>Number.EPSILON){V.normalize();const c=Math.acos(er.clamp(g[e-1].dot(g[e]),-1,1));E[e].applyMatrix4(Z.makeRotationAxis(V,c))}I[e].crossVectors(g[e],E[e])}if(!0===u){let e=Math.acos(er.clamp(E[0].dot(E[t]),-1,1));e/=t,g[0].dot(V.crossVectors(E[0],E[t]))>0&&(e=-e);for(let c=1;c<=t;c++)E[c].applyMatrix4(Z.makeRotationAxis(g[c],e*c)),I[c].crossVectors(g[c],E[c])}return{tangents:g,normals:E,binormals:I}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),(a.prototype=Object.create(yr.prototype)).constructor=a,a.prototype.isEllipseCurve=!0,a.prototype.getPoint=function(t,u){const m=u||new Sn,g=2*Math.PI;let E=this.aEndAngle-this.aStartAngle;const I=Math.abs(E)<Number.EPSILON;for(;E<0;)E+=g;for(;E>g;)E-=g;E<Number.EPSILON&&(E=I?0:g),!0!==this.aClockwise||I||(E===g?E=-g:E-=g);const V=this.aStartAngle+t*E;let Z=this.aX+this.xRadius*Math.cos(V),J=this.aY+this.yRadius*Math.sin(V);if(0!==this.aRotation){const ee=Math.cos(this.aRotation),_e=Math.sin(this.aRotation),S=Z-this.aX,e=J-this.aY;Z=S*ee-e*_e+this.aX,J=S*_e+e*ee+this.aY}return m.set(Z,J)},a.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},a.prototype.toJSON=function(){const t=yr.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},a.prototype.fromJSON=function(t){return yr.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},(r.prototype=Object.create(a.prototype)).constructor=r,r.prototype.isArcCurve=!0;const d=new ot,y=new h,b=new h,N=new h;function k(t,u,m,g){yr.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=u||!1,this.curveType=m||"centripetal",this.tension=void 0!==g?g:.5}function T(t,u,m,g,E){const I=.5*(g-u),V=.5*(E-m),Z=t*t;return(2*m-2*g+I+V)*(t*Z)+(-3*m+3*g-2*I-V)*Z+I*t+m}function H(t,u,m,g){return function(E,I){const V=1-E;return V*V*I}(t,u)+2*(1-(E=t))*E*m+function(E,I){return E*E*I}(t,g);var E}function Y(t,u,m,g,E){return function(I,V){const Z=1-I;return Z*Z*Z*V}(t,u)+function(I,V){const Z=1-I;return 3*Z*Z*I*V}(t,m)+3*(1-(I=t))*I*I*g+function(I,V){return I*I*I*V}(t,E);var I}function le(t,u,m,g){yr.call(this),this.type="CubicBezierCurve",this.v0=t||new Sn,this.v1=u||new Sn,this.v2=m||new Sn,this.v3=g||new Sn}function ae(t,u,m,g){yr.call(this),this.type="CubicBezierCurve3",this.v0=t||new ot,this.v1=u||new ot,this.v2=m||new ot,this.v3=g||new ot}function ge(t,u){yr.call(this),this.type="LineCurve",this.v1=t||new Sn,this.v2=u||new Sn}function we(t,u){yr.call(this),this.type="LineCurve3",this.v1=t||new ot,this.v2=u||new ot}function Se(t,u,m){yr.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Sn,this.v1=u||new Sn,this.v2=m||new Sn}function $e(t,u,m){yr.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new ot,this.v1=u||new ot,this.v2=m||new ot}function Re(t){yr.call(this),this.type="SplineCurve",this.points=t||[]}(k.prototype=Object.create(yr.prototype)).constructor=k,k.prototype.isCatmullRomCurve3=!0,k.prototype.getPoint=function(t,u){const m=u||new ot,g=this.points,E=g.length,I=(E-(this.closed?0:1))*t;let V,Z,J,ee,_e=Math.floor(I),S=I-_e;if(this.closed?_e+=_e>0?0:(Math.floor(Math.abs(_e)/E)+1)*E:0===S&&_e===E-1&&(_e=E-2,S=1),this.closed||_e>0?V=g[(_e-1)%E]:(d.subVectors(g[0],g[1]).add(g[0]),V=d),Z=g[_e%E],J=g[(_e+1)%E],this.closed||_e+2<E?ee=g[(_e+2)%E]:(d.subVectors(g[E-1],g[E-2]).add(g[E-1]),ee=d),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let c=Math.pow(V.distanceToSquared(Z),e),p=Math.pow(Z.distanceToSquared(J),e),_=Math.pow(J.distanceToSquared(ee),e);p<1e-4&&(p=1),c<1e-4&&(c=p),_<1e-4&&(_=p),y.initNonuniformCatmullRom(V.x,Z.x,J.x,ee.x,c,p,_),b.initNonuniformCatmullRom(V.y,Z.y,J.y,ee.y,c,p,_),N.initNonuniformCatmullRom(V.z,Z.z,J.z,ee.z,c,p,_)}else"catmullrom"===this.curveType&&(y.initCatmullRom(V.x,Z.x,J.x,ee.x,this.tension),b.initCatmullRom(V.y,Z.y,J.y,ee.y,this.tension),N.initCatmullRom(V.z,Z.z,J.z,ee.z,this.tension));return m.set(y.calc(S),b.calc(S),N.calc(S)),m},k.prototype.copy=function(t){yr.prototype.copy.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++)this.points.push(t.points[u].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},k.prototype.toJSON=function(){const t=yr.prototype.toJSON.call(this);t.points=[];for(let u=0,m=this.points.length;u<m;u++)t.points.push(this.points[u].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},k.prototype.fromJSON=function(t){yr.prototype.fromJSON.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++){const g=t.points[u];this.points.push((new ot).fromArray(g))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},(le.prototype=Object.create(yr.prototype)).constructor=le,le.prototype.isCubicBezierCurve=!0,le.prototype.getPoint=function(t,u){const m=u||new Sn,g=this.v0,E=this.v1,I=this.v2,V=this.v3;return m.set(Y(t,g.x,E.x,I.x,V.x),Y(t,g.y,E.y,I.y,V.y)),m},le.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},le.prototype.toJSON=function(){const t=yr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},le.prototype.fromJSON=function(t){return yr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(ae.prototype=Object.create(yr.prototype)).constructor=ae,ae.prototype.isCubicBezierCurve3=!0,ae.prototype.getPoint=function(t,u){const m=u||new ot,g=this.v0,E=this.v1,I=this.v2,V=this.v3;return m.set(Y(t,g.x,E.x,I.x,V.x),Y(t,g.y,E.y,I.y,V.y),Y(t,g.z,E.z,I.z,V.z)),m},ae.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ae.prototype.toJSON=function(){const t=yr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ae.prototype.fromJSON=function(t){return yr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(ge.prototype=Object.create(yr.prototype)).constructor=ge,ge.prototype.isLineCurve=!0,ge.prototype.getPoint=function(t,u){const m=u||new Sn;return 1===t?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(t).add(this.v1)),m},ge.prototype.getPointAt=function(t,u){return this.getPoint(t,u)},ge.prototype.getTangent=function(t,u){const m=u||new Sn;return m.copy(this.v2).sub(this.v1).normalize(),m},ge.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ge.prototype.toJSON=function(){const t=yr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ge.prototype.fromJSON=function(t){return yr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(we.prototype=Object.create(yr.prototype)).constructor=we,we.prototype.isLineCurve3=!0,we.prototype.getPoint=function(t,u){const m=u||new ot;return 1===t?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(t).add(this.v1)),m},we.prototype.getPointAt=function(t,u){return this.getPoint(t,u)},we.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},we.prototype.toJSON=function(){const t=yr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},we.prototype.fromJSON=function(t){return yr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Se.prototype=Object.create(yr.prototype)).constructor=Se,Se.prototype.isQuadraticBezierCurve=!0,Se.prototype.getPoint=function(t,u){const m=u||new Sn,g=this.v0,E=this.v1,I=this.v2;return m.set(H(t,g.x,E.x,I.x),H(t,g.y,E.y,I.y)),m},Se.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Se.prototype.toJSON=function(){const t=yr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Se.prototype.fromJSON=function(t){return yr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},($e.prototype=Object.create(yr.prototype)).constructor=$e,$e.prototype.isQuadraticBezierCurve3=!0,$e.prototype.getPoint=function(t,u){const m=u||new ot,g=this.v0,E=this.v1,I=this.v2;return m.set(H(t,g.x,E.x,I.x),H(t,g.y,E.y,I.y),H(t,g.z,E.z,I.z)),m},$e.prototype.copy=function(t){return yr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},$e.prototype.toJSON=function(){const t=yr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},$e.prototype.fromJSON=function(t){return yr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Re.prototype=Object.create(yr.prototype)).constructor=Re,Re.prototype.isSplineCurve=!0,Re.prototype.getPoint=function(t,u){const m=u||new Sn,g=this.points,E=(g.length-1)*t,I=Math.floor(E),V=E-I,Z=g[0===I?I:I-1],J=g[I],ee=g[I>g.length-2?g.length-1:I+1],_e=g[I>g.length-3?g.length-1:I+2];return m.set(T(V,Z.x,J.x,ee.x,_e.x),T(V,Z.y,J.y,ee.y,_e.y)),m},Re.prototype.copy=function(t){yr.prototype.copy.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++)this.points.push(t.points[u].clone());return this},Re.prototype.toJSON=function(){const t=yr.prototype.toJSON.call(this);t.points=[];for(let u=0,m=this.points.length;u<m;u++)t.points.push(this.points[u].toArray());return t},Re.prototype.fromJSON=function(t){yr.prototype.fromJSON.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++){const g=t.points[u];this.points.push((new Sn).fromArray(g))}return this};var Pe=Object.freeze({__proto__:null,ArcCurve:r,CatmullRomCurve3:k,CubicBezierCurve:le,CubicBezierCurve3:ae,EllipseCurve:a,LineCurve:ge,LineCurve3:we,QuadraticBezierCurve:Se,QuadraticBezierCurve3:$e,SplineCurve:Re});function Oe(){yr.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Fe(t){Oe.call(this),this.type="Path",this.currentPoint=new Sn,t&&this.setFromPoints(t)}function De(t){Fe.call(this,t),this.uuid=er.generateUUID(),this.type="Shape",this.holes=[]}function Qe(t,u){Zn.call(this),this.type="Light",this.color=new or(t),this.intensity=void 0!==u?u:1,this.receiveShadow=void 0}function it(t,u,m){Qe.call(this,t,m),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Zn.DefaultUp),this.updateMatrix(),this.groundColor=new or(u)}function ct(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Sn(512,512),this.map=null,this.mapPass=null,this.matrix=new ni,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Yc,this._frameExtents=new Sn(1,1),this._viewportCount=1,this._viewports=[new bi(0,0,1,1)]}function _t(){ct.call(this,new Ns(50,1,.5,500))}function $t(t,u,m,g,E,I){Qe.call(this,t,u),this.type="SpotLight",this.position.copy(Zn.DefaultUp),this.updateMatrix(),this.target=new Zn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(V){this.intensity=V/Math.PI}}),this.distance=void 0!==m?m:0,this.angle=void 0!==g?g:Math.PI/3,this.penumbra=void 0!==E?E:0,this.decay=void 0!==I?I:1,this.shadow=new _t}function rn(){ct.call(this,new Ns(90,1,.5,500)),this._frameExtents=new Sn(4,2),this._viewportCount=6,this._viewports=[new bi(2,1,1,1),new bi(0,1,1,1),new bi(3,1,1,1),new bi(1,1,1,1),new bi(3,0,1,1),new bi(1,0,1,1)],this._cubeDirections=[new ot(1,0,0),new ot(-1,0,0),new ot(0,0,1),new ot(0,0,-1),new ot(0,1,0),new ot(0,-1,0)],this._cubeUps=[new ot(0,1,0),new ot(0,1,0),new ot(0,1,0),new ot(0,1,0),new ot(0,0,1),new ot(0,0,-1)]}function Dt(t,u,m,g){Qe.call(this,t,u),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(E){this.intensity=E/(4*Math.PI)}}),this.distance=void 0!==m?m:0,this.decay=void 0!==g?g:1,this.shadow=new rn}function Lt(t,u,m,g,E,I){Ai.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==u?u:1,this.top=void 0!==m?m:1,this.bottom=void 0!==g?g:-1,this.near=void 0!==E?E:.1,this.far=void 0!==I?I:2e3,this.updateProjectionMatrix()}function Ct(){ct.call(this,new Lt(-5,5,5,-5,.5,500))}function ut(t,u){Qe.call(this,t,u),this.type="DirectionalLight",this.position.copy(Zn.DefaultUp),this.updateMatrix(),this.target=new Zn,this.shadow=new Ct}function Tt(t,u){Qe.call(this,t,u),this.type="AmbientLight",this.castShadow=void 0}function Qt(t,u,m,g){Qe.call(this,t,u),this.type="RectAreaLight",this.width=void 0!==m?m:10,this.height=void 0!==g?g:10}function vn(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new ot)}function gn(t,u){Qe.call(this,void 0,u),this.type="LightProbe",this.sh=void 0!==t?t:new vn}function fr(t){hi.call(this,t),this.textures={}}Oe.prototype=Object.assign(Object.create(yr.prototype),{constructor:Oe,add:function(t){this.curves.push(t)},closePath:function(){const t=this.curves[0].getPoint(0),u=this.curves[this.curves.length-1].getPoint(1);t.equals(u)||this.curves.push(new ge(u,t))},getPoint:function(t){const u=t*this.getLength(),m=this.getCurveLengths();let g=0;for(;g<m.length;){if(m[g]>=u){const E=m[g]-u,I=this.curves[g],V=I.getLength();return I.getPointAt(0===V?0:1-E/V)}g++}return null},getLength:function(){const t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let u=0;for(let m=0,g=this.curves.length;m<g;m++)u+=this.curves[m].getLength(),t.push(u);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);const u=[];for(let m=0;m<=t;m++)u.push(this.getPoint(m/t));return this.autoClose&&u.push(u[0]),u},getPoints:function(t){t=t||12;const u=[];let m;for(let g=0,E=this.curves;g<E.length;g++){const I=E[g],Z=I.getPoints(I&&I.isEllipseCurve?2*t:I&&(I.isLineCurve||I.isLineCurve3)?1:I&&I.isSplineCurve?t*I.points.length:t);for(let J=0;J<Z.length;J++){const ee=Z[J];m&&m.equals(ee)||(u.push(ee),m=ee)}}return this.autoClose&&u.length>1&&!u[u.length-1].equals(u[0])&&u.push(u[0]),u},copy:function(t){yr.prototype.copy.call(this,t),this.curves=[];for(let u=0,m=t.curves.length;u<m;u++)this.curves.push(t.curves[u].clone());return this.autoClose=t.autoClose,this},toJSON:function(){const t=yr.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(let u=0,m=this.curves.length;u<m;u++)t.curves.push(this.curves[u].toJSON());return t},fromJSON:function(t){yr.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(let u=0,m=t.curves.length;u<m;u++){const g=t.curves[u];this.curves.push((new Pe[g.type]).fromJSON(g))}return this}}),Fe.prototype=Object.assign(Object.create(Oe.prototype),{constructor:Fe,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(let u=1,m=t.length;u<m;u++)this.lineTo(t[u].x,t[u].y);return this},moveTo:function(t,u){return this.currentPoint.set(t,u),this},lineTo:function(t,u){const m=new ge(this.currentPoint.clone(),new Sn(t,u));return this.curves.push(m),this.currentPoint.set(t,u),this},quadraticCurveTo:function(t,u,m,g){const E=new Se(this.currentPoint.clone(),new Sn(t,u),new Sn(m,g));return this.curves.push(E),this.currentPoint.set(m,g),this},bezierCurveTo:function(t,u,m,g,E,I){const V=new le(this.currentPoint.clone(),new Sn(t,u),new Sn(m,g),new Sn(E,I));return this.curves.push(V),this.currentPoint.set(E,I),this},splineThru:function(t){const u=new Re([this.currentPoint.clone()].concat(t));return this.curves.push(u),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,u,m,g,E,I){return this.absarc(t+this.currentPoint.x,u+this.currentPoint.y,m,g,E,I),this},absarc:function(t,u,m,g,E,I){return this.absellipse(t,u,m,m,g,E,I),this},ellipse:function(t,u,m,g,E,I,V,Z){return this.absellipse(t+this.currentPoint.x,u+this.currentPoint.y,m,g,E,I,V,Z),this},absellipse:function(t,u,m,g,E,I,V,Z){const J=new a(t,u,m,g,E,I,V,Z);if(this.curves.length>0){const _e=J.getPoint(0);_e.equals(this.currentPoint)||this.lineTo(_e.x,_e.y)}this.curves.push(J);const ee=J.getPoint(1);return this.currentPoint.copy(ee),this},copy:function(t){return Oe.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){const t=Oe.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Oe.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),De.prototype=Object.assign(Object.create(Fe.prototype),{constructor:De,getPointsHoles:function(t){const u=[];for(let m=0,g=this.holes.length;m<g;m++)u[m]=this.holes[m].getPoints(t);return u},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Fe.prototype.copy.call(this,t),this.holes=[];for(let u=0,m=t.holes.length;u<m;u++)this.holes.push(t.holes[u].clone());return this},toJSON:function(){const t=Fe.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(let u=0,m=this.holes.length;u<m;u++)t.holes.push(this.holes[u].toJSON());return t},fromJSON:function(t){Fe.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(let u=0,m=t.holes.length;u<m;u++){const g=t.holes[u];this.holes.push((new Fe).fromJSON(g))}return this}}),Qe.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Qe,isLight:!0,copy:function(t){return Zn.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){const u=Zn.prototype.toJSON.call(this,t);return u.object.color=this.color.getHex(),u.object.intensity=this.intensity,void 0!==this.groundColor&&(u.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(u.object.distance=this.distance),void 0!==this.angle&&(u.object.angle=this.angle),void 0!==this.decay&&(u.object.decay=this.decay),void 0!==this.penumbra&&(u.object.penumbra=this.penumbra),void 0!==this.shadow&&(u.object.shadow=this.shadow.toJSON()),u}}),it.prototype=Object.assign(Object.create(Qe.prototype),{constructor:it,isHemisphereLight:!0,copy:function(t){return Qe.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(ct.prototype,{_projScreenMatrix:new ni,_lightPositionWorld:new ot,_lookTarget:new ot,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){const u=this.camera,m=this.matrix,g=this._projScreenMatrix,E=this._lookTarget,I=this._lightPositionWorld;I.setFromMatrixPosition(t.matrixWorld),u.position.copy(I),E.setFromMatrixPosition(t.target.matrixWorld),u.lookAt(E),u.updateMatrixWorld(),g.multiplyMatrices(u.projectionMatrix,u.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g),m.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),m.multiply(u.projectionMatrix),m.multiply(u.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),_t.prototype=Object.assign(Object.create(ct.prototype),{constructor:_t,isSpotLightShadow:!0,updateMatrices:function(t){const u=this.camera,m=2*er.RAD2DEG*t.angle,g=this.mapSize.width/this.mapSize.height,E=t.distance||u.far;m===u.fov&&g===u.aspect&&E===u.far||(u.fov=m,u.aspect=g,u.far=E,u.updateProjectionMatrix()),ct.prototype.updateMatrices.call(this,t)}}),$t.prototype=Object.assign(Object.create(Qe.prototype),{constructor:$t,isSpotLight:!0,copy:function(t){return Qe.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),rn.prototype=Object.assign(Object.create(ct.prototype),{constructor:rn,isPointLightShadow:!0,updateMatrices:function(t,u){void 0===u&&(u=0);const m=this.camera,g=this.matrix,E=this._lightPositionWorld,I=this._lookTarget,V=this._projScreenMatrix;E.setFromMatrixPosition(t.matrixWorld),m.position.copy(E),I.copy(m.position),I.add(this._cubeDirections[u]),m.up.copy(this._cubeUps[u]),m.lookAt(I),m.updateMatrixWorld(),g.makeTranslation(-E.x,-E.y,-E.z),V.multiplyMatrices(m.projectionMatrix,m.matrixWorldInverse),this._frustum.setFromProjectionMatrix(V)}}),Dt.prototype=Object.assign(Object.create(Qe.prototype),{constructor:Dt,isPointLight:!0,copy:function(t){return Qe.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Lt.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Lt,isOrthographicCamera:!0,copy:function(t,u){return Ai.prototype.copy.call(this,t,u),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,u,m,g,E,I){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=u,this.view.offsetX=m,this.view.offsetY=g,this.view.width=E,this.view.height=I,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=(this.right-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),m=(this.right+this.left)/2,g=(this.top+this.bottom)/2;let E=m-t,I=m+t,V=g+u,Z=g-u;if(null!==this.view&&this.view.enabled){const J=(this.right-this.left)/this.view.fullWidth/this.zoom,ee=(this.top-this.bottom)/this.view.fullHeight/this.zoom;E+=J*this.view.offsetX,I=E+J*this.view.width,V-=ee*this.view.offsetY,Z=V-ee*this.view.height}this.projectionMatrix.makeOrthographic(E,I,V,Z,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const u=Zn.prototype.toJSON.call(this,t);return u.object.zoom=this.zoom,u.object.left=this.left,u.object.right=this.right,u.object.top=this.top,u.object.bottom=this.bottom,u.object.near=this.near,u.object.far=this.far,null!==this.view&&(u.object.view=Object.assign({},this.view)),u}}),Ct.prototype=Object.assign(Object.create(ct.prototype),{constructor:Ct,isDirectionalLightShadow:!0,updateMatrices:function(t){ct.prototype.updateMatrices.call(this,t)}}),ut.prototype=Object.assign(Object.create(Qe.prototype),{constructor:ut,isDirectionalLight:!0,copy:function(t){return Qe.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Tt.prototype=Object.assign(Object.create(Qe.prototype),{constructor:Tt,isAmbientLight:!0}),Qt.prototype=Object.assign(Object.create(Qe.prototype),{constructor:Qt,isRectAreaLight:!0,copy:function(t){return Qe.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){const u=Qe.prototype.toJSON.call(this,t);return u.object.width=this.width,u.object.height=this.height,u}}),Object.assign(vn.prototype,{isSphericalHarmonics3:!0,set:function(t){for(let u=0;u<9;u++)this.coefficients[u].copy(t[u]);return this},zero:function(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,u){const m=t.x,g=t.y,E=t.z,I=this.coefficients;return u.copy(I[0]).multiplyScalar(.282095),u.addScaledVector(I[1],.488603*g),u.addScaledVector(I[2],.488603*E),u.addScaledVector(I[3],.488603*m),u.addScaledVector(I[4],m*g*1.092548),u.addScaledVector(I[5],g*E*1.092548),u.addScaledVector(I[6],.315392*(3*E*E-1)),u.addScaledVector(I[7],m*E*1.092548),u.addScaledVector(I[8],.546274*(m*m-g*g)),u},getIrradianceAt:function(t,u){const m=t.x,g=t.y,E=t.z,I=this.coefficients;return u.copy(I[0]).multiplyScalar(.886227),u.addScaledVector(I[1],1.023328*g),u.addScaledVector(I[2],1.023328*E),u.addScaledVector(I[3],1.023328*m),u.addScaledVector(I[4],.858086*m*g),u.addScaledVector(I[5],.858086*g*E),u.addScaledVector(I[6],.743125*E*E-.247708),u.addScaledVector(I[7],.858086*m*E),u.addScaledVector(I[8],.429043*(m*m-g*g)),u},add:function(t){for(let u=0;u<9;u++)this.coefficients[u].add(t.coefficients[u]);return this},addScaledSH:function(t,u){for(let m=0;m<9;m++)this.coefficients[m].addScaledVector(t.coefficients[m],u);return this},scale:function(t){for(let u=0;u<9;u++)this.coefficients[u].multiplyScalar(t);return this},lerp:function(t,u){for(let m=0;m<9;m++)this.coefficients[m].lerp(t.coefficients[m],u);return this},equals:function(t){for(let u=0;u<9;u++)if(!this.coefficients[u].equals(t.coefficients[u]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,u){void 0===u&&(u=0);const m=this.coefficients;for(let g=0;g<9;g++)m[g].fromArray(t,u+3*g);return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.coefficients;for(let g=0;g<9;g++)m[g].toArray(t,u+3*g);return t}}),Object.assign(vn,{getBasisAt:function(t,u){const m=t.x,g=t.y,E=t.z;u[0]=.282095,u[1]=.488603*g,u[2]=.488603*E,u[3]=.488603*m,u[4]=1.092548*m*g,u[5]=1.092548*g*E,u[6]=.315392*(3*E*E-1),u[7]=1.092548*m*E,u[8]=.546274*(m*m-g*g)}}),gn.prototype=Object.assign(Object.create(Qe.prototype),{constructor:gn,isLightProbe:!0,copy:function(t){return Qe.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){const u=Qe.prototype.toJSON.call(this,t);return u.object.sh=this.sh.toArray(),u}}),fr.prototype=Object.assign(Object.create(hi.prototype),{constructor:fr,load:function(t,u,m,g){const E=this,I=new Dl(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(V){try{u(E.parse(JSON.parse(V)))}catch(Z){g?g(Z):console.error(Z),E.manager.itemError(t)}},m,g)},parse:function(t){const u=this.textures;function m(E){return void 0===u[E]&&console.warn("THREE.MaterialLoader: Undefined texture",E),u[E]}const g=new Bh[t.type];if(void 0!==t.uuid&&(g.uuid=t.uuid),void 0!==t.name&&(g.name=t.name),void 0!==t.color&&g.color.setHex(t.color),void 0!==t.roughness&&(g.roughness=t.roughness),void 0!==t.metalness&&(g.metalness=t.metalness),void 0!==t.sheen&&(g.sheen=(new or).setHex(t.sheen)),void 0!==t.emissive&&g.emissive.setHex(t.emissive),void 0!==t.specular&&g.specular.setHex(t.specular),void 0!==t.shininess&&(g.shininess=t.shininess),void 0!==t.clearcoat&&(g.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(g.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(g.fog=t.fog),void 0!==t.flatShading&&(g.flatShading=t.flatShading),void 0!==t.blending&&(g.blending=t.blending),void 0!==t.combine&&(g.combine=t.combine),void 0!==t.side&&(g.side=t.side),void 0!==t.opacity&&(g.opacity=t.opacity),void 0!==t.transparent&&(g.transparent=t.transparent),void 0!==t.alphaTest&&(g.alphaTest=t.alphaTest),void 0!==t.depthTest&&(g.depthTest=t.depthTest),void 0!==t.depthWrite&&(g.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(g.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(g.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(g.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(g.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(g.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(g.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(g.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(g.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(g.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(g.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(g.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(g.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(g.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(g.rotation=t.rotation),1!==t.linewidth&&(g.linewidth=t.linewidth),void 0!==t.dashSize&&(g.dashSize=t.dashSize),void 0!==t.gapSize&&(g.gapSize=t.gapSize),void 0!==t.scale&&(g.scale=t.scale),void 0!==t.polygonOffset&&(g.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(g.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(g.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(g.skinning=t.skinning),void 0!==t.morphTargets&&(g.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(g.morphNormals=t.morphNormals),void 0!==t.dithering&&(g.dithering=t.dithering),void 0!==t.vertexTangents&&(g.vertexTangents=t.vertexTangents),void 0!==t.visible&&(g.visible=t.visible),void 0!==t.toneMapped&&(g.toneMapped=t.toneMapped),void 0!==t.userData&&(g.userData=t.userData),void 0!==t.vertexColors&&(g.vertexColors="number"==typeof t.vertexColors?t.vertexColors>0:t.vertexColors),void 0!==t.uniforms)for(const E in t.uniforms){const I=t.uniforms[E];switch(g.uniforms[E]={},I.type){case"t":g.uniforms[E].value=m(I.value);break;case"c":g.uniforms[E].value=(new or).setHex(I.value);break;case"v2":g.uniforms[E].value=(new Sn).fromArray(I.value);break;case"v3":g.uniforms[E].value=(new ot).fromArray(I.value);break;case"v4":g.uniforms[E].value=(new bi).fromArray(I.value);break;case"m3":g.uniforms[E].value=(new jo).fromArray(I.value);case"m4":g.uniforms[E].value=(new ni).fromArray(I.value);break;default:g.uniforms[E].value=I.value}}if(void 0!==t.defines&&(g.defines=t.defines),void 0!==t.vertexShader&&(g.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(g.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const E in t.extensions)g.extensions[E]=t.extensions[E];if(void 0!==t.shading&&(g.flatShading=1===t.shading),void 0!==t.size&&(g.size=t.size),void 0!==t.sizeAttenuation&&(g.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(g.map=m(t.map)),void 0!==t.matcap&&(g.matcap=m(t.matcap)),void 0!==t.alphaMap&&(g.alphaMap=m(t.alphaMap)),void 0!==t.bumpMap&&(g.bumpMap=m(t.bumpMap)),void 0!==t.bumpScale&&(g.bumpScale=t.bumpScale),void 0!==t.normalMap&&(g.normalMap=m(t.normalMap)),void 0!==t.normalMapType&&(g.normalMapType=t.normalMapType),void 0!==t.normalScale){let E=t.normalScale;!1===Array.isArray(E)&&(E=[E,E]),g.normalScale=(new Sn).fromArray(E)}return void 0!==t.displacementMap&&(g.displacementMap=m(t.displacementMap)),void 0!==t.displacementScale&&(g.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(g.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(g.roughnessMap=m(t.roughnessMap)),void 0!==t.metalnessMap&&(g.metalnessMap=m(t.metalnessMap)),void 0!==t.emissiveMap&&(g.emissiveMap=m(t.emissiveMap)),void 0!==t.emissiveIntensity&&(g.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(g.specularMap=m(t.specularMap)),void 0!==t.envMap&&(g.envMap=m(t.envMap)),void 0!==t.envMapIntensity&&(g.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(g.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(g.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(g.lightMap=m(t.lightMap)),void 0!==t.lightMapIntensity&&(g.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(g.aoMap=m(t.aoMap)),void 0!==t.aoMapIntensity&&(g.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(g.gradientMap=m(t.gradientMap)),void 0!==t.clearcoatMap&&(g.clearcoatMap=m(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap=m(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(g.clearcoatNormalMap=m(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(g.clearcoatNormalScale=(new Sn).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(g.transmission=t.transmission),void 0!==t.transmissionMap&&(g.transmissionMap=m(t.transmissionMap)),g},setTextures:function(t){return this.textures=t,this}});const sr={decodeText:function(t){if(typeof TextDecoder<"u")return(new TextDecoder).decode(t);let u="";for(let m=0,g=t.length;m<g;m++)u+=String.fromCharCode(t[m]);try{return decodeURIComponent(escape(u))}catch{return u}},extractUrlBase:function(t){const u=t.lastIndexOf("/");return-1===u?"./":t.substr(0,u+1)}};function Rn(){pn.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Jn(t,u,m,g){"number"==typeof m&&(g=m,m=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Hr.call(this,t,u,m),this.meshPerAttribute=g||1}function Kn(t){hi.call(this,t)}Rn.prototype=Object.assign(Object.create(pn.prototype),{constructor:Rn,isInstancedBufferGeometry:!0,copy:function(t){return pn.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t=pn.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),Jn.prototype=Object.assign(Object.create(Hr.prototype),{constructor:Jn,isInstancedBufferAttribute:!0,copy:function(t){return Hr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){const t=Hr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Kn.prototype=Object.assign(Object.create(hi.prototype),{constructor:Kn,load:function(t,u,m,g){const E=this,I=new Dl(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(V){try{u(E.parse(JSON.parse(V)))}catch(Z){g?g(Z):console.error(Z),E.manager.itemError(t)}},m,g)},parse:function(t){const u={},m={};function g(_e,S){if(void 0!==u[S])return u[S];const e=_e.interleavedBuffers[S],c=function(_,w){if(void 0!==m[w])return m[w];const O=new Uint32Array(_.arrayBuffers[w]).buffer;return m[w]=O,O}(_e,e.buffer),p=new Ca(new Er[e.type](c),e.stride);return p.uuid=e.uuid,u[S]=p,p}const E=t.isInstancedBufferGeometry?new Rn:new pn,I=t.data.index;if(void 0!==I){const _e=new Er[I.type](I.array);E.setIndex(new Hr(_e,1))}const V=t.data.attributes;for(const _e in V){const S=V[_e];let e;if(S.isInterleavedBufferAttribute)e=new wh(g(t.data,S.data),S.itemSize,S.offset,S.normalized);else{const c=new Er[S.type](S.array);e=new(S.isInstancedBufferAttribute?Jn:Hr)(c,S.itemSize,S.normalized)}void 0!==S.name&&(e.name=S.name),E.setAttribute(_e,e)}const Z=t.data.morphAttributes;if(Z)for(const _e in Z){const S=Z[_e],e=[];for(let c=0,p=S.length;c<p;c++){const _=S[c];let w;w=_.isInterleavedBufferAttribute?new wh(g(t.data,_.data),_.itemSize,_.offset,_.normalized):new Hr(new Er[_.type](_.array),_.itemSize,_.normalized),void 0!==_.name&&(w.name=_.name),e.push(w)}E.morphAttributes[_e]=e}t.data.morphTargetsRelative&&(E.morphTargetsRelative=!0);const J=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==J)for(let _e=0,S=J.length;_e!==S;++_e){const e=J[_e];E.addGroup(e.start,e.count,e.materialIndex)}const ee=t.data.boundingSphere;if(void 0!==ee){const _e=new ot;void 0!==ee.center&&_e.fromArray(ee.center),E.boundingSphere=new zn(_e,ee.radius)}return t.name&&(E.name=t.name),t.userData&&(E.userData=t.userData),E}});const Er={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function vi(t){hi.call(this,t)}vi.prototype=Object.assign(Object.create(hi.prototype),{constructor:vi,load:function(t,u,m,g){const E=this,I=""===this.path?sr.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||I;const V=new Dl(E.manager);V.setPath(this.path),V.setRequestHeader(this.requestHeader),V.load(t,function(Z){let J=null;try{J=JSON.parse(Z)}catch(_e){return void 0!==g&&g(_e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",_e.message)}const ee=J.metadata;void 0!==ee&&void 0!==ee.type&&"geometry"!==ee.type.toLowerCase()?E.parse(J,u):console.error("THREE.ObjectLoader: Can't load "+t)},m,g)},parse:function(t,u){const m=this.parseShape(t.shapes),g=this.parseGeometries(t.geometries,m),E=this.parseImages(t.images,function(){void 0!==u&&u(Z)}),I=this.parseTextures(t.textures,E),V=this.parseMaterials(t.materials,I),Z=this.parseObject(t.object,g,V);return t.animations&&(Z.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==u&&u(Z),Z},parseShape:function(t){const u={};if(void 0!==t)for(let m=0,g=t.length;m<g;m++){const E=(new De).fromJSON(t[m]);u[E.uuid]=E}return u},parseGeometries:function(t,u){const m={};let g;if(void 0!==t){const E=new Kn;for(let I=0,V=t.length;I<V;I++){let Z;const J=t[I];switch(J.type){case"PlaneGeometry":case"PlaneBufferGeometry":Z=new Us[J.type](J.width,J.height,J.widthSegments,J.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":Z=new Us[J.type](J.width,J.height,J.depth,J.widthSegments,J.heightSegments,J.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":Z=new Us[J.type](J.radius,J.segments,J.thetaStart,J.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":Z=new Us[J.type](J.radiusTop,J.radiusBottom,J.height,J.radialSegments,J.heightSegments,J.openEnded,J.thetaStart,J.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":Z=new Us[J.type](J.radius,J.height,J.radialSegments,J.heightSegments,J.openEnded,J.thetaStart,J.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":Z=new Us[J.type](J.radius,J.widthSegments,J.heightSegments,J.phiStart,J.phiLength,J.thetaStart,J.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":Z=new Us[J.type](J.radius,J.detail);break;case"RingGeometry":case"RingBufferGeometry":Z=new Us[J.type](J.innerRadius,J.outerRadius,J.thetaSegments,J.phiSegments,J.thetaStart,J.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":Z=new Us[J.type](J.radius,J.tube,J.radialSegments,J.tubularSegments,J.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":Z=new Us[J.type](J.radius,J.tube,J.tubularSegments,J.radialSegments,J.p,J.q);break;case"TubeGeometry":case"TubeBufferGeometry":Z=new Us[J.type]((new Pe[J.path.type]).fromJSON(J.path),J.tubularSegments,J.radius,J.radialSegments,J.closed);break;case"LatheGeometry":case"LatheBufferGeometry":Z=new Us[J.type](J.points,J.segments,J.phiStart,J.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":Z=new Us[J.type](J.vertices,J.indices,J.radius,J.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":g=[];for(let _e=0,S=J.shapes.length;_e<S;_e++)g.push(u[J.shapes[_e]]);Z=new Us[J.type](g,J.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":g=[];for(let _e=0,S=J.shapes.length;_e<S;_e++)g.push(u[J.shapes[_e]]);const ee=J.options.extrudePath;void 0!==ee&&(J.options.extrudePath=(new Pe[ee.type]).fromJSON(ee)),Z=new Us[J.type](g,J.options);break;case"BufferGeometry":case"InstancedBufferGeometry":Z=E.parse(J);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+J.type+'"');continue}Z.uuid=J.uuid,void 0!==J.name&&(Z.name=J.name),!0===Z.isBufferGeometry&&void 0!==J.userData&&(Z.userData=J.userData),m[J.uuid]=Z}}return m},parseMaterials:function(t,u){const m={},g={};if(void 0!==t){const E=new fr;E.setTextures(u);for(let I=0,V=t.length;I<V;I++){const Z=t[I];if("MultiMaterial"===Z.type){const J=[];for(let ee=0;ee<Z.materials.length;ee++){const _e=Z.materials[ee];void 0===m[_e.uuid]&&(m[_e.uuid]=E.parse(_e)),J.push(m[_e.uuid])}g[Z.uuid]=J}else void 0===m[Z.uuid]&&(m[Z.uuid]=E.parse(Z)),g[Z.uuid]=m[Z.uuid]}}return g},parseAnimations:function(t){const u=[];for(let m=0;m<t.length;m++){const g=t[m],E=rs.parse(g);void 0!==g.uuid&&(E.uuid=g.uuid),u.push(E)}return u},parseImages:function(t,u){const m=this,g={};let E;function I(V){return m.manager.itemStart(V),E.load(V,function(){m.manager.itemEnd(V)},void 0,function(){m.manager.itemError(V),m.manager.itemEnd(V)})}if(void 0!==t&&t.length>0){const V=new Dp(u);E=new Za(V),E.setCrossOrigin(this.crossOrigin);for(let Z=0,J=t.length;Z<J;Z++){const ee=t[Z],_e=ee.url;if(Array.isArray(_e)){g[ee.uuid]=[];for(let S=0,e=_e.length;S<e;S++){const c=_e[S],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:m.resourcePath+c;g[ee.uuid].push(I(p))}}else{const S=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(ee.url)?ee.url:m.resourcePath+ee.url;g[ee.uuid]=I(S)}}}return g},parseTextures:function(t,u){function m(E,I){return"number"==typeof E?E:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",E),I[E])}const g={};if(void 0!==t)for(let E=0,I=t.length;E<I;E++){const V=t[E];let Z;void 0===V.image&&console.warn('THREE.ObjectLoader: No "image" specified for',V.uuid),void 0===u[V.image]&&console.warn("THREE.ObjectLoader: Undefined image",V.image),Z=Array.isArray(u[V.image])?new as(u[V.image]):new di(u[V.image]),Z.needsUpdate=!0,Z.uuid=V.uuid,void 0!==V.name&&(Z.name=V.name),void 0!==V.mapping&&(Z.mapping=m(V.mapping,no)),void 0!==V.offset&&Z.offset.fromArray(V.offset),void 0!==V.repeat&&Z.repeat.fromArray(V.repeat),void 0!==V.center&&Z.center.fromArray(V.center),void 0!==V.rotation&&(Z.rotation=V.rotation),void 0!==V.wrap&&(Z.wrapS=m(V.wrap[0],fo),Z.wrapT=m(V.wrap[1],fo)),void 0!==V.format&&(Z.format=V.format),void 0!==V.type&&(Z.type=V.type),void 0!==V.encoding&&(Z.encoding=V.encoding),void 0!==V.minFilter&&(Z.minFilter=m(V.minFilter,Vo)),void 0!==V.magFilter&&(Z.magFilter=m(V.magFilter,Vo)),void 0!==V.anisotropy&&(Z.anisotropy=V.anisotropy),void 0!==V.flipY&&(Z.flipY=V.flipY),void 0!==V.premultiplyAlpha&&(Z.premultiplyAlpha=V.premultiplyAlpha),void 0!==V.unpackAlignment&&(Z.unpackAlignment=V.unpackAlignment),g[V.uuid]=Z}return g},parseObject:function(t,u,m){let g,E,I;function V(J){return void 0===u[J]&&console.warn("THREE.ObjectLoader: Undefined geometry",J),u[J]}function Z(J){if(void 0!==J){if(Array.isArray(J)){const ee=[];for(let _e=0,S=J.length;_e<S;_e++){const e=J[_e];void 0===m[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),ee.push(m[e])}return ee}return void 0===m[J]&&console.warn("THREE.ObjectLoader: Undefined material",J),m[J]}}switch(t.type){case"Scene":g=new El,void 0!==t.background&&Number.isInteger(t.background)&&(g.background=new or(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?g.fog=new Yd(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(g.fog=new uf(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":g=new Ns(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(g.focus=t.focus),void 0!==t.zoom&&(g.zoom=t.zoom),void 0!==t.filmGauge&&(g.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(g.filmOffset=t.filmOffset),void 0!==t.view&&(g.view=Object.assign({},t.view));break;case"OrthographicCamera":g=new Lt(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(g.zoom=t.zoom),void 0!==t.view&&(g.view=Object.assign({},t.view));break;case"AmbientLight":g=new Tt(t.color,t.intensity);break;case"DirectionalLight":g=new ut(t.color,t.intensity);break;case"PointLight":g=new Dt(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":g=new Qt(t.color,t.intensity,t.width,t.height);break;case"SpotLight":g=new $t(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":g=new it(t.color,t.groundColor,t.intensity);break;case"LightProbe":g=(new gn).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":E=V(t.geometry),I=Z(t.material),g=new Li(E,I);break;case"InstancedMesh":E=V(t.geometry),I=Z(t.material);const ee=t.instanceMatrix;g=new cs(E,I,t.count),g.instanceMatrix=new Hr(new Float32Array(ee.array),16);break;case"LOD":g=new Qd;break;case"Line":g=new Di(V(t.geometry),Z(t.material),t.mode);break;case"LineLoop":g=new Pp(V(t.geometry),Z(t.material));break;case"LineSegments":g=new Wi(V(t.geometry),Z(t.material));break;case"PointCloud":case"Points":g=new tu(V(t.geometry),Z(t.material));break;case"Sprite":g=new Wa(Z(t.material));break;case"Group":g=new tc;break;default:g=new Zn}if(g.uuid=t.uuid,void 0!==t.name&&(g.name=t.name),void 0!==t.matrix?(g.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(g.matrixAutoUpdate=t.matrixAutoUpdate),g.matrixAutoUpdate&&g.matrix.decompose(g.position,g.quaternion,g.scale)):(void 0!==t.position&&g.position.fromArray(t.position),void 0!==t.rotation&&g.rotation.fromArray(t.rotation),void 0!==t.quaternion&&g.quaternion.fromArray(t.quaternion),void 0!==t.scale&&g.scale.fromArray(t.scale)),void 0!==t.castShadow&&(g.castShadow=t.castShadow),void 0!==t.receiveShadow&&(g.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(g.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(g.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(g.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&g.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(g.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(g.visible=t.visible),void 0!==t.frustumCulled&&(g.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(g.renderOrder=t.renderOrder),void 0!==t.userData&&(g.userData=t.userData),void 0!==t.layers&&(g.layers.mask=t.layers),void 0!==t.children){const J=t.children;for(let ee=0;ee<J.length;ee++)g.add(this.parseObject(J[ee],u,m))}if("LOD"===t.type){void 0!==t.autoUpdate&&(g.autoUpdate=t.autoUpdate);const J=t.levels;for(let ee=0;ee<J.length;ee++){const _e=J[ee],S=g.getObjectByProperty("uuid",_e.object);void 0!==S&&g.addLevel(S,_e.distance)}}return g}});const no={UVMapping:gi,CubeReflectionMapping:Ti,CubeRefractionMapping:$o,EquirectangularReflectionMapping:Hs,EquirectangularRefractionMapping:ia,CubeUVReflectionMapping:Oi,CubeUVRefractionMapping:Co},fo={RepeatWrapping:wo,ClampToEdgeWrapping:Yr,MirroredRepeatWrapping:os},Vo={NearestFilter:Or,NearestMipmapNearestFilter:Oa,NearestMipmapLinearFilter:fs,LinearFilter:ai,LinearMipmapNearestFilter:Fc,LinearMipmapLinearFilter:Ka};function Uo(t){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),hi.call(this,t),this.options={premultiplyAlpha:"none"}}function Gs(){this.type="ShapePath",this.color=new or,this.subPaths=[],this.currentPath=null}function hs(t){this.type="Font",this.data=t}function ps(t,u,m,g,E){const I=E.glyphs[t]||E.glyphs["?"];if(!I)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+E.familyName+".");const V=new Gs;let Z,J,ee,_e,S,e,c,p;if(I.o){const _=I._cachedOutline||(I._cachedOutline=I.o.split(" "));for(let w=0,L=_.length;w<L;)switch(_[w++]){case"m":Z=_[w++]*u+m,J=_[w++]*u+g,V.moveTo(Z,J);break;case"l":Z=_[w++]*u+m,J=_[w++]*u+g,V.lineTo(Z,J);break;case"q":ee=_[w++]*u+m,_e=_[w++]*u+g,S=_[w++]*u+m,e=_[w++]*u+g,V.quadraticCurveTo(S,e,ee,_e);break;case"b":ee=_[w++]*u+m,_e=_[w++]*u+g,S=_[w++]*u+m,e=_[w++]*u+g,c=_[w++]*u+m,p=_[w++]*u+g,V.bezierCurveTo(S,e,c,p,ee,_e)}}return{offsetX:I.ha*u,path:V}}function ds(t){hi.call(this,t)}let Ic;Uo.prototype=Object.assign(Object.create(hi.prototype),{constructor:Uo,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,u,m,g){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=ta.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;fetch(t).then(function(V){return V.blob()}).then(function(V){return createImageBitmap(V,E.options)}).then(function(V){ta.add(t,V),u&&u(V),E.manager.itemEnd(t)}).catch(function(V){g&&g(V),E.manager.itemError(t),E.manager.itemEnd(t)}),E.manager.itemStart(t)}}),Object.assign(Gs.prototype,{moveTo:function(t,u){return this.currentPath=new Fe,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,u),this},lineTo:function(t,u){return this.currentPath.lineTo(t,u),this},quadraticCurveTo:function(t,u,m,g){return this.currentPath.quadraticCurveTo(t,u,m,g),this},bezierCurveTo:function(t,u,m,g,E,I){return this.currentPath.bezierCurveTo(t,u,m,g,E,I),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,u){function m(L){const O=[];for(let F=0,U=L.length;F<U;F++){const te=L[F],ce=new De;ce.curves=te.curves,O.push(ce)}return O}function g(L,O){const F=O.length;let U=!1;for(let te=F-1,ce=0;ce<F;te=ce++){let oe=O[te],de=O[ce],ve=de.x-oe.x,Me=de.y-oe.y;if(Math.abs(Me)>Number.EPSILON){if(Me<0&&(oe=O[ce],ve=-ve,de=O[te],Me=-Me),L.y<oe.y||L.y>de.y)continue;if(L.y===oe.y){if(L.x===oe.x)return!0}else{const Be=Me*(L.x-oe.x)-ve*(L.y-oe.y);if(0===Be)return!0;if(Be<0)continue;U=!U}}else{if(L.y!==oe.y)continue;if(de.x<=L.x&&L.x<=oe.x||oe.x<=L.x&&L.x<=de.x)return!0}}return U}const E=oh.isClockWise,I=this.subPaths;if(0===I.length)return[];if(!0===u)return m(I);let V,Z,J,ee=[];if(1===I.length)return Z=I[0],J=new De,J.curves=Z.curves,ee.push(J),ee;let _e=!E(I[0].getPoints());_e=t?!_e:_e;const S=[],e=[];let c,p,_=[],w=0;e[w]=void 0,_[w]=[];for(let L=0,O=I.length;L<O;L++)Z=I[L],c=Z.getPoints(),V=E(c),V=t?!V:V,V?(!_e&&e[w]&&w++,e[w]={s:new De,p:c},e[w].s.curves=Z.curves,_e&&w++,_[w]=[]):_[w].push({h:Z,p:c[0]});if(!e[0])return m(I);if(e.length>1){let L=!1;const O=[];for(let F=0,U=e.length;F<U;F++)S[F]=[];for(let F=0,U=e.length;F<U;F++){const te=_[F];for(let ce=0;ce<te.length;ce++){const oe=te[ce];let de=!0;for(let ve=0;ve<e.length;ve++)g(oe.p,e[ve].p)&&(F!==ve&&O.push({froms:F,tos:ve,hole:ce}),de?(de=!1,S[ve].push(oe)):L=!0);de&&S[F].push(oe)}}O.length>0&&(L||(_=S))}for(let L=0,O=e.length;L<O;L++){J=e[L].s,ee.push(J),p=_[L];for(let F=0,U=p.length;F<U;F++)J.holes.push(p[F].h)}return ee}}),Object.assign(hs.prototype,{isFont:!0,generateShapes:function(t,u){void 0===u&&(u=100);const m=[],g=function(E,I,V){const Z=Array.from?Array.from(E):String(E).split(""),J=I/V.resolution,ee=(V.boundingBox.yMax-V.boundingBox.yMin+V.underlineThickness)*J,_e=[];let S=0,e=0;for(let c=0;c<Z.length;c++){const p=Z[c];if("\n"===p)S=0,e-=ee;else{const _=ps(p,J,S,e,V);S+=_.offsetX,_e.push(_.path)}}return _e}(t,u,this.data);for(let E=0,I=g.length;E<I;E++)Array.prototype.push.apply(m,g[E].toShapes());return m}}),ds.prototype=Object.assign(Object.create(hi.prototype),{constructor:ds,load:function(t,u,m,g){const E=this,I=new Dl(this.manager);I.setPath(this.path),I.setRequestHeader(this.requestHeader),I.load(t,function(V){let Z;try{Z=JSON.parse(V)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),Z=JSON.parse(V.substring(65,V.length-2))}const J=E.parse(Z);u&&u(J)},m,g)},parse:function(t){return new hs(t)}});const ad={getContext:function(){return void 0===Ic&&(Ic=new(window.AudioContext||window.webkitAudioContext)),Ic},setContext:function(t){Ic=t}};function Up(t){hi.call(this,t)}function ip(t,u,m){gn.call(this,void 0,m);const g=(new or).set(t),E=(new or).set(u),I=new ot(g.r,g.g,g.b),V=new ot(E.r,E.g,E.b),Z=Math.sqrt(Math.PI),J=Z*Math.sqrt(.75);this.sh.coefficients[0].copy(I).add(V).multiplyScalar(Z),this.sh.coefficients[1].copy(I).sub(V).multiplyScalar(J)}function sp(t,u){gn.call(this,void 0,u);const m=(new or).set(t);this.sh.coefficients[0].set(m.r,m.g,m.b).multiplyScalar(2*Math.sqrt(Math.PI))}Up.prototype=Object.assign(Object.create(hi.prototype),{constructor:Up,load:function(t,u,m,g){const E=this,I=new Dl(E.manager);I.setResponseType("arraybuffer"),I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(V){try{const Z=V.slice(0);ad.getContext().decodeAudioData(Z,function(J){u(J)})}catch(Z){g?g(Z):console.error(Z),E.manager.itemError(t)}},m,g)}}),ip.prototype=Object.assign(Object.create(gn.prototype),{constructor:ip,isHemisphereLightProbe:!0,copy:function(t){return gn.prototype.copy.call(this,t),this},toJSON:function(t){return gn.prototype.toJSON.call(this,t)}}),sp.prototype=Object.assign(Object.create(gn.prototype),{constructor:sp,isAmbientLightProbe:!0,copy:function(t){return gn.prototype.copy.call(this,t),this},toJSON:function(t){return gn.prototype.toJSON.call(this,t)}});const Ad=new ni,Oc=new ni;function ap(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ns,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ns,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function au(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(ap.prototype,{update:function(t){const u=this._cache;if(u.focus!==t.focus||u.fov!==t.fov||u.aspect!==t.aspect*this.aspect||u.near!==t.near||u.far!==t.far||u.zoom!==t.zoom||u.eyeSep!==this.eyeSep){u.focus=t.focus,u.fov=t.fov,u.aspect=t.aspect*this.aspect,u.near=t.near,u.far=t.far,u.zoom=t.zoom,u.eyeSep=this.eyeSep;const m=t.projectionMatrix.clone(),g=u.eyeSep/2,E=g*u.near/u.focus,I=u.near*Math.tan(er.DEG2RAD*u.fov*.5)/u.zoom;let V,Z;Oc.elements[12]=-g,Ad.elements[12]=g,V=-I*u.aspect+E,Z=I*u.aspect+E,m.elements[0]=2*u.near/(Z-V),m.elements[8]=(Z+V)/(Z-V),this.cameraL.projectionMatrix.copy(m),V=-I*u.aspect-E,Z=I*u.aspect-E,m.elements[0]=2*u.near/(Z-V),m.elements[8]=(Z+V)/(Z-V),this.cameraR.projectionMatrix.copy(m)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Oc),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Ad)}}),Object.assign(au.prototype,{start:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const u=(typeof performance>"u"?Date:performance).now();t=(u-this.oldTime)/1e3,this.oldTime=u,this.elapsedTime+=t}return t}});const Na=new ot,$d=new So,Dm=new ot,Cd=new ot;function Rf(){Zn.call(this),this.type="AudioListener",this.context=ad.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new au}function Ld(t){Zn.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}Rf.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Rf,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Zn.prototype.updateMatrixWorld.call(this,t);const u=this.context.listener,m=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Na,$d,Dm),Cd.set(0,0,-1).applyQuaternion($d),u.positionX){const g=this.context.currentTime+this.timeDelta;u.positionX.linearRampToValueAtTime(Na.x,g),u.positionY.linearRampToValueAtTime(Na.y,g),u.positionZ.linearRampToValueAtTime(Na.z,g),u.forwardX.linearRampToValueAtTime(Cd.x,g),u.forwardY.linearRampToValueAtTime(Cd.y,g),u.forwardZ.linearRampToValueAtTime(Cd.z,g),u.upX.linearRampToValueAtTime(m.x,g),u.upY.linearRampToValueAtTime(m.y,g),u.upZ.linearRampToValueAtTime(m.z,g)}else u.setPosition(Na.x,Na.y,Na.z),u.setOrientation(Cd.x,Cd.y,Cd.z,m.x,m.y,m.z)}}),Ld.prototype=Object.assign(Object.create(Zn.prototype),{constructor:Ld,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const u=this.context.createBufferSource();return u.buffer=this.buffer,u.loop=this.loop,u.loopStart=this.loopStart,u.loopEnd=this.loopEnd,u.onended=this.onEnded.bind(this),u.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=u,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,u=this.filters.length;t<u;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,u=this.filters.length;t<u;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});const ld=new ot,hm=new So,Pf=new ot,Bd=new ot;function ff(t){Ld.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function If(t,u){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==u?u:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function pm(t,u,m){let g,E,I;switch(this.binding=t,this.valueSize=m,u){case"quaternion":g=this._slerp,E=this._slerpAdditive,I=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*m),this._workIndex=5;break;case"string":case"bool":g=this._select,E=this._select,I=this._setAdditiveIdentityOther,this.buffer=new Array(5*m);break;default:g=this._lerp,E=this._lerpAdditive,I=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*m)}this._mixBufferRegion=g,this._mixBufferRegionAdditive=E,this._setIdentity=I,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}ff.prototype=Object.assign(Object.create(Ld.prototype),{constructor:ff,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,u,m){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=u,this.panner.coneOuterGain=m,this},updateMatrixWorld:function(t){if(Zn.prototype.updateMatrixWorld.call(this,t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(ld,hm,Pf),Bd.set(0,0,1).applyQuaternion(hm);const u=this.panner;if(u.positionX){const m=this.context.currentTime+this.listener.timeDelta;u.positionX.linearRampToValueAtTime(ld.x,m),u.positionY.linearRampToValueAtTime(ld.y,m),u.positionZ.linearRampToValueAtTime(ld.z,m),u.orientationX.linearRampToValueAtTime(Bd.x,m),u.orientationY.linearRampToValueAtTime(Bd.y,m),u.orientationZ.linearRampToValueAtTime(Bd.z,m)}else u.setPosition(ld.x,ld.y,ld.z),u.setOrientation(Bd.x,Bd.y,Bd.z)}}),Object.assign(If.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){let t=0;const u=this.getFrequencyData();for(let m=0;m<u.length;m++)t+=u[m];return t/u.length}}),Object.assign(pm.prototype,{accumulate:function(t,u){const m=this.buffer,g=this.valueSize,E=t*g+g;let I=this.cumulativeWeight;if(0===I){for(let V=0;V!==g;++V)m[E+V]=m[V];I=u}else I+=u,this._mixBufferRegion(m,E,0,u/I,g);this.cumulativeWeight=I},accumulateAdditive:function(t){const u=this.buffer,m=this.valueSize,g=m*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(u,g,0,t,m),this.cumulativeWeightAdditive+=t},apply:function(t){const u=this.valueSize,m=this.buffer,g=t*u+u,E=this.cumulativeWeight,I=this.cumulativeWeightAdditive,V=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,E<1&&this._mixBufferRegion(m,g,u*this._origIndex,1-E,u),I>0&&this._mixBufferRegionAdditive(m,g,this._addIndex*u,1,u);for(let Z=u,J=u+u;Z!==J;++Z)if(m[Z]!==m[Z+u]){V.setValue(m,g);break}},saveOriginalState:function(){const u=this.buffer,m=this.valueSize,g=m*this._origIndex;this.binding.getValue(u,g);for(let E=m,I=g;E!==I;++E)u[E]=u[g+E%m];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){const t=this._addIndex*this.valueSize,u=t+this.valueSize;for(let m=t;m<u;m++)this.buffer[m]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){const t=this._origIndex*this.valueSize,u=this._addIndex*this.valueSize;for(let m=0;m<this.valueSize;m++)this.buffer[u+m]=this.buffer[t+m]},_select:function(t,u,m,g,E){if(g>=.5)for(let I=0;I!==E;++I)t[u+I]=t[m+I]},_slerp:function(t,u,m,g){So.slerpFlat(t,u,t,u,t,m,g)},_slerpAdditive:function(t,u,m,g,E){const I=this._workIndex*E;So.multiplyQuaternionsFlat(t,I,t,u,t,m),So.slerpFlat(t,u,t,u,t,I,g)},_lerp:function(t,u,m,g,E){const I=1-g;for(let V=0;V!==E;++V){const Z=u+V;t[Z]=t[Z]*I+t[m+V]*g}},_lerpAdditive:function(t,u,m,g,E){for(let I=0;I!==E;++I){const V=u+I;t[V]=t[V]+t[m+I]*g}}});const Um="\\[\\]\\.:\\/",y_=new RegExp("["+Um+"]","g"),dm="[^"+Um+"]",t_="[^"+Um.replace("\\.","")+"]",n_=/((?:WC+[\/:])*)/.source.replace("WC",dm),r_=/(WCOD+)?/.source.replace("WCOD",t_),zm=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",dm),b_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",dm),x_=new RegExp("^"+n_+r_+zm+b_+"$"),fm=["material","materials","bones"];function mm(t,u,m){const g=m||lc.parseTrackName(u);this._targetGroup=t,this._bindings=t.subscribe_(u,g)}function lc(t,u,m){this.path=u,this.parsedPath=m||lc.parseTrackName(u),this.node=lc.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function jm(){this.uuid=er.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let m=0,g=arguments.length;m!==g;++m)t[arguments[m].uuid]=m;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const u=this;this.stats={objects:{get total(){return u._objects.length},get inUse(){return this.total-u.nCachedObjects_}},get bindingsPerObject(){return u._bindings.length}}}function Gm(t,u,m,g){this._mixer=t,this._clip=u,this._localRoot=m||null,this.blendMode=g||u.blendMode;const E=u.tracks,I=E.length,V=new Array(I),Z={endingStart:ba,endingEnd:ba};for(let J=0;J!==I;++J){const ee=E[J].createInterpolant(null);V[J]=ee,ee.settings=Z}this._interpolantSettings=Z,this._interpolants=V,this._propertyBindings=new Array(I),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Fa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function _m(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Of(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Hm(t,u,m){Ca.call(this,t,u),this.meshPerAttribute=m||1}function gm(t,u,m,g){this.ray=new _o(t,u),this.near=m||0,this.far=g||1/0,this.camera=null,this.layers=new gu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Vm(t,u){return t.distance-u.distance}function cd(t,u,m,g){if(t.layers.test(u.layers)&&t.raycast(u,m),!0===g){const E=t.children;for(let I=0,V=E.length;I<V;I++)cd(E[I],u,m,!0)}}Object.assign(mm.prototype,{getValue:function(t,u){this.bind();const g=this._bindings[this._targetGroup.nCachedObjects_];void 0!==g&&g.getValue(t,u)},setValue:function(t,u){const m=this._bindings;for(let g=this._targetGroup.nCachedObjects_,E=m.length;g!==E;++g)m[g].setValue(t,u)},bind:function(){const t=this._bindings;for(let u=this._targetGroup.nCachedObjects_,m=t.length;u!==m;++u)t[u].bind()},unbind:function(){const t=this._bindings;for(let u=this._targetGroup.nCachedObjects_,m=t.length;u!==m;++u)t[u].unbind()}}),Object.assign(lc,{Composite:mm,create:function(t,u,m){return t&&t.isAnimationObjectGroup?new lc.Composite(t,u,m):new lc(t,u,m)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(y_,"")},parseTrackName:function(t){const u=x_.exec(t);if(!u)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const m={nodeName:u[2],objectName:u[3],objectIndex:u[4],propertyName:u[5],propertyIndex:u[6]},g=m.nodeName&&m.nodeName.lastIndexOf(".");if(void 0!==g&&-1!==g){const E=m.nodeName.substring(g+1);-1!==fm.indexOf(E)&&(m.nodeName=m.nodeName.substring(0,g),m.objectName=E)}if(null===m.propertyName||0===m.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return m},findNode:function(t,u){if(!u||""===u||"."===u||-1===u||u===t.name||u===t.uuid)return t;if(t.skeleton){const m=t.skeleton.getBoneByName(u);if(void 0!==m)return m}if(t.children){const m=function(E){for(let I=0;I<E.length;I++){const V=E[I];if(V.name===u||V.uuid===u)return V;const Z=m(V.children);if(Z)return Z}return null},g=m(t.children);if(g)return g}return null}}),Object.assign(lc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,u){t[u]=this.node[this.propertyName]},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)t[u++]=m[g]},function(t,u){t[u]=this.resolvedProperty[this.propertyIndex]},function(t,u){this.resolvedProperty.toArray(t,u)}],SetterByBindingTypeAndVersioning:[[function(t,u){this.targetObject[this.propertyName]=t[u]},function(t,u){this.targetObject[this.propertyName]=t[u],this.targetObject.needsUpdate=!0},function(t,u){this.targetObject[this.propertyName]=t[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++]},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++];this.targetObject.needsUpdate=!0},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){this.resolvedProperty[this.propertyIndex]=t[u]},function(t,u){this.resolvedProperty[this.propertyIndex]=t[u],this.targetObject.needsUpdate=!0},function(t,u){this.resolvedProperty[this.propertyIndex]=t[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){this.resolvedProperty.fromArray(t,u)},function(t,u){this.resolvedProperty.fromArray(t,u),this.targetObject.needsUpdate=!0},function(t,u){this.resolvedProperty.fromArray(t,u),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,u){this.bind(),this.getValue(t,u)},setValue:function(t,u){this.bind(),this.setValue(t,u)},bind:function(){let t=this.node,u=this.parsedPath,m=u.objectName,g=u.propertyName,E=u.propertyIndex;if(t||(t=lc.findNode(this.rootNode,u.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(m){let J=u.objectIndex;switch(m){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let ee=0;ee<t.length;ee++)if(t[ee].name===J){J=ee;break}break;default:if(void 0===t[m])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[m]}if(void 0!==J){if(void 0===t[J])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[J]}}const I=t[g];if(void 0===I)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+u.nodeName+"."+g+" but it wasn't found.",t);let V=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?V=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(V=this.Versioning.MatrixWorldNeedsUpdate);let Z=this.BindingType.Direct;if(void 0!==E){if("morphTargetInfluences"===g){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[E]&&(E=t.morphTargetDictionary[E])}Z=this.BindingType.ArrayElement,this.resolvedProperty=I,this.propertyIndex=E}else void 0!==I.fromArray&&void 0!==I.toArray?(Z=this.BindingType.HasFromToArray,this.resolvedProperty=I):Array.isArray(I)?(Z=this.BindingType.EntireArray,this.resolvedProperty=I):this.propertyName=g;this.getValue=this.GetterByBindingType[Z],this.setValue=this.SetterByBindingTypeAndVersioning[Z][V]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(lc.prototype,{_getValue_unbound:lc.prototype.getValue,_setValue_unbound:lc.prototype.setValue}),Object.assign(jm.prototype,{isAnimationObjectGroup:!0,add:function(){const t=this._objects,u=this._indicesByUUID,m=this._paths,g=this._parsedPaths,E=this._bindings,I=E.length;let V,Z=t.length,J=this.nCachedObjects_;for(let ee=0,_e=arguments.length;ee!==_e;++ee){const S=arguments[ee],e=S.uuid;let c=u[e];if(void 0===c){c=Z++,u[e]=c,t.push(S);for(let p=0,_=I;p!==_;++p)E[p].push(new lc(S,m[p],g[p]))}else if(c<J){V=t[c];const p=--J,_=t[p];u[_.uuid]=c,t[c]=_,u[e]=p,t[p]=S;for(let w=0,L=I;w!==L;++w){const O=E[w];let U=O[c];O[c]=O[p],void 0===U&&(U=new lc(S,m[w],g[w])),O[p]=U}}else t[c]!==V&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=J},remove:function(){const t=this._objects,u=this._indicesByUUID,m=this._bindings,g=m.length;let E=this.nCachedObjects_;for(let I=0,V=arguments.length;I!==V;++I){const Z=arguments[I],J=Z.uuid,ee=u[J];if(void 0!==ee&&ee>=E){const _e=E++,S=t[_e];u[S.uuid]=ee,t[ee]=S,u[J]=_e,t[_e]=Z;for(let e=0,c=g;e!==c;++e){const p=m[e],w=p[ee];p[ee]=p[_e],p[_e]=w}}}this.nCachedObjects_=E},uncache:function(){const t=this._objects,u=this._indicesByUUID,m=this._bindings,g=m.length;let E=this.nCachedObjects_,I=t.length;for(let V=0,Z=arguments.length;V!==Z;++V){const J=arguments[V].uuid,ee=u[J];if(void 0!==ee)if(delete u[J],ee<E){const _e=--E,S=t[_e],e=--I,c=t[e];u[S.uuid]=ee,t[ee]=S,u[c.uuid]=_e,t[_e]=c,t.pop();for(let p=0,_=g;p!==_;++p){const w=m[p],O=w[e];w[ee]=w[_e],w[_e]=O,w.pop()}}else{const _e=--I,S=t[_e];u[S.uuid]=ee,t[ee]=S,t.pop();for(let e=0,c=g;e!==c;++e){const p=m[e];p[ee]=p[_e],p.pop()}}}this.nCachedObjects_=E},subscribe_:function(t,u){let m=this._bindingsIndicesByPath,g=m[t],E=this._bindings;if(void 0!==g)return E[g];const I=this._paths,V=this._parsedPaths,Z=this._objects,ee=this.nCachedObjects_,_e=new Array(Z.length);g=E.length,m[t]=g,I.push(t),V.push(u),E.push(_e);for(let S=ee,e=Z.length;S!==e;++S)_e[S]=new lc(Z[S],t,u);return _e},unsubscribe_:function(t){const u=this._bindingsIndicesByPath,m=u[t];if(void 0!==m){const g=this._paths,E=this._parsedPaths,I=this._bindings,V=I.length-1,Z=I[V];u[t[V]]=m,I[m]=Z,I.pop(),E[m]=E[V],E.pop(),g[m]=g[V],g.pop()}}}),Object.assign(Gm.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,u){return this.loop=t,this.repetitions=u,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,u,m){if(t.fadeOut(u),this.fadeIn(u),m){const g=this._clip.duration,E=t._clip.duration,V=g/E;t.warp(1,E/g,u),this.warp(V,1,u)}return this},crossFadeTo:function(t,u,m){return t.crossFadeFrom(this,u,m)},stopFading:function(){let t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,u,m){const g=this._mixer,E=g.time,I=this.timeScale;let V=this._timeScaleInterpolant;null===V&&(V=g._lendControlInterpolant(),this._timeScaleInterpolant=V);const Z=V.parameterPositions,J=V.sampleValues;return Z[0]=E,Z[1]=E+m,J[0]=t/I,J[1]=u/I,this},stopWarping:function(){let t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,u,m,g){if(!this.enabled)return void this._updateWeight(t);const E=this._startTime;if(null!==E){const Z=(t-E)*m;if(Z<0||0===m)return;this._startTime=null,u=m*Z}u*=this._updateTimeScale(t);const I=this._updateTime(u),V=this._updateWeight(t);if(V>0){const Z=this._interpolants,J=this._propertyBindings;if(this.blendMode===Wu)for(let ee=0,_e=Z.length;ee!==_e;++ee)Z[ee].evaluate(I),J[ee].accumulateAdditive(V);else for(let ee=0,_e=Z.length;ee!==_e;++ee)Z[ee].evaluate(I),J[ee].accumulate(g,V)}},_updateWeight:function(t){let u=0;if(this.enabled){u=this.weight;const m=this._weightInterpolant;if(null!==m){const g=m.evaluate(t)[0];u*=g,t>m.parameterPositions[1]&&(this.stopFading(),0===g&&(this.enabled=!1))}}return this._effectiveWeight=u,u},_updateTimeScale:function(t){let u=0;if(!this.paused){u=this.timeScale;const m=this._timeScaleInterpolant;null!==m&&(u*=m.evaluate(t)[0],t>m.parameterPositions[1]&&(this.stopWarping(),0===u?this.paused=!0:this.timeScale=u))}return this._effectiveTimeScale=u,u},_updateTime:function(t){const u=this._clip.duration,m=this.loop;let g=this.time+t,E=this._loopCount;const I=m===dc;if(0===t)return-1===E||!I||1&~E?g:u-g;if(m===fu){-1===E&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(g>=u)g=u;else{if(!(g<0)){this.time=g;break e}g=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===E&&(t>=0?(E=0,this._setEndings(!0,0===this.repetitions,I)):this._setEndings(0===this.repetitions,!0,I)),g>=u||g<0){const V=Math.floor(g/u);g-=u*V,E+=Math.abs(V);const Z=this.repetitions-E;if(Z<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,g=t>0?u:0,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===Z){const J=t<0;this._setEndings(J,!J,I)}else this._setEndings(!1,!1,I);this._loopCount=E,this.time=g,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:V})}}else this.time=g;if(I&&!(1&~E))return u-g}return g},_setEndings:function(t,u,m){const g=this._interpolantSettings;m?(g.endingStart=sa,g.endingEnd=sa):(g.endingStart=t?this.zeroSlopeAtStart?sa:ba:wl,g.endingEnd=u?this.zeroSlopeAtEnd?sa:ba:wl)},_scheduleFading:function(t,u,m){const g=this._mixer,E=g.time;let I=this._weightInterpolant;null===I&&(I=g._lendControlInterpolant(),this._weightInterpolant=I);const V=I.parameterPositions,Z=I.sampleValues;return V[0]=E,Z[0]=u,V[1]=E+t,Z[1]=m,this}}),_m.prototype=Object.assign(Object.create(ca.prototype),{constructor:_m,_bindAction:function(t,u){const m=t._localRoot||this._root,g=t._clip.tracks,E=g.length,I=t._propertyBindings,V=t._interpolants,Z=m.uuid,J=this._bindingsByRootAndName;let ee=J[Z];void 0===ee&&(ee={},J[Z]=ee);for(let _e=0;_e!==E;++_e){const S=g[_e],e=S.name;let c=ee[e];if(void 0!==c)I[_e]=c;else{if(c=I[_e],void 0!==c){null===c._cacheIndex&&(++c.referenceCount,this._addInactiveBinding(c,Z,e));continue}c=new pm(lc.create(m,e,u&&u._propertyBindings[_e].binding.parsedPath),S.ValueTypeName,S.getValueSize()),++c.referenceCount,this._addInactiveBinding(c,Z,e),I[_e]=c}V[_e].resultBuffer=c.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const m=(t._localRoot||this._root).uuid,g=t._clip.uuid,E=this._actionsByClip[g];this._bindAction(t,E&&E.knownActions[0]),this._addInactiveAction(t,g,m)}const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==E.useCount++&&(this._lendBinding(E),E.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==--E.useCount&&(E.restoreOriginalState(),this._takeBackBinding(E))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){const u=t._cacheIndex;return null!==u&&u<this._nActiveActions},_addInactiveAction:function(t,u,m){const g=this._actions,E=this._actionsByClip;let I=E[u];if(void 0===I)I={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,E[u]=I;else{const V=I.knownActions;t._byClipCacheIndex=V.length,V.push(t)}t._cacheIndex=g.length,g.push(t),I.actionByRoot[m]=t},_removeInactiveAction:function(t){const u=this._actions,m=u[u.length-1],g=t._cacheIndex;m._cacheIndex=g,u[g]=m,u.pop(),t._cacheIndex=null;const E=t._clip.uuid,I=this._actionsByClip,V=I[E],Z=V.knownActions,J=Z[Z.length-1],ee=t._byClipCacheIndex;J._byClipCacheIndex=ee,Z[ee]=J,Z.pop(),t._byClipCacheIndex=null,delete V.actionByRoot[(t._localRoot||this._root).uuid],0===Z.length&&delete I[E],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==--E.referenceCount&&this._removeInactiveBinding(E)}},_lendAction:function(t){const u=this._actions,m=t._cacheIndex,g=this._nActiveActions++,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_takeBackAction:function(t){const u=this._actions,m=t._cacheIndex,g=--this._nActiveActions,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_addInactiveBinding:function(t,u,m){const g=this._bindingsByRootAndName,E=this._bindings;let I=g[u];void 0===I&&(I={},g[u]=I),I[m]=t,t._cacheIndex=E.length,E.push(t)},_removeInactiveBinding:function(t){const u=this._bindings,m=t.binding,g=m.rootNode.uuid,E=m.path,I=this._bindingsByRootAndName,V=I[g],Z=u[u.length-1],J=t._cacheIndex;Z._cacheIndex=J,u[J]=Z,u.pop(),delete V[E],0===Object.keys(V).length&&delete I[g]},_lendBinding:function(t){const u=this._bindings,m=t._cacheIndex,g=this._nActiveBindings++,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_takeBackBinding:function(t){const u=this._bindings,m=t._cacheIndex,g=--this._nActiveBindings,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_lendControlInterpolant:function(){const t=this._controlInterpolants,u=this._nActiveControlInterpolants++;let m=t[u];return void 0===m&&(m=new su(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),m.__cacheIndex=u,t[u]=m),m},_takeBackControlInterpolant:function(t){const u=this._controlInterpolants,m=t.__cacheIndex,g=--this._nActiveControlInterpolants,E=u[g];t.__cacheIndex=g,u[g]=t,E.__cacheIndex=m,u[m]=E},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,u,m){const g=u||this._root,E=g.uuid;let I="string"==typeof t?rs.findByName(g,t):t;const V=null!==I?I.uuid:t;let Z=this._actionsByClip[V],J=null;if(void 0===m&&(m=null!==I?I.blendMode:Vu),void 0!==Z){const _e=Z.actionByRoot[E];if(void 0!==_e&&_e.blendMode===m)return _e;J=Z.knownActions[0],null===I&&(I=J._clip)}if(null===I)return null;const ee=new Gm(this,I,u,m);return this._bindAction(ee,J),this._addInactiveAction(ee,V,E),ee},existingAction:function(t,u){const m=u||this._root,g=m.uuid,E="string"==typeof t?rs.findByName(m,t):t,V=this._actionsByClip[E?E.uuid:t];return void 0!==V&&V.actionByRoot[g]||null},stopAllAction:function(){const t=this._actions;for(let u=this._nActiveActions-1;u>=0;--u)t[u].stop();return this},update:function(t){const u=this._actions,m=this._nActiveActions,g=this.time+=t*=this.timeScale,E=Math.sign(t),I=this._accuIndex^=1;for(let J=0;J!==m;++J)u[J]._update(g,t,E,I);const V=this._bindings,Z=this._nActiveBindings;for(let J=0;J!==Z;++J)V[J].apply(I);return this},setTime:function(t){this.time=0;for(let u=0;u<this._actions.length;u++)this._actions[u].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){const u=this._actions,m=t.uuid,g=this._actionsByClip,E=g[m];if(void 0!==E){const I=E.knownActions;for(let V=0,Z=I.length;V!==Z;++V){const J=I[V];this._deactivateAction(J);const ee=J._cacheIndex,_e=u[u.length-1];J._cacheIndex=null,J._byClipCacheIndex=null,_e._cacheIndex=ee,u[ee]=_e,u.pop(),this._removeInactiveBindingsForAction(J)}delete g[m]}},uncacheRoot:function(t){const u=t.uuid,m=this._actionsByClip;for(const E in m){const I=m[E].actionByRoot[u];void 0!==I&&(this._deactivateAction(I),this._removeInactiveAction(I))}const g=this._bindingsByRootAndName[u];if(void 0!==g)for(const E in g){const I=g[E];I.restoreOriginalState(),this._removeInactiveBinding(I)}},uncacheAction:function(t,u){const m=this.existingAction(t,u);null!==m&&(this._deactivateAction(m),this._removeInactiveAction(m))}}),Of.prototype.clone=function(){return new Of(void 0===this.value.clone?this.value:this.value.clone())},Hm.prototype=Object.assign(Object.create(Ca.prototype),{constructor:Hm,isInstancedInterleavedBuffer:!0,copy:function(t){return Ca.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){const u=Ca.prototype.clone.call(this,t);return u.meshPerAttribute=this.meshPerAttribute,u},toJSON:function(t){const u=Ca.prototype.toJSON.call(this,t);return u.isInstancedInterleavedBuffer=!0,u.meshPerAttribute=this.meshPerAttribute,u}}),Object.assign(gm.prototype,{set:function(t,u){this.ray.set(t,u)},setFromCamera:function(t,u){u&&u.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(u.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(u).sub(this.ray.origin).normalize(),this.camera=u):u&&u.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(u.near+u.far)/(u.near-u.far)).unproject(u),this.ray.direction.set(0,0,-1).transformDirection(u.matrixWorld),this.camera=u):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,u,m){const g=m||[];return cd(t,this,g,u),g.sort(Vm),g},intersectObjects:function(t,u,m){const g=m||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),g;for(let E=0,I=t.length;E<I;E++)cd(t[E],this,g,u);return g.sort(Vm),g}});class i_{constructor(u=1,m=0,g=0){return this.radius=u,this.phi=m,this.theta=g,this}set(u,m,g){return this.radius=u,this.phi=m,this.theta=g,this}clone(){return(new this.constructor).copy(this)}copy(u){return this.radius=u.radius,this.phi=u.phi,this.theta=u.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(u){return this.setFromCartesianCoords(u.x,u.y,u.z)}setFromCartesianCoords(u,m,g){return this.radius=Math.sqrt(u*u+m*m+g*g),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(u,g),this.phi=Math.acos(er.clamp(m/this.radius,-1,1))),this}}function o_(t,u,m){return this.radius=void 0!==t?t:1,this.theta=void 0!==u?u:0,this.y=void 0!==m?m:0,this}Object.assign(o_.prototype,{set:function(t,u,m){return this.radius=t,this.theta=u,this.y=m,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,u,m){return this.radius=Math.sqrt(t*t+m*m),this.theta=Math.atan2(t,m),this.y=u,this}});const Nd=new Sn;function Wm(t,u){this.min=void 0!==t?t:new Sn(1/0,1/0),this.max=void 0!==u?u:new Sn(-1/0,-1/0)}Object.assign(Wm.prototype,{set:function(t,u){return this.min.copy(t),this.max.copy(u),this},setFromPoints:function(t){this.makeEmpty();for(let u=0,m=t.length;u<m;u++)this.expandByPoint(t[u]);return this},setFromCenterAndSize:function(t,u){const m=Nd.copy(u).multiplyScalar(.5);return this.min.copy(t).sub(m),this.max.copy(t).add(m),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Sn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Sn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,u){return void 0===u&&(console.warn("THREE.Box2: .getParameter() target is now required"),u=new Sn),u.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,u){return void 0===u&&(console.warn("THREE.Box2: .clampPoint() target is now required"),u=new Sn),u.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Nd.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const vm=new ot,zp=new ot;function ym(t,u){this.start=void 0!==t?t:new ot,this.end=void 0!==u?u:new ot}function kf(t){Zn.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Object.assign(ym.prototype,{set:function(t,u){return this.start.copy(t),this.end.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new ot),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new ot),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,u){return void 0===u&&(console.warn("THREE.Line3: .at() target is now required"),u=new ot),this.delta(u).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,u){vm.subVectors(t,this.start),zp.subVectors(this.end,this.start);const m=zp.dot(zp);let g=zp.dot(vm)/m;return u&&(g=er.clamp(g,0,1)),g},closestPointToPoint:function(t,u,m){const g=this.closestPointToPointParameter(t,u);return void 0===m&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),m=new ot),this.delta(m).multiplyScalar(g).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),(kf.prototype=Object.create(Zn.prototype)).constructor=kf,kf.prototype.isImmediateRenderObject=!0;const Rd=new ot;function mf(t,u){Zn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=u;const m=new pn,g=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let I=0,V=1,Z=32;I<Z;I++,V++){const J=I/Z*Math.PI*2,ee=V/Z*Math.PI*2;g.push(Math.cos(J),Math.sin(J),1,Math.cos(ee),Math.sin(ee),1)}m.setAttribute("position",new Dn(g,3));const E=new Ir({fog:!1,toneMapped:!1});this.cone=new Wi(m,E),this.add(this.cone),this.update()}(mf.prototype=Object.create(Zn.prototype)).constructor=mf,mf.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},mf.prototype.update=function(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,u=t*Math.tan(this.light.angle);this.cone.scale.set(u,u,t),Rd.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Rd),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};const ud=new ot,Ff=new ni,Df=new ni;function s_(t){const u=[];t&&t.isBone&&u.push(t);for(let m=0;m<t.children.length;m++)u.push.apply(u,s_(t.children[m]));return u}function hd(t){const u=s_(t),m=new pn,g=[],E=[],I=new or(0,0,1),V=new or(0,1,0);for(let J=0;J<u.length;J++){const ee=u[J];ee.parent&&ee.parent.isBone&&(g.push(0,0,0),g.push(0,0,0),E.push(I.r,I.g,I.b),E.push(V.r,V.g,V.b))}m.setAttribute("position",new Dn(g,3)),m.setAttribute("color",new Dn(E,3));const Z=new Ir({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Wi.call(this,m,Z),this.type="SkeletonHelper",this.root=t,this.bones=u,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function _f(t,u,m){this.light=t,this.light.updateMatrixWorld(),this.color=m;const g=new Ru(u,4,2),E=new ro({wireframe:!0,fog:!1,toneMapped:!1});Li.call(this,g,E),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}(hd.prototype=Object.create(Wi.prototype)).constructor=hd,hd.prototype.isSkeletonHelper=!0,hd.prototype.updateMatrixWorld=function(t){const u=this.bones,m=this.geometry,g=m.getAttribute("position");Df.getInverse(this.root.matrixWorld);for(let E=0,I=0;E<u.length;E++){const V=u[E];V.parent&&V.parent.isBone&&(Ff.multiplyMatrices(Df,V.matrixWorld),ud.setFromMatrixPosition(Ff),g.setXYZ(I,ud.x,ud.y,ud.z),Ff.multiplyMatrices(Df,V.parent.matrixWorld),ud.setFromMatrixPosition(Ff),g.setXYZ(I+1,ud.x,ud.y,ud.z),I+=2)}m.getAttribute("position").needsUpdate=!0,Zn.prototype.updateMatrixWorld.call(this,t)},(_f.prototype=Object.create(Li.prototype)).constructor=_f,_f.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},_f.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};const w_=new ot,a_=new or,l_=new or;function gf(t,u,m){Zn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=m;const g=new Zs(u);g.rotateY(.5*Math.PI),this.material=new ro({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const E=g.getAttribute("position"),I=new Float32Array(3*E.count);g.setAttribute("color",new Hr(I,3)),this.add(new Li(g,this.material)),this.update()}function Uf(t,u,m,g){t=t||10,u=u||10,m=new or(void 0!==m?m:4473924),g=new or(void 0!==g?g:8947848);const E=u/2,I=t/u,V=t/2,Z=[],J=[];for(let S=0,e=0,c=-V;S<=u;S++,c+=I){Z.push(-V,0,c,V,0,c),Z.push(c,0,-V,c,0,V);const p=S===E?m:g;p.toArray(J,e),e+=3,p.toArray(J,e),e+=3,p.toArray(J,e),e+=3,p.toArray(J,e),e+=3}const ee=new pn;ee.setAttribute("position",new Dn(Z,3)),ee.setAttribute("color",new Dn(J,3));const _e=new Ir({vertexColors:!0,toneMapped:!1});Wi.call(this,ee,_e),this.type="GridHelper"}function bm(t,u,m,g,E,I){t=t||10,u=u||16,m=m||8,g=g||64,E=new or(void 0!==E?E:4473924),I=new or(void 0!==I?I:8947848);const V=[],Z=[];for(let _e=0;_e<=u;_e++){const S=_e/u*(2*Math.PI),e=Math.sin(S)*t,c=Math.cos(S)*t;V.push(0,0,0),V.push(e,0,c);const p=1&_e?E:I;Z.push(p.r,p.g,p.b),Z.push(p.r,p.g,p.b)}for(let _e=0;_e<=m;_e++){const S=1&_e?E:I,e=t-t/m*_e;for(let c=0;c<g;c++){let p=c/g*(2*Math.PI),_=Math.sin(p)*e,w=Math.cos(p)*e;V.push(_,0,w),Z.push(S.r,S.g,S.b),p=(c+1)/g*(2*Math.PI),_=Math.sin(p)*e,w=Math.cos(p)*e,V.push(_,0,w),Z.push(S.r,S.g,S.b)}}const J=new pn;J.setAttribute("position",new Dn(V,3)),J.setAttribute("color",new Dn(Z,3));const ee=new Ir({vertexColors:!0,toneMapped:!1});Wi.call(this,J,ee),this.type="PolarGridHelper"}(gf.prototype=Object.create(Zn.prototype)).constructor=gf,gf.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},gf.prototype.update=function(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const u=t.geometry.getAttribute("color");a_.copy(this.light.color),l_.copy(this.light.groundColor);for(let m=0,g=u.count;m<g;m++){const E=m<g/2?a_:l_;u.setXYZ(m,E.r,E.g,E.b)}u.needsUpdate=!0}t.lookAt(w_.setFromMatrixPosition(this.light.matrixWorld).negate())},(Uf.prototype=Object.create(Wi.prototype)).constructor=Uf,(bm.prototype=Object.create(Wi.prototype)).constructor=bm;const yo=new ot,zf=new ot,c_=new ot;function tf(t,u,m){Zn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=m,void 0===u&&(u=1);let g=new pn;g.setAttribute("position",new Dn([-u,u,0,u,u,0,u,-u,0,-u,-u,0,-u,u,0],3));const E=new Ir({fog:!1,toneMapped:!1});this.lightPlane=new Di(g,E),this.add(this.lightPlane),g=new pn,g.setAttribute("position",new Dn([0,0,0,0,0,1],3)),this.targetLine=new Di(g,E),this.add(this.targetLine),this.update()}(tf.prototype=Object.create(Zn.prototype)).constructor=tf,tf.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},tf.prototype.update=function(){yo.setFromMatrixPosition(this.light.matrixWorld),zf.setFromMatrixPosition(this.light.target.matrixWorld),c_.subVectors(zf,yo),this.lightPlane.lookAt(zf),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(zf),this.targetLine.scale.z=c_.length()};const nf=new ot,na=new Ai;function vf(t){const u=new pn,m=new Ir({color:16777215,vertexColors:!0,toneMapped:!1}),g=[],E=[],I={},V=new or(16755200),Z=new or(16711680),J=new or(43775),ee=new or(16777215),_e=new or(3355443);function S(c,p,_){e(c,_),e(p,_)}function e(c,p){g.push(0,0,0),E.push(p.r,p.g,p.b),void 0===I[c]&&(I[c]=[]),I[c].push(g.length/3-1)}S("n1","n2",V),S("n2","n4",V),S("n4","n3",V),S("n3","n1",V),S("f1","f2",V),S("f2","f4",V),S("f4","f3",V),S("f3","f1",V),S("n1","f1",V),S("n2","f2",V),S("n3","f3",V),S("n4","f4",V),S("p","n1",Z),S("p","n2",Z),S("p","n3",Z),S("p","n4",Z),S("u1","u2",J),S("u2","u3",J),S("u3","u1",J),S("c","t",ee),S("p","c",_e),S("cn1","cn2",_e),S("cn3","cn4",_e),S("cf1","cf2",_e),S("cf3","cf4",_e),u.setAttribute("position",new Dn(g,3)),u.setAttribute("color",new Dn(E,3)),Wi.call(this,u,m),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=I,this.update()}function Ra(t,u,m,g,E,I,V){nf.set(E,I,V).unproject(g);const Z=u[t];if(void 0!==Z){const J=m.getAttribute("position");for(let ee=0,_e=Z.length;ee<_e;ee++)J.setXYZ(Z[ee],nf.x,nf.y,nf.z)}}(vf.prototype=Object.create(Wi.prototype)).constructor=vf,vf.prototype.update=function(){const t=this.geometry,u=this.pointMap;na.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ra("c",u,t,na,0,0,-1),Ra("t",u,t,na,0,0,1),Ra("n1",u,t,na,-1,-1,-1),Ra("n2",u,t,na,1,-1,-1),Ra("n3",u,t,na,-1,1,-1),Ra("n4",u,t,na,1,1,-1),Ra("f1",u,t,na,-1,-1,1),Ra("f2",u,t,na,1,-1,1),Ra("f3",u,t,na,-1,1,1),Ra("f4",u,t,na,1,1,1),Ra("u1",u,t,na,.7,1.1,-1),Ra("u2",u,t,na,-.7,1.1,-1),Ra("u3",u,t,na,0,2,-1),Ra("cf1",u,t,na,-1,0,1),Ra("cf2",u,t,na,1,0,1),Ra("cf3",u,t,na,0,-1,1),Ra("cf4",u,t,na,0,1,1),Ra("cn1",u,t,na,-1,0,-1),Ra("cn2",u,t,na,1,0,-1),Ra("cn3",u,t,na,0,-1,-1),Ra("cn4",u,t,na,0,1,-1),t.getAttribute("position").needsUpdate=!0};const jf=new mn;function jp(t,u){this.object=t,void 0===u&&(u=16776960);const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new Float32Array(24),E=new pn;E.setIndex(new Hr(m,1)),E.setAttribute("position",new Hr(g,3)),Wi.call(this,E,new Ir({color:u,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function Gf(t,u){this.type="Box3Helper",this.box=t,void 0===u&&(u=16776960);const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new pn;g.setIndex(new Hr(m,1)),g.setAttribute("position",new Dn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Wi.call(this,g,new Ir({color:u,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function Hf(t,u,m){this.plane=t,this.size=void 0===u?1:u;const g=void 0!==m?m:16776960,E=new pn;E.setAttribute("position",new Dn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),E.computeBoundingSphere(),Di.call(this,E,new Ir({color:g,toneMapped:!1})),this.type="PlaneHelper";const I=new pn;I.setAttribute("position",new Dn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),I.computeBoundingSphere(),this.add(new Li(I,new ro({color:g,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}(jp.prototype=Object.create(Wi.prototype)).constructor=jp,jp.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&jf.setFromObject(this.object),jf.isEmpty())return;const u=jf.min,m=jf.max,g=this.geometry.attributes.position,E=g.array;E[0]=m.x,E[1]=m.y,E[2]=m.z,E[3]=u.x,E[4]=m.y,E[5]=m.z,E[6]=u.x,E[7]=u.y,E[8]=m.z,E[9]=m.x,E[10]=u.y,E[11]=m.z,E[12]=m.x,E[13]=m.y,E[14]=u.z,E[15]=u.x,E[16]=m.y,E[17]=u.z,E[18]=u.x,E[19]=u.y,E[20]=u.z,E[21]=m.x,E[22]=u.y,E[23]=u.z,g.needsUpdate=!0,this.geometry.computeBoundingSphere()},jp.prototype.setFromObject=function(t){return this.object=t,this.update(),this},jp.prototype.copy=function(t){return Wi.prototype.copy.call(this,t),this.object=t.object,this},(Gf.prototype=Object.create(Wi.prototype)).constructor=Gf,Gf.prototype.updateMatrixWorld=function(t){const u=this.box;u.isEmpty()||(u.getCenter(this.position),u.getSize(this.scale),this.scale.multiplyScalar(.5),Zn.prototype.updateMatrixWorld.call(this,t))},(Hf.prototype=Object.create(Di.prototype)).constructor=Hf,Hf.prototype.updateMatrixWorld=function(t){let u=-this.plane.constant;Math.abs(u)<1e-8&&(u=1e-8),this.scale.set(.5*this.size,.5*this.size,u),this.children[0].material.side=u<0?W:ie,this.lookAt(this.plane.normal),Zn.prototype.updateMatrixWorld.call(this,t)};const qm=new ot;let pd,xm;function lp(t,u,m,g,E,I){Zn.call(this),this.type="ArrowHelper",void 0===t&&(t=new ot(0,0,1)),void 0===u&&(u=new ot(0,0,0)),void 0===m&&(m=1),void 0===g&&(g=16776960),void 0===E&&(E=.2*m),void 0===I&&(I=.2*E),void 0===pd&&(pd=new pn,pd.setAttribute("position",new Dn([0,0,0,0,1,0],3)),xm=new Ho(0,.5,1,5,1),xm.translate(0,-.5,0)),this.position.copy(u),this.line=new Di(pd,new Ir({color:g,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Li(xm,new ro({color:g,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(m,E,I)}function yf(t){const u=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],m=new pn;m.setAttribute("position",new Dn(u,3)),m.setAttribute("color",new Dn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));const g=new Ir({vertexColors:!0,toneMapped:!1});Wi.call(this,m,g),this.type="AxesHelper"}(lp.prototype=Object.create(Zn.prototype)).constructor=lp,lp.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{qm.set(t.z,0,-t.x).normalize();const u=Math.acos(t.y);this.quaternion.setFromAxisAngle(qm,u)}},lp.prototype.setLength=function(t,u,m){void 0===u&&(u=.2*t),void 0===m&&(m=.2*u),this.line.scale.set(1,Math.max(1e-4,t-u),1),this.line.updateMatrix(),this.cone.scale.set(m,u,m),this.cone.position.y=t,this.cone.updateMatrix()},lp.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},lp.prototype.copy=function(t){return Zn.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},(yf.prototype=Object.create(Wi.prototype)).constructor=yf;const up=Math.pow(2,8),Xm=[.125,.215,.35,.446,.526,.582],u_=5+Xm.length,ch=20,uh={[Ki]:0,[rl]:1,[Hc]:2,[mc]:3,[qu]:4,[mu]:5,[ql]:6},Vf=new Lt,{_lodPlanes:bf,_sizeLods:Ym,_sigmas:wm}=function(){const t=[],u=[],m=[];let g=8;for(let E=0;E<u_;E++){const I=Math.pow(2,g);u.push(I);let V=1/I;E>4?V=Xm[E-8+4-1]:0==E&&(V=0),m.push(V);const Z=1/(I-1),J=-Z/2,ee=1+Z/2,_e=[J,J,ee,J,ee,ee,J,J,ee,ee,J,ee],S=6,e=6,c=3,p=2,_=1,w=new Float32Array(c*e*S),L=new Float32Array(p*e*S),O=new Float32Array(_*e*S);for(let U=0;U<S;U++){const te=U%3*2/3-1,ce=U>2?0:-1;w.set([te,ce,0,te+2/3,ce,0,te+2/3,ce+1,0,te,ce,0,te+2/3,ce+1,0,te,ce+1,0],c*e*U),L.set(_e,p*e*U),O.set([U,U,U,U,U,U],_*e*U)}const F=new pn;F.setAttribute("position",new Hr(w,c)),F.setAttribute("uv",new Hr(L,p)),F.setAttribute("faceIndex",new Hr(O,_)),t.push(F),g>4&&g--}return{_lodPlanes:t,_sizeLods:u,_sigmas:m}}();let Jm=null;const Pd=(1+Math.sqrt(5))/2,rf=1/Pd,h_=[new ot(1,1,1),new ot(-1,1,1),new ot(1,1,-1),new ot(-1,1,-1),new ot(0,Pd,rf),new ot(0,Pd,-rf),new ot(rf,0,Pd),new ot(-rf,0,Pd),new ot(Pd,rf,0),new ot(-Pd,rf,0)];function Sm(t){var u;this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=new _a({name:"SphericalGaussianBlur",defines:{n:u=ch},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(u)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new ot(0,1,0)},inputEncoding:{value:uh[Ki]},outputEncoding:{value:uh[Ki]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1}),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function S_(t){return void 0!==t&&t.type===oa&&(t.encoding===Ki||t.encoding===rl||t.encoding===ql)}function Zm(t){const u=new ks(3*up,3*up,t);return u.texture.mapping=Oi,u.texture.name="PMREM.cubeUv",u.scissorTest=!0,u}function of(t,u,m,g,E){t.viewport.set(u,m,g,E),t.scissor.set(u,m,g,E)}function Qm(){return new _a({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new Sn(1,1)},inputEncoding:{value:uh[Ki]},outputEncoding:{value:uh[Ki]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function p_(){return new _a({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:uh[Ki]},outputEncoding:{value:uh[Ki]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function Em(t,u,m,g,E,I,V){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ha(t,u,m,E,I,V)}Sm.prototype={constructor:Sm,fromScene:function(t,u=0,m=.1,g=100){Jm=this._renderer.getRenderTarget();const E=this._allocateTargets();return this._sceneToCubeUV(t,m,g,E),u>0&&this._blur(E,0,0,u),this._applyPMREM(E),this._cleanup(E),E},fromEquirectangular:function(t){return this._fromTexture(t)},fromCubemap:function(t){return this._fromTexture(t)},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=p_(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=Qm(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<bf.length;t++)bf[t].dispose()},_cleanup:function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Jm),t.scissorTest=!1,of(t,0,0,t.width,t.height)},_fromTexture:function(t){Jm=this._renderer.getRenderTarget();const u=this._allocateTargets(t);return this._textureToCubeUV(t,u),this._applyPMREM(u),this._cleanup(u),u},_allocateTargets:function(t){const u={magFilter:Or,minFilter:Or,generateMipmaps:!1,type:oa,format:ph,encoding:S_(t)?t.encoding:Hc,depthBuffer:!1,stencilBuffer:!1},m=Zm(u);return m.depthBuffer=!t,this._pingPongRenderTarget=Zm(u),m},_compileMaterial:function(t){const u=new Li(bf[0],t);this._renderer.compile(u,Vf)},_sceneToCubeUV:function(t,u,m,g){const E=new Ns(90,1,u,m),I=[1,-1,1,1,1,1],V=[1,1,1,-1,-1,-1],Z=this._renderer,J=Z.outputEncoding,ee=Z.toneMapping,_e=Z.getClearColor(),S=Z.getClearAlpha();Z.toneMapping=mr,Z.outputEncoding=Ki;let e=t.background;if(e&&e.isColor){e.convertSRGBToLinear();const c=Math.max(e.r,e.g,e.b),p=Math.min(Math.max(Math.ceil(Math.log2(c)),-128),127);e=e.multiplyScalar(Math.pow(2,-p)),Z.setClearColor(e,(p+128)/255),t.background=null}for(let c=0;c<6;c++){const p=c%3;0==p?(E.up.set(0,I[c],0),E.lookAt(V[c],0,0)):1==p?(E.up.set(0,0,I[c]),E.lookAt(0,V[c],0)):(E.up.set(0,I[c],0),E.lookAt(0,0,V[c])),of(g,p*up,c>2?up:0,up,up),Z.setRenderTarget(g),Z.render(t,E)}Z.toneMapping=ee,Z.outputEncoding=J,Z.setClearColor(_e,S)},_textureToCubeUV:function(t,u){const m=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=p_()):null==this._equirectShader&&(this._equirectShader=Qm());const g=t.isCubeTexture?this._cubemapShader:this._equirectShader,E=new Li(bf[0],g),I=g.uniforms;I.envMap.value=t,t.isCubeTexture||I.texelSize.value.set(1/t.image.width,1/t.image.height),I.inputEncoding.value=uh[t.encoding],I.outputEncoding.value=uh[u.texture.encoding],of(u,0,0,3*up,2*up),m.setRenderTarget(u),m.render(E,Vf)},_applyPMREM:function(t){const u=this._renderer,m=u.autoClear;u.autoClear=!1;for(let g=1;g<u_;g++){const E=Math.sqrt(wm[g]*wm[g]-wm[g-1]*wm[g-1]);this._blur(t,g-1,g,E,h_[(g-1)%h_.length])}u.autoClear=m},_blur:function(t,u,m,g,E){const I=this._pingPongRenderTarget;this._halfBlur(t,I,u,m,g,"latitudinal",E),this._halfBlur(I,t,m,m,g,"longitudinal",E)},_halfBlur:function(t,u,m,g,E,I,V){const Z=this._renderer,J=this._blurMaterial;"latitudinal"!==I&&"longitudinal"!==I&&console.error("blur direction must be either latitudinal or longitudinal!");const ee=new Li(bf[g],J),_e=J.uniforms,S=Ym[m]-1,e=isFinite(E)?Math.PI/(2*S):2*Math.PI/(2*ch-1),c=E/e,p=isFinite(E)?1+Math.floor(3*c):ch;p>ch&&console.warn(`sigmaRadians, ${E}, is too large and will clip, as it requested ${p} samples when the maximum is set to ${ch}`);const _=[];let w=0;for(let O=0;O<ch;++O){const F=O/c,U=Math.exp(-F*F/2);_.push(U),0==O?w+=U:O<p&&(w+=2*U)}for(let O=0;O<_.length;O++)_[O]=_[O]/w;_e.envMap.value=t.texture,_e.samples.value=p,_e.weights.value=_,_e.latitudinal.value="latitudinal"===I,V&&(_e.poleAxis.value=V),_e.dTheta.value=e,_e.mipInt.value=8-m,_e.inputEncoding.value=uh[t.texture.encoding],_e.outputEncoding.value=uh[t.texture.encoding];const L=Ym[g];of(u,3*Math.max(0,up-2*L),(0===g?0:2*up)+2*L*(g>4?g-8+4:0),3*L,2*L),Z.setRenderTarget(u),Z.render(ee,Vf)}};const va=0,E_=1,Pa=0,Tm=1,d_=2;function T_(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function M_(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function f_(t,u){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new tu(t,u)}function Mm(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Wa(t)}function Km(t,u){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new tu(t,u)}function A_(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Pl(t)}function m_(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Pl(t)}function __(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Pl(t)}function $_(t,u,m){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new ot(t,u,m)}function C_(t,u){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Hr(t,u).setUsage(Lr)}function L_(t,u){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new ol(t,u)}function B_(t,u){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Ec(t,u)}function N_(t,u){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Yu(t,u)}function R_(t,u){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Xh(t,u)}function P_(t,u){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Ml(t,u)}function I_(t,u){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Qn(t,u)}function O_(t,u){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new sl(t,u)}function k_(t,u){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Dn(t,u)}function F_(t,u){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Al(t,u)}function g_(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),k.call(this,t),this.type="catmullrom",this.closed=!0}function v_(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),k.call(this,t),this.type="catmullrom"}function e_(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),k.call(this,t),this.type="catmullrom"}function D_(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new yf(t)}function U_(t,u){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new jp(t,u)}function z_(t,u){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Wi(new $h(t.geometry),new Ir({color:void 0!==u?u:16777215}))}function j_(t,u){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Wi(new Ol(t.geometry),new Ir({color:void 0!==u?u:16777215}))}function G_(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Dl(t)}function H_(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Pc(t)}function V_(t,u,m){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Cl(t,m)}yr.create=function(t,u){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(yr.prototype),t.prototype.constructor=t,t.prototype.getPoint=u,t},Object.assign(Oe.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=this.getPoints(t);return this.createGeometry(u)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=this.getSpacedPoints(t);return this.createGeometry(u)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=new Fr;for(let m=0,g=t.length;m<g;m++){const E=t[m];u.vertices.push(new ot(E.x,E.y,E.z||0))}return u}}),Object.assign(Fe.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),g_.prototype=Object.create(k.prototype),v_.prototype=Object.create(k.prototype),e_.prototype=Object.create(k.prototype),Object.assign(e_.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Uf.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},hd.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(hi.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),sr.extractUrlBase(t)}}),hi.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(vi.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(Wm.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(mn.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(zn.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Yc.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},ym.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(er,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),er.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),er.ceilPowerOfTwo(t)}}),Object.assign(jo.prototype,{flattenToArrayOffset:function(t,u){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,u)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(ni.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,u){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,u)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ot).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,u,m,g,E,I){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,u,g,m,E,I)}}),Xo.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},So.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(_o.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Pr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,u){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,u)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Pr,{barycoordFromPoint:function(t,u,m,g,E){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Pr.getBarycoord(t,u,m,g,E)},normal:function(t,u,m,g){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Pr.getNormal(t,u,m,g)}}),Object.assign(De.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ou(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Nc(this,t)}}),Object.assign(Sn.prototype,{fromAttribute:function(t,u,m){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ot.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,u){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(u,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,u,m){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(bi.prototype,{fromAttribute:function(t,u,m){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Fr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(Zn.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,u){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(u,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Zn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Li.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Li.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),jh},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Qd.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ef.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Kd.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(yr.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Ns.prototype.setLens=function(t,u){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==u&&(this.filmGauge=u),this.setFocalLength(t)},Object.defineProperties(Qe.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Hr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Lr},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Lr)}}}),Object.assign(Hr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Lr:yi),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(pn.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,u){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),u&&u.isBufferAttribute||u&&u.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(u),this):this.setAttribute(t,u):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Hr(arguments[1],arguments[2])))},addDrawCall:function(t,u,m){void 0!==m&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,u)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(pn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Rn.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(gm.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(Ca.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Lr},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(Ca.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Lr:yi),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(ma.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(Of.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(zr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new or}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===A}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Jo.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(uo.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(go.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(qd.prototype,{clearTarget:function(t,u,m,g){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(u,m,g)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(qd.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?rl:Ki}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Np.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ks.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Ld.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const u=this;return(new Up).load(t,function(m){u.setBuffer(m)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),If.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Fo.prototype.updateCubeMap=function(t,u){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,u)};const W_={merge:function(t,u,m){let g;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),u.isMesh&&(u.matrixAutoUpdate&&u.updateMatrix(),g=u.matrix,u=u.geometry),t.merge(u,g,m)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};function q_(){console.error("THREE.CanvasRenderer has been removed")}function X_(){console.error("THREE.JSONLoader has been removed.")}eo.crossOrigin=void 0,eo.loadTexture=function(t,u,m,g){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const E=new Si;E.setCrossOrigin(this.crossOrigin);const I=E.load(t,m,void 0,g);return u&&(I.mapping=u),I},eo.loadTextureCube=function(t,u,m,g){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const E=new Rh;E.setCrossOrigin(this.crossOrigin);const I=E.load(t,m,void 0,g);return u&&(I.mapping=u),I},eo.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},eo.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Y_={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function J_(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:x}}))},759:(n,o,l)=>{"use strict";l.d(o,{U:()=>x}),n=l.hmd(n),function(B){"object"==typeof exports?n.exports=B():"function"==typeof define&&l.amdO?define([],B):(typeof window<"u"?window:void 0!==l.g?l.g:typeof self<"u"?self:this).opentype=B()}(function(){return function B(D,G,M){function P(ne,ue){if(!G[ne]){if(!D[ne]){if(fe)return fe(ne,!0);var me=new Error("Cannot find module '"+ne+"'");throw me.code="MODULE_NOT_FOUND",me}var ie=G[ne]={exports:{}};D[ne][0].call(ie.exports,function(W){return P(D[ne][1][W]||W)},ie,ie.exports,B,D,G,M)}return G[ne].exports}for(var fe=void 0,ye=0;ye<M.length;ye++)P(M[ye]);return P}({1:[function(B,D,G){function M(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function P(Ke,vt){this.source=Ke,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=vt,this.destLen=0,this.ltree=new M,this.dtree=new M}function fe(Ke,vt,ht,Bt){var wt,Ft;for(wt=0;ht>wt;++wt)Ke[wt]=0;for(wt=0;30-ht>wt;++wt)Ke[wt+ht]=wt/ht|0;for(Ft=Bt,wt=0;30>wt;++wt)vt[wt]=Ft,Ft+=1<<Ke[wt]}function ye(Ke,vt,ht,Bt){var wt,Ft;for(wt=0;16>wt;++wt)Ke.table[wt]=0;for(wt=0;Bt>wt;++wt)Ke.table[vt[ht+wt]]++;for(Ke.table[0]=0,Ft=0,wt=0;16>wt;++wt)qe[wt]=Ft,Ft+=Ke.table[wt];for(wt=0;Bt>wt;++wt)vt[ht+wt]&&(Ke.trans[qe[vt[ht+wt]]++]=wt)}function ne(Ke){Ke.bitcount--||(Ke.tag=Ke.source[Ke.sourceIndex++],Ke.bitcount=7);var vt=1&Ke.tag;return Ke.tag>>>=1,vt}function ue(Ke,vt,ht){if(!vt)return ht;for(;Ke.bitcount<24;)Ke.tag|=Ke.source[Ke.sourceIndex++]<<Ke.bitcount,Ke.bitcount+=8;var Bt=Ke.tag&65535>>>16-vt;return Ke.tag>>>=vt,Ke.bitcount-=vt,Bt+ht}function me(Ke,vt){for(;Ke.bitcount<24;)Ke.tag|=Ke.source[Ke.sourceIndex++]<<Ke.bitcount,Ke.bitcount+=8;var ht=0,Bt=0,wt=0,Ft=Ke.tag;do{Bt=2*Bt+(1&Ft),Ft>>>=1,++wt,ht+=vt.table[wt],Bt-=vt.table[wt]}while(Bt>=0);return Ke.tag=Ft,Ke.bitcount-=wt,vt.trans[ht+Bt]}function ie(Ke,vt,ht){var Bt,wt,Ft,Ot,on,ft;for(Bt=ue(Ke,5,257),wt=ue(Ke,5,1),Ft=ue(Ke,4,4),Ot=0;19>Ot;++Ot)Te[Ot]=0;for(Ot=0;Ft>Ot;++Ot){var An=ue(Ke,3,0);Te[Ne[Ot]]=An}for(ye(je,Te,0,19),on=0;Bt+wt>on;){var Cn=me(Ke,je);switch(Cn){case 16:var fn=Te[on-1];for(ft=ue(Ke,2,3);ft;--ft)Te[on++]=fn;break;case 17:for(ft=ue(Ke,3,3);ft;--ft)Te[on++]=0;break;case 18:for(ft=ue(Ke,7,11);ft;--ft)Te[on++]=0;break;default:Te[on++]=Cn}}ye(vt,Te,0,Bt),ye(ht,Te,Bt,wt)}function W(Ke,vt,ht){for(;;){var Bt,wt,Ft,Ot,on=me(Ke,vt);if(256===on)return A;if(256>on)Ke.dest[Ke.destLen++]=on;else for(Bt=ue(Ke,z[on-=257],Le[on]),wt=me(Ke,ht),Ot=Ft=Ke.destLen-ue(Ke,K[wt],be[wt]);Ft+Bt>Ot;++Ot)Ke.dest[Ke.destLen++]=Ke.dest[Ot]}}function Q(Ke){for(var vt,ht;Ke.bitcount>8;)Ke.sourceIndex--,Ke.bitcount-=8;if((vt=256*(vt=Ke.source[Ke.sourceIndex+1])+Ke.source[Ke.sourceIndex])!==(65535&~(256*Ke.source[Ke.sourceIndex+3]+Ke.source[Ke.sourceIndex+2])))return R;for(Ke.sourceIndex+=4,ht=vt;ht;--ht)Ke.dest[Ke.destLen++]=Ke.source[Ke.sourceIndex++];return Ke.bitcount=0,A}var A=0,R=-3,X=new M,he=new M,z=new Uint8Array(30),Le=new Uint16Array(30),K=new Uint8Array(30),be=new Uint16Array(30),Ne=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),je=new M,Te=new Uint8Array(320),qe=new Uint16Array(16);(function(Ke,vt){var ht;for(ht=0;7>ht;++ht)Ke.table[ht]=0;for(Ke.table[7]=24,Ke.table[8]=152,Ke.table[9]=112,ht=0;24>ht;++ht)Ke.trans[ht]=256+ht;for(ht=0;144>ht;++ht)Ke.trans[24+ht]=ht;for(ht=0;8>ht;++ht)Ke.trans[168+ht]=280+ht;for(ht=0;112>ht;++ht)Ke.trans[176+ht]=144+ht;for(ht=0;5>ht;++ht)vt.table[ht]=0;for(vt.table[5]=32,ht=0;32>ht;++ht)vt.trans[ht]=ht})(X,he),fe(z,Le,4,3),fe(K,be,2,1),z[28]=0,Le[28]=258,D.exports=function(Ke,vt){var ht,Bt,wt=new P(Ke,vt);do{switch(ht=ne(wt),ue(wt,2,0)){case 0:Bt=Q(wt);break;case 1:Bt=W(wt,X,he);break;case 2:ie(wt,wt.ltree,wt.dtree),Bt=W(wt,wt.ltree,wt.dtree);break;default:Bt=R}if(Bt!==A)throw new Error("Data error")}while(!ht);return wt.destLen<wt.dest.length?"function"==typeof wt.dest.slice?wt.dest.slice(0,wt.destLen):wt.dest.subarray(0,wt.destLen):wt.dest}},{}],2:[function(B,D,G){G.fail=function(M){throw new Error(M)},G.argument=function(M,P){M||G.fail(P)},G.assert=G.argument},{}],3:[function(B,D,G){G.line=function(M,P,fe,ye,ne){M.beginPath(),M.moveTo(P,fe),M.lineTo(ye,ne),M.stroke()}},{}],4:[function(B,D,G){function M(ne){this.font=ne}function P(ne){this.cmap=ne}function fe(ne,ue){this.encoding=ne,this.charset=ue}function ye(ne){var ue;switch(ne.version){case 1:this.names=G.standardNames.slice();break;case 2:for(this.names=new Array(ne.numberOfGlyphs),ue=0;ue<ne.numberOfGlyphs;ue++)this.names[ue]=ne.glyphNameIndex[ue]<G.standardNames.length?G.standardNames[ne.glyphNameIndex[ue]]:ne.names[ne.glyphNameIndex[ue]-G.standardNames.length];break;case 2.5:for(this.names=new Array(ne.numberOfGlyphs),ue=0;ue<ne.numberOfGlyphs;ue++)this.names[ue]=G.standardNames[ue+ne.glyphNameIndex[ue]];break;case 3:this.names=[]}}M.prototype.charToGlyphIndex=function(ne){var ue=ne.charCodeAt(0),me=this.font.glyphs;if(!me)return null;for(var ie=0;ie<me.length;ie+=1)for(var W=me.get(ie),Q=0;Q<W.unicodes.length;Q+=1)if(W.unicodes[Q]===ue)return ie},P.prototype.charToGlyphIndex=function(ne){return this.cmap.glyphIndexMap[ne.charCodeAt(0)]||0},fe.prototype.charToGlyphIndex=function(ne){var ue=ne.charCodeAt(0);return this.charset.indexOf(this.encoding[ue])},ye.prototype.nameToGlyphIndex=function(ne){return this.names.indexOf(ne)},ye.prototype.glyphIndexToName=function(ne){return this.names[ne]},G.cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],G.cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],G.cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],G.standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"],G.DefaultEncoding=M,G.CmapEncoding=P,G.CffEncoding=fe,G.GlyphNames=ye,G.addGlyphNames=function(ne){for(var ue,me=ne.tables.cmap.glyphIndexMap,ie=Object.keys(me),W=0;W<ie.length;W+=1){var Q=ie[W];(ue=ne.glyphs.get(me[Q])).addUnicode(parseInt(Q))}for(W=0;W<ne.glyphs.length;W+=1)ue=ne.glyphs.get(W),ne.cffEncoding?ue.name=ne.cffEncoding.charset[W]:ne.glyphNames.names&&(ue.name=ne.glyphNames.glyphIndexToName(W))}},{}],5:[function(B,D,G){function M(ie){(ie=ie||{}).empty||(me.checkArgument(ie.familyName,"When creating a new Font object, familyName is required."),me.checkArgument(ie.styleName,"When creating a new Font object, styleName is required."),me.checkArgument(ie.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),me.checkArgument(ie.ascender,"When creating a new Font object, ascender is required."),me.checkArgument(ie.descender,"When creating a new Font object, descender is required."),me.checkArgument(ie.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:ie.familyName||" "},fontSubfamily:{en:ie.styleName||" "},fullName:{en:ie.fullName||ie.familyName+" "+ie.styleName},postScriptName:{en:ie.postScriptName||ie.familyName+ie.styleName},designer:{en:ie.designer||" "},designerURL:{en:ie.designerURL||" "},manufacturer:{en:ie.manufacturer||" "},manufacturerURL:{en:ie.manufacturerURL||" "},license:{en:ie.license||" "},licenseURL:{en:ie.licenseURL||" "},version:{en:ie.version||"Version 0.1"},description:{en:ie.description||" "},copyright:{en:ie.copyright||" "},trademark:{en:ie.trademark||" "}},this.unitsPerEm=ie.unitsPerEm||1e3,this.ascender=ie.ascender,this.descender=ie.descender,this.createdTimestamp=ie.createdTimestamp,this.tables={os2:{usWeightClass:ie.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:ie.widthClass||this.usWidthClasses.MEDIUM,fsSelection:ie.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new ne.GlyphSet(this,ie.glyphs||[]),this.encoding=new ye.DefaultEncoding(this),this.substitution=new ue(this),this.tables=this.tables||{}}var P=B("./path"),fe=B("./tables/sfnt"),ye=B("./encoding"),ne=B("./glyphset"),ue=B("./substitution"),me=B("./util");M.prototype.hasChar=function(ie){return null!==this.encoding.charToGlyphIndex(ie)},M.prototype.charToGlyphIndex=function(ie){return this.encoding.charToGlyphIndex(ie)},M.prototype.charToGlyph=function(ie){var W=this.charToGlyphIndex(ie),Q=this.glyphs.get(W);return Q||(Q=this.glyphs.get(0)),Q},M.prototype.stringToGlyphs=function(ie){for(var W=[],Q=0;Q<ie.length;Q+=1)W.push(this.charToGlyph(ie[Q]));return W},M.prototype.nameToGlyphIndex=function(ie){return this.glyphNames.nameToGlyphIndex(ie)},M.prototype.nameToGlyph=function(ie){var W=this.nametoGlyphIndex(ie),Q=this.glyphs.get(W);return Q||(Q=this.glyphs.get(0)),Q},M.prototype.glyphIndexToName=function(ie){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(ie):""},M.prototype.getKerningValue=function(ie,W){ie=ie.index||ie,W=W.index||W;var Q=this.getGposKerningValue;return Q?Q(ie,W):this.kerningPairs[ie+","+W]||0},M.prototype.forEachGlyph=function(ie,W,Q,A,R,X){W=void 0!==W?W:0,Q=void 0!==Q?Q:0;for(var he=void 0===(R=R||{}).kerning||R.kerning,z=1/this.unitsPerEm*(A=void 0!==A?A:72),Le=this.stringToGlyphs(ie),K=0;K<Le.length;K+=1){var be=Le[K];X(be,W,Q,A,R),be.advanceWidth&&(W+=be.advanceWidth*z),he&&K<Le.length-1&&(W+=this.getKerningValue(be,Le[K+1])*z)}},M.prototype.getPath=function(ie,W,Q,A,R){var X=new P.Path;return this.forEachGlyph(ie,W,Q,A,R,function(he,z,Le,K){var be=he.getPath(z,Le,K);X.extend(be)}),X},M.prototype.getPaths=function(ie,W,Q,A,R){var X=[];return this.forEachGlyph(ie,W,Q,A,R,function(he,z,Le,K){var be=he.getPath(z,Le,K);X.push(be)}),X},M.prototype.draw=function(ie,W,Q,A,R,X){this.getPath(W,Q,A,R,X).draw(ie)},M.prototype.drawPoints=function(ie,W,Q,A,R,X){this.forEachGlyph(W,Q,A,R,X,function(he,z,Le,K){he.drawPoints(ie,z,Le,K)})},M.prototype.drawMetrics=function(ie,W,Q,A,R,X){this.forEachGlyph(W,Q,A,R,X,function(he,z,Le,K){he.drawMetrics(ie,z,Le,K)})},M.prototype.getEnglishName=function(ie){var W=this.names[ie];return W?W.en:void 0},M.prototype.validate=function(){function ie(R,X){R||Q.push(X)}function W(R){var X=A.getEnglishName(R);ie(X&&X.trim().length>0,"No English "+R+" specified.")}var Q=[],A=this;W("fontFamily"),W("weightName"),W("manufacturer"),W("copyright"),W("version"),ie(this.unitsPerEm>0,"No unitsPerEm specified.")},M.prototype.toTables=function(){return fe.fontToTable(this)},M.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},M.prototype.toArrayBuffer=function(){for(var ie=this.toTables().encode(),W=new ArrayBuffer(ie.length),Q=new Uint8Array(W),A=0;A<ie.length;A++)Q[A]=ie[A];return W},M.prototype.download=function(){var ie=this.getEnglishName("fontFamily"),W=this.getEnglishName("fontSubfamily"),Q=ie.replace(/\s/g,"")+"-"+W+".otf",A=this.toArrayBuffer();if(me.isBrowser())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,A.byteLength,function(he){he.root.getFile(Q,{create:!0},function(z){z.createWriter(function(Le){var K=new DataView(A),be=new Blob([K],{type:"font/opentype"});Le.write(be),Le.addEventListener("writeend",function(){location.href=z.toURL()},!1)})})},function(he){throw new Error(he.name+": "+he.message)});else{var R=B("fs"),X=me.arrayBufferToNodeBuffer(A);R.writeFileSync(Q,X)}},M.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},M.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},M.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900},G.Font=M},{"./encoding":4,"./glyphset":7,"./path":11,"./substitution":12,"./tables/sfnt":31,"./util":33,fs:void 0}],6:[function(B,D,G){function M(ne){this.bindConstructorValues(ne)}var P=B("./check"),fe=B("./draw"),ye=B("./path");M.prototype.bindConstructorValues=function(ne){var me;this.index=ne.index||0,this.name=ne.name||null,this.unicode=ne.unicode||void 0,this.unicodes=ne.unicodes||void 0!==ne.unicode?[ne.unicode]:[],ne.xMin&&(this.xMin=ne.xMin),ne.yMin&&(this.yMin=ne.yMin),ne.xMax&&(this.xMax=ne.xMax),ne.yMax&&(this.yMax=ne.yMax),ne.advanceWidth&&(this.advanceWidth=ne.advanceWidth),Object.defineProperty(this,"path",(me=ne.path||{commands:[]},{configurable:!0,get:function(){return"function"==typeof me&&(me=me()),me},set:function(ie){me=ie}}))},M.prototype.addUnicode=function(ne){0===this.unicodes.length&&(this.unicode=ne),this.unicodes.push(ne)},M.prototype.getPath=function(ne,ue,me,ie){ne=void 0!==ne?ne:0,ue=void 0!==ue?ue:0;for(var W=1/this.path.unitsPerEm*(me=void 0!==me?me:72),Q=(ie=void 0!==ie?ie:{xScale:1,yScale:1}).xScale*W,A=ie.yScale*W,R=new ye.Path,X=this.path.commands,he=0;he<X.length;he+=1){var z=X[he];"M"===z.type?R.moveTo(ne+z.x*Q,ue+-z.y*A):"L"===z.type?R.lineTo(ne+z.x*Q,ue+-z.y*A):"Q"===z.type?R.quadraticCurveTo(ne+z.x1*Q,ue+-z.y1*A,ne+z.x*Q,ue+-z.y*A):"C"===z.type?R.curveTo(ne+z.x1*Q,ue+-z.y1*A,ne+z.x2*Q,ue+-z.y2*A,ne+z.x*Q,ue+-z.y*A):"Z"===z.type&&R.closePath()}return R},M.prototype.getContours=function(){if(void 0===this.points)return[];for(var ne=[],ue=[],me=0;me<this.points.length;me+=1){var ie=this.points[me];ue.push(ie),ie.lastPointOfContour&&(ne.push(ue),ue=[])}return P.argument(0===ue.length,"There are still points left in the current contour."),ne},M.prototype.getMetrics=function(){for(var ne=this.path.commands,ue=[],me=[],ie=0;ie<ne.length;ie+=1){var W=ne[ie];"Z"!==W.type&&(ue.push(W.x),me.push(W.y)),("Q"===W.type||"C"===W.type)&&(ue.push(W.x1),me.push(W.y1)),"C"===W.type&&(ue.push(W.x2),me.push(W.y2))}var Q={xMin:Math.min.apply(null,ue),yMin:Math.min.apply(null,me),xMax:Math.max.apply(null,ue),yMax:Math.max.apply(null,me),leftSideBearing:this.leftSideBearing};return isFinite(Q.xMin)||(Q.xMin=0),isFinite(Q.xMax)||(Q.xMax=this.advanceWidth),isFinite(Q.yMin)||(Q.yMin=0),isFinite(Q.yMax)||(Q.yMax=0),Q.rightSideBearing=this.advanceWidth-Q.leftSideBearing-(Q.xMax-Q.xMin),Q},M.prototype.draw=function(ne,ue,me,ie,W){this.getPath(ue,me,ie,W).draw(ne)},M.prototype.drawPoints=function(ne,ue,me,ie){function W(Le,K,be,Ne){var je=2*Math.PI;ne.beginPath();for(var Te=0;Te<Le.length;Te+=1)ne.moveTo(K+Le[Te].x*Ne,be+Le[Te].y*Ne),ne.arc(K+Le[Te].x*Ne,be+Le[Te].y*Ne,2,0,je,!1);ne.closePath(),ne.fill()}ue=void 0!==ue?ue:0,me=void 0!==me?me:0;for(var Q=1/this.path.unitsPerEm*(ie=void 0!==ie?ie:24),A=[],R=[],X=this.path,he=0;he<X.commands.length;he+=1){var z=X.commands[he];void 0!==z.x&&A.push({x:z.x,y:-z.y}),void 0!==z.x1&&R.push({x:z.x1,y:-z.y1}),void 0!==z.x2&&R.push({x:z.x2,y:-z.y2})}ne.fillStyle="blue",W(A,ue,me,Q),ne.fillStyle="red",W(R,ue,me,Q)},M.prototype.drawMetrics=function(ne,ue,me,ie){var W;ue=void 0!==ue?ue:0,me=void 0!==me?me:0,W=1/this.path.unitsPerEm*(ie=void 0!==ie?ie:24),ne.lineWidth=1,ne.strokeStyle="black",fe.line(ne,ue,-1e4,ue,1e4),fe.line(ne,-1e4,me,1e4,me);var Q=this.xMin||0,A=this.yMin||0,R=this.xMax||0,X=this.yMax||0,he=this.advanceWidth||0;ne.strokeStyle="blue",fe.line(ne,ue+Q*W,-1e4,ue+Q*W,1e4),fe.line(ne,ue+R*W,-1e4,ue+R*W,1e4),fe.line(ne,-1e4,me+-A*W,1e4,me+-A*W),fe.line(ne,-1e4,me+-X*W,1e4,me+-X*W),ne.strokeStyle="green",fe.line(ne,ue+he*W,-1e4,ue+he*W,1e4)},G.Glyph=M},{"./check":2,"./draw":3,"./path":11}],7:[function(B,D,G){function M(ye,ne,ue){Object.defineProperty(ye,ne,{get:function(){return ye[ue]},set:function(me){ye[ue]=me},enumerable:!0,configurable:!0})}function P(ye,ne){if(this.font=ye,this.glyphs={},Array.isArray(ne))for(var ue=0;ue<ne.length;ue++)this.glyphs[ue]=ne[ue];this.length=ne&&ne.length||0}var fe=B("./glyph");P.prototype.get=function(ye){return"function"==typeof this.glyphs[ye]&&(this.glyphs[ye]=this.glyphs[ye]()),this.glyphs[ye]},P.prototype.push=function(ye,ne){this.glyphs[ye]=ne,this.length++},G.GlyphSet=P,G.glyphLoader=function(ye,ne){return new fe.Glyph({index:ne,font:ye})},G.ttfGlyphLoader=function(ye,ne,ue,me,ie,W){return function(){var Q=new fe.Glyph({index:ne,font:ye});return Q.path=function(){ue(Q,me,ie);var A=W(ye.glyphs,Q);return A.unitsPerEm=ye.unitsPerEm,A},M(Q,"xMin","_xMin"),M(Q,"xMax","_xMax"),M(Q,"yMin","_yMin"),M(Q,"yMax","_yMax"),Q}},G.cffGlyphLoader=function(ye,ne,ue,me){return function(){var ie=new fe.Glyph({index:ne,font:ye});return ie.path=function(){var W=ue(ye,ie,me);return W.unitsPerEm=ye.unitsPerEm,W},ie}}},{"./glyph":6}],8:[function(B,D,G){function M(ye,ne){for(var ue=0,me=ye.length-1;me>=ue;){var ie=ue+me>>>1,W=ye[ie].tag;if(W===ne)return ie;ne>W?ue=ie+1:me=ie-1}return-ue-1}var P=B("./check");D.exports={searchTag:M,binSearch:function(ye,ne){for(var ue=0,me=ye.length-1;me>=ue;){var ie=ue+me>>>1,W=ye[ie];if(W===ne)return ie;ne>W?ue=ie+1:me=ie-1}return-ue-1},getScriptNames:function(){var ye=this.getGsubTable();return ye?ye.scripts.map(function(ne){return ne.tag}):[]},getScriptTable:function(ye,ne){var ue=this.getGsubTable(ne);if(ue){var me=ue.scripts,ie=M(ue.scripts,ye);if(ie>=0)return me[ie].script;var W={tag:ye,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return me.splice(-1-ie,0,W.script),W}},getLangSysTable:function(ye,ne,ue){var me=this.getScriptTable(ye,ue);if(me){if("DFLT"===ne)return me.defaultLangSys;var ie=M(me.langSysRecords,ne);if(ie>=0)return me.langSysRecords[ie].langSys;if(ue){var W={tag:ne,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return me.langSysRecords.splice(-1-ie,0,W),W.langSys}}},getFeatureTable:function(ye,ne,ue,me){var ie=this.getLangSysTable(ye,ne,me);if(ie){for(var W,Q=ie.featureIndexes,A=this.font.tables.gsub.features,R=0;R<Q.length;R++)if((W=A[Q[R]]).tag===ue)return W.feature;if(me){var X=A.length;return P.assert(0===X||ue>=A[X-1].tag,"Features must be added in alphabetical order."),A.push(W={tag:ue,feature:{params:0,lookupListIndexes:[]}}),Q.push(X),W.feature}}},getLookupTable:function(ye,ne,ue,me,ie){var W=this.getFeatureTable(ye,ne,ue,ie);if(W){for(var Q,A=W.lookupListIndexes,R=this.font.tables.gsub.lookups,X=0;X<A.length;X++)if((Q=R[A[X]]).lookupType===me)return Q;if(ie){var he=R.length;return R.push(Q={lookupType:me,lookupFlag:0,subtables:[],markFilteringSet:void 0}),A.push(he),Q}}},expandCoverage:function(ye){if(1===ye.format)return ye.glyphs;for(var ne=[],ue=ye.ranges,me=0;ue>me;me++)for(var ie=ue[me],Q=ie.end,A=ie.start;Q>=A;A++)ne.push(A);return ne}}},{"./check":2}],9:[function(B,D,G){function M(on,ft){B("fs").readFile(on,function(An,Cn){return An?ft(An.message):void ft(null,R.nodeBufferToArrayBuffer(Cn))})}function P(on,ft){var An=new XMLHttpRequest;An.open("get",on,!0),An.responseType="arraybuffer",An.onload=function(){return 200!==An.status?ft("Font could not be loaded: "+An.statusText):ft(null,An.response)},An.send()}function fe(on,ft){for(var An=[],Cn=12,fn=0;ft>fn;fn+=1){var On=Q.getTag(on,Cn),$n=Q.getULong(on,Cn+4),_n=Q.getULong(on,Cn+8),ar=Q.getULong(on,Cn+12);An.push({tag:On,checksum:$n,offset:_n,length:ar,compression:!1}),Cn+=16}return An}function ye(on,ft){if("WOFF"===ft.compression){var An=new Uint8Array(on.buffer,ft.offset+2,ft.compressedLength-2),Cn=new Uint8Array(ft.originalLength);if(ue(An,Cn),Cn.byteLength!==ft.originalLength)throw new Error("Decompression error: "+ft.tag+" decompressed length doesn't match recorded length");return{data:new DataView(Cn.buffer,0),offset:0}}return{data:on,offset:ft.offset}}function ne(on){var ft,An,Cn,fn=new ie.Font({empty:!0}),On=new DataView(on,0),$n=[],_n=Q.getTag(On,0);if("\0\x01\0\0"===_n)fn.outlinesFormat="truetype",$n=fe(On,Cn=Q.getUShort(On,4));else if("OTTO"===_n)fn.outlinesFormat="cff",$n=fe(On,Cn=Q.getUShort(On,4));else{if("wOFF"!==_n)throw new Error("Unsupported OpenType signature "+_n);var ar=Q.getTag(On,4);if("\0\x01\0\0"===ar)fn.outlinesFormat="truetype";else{if("OTTO"!==ar)throw new Error("Unsupported OpenType flavor "+_n);fn.outlinesFormat="cff"}$n=function(Iu,fs){for(var Vs=[],ai=44,Fc=0;fs>Fc;Fc+=1){var Ka=Q.getTag(Iu,ai),Gp=Q.getULong(Iu,ai+4),oa=Q.getULong(Iu,ai+8),zl=Q.getULong(Iu,ai+12);Vs.push({tag:Ka,offset:Gp,compression:zl>oa&&"WOFF",compressedLength:oa,originalLength:zl}),ai+=20}return Vs}(On,Cn=Q.getUShort(On,12))}for(var nr,lr,rr,ti,Zr,pi,tr,mr,mi,xo,Nr=0;Cn>Nr;Nr+=1){var Qr,Vr=$n[Nr];switch(Vr.tag){case"cmap":Qr=ye(On,Vr),fn.tables.cmap=X.parse(Qr.data,Qr.offset),fn.encoding=new me.CmapEncoding(fn.tables.cmap);break;case"fvar":lr=Vr;break;case"head":Qr=ye(On,Vr),fn.tables.head=Ne.parse(Qr.data,Qr.offset),fn.unitsPerEm=fn.tables.head.unitsPerEm,ft=fn.tables.head.indexToLocFormat;break;case"hhea":Qr=ye(On,Vr),fn.tables.hhea=je.parse(Qr.data,Qr.offset),fn.ascender=fn.tables.hhea.ascender,fn.descender=fn.tables.hhea.descender,fn.numberOfHMetrics=fn.tables.hhea.numberOfHMetrics;break;case"hmtx":pi=Vr;break;case"ltag":Qr=ye(On,Vr),An=Ke.parse(Qr.data,Qr.offset);break;case"maxp":Qr=ye(On,Vr),fn.tables.maxp=ht.parse(Qr.data,Qr.offset),fn.numGlyphs=fn.tables.maxp.numGlyphs;break;case"name":mi=Vr;break;case"OS/2":Qr=ye(On,Vr),fn.tables.os2=wt.parse(Qr.data,Qr.offset);break;case"post":Qr=ye(On,Vr),fn.tables.post=Ft.parse(Qr.data,Qr.offset),fn.glyphNames=new me.GlyphNames(fn.tables.post);break;case"glyf":rr=Vr;break;case"loca":mr=Vr;break;case"CFF ":nr=Vr;break;case"kern":tr=Vr;break;case"GPOS":ti=Vr;break;case"GSUB":Zr=Vr;break;case"meta":xo=Vr}}var gi=ye(On,mi);if(fn.tables.name=Bt.parse(gi.data,gi.offset,An),fn.names=fn.tables.name,rr&&mr){var Ti=0===ft,$o=ye(On,mr),Hs=vt.parse($o.data,$o.offset,fn.numGlyphs,Ti),ia=ye(On,rr);fn.glyphs=Le.parse(ia.data,ia.offset,Hs,fn)}else{if(!nr)throw new Error("Font doesn't contain TrueType or CFF outlines.");var Oi=ye(On,nr);he.parse(Oi.data,Oi.offset,fn)}var Co=ye(On,pi);if(Te.parse(Co.data,Co.offset,fn.numberOfHMetrics,fn.numGlyphs,fn.glyphs),me.addGlyphNames(fn),tr){var wo=ye(On,tr);fn.kerningPairs=qe.parse(wo.data,wo.offset)}else fn.kerningPairs={};if(ti){var Yr=ye(On,ti);K.parse(Yr.data,Yr.offset,fn)}if(Zr){var os=ye(On,Zr);fn.tables.gsub=be.parse(os.data,os.offset)}if(lr){var Or=ye(On,lr);fn.tables.fvar=z.parse(Or.data,Or.offset,fn.names)}if(xo){var Oa=ye(On,xo);fn.tables.meta=Ot.parse(Oa.data,Oa.offset),fn.metas=fn.tables.meta}return fn}var ue=B("tiny-inflate"),me=B("./encoding"),ie=B("./font"),W=B("./glyph"),Q=B("./parse"),A=B("./path"),R=B("./util"),X=B("./tables/cmap"),he=B("./tables/cff"),z=B("./tables/fvar"),Le=B("./tables/glyf"),K=B("./tables/gpos"),be=B("./tables/gsub"),Ne=B("./tables/head"),je=B("./tables/hhea"),Te=B("./tables/hmtx"),qe=B("./tables/kern"),Ke=B("./tables/ltag"),vt=B("./tables/loca"),ht=B("./tables/maxp"),Bt=B("./tables/name"),wt=B("./tables/os2"),Ft=B("./tables/post"),Ot=B("./tables/meta");G._parse=Q,G.Font=ie.Font,G.Glyph=W.Glyph,G.Path=A.Path,G.parse=ne,G.load=function(on,ft){(typeof window>"u"?M:P)(on,function(An,Cn){if(An)return ft(An);var fn;try{fn=ne(Cn)}catch(On){return ft(On,null)}return ft(null,fn)})},G.loadSync=function(on){var ft=B("fs").readFileSync(on);return ne(R.nodeBufferToArrayBuffer(ft))}},{"./encoding":4,"./font":5,"./glyph":6,"./parse":10,"./path":11,"./tables/cff":14,"./tables/cmap":15,"./tables/fvar":16,"./tables/glyf":17,"./tables/gpos":18,"./tables/gsub":19,"./tables/head":20,"./tables/hhea":21,"./tables/hmtx":22,"./tables/kern":23,"./tables/loca":24,"./tables/ltag":25,"./tables/maxp":26,"./tables/meta":27,"./tables/name":28,"./tables/os2":29,"./tables/post":30,"./util":33,fs:void 0,"tiny-inflate":1}],10:[function(B,D,G){function M(ue,me){return ue.getUint16(me,!1)}function P(ue,me){this.data=ue,this.offset=me,this.relativeOffset=0}var fe=B("./check");G.getByte=function(ue,me){return ue.getUint8(me)},G.getCard8=G.getByte,G.getUShort=G.getCard16=M,G.getShort=function(ue,me){return ue.getInt16(me,!1)},G.getULong=function(ue,me){return ue.getUint32(me,!1)},G.getFixed=function(ue,me){return ue.getInt16(me,!1)+ue.getUint16(me+2,!1)/65535},G.getTag=function(ue,me){for(var ie="",W=me;me+4>W;W+=1)ie+=String.fromCharCode(ue.getInt8(W));return ie},G.getOffset=function(ue,me,ie){for(var W=0,Q=0;ie>Q;Q+=1)W<<=8,W+=ue.getUint8(me+Q);return W},G.getBytes=function(ue,me,ie){for(var W=[],Q=me;ie>Q;Q+=1)W.push(ue.getUint8(Q));return W},G.bytesToString=function(ue){for(var me="",ie=0;ie<ue.length;ie+=1)me+=String.fromCharCode(ue[ie]);return me};var ye={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};P.prototype.parseByte=function(){var ue=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,ue},P.prototype.parseChar=function(){var ue=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,ue},P.prototype.parseCard8=P.prototype.parseByte,P.prototype.parseCard16=P.prototype.parseUShort=function(){var ue=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,ue},P.prototype.parseSID=P.prototype.parseUShort,P.prototype.parseOffset16=P.prototype.parseUShort,P.prototype.parseShort=function(){var ue=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,ue},P.prototype.parseF2Dot14=function(){var ue=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,ue},P.prototype.parseULong=function(){var ue=G.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,ue},P.prototype.parseFixed=function(){var ue=G.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,ue},P.prototype.parseString=function(ue){var me=this.data,ie=this.offset+this.relativeOffset,W="";this.relativeOffset+=ue;for(var Q=0;ue>Q;Q++)W+=String.fromCharCode(me.getUint8(ie+Q));return W},P.prototype.parseTag=function(){return this.parseString(4)},P.prototype.parseLongDateTime=function(){var ue=G.getULong(this.data,this.offset+this.relativeOffset+4);return ue-=2082844800,this.relativeOffset+=8,ue},P.prototype.parseVersion=function(){var ue=M(this.data,this.offset+this.relativeOffset),me=M(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,ue+me/4096/10},P.prototype.skip=function(ue,me){void 0===me&&(me=1),this.relativeOffset+=ye[ue]*me},P.prototype.parseOffset16List=P.prototype.parseUShortList=function(ue){void 0===ue&&(ue=this.parseUShort());for(var me=new Array(ue),ie=this.data,W=this.offset+this.relativeOffset,Q=0;ue>Q;Q++)me[Q]=ie.getUint16(W),W+=2;return this.relativeOffset+=2*ue,me},P.prototype.parseList=function(ue,me){me||(me=ue,ue=this.parseUShort());for(var ie=new Array(ue),W=0;ue>W;W++)ie[W]=me.call(this);return ie},P.prototype.parseRecordList=function(ue,me){me||(me=ue,ue=this.parseUShort());for(var ie=new Array(ue),W=Object.keys(me),Q=0;ue>Q;Q++){for(var A={},R=0;R<W.length;R++){var X=W[R];A[X]=me[X].call(this)}ie[Q]=A}return ie},P.prototype.parseStruct=function(ue){if("function"==typeof ue)return ue.call(this);for(var me=Object.keys(ue),ie={},W=0;W<me.length;W++){var Q=me[W];ie[Q]=ue[Q].call(this)}return ie},P.prototype.parsePointer=function(ue){var me=this.parseOffset16();return me>0?new P(this.data,this.offset+me).parseStruct(ue):void 0},P.prototype.parseListOfLists=function(ue){for(var me=this.parseOffset16List(),ie=me.length,W=this.relativeOffset,Q=new Array(ie),A=0;ie>A;A++){var R=me[A];if(0!==R)if(this.relativeOffset=R,ue){for(var X=this.parseOffset16List(),he=new Array(X.length),z=0;z<X.length;z++)this.relativeOffset=R+X[z],he[z]=ue.call(this);Q[A]=he}else Q[A]=this.parseUShortList();else Q[A]=void 0}return this.relativeOffset=W,Q},P.prototype.parseCoverage=function(){var ue=this.offset+this.relativeOffset,me=this.parseUShort(),ie=this.parseUShort();if(1===me)return{format:1,glyphs:this.parseUShortList(ie)};if(2===me){for(var W=new Array(ie),Q=0;ie>Q;Q++)W[Q]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:W}}fe.assert(!1,"0x"+ue.toString(16)+": Coverage format must be 1 or 2.")},P.prototype.parseClassDef=function(){var ue=this.offset+this.relativeOffset,me=this.parseUShort();return 1===me?{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()}:2===me?{format:2,ranges:this.parseRecordList({start:P.uShort,end:P.uShort,classId:P.uShort})}:void fe.assert(!1,"0x"+ue.toString(16)+": ClassDef format must be 1 or 2.")},P.list=function(ue,me){return function(){return this.parseList(ue,me)}},P.recordList=function(ue,me){return function(){return this.parseRecordList(ue,me)}},P.pointer=function(ue){return function(){return this.parsePointer(ue)}},P.tag=P.prototype.parseTag,P.byte=P.prototype.parseByte,P.uShort=P.offset16=P.prototype.parseUShort,P.uShortList=P.prototype.parseUShortList,P.struct=P.prototype.parseStruct,P.coverage=P.prototype.parseCoverage,P.classDef=P.prototype.parseClassDef;var ne={reserved:P.uShort,reqFeatureIndex:P.uShort,featureIndexes:P.uShortList};P.prototype.parseScriptList=function(){return this.parsePointer(P.recordList({tag:P.tag,script:P.pointer({defaultLangSys:P.pointer(ne),langSysRecords:P.recordList({tag:P.tag,langSys:P.pointer(ne)})})}))},P.prototype.parseFeatureList=function(){return this.parsePointer(P.recordList({tag:P.tag,feature:P.pointer({featureParams:P.offset16,lookupListIndexes:P.uShortList})}))},P.prototype.parseLookupList=function(ue){return this.parsePointer(P.list(P.pointer(function(){var me=this.parseUShort();fe.argument(me>=1&&8>=me,"GSUB lookup type "+me+" unknown.");var ie=this.parseUShort(),W=16&ie;return{lookupType:me,lookupFlag:ie,subtables:this.parseList(P.pointer(ue[me])),markFilteringSet:W?this.parseUShort():void 0}})))},G.Parser=P},{"./check":2}],11:[function(B,D,G){function M(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}M.prototype.moveTo=function(P,fe){this.commands.push({type:"M",x:P,y:fe})},M.prototype.lineTo=function(P,fe){this.commands.push({type:"L",x:P,y:fe})},M.prototype.curveTo=M.prototype.bezierCurveTo=function(P,fe,ye,ne,ue,me){this.commands.push({type:"C",x1:P,y1:fe,x2:ye,y2:ne,x:ue,y:me})},M.prototype.quadTo=M.prototype.quadraticCurveTo=function(P,fe,ye,ne){this.commands.push({type:"Q",x1:P,y1:fe,x:ye,y:ne})},M.prototype.close=M.prototype.closePath=function(){this.commands.push({type:"Z"})},M.prototype.extend=function(P){P.commands&&(P=P.commands),Array.prototype.push.apply(this.commands,P)},M.prototype.draw=function(P){P.beginPath();for(var fe=0;fe<this.commands.length;fe+=1){var ye=this.commands[fe];"M"===ye.type?P.moveTo(ye.x,ye.y):"L"===ye.type?P.lineTo(ye.x,ye.y):"C"===ye.type?P.bezierCurveTo(ye.x1,ye.y1,ye.x2,ye.y2,ye.x,ye.y):"Q"===ye.type?P.quadraticCurveTo(ye.x1,ye.y1,ye.x,ye.y):"Z"===ye.type&&P.closePath()}this.fill&&(P.fillStyle=this.fill,P.fill()),this.stroke&&(P.strokeStyle=this.stroke,P.lineWidth=this.strokeWidth,P.stroke())},M.prototype.toPathData=function(P){function fe(ie){return Math.round(ie)===ie?""+Math.round(ie):ie.toFixed(P)}function ye(){for(var ie="",W=0;W<arguments.length;W+=1){var Q=arguments[W];Q>=0&&W>0&&(ie+=" "),ie+=fe(Q)}return ie}P=void 0!==P?P:2;for(var ne="",ue=0;ue<this.commands.length;ue+=1){var me=this.commands[ue];"M"===me.type?ne+="M"+ye(me.x,me.y):"L"===me.type?ne+="L"+ye(me.x,me.y):"C"===me.type?ne+="C"+ye(me.x1,me.y1,me.x2,me.y2,me.x,me.y):"Q"===me.type?ne+="Q"+ye(me.x1,me.y1,me.x,me.y):"Z"===me.type&&(ne+="Z")}return ne},M.prototype.toSVG=function(P){var fe='<path d="';return fe+=this.toPathData(P),fe+='"',this.fill&&"black"!==this.fill&&(fe+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(fe+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),fe+"/>"},G.Path=M},{}],12:[function(B,D,G){function M(ue,me){var ie=ue.length;if(ie!==me.length)return!1;for(var W=0;ie>W;W++)if(ue[W]!==me[W])return!1;return!0}function P(ue,me,ie){for(var W=ue.subtables,Q=0;Q<W.length;Q++){var A=W[Q];if(A.substFormat===me)return A}return ie?(W.push(ie),ie):void 0}var fe=B("./check"),ye=B("./layout"),ne=function(ue){this.font=ue};(ne.prototype=ye).getGsubTable=function(ue){var me=this.font.tables.gsub;return!me&&ue&&(this.font.tables.gsub=me={version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}),me},ne.prototype.getSingle=function(ue,me,ie){var W=[],Q=this.getLookupTable(me,ie,ue,1);if(!Q)return W;for(var A=Q.subtables,R=0;R<A.length;R++){var X,he=A[R],z=this.expandCoverage(he.coverage);if(1===he.substFormat){var Le=he.deltaGlyphId;for(X=0;X<z.length;X++){var K=z[X];W.push({sub:K,by:K+Le})}}else{var be=he.substitute;for(X=0;X<z.length;X++)W.push({sub:z[X],by:be[X]})}}return W},ne.prototype.getAlternates=function(ue,me,ie){var W=[],Q=this.getLookupTable(me,ie,ue,3);if(!Q)return W;for(var A=Q.subtables,R=0;R<A.length;R++)for(var X=A[R],he=this.expandCoverage(X.coverage),z=X.alternateSets,Le=0;Le<he.length;Le++)W.push({sub:he[Le],by:z[Le]});return W},ne.prototype.getLigatures=function(ue,me,ie){var W=[],Q=this.getLookupTable(me,ie,ue,4);if(!Q)return[];for(var A=Q.subtables,R=0;R<A.length;R++)for(var X=A[R],he=this.expandCoverage(X.coverage),z=X.ligatureSets,Le=0;Le<he.length;Le++)for(var K=he[Le],be=z[Le],Ne=0;Ne<be.length;Ne++){var je=be[Ne];W.push({sub:[K].concat(je.components),by:je.ligGlyph})}return W},ne.prototype.addSingle=function(ue,me,ie,W){var Q=P(this.getLookupTable(ie,W,ue,1,!0),2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});fe.assert(1===Q.coverage.format,"Ligature: unable to modify coverage table format "+Q.coverage.format);var A=me.sub,R=this.binSearch(Q.coverage.glyphs,A);0>R&&(Q.coverage.glyphs.splice(R=-1-R,0,A),Q.substitute.splice(R,0,0)),Q.substitute[R]=me.by},ne.prototype.addAlternate=function(ue,me,ie,W){var Q=P(this.getLookupTable(ie,W,ue,3,!0),1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});fe.assert(1===Q.coverage.format,"Ligature: unable to modify coverage table format "+Q.coverage.format);var A=me.sub,R=this.binSearch(Q.coverage.glyphs,A);0>R&&(Q.coverage.glyphs.splice(R=-1-R,0,A),Q.alternateSets.splice(R,0,0)),Q.alternateSets[R]=me.by},ne.prototype.addLigature=function(ue,me,ie,W){var Q=this.getLookupTable(ie=ie||"DFLT",W=W||"DFLT",ue,4,!0),A=Q.subtables[0];A||(Q.subtables[0]=A={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]}),fe.assert(1===A.coverage.format,"Ligature: unable to modify coverage table format "+A.coverage.format);var R=me.sub[0],X=me.sub.slice(1),he={ligGlyph:me.by,components:X},z=this.binSearch(A.coverage.glyphs,R);if(z>=0){for(var Le=A.ligatureSets[z],K=0;K<Le.length;K++)if(M(Le[K].components,X))return;Le.push(he)}else A.coverage.glyphs.splice(z=-1-z,0,R),A.ligatureSets.splice(z,0,[he])},ne.prototype.getFeature=function(ue,me,ie){if(me=me||"DFLT",ie=ie||"DFLT",/ss\d\d/.test(ue))return this.getSingle(ue,me,ie);switch(ue){case"aalt":case"salt":return this.getSingle(ue,me,ie).concat(this.getAlternates(ue,me,ie));case"dlig":case"liga":case"rlig":return this.getLigatures(ue,me,ie)}},ne.prototype.add=function(ue,me,ie,W){if(ie=ie||"DFLT",W=W||"DFLT",/ss\d\d/.test(ue))return this.addSingle(ue,me,ie,W);switch(ue){case"aalt":case"salt":return"number"==typeof me.by?this.addSingle(ue,me,ie,W):this.addAlternate(ue,me,ie,W);case"dlig":case"liga":case"rlig":return this.addLigature(ue,me,ie,W)}},D.exports=ne},{"./check":2,"./layout":8}],13:[function(B,D,G){function M(R,X,he){var z;for(z=0;z<X.length;z+=1){var Le=X[z];this[Le.name]=Le.value}if(this.tableName=R,this.fields=X,he){var K=Object.keys(he);for(z=0;z<K.length;z+=1){var be=K[z];void 0!==this[be]&&(this[be]=he[be])}}}function P(R,X,he){void 0===he&&(he=X.length);var z=new Array(X.length+1);z[0]={name:R+"Count",type:"USHORT",value:he};for(var Le=0;Le<X.length;Le++)z[Le+1]={name:R+Le,type:"USHORT",value:X[Le]};return z}function fe(R,X,he){var z=X.length,Le=new Array(z+1);Le[0]={name:R+"Count",type:"USHORT",value:z};for(var K=0;z>K;K++)Le[K+1]={name:R+K,type:"TABLE",value:he(X[K],K)};return Le}function ye(R,X,he){var z=X.length,Le=[];Le[0]={name:R+"Count",type:"USHORT",value:z};for(var K=0;z>K;K++)Le=Le.concat(he(X[K],K));return Le}function ne(R){1===R.format?M.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(P("glyph",R.glyphs))):W.assert(!1,"Can't create coverage table format 2 yet.")}function ue(R){M.call(this,"scriptListTable",ye("scriptRecord",R,function(X,he){var z=X.script,Le=z.defaultLangSys;return W.assert(!!Le,"Unable to write GSUB: script "+X.tag+" has no default language system."),[{name:"scriptTag"+he,type:"TAG",value:X.tag},{name:"script"+he,type:"TABLE",value:new M("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new M("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:Le.reqFeatureIndex}].concat(P("featureIndex",Le.featureIndexes)))}].concat(ye("langSys",z.langSysRecords,function(K,be){var Ne=K.langSys;return[{name:"langSysTag"+be,type:"TAG",value:K.tag},{name:"langSys"+be,type:"TABLE",value:new M("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:Ne.reqFeatureIndex}].concat(P("featureIndex",Ne.featureIndexes)))}]})))}]}))}function me(R){M.call(this,"featureListTable",ye("featureRecord",R,function(X,he){var z=X.feature;return[{name:"featureTag"+he,type:"TAG",value:X.tag},{name:"feature"+he,type:"TABLE",value:new M("featureTable",[{name:"featureParams",type:"USHORT",value:z.featureParams}].concat(P("lookupListIndex",z.lookupListIndexes)))}]}))}function ie(R,X){M.call(this,"lookupListTable",fe("lookup",R,function(he){var z=X[he.lookupType];return W.assert(!!z,"Unable to write GSUB lookup type "+he.lookupType+" tables."),new M("lookupTable",[{name:"lookupType",type:"USHORT",value:he.lookupType},{name:"lookupFlag",type:"USHORT",value:he.lookupFlag}].concat(fe("subtable",he.subtables,z)))}))}var W=B("./check"),Q=B("./types").encode,A=B("./types").sizeOf;M.prototype.encode=function(){return Q.TABLE(this)},M.prototype.sizeOf=function(){return A.TABLE(this)},(ne.prototype=Object.create(M.prototype)).constructor=ne,(ue.prototype=Object.create(M.prototype)).constructor=ue,(me.prototype=Object.create(M.prototype)).constructor=me,(ie.prototype=Object.create(M.prototype)).constructor=ie,G.Record=G.Table=M,G.Coverage=ne,G.ScriptList=ue,G.FeatureList=me,G.LookupList=ie,G.ushortList=P,G.tableList=fe,G.recordList=ye},{"./check":2,"./types":32}],14:[function(B,D,G){function M(Te,qe){if(Te===qe)return!0;if(Array.isArray(Te)&&Array.isArray(qe)){if(Te.length!==qe.length)return!1;for(var Ke=0;Ke<Te.length;Ke+=1)if(!M(Te[Ke],qe[Ke]))return!1;return!0}return!1}function P(Te,qe,Ke){var vt,ht,Bt,wt=[],Ft=[],Ot=Le.getCard16(Te,qe);if(0!==Ot){var on=Le.getByte(Te,qe+2);ht=qe+(Ot+1)*on+2;var ft=qe+3;for(vt=0;Ot+1>vt;vt+=1)wt.push(Le.getOffset(Te,ft,on)),ft+=on;Bt=ht+wt[Ot]}else Bt=qe+2;for(vt=0;vt<wt.length-1;vt+=1){var An=Le.getBytes(Te,ht+wt[vt],ht+wt[vt+1]);Ke&&(An=Ke(An)),Ft.push(An)}return{objects:Ft,startOffset:qe,endOffset:Bt}}function fe(Te,qe){if(28===qe)return Te.parseByte()<<8|Te.parseByte();if(29===qe)return Te.parseByte()<<24|Te.parseByte()<<16|Te.parseByte()<<8|Te.parseByte();if(30===qe)return function(Ke){for(var vt="",ht=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var Bt=Ke.parseByte(),wt=Bt>>4,Ft=15&Bt;if(15===wt||(vt+=ht[wt],15===Ft))break;vt+=ht[Ft]}return parseFloat(vt)}(Te);if(qe>=32&&246>=qe)return qe-139;if(qe>=247&&250>=qe)return 256*(qe-247)+Te.parseByte()+108;if(qe>=251&&254>=qe)return 256*-(qe-251)-Te.parseByte()-108;throw new Error("Invalid b0 "+qe)}function ye(Te,qe,Ke){var vt=new Le.Parser(Te,qe=void 0!==qe?qe:0),ht=[],Bt=[];for(Ke=void 0!==Ke?Ke:Te.length;vt.relativeOffset<Ke;){var wt=vt.parseByte();21>=wt?(12===wt&&(wt=1200+vt.parseByte()),ht.push([wt,Bt]),Bt=[]):Bt.push(fe(vt,wt))}return function(Ft){for(var Ot={},on=0;on<Ft.length;on+=1){var ft,An=Ft[on][0],Cn=Ft[on][1];if(ft=1===Cn.length?Cn[0]:Cn,Ot.hasOwnProperty(An))throw new Error("Object "+Ot+" already has key "+An);Ot[An]=ft}return Ot}(ht)}function ne(Te,qe){return 390>=qe?he.cffStandardStrings[qe]:Te[qe-391]}function ue(Te,qe,Ke){for(var vt={},ht=0;ht<qe.length;ht+=1){var Bt=qe[ht],wt=Te[Bt.op];void 0===wt&&(wt=void 0!==Bt.value?Bt.value:null),"SID"===Bt.type&&(wt=ne(Ke,wt)),vt[Bt.name]=wt}return vt}function me(Te,qe,Ke){function vt(ar,nr){On&&on.closePath(),on.moveTo(ar,nr),On=!0}function ht(){ft.length%2!=0&&!Cn&&(fn=ft.shift()+Te.nominalWidthX),An+=ft.length>>1,ft.length=0,Cn=!0}var Bt,wt,Ft,Ot,on=new K.Path,ft=[],An=0,Cn=!1,fn=Te.defaultWidthX,On=!1,$n=0,_n=0;return function ar(nr){for(var lr,rr,ti,Zr,pi,tr,mr,mi,xo,Nr,Qr,Vr,gi=0;gi<nr.length;){var Ti=nr[gi];switch(gi+=1,Ti){case 1:case 3:case 18:case 23:ht();break;case 4:ft.length>1&&!Cn&&(fn=ft.shift()+Te.nominalWidthX,Cn=!0),_n+=ft.pop(),vt($n,_n);break;case 5:for(;ft.length>0;)$n+=ft.shift(),_n+=ft.shift(),on.lineTo($n,_n);break;case 6:for(;ft.length>0&&($n+=ft.shift(),on.lineTo($n,_n),0!==ft.length);)_n+=ft.shift(),on.lineTo($n,_n);break;case 7:for(;ft.length>0&&(_n+=ft.shift(),on.lineTo($n,_n),0!==ft.length);)$n+=ft.shift(),on.lineTo($n,_n);break;case 8:for(;ft.length>0;)Bt=$n+ft.shift(),wt=_n+ft.shift(),Ft=Bt+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),_n=Ot+ft.shift(),on.curveTo(Bt,wt,Ft,Ot,$n,_n);break;case 10:pi=ft.pop()+Te.subrsBias,(tr=Te.subrs[pi])&&ar(tr);break;case 11:return;case 12:switch(Ti=nr[gi],gi+=1,Ti){case 35:Bt=$n+ft.shift(),wt=_n+ft.shift(),Ft=Bt+ft.shift(),Ot=wt+ft.shift(),mr=Ft+ft.shift(),mi=Ot+ft.shift(),xo=mr+ft.shift(),Nr=mi+ft.shift(),Qr=xo+ft.shift(),Vr=Nr+ft.shift(),$n=Qr+ft.shift(),_n=Vr+ft.shift(),ft.shift(),on.curveTo(Bt,wt,Ft,Ot,mr,mi),on.curveTo(xo,Nr,Qr,Vr,$n,_n);break;case 34:Bt=$n+ft.shift(),wt=_n,Ft=Bt+ft.shift(),Ot=wt+ft.shift(),mr=Ft+ft.shift(),mi=Ot,xo=mr+ft.shift(),Nr=Ot,Qr=xo+ft.shift(),Vr=_n,$n=Qr+ft.shift(),on.curveTo(Bt,wt,Ft,Ot,mr,mi),on.curveTo(xo,Nr,Qr,Vr,$n,_n);break;case 36:Bt=$n+ft.shift(),wt=_n+ft.shift(),Ft=Bt+ft.shift(),Ot=wt+ft.shift(),mr=Ft+ft.shift(),mi=Ot,xo=mr+ft.shift(),Nr=Ot,Qr=xo+ft.shift(),Vr=Nr+ft.shift(),$n=Qr+ft.shift(),on.curveTo(Bt,wt,Ft,Ot,mr,mi),on.curveTo(xo,Nr,Qr,Vr,$n,_n);break;case 37:Bt=$n+ft.shift(),wt=_n+ft.shift(),Ft=Bt+ft.shift(),Ot=wt+ft.shift(),mr=Ft+ft.shift(),mi=Ot+ft.shift(),xo=mr+ft.shift(),Nr=mi+ft.shift(),Qr=xo+ft.shift(),Vr=Nr+ft.shift(),Math.abs(Qr-$n)>Math.abs(Vr-_n)?$n=Qr+ft.shift():_n=Vr+ft.shift(),on.curveTo(Bt,wt,Ft,Ot,mr,mi),on.curveTo(xo,Nr,Qr,Vr,$n,_n);break;default:console.log("Glyph "+qe.index+": unknown operator 1200"+Ti),ft.length=0}break;case 14:ft.length>0&&!Cn&&(fn=ft.shift()+Te.nominalWidthX,Cn=!0),On&&(on.closePath(),On=!1);break;case 19:case 20:ht(),gi+=An+7>>3;break;case 21:ft.length>2&&!Cn&&(fn=ft.shift()+Te.nominalWidthX,Cn=!0),_n+=ft.pop(),vt($n+=ft.pop(),_n);break;case 22:ft.length>1&&!Cn&&(fn=ft.shift()+Te.nominalWidthX,Cn=!0),vt($n+=ft.pop(),_n);break;case 24:for(;ft.length>2;)Bt=$n+ft.shift(),wt=_n+ft.shift(),Ft=Bt+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),_n=Ot+ft.shift(),on.curveTo(Bt,wt,Ft,Ot,$n,_n);$n+=ft.shift(),_n+=ft.shift(),on.lineTo($n,_n);break;case 25:for(;ft.length>6;)$n+=ft.shift(),_n+=ft.shift(),on.lineTo($n,_n);Bt=$n+ft.shift(),wt=_n+ft.shift(),Ft=Bt+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),_n=Ot+ft.shift(),on.curveTo(Bt,wt,Ft,Ot,$n,_n);break;case 26:for(ft.length%2&&($n+=ft.shift());ft.length>0;)Bt=$n,wt=_n+ft.shift(),Ft=Bt+ft.shift(),Ot=wt+ft.shift(),$n=Ft,_n=Ot+ft.shift(),on.curveTo(Bt,wt,Ft,Ot,$n,_n);break;case 27:for(ft.length%2&&(_n+=ft.shift());ft.length>0;)Bt=$n+ft.shift(),wt=_n,Ft=Bt+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),on.curveTo(Bt,wt,Ft,Ot,$n,_n=Ot);break;case 28:ft.push(((lr=nr[gi])<<24|(rr=nr[gi+1])<<16)>>16),gi+=2;break;case 29:pi=ft.pop()+Te.gsubrsBias,(tr=Te.gsubrs[pi])&&ar(tr);break;case 30:for(;ft.length>0&&(Bt=$n,wt=_n+ft.shift(),Ft=Bt+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),_n=Ot+(1===ft.length?ft.shift():0),on.curveTo(Bt,wt,Ft,Ot,$n,_n),0!==ft.length);)Bt=$n+ft.shift(),wt=_n,Ft=Bt+ft.shift(),Ot=wt+ft.shift(),_n=Ot+ft.shift(),$n=Ft+(1===ft.length?ft.shift():0),on.curveTo(Bt,wt,Ft,Ot,$n,_n);break;case 31:for(;ft.length>0&&(Bt=$n+ft.shift(),wt=_n,Ft=Bt+ft.shift(),Ot=wt+ft.shift(),_n=Ot+ft.shift(),$n=Ft+(1===ft.length?ft.shift():0),on.curveTo(Bt,wt,Ft,Ot,$n,_n),0!==ft.length);)Bt=$n,wt=_n+ft.shift(),Ft=Bt+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),_n=Ot+(1===ft.length?ft.shift():0),on.curveTo(Bt,wt,Ft,Ot,$n,_n);break;default:32>Ti?console.log("Glyph "+qe.index+": unknown operator "+Ti):247>Ti?ft.push(Ti-139):251>Ti?(lr=nr[gi],gi+=1,ft.push(256*(Ti-247)+lr+108)):255>Ti?(lr=nr[gi],gi+=1,ft.push(256*-(Ti-251)-lr-108)):(lr=nr[gi],rr=nr[gi+1],ti=nr[gi+2],Zr=nr[gi+3],gi+=4,ft.push((lr<<24|rr<<16|ti<<8|Zr)/65536))}}}(Ke),qe.advanceWidth=fn,on}function ie(Te){return Te.length<1240?107:Te.length<33900?1131:32768}function W(Te,qe){var Ke,vt=he.cffStandardStrings.indexOf(Te);return vt>=0&&(Ke=vt),(vt=qe.indexOf(Te))>=0?Ke=vt+he.cffStandardStrings.length:(Ke=he.cffStandardStrings.length+qe.length,qe.push(Te)),Ke}function Q(Te,qe,Ke){for(var vt={},ht=0;ht<Te.length;ht+=1){var Bt=Te[ht],wt=qe[Bt.name];void 0===wt||M(wt,Bt.value)||("SID"===Bt.type&&(wt=W(wt,Ke)),vt[Bt.op]={name:Bt.name,type:Bt.type,value:wt})}return vt}function A(Te,qe){var Ke=new be.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return Ke.dict=Q(Ne,Te,qe),Ke}function R(Te){var qe=new be.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return qe.topDicts=[{name:"topDict_0",type:"TABLE",value:Te}],qe}function X(Te){var qe=[],Ke=Te.path;qe.push({name:"width",type:"NUMBER",value:Te.advanceWidth});for(var vt=0,ht=0,Bt=0;Bt<Ke.commands.length;Bt+=1){var wt,Ft,Ot=Ke.commands[Bt];if("Q"===Ot.type){var on=.3333333333333333,ft=2/3;Ot={type:"C",x:Ot.x,y:Ot.y,x1:on*vt+ft*Ot.x1,y1:on*ht+ft*Ot.y1,x2:on*Ot.x+ft*Ot.x1,y2:on*Ot.y+ft*Ot.y1}}if("M"===Ot.type)wt=Math.round(Ot.x-vt),Ft=Math.round(Ot.y-ht),qe.push({name:"dx",type:"NUMBER",value:wt}),qe.push({name:"dy",type:"NUMBER",value:Ft}),qe.push({name:"rmoveto",type:"OP",value:21}),vt=Math.round(Ot.x),ht=Math.round(Ot.y);else if("L"===Ot.type)wt=Math.round(Ot.x-vt),Ft=Math.round(Ot.y-ht),qe.push({name:"dx",type:"NUMBER",value:wt}),qe.push({name:"dy",type:"NUMBER",value:Ft}),qe.push({name:"rlineto",type:"OP",value:5}),vt=Math.round(Ot.x),ht=Math.round(Ot.y);else if("C"===Ot.type){var An=Math.round(Ot.x1-vt),Cn=Math.round(Ot.y1-ht),fn=Math.round(Ot.x2-Ot.x1),On=Math.round(Ot.y2-Ot.y1);wt=Math.round(Ot.x-Ot.x2),Ft=Math.round(Ot.y-Ot.y2),qe.push({name:"dx1",type:"NUMBER",value:An}),qe.push({name:"dy1",type:"NUMBER",value:Cn}),qe.push({name:"dx2",type:"NUMBER",value:fn}),qe.push({name:"dy2",type:"NUMBER",value:On}),qe.push({name:"dx",type:"NUMBER",value:wt}),qe.push({name:"dy",type:"NUMBER",value:Ft}),qe.push({name:"rrcurveto",type:"OP",value:8}),vt=Math.round(Ot.x),ht=Math.round(Ot.y)}}return qe.push({name:"endchar",type:"OP",value:14}),qe}var he=B("../encoding"),z=B("../glyphset"),Le=B("../parse"),K=B("../path"),be=B("../table"),Ne=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],je=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];G.parse=function(Te,qe,Ke){Ke.tables.cff={};var _n,ar,nr,ht=P(Te,((nr={}).formatMajor=Le.getCard8(_n=Te,ar=qe),nr.formatMinor=Le.getCard8(_n,ar+1),nr.size=Le.getCard8(_n,ar+2),nr.offsetSize=Le.getCard8(_n,ar+3),nr.startOffset=ar,nr.endOffset=ar+4,nr).endOffset,Le.bytesToString),Bt=P(Te,ht.endOffset),wt=P(Te,Bt.endOffset,Le.bytesToString),Ft=P(Te,wt.endOffset);Ke.gsubrs=Ft.objects,Ke.gsubrsBias=ie(Ke.gsubrs);var Ot=function(_n,ar){return ue(ye(_n,0,_n.byteLength),Ne,ar)}(new DataView(new Uint8Array(Bt.objects[0]).buffer),wt.objects);Ke.tables.cff.topDict=Ot;var on=qe+Ot.private[1],ft=function(_n,ar,nr,lr){return ue(ye(_n,ar,nr),je,lr)}(Te,on,Ot.private[0],wt.objects);if(Ke.defaultWidthX=ft.defaultWidthX,Ke.nominalWidthX=ft.nominalWidthX,0!==ft.subrs){var An=P(Te,on+ft.subrs);Ke.subrs=An.objects,Ke.subrsBias=ie(Ke.subrs)}else Ke.subrs=[],Ke.subrsBias=0;var Cn=P(Te,qe+Ot.charStrings);Ke.nGlyphs=Cn.objects.length;var fn=function(_n,ar,nr,lr){var rr,ti,Zr,pi=new Le.Parser(_n,ar);nr-=1;var tr=[".notdef"],mr=pi.parseCard8();if(0===mr)for(rr=0;nr>rr;rr+=1)ti=pi.parseSID(),tr.push(ne(lr,ti));else if(1===mr)for(;tr.length<=nr;)for(ti=pi.parseSID(),Zr=pi.parseCard8(),rr=0;Zr>=rr;rr+=1)tr.push(ne(lr,ti)),ti+=1;else{if(2!==mr)throw new Error("Unknown charset format "+mr);for(;tr.length<=nr;)for(ti=pi.parseSID(),Zr=pi.parseCard16(),rr=0;Zr>=rr;rr+=1)tr.push(ne(lr,ti)),ti+=1}return tr}(Te,qe+Ot.charset,Ke.nGlyphs,wt.objects);Ke.cffEncoding=0===Ot.encoding?new he.CffEncoding(he.cffStandardEncoding,fn):1===Ot.encoding?new he.CffEncoding(he.cffExpertEncoding,fn):function(_n,ar,nr){var lr,rr,ti={},Zr=new Le.Parser(_n,ar),pi=Zr.parseCard8();if(0===pi){var tr=Zr.parseCard8();for(lr=0;tr>lr;lr+=1)ti[rr=Zr.parseCard8()]=lr}else{if(1!==pi)throw new Error("Unknown encoding format "+pi);var mr=Zr.parseCard8();for(rr=1,lr=0;mr>lr;lr+=1)for(var mi=Zr.parseCard8(),xo=Zr.parseCard8(),Nr=mi;mi+xo>=Nr;Nr+=1)ti[Nr]=rr,rr+=1}return new he.CffEncoding(ti,nr)}(Te,qe+Ot.encoding,fn),Ke.encoding=Ke.encoding||Ke.cffEncoding,Ke.glyphs=new z.GlyphSet(Ke);for(var On=0;On<Ke.nGlyphs;On+=1)Ke.glyphs.push(On,z.cffGlyphLoader(Ke,On,me,Cn.objects[On]))},G.make=function(Te,qe){for(var Ke,vt=new be.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),ht=1/qe.unitsPerEm,Bt={version:qe.version,fullName:qe.fullName,familyName:qe.familyName,weight:qe.weightName,fontBBox:qe.fontBBox||[0,0,0,0],fontMatrix:[ht,0,0,ht,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},wt=[],Ft=1;Ft<Te.length;Ft+=1)Ke=Te.get(Ft),wt.push(Ke.name);var Ot=[];vt.header=new be.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),vt.nameIndex=function(An){var Cn=new be.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);Cn.names=[];for(var fn=0;fn<An.length;fn+=1)Cn.names.push({name:"name_"+fn,type:"NAME",value:An[fn]});return Cn}([qe.postScriptName]);var Cn,fn,on=A(Bt,Ot);vt.topDictIndex=R(on),vt.globalSubrIndex=new be.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),vt.charsets=function(An,Cn){for(var fn=new be.Record("Charsets",[{name:"format",type:"Card8",value:0}]),On=0;On<An.length;On+=1){var $n=W(An[On],Cn);fn.fields.push({name:"glyph_"+On,type:"SID",value:$n})}return fn}(wt,Ot),vt.charStringsIndex=function(An){for(var Cn=new be.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),fn=0;fn<An.length;fn+=1){var On=An.get(fn),$n=X(On);Cn.charStrings.push({name:On.name,type:"CHARSTRING",value:$n})}return Cn}(Te),vt.privateDict=(Cn=Ot,(fn=new be.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=Q(je,{},Cn),fn),vt.stringIndex=function(An){var Cn=new be.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);Cn.strings=[];for(var fn=0;fn<An.length;fn+=1)Cn.strings.push({name:"string_"+fn,type:"STRING",value:An[fn]});return Cn}(Ot);var ft=vt.header.sizeOf()+vt.nameIndex.sizeOf()+vt.topDictIndex.sizeOf()+vt.stringIndex.sizeOf()+vt.globalSubrIndex.sizeOf();return Bt.charset=ft,Bt.encoding=0,Bt.charStrings=Bt.charset+vt.charsets.sizeOf(),Bt.private[1]=Bt.charStrings+vt.charStringsIndex.sizeOf(),on=A(Bt,Ot),vt.topDictIndex=R(on),vt}},{"../encoding":4,"../glyphset":7,"../parse":10,"../path":11,"../table":13}],15:[function(B,D,G){function M(ne,ue,me){ne.segments.push({end:ue,start:ue,delta:-(ue-me),offset:0})}var P=B("../check"),fe=B("../parse"),ye=B("../table");G.parse=function(ne,ue){var me,ie={};ie.version=fe.getUShort(ne,ue),P.argument(0===ie.version,"cmap table version should be 0."),ie.numTables=fe.getUShort(ne,ue+2);var W=-1;for(me=ie.numTables-1;me>=0;me-=1){var Q=fe.getUShort(ne,ue+4+8*me),A=fe.getUShort(ne,ue+4+8*me+2);if(3===Q&&(0===A||1===A||10===A)){W=fe.getULong(ne,ue+4+8*me+4);break}}if(-1===W)return null;var R=new fe.Parser(ne,ue+W);if(ie.format=R.parseUShort(),12===ie.format)!function(X,he){var z,Le;for(he.parseUShort(),X.length=he.parseULong(),X.language=he.parseULong(),X.groupCount=Le=he.parseULong(),X.glyphIndexMap={},z=0;Le>z;z+=1)for(var K=he.parseULong(),be=he.parseULong(),Ne=he.parseULong(),je=K;be>=je;je+=1)X.glyphIndexMap[je]=Ne,Ne++}(ie,R);else{if(4!==ie.format)throw new Error("Only format 4 and 12 cmap tables are supported.");!function(X,he,z,Le,K){var be,Ne;X.length=he.parseUShort(),X.language=he.parseUShort(),X.segCount=Ne=he.parseUShort()>>1,he.skip("uShort",3),X.glyphIndexMap={};var je=new fe.Parser(z,Le+K+14),Te=new fe.Parser(z,Le+K+16+2*Ne),qe=new fe.Parser(z,Le+K+16+4*Ne),Ke=new fe.Parser(z,Le+K+16+6*Ne),vt=Le+K+16+8*Ne;for(be=0;Ne-1>be;be+=1)for(var ht,Bt=je.parseUShort(),wt=Te.parseUShort(),Ft=qe.parseShort(),Ot=Ke.parseUShort(),on=wt;Bt>=on;on+=1)0!==Ot?(vt=Ke.offset+Ke.relativeOffset-2,vt+=Ot,0!==(ht=fe.getUShort(z,vt+=2*(on-wt)))&&(ht=ht+Ft&65535)):ht=on+Ft&65535,X.glyphIndexMap[on]=ht}(ie,R,ne,ue,W)}return ie},G.make=function(ne){var ue,me,ie=new ye.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(ie.segments=[],ue=0;ue<ne.length;ue+=1){for(var W=ne.get(ue),Q=0;Q<W.unicodes.length;Q+=1)M(ie,W.unicodes[Q],ue);ie.segments=ie.segments.sort(function(K,be){return K.start-be.start})}ie.segments.push({end:65535,start:65535,delta:1,offset:0}),ie.segCountX2=2*(me=ie.segments.length),ie.searchRange=2*Math.pow(2,Math.floor(Math.log(me)/Math.log(2))),ie.entrySelector=Math.log(ie.searchRange/2)/Math.log(2),ie.rangeShift=ie.segCountX2-ie.searchRange;var A=[],R=[],X=[],he=[],z=[];for(ue=0;me>ue;ue+=1){var Le=ie.segments[ue];A=A.concat({name:"end_"+ue,type:"USHORT",value:Le.end}),R=R.concat({name:"start_"+ue,type:"USHORT",value:Le.start}),X=X.concat({name:"idDelta_"+ue,type:"SHORT",value:Le.delta}),he=he.concat({name:"idRangeOffset_"+ue,type:"USHORT",value:Le.offset}),void 0!==Le.glyphId&&(z=z.concat({name:"glyph_"+ue,type:"USHORT",value:Le.glyphId}))}return ie.fields=ie.fields.concat(A),ie.fields.push({name:"reservedPad",type:"USHORT",value:0}),ie.fields=ie.fields.concat(R),ie.fields=ie.fields.concat(X),ie.fields=ie.fields.concat(he),ie.fields=ie.fields.concat(z),ie.length=14+2*A.length+2+2*R.length+2*X.length+2*he.length+2*z.length,ie}},{"../check":2,"../parse":10,"../table":13}],16:[function(B,D,G){function M(W,Q){var A=JSON.stringify(W),R=256;for(var X in Q){var he=parseInt(X);if(he&&!(256>he)){if(JSON.stringify(Q[X])===A)return he;he>=R&&(R=he+1)}}return Q[R]=W,R}function P(W,Q,A){var R=M(Q.name,A);return[{name:"tag_"+W,type:"TAG",value:Q.tag},{name:"minValue_"+W,type:"FIXED",value:Q.minValue<<16},{name:"defaultValue_"+W,type:"FIXED",value:Q.defaultValue<<16},{name:"maxValue_"+W,type:"FIXED",value:Q.maxValue<<16},{name:"flags_"+W,type:"USHORT",value:0},{name:"nameID_"+W,type:"USHORT",value:R}]}function fe(W,Q,A){var R={},X=new me.Parser(W,Q);return R.tag=X.parseTag(),R.minValue=X.parseFixed(),R.defaultValue=X.parseFixed(),R.maxValue=X.parseFixed(),X.skip("uShort",1),R.name=A[X.parseUShort()]||{},R}function ye(W,Q,A,R){for(var X=[{name:"nameID_"+W,type:"USHORT",value:M(Q.name,R)},{name:"flags_"+W,type:"USHORT",value:0}],he=0;he<A.length;++he){var z=A[he].tag;X.push({name:"axis_"+W+" "+z,type:"FIXED",value:Q.coordinates[z]<<16})}return X}function ne(W,Q,A,R){var X={},he=new me.Parser(W,Q);X.name=R[he.parseUShort()]||{},he.skip("uShort",1),X.coordinates={};for(var z=0;z<A.length;++z)X.coordinates[A[z].tag]=he.parseFixed();return X}var ue=B("../check"),me=B("../parse"),ie=B("../table");G.make=function(W,Q){var A=new ie.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:W.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:W.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*W.axes.length}]);A.offsetToData=A.sizeOf();for(var R=0;R<W.axes.length;R++)A.fields=A.fields.concat(P(R,W.axes[R],Q));for(var X=0;X<W.instances.length;X++)A.fields=A.fields.concat(ye(X,W.instances[X],W.axes,Q));return A},G.parse=function(W,Q,A){var R=new me.Parser(W,Q),X=R.parseULong();ue.argument(65536===X,"Unsupported fvar table version.");var he=R.parseOffset16();R.skip("uShort",1);for(var z=R.parseUShort(),Le=R.parseUShort(),K=R.parseUShort(),be=R.parseUShort(),Ne=[],je=0;z>je;je++)Ne.push(fe(W,Q+he+je*Le,A));for(var Te=[],qe=Q+he+z*Le,Ke=0;K>Ke;Ke++)Te.push(ne(W,qe+Ke*be,Ne,A));return{axes:Ne,instances:Te}}},{"../check":2,"../parse":10,"../table":13}],17:[function(B,D,G){function M(W,Q,A,R,X){var he;return(Q&R)>0?(he=W.parseByte(),!(Q&X)&&(he=-he),he=A+he):he=(Q&X)>0?A:A+W.parseShort(),he}function P(W,Q,A){var R,X,he=new me.Parser(Q,A);if(W.numberOfContours=he.parseShort(),W._xMin=he.parseShort(),W._yMin=he.parseShort(),W._xMax=he.parseShort(),W._yMax=he.parseShort(),W.numberOfContours>0){var z,Le=W.endPointIndices=[];for(z=0;z<W.numberOfContours;z+=1)Le.push(he.parseUShort());for(W.instructionLength=he.parseUShort(),W.instructions=[],z=0;z<W.instructionLength;z+=1)W.instructions.push(he.parseByte());var K=Le[Le.length-1]+1;for(R=[],z=0;K>z;z+=1)if(X=he.parseByte(),R.push(X),(8&X)>0)for(var be=he.parseByte(),Ne=0;be>Ne;Ne+=1)R.push(X),z+=1;if(ne.argument(R.length===K,"Bad flags."),Le.length>0){var je,Te=[];if(K>0){for(z=0;K>z;z+=1)(je={}).onCurve=!!(1&(X=R[z])),je.lastPointOfContour=Le.indexOf(z)>=0,Te.push(je);var qe=0;for(z=0;K>z;z+=1)(je=Te[z]).x=M(he,X=R[z],qe,2,16),qe=je.x;var Ke=0;for(z=0;K>z;z+=1)(je=Te[z]).y=M(he,X=R[z],Ke,4,32),Ke=je.y}W.points=Te}else W.points=[]}else if(0===W.numberOfContours)W.points=[];else{W.isComposite=!0,W.points=[],W.components=[];for(var vt=!0;vt;){R=he.parseUShort();var ht={glyphIndex:he.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&R)>0?(2&R)>0?(ht.dx=he.parseShort(),ht.dy=he.parseShort()):ht.matchedPoints=[he.parseUShort(),he.parseUShort()]:(2&R)>0?(ht.dx=he.parseChar(),ht.dy=he.parseChar()):ht.matchedPoints=[he.parseByte(),he.parseByte()],(8&R)>0?ht.xScale=ht.yScale=he.parseF2Dot14():(64&R)>0?(ht.xScale=he.parseF2Dot14(),ht.yScale=he.parseF2Dot14()):(128&R)>0&&(ht.xScale=he.parseF2Dot14(),ht.scale01=he.parseF2Dot14(),ht.scale10=he.parseF2Dot14(),ht.yScale=he.parseF2Dot14()),W.components.push(ht),vt=!!(32&R)}}}function fe(W,Q){for(var A=[],R=0;R<W.length;R+=1){var X=W[R];A.push({x:Q.xScale*X.x+Q.scale01*X.y+Q.dx,y:Q.scale10*X.x+Q.yScale*X.y+Q.dy,onCurve:X.onCurve,lastPointOfContour:X.lastPointOfContour})}return A}function ye(W,Q){if(Q.isComposite)for(var A=0;A<Q.components.length;A+=1){var R=Q.components[A],X=W.get(R.glyphIndex);if(X.getPath(),X.points){var he;if(void 0===R.matchedPoints)he=fe(X.points,R);else{if(R.matchedPoints[0]>Q.points.length-1||R.matchedPoints[1]>X.points.length-1)throw Error("Matched points out of range in "+Q.name);var z=Q.points[R.matchedPoints[0]],Le=X.points[R.matchedPoints[1]],K={xScale:R.xScale,scale01:R.scale01,scale10:R.scale10,yScale:R.yScale,dx:0,dy:0};Le=fe([Le],K)[0],K.dx=z.x-Le.x,K.dy=z.y-Le.y,he=fe(X.points,K)}Q.points=Q.points.concat(he)}}return function(be){var Ne=new ie.Path;if(!be)return Ne;for(var je=function(ft){for(var An=[],Cn=[],fn=0;fn<ft.length;fn+=1){var On=ft[fn];Cn.push(On),On.lastPointOfContour&&(An.push(Cn),Cn=[])}return ne.argument(0===Cn.length,"There are still points left in the current contour."),An}(be),Te=0;Te<je.length;Te+=1){var qe,Ke,vt=je[Te],ht=vt[0],Bt=vt[vt.length-1];ht.onCurve?(qe=null,Ke=!0):(qe=ht=Bt.onCurve?Bt:{x:(ht.x+Bt.x)/2,y:(ht.y+Bt.y)/2},Ke=!1),Ne.moveTo(ht.x,ht.y);for(var wt=Ke?1:0;wt<vt.length;wt+=1){var Ft=vt[wt],Ot=0===wt?ht:vt[wt-1];if(Ot.onCurve&&Ft.onCurve)Ne.lineTo(Ft.x,Ft.y);else if(Ot.onCurve&&!Ft.onCurve)qe=Ft;else if(Ot.onCurve||Ft.onCurve){if(Ot.onCurve||!Ft.onCurve)throw new Error("Invalid state.");Ne.quadraticCurveTo(qe.x,qe.y,Ft.x,Ft.y),qe=null}else{var on={x:(Ot.x+Ft.x)/2,y:(Ot.y+Ft.y)/2};Ne.quadraticCurveTo(Ot.x,Ot.y,on.x,on.y),qe=Ft}}ht!==Bt&&(qe?Ne.quadraticCurveTo(qe.x,qe.y,ht.x,ht.y):Ne.lineTo(ht.x,ht.y))}return Ne.closePath(),Ne}(Q.points)}var ne=B("../check"),ue=B("../glyphset"),me=B("../parse"),ie=B("../path");G.parse=function(W,Q,A,R){var X,he=new ue.GlyphSet(R);for(X=0;X<A.length-1;X+=1){var z=A[X];he.push(X,z!==A[X+1]?ue.ttfGlyphLoader(R,X,P,W,Q+z,ye):ue.glyphLoader(R,X))}return he}},{"../check":2,"../glyphset":7,"../parse":10,"../path":11}],18:[function(B,D,G){function M(me,ie){for(var W=new ue.Parser(me,ie),Q=W.parseUShort(),A=[],R=0;Q>R;R++)A[W.parseTag()]={offset:W.parseUShort()};return A}function P(me,ie){var W=new ue.Parser(me,ie),Q=W.parseUShort();if(1===Q){var A=W.parseUShort(),R=W.parseUShort(),X=W.parseUShortList(R);return function(Ne){return X[Ne-A]||0}}if(2===Q){for(var he=W.parseUShort(),z=[],Le=[],K=[],be=0;he>be;be++)z[be]=W.parseUShort(),Le[be]=W.parseUShort(),K[be]=W.parseUShort();return function(Ne){for(var je=0,Te=z.length-1;Te>je;){var qe=je+Te+1>>1;Ne<z[qe]?Te=qe-1:je=qe}return z[je]<=Ne&&Ne<=Le[je]&&K[je]||0}}}function fe(me,ie){var W,Q=new ue.Parser(me,ie),A=Q.parseUShort(),R=function(On,$n){var _n=new ue.Parser(On,$n),ar=_n.parseUShort(),nr=_n.parseUShort();if(1===ar)return _n.parseUShortList(nr);if(2===ar){for(var lr=[];nr--;)for(var rr=_n.parseUShort(),ti=_n.parseUShort(),Zr=_n.parseUShort(),pi=rr;ti>=pi;pi++)lr[Zr++]=pi;return lr}}(me,ie+Q.parseUShort()),X=Q.parseUShort(),he=Q.parseUShort();if(4===X&&0===he){var z={};if(1===A){for(var Le=Q.parseUShort(),K=[],be=Q.parseOffset16List(Le),Ne=0;Le>Ne;Ne++){var je=be[Ne],Te=z[je];if(!Te){Te={},Q.relativeOffset=je;for(var qe=Q.parseUShort();qe--;){var Ke=Q.parseUShort();X&&(W=Q.parseShort()),he&&Q.parseShort(),Te[Ke]=W}}K[R[Ne]]=Te}return function(On,$n){var _n=K[On];return _n?_n[$n]:void 0}}if(2===A){for(var vt=Q.parseUShort(),ht=Q.parseUShort(),Bt=Q.parseUShort(),wt=Q.parseUShort(),Ft=P(me,ie+vt),Ot=P(me,ie+ht),on=[],ft=0;Bt>ft;ft++)for(var An=on[ft]=[],Cn=0;wt>Cn;Cn++)X&&(W=Q.parseShort()),he&&Q.parseShort(),An[Cn]=W;var fn={};for(ft=0;ft<R.length;ft++)fn[R[ft]]=1;return function(On,$n){if(fn[On]){var _n=Ft(On),ar=Ot($n),nr=on[_n];return nr?nr[ar]:void 0}}}}}function ye(me,ie){var W=new ue.Parser(me,ie),Q=W.parseUShort(),A=W.parseUShort(),R=16&A,X=W.parseUShort(),he=W.parseOffset16List(X),z={lookupType:Q,lookupFlag:A,markFilteringSet:R?W.parseUShort():-1};if(2===Q){for(var Le=[],K=0;X>K;K++)Le.push(fe(me,ie+he[K]));z.getKerningValue=function(be,Ne){for(var je=Le.length;je--;){var Te=Le[je](be,Ne);if(void 0!==Te)return Te}return 0}}return z}var ne=B("../check"),ue=B("../parse");G.parse=function(me,ie,W){var Q=new ue.Parser(me,ie),A=Q.parseFixed();ne.argument(1===A,"Unsupported GPOS table version."),M(me,ie+Q.parseUShort()),M(me,ie+Q.parseUShort());var R=Q.parseUShort();Q.relativeOffset=R;for(var X=Q.parseUShort(),he=Q.parseOffset16List(X),z=ie+R,Le=0;X>Le;Le++){var K=ye(me,z+he[Le]);2!==K.lookupType||W.getGposKerningValue||(W.getGposKerningValue=K.getKerningValue)}}},{"../check":2,"../parse":10}],19:[function(B,D,G){var M=B("../check"),P=B("../parse").Parser,fe=new Array(9),ye=B("../table");fe[1]=function(){var me=this.offset+this.relativeOffset,ie=this.parseUShort();return 1===ie?{substFormat:1,coverage:this.parsePointer(P.coverage),deltaGlyphId:this.parseUShort()}:2===ie?{substFormat:2,coverage:this.parsePointer(P.coverage),substitute:this.parseOffset16List()}:void M.assert(!1,"0x"+me.toString(16)+": lookup type 1 format must be 1 or 2.")},fe[2]=function(){var me=this.parseUShort();return M.argument(1===me,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:me,coverage:this.parsePointer(P.coverage),sequences:this.parseListOfLists()}},fe[3]=function(){var me=this.parseUShort();return M.argument(1===me,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:me,coverage:this.parsePointer(P.coverage),alternateSets:this.parseListOfLists()}},fe[4]=function(){var me=this.parseUShort();return M.argument(1===me,"GSUB ligature table identifier-format must be 1"),{substFormat:me,coverage:this.parsePointer(P.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var ne={sequenceIndex:P.uShort,lookupListIndex:P.uShort};fe[5]=function(){var me=this.offset+this.relativeOffset,ie=this.parseUShort();if(1===ie)return{substFormat:ie,coverage:this.parsePointer(P.coverage),ruleSets:this.parseListOfLists(function(){var A=this.parseUShort(),R=this.parseUShort();return{input:this.parseUShortList(A-1),lookupRecords:this.parseRecordList(R,ne)}})};if(2===ie)return{substFormat:ie,coverage:this.parsePointer(P.coverage),classDef:this.parsePointer(P.classDef),classSets:this.parseListOfLists(function(){var A=this.parseUShort(),R=this.parseUShort();return{classes:this.parseUShortList(A-1),lookupRecords:this.parseRecordList(R,ne)}})};if(3===ie){var W=this.parseUShort(),Q=this.parseUShort();return{substFormat:ie,coverages:this.parseList(W,P.pointer(P.coverage)),lookupRecords:this.parseRecordList(Q,ne)}}M.assert(!1,"0x"+me.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},fe[6]=function(){var me=this.offset+this.relativeOffset,ie=this.parseUShort();return 1===ie?{substFormat:1,coverage:this.parsePointer(P.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ne)}})}:2===ie?{substFormat:2,coverage:this.parsePointer(P.coverage),backtrackClassDef:this.parsePointer(P.classDef),inputClassDef:this.parsePointer(P.classDef),lookaheadClassDef:this.parsePointer(P.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ne)}})}:3===ie?{substFormat:3,backtrackCoverage:this.parseList(P.pointer(P.coverage)),inputCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),lookupRecords:this.parseRecordList(ne)}:void M.assert(!1,"0x"+me.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},fe[7]=function(){var me=this.parseUShort();M.argument(1===me,"GSUB Extension Substitution subtable identifier-format must be 1");var ie=this.parseUShort(),W=new P(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:ie,extension:fe[ie].call(W)}},fe[8]=function(){var me=this.parseUShort();return M.argument(1===me,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:me,coverage:this.parsePointer(P.coverage),backtrackCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),substitutes:this.parseUShortList()}};var ue=new Array(9);ue[1]=function(me){return new ye.Table("substitutionTable",1===me.substFormat?[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new ye.Coverage(me.coverage)},{name:"deltaGlyphID",type:"USHORT",value:me.deltaGlyphId}]:[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new ye.Coverage(me.coverage)}].concat(ye.ushortList("substitute",me.substitute)))},ue[3]=function(me){return M.assert(1===me.substFormat,"Lookup type 3 substFormat must be 1."),new ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new ye.Coverage(me.coverage)}].concat(ye.tableList("altSet",me.alternateSets,function(ie){return new ye.Table("alternateSetTable",ye.ushortList("alternate",ie))})))},ue[4]=function(me){return M.assert(1===me.substFormat,"Lookup type 4 substFormat must be 1."),new ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new ye.Coverage(me.coverage)}].concat(ye.tableList("ligSet",me.ligatureSets,function(ie){return new ye.Table("ligatureSetTable",ye.tableList("ligature",ie,function(W){return new ye.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:W.ligGlyph}].concat(ye.ushortList("component",W.components,W.components.length+1)))}))})))},G.parse=function(me,ie){var W=new P(me,ie=ie||0),Q=W.parseVersion();return M.argument(1===Q,"Unsupported GSUB table version."),{version:Q,scripts:W.parseScriptList(),features:W.parseFeatureList(),lookups:W.parseLookupList(fe)}},G.make=function(me){return new ye.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new ye.ScriptList(me.scripts)},{name:"features",type:"TABLE",value:new ye.FeatureList(me.features)},{name:"lookups",type:"TABLE",value:new ye.LookupList(me.lookups,ue)}])}},{"../check":2,"../parse":10,"../table":13}],20:[function(B,D,G){var M=B("../check"),P=B("../parse"),fe=B("../table");G.parse=function(ye,ne){var ue={},me=new P.Parser(ye,ne);return ue.version=me.parseVersion(),ue.fontRevision=Math.round(1e3*me.parseFixed())/1e3,ue.checkSumAdjustment=me.parseULong(),ue.magicNumber=me.parseULong(),M.argument(1594834165===ue.magicNumber,"Font header has wrong magic number."),ue.flags=me.parseUShort(),ue.unitsPerEm=me.parseUShort(),ue.created=me.parseLongDateTime(),ue.modified=me.parseLongDateTime(),ue.xMin=me.parseShort(),ue.yMin=me.parseShort(),ue.xMax=me.parseShort(),ue.yMax=me.parseShort(),ue.macStyle=me.parseUShort(),ue.lowestRecPPEM=me.parseUShort(),ue.fontDirectionHint=me.parseShort(),ue.indexToLocFormat=me.parseShort(),ue.glyphDataFormat=me.parseShort(),ue},G.make=function(ye){var ne=Math.round((new Date).getTime()/1e3)+2082844800,ue=ne;return ye.createdTimestamp&&(ue=ye.createdTimestamp+2082844800),new fe.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:ue},{name:"modified",type:"LONGDATETIME",value:ne},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],ye)}},{"../check":2,"../parse":10,"../table":13}],21:[function(B,D,G){var M=B("../parse"),P=B("../table");G.parse=function(fe,ye){var ne={},ue=new M.Parser(fe,ye);return ne.version=ue.parseVersion(),ne.ascender=ue.parseShort(),ne.descender=ue.parseShort(),ne.lineGap=ue.parseShort(),ne.advanceWidthMax=ue.parseUShort(),ne.minLeftSideBearing=ue.parseShort(),ne.minRightSideBearing=ue.parseShort(),ne.xMaxExtent=ue.parseShort(),ne.caretSlopeRise=ue.parseShort(),ne.caretSlopeRun=ue.parseShort(),ne.caretOffset=ue.parseShort(),ue.relativeOffset+=8,ne.metricDataFormat=ue.parseShort(),ne.numberOfHMetrics=ue.parseUShort(),ne},G.make=function(fe){return new P.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],fe)}},{"../parse":10,"../table":13}],22:[function(B,D,G){var M=B("../parse"),P=B("../table");G.parse=function(fe,ye,ne,ue,me){for(var ie,W,Q=new M.Parser(fe,ye),A=0;ue>A;A+=1){ne>A&&(ie=Q.parseUShort(),W=Q.parseShort());var R=me.get(A);R.advanceWidth=ie,R.leftSideBearing=W}},G.make=function(fe){for(var ye=new P.Table("hmtx",[]),ne=0;ne<fe.length;ne+=1){var ue=fe.get(ne),ie=ue.leftSideBearing||0;ye.fields.push({name:"advanceWidth_"+ne,type:"USHORT",value:ue.advanceWidth||0}),ye.fields.push({name:"leftSideBearing_"+ne,type:"SHORT",value:ie})}return ye}},{"../parse":10,"../table":13}],23:[function(B,D,G){var M=B("../check"),P=B("../parse");G.parse=function(fe,ye){var ne={},ue=new P.Parser(fe,ye),me=ue.parseUShort();M.argument(0===me,"Unsupported kern table version."),ue.skip("uShort",1);var ie=ue.parseUShort();M.argument(0===ie,"Unsupported kern sub-table version."),ue.skip("uShort",2);var W=ue.parseUShort();ue.skip("uShort",3);for(var Q=0;W>Q;Q+=1){var A=ue.parseUShort(),R=ue.parseUShort(),X=ue.parseShort();ne[A+","+R]=X}return ne}},{"../check":2,"../parse":10}],24:[function(B,D,G){var M=B("../parse");G.parse=function(P,fe,ye,ne){for(var ue=new M.Parser(P,fe),me=ne?ue.parseUShort:ue.parseULong,ie=[],W=0;ye+1>W;W+=1){var Q=me.call(ue);ne&&(Q*=2),ie.push(Q)}return ie}},{"../parse":10}],25:[function(B,D,G){var M=B("../check"),P=B("../parse"),fe=B("../table");G.make=function(ye){for(var ne=new fe.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:ye.length}]),ue="",me=12+4*ye.length,ie=0;ie<ye.length;++ie){var W=ue.indexOf(ye[ie]);0>W&&(W=ue.length,ue+=ye[ie]),ne.fields.push({name:"offset "+ie,type:"USHORT",value:me+W}),ne.fields.push({name:"length "+ie,type:"USHORT",value:ye[ie].length})}return ne.fields.push({name:"stringPool",type:"CHARARRAY",value:ue}),ne},G.parse=function(ye,ne){var ue=new P.Parser(ye,ne),me=ue.parseULong();M.argument(1===me,"Unsupported ltag table version."),ue.skip("uLong",1);for(var ie=ue.parseULong(),W=[],Q=0;ie>Q;Q++){for(var A="",R=ne+ue.parseUShort(),X=ue.parseUShort(),he=R;R+X>he;++he)A+=String.fromCharCode(ye.getInt8(he));W.push(A)}return W}},{"../check":2,"../parse":10,"../table":13}],26:[function(B,D,G){var M=B("../parse"),P=B("../table");G.parse=function(fe,ye){var ne={},ue=new M.Parser(fe,ye);return ne.version=ue.parseVersion(),ne.numGlyphs=ue.parseUShort(),1===ne.version&&(ne.maxPoints=ue.parseUShort(),ne.maxContours=ue.parseUShort(),ne.maxCompositePoints=ue.parseUShort(),ne.maxCompositeContours=ue.parseUShort(),ne.maxZones=ue.parseUShort(),ne.maxTwilightPoints=ue.parseUShort(),ne.maxStorage=ue.parseUShort(),ne.maxFunctionDefs=ue.parseUShort(),ne.maxInstructionDefs=ue.parseUShort(),ne.maxStackElements=ue.parseUShort(),ne.maxSizeOfInstructions=ue.parseUShort(),ne.maxComponentElements=ue.parseUShort(),ne.maxComponentDepth=ue.parseUShort()),ne},G.make=function(fe){return new P.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:fe}])}},{"../parse":10,"../table":13}],27:[function(B,D,G){var M=B("../types").decode,P=B("../check"),fe=B("../parse"),ye=B("../table");G.parse=function(ne,ue){var me=new fe.Parser(ne,ue),ie=me.parseULong();P.argument(1===ie,"Unsupported META table version."),me.parseULong(),me.parseULong();for(var W=me.parseULong(),Q={},A=0;W>A;A++){var R=me.parseTag(),X=me.parseULong(),he=me.parseULong(),z=M.UTF8(ne,ue+X,he);Q[R]=z}return Q},G.make=function(ne){var ue=Object.keys(ne).length,me="",ie=16+12*ue,W=new ye.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:ie},{name:"numTags",type:"ULONG",value:ue}]);for(var Q in ne){var A=me.length;me+=ne[Q],W.fields.push({name:"tag "+Q,type:"TAG",value:Q}),W.fields.push({name:"offset "+Q,type:"ULONG",value:ie+A}),W.fields.push({name:"length "+Q,type:"ULONG",value:ne[Q].length})}return W.fields.push({name:"stringPool",type:"CHARARRAY",value:me}),W}},{"../check":2,"../parse":10,"../table":13,"../types":32}],28:[function(B,D,G){function M(be,Ne,je){switch(be){case 0:if(65535===Ne)return"und";if(je)return je[Ne];break;case 1:return R[Ne];case 3:return he[Ne]}}function P(be,Ne,je){switch(be){case 0:return z;case 1:return K[je]||Le[Ne];case 3:if(1===Ne||10===Ne)return z}}function fe(be){var Ne={};for(var je in be)Ne[be[je]]=parseInt(je);return Ne}function ye(be,Ne,je,Te,qe,Ke){return new Q.Record("NameRecord",[{name:"platformID",type:"USHORT",value:be},{name:"encodingID",type:"USHORT",value:Ne},{name:"languageID",type:"USHORT",value:je},{name:"nameID",type:"USHORT",value:Te},{name:"length",type:"USHORT",value:qe},{name:"offset",type:"USHORT",value:Ke}])}function ne(be,Ne){var je=function(Ke,vt){var ht=Ke.length,Bt=vt.length-ht+1;e:for(var wt=0;Bt>wt;wt++)for(;Bt>wt;wt++){for(var Ft=0;ht>Ft;Ft++)if(vt[wt+Ft]!==Ke[Ft])continue e;return wt}return-1}(be,Ne);if(0>je){je=Ne.length;for(var Te=0,qe=be.length;qe>Te;++Te)Ne.push(be[Te])}return je}var ue=B("../types"),me=ue.decode,ie=ue.encode,W=B("../parse"),Q=B("../table"),A=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],R={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},X={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},he={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},z="utf-16",Le={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},K={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};G.parse=function(be,Ne,je){for(var Te={},qe=new W.Parser(be,Ne),Ke=qe.parseUShort(),vt=qe.parseUShort(),ht=qe.offset+qe.parseUShort(),Bt=0;vt>Bt;Bt++){var wt,Ft=qe.parseUShort(),Ot=qe.parseUShort(),on=qe.parseUShort(),ft=qe.parseUShort(),An=A[ft]||ft,Cn=qe.parseUShort(),fn=qe.parseUShort(),On=M(Ft,on,je),$n=P(Ft,Ot,on);if(void 0!==$n&&void 0!==On&&(wt=$n===z?me.UTF16(be,ht+fn,Cn):me.MACSTRING(be,ht+fn,Cn,$n))){var _n=Te[An];void 0===_n&&(_n=Te[An]={}),_n[On]=wt}}return 1===Ke&&qe.parseUShort(),Te},G.make=function(be,Ne){var je,Te=[],qe={},Ke=fe(A);for(var vt in be){var ht=Ke[vt];if(void 0===ht&&(ht=vt),je=parseInt(ht),isNaN(je))throw new Error('Name table entry "'+vt+'" does not exist, see nameTableNames for complete list.');qe[je]=be[vt],Te.push(je)}for(var Bt=fe(R),wt=fe(he),Ft=[],Ot=[],on=0;on<Te.length;on++){var ft=qe[je=Te[on]];for(var An in ft){var Cn=ft[An],fn=1,On=Bt[An],$n=X[On],_n=P(fn,$n,On),ar=ie.MACSTRING(Cn,_n);void 0===ar&&(fn=0,0>(On=Ne.indexOf(An))&&(On=Ne.length,Ne.push(An)),$n=4,ar=ie.UTF16(Cn));var nr=ne(ar,Ot);Ft.push(ye(fn,$n,On,je,ar.length,nr));var lr=wt[An];if(void 0!==lr){var rr=ie.UTF16(Cn),ti=ne(rr,Ot);Ft.push(ye(3,1,lr,je,rr.length,ti))}}}Ft.sort(function(tr,mr){return tr.platformID-mr.platformID||tr.encodingID-mr.encodingID||tr.languageID-mr.languageID||tr.nameID-mr.nameID});for(var Zr=new Q.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:Ft.length},{name:"stringOffset",type:"USHORT",value:6+12*Ft.length}]),pi=0;pi<Ft.length;pi++)Zr.fields.push({name:"record_"+pi,type:"RECORD",value:Ft[pi]});return Zr.fields.push({name:"strings",type:"LITERAL",value:Ot}),Zr}},{"../parse":10,"../table":13,"../types":32}],29:[function(B,D,G){var M=B("../parse"),P=B("../table"),fe=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];G.unicodeRanges=fe,G.getUnicodeRange=function(ye){for(var ne=0;ne<fe.length;ne+=1){var ue=fe[ne];if(ye>=ue.begin&&ye<ue.end)return ne}return-1},G.parse=function(ye,ne){var ue={},me=new M.Parser(ye,ne);ue.version=me.parseUShort(),ue.xAvgCharWidth=me.parseShort(),ue.usWeightClass=me.parseUShort(),ue.usWidthClass=me.parseUShort(),ue.fsType=me.parseUShort(),ue.ySubscriptXSize=me.parseShort(),ue.ySubscriptYSize=me.parseShort(),ue.ySubscriptXOffset=me.parseShort(),ue.ySubscriptYOffset=me.parseShort(),ue.ySuperscriptXSize=me.parseShort(),ue.ySuperscriptYSize=me.parseShort(),ue.ySuperscriptXOffset=me.parseShort(),ue.ySuperscriptYOffset=me.parseShort(),ue.yStrikeoutSize=me.parseShort(),ue.yStrikeoutPosition=me.parseShort(),ue.sFamilyClass=me.parseShort(),ue.panose=[];for(var ie=0;10>ie;ie++)ue.panose[ie]=me.parseByte();return ue.ulUnicodeRange1=me.parseULong(),ue.ulUnicodeRange2=me.parseULong(),ue.ulUnicodeRange3=me.parseULong(),ue.ulUnicodeRange4=me.parseULong(),ue.achVendID=String.fromCharCode(me.parseByte(),me.parseByte(),me.parseByte(),me.parseByte()),ue.fsSelection=me.parseUShort(),ue.usFirstCharIndex=me.parseUShort(),ue.usLastCharIndex=me.parseUShort(),ue.sTypoAscender=me.parseShort(),ue.sTypoDescender=me.parseShort(),ue.sTypoLineGap=me.parseShort(),ue.usWinAscent=me.parseUShort(),ue.usWinDescent=me.parseUShort(),ue.version>=1&&(ue.ulCodePageRange1=me.parseULong(),ue.ulCodePageRange2=me.parseULong()),ue.version>=2&&(ue.sxHeight=me.parseShort(),ue.sCapHeight=me.parseShort(),ue.usDefaultChar=me.parseUShort(),ue.usBreakChar=me.parseUShort(),ue.usMaxContent=me.parseUShort()),ue},G.make=function(ye){return new P.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],ye)}},{"../parse":10,"../table":13}],30:[function(B,D,G){var M=B("../encoding"),P=B("../parse"),fe=B("../table");G.parse=function(ye,ne){var ue,me={},ie=new P.Parser(ye,ne);switch(me.version=ie.parseVersion(),me.italicAngle=ie.parseFixed(),me.underlinePosition=ie.parseShort(),me.underlineThickness=ie.parseShort(),me.isFixedPitch=ie.parseULong(),me.minMemType42=ie.parseULong(),me.maxMemType42=ie.parseULong(),me.minMemType1=ie.parseULong(),me.maxMemType1=ie.parseULong(),me.version){case 1:me.names=M.standardNames.slice();break;case 2:for(me.numberOfGlyphs=ie.parseUShort(),me.glyphNameIndex=new Array(me.numberOfGlyphs),ue=0;ue<me.numberOfGlyphs;ue++)me.glyphNameIndex[ue]=ie.parseUShort();for(me.names=[],ue=0;ue<me.numberOfGlyphs;ue++)if(me.glyphNameIndex[ue]>=M.standardNames.length){var W=ie.parseChar();me.names.push(ie.parseString(W))}break;case 2.5:for(me.numberOfGlyphs=ie.parseUShort(),me.offset=new Array(me.numberOfGlyphs),ue=0;ue<me.numberOfGlyphs;ue++)me.offset[ue]=ie.parseChar()}return me},G.make=function(){return new fe.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},{"../encoding":4,"../parse":10,"../table":13}],31:[function(B,D,G){function M(Te){return Math.log(Te)/Math.log(2)|0}function P(Te){for(;Te.length%4!=0;)Te.push(0);for(var qe=0,Ke=0;Ke<Te.length;Ke+=4)qe+=(Te[Ke]<<24)+(Te[Ke+1]<<16)+(Te[Ke+2]<<8)+Te[Ke+3];return qe%Math.pow(2,32)}function fe(Te,qe,Ke,vt){return new ie.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==Te?Te:""},{name:"checkSum",type:"ULONG",value:void 0!==qe?qe:0},{name:"offset",type:"ULONG",value:void 0!==Ke?Ke:0},{name:"length",type:"ULONG",value:void 0!==vt?vt:0}])}function ye(Te){var qe=new ie.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);qe.tables=Te,qe.numTables=Te.length;var Ke=Math.pow(2,M(qe.numTables));qe.searchRange=16*Ke,qe.entrySelector=M(Ke),qe.rangeShift=16*qe.numTables-qe.searchRange;for(var vt=[],ht=[],Bt=qe.sizeOf()+fe().sizeOf()*qe.numTables;Bt%4!=0;)Bt+=1,ht.push({name:"padding",type:"BYTE",value:0});for(var wt=0;wt<Te.length;wt+=1){var Ft=Te[wt];me.argument(4===Ft.tableName.length,"Table name"+Ft.tableName+" is invalid.");var Ot=Ft.sizeOf(),on=fe(Ft.tableName,P(Ft.encode()),Bt,Ot);for(vt.push({name:on.tag+" Table Record",type:"RECORD",value:on}),ht.push({name:Ft.tableName+" table",type:"RECORD",value:Ft}),Bt+=Ot,me.argument(!isNaN(Bt),"Something went wrong calculating the offset.");Bt%4!=0;)Bt+=1,ht.push({name:"padding",type:"BYTE",value:0})}return vt.sort(function(ft,An){return ft.value.tag>An.value.tag?1:-1}),qe.fields=qe.fields.concat(vt),qe.fields=qe.fields.concat(ht),qe}function ne(Te,qe,Ke){for(var vt=0;vt<qe.length;vt+=1){var ht=Te.charToGlyphIndex(qe[vt]);if(ht>0)return Te.glyphs.get(ht).getMetrics()}return Ke}function ue(Te){for(var qe=0,Ke=0;Ke<Te.length;Ke+=1)qe+=Te[Ke];return qe/Te.length}var me=B("../check"),ie=B("../table"),W=B("./cmap"),Q=B("./cff"),A=B("./head"),R=B("./hhea"),X=B("./hmtx"),he=B("./ltag"),z=B("./maxp"),Le=B("./name"),K=B("./os2"),be=B("./post"),Ne=B("./gsub"),je=B("./meta");G.computeCheckSum=P,G.make=ye,G.fontToTable=function(Te){for(var qe,Ke=[],vt=[],ht=[],Bt=[],wt=[],Ft=[],Ot=[],on=0,ft=0,An=0,Cn=0,fn=0,On=0;On<Te.glyphs.length;On+=1){var $n=Te.glyphs.get(On),_n=0|$n.unicode;if(isNaN($n.advanceWidth))throw new Error("Glyph "+$n.name+" ("+On+"): advanceWidth is not a number.");(qe>_n||void 0===qe)&&_n>0&&(qe=_n),_n>on&&(on=_n);var ar=K.getUnicodeRange(_n);if(32>ar)ft|=1<<ar;else if(64>ar)An|=1<<ar-32;else if(96>ar)Cn|=1<<ar-64;else{if(!(123>ar))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");fn|=1<<ar-96}if(".notdef"!==$n.name){var nr=$n.getMetrics();Ke.push(nr.xMin),vt.push(nr.yMin),ht.push(nr.xMax),Bt.push(nr.yMax),Ft.push(nr.leftSideBearing),Ot.push(nr.rightSideBearing),wt.push($n.advanceWidth)}}var lr={xMin:Math.min.apply(null,Ke),yMin:Math.min.apply(null,vt),xMax:Math.max.apply(null,ht),yMax:Math.max.apply(null,Bt),advanceWidthMax:Math.max.apply(null,wt),advanceWidthAvg:ue(wt),minLeftSideBearing:Math.min.apply(null,Ft),maxLeftSideBearing:Math.max.apply(null,Ft),minRightSideBearing:Math.min.apply(null,Ot)};lr.ascender=Te.ascender,lr.descender=Te.descender;var rr=A.make({flags:3,unitsPerEm:Te.unitsPerEm,xMin:lr.xMin,yMin:lr.yMin,xMax:lr.xMax,yMax:lr.yMax,lowestRecPPEM:3,createdTimestamp:Te.createdTimestamp}),ti=R.make({ascender:lr.ascender,descender:lr.descender,advanceWidthMax:lr.advanceWidthMax,minLeftSideBearing:lr.minLeftSideBearing,minRightSideBearing:lr.minRightSideBearing,xMaxExtent:lr.maxLeftSideBearing+(lr.xMax-lr.xMin),numberOfHMetrics:Te.glyphs.length}),Zr=z.make(Te.glyphs.length),pi=K.make({xAvgCharWidth:Math.round(lr.advanceWidthAvg),usWeightClass:Te.tables.os2.usWeightClass,usWidthClass:Te.tables.os2.usWidthClass,usFirstCharIndex:qe,usLastCharIndex:on,ulUnicodeRange1:ft,ulUnicodeRange2:An,ulUnicodeRange3:Cn,ulUnicodeRange4:fn,fsSelection:Te.tables.os2.fsSelection,sTypoAscender:lr.ascender,sTypoDescender:lr.descender,sTypoLineGap:0,usWinAscent:lr.yMax,usWinDescent:Math.abs(lr.yMin),ulCodePageRange1:1,sxHeight:ne(Te,"xyvw",{yMax:Math.round(lr.ascender/2)}).yMax,sCapHeight:ne(Te,"HIKLEFJMNTZBDPRAGOQSUVWXY",lr).yMax,usDefaultChar:Te.hasChar(" ")?32:0,usBreakChar:Te.hasChar(" ")?32:0}),tr=X.make(Te.glyphs),mr=W.make(Te.glyphs),mi=Te.getEnglishName("fontFamily"),xo=Te.getEnglishName("fontSubfamily"),Nr=mi+" "+xo,Qr=Te.getEnglishName("postScriptName");Qr||(Qr=mi.replace(/\s/g,"")+"-"+xo);var Vr={};for(var gi in Te.names)Vr[gi]=Te.names[gi];Vr.uniqueID||(Vr.uniqueID={en:Te.getEnglishName("manufacturer")+":"+Nr}),Vr.postScriptName||(Vr.postScriptName={en:Qr}),Vr.preferredFamily||(Vr.preferredFamily=Te.names.fontFamily),Vr.preferredSubfamily||(Vr.preferredSubfamily=Te.names.fontSubfamily);var Ti=[],$o=Le.make(Vr,Ti),Hs=Ti.length>0?he.make(Ti):void 0,ia=be.make(),Oi=Q.make(Te.glyphs,{version:Te.getEnglishName("version"),fullName:Nr,familyName:mi,weightName:xo,postScriptName:Qr,unitsPerEm:Te.unitsPerEm,fontBBox:[0,lr.yMin,lr.ascender,lr.advanceWidthMax]}),Co=Te.metas&&Object.keys(Te.metas).length>0?je.make(Te.metas):void 0,wo=[rr,ti,Zr,pi,$o,mr,ia,Oi,tr];Hs&&wo.push(Hs),Te.tables.gsub&&wo.push(Ne.make(Te.tables.gsub)),Co&&wo.push(Co);var Yr=ye(wo),os=P(Yr.encode()),Or=Yr.fields,Oa=!1;for(On=0;On<Or.length;On+=1)if("head table"===Or[On].name){Or[On].value.checkSumAdjustment=2981146554-os,Oa=!0;break}if(!Oa)throw new Error("Could not find head table with checkSum to adjust.");return Yr}},{"../check":2,"../table":13,"./cff":14,"./cmap":15,"./gsub":19,"./head":20,"./hhea":21,"./hmtx":22,"./ltag":25,"./maxp":26,"./meta":27,"./name":28,"./os2":29,"./post":30}],32:[function(B,D,G){function M(A){return function(){return A}}var P=B("./check"),fe=2147483648,ye={},ne={},ue={};ne.BYTE=function(A){return P.argument(A>=0&&255>=A,"Byte value should be between 0 and 255."),[A]},ue.BYTE=M(1),ne.CHAR=function(A){return[A.charCodeAt(0)]},ue.CHAR=M(1),ne.CHARARRAY=function(A){for(var R=[],X=0;X<A.length;X+=1)R[X]=A.charCodeAt(X);return R},ue.CHARARRAY=function(A){return A.length},ne.USHORT=function(A){return[A>>8&255,255&A]},ue.USHORT=M(2),ne.SHORT=function(A){return A>=32768&&(A=-(65536-A)),[A>>8&255,255&A]},ue.SHORT=M(2),ne.UINT24=function(A){return[A>>16&255,A>>8&255,255&A]},ue.UINT24=M(3),ne.ULONG=function(A){return[A>>24&255,A>>16&255,A>>8&255,255&A]},ue.ULONG=M(4),ne.LONG=function(A){return A>=fe&&(A=-(2*fe-A)),[A>>24&255,A>>16&255,A>>8&255,255&A]},ue.LONG=M(4),ne.FIXED=ne.ULONG,ue.FIXED=ue.ULONG,ne.FWORD=ne.SHORT,ue.FWORD=ue.SHORT,ne.UFWORD=ne.USHORT,ue.UFWORD=ue.USHORT,ne.LONGDATETIME=function(A){return[0,0,0,0,A>>24&255,A>>16&255,A>>8&255,255&A]},ue.LONGDATETIME=M(8),ne.TAG=function(A){return P.argument(4===A.length,"Tag should be exactly 4 ASCII characters."),[A.charCodeAt(0),A.charCodeAt(1),A.charCodeAt(2),A.charCodeAt(3)]},ue.TAG=M(4),ne.Card8=ne.BYTE,ue.Card8=ue.BYTE,ne.Card16=ne.USHORT,ue.Card16=ue.USHORT,ne.OffSize=ne.BYTE,ue.OffSize=ue.BYTE,ne.SID=ne.USHORT,ue.SID=ue.USHORT,ne.NUMBER=function(A){return A>=-107&&107>=A?[A+139]:A>=108&&1131>=A?[247+((A-=108)>>8),255&A]:A>=-1131&&-108>=A?[251+((A=-A-108)>>8),255&A]:A>=-32768&&32767>=A?ne.NUMBER16(A):ne.NUMBER32(A)},ue.NUMBER=function(A){return ne.NUMBER(A).length},ne.NUMBER16=function(A){return[28,A>>8&255,255&A]},ue.NUMBER16=M(3),ne.NUMBER32=function(A){return[29,A>>24&255,A>>16&255,A>>8&255,255&A]},ue.NUMBER32=M(5),ne.REAL=function(A){var R=A.toString(),X=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(R);if(X){var he=parseFloat("1e"+((X[2]?+X[2]:0)+X[1].length));R=(Math.round(A*he)/he).toString()}var z,Le,K="";for(z=0,Le=R.length;Le>z;z+=1){var be=R[z];K+="e"===be?"-"===R[++z]?"c":"b":"."===be?"a":"-"===be?"e":be}var Ne=[30];for(z=0,Le=(K+=1&K.length?"f":"ff").length;Le>z;z+=2)Ne.push(parseInt(K.substr(z,2),16));return Ne},ue.REAL=function(A){return ne.REAL(A).length},ne.NAME=ne.CHARARRAY,ue.NAME=ue.CHARARRAY,ne.STRING=ne.CHARARRAY,ue.STRING=ue.CHARARRAY,ye.UTF8=function(A,R,X){for(var he=[],z=X,Le=0;z>Le;Le++,R+=1)he[Le]=A.getUint8(R);return String.fromCharCode.apply(null,he)},ye.UTF16=function(A,R,X){for(var he=[],z=X/2,Le=0;z>Le;Le++,R+=2)he[Le]=A.getUint16(R);return String.fromCharCode.apply(null,he)},ne.UTF16=function(A){for(var R=[],X=0;X<A.length;X+=1){var he=A.charCodeAt(X);R[R.length]=he>>8&255,R[R.length]=255&he}return R},ue.UTF16=function(A){return 2*A.length};var me={"x-mac-croatian":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\u0160\u2122\xb4\xa8\u2260\u017d\xd8\u221e\xb1\u2264\u2265\u2206\xb5\u2202\u2211\u220f\u0161\u222b\xaa\xba\u03a9\u017e\xf8\xbf\xa1\xac\u221a\u0192\u2248\u0106\xab\u010c\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u0110\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\uf8ff\xa9\u2044\u20ac\u2039\u203a\xc6\xbb\u2013\xb7\u201a\u201e\u2030\xc2\u0107\xc1\u010d\xc8\xcd\xce\xcf\xcc\xd3\xd4\u0111\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u03c0\xcb\u02da\xb8\xca\xe6\u02c7","x-mac-cyrillic":"\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042a\u042b\u042c\u042d\u042e\u042f\u2020\xb0\u0490\xa3\xa7\u2022\xb6\u0406\xae\xa9\u2122\u0402\u0452\u2260\u0403\u0453\u221e\xb1\u2264\u2265\u0456\xb5\u0491\u0408\u0404\u0454\u0407\u0457\u0409\u0459\u040a\u045a\u0458\u0405\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\u040b\u045b\u040c\u045c\u0455\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u201e\u040e\u045e\u040f\u045f\u2116\u0401\u0451\u044f\u0430\u0431\u0432\u0433\u0434\u0435\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044a\u044b\u044c\u044d\u044e","x-mac-gaelic":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u1e02\xb1\u2264\u2265\u1e03\u010a\u010b\u1e0a\u1e0b\u1e1e\u1e1f\u0120\u0121\u1e40\xe6\xf8\u1e41\u1e56\u1e57\u027c\u0192\u017f\u1e60\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\u1e61\u1e9b\xff\u0178\u1e6a\u20ac\u2039\u203a\u0176\u0177\u1e6b\xb7\u1ef2\u1ef3\u204a\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\u2663\xd2\xda\xdb\xd9\u0131\xdd\xfd\u0174\u0175\u1e84\u1e85\u1e80\u1e81\u1e82\u1e83","x-mac-greek":"\xc4\xb9\xb2\xc9\xb3\xd6\xdc\u0385\xe0\xe2\xe4\u0384\xa8\xe7\xe9\xe8\xea\xeb\xa3\u2122\xee\xef\u2022\xbd\u2030\xf4\xf6\xa6\u20ac\xf9\xfb\xfc\u2020\u0393\u0394\u0398\u039b\u039e\u03a0\xdf\xae\xa9\u03a3\u03aa\xa7\u2260\xb0\xb7\u0391\xb1\u2264\u2265\xa5\u0392\u0395\u0396\u0397\u0399\u039a\u039c\u03a6\u03ab\u03a8\u03a9\u03ac\u039d\xac\u039f\u03a1\u2248\u03a4\xab\xbb\u2026\xa0\u03a5\u03a7\u0386\u0388\u0153\u2013\u2015\u201c\u201d\u2018\u2019\xf7\u0389\u038a\u038c\u038e\u03ad\u03ae\u03af\u03cc\u038f\u03cd\u03b1\u03b2\u03c8\u03b4\u03b5\u03c6\u03b3\u03b7\u03b9\u03be\u03ba\u03bb\u03bc\u03bd\u03bf\u03c0\u03ce\u03c1\u03c3\u03c4\u03b8\u03c9\u03c2\u03c7\u03c5\u03b6\u03ca\u03cb\u0390\u03b0\xad","x-mac-icelandic":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\xdd\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\xd0\xf0\xde\xfe\xfd\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-inuit":"\u1403\u1404\u1405\u1406\u140a\u140b\u1431\u1432\u1433\u1434\u1438\u1439\u1449\u144e\u144f\u1450\u1451\u1455\u1456\u1466\u146d\u146e\u146f\u1470\u1472\u1473\u1483\u148b\u148c\u148d\u148e\u1490\u1491\xb0\u14a1\u14a5\u14a6\u2022\xb6\u14a7\xae\xa9\u2122\u14a8\u14aa\u14ab\u14bb\u14c2\u14c3\u14c4\u14c5\u14c7\u14c8\u14d0\u14ef\u14f0\u14f1\u14f2\u14f4\u14f5\u1505\u14d5\u14d6\u14d7\u14d8\u14da\u14db\u14ea\u1528\u1529\u152a\u152b\u152d\u2026\xa0\u152e\u153e\u1555\u1556\u1557\u2013\u2014\u201c\u201d\u2018\u2019\u1558\u1559\u155a\u155d\u1546\u1547\u1548\u1549\u154b\u154c\u1550\u157f\u1580\u1581\u1582\u1583\u1584\u1585\u158f\u1590\u1591\u1592\u1593\u1594\u1595\u1671\u1672\u1673\u1674\u1675\u1676\u1596\u15a0\u15a1\u15a2\u15a3\u15a4\u15a5\u15a6\u157c\u0141\u0142","x-mac-ce":"\xc4\u0100\u0101\xc9\u0104\xd6\xdc\xe1\u0105\u010c\xe4\u010d\u0106\u0107\xe9\u0179\u017a\u010e\xed\u010f\u0112\u0113\u0116\xf3\u0117\xf4\xf6\xf5\xfa\u011a\u011b\xfc\u2020\xb0\u0118\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\u0119\xa8\u2260\u0123\u012e\u012f\u012a\u2264\u2265\u012b\u0136\u2202\u2211\u0142\u013b\u013c\u013d\u013e\u0139\u013a\u0145\u0146\u0143\xac\u221a\u0144\u0147\u2206\xab\xbb\u2026\xa0\u0148\u0150\xd5\u0151\u014c\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\u014d\u0154\u0155\u0158\u2039\u203a\u0159\u0156\u0157\u0160\u201a\u201e\u0161\u015a\u015b\xc1\u0164\u0165\xcd\u017d\u017e\u016a\xd3\xd4\u016b\u016e\xda\u016f\u0170\u0171\u0172\u0173\xdd\xfd\u0137\u017b\u0141\u017c\u0122\u02c7",macintosh:"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\u2039\u203a\ufb01\ufb02\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-romanian":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\u0102\u0218\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\u0103\u0219\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\u2039\u203a\u021a\u021b\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-turkish":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u011e\u011f\u0130\u0131\u015e\u015f\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\uf8a0\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7"};ye.MACSTRING=function(A,R,X,he){var z=me[he];if(void 0!==z){for(var Le="",K=0;X>K;K++){var be=A.getUint8(R+K);Le+=127>=be?String.fromCharCode(be):z[127&be]}return Le}};var ie,W="function"==typeof WeakMap&&new WeakMap;ne.MACSTRING=function(A,R){var X=function(K){if(!ie)for(var be in ie={},me)ie[be]=new String(be);var Ne=ie[K];if(void 0!==Ne){if(W){var je=W.get(Ne);if(void 0!==je)return je}var Te=me[K];if(void 0!==Te){for(var qe={},Ke=0;Ke<Te.length;Ke++)qe[Te.charCodeAt(Ke)]=Ke+128;return W&&W.set(Ne,qe),qe}}}(R);if(void 0!==X){for(var he=[],z=0;z<A.length;z++){var Le=A.charCodeAt(z);if(Le>=128&&void 0===(Le=X[Le]))return;he[z]=Le}return he}},ue.MACSTRING=function(A,R){var X=ne.MACSTRING(A,R);return void 0!==X?X.length:0},ne.INDEX=function(A){var R,X=1,he=[X],z=[];for(R=0;R<A.length;R+=1){var Le=ne.OBJECT(A[R]);Array.prototype.push.apply(z,Le),he.push(X+=Le.length)}if(0===z.length)return[0,0];var K=[],be=1+Math.floor(Math.log(X)/Math.log(2))/8|0,Ne=[void 0,ne.BYTE,ne.USHORT,ne.UINT24,ne.ULONG][be];for(R=0;R<he.length;R+=1){var je=Ne(he[R]);Array.prototype.push.apply(K,je)}return Array.prototype.concat(ne.Card16(A.length),ne.OffSize(be),K,z)},ue.INDEX=function(A){return ne.INDEX(A).length},ne.DICT=function(A){for(var R=[],X=Object.keys(A),he=X.length,z=0;he>z;z+=1){var Le=parseInt(X[z],0),K=A[Le];R=(R=R.concat(ne.OPERAND(K.value,K.type))).concat(ne.OPERATOR(Le))}return R},ue.DICT=function(A){return ne.DICT(A).length},ne.OPERATOR=function(A){return 1200>A?[A]:[12,A-1200]},ne.OPERAND=function(A,R){var X=[];if(Array.isArray(R))for(var he=0;he<R.length;he+=1)P.argument(A.length===R.length,"Not enough arguments given for type"+R),X=X.concat(ne.OPERAND(A[he],R[he]));else if("SID"===R)X=X.concat(ne.NUMBER(A));else if("offset"===R)X=X.concat(ne.NUMBER32(A));else if("number"===R)X=X.concat(ne.NUMBER(A));else{if("real"!==R)throw new Error("Unknown operand type "+R);X=X.concat(ne.REAL(A))}return X},ne.OP=ne.BYTE,ue.OP=ue.BYTE;var Q="function"==typeof WeakMap&&new WeakMap;ne.CHARSTRING=function(A){if(Q){var R=Q.get(A);if(void 0!==R)return R}for(var X=[],he=A.length,z=0;he>z;z+=1){var Le=A[z];X=X.concat(ne[Le.type](Le.value))}return Q&&Q.set(A,X),X},ue.CHARSTRING=function(A){return ne.CHARSTRING(A).length},ne.OBJECT=function(A){var R=ne[A.type];return P.argument(void 0!==R,"No encoding function for type "+A.type),R(A.value)},ue.OBJECT=function(A){var R=ue[A.type];return P.argument(void 0!==R,"No sizeOf function for type "+A.type),R(A.value)},ne.TABLE=function(A){var R,X=[],he=A.fields.length,z=[],Le=[];for(R=0;he>R;R+=1){var K=A.fields[R],be=ne[K.type];P.argument(void 0!==be,"No encoding function for field type "+K.type+" ("+K.name+")");var Ne=A[K.name];void 0===Ne&&(Ne=K.value);var je=be(Ne);"TABLE"===K.type?(Le.push(X.length),X=X.concat([0,0]),z.push(je)):X=X.concat(je)}for(R=0;R<z.length;R+=1){var Te=Le[R],qe=X.length;P.argument(65536>qe,"Table "+A.tableName+" too big."),X[Te]=qe>>8,X[Te+1]=255&qe,X=X.concat(z[R])}return X},ue.TABLE=function(A){for(var R=0,X=A.fields.length,he=0;X>he;he+=1){var z=A.fields[he],Le=ue[z.type];P.argument(void 0!==Le,"No sizeOf function for field type "+z.type+" ("+z.name+")");var K=A[z.name];void 0===K&&(K=z.value),R+=Le(K),"TABLE"===z.type&&(R+=2)}return R},ne.RECORD=ne.TABLE,ue.RECORD=ue.TABLE,ne.LITERAL=function(A){return A},ue.LITERAL=function(A){return A.length},G.decode=ye,G.encode=ne,G.sizeOf=ue},{"./check":2}],33:[function(B,D,G){G.isBrowser=function(){return typeof window<"u"},G.isNode=function(){return typeof window>"u"},G.nodeBufferToArrayBuffer=function(M){for(var P=new ArrayBuffer(M.length),fe=new Uint8Array(P),ye=0;ye<M.length;++ye)fe[ye]=M[ye];return P},G.arrayBufferToNodeBuffer=function(M){for(var P=new Buffer(M.byteLength),fe=new Uint8Array(M),ye=0;ye<P.length;++ye)P[ye]=fe[ye];return P},G.checkArgument=function(M,P){if(!M)throw P}},{}]},{},[9])(9)});var x=window.opentype},408:n=>{var o=/\n/,l=/\s/;function x(G,M,P,fe){var ye=G.indexOf(M,P);return-1===ye||ye>fe?fe:ye}function B(G){return l.test(G)}function D(G,M,P,fe){return{start:M,end:M+Math.min(fe,P-M)}}n.exports=function(G,M){return n.exports.lines(G,M).map(function(P){return G.substring(P.start,P.end)}).join("\n")},n.exports.lines=function(G,M){if(0===(M=M||{}).width&&"nowrap"!==M.mode)return[];G=G||"";var P="number"==typeof M.width?M.width:Number.MAX_VALUE,fe=Math.max(0,M.start||0),ye="number"==typeof M.end?M.end:G.length,ne=M.mode,ue=M.measure||D;return"pre"===ne?function(me,ie,W,Q,A){for(var R=[],X=W,he=W;he<Q&&he<ie.length;he++){var z=ie.charAt(he),Le=o.test(z);if(Le||he===Q-1){var K=me(ie,X,Le?he:he+1,A);R.push(K),X=he+1}}return R}(ue,G,fe,ye,P):function(me,ie,W,Q,A,R){var X=[],he=A;for("nowrap"===R&&(he=Number.MAX_VALUE);W<Q&&W<ie.length;){for(var z=x(ie,"\n",W,Q);W<z&&B(ie.charAt(W));)W++;var Le=me(ie,W,z,he),K=W+(Le.end-Le.start),be=K+1;if(K<z){for(;K>W&&!B(ie.charAt(K));)K--;if(K===W)be>W+1&&be--,K=be;else for(be=K;K>W&&B(ie.charAt(K-1));)K--}if(K>=W){var Ne=me(ie,W,K,he);X.push(Ne)}W=be}return X}(ue,G,fe,ye,P,ne)}},720:n=>{n.exports=function(){for(var l={},x=0;x<arguments.length;x++){var B=arguments[x];for(var D in B)o.call(B,D)&&(l[D]=B[D])}return l};var o=Object.prototype.hasOwnProperty},500:(n,o,l)=>{var x=l(412);x.KeyframeTrack.prototype.color="#FF0000",x.KeyframeTrack.prototype.setColor=function(B){this.color=B},x.KeyframeTrack.prototype.sort=function(){for(var B=0;B<this.times.length;B++)for(var D=B+1;D<this.times.length;D++)if(this.times[B]>this.times[D]){var G=this.times[D];this.times[D]=this.times[B],this.times[B]=G;for(var M=this.getValueSize(),P=D*M,fe=B*M,ye=0;ye<M;ye++)G=this.values[P+ye],this.values[P+ye]=this.values[fe+ye],this.values[fe+ye]=G}},x.KeyframeTrack._toJSON=x.KeyframeTrack.toJSON,x.KeyframeTrack.toJSON=function(B){var D=x.KeyframeTrack._toJSON.call(this,B);return D.color=B.color,D},x.KeyframeTrack._parse=x.KeyframeTrack.parse,x.KeyframeTrack.parse=function(B){var D=x.KeyframeTrack._parse.call(this,B);return void 0!==B.color&&(D.color=B.color),D}},10:(n,o,l)=>{l(412).Camera.prototype.render=function(x,B){x.render(B,this)}},939:(n,o,l)=>{l(412).BufferAttribute.prototype.toJSON=function(){return{type:"BufferAttribute",typedArray:{type:this.array.constructor.name,array:Array.prototype.slice.call(this.array)},itemSize:this.itemSize,normalized:this.normalized}}},12:(n,o,l)=>{l(412).InterleavedBuffer.prototype.toJSON=function(){return{typedArray:{type:this.array.constructor.name,array:Array.prototype.slice.call(this.array)},stride:this.stride,count:this.count,usage:this.usage}}},443:(n,o,l)=>{l(412).InterleavedBufferAttribute.prototype.toJSON=function(){return{type:"InterleavedBufferAttribute",data:this.data.toJSON(),itemSize:this.itemSize,offset:this.offset,normalized:this.normalized}}},870:(n,o,l)=>{var x=l(412);x.LightShadow.prototype.toJSON=function(){var B={};return B.bias=this.bias,B.radius=this.radius,B.mapSize={x:this.mapSize.x,y:this.mapSize.y},B.camera={top:this.camera.top,bottom:this.camera.bottom,far:this.camera.far,near:this.camera.near,left:this.camera.left,right:this.camera.right},B},x.LightShadow.prototype.fromJSON=function(B){if(void 0!==B.bias&&(this.bias=B.bias),void 0!==B.radius&&(this.radius=B.radius),void 0!==B.mapSize){var D=B.mapSize;this.mapSize.set(D.x,D.y)}if(void 0!==B.camera){var G=B.camera;this.camera.top=G.top,this.camera.bottom=G.bottom,this.camera.left=G.left,this.camera.right=G.right,this.camera.near=G.near,this.camera.far=G.far}}},819:(n,o,l)=>{var x=l(412);x.Fog.NONE=0,x.Fog.LINEAR=1,x.Fog.EXPONENTIAL=2}},__webpack_module_cache__={};function __webpack_require__(n){var o=__webpack_module_cache__[n];if(void 0!==o)return o.exports;var l=__webpack_module_cache__[n]={id:n,loaded:!1,exports:{}};return __webpack_modules__[n].call(l.exports,l,l.exports,__webpack_require__),l.loaded=!0,l.exports}__webpack_require__.amdO={},__webpack_require__.n=n=>{var o=n&&n.__esModule?()=>n.default:()=>n;return __webpack_require__.d(o,{a:o}),o},__webpack_require__.d=(n,o)=>{for(var l in o)__webpack_require__.o(o,l)&&!__webpack_require__.o(n,l)&&Object.defineProperty(n,l,{enumerable:!0,get:o[l]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch{if("object"==typeof window)return window}}(),__webpack_require__.hmd=n=>((n=Object.create(n)).children||(n.children=[]),Object.defineProperty(n,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+n.id)}}),n),__webpack_require__.o=(n,o)=>Object.prototype.hasOwnProperty.call(n,o),__webpack_require__.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ARHandler:()=>Ro,AdaptiveToneMappingPass:()=>Jc,AfterimagePass:()=>ui,AmbientLight:()=>Cs,AnimationMixer:()=>iu,AnimationTimer:()=>Md,App:()=>ns,ArraybufferUtils:()=>pa,Audio:()=>Nt,AudioEmitter:()=>ri,AudioLoader:()=>Mh,Base64Utils:()=>ci,BloomPass:()=>Dr,BokehPass:()=>Ha,BufferUtils:()=>ja,CSS3DObject:()=>hl,CSS3DRenderer:()=>Ks,CSS3DSprite:()=>oc,CanvasSprite:()=>tu,CanvasTexture:()=>rc,CapsuleBufferGeometry:()=>Lc,ColorifyPass:()=>Cp,CompressedTexture:()=>Bc,CopyPass:()=>Yc,CubeCamera:()=>gr,CubeTexture:()=>Sr,DataTexture:()=>La,DirectionalLight:()=>ll,DotScreenPass:()=>Mc,EffectComposer:()=>Bo,EventManager:()=>pn,FXAAPass:()=>qp,FileSystem:()=>Bn,FilmPass:()=>ul,FirstPersonControls:()=>Zc,Font:()=>Xe,FontLoader:()=>ih,Gamepad:()=>Xr,GeometryLoader:()=>Lu,Group:()=>wu,Gyroscope:()=>Ru,HTMLView:()=>Ql,HemisphereLight:()=>Su,HueSaturationPass:()=>Fo,Image:()=>ys,ImageLoader:()=>Cu,InstancedMesh:()=>as,Key:()=>li,Keyboard:()=>Wn,LegacyGeometryLoader:()=>Ds,LensFlare:()=>Ma,LightProbe:()=>Qc,LocalStorage:()=>Pc,MaterialLoader:()=>$u,MathUtils:()=>qc,Mesh:()=>eh,Model:()=>yt,Mouse:()=>Jr,NodeScript:()=>hi,Nunu:()=>vo,ObjectLoader:()=>Zi,ObjectUtils:()=>Za,OrbitControls:()=>Aa,OrthographicCamera:()=>ts,ParametricBufferGeometry:()=>Th,ParticleEmitter:()=>to,ParticleEmitterControl:()=>Ui,ParticleGroup:()=>xs,ParticleShaders:()=>ic,Pass:()=>ur,PerspectiveCamera:()=>Ie,PhysicsGenerator:()=>Si,PhysicsObject:()=>Ue,PointLight:()=>Ge,PositionalAudio:()=>qt,Program:()=>ii,RectAreaLight:()=>Pn,RenderPass:()=>cl,RendererConfiguration:()=>Nu,RendererState:()=>Jh,Resource:()=>xi,ResourceContainer:()=>B,ResourceManager:()=>Mo,RoundedBoxBufferGeometry:()=>nu,SSAONOHPass:()=>Ai,SSAOPass:()=>ko,SSAOShader:()=>Bs,Scene:()=>Po,Script:()=>En,ShaderAttribute:()=>wi,ShaderPass:()=>Yo,ShaderUtils:()=>zt,SkinnedMesh:()=>Gn,Sky:()=>$r,SobelPass:()=>Rs,SpineAnimation:()=>Js,SpineTexture:()=>rh,SpotLight:()=>Di,Sprite:()=>nc,SpriteSheetTexture:()=>Xa,TargetConfig:()=>Qs,TechnicolorPass:()=>Xc,TerrainBufferGeometry:()=>Ol,TextBitmap:()=>Do,TextFile:()=>Il,TextMesh:()=>fa,TextSprite:()=>qa,Texture:()=>bs,TextureLoader:()=>dl,Timer:()=>Ul,TizenKeyboard:()=>Cr,TwistModifier:()=>Ah,TypedArrayHelper:()=>Go,UnitConverter:()=>yr,UnrealBloomPass:()=>Ls,VRHandler:()=>$i,Video:()=>kl,VideoLoader:()=>Bu,VideoStream:()=>np,VideoTexture:()=>Ps,Viewport:()=>io,WebcamTexture:()=>Zs,WorkerPool:()=>Dl,WorkerTask:()=>Rc});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{AABB:()=>ne,ArrayCollisionMatrix:()=>ie,BODY_SLEEP_STATES:()=>vt,BODY_TYPES:()=>Ke,Body:()=>ht,Box:()=>je,Broadphase:()=>nr,COLLISION_TYPES:()=>Gi,ConeTwistConstraint:()=>Fu,Constraint:()=>uu,ContactEquation:()=>Lo,ContactMaterial:()=>Uu,ConvexPolyhedron:()=>K,Cylinder:()=>Yt,DistanceConstraint:()=>gs,Equation:()=>Ts,EventTarget:()=>W,FrictionEquation:()=>uc,GSSolver:()=>_u,GridBroadphase:()=>pi,Heightfield:()=>wn,HingeConstraint:()=>mp,JacobianElement:()=>hu,LockConstraint:()=>Gl,Mat3:()=>G,Material:()=>zu,NaiveBroadphase:()=>mr,Narrowphase:()=>kr,ObjectCollisionMatrix:()=>D,Particle:()=>dn,Plane:()=>kn,PointToPointConstraint:()=>cc,Pool:()=>gu,Quaternion:()=>Q,RAY_MODES:()=>xo,Ray:()=>Nr,RaycastResult:()=>mi,RaycastVehicle:()=>Uh,RigidVehicle:()=>qu,RotationalEquation:()=>yl,RotationalMotorEquation:()=>Du,SAPBroadphase:()=>ms,SHAPE_TYPES:()=>X,SPHSystem:()=>pe,Shape:()=>he,Solver:()=>So,Sphere:()=>mc,SplitSolver:()=>Ms,Spring:()=>tl,Transform:()=>z,Trimesh:()=>il,Vec3:()=>M,Vec3Pool:()=>Tp,World:()=>Dn});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{ARHandler:()=>Ro,AdaptiveToneMappingPass:()=>Jc,AfterimagePass:()=>ui,AmbientLight:()=>Cs,AnimationMixer:()=>iu,AnimationTimer:()=>Md,App:()=>ns,ArraybufferUtils:()=>pa,Audio:()=>Nt,AudioEmitter:()=>ri,AudioLoader:()=>Mh,Base64Utils:()=>ci,BloomPass:()=>Dr,BokehPass:()=>Ha,BufferUtils:()=>ja,CSS3DObject:()=>hl,CSS3DRenderer:()=>Ks,CSS3DSprite:()=>oc,CanvasSprite:()=>tu,CanvasTexture:()=>rc,CapsuleBufferGeometry:()=>Lc,ColorifyPass:()=>Cp,CompressedTexture:()=>Bc,CopyPass:()=>Yc,CubeCamera:()=>gr,CubeTexture:()=>Sr,DataTexture:()=>La,DirectionalLight:()=>ll,DotScreenPass:()=>Mc,EffectComposer:()=>Bo,EventManager:()=>pn,FXAAPass:()=>qp,FileSystem:()=>Bn,FilmPass:()=>ul,FirstPersonControls:()=>Zc,Font:()=>Xe,FontLoader:()=>ih,Gamepad:()=>Xr,GeometryLoader:()=>Lu,Group:()=>wu,Gyroscope:()=>Ru,HTMLView:()=>Ql,HemisphereLight:()=>Su,HueSaturationPass:()=>Fo,Image:()=>ys,ImageLoader:()=>Cu,InstancedMesh:()=>as,Key:()=>li,Keyboard:()=>Wn,LegacyGeometryLoader:()=>Ds,LensFlare:()=>Ma,LightProbe:()=>Qc,LocalStorage:()=>Pc,MaterialLoader:()=>$u,MathUtils:()=>qc,Mesh:()=>eh,Model:()=>yt,Mouse:()=>Jr,NodeScript:()=>hi,Nunu:()=>vo,ObjectLoader:()=>Zi,ObjectUtils:()=>Za,OrbitControls:()=>Aa,OrthographicCamera:()=>ts,ParametricBufferGeometry:()=>Th,ParticleEmitter:()=>to,ParticleEmitterControl:()=>Ui,ParticleGroup:()=>xs,ParticleShaders:()=>ic,Pass:()=>ur,PerspectiveCamera:()=>Ie,PhysicsGenerator:()=>Si,PhysicsObject:()=>Ue,PointLight:()=>Ge,PositionalAudio:()=>qt,Program:()=>ii,RectAreaLight:()=>Pn,RenderPass:()=>cl,RendererConfiguration:()=>Nu,RendererState:()=>Jh,Resource:()=>xi,ResourceContainer:()=>B,ResourceManager:()=>Mo,RoundedBoxBufferGeometry:()=>nu,SSAONOHPass:()=>Ai,SSAOPass:()=>ko,SSAOShader:()=>Bs,Scene:()=>Po,Script:()=>En,ShaderAttribute:()=>wi,ShaderPass:()=>Yo,ShaderUtils:()=>zt,SkinnedMesh:()=>Gn,Sky:()=>$r,SobelPass:()=>Rs,SpineAnimation:()=>Js,SpineTexture:()=>rh,SpotLight:()=>Di,Sprite:()=>nc,SpriteSheetTexture:()=>Xa,TargetConfig:()=>Qs,TechnicolorPass:()=>Xc,TerrainBufferGeometry:()=>Ol,TextBitmap:()=>Do,TextFile:()=>Il,TextMesh:()=>fa,TextSprite:()=>qa,Texture:()=>bs,TextureLoader:()=>dl,Timer:()=>Ul,TizenKeyboard:()=>Cr,TwistModifier:()=>Ah,TypedArrayHelper:()=>Go,UnitConverter:()=>yr,UnrealBloomPass:()=>Ls,VRHandler:()=>$i,Video:()=>kl,VideoLoader:()=>Bu,VideoStream:()=>np,VideoTexture:()=>Ps,Viewport:()=>io,WebcamTexture:()=>Zs,WorkerPool:()=>Dl,WorkerTask:()=>Rc});var l=__webpack_require__(412),x=__webpack_require__(412);function B(){this.images=[],this.videos=[],this.audio=[],this.fonts=[],this.materials=[],this.textures=[],this.geometries=[],this.resources=[],this.shapes=[],this.skeletons=[]}x.AnimationClip.prototype.enabled=!0,x.AnimationClip.prototype.loop=l.LoopRepeat,x.AnimationClip.prototype.timeScale=1,x.AnimationClip.prototype.weight=1,x.AnimationClip._toJSON=x.AnimationClip.toJSON,x.AnimationClip.toJSON=function(a){var r=x.AnimationClip._toJSON.call(this,a);return r.enabled=a.enabled,r.loop=a.loop,r.timeScale=a.timeScale,r.weight=a.weight,r},x.AnimationClip._parse=x.AnimationClip.parse,x.AnimationClip.parse=function(a){var r=x.AnimationClip._parse.call(this,a);return void 0!==a.enabled&&(r.enabled=a.enabled,r.loop=a.loop,r.timeScale=a.timeScale,r.weight=a.weight),r},__webpack_require__(500),__webpack_require__(10),__webpack_require__(939),__webpack_require__(412).InstancedBufferAttribute.prototype.toJSON=function(){var a=l.BufferAttribute.prototype.toJSON.call(this);return a.type="InstancedBufferAttribute",a.meshPerAttribute=this.meshPerAttribute,a},__webpack_require__(12),__webpack_require__(443),B.libraries=["images","videos","audio","fonts","materials","textures","geometries","resources","shapes","skeletons"],B.prototype.copyResources=function(a){this.materials=a.materials,this.textures=a.textures,this.resources=a.resources,this.fonts=a.fonts,this.audio=a.audio,this.geometries=a.geometries,this.images=a.images,this.videos=a.videos,this.shapes=a.shapes,this.skeletons=a.skeletons},B.prototype.getTexture=function(a){return void 0===this.textures[a]&&console.warn("nunuStudio: ResourceContainer, Undefined texture",a),this.textures[a]},B.prototype.getGeometry=function(a){return void 0===this.geometries[a]&&console.warn("nunuStudio: ResourceContainer, Undefined geometry",a),this.geometries[a]},B.prototype.getMaterial=function(a){if(a instanceof Array){for(var r=[],h=0;h<a.length;h++)void 0===this.materials[a[h]]&&console.warn("nunuStudio: ResourceContainer, Undefined material",a),r.push(this.materials[a[h]]);return r}return void 0===this.materials[a]&&console.warn("nunuStudio: ResourceContainer, Undefined material",a),this.materials[a]},B.prototype.getFont=function(a){return void 0===this.fonts[a]&&console.warn("nunuStudio: ResourceContainer, Undefined font",a),this.fonts[a]},B.prototype.getAudio=function(a){return void 0===this.audio[a]&&console.warn("nunuStudio: ResourceContainer, Undefined audio",a),this.audio[a]};class D{constructor(){this.matrix={}}get(r,h){let{id:d}=r,{id:y}=h;if(y>d){const b=y;y=d,d=b}return d+"-"+y in this.matrix}set(r,h,d){let{id:y}=r,{id:b}=h;if(b>y){const N=b;b=y,y=N}d?this.matrix[y+"-"+b]=!0:delete this.matrix[y+"-"+b]}reset(){this.matrix={}}setNumObjects(r){}}class G{constructor(r=[0,0,0,0,0,0,0,0,0]){this.elements=r}identity(){const r=this.elements;r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1}setZero(){const r=this.elements;r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r[8]=0}setTrace(r){const h=this.elements;h[0]=r.x,h[4]=r.y,h[8]=r.z}getTrace(r=new M){const h=this.elements;r.x=h[0],r.y=h[4],r.z=h[8]}vmult(r,h=new M){const d=this.elements,y=r.x,b=r.y,N=r.z;return h.x=d[0]*y+d[1]*b+d[2]*N,h.y=d[3]*y+d[4]*b+d[5]*N,h.z=d[6]*y+d[7]*b+d[8]*N,h}smult(r){for(let h=0;h<this.elements.length;h++)this.elements[h]*=r}mmult(r,h=new G){const{elements:d}=r;for(let y=0;y<3;y++)for(let b=0;b<3;b++){let N=0;for(let k=0;k<3;k++)N+=d[y+3*k]*this.elements[k+3*b];h.elements[y+3*b]=N}return h}scale(r,h=new G){const d=this.elements,y=h.elements;for(let b=0;3!==b;b++)y[3*b+0]=r.x*d[3*b+0],y[3*b+1]=r.y*d[3*b+1],y[3*b+2]=r.z*d[3*b+2];return h}solve(r,h=new M){const d=[];let y,b;for(y=0;y<12;y++)d.push(0);for(y=0;y<3;y++)for(b=0;b<3;b++)d[y+4*b]=this.elements[y+3*b];d[3]=r.x,d[7]=r.y,d[11]=r.z;let N=3;const k=N;let T,H;do{if(y=k-N,0===d[y+4*y])for(b=y+1;b<k;b++)if(0!==d[y+4*b]){T=4;do{H=4-T,d[H+4*y]+=d[H+4*b]}while(--T);break}if(0!==d[y+4*y])for(b=y+1;b<k;b++){const Y=d[y+4*b]/d[y+4*y];T=4;do{H=4-T,d[H+4*b]=H<=y?0:d[H+4*b]-d[H+4*y]*Y}while(--T)}}while(--N);if(h.z=d[11]/d[10],h.y=(d[7]-d[6]*h.z)/d[5],h.x=(d[3]-d[2]*h.z-d[1]*h.y)/d[0],isNaN(h.x)||isNaN(h.y)||isNaN(h.z)||h.x===1/0||h.y===1/0||h.z===1/0)throw"Could not solve equation! Got x=["+h.toString()+"], b=["+r.toString()+"], A=["+this.toString()+"]";return h}e(r,h,d){if(void 0===d)return this.elements[h+3*r];this.elements[h+3*r]=d}copy(r){for(let h=0;h<r.elements.length;h++)this.elements[h]=r.elements[h];return this}toString(){let r="";for(let h=0;h<9;h++)r+=this.elements[h]+",";return r}reverse(r=new G){const h=[];let d,y;for(d=0;d<18;d++)h.push(0);for(d=0;d<3;d++)for(y=0;y<3;y++)h[d+6*y]=this.elements[d+3*y];h[3]=1,h[9]=0,h[15]=0,h[4]=0,h[10]=1,h[16]=0,h[5]=0,h[11]=0,h[17]=1;let b=3;const N=b;let k,T;do{if(d=N-b,0===h[d+6*d])for(y=d+1;y<N;y++)if(0!==h[d+6*y]){k=6;do{T=6-k,h[T+6*d]+=h[T+6*y]}while(--k);break}if(0!==h[d+6*d])for(y=d+1;y<N;y++){const H=h[d+6*y]/h[d+6*d];k=6;do{T=6-k,h[T+6*y]=T<=d?0:h[T+6*y]-h[T+6*d]*H}while(--k)}}while(--b);d=2;do{y=d-1;do{const H=h[d+6*y]/h[d+6*d];k=6;do{T=6-k,h[T+6*y]=h[T+6*y]-h[T+6*d]*H}while(--k)}while(y--)}while(--d);d=2;do{const H=1/h[d+6*d];k=6;do{T=6-k,h[T+6*d]=h[T+6*d]*H}while(--k)}while(d--);d=2;do{y=2;do{if(T=h[3+y+6*d],isNaN(T)||T===1/0)throw"Could not reverse! A=["+this.toString()+"]";r.e(d,y,T)}while(y--)}while(d--);return r}setRotationFromQuaternion(r){const h=r.x,d=r.y,y=r.z,b=r.w,N=h+h,k=d+d,T=y+y,H=h*N,Y=h*k,le=h*T,ae=d*k,ge=d*T,we=y*T,Se=b*N,$e=b*k,Re=b*T,Pe=this.elements;return Pe[0]=1-(ae+we),Pe[1]=Y-Re,Pe[2]=le+$e,Pe[3]=Y+Re,Pe[4]=1-(H+we),Pe[5]=ge-Se,Pe[6]=le-$e,Pe[7]=ge+Se,Pe[8]=1-(H+ae),this}transpose(r=new G){const h=r.elements,d=this.elements;for(let y=0;3!==y;y++)for(let b=0;3!==b;b++)h[3*y+b]=d[3*b+y];return r}}class M{constructor(r=0,h=0,d=0){this.x=r,this.y=h,this.z=d}cross(r,h=new M){const d=r.x,y=r.y,b=r.z,N=this.x,k=this.y,T=this.z;return h.x=k*b-T*y,h.y=T*d-N*b,h.z=N*y-k*d,h}set(r,h,d){return this.x=r,this.y=h,this.z=d,this}setZero(){this.x=this.y=this.z=0}vadd(r,h){if(!h)return new M(this.x+r.x,this.y+r.y,this.z+r.z);h.x=r.x+this.x,h.y=r.y+this.y,h.z=r.z+this.z}vsub(r,h){if(!h)return new M(this.x-r.x,this.y-r.y,this.z-r.z);h.x=this.x-r.x,h.y=this.y-r.y,h.z=this.z-r.z}crossmat(){return new G([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const r=this.x,h=this.y,d=this.z,y=Math.sqrt(r*r+h*h+d*d);if(y>0){const b=1/y;this.x*=b,this.y*=b,this.z*=b}else this.x=0,this.y=0,this.z=0;return y}unit(r=new M){const h=this.x,d=this.y,y=this.z;let b=Math.sqrt(h*h+d*d+y*y);return b>0?(b=1/b,r.x=h*b,r.y=d*b,r.z=y*b):(r.x=1,r.y=0,r.z=0),r}length(){const r=this.x,h=this.y,d=this.z;return Math.sqrt(r*r+h*h+d*d)}lengthSquared(){return this.dot(this)}distanceTo(r){const h=this.x,d=this.y,y=this.z,b=r.x,N=r.y,k=r.z;return Math.sqrt((b-h)*(b-h)+(N-d)*(N-d)+(k-y)*(k-y))}distanceSquared(r){const h=this.x,d=this.y,y=this.z,b=r.x,N=r.y,k=r.z;return(b-h)*(b-h)+(N-d)*(N-d)+(k-y)*(k-y)}scale(r,h=new M){const y=this.y,b=this.z;return h.x=r*this.x,h.y=r*y,h.z=r*b,h}vmul(r,h=new M){return h.x=r.x*this.x,h.y=r.y*this.y,h.z=r.z*this.z,h}addScaledVector(r,h,d=new M){return d.x=this.x+r*h.x,d.y=this.y+r*h.y,d.z=this.z+r*h.z,d}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(r=new M){return r.x=-this.x,r.y=-this.y,r.z=-this.z,r}tangents(r,h){const d=this.length();if(d>0){const y=P,b=1/d;y.set(this.x*b,this.y*b,this.z*b);const N=fe;Math.abs(y.x)<.9?(N.set(1,0,0),y.cross(N,r)):(N.set(0,1,0),y.cross(N,r)),y.cross(r,h)}else r.set(1,0,0),h.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this}lerp(r,h,d){const y=this.x,b=this.y,N=this.z;d.x=y+(r.x-y)*h,d.y=b+(r.y-b)*h,d.z=N+(r.z-N)*h}almostEquals(r,h=1e-6){return!(Math.abs(this.x-r.x)>h||Math.abs(this.y-r.y)>h||Math.abs(this.z-r.z)>h)}almostZero(r=1e-6){return!(Math.abs(this.x)>r||Math.abs(this.y)>r||Math.abs(this.z)>r)}isAntiparallelTo(r,h){return this.negate(ye),ye.almostEquals(r,h)}clone(){return new M(this.x,this.y,this.z)}}M.ZERO=new M(0,0,0),M.UNIT_X=new M(1,0,0),M.UNIT_Y=new M(0,1,0),M.UNIT_Z=new M(0,0,1);const P=new M,fe=new M,ye=new M;class ne{constructor(r={}){this.lowerBound=new M,this.upperBound=new M,r.lowerBound&&this.lowerBound.copy(r.lowerBound),r.upperBound&&this.upperBound.copy(r.upperBound)}setFromPoints(r,h,d,y){const b=this.lowerBound,N=this.upperBound,k=d;b.copy(r[0]),k&&k.vmult(b,b),N.copy(b);for(let T=1;T<r.length;T++){let H=r[T];k&&(k.vmult(H,ue),H=ue),H.x>N.x&&(N.x=H.x),H.x<b.x&&(b.x=H.x),H.y>N.y&&(N.y=H.y),H.y<b.y&&(b.y=H.y),H.z>N.z&&(N.z=H.z),H.z<b.z&&(b.z=H.z)}return h&&(h.vadd(b,b),h.vadd(N,N)),y&&(b.x-=y,b.y-=y,b.z-=y,N.x+=y,N.y+=y,N.z+=y),this}copy(r){return this.lowerBound.copy(r.lowerBound),this.upperBound.copy(r.upperBound),this}clone(){return(new ne).copy(this)}extend(r){this.lowerBound.x=Math.min(this.lowerBound.x,r.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,r.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,r.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,r.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,r.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,r.upperBound.z)}overlaps(r){const h=this.lowerBound,d=this.upperBound,y=r.lowerBound,b=r.upperBound;return(y.x<=d.x&&d.x<=b.x||h.x<=b.x&&b.x<=d.x)&&(y.y<=d.y&&d.y<=b.y||h.y<=b.y&&b.y<=d.y)&&(y.z<=d.z&&d.z<=b.z||h.z<=b.z&&b.z<=d.z)}volume(){const r=this.lowerBound,h=this.upperBound;return(h.x-r.x)*(h.y-r.y)*(h.z-r.z)}contains(r){const h=this.lowerBound,d=this.upperBound,y=r.lowerBound,b=r.upperBound;return h.x<=y.x&&d.x>=b.x&&h.y<=y.y&&d.y>=b.y&&h.z<=y.z&&d.z>=b.z}getCorners(r,h,d,y,b,N,k,T){const H=this.lowerBound,Y=this.upperBound;r.copy(H),h.set(Y.x,H.y,H.z),d.set(Y.x,Y.y,H.z),y.set(H.x,Y.y,Y.z),b.set(Y.x,H.y,Y.z),N.set(H.x,Y.y,H.z),k.set(H.x,H.y,Y.z),T.copy(Y)}toLocalFrame(r,h){const d=me;this.getCorners(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7]);for(let ae=0;8!==ae;ae++){const ge=d[ae];r.pointToLocal(ge,ge)}return h.setFromPoints(d)}toWorldFrame(r,h){const d=me;this.getCorners(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7]);for(let ae=0;8!==ae;ae++){const ge=d[ae];r.pointToWorld(ge,ge)}return h.setFromPoints(d)}overlapsRay(r){const{direction:h,from:d}=r,y=1/h.x,b=1/h.y,N=1/h.z,k=(this.lowerBound.x-d.x)*y,T=(this.upperBound.x-d.x)*y,H=(this.lowerBound.y-d.y)*b,Y=(this.upperBound.y-d.y)*b,le=(this.lowerBound.z-d.z)*N,ae=(this.upperBound.z-d.z)*N,ge=Math.max(Math.max(Math.min(k,T),Math.min(H,Y)),Math.min(le,ae)),we=Math.min(Math.min(Math.max(k,T),Math.max(H,Y)),Math.max(le,ae));return!(we<0||ge>we)}}const ue=new M,me=[new M,new M,new M,new M,new M,new M,new M,new M];class ie{constructor(){this.matrix=[]}get(r,h){let{index:d}=r,{index:y}=h;if(y>d){const b=y;y=d,d=b}return this.matrix[(d*(d+1)>>1)+y-1]}set(r,h,d){let{index:y}=r,{index:b}=h;if(b>y){const N=b;b=y,y=N}this.matrix[(y*(y+1)>>1)+b-1]=d?1:0}reset(){for(let r=0,h=this.matrix.length;r!==h;r++)this.matrix[r]=0}setNumObjects(r){this.matrix.length=r*(r-1)>>1}}class W{constructor(){}addEventListener(r,h){void 0===this._listeners&&(this._listeners={});const d=this._listeners;return void 0===d[r]&&(d[r]=[]),d[r].includes(h)||d[r].push(h),this}hasEventListener(r,h){if(void 0===this._listeners)return!1;const d=this._listeners;return!(void 0===d[r]||!d[r].includes(h))}hasAnyEventListener(r){return void 0!==this._listeners&&void 0!==this._listeners[r]}removeEventListener(r,h){if(void 0===this._listeners)return this;const d=this._listeners;if(void 0===d[r])return this;const y=d[r].indexOf(h);return-1!==y&&d[r].splice(y,1),this}dispatchEvent(r){if(void 0===this._listeners)return this;const h=this._listeners[r.type];if(void 0!==h){r.target=this;for(let d=0,y=h.length;d<y;d++)h[d].call(this,r)}return this}}class Q{constructor(r=0,h=0,d=0,y=1){this.x=r,this.y=h,this.z=d,this.w=y}set(r,h,d,y){return this.x=r,this.y=h,this.z=d,this.w=y,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(r,h){const d=Math.sin(.5*h);return this.x=r.x*d,this.y=r.y*d,this.z=r.z*d,this.w=Math.cos(.5*h),this}toAxisAngle(r=new M){this.normalize();const h=2*Math.acos(this.w),d=Math.sqrt(1-this.w*this.w);return d<.001?(r.x=this.x,r.y=this.y,r.z=this.z):(r.x=this.x/d,r.y=this.y/d,r.z=this.z/d),[r,h]}setFromVectors(r,h){if(r.isAntiparallelTo(h)){const d=A;r.tangents(d,R),this.setFromAxisAngle(d,Math.PI)}else{const d=r.cross(h);this.x=d.x,this.y=d.y,this.z=d.z,this.w=Math.sqrt(r.length()**2*h.length()**2)+r.dot(h),this.normalize()}return this}mult(r,h=new Q){const d=this.x,y=this.y,b=this.z,N=this.w,k=r.x,T=r.y,H=r.z,Y=r.w;return h.x=d*Y+N*k+y*H-b*T,h.y=y*Y+N*T+b*k-d*H,h.z=b*Y+N*H+d*T-y*k,h.w=N*Y-d*k-y*T-b*H,h}inverse(r=new Q){const h=this.x,d=this.y,y=this.z,b=this.w;this.conjugate(r);const N=1/(h*h+d*d+y*y+b*b);return r.x*=N,r.y*=N,r.z*=N,r.w*=N,r}conjugate(r=new Q){return r.x=-this.x,r.y=-this.y,r.z=-this.z,r.w=this.w,r}normalize(){let r=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===r?(this.x=0,this.y=0,this.z=0,this.w=0):(r=1/r,this.x*=r,this.y*=r,this.z*=r,this.w*=r),this}normalizeFast(){const r=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===r?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=r,this.y*=r,this.z*=r,this.w*=r),this}vmult(r,h=new M){const d=r.x,y=r.y,b=r.z,N=this.x,k=this.y,T=this.z,H=this.w,Y=H*d+k*b-T*y,le=H*y+T*d-N*b,ae=H*b+N*y-k*d,ge=-N*d-k*y-T*b;return h.x=Y*H+ge*-N+le*-T-ae*-k,h.y=le*H+ge*-k+ae*-N-Y*-T,h.z=ae*H+ge*-T+Y*-k-le*-N,h}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w,this}toEuler(r,h="YZX"){let d,y,b;const N=this.x,k=this.y,T=this.z,H=this.w;if("YZX"!==h)throw new Error("Euler order "+h+" not supported yet.");{const Y=N*k+T*H;if(Y>.499&&(d=2*Math.atan2(N,H),y=Math.PI/2,b=0),Y<-.499&&(d=-2*Math.atan2(N,H),y=-Math.PI/2,b=0),void 0===d){const le=N*N,ge=T*T;d=Math.atan2(2*k*H-2*N*T,1-k*k*2-2*ge),y=Math.asin(2*Y),b=Math.atan2(2*N*H-2*k*T,1-2*le-2*ge)}}r.y=d,r.z=y,r.x=b}setFromEuler(r,h,d,y="XYZ"){const b=Math.cos(r/2),N=Math.cos(h/2),k=Math.cos(d/2),T=Math.sin(r/2),H=Math.sin(h/2),Y=Math.sin(d/2);return"XYZ"===y?(this.x=T*N*k+b*H*Y,this.y=b*H*k-T*N*Y,this.z=b*N*Y+T*H*k,this.w=b*N*k-T*H*Y):"YXZ"===y?(this.x=T*N*k+b*H*Y,this.y=b*H*k-T*N*Y,this.z=b*N*Y-T*H*k,this.w=b*N*k+T*H*Y):"ZXY"===y?(this.x=T*N*k-b*H*Y,this.y=b*H*k+T*N*Y,this.z=b*N*Y+T*H*k,this.w=b*N*k-T*H*Y):"ZYX"===y?(this.x=T*N*k-b*H*Y,this.y=b*H*k+T*N*Y,this.z=b*N*Y-T*H*k,this.w=b*N*k+T*H*Y):"YZX"===y?(this.x=T*N*k+b*H*Y,this.y=b*H*k+T*N*Y,this.z=b*N*Y-T*H*k,this.w=b*N*k-T*H*Y):"XZY"===y&&(this.x=T*N*k-b*H*Y,this.y=b*H*k-T*N*Y,this.z=b*N*Y+T*H*k,this.w=b*N*k+T*H*Y),this}clone(){return new Q(this.x,this.y,this.z,this.w)}slerp(r,h,d=new Q){const y=this.x,b=this.y,N=this.z,k=this.w;let T,H,Y,le,ae,ge=r.x,we=r.y,Se=r.z,$e=r.w;return H=y*ge+b*we+N*Se+k*$e,H<0&&(H=-H,ge=-ge,we=-we,Se=-Se,$e=-$e),1-H>1e-6?(T=Math.acos(H),Y=Math.sin(T),le=Math.sin((1-h)*T)/Y,ae=Math.sin(h*T)/Y):(le=1-h,ae=h),d.x=le*y+ae*ge,d.y=le*b+ae*we,d.z=le*N+ae*Se,d.w=le*k+ae*$e,d}integrate(r,h,d,y=new Q){const b=r.x*d.x,N=r.y*d.y,k=r.z*d.z,T=this.x,H=this.y,Y=this.z,le=this.w,ae=.5*h;return y.x+=ae*(b*le+N*Y-k*H),y.y+=ae*(N*le+k*T-b*Y),y.z+=ae*(k*le+b*H-N*T),y.w+=ae*(-b*T-N*H-k*Y),y}}const A=new M,R=new M,X={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class he{constructor(r={}){this.id=he.idCounter++,this.type=r.type||0,this.boundingSphereRadius=0,this.collisionResponse=!r.collisionResponse||r.collisionResponse,this.collisionFilterGroup=void 0!==r.collisionFilterGroup?r.collisionFilterGroup:1,this.collisionFilterMask=void 0!==r.collisionFilterMask?r.collisionFilterMask:-1,this.material=r.material?r.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(r,h){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(r,h,d,y){throw"calculateWorldAABB() not implemented for shape type "+this.type}}he.idCounter=0,he.types=X;class z{constructor(r={}){this.position=new M,this.quaternion=new Q,r.position&&this.position.copy(r.position),r.quaternion&&this.quaternion.copy(r.quaternion)}pointToLocal(r,h){return z.pointToLocalFrame(this.position,this.quaternion,r,h)}pointToWorld(r,h){return z.pointToWorldFrame(this.position,this.quaternion,r,h)}vectorToWorldFrame(r,h=new M){return this.quaternion.vmult(r,h),h}static pointToLocalFrame(r,h,d,y=new M){return d.vsub(r,y),h.conjugate(Le),Le.vmult(y,y),y}static pointToWorldFrame(r,h,d,y=new M){return h.vmult(d,y),y.vadd(r,y),y}static vectorToWorldFrame(r,h,d=new M){return r.vmult(h,d),d}static vectorToLocalFrame(r,h,d,y=new M){return h.w*=-1,h.vmult(d,y),h.w*=-1,y}}const Le=new Q;class K extends he{constructor(r={}){const{vertices:h=[],faces:d=[],normals:y=[],axes:b,boundingSphereRadius:N}=r;super({type:he.types.CONVEXPOLYHEDRON}),this.vertices=h,this.faces=d,this.faceNormals=y,0===this.faceNormals.length&&this.computeNormals(),N?this.boundingSphereRadius=N:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=b?b.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const r=this.faces,h=this.vertices,d=this.uniqueEdges;d.length=0;const y=new M;for(let b=0;b!==r.length;b++){const N=r[b],k=N.length;for(let T=0;T!==k;T++){h[N[T]].vsub(h[N[(T+1)%k]],y),y.normalize();let Y=!1;for(let le=0;le!==d.length;le++)if(d[le].almostEquals(y)||d[le].almostEquals(y)){Y=!0;break}Y||d.push(y.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let r=0;r<this.faces.length;r++){for(let y=0;y<this.faces[r].length;y++)if(!this.vertices[this.faces[r][y]])throw new Error("Vertex "+this.faces[r][y]+" not found!");const h=this.faceNormals[r]||new M;if(this.getFaceNormal(r,h),h.negate(h),this.faceNormals[r]=h,h.dot(this.vertices[this.faces[r][0]])<0){console.error(".faceNormals["+r+"] = Vec3("+h.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let y=0;y<this.faces[r].length;y++)console.warn(".vertices["+this.faces[r][y]+"] = Vec3("+this.vertices[this.faces[r][y]].toString()+")")}}}getFaceNormal(r,h){const d=this.faces[r];K.computeNormal(this.vertices[d[0]],this.vertices[d[1]],this.vertices[d[2]],h)}clipAgainstHull(r,h,d,y,b,N,k,T,H){const Y=new M;let le=-1,ae=-Number.MAX_VALUE;for(let we=0;we<d.faces.length;we++){Y.copy(d.faceNormals[we]),b.vmult(Y,Y);const Se=Y.dot(N);Se>ae&&(ae=Se,le=we)}const ge=[];for(let we=0;we<d.faces[le].length;we++){const Se=d.vertices[d.faces[le][we]],$e=new M;$e.copy(Se),b.vmult($e,$e),y.vadd($e,$e),ge.push($e)}le>=0&&this.clipFaceAgainstHull(N,r,h,ge,k,T,H)}findSeparatingAxis(r,h,d,y,b,N,k,T){const H=new M,Y=new M,le=new M,ae=new M,ge=new M,we=new M;let Se=Number.MAX_VALUE;const $e=this;if($e.uniqueAxes)for(let Re=0;Re!==$e.uniqueAxes.length;Re++){d.vmult($e.uniqueAxes[Re],H);const Pe=$e.testSepAxis(H,r,h,d,y,b);if(!1===Pe)return!1;Pe<Se&&(Se=Pe,N.copy(H))}else{const Re=k?k.length:$e.faces.length;for(let Pe=0;Pe<Re;Pe++){H.copy($e.faceNormals[k?k[Pe]:Pe]),d.vmult(H,H);const Fe=$e.testSepAxis(H,r,h,d,y,b);if(!1===Fe)return!1;Fe<Se&&(Se=Fe,N.copy(H))}}if(r.uniqueAxes)for(let Re=0;Re!==r.uniqueAxes.length;Re++){b.vmult(r.uniqueAxes[Re],Y);const Pe=$e.testSepAxis(Y,r,h,d,y,b);if(!1===Pe)return!1;Pe<Se&&(Se=Pe,N.copy(Y))}else{const Re=T?T.length:r.faces.length;for(let Pe=0;Pe<Re;Pe++){Y.copy(r.faceNormals[T?T[Pe]:Pe]),b.vmult(Y,Y);const Fe=$e.testSepAxis(Y,r,h,d,y,b);if(!1===Fe)return!1;Fe<Se&&(Se=Fe,N.copy(Y))}}for(let Re=0;Re!==$e.uniqueEdges.length;Re++){d.vmult($e.uniqueEdges[Re],ae);for(let Pe=0;Pe!==r.uniqueEdges.length;Pe++)if(b.vmult(r.uniqueEdges[Pe],ge),ae.cross(ge,we),!we.almostZero()){we.normalize();const Oe=$e.testSepAxis(we,r,h,d,y,b);if(!1===Oe)return!1;Oe<Se&&(Se=Oe,N.copy(we))}}return y.vsub(h,le),le.dot(N)>0&&N.negate(N),!0}testSepAxis(r,h,d,y,b,N){K.project(this,r,d,y,be),K.project(h,r,b,N,Ne);const k=be[0],T=be[1],H=Ne[0],Y=Ne[1];if(k<Y||H<T)return!1;const le=k-Y,ae=H-T;return le<ae?le:ae}calculateLocalInertia(r,h){const d=new M,y=new M;this.computeLocalAABB(y,d);const b=d.x-y.x,N=d.y-y.y,k=d.z-y.z;h.x=1/12*r*(2*N*2*N+2*k*2*k),h.y=1/12*r*(2*b*2*b+2*k*2*k),h.z=1/12*r*(2*N*2*N+2*b*2*b)}getPlaneConstantOfFace(r){return-this.faceNormals[r].dot(this.vertices[this.faces[r][0]])}clipFaceAgainstHull(r,h,d,y,b,N,k){const T=new M,H=new M,Y=new M,le=new M,ae=new M,ge=new M,we=new M,Se=new M,$e=this,Re=y,Pe=[];let Oe=-1,Fe=Number.MAX_VALUE;for(let _t=0;_t<$e.faces.length;_t++){T.copy($e.faceNormals[_t]),d.vmult(T,T);const $t=T.dot(r);$t<Fe&&(Fe=$t,Oe=_t)}if(Oe<0)return;const De=$e.faces[Oe];De.connectedFaces=[];for(let _t=0;_t<$e.faces.length;_t++)for(let $t=0;$t<$e.faces[_t].length;$t++)-1!==De.indexOf($e.faces[_t][$t])&&_t!==Oe&&-1===De.connectedFaces.indexOf(_t)&&De.connectedFaces.push(_t);const Qe=De.length;for(let _t=0;_t<Qe;_t++){const $t=$e.vertices[De[_t]];$t.vsub($e.vertices[De[(_t+1)%Qe]],H),Y.copy(H),d.vmult(Y,Y),h.vadd(Y,Y),le.copy(this.faceNormals[Oe]),d.vmult(le,le),h.vadd(le,le),Y.cross(le,ae),ae.negate(ae),ge.copy($t),d.vmult(ge,ge),h.vadd(ge,ge);const Dt=De.connectedFaces[_t];we.copy(this.faceNormals[Dt]);const Lt=this.getPlaneConstantOfFace(Dt);Se.copy(we),d.vmult(Se,Se);const Ct=Lt-Se.dot(h);for(this.clipFaceAgainstPlane(Re,Pe,Se,Ct);Re.length;)Re.shift();for(;Pe.length;)Re.push(Pe.shift())}we.copy(this.faceNormals[Oe]);const it=this.getPlaneConstantOfFace(Oe);Se.copy(we),d.vmult(Se,Se);const ct=it-Se.dot(h);for(let _t=0;_t<Re.length;_t++){let $t=Se.dot(Re[_t])+ct;$t<=b&&(console.log("clamped: depth="+$t+" to minDist="+b),$t=b),$t<=N&&$t<=1e-6&&k.push({point:Re[_t],normal:Se,depth:$t})}}clipFaceAgainstPlane(r,h,d,y){let b,N;const k=r.length;if(k<2)return h;let T=r[r.length-1],H=r[0];b=d.dot(T)+y;for(let Y=0;Y<k;Y++){if(H=r[Y],N=d.dot(H)+y,b<0)if(N<0){const le=new M;le.copy(H),h.push(le)}else{const le=new M;T.lerp(H,b/(b-N),le),h.push(le)}else if(N<0){const le=new M;T.lerp(H,b/(b-N),le),h.push(le),h.push(H)}T=H,b=N}return h}computeWorldVertices(r,h){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new M);const d=this.vertices,y=this.worldVertices;for(let b=0;b!==this.vertices.length;b++)h.vmult(d[b],y[b]),r.vadd(y[b],y[b]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(r,h){const d=this.vertices;r.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),h.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let y=0;y<this.vertices.length;y++){const b=d[y];b.x<r.x?r.x=b.x:b.x>h.x&&(h.x=b.x),b.y<r.y?r.y=b.y:b.y>h.y&&(h.y=b.y),b.z<r.z?r.z=b.z:b.z>h.z&&(h.z=b.z)}}computeWorldFaceNormals(r){const h=this.faceNormals.length;for(;this.worldFaceNormals.length<h;)this.worldFaceNormals.push(new M);const d=this.faceNormals,y=this.worldFaceNormals;for(let b=0;b!==h;b++)r.vmult(d[b],y[b]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let r=0;const h=this.vertices;for(let d=0;d!==h.length;d++){const y=h[d].lengthSquared();y>r&&(r=y)}this.boundingSphereRadius=Math.sqrt(r)}calculateWorldAABB(r,h,d,y){const b=this.vertices;let N,k,T,H,Y,le,ae=new M;for(let ge=0;ge<b.length;ge++)ae.copy(b[ge]),h.vmult(ae,ae),r.vadd(ae,ae),(void 0===N||ae.x<N)&&(N=ae.x),(void 0===H||ae.x>H)&&(H=ae.x),(void 0===k||ae.y<k)&&(k=ae.y),(void 0===Y||ae.y>Y)&&(Y=ae.y),(void 0===T||ae.z<T)&&(T=ae.z),(void 0===le||ae.z>le)&&(le=ae.z);d.set(N,k,T),y.set(H,Y,le)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(r=new M){const h=this.vertices;for(let d=0;d<h.length;d++)r.vadd(h[d],r);return r.scale(1/h.length,r),r}transformAllPoints(r,h){const d=this.vertices.length,y=this.vertices;if(h){for(let b=0;b<d;b++){const N=y[b];h.vmult(N,N)}for(let b=0;b<this.faceNormals.length;b++){const N=this.faceNormals[b];h.vmult(N,N)}}if(r)for(let b=0;b<d;b++){const N=y[b];N.vadd(r,N)}}pointIsInside(r){const h=this.vertices,d=this.faces,y=this.faceNormals,b=new M;this.getAveragePointLocal(b);for(let N=0;N<this.faces.length;N++){let k=y[N];const T=h[d[N][0]],H=new M;r.vsub(T,H);const Y=k.dot(H),le=new M;b.vsub(T,le);const ae=k.dot(le);if(Y<0&&ae>0||Y>0&&ae<0)return!1}return-1}}K.computeNormal=(a,r,h,d)=>{const y=new M,b=new M;r.vsub(a,b),h.vsub(r,y),y.cross(b,d),d.isZero()||d.normalize()};const be=[],Ne=[];K.project=(a,r,h,d,y)=>{const b=a.vertices.length,N=new M;let k=0,T=0;const H=new M,Y=a.vertices;H.setZero(),z.vectorToLocalFrame(h,d,r,N),z.pointToLocalFrame(h,d,H,H);const le=H.dot(N);T=k=Y[0].dot(N);for(let ae=1;ae<b;ae++){const ge=Y[ae].dot(N);ge>k&&(k=ge),ge<T&&(T=ge)}if(T-=le,k-=le,T>k){const ae=T;T=k,k=ae}y[0]=k,y[1]=T};class je extends he{constructor(r){super({type:he.types.BOX}),this.halfExtents=r,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const r=this.halfExtents.x,h=this.halfExtents.y,d=this.halfExtents.z,y=M,b=[new y(-r,-h,-d),new y(r,-h,-d),new y(r,h,-d),new y(-r,h,-d),new y(-r,-h,d),new y(r,-h,d),new y(r,h,d),new y(-r,h,d)],N=[new y(0,0,1),new y(0,1,0),new y(1,0,0)],k=new K({vertices:b,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:N});this.convexPolyhedronRepresentation=k,k.material=this.material}calculateLocalInertia(r,h=new M){return je.calculateInertia(this.halfExtents,r,h),h}getSideNormals(r,h){const d=r,y=this.halfExtents;if(d[0].set(y.x,0,0),d[1].set(0,y.y,0),d[2].set(0,0,y.z),d[3].set(-y.x,0,0),d[4].set(0,-y.y,0),d[5].set(0,0,-y.z),void 0!==h)for(let b=0;b!==d.length;b++)h.vmult(d[b],d[b]);return d}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(r,h,d){const y=this.halfExtents,b=[[y.x,y.y,y.z],[-y.x,y.y,y.z],[-y.x,-y.y,y.z],[-y.x,-y.y,-y.z],[y.x,-y.y,-y.z],[y.x,y.y,-y.z],[-y.x,y.y,-y.z],[y.x,-y.y,y.z]];for(let N=0;N<b.length;N++)Te.set(b[N][0],b[N][1],b[N][2]),h.vmult(Te,Te),r.vadd(Te,Te),d(Te.x,Te.y,Te.z)}calculateWorldAABB(r,h,d,y){const b=this.halfExtents;qe[0].set(b.x,b.y,b.z),qe[1].set(-b.x,b.y,b.z),qe[2].set(-b.x,-b.y,b.z),qe[3].set(-b.x,-b.y,-b.z),qe[4].set(b.x,-b.y,-b.z),qe[5].set(b.x,b.y,-b.z),qe[6].set(-b.x,b.y,-b.z),qe[7].set(b.x,-b.y,b.z);const N=qe[0];h.vmult(N,N),r.vadd(N,N),y.copy(N),d.copy(N);for(let k=1;k<8;k++){const T=qe[k];h.vmult(T,T),r.vadd(T,T);const H=T.x,Y=T.y,le=T.z;H>y.x&&(y.x=H),Y>y.y&&(y.y=Y),le>y.z&&(y.z=le),H<d.x&&(d.x=H),Y<d.y&&(d.y=Y),le<d.z&&(d.z=le)}}}je.calculateInertia=(a,r,h)=>{const d=a;h.x=1/12*r*(2*d.y*2*d.y+2*d.z*2*d.z),h.y=1/12*r*(2*d.x*2*d.x+2*d.z*2*d.z),h.z=1/12*r*(2*d.y*2*d.y+2*d.x*2*d.x)};const Te=new M,qe=[new M,new M,new M,new M,new M,new M,new M,new M],Ke={DYNAMIC:1,STATIC:2,KINEMATIC:4},vt={AWAKE:0,SLEEPY:1,SLEEPING:2};class ht extends W{constructor(r={}){super(),this.id=ht.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new M,this.collisionFilterGroup="number"==typeof r.collisionFilterGroup?r.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof r.collisionFilterMask?r.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof r.collisionResponse||r.collisionResponse,this.position=new M,this.previousPosition=new M,this.interpolatedPosition=new M,this.initPosition=new M,r.position&&(this.position.copy(r.position),this.previousPosition.copy(r.position),this.interpolatedPosition.copy(r.position),this.initPosition.copy(r.position)),this.velocity=new M,r.velocity&&this.velocity.copy(r.velocity),this.initVelocity=new M,this.force=new M;const h="number"==typeof r.mass?r.mass:0;this.mass=h,this.invMass=h>0?1/h:0,this.material=r.material||null,this.linearDamping="number"==typeof r.linearDamping?r.linearDamping:.01,this.type=h<=0?ht.STATIC:ht.DYNAMIC,typeof r.type==typeof ht.STATIC&&(this.type=r.type),this.allowSleep=void 0===r.allowSleep||r.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==r.sleepSpeedLimit?r.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==r.sleepTimeLimit?r.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new M,this.quaternion=new Q,this.initQuaternion=new Q,this.previousQuaternion=new Q,this.interpolatedQuaternion=new Q,r.quaternion&&(this.quaternion.copy(r.quaternion),this.initQuaternion.copy(r.quaternion),this.previousQuaternion.copy(r.quaternion),this.interpolatedQuaternion.copy(r.quaternion)),this.angularVelocity=new M,r.angularVelocity&&this.angularVelocity.copy(r.angularVelocity),this.initAngularVelocity=new M,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new M,this.invInertia=new M,this.invInertiaWorld=new G,this.invMassSolve=0,this.invInertiaSolve=new M,this.invInertiaWorldSolve=new G,this.fixedRotation=void 0!==r.fixedRotation&&r.fixedRotation,this.angularDamping=void 0!==r.angularDamping?r.angularDamping:.01,this.linearFactor=new M(1,1,1),r.linearFactor&&this.linearFactor.copy(r.linearFactor),this.angularFactor=new M(1,1,1),r.angularFactor&&this.angularFactor.copy(r.angularFactor),this.aabb=new ne,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new M,r.shape&&this.addShape(r.shape),this.updateMassProperties()}wakeUp(){const r=this.sleepState;this.sleepState=0,this.wakeUpAfterNarrowphase=!1,r===ht.SLEEPING&&this.dispatchEvent(ht.wakeupEvent)}sleep(){this.sleepState=ht.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(r){if(this.allowSleep){const h=this.sleepState,d=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),y=this.sleepSpeedLimit**2;h===ht.AWAKE&&d<y?(this.sleepState=ht.SLEEPY,this.timeLastSleepy=r,this.dispatchEvent(ht.sleepyEvent)):h===ht.SLEEPY&&d>y?this.wakeUp():h===ht.SLEEPY&&r-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(ht.sleepEvent))}}updateSolveMassProperties(){this.sleepState===ht.SLEEPING||this.type===ht.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(r,h=new M){return r.vsub(this.position,h),this.quaternion.conjugate().vmult(h,h),h}vectorToLocalFrame(r,h=new M){return this.quaternion.conjugate().vmult(r,h),h}pointToWorldFrame(r,h=new M){return this.quaternion.vmult(r,h),h.vadd(this.position,h),h}vectorToWorldFrame(r,h=new M){return this.quaternion.vmult(r,h),h}addShape(r,h,d){const y=new M,b=new Q;return h&&y.copy(h),d&&b.copy(d),this.shapes.push(r),this.shapeOffsets.push(y),this.shapeOrientations.push(b),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,r.body=this,this}updateBoundingRadius(){const r=this.shapes,h=this.shapeOffsets,d=r.length;let y=0;for(let b=0;b!==d;b++){const N=r[b];N.updateBoundingSphereRadius();const k=h[b].length(),T=N.boundingSphereRadius;k+T>y&&(y=k+T)}this.boundingRadius=y}computeAABB(){const r=this.shapes,h=this.shapeOffsets,d=this.shapeOrientations,y=r.length,b=Bt,N=wt,k=this.quaternion,T=this.aabb,H=Ft;for(let Y=0;Y!==y;Y++){const le=r[Y];k.vmult(h[Y],b),b.vadd(this.position,b),k.mult(d[Y],N),le.calculateWorldAABB(b,N,H.lowerBound,H.upperBound),0===Y?T.copy(H):T.extend(H)}this.aabbNeedsUpdate=!1}updateInertiaWorld(r){const h=this.invInertia;if(h.x!==h.y||h.y!==h.z||r){const d=Ot,y=on;d.setRotationFromQuaternion(this.quaternion),d.transpose(y),d.scale(h,d),d.mmult(y,this.invInertiaWorld)}}applyForce(r,h){if(this.type!==ht.DYNAMIC)return;const d=ft;h.cross(r,d),this.force.vadd(r,this.force),this.torque.vadd(d,this.torque)}applyLocalForce(r,h){if(this.type!==ht.DYNAMIC)return;const d=An,y=Cn;this.vectorToWorldFrame(r,d),this.vectorToWorldFrame(h,y),this.applyForce(d,y)}applyImpulse(r,h){if(this.type!==ht.DYNAMIC)return;const d=h,y=fn;y.copy(r),y.scale(this.invMass,y),this.velocity.vadd(y,this.velocity);const b=On;d.cross(r,b),this.invInertiaWorld.vmult(b,b),this.angularVelocity.vadd(b,this.angularVelocity)}applyLocalImpulse(r,h){if(this.type!==ht.DYNAMIC)return;const d=$n,y=_n;this.vectorToWorldFrame(r,d),this.vectorToWorldFrame(h,y),this.applyImpulse(d,y)}updateMassProperties(){const r=ar;this.invMass=this.mass>0?1/this.mass:0;const h=this.inertia,d=this.fixedRotation;this.computeAABB(),r.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),je.calculateInertia(r,this.mass,h),this.invInertia.set(h.x>0&&!d?1/h.x:0,h.y>0&&!d?1/h.y:0,h.z>0&&!d?1/h.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(r,h){const d=new M;return r.vsub(this.position,d),this.angularVelocity.cross(d,h),this.velocity.vadd(h,h),h}integrate(r,h,d){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==ht.DYNAMIC&&this.type!==ht.KINEMATIC||this.sleepState===ht.SLEEPING)return;const y=this.velocity,b=this.angularVelocity,N=this.position,k=this.force,T=this.torque,H=this.quaternion,le=this.invInertiaWorld,ae=this.linearFactor,ge=this.invMass*r;y.x+=k.x*ge*ae.x,y.y+=k.y*ge*ae.y,y.z+=k.z*ge*ae.z;const we=le.elements,Se=this.angularFactor,$e=T.x*Se.x,Re=T.y*Se.y,Pe=T.z*Se.z;b.x+=r*(we[0]*$e+we[1]*Re+we[2]*Pe),b.y+=r*(we[3]*$e+we[4]*Re+we[5]*Pe),b.z+=r*(we[6]*$e+we[7]*Re+we[8]*Pe),N.x+=y.x*r,N.y+=y.y*r,N.z+=y.z*r,H.integrate(this.angularVelocity,r,this.angularFactor,H),h&&(d?H.normalizeFast():H.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}ht.COLLIDE_EVENT_NAME="collide",ht.DYNAMIC=1,ht.STATIC=2,ht.KINEMATIC=4,ht.AWAKE=vt.AWAKE,ht.SLEEPY=vt.SLEEPY,ht.SLEEPING=vt.SLEEPING,ht.idCounter=0,ht.wakeupEvent={type:"wakeup"},ht.sleepyEvent={type:"sleepy"},ht.sleepEvent={type:"sleep"};const Bt=new M,wt=new Q,Ft=new ne,Ot=new G,on=new G,ft=new M,An=new M,Cn=new M,fn=new M,On=new M,$n=new M,_n=new M,ar=new M;class nr{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(r,h,d){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(r,h){return!(!(r.collisionFilterGroup&h.collisionFilterMask&&h.collisionFilterGroup&r.collisionFilterMask)||(r.type&ht.STATIC||r.sleepState===ht.SLEEPING)&&(h.type&ht.STATIC||h.sleepState===ht.SLEEPING))}intersectionTest(r,h,d,y){this.useBoundingBoxes?this.doBoundingBoxBroadphase(r,h,d,y):this.doBoundingSphereBroadphase(r,h,d,y)}doBoundingSphereBroadphase(r,h,d,y){const b=lr;h.position.vsub(r.position,b);const N=(r.boundingRadius+h.boundingRadius)**2;b.lengthSquared()<N&&(d.push(r),y.push(h))}doBoundingBoxBroadphase(r,h,d,y){r.aabbNeedsUpdate&&r.computeAABB(),h.aabbNeedsUpdate&&h.computeAABB(),r.aabb.overlaps(h.aabb)&&(d.push(r),y.push(h))}makePairsUnique(r,h){const d=rr,y=ti,b=Zr,N=r.length;for(let k=0;k!==N;k++)y[k]=r[k],b[k]=h[k];r.length=0,h.length=0;for(let k=0;k!==N;k++){const T=y[k].id,H=b[k].id,Y=T<H?T+","+H:H+","+T;d[Y]=k,d.keys.push(Y)}for(let k=0;k!==d.keys.length;k++){const T=d.keys.pop(),H=d[T];r.push(y[H]),h.push(b[H]),delete d[T]}}setWorld(r){}aabbQuery(r,h,d){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const lr=new M,rr={keys:[]},ti=[],Zr=[];nr.boundingSphereCheck=(a,r)=>{const h=new M;return a.position.vsub(r.position,h),Math.pow(a.shapes[0].boundingSphereRadius+r.shapes[0].boundingSphereRadius,2)>h.lengthSquared()};class pi extends nr{constructor(r=new M(100,100,100),h=new M(-100,-100,-100),d=10,y=10,b=10){super(),this.nx=d,this.ny=y,this.nz=b,this.aabbMin=r,this.aabbMax=h;const N=this.nx*this.ny*this.nz;if(N<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=N,this.binLengths.length=N;for(let k=0;k<N;k++)this.bins[k]=[],this.binLengths[k]=0}collisionPairs(r,h,d){const y=r.numObjects(),b=r.bodies,N=this.aabbMax,k=this.aabbMin,T=this.nx,H=this.ny,Y=this.nz,le=H*Y,ae=Y,ge=N.x,we=N.y,Se=N.z,$e=k.x,Re=k.y,Pe=k.z,Oe=T/(ge-$e),Fe=H/(we-Re),De=Y/(Se-Pe),Qe=(ge-$e)/T,it=(we-Re)/H,ct=(Se-Pe)/Y,_t=.5*Math.sqrt(Qe*Qe+it*it+ct*ct),$t=he.types,rn=$t.SPHERE,Dt=$t.PLANE,Lt=this.bins,Ct=this.binLengths,ut=this.bins.length;for(let vn=0;vn!==ut;vn++)Ct[vn]=0;const Tt=Math.ceil;function Qt(vn,gn,fr,sr,Rn,Jn,Kn){let Er=(vn-$e)*Oe|0,vi=(gn-Re)*Fe|0,no=(fr-Pe)*De|0,fo=Tt((sr-$e)*Oe),Vo=Tt((Rn-Re)*Fe),Uo=Tt((Jn-Pe)*De);Er<0?Er=0:Er>=T&&(Er=T-1),vi<0?vi=0:vi>=H&&(vi=H-1),no<0?no=0:no>=Y&&(no=Y-1),fo<0?fo=0:fo>=T&&(fo=T-1),Vo<0?Vo=0:Vo>=H&&(Vo=H-1),Uo<0?Uo=0:Uo>=Y&&(Uo=Y-1),Er*=le,vi*=ae,no*=1,fo*=le,Vo*=ae,Uo*=1;for(let Gs=Er;Gs<=fo;Gs+=le)for(let hs=vi;hs<=Vo;hs+=ae)for(let ps=no;ps<=Uo;ps+=1){const ds=Gs+hs+ps;Lt[ds][Ct[ds]++]=Kn}}for(let vn=0;vn!==y;vn++){const gn=b[vn],fr=gn.shapes[0];switch(fr.type){case rn:{const Rn=gn.position.x,Jn=gn.position.y,Kn=gn.position.z,Er=fr.radius;Qt(Rn-Er,Jn-Er,Kn-Er,Rn+Er,Jn+Er,Kn+Er,gn);break}case Dt:{const sr=fr;sr.worldNormalNeedsUpdate&&sr.computeWorldNormal(gn.quaternion);const Rn=sr.worldNormal,Kn=Re+.5*it-gn.position.y,Er=Pe+.5*ct-gn.position.z,vi=tr;vi.set($e+.5*Qe-gn.position.x,Kn,Er);for(let no=0,fo=0;no!==T;no++,fo+=le,vi.y=Kn,vi.x+=Qe)for(let Vo=0,Uo=0;Vo!==H;Vo++,Uo+=ae,vi.z=Er,vi.y+=it)for(let Gs=0,hs=0;Gs!==Y;Gs++,hs+=1,vi.z+=ct)if(vi.dot(Rn)<_t){const ps=fo+Uo+hs;Lt[ps][Ct[ps]++]=gn}break}default:gn.aabbNeedsUpdate&&gn.computeAABB(),Qt(gn.aabb.lowerBound.x,gn.aabb.lowerBound.y,gn.aabb.lowerBound.z,gn.aabb.upperBound.x,gn.aabb.upperBound.y,gn.aabb.upperBound.z,gn)}}for(let vn=0;vn!==ut;vn++){const gn=Ct[vn];if(gn>1){const fr=Lt[vn];for(let sr=0;sr!==gn;sr++){const Rn=fr[sr];for(let Jn=0;Jn!==sr;Jn++){const Kn=fr[Jn];this.needBroadphaseCollision(Rn,Kn)&&this.intersectionTest(Rn,Kn,h,d)}}}}this.makePairsUnique(h,d)}}const tr=new M;class mr extends nr{constructor(){super()}collisionPairs(r,h,d){const y=r.bodies,b=y.length;let N,k;for(let T=0;T!==b;T++)for(let H=0;H!==T;H++)N=y[T],k=y[H],this.needBroadphaseCollision(N,k)&&this.intersectionTest(N,k,h,d)}aabbQuery(r,h,d=[]){for(let y=0;y<r.bodies.length;y++){const b=r.bodies[y];b.aabbNeedsUpdate&&b.computeAABB(),b.aabb.overlaps(h)&&d.push(b)}return d}}class mi{constructor(){this.rayFromWorld=new M,this.rayToWorld=new M,this.hitNormalWorld=new M,this.hitPointWorld=new M,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(r,h,d,y,b,N,k){this.rayFromWorld.copy(r),this.rayToWorld.copy(h),this.hitNormalWorld.copy(d),this.hitPointWorld.copy(y),this.shape=b,this.body=N,this.distance=k}}const xo={CLOSEST:1,ANY:2,ALL:4};class Nr{constructor(r=new M,h=new M){this.from=r.clone(),this.to=h.clone(),this.direction=new M,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Nr.ANY,this.result=new mi,this.hasHit=!1,this.callback=d=>{}}intersectWorld(r,h){return this.mode=h.mode||Nr.ANY,this.result=h.result||new mi,this.skipBackfaces=!!h.skipBackfaces,this.collisionFilterMask=void 0!==h.collisionFilterMask?h.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==h.collisionFilterGroup?h.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===h.checkCollisionResponse||h.checkCollisionResponse,h.from&&this.from.copy(h.from),h.to&&this.to.copy(h.to),this.callback=h.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(Qr),Vr.length=0,r.broadphase.aabbQuery(r,Qr,Vr),this.intersectBodies(Vr),this.hasHit}intersectBody(r,h){h&&(this.result=h,this.updateDirection());const d=this.checkCollisionResponse;if(d&&!r.collisionResponse||!(this.collisionFilterGroup&r.collisionFilterMask&&r.collisionFilterGroup&this.collisionFilterMask))return;const y=Hs,b=ia;for(let N=0,k=r.shapes.length;N<k;N++){const T=r.shapes[N];if((!d||T.collisionResponse)&&(r.quaternion.mult(r.shapeOrientations[N],b),r.quaternion.vmult(r.shapeOffsets[N],y),y.vadd(r.position,y),this.intersectShape(T,b,y,r),this.result.shouldStop))break}}intersectBodies(r,h){h&&(this.result=h,this.updateDirection());for(let d=0,y=r.length;!this.result.shouldStop&&d<y;d++)this.intersectBody(r[d])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(r,h,d,y){if(function(k,T,H){H.vsub(k,Ws);const Y=Ws.dot(T);return T.scale(Y,qo),qo.vadd(k,qo),H.distanceTo(qo)}(this.from,this.direction,d)>r.boundingSphereRadius)return;const N=this[r.type];N&&N.call(this,r,h,d,y,r)}_intersectBox(r,h,d,y,b){return this._intersectConvex(r.convexPolyhedronRepresentation,h,d,y,b)}_intersectPlane(r,h,d,y,b){const N=this.from,k=this.to,T=this.direction,H=new M(0,0,1);h.vmult(H,H);const Y=new M;N.vsub(d,Y);const le=Y.dot(H);if(k.vsub(d,Y),le*Y.dot(H)>0||N.distanceTo(k)<le)return;const ae=H.dot(T);if(Math.abs(ae)<this.precision)return;const ge=new M,we=new M,Se=new M;N.vsub(d,ge);const $e=-H.dot(ge)/ae;T.scale($e,we),N.vadd(we,Se),this.reportIntersection(H,Se,b,y,-1)}getAABB(r){const{lowerBound:h,upperBound:d}=r,y=this.to,b=this.from;h.x=Math.min(y.x,b.x),h.y=Math.min(y.y,b.y),h.z=Math.min(y.z,b.z),d.x=Math.max(y.x,b.x),d.y=Math.max(y.y,b.y),d.z=Math.max(y.z,b.z)}_intersectHeightfield(r,h,d,y,b){const N=Oa;N.from.copy(this.from),N.to.copy(this.to),z.pointToLocalFrame(d,h,N.from,N.from),z.pointToLocalFrame(d,h,N.to,N.to),N.updateDirection();const k=Iu;let T,H,Y,le;T=H=0,Y=le=r.data.length-1;const ae=new ne;N.getAABB(ae),r.getIndexOfPosition(ae.lowerBound.x,ae.lowerBound.y,k,!0),T=Math.max(T,k[0]),H=Math.max(H,k[1]),r.getIndexOfPosition(ae.upperBound.x,ae.upperBound.y,k,!0),Y=Math.min(Y,k[0]+1),le=Math.min(le,k[1]+1);for(let ge=T;ge<Y;ge++)for(let we=H;we<le;we++){if(this.result.shouldStop)return;if(r.getAabbAtIndex(ge,we,ae),ae.overlapsRay(N)){if(r.getConvexTrianglePillar(ge,we,!1),z.pointToWorldFrame(d,h,r.pillarOffset,Or),this._intersectConvex(r.pillarConvex,h,Or,y,b,os),this.result.shouldStop)return;r.getConvexTrianglePillar(ge,we,!0),z.pointToWorldFrame(d,h,r.pillarOffset,Or),this._intersectConvex(r.pillarConvex,h,Or,y,b,os)}}}_intersectSphere(r,h,d,y,b){const N=this.from,k=this.to,H=(k.x-N.x)**2+(k.y-N.y)**2+(k.z-N.z)**2,Y=2*((k.x-N.x)*(N.x-d.x)+(k.y-N.y)*(N.y-d.y)+(k.z-N.z)*(N.z-d.z)),le=Y**2-4*H*((N.x-d.x)**2+(N.y-d.y)**2+(N.z-d.z)**2-r.radius**2),ae=fs,ge=Vs;if(!(le<0))if(0===le)N.lerp(k,le,ae),ae.vsub(d,ge),ge.normalize(),this.reportIntersection(ge,ae,b,y,-1);else{const we=(-Y-Math.sqrt(le))/(2*H),Se=(-Y+Math.sqrt(le))/(2*H);if(we>=0&&we<=1&&(N.lerp(k,we,ae),ae.vsub(d,ge),ge.normalize(),this.reportIntersection(ge,ae,b,y,-1)),this.result.shouldStop)return;Se>=0&&Se<=1&&(N.lerp(k,Se,ae),ae.vsub(d,ge),ge.normalize(),this.reportIntersection(ge,ae,b,y,-1))}}_intersectConvex(r,h,d,y,b,N){const k=ai,T=Fc,H=N&&N.faceList||null,Y=r.faces,le=r.vertices,ae=r.faceNormals,ge=this.direction,we=this.from,$e=we.distanceTo(this.to),Re=H?H.length:Y.length,Pe=this.result;for(let Oe=0;!Pe.shouldStop&&Oe<Re;Oe++){const Fe=H?H[Oe]:Oe,De=Y[Fe],Qe=ae[Fe],it=h,ct=d;T.copy(le[De[0]]),it.vmult(T,T),T.vadd(ct,T),T.vsub(we,T),it.vmult(Qe,k);const _t=ge.dot(k);if(Math.abs(_t)<this.precision)continue;const $t=k.dot(T)/_t;if(!($t<0)){ge.scale($t,Oi),Oi.vadd(we,Oi),Co.copy(le[De[0]]),it.vmult(Co,Co),ct.vadd(Co,Co);for(let rn=1;!Pe.shouldStop&&rn<De.length-1;rn++){wo.copy(le[De[rn]]),Yr.copy(le[De[rn+1]]),it.vmult(wo,wo),it.vmult(Yr,Yr),ct.vadd(wo,wo),ct.vadd(Yr,Yr);const Dt=Oi.distanceTo(we);!$o(Oi,Co,wo,Yr)&&!$o(Oi,wo,Co,Yr)||Dt>$e||this.reportIntersection(k,Oi,b,y,Fe)}}}}_intersectTrimesh(r,h,d,y,b,N){const k=Ph,T=Dc,H=Hp,Y=Fc,le=Ka,ae=Gp,ge=oa,we=ka,Se=zl,$e=r.indices,Re=this.from,Pe=this.to,Oe=this.direction;H.position.copy(d),H.quaternion.copy(h),z.vectorToLocalFrame(d,h,Oe,le),z.pointToLocalFrame(d,h,Re,ae),z.pointToLocalFrame(d,h,Pe,ge),ge.x*=r.scale.x,ge.y*=r.scale.y,ge.z*=r.scale.z,ae.x*=r.scale.x,ae.y*=r.scale.y,ae.z*=r.scale.z,ge.vsub(ae,le),le.normalize();const Fe=ae.distanceSquared(ge);r.tree.rayQuery(this,H,T);for(let De=0,Qe=T.length;!this.result.shouldStop&&De!==Qe;De++){const it=T[De];r.getNormal(it,k),r.getVertex($e[3*it],Co),Co.vsub(ae,Y);const ct=le.dot(k),_t=k.dot(Y)/ct;if(_t<0)continue;le.scale(_t,Oi),Oi.vadd(ae,Oi),r.getVertex($e[3*it+1],wo),r.getVertex($e[3*it+2],Yr);const $t=Oi.distanceSquared(ae);!$o(Oi,wo,Co,Yr)&&!$o(Oi,Co,wo,Yr)||$t>Fe||(z.vectorToWorldFrame(h,k,Se),z.pointToWorldFrame(d,h,Oi,we),this.reportIntersection(Se,we,b,y,it))}T.length=0}reportIntersection(r,h,d,y,b){const N=this.from,k=this.to,T=N.distanceTo(h),H=this.result;if(!(this.skipBackfaces&&r.dot(this.direction)>0))switch(H.hitFaceIndex=void 0!==b?b:-1,this.mode){case Nr.ALL:this.hasHit=!0,H.set(N,k,r,h,d,y,T),H.hasHit=!0,this.callback(H);break;case Nr.CLOSEST:(T<H.distance||!H.hasHit)&&(this.hasHit=!0,H.hasHit=!0,H.set(N,k,r,h,d,y,T));break;case Nr.ANY:this.hasHit=!0,H.hasHit=!0,H.set(N,k,r,h,d,y,T),H.shouldStop=!0}}}Nr.CLOSEST=1,Nr.ANY=2,Nr.ALL=4;const Qr=new ne,Vr=[],gi=new M,Ti=new M;function $o(a,r,h,d){d.vsub(r,Ws),h.vsub(r,gi),a.vsub(r,Ti);const y=Ws.dot(Ws),b=Ws.dot(gi),N=Ws.dot(Ti),k=gi.dot(gi),T=gi.dot(Ti);let H,Y;return(H=k*N-b*T)>=0&&(Y=y*T-b*N)>=0&&H+Y<y*k-b*b}Nr.pointInTriangle=$o;const Hs=new M,ia=new Q,Oi=new M,Co=new M,wo=new M,Yr=new M;Nr.prototype[he.types.BOX]=Nr.prototype._intersectBox,Nr.prototype[he.types.PLANE]=Nr.prototype._intersectPlane;const os={faceList:[0]},Or=new M,Oa=new Nr,Iu=[];Nr.prototype[he.types.HEIGHTFIELD]=Nr.prototype._intersectHeightfield;const fs=new M,Vs=new M;Nr.prototype[he.types.SPHERE]=Nr.prototype._intersectSphere;const ai=new M,Fc=new M;Nr.prototype[he.types.CONVEXPOLYHEDRON]=Nr.prototype._intersectConvex;const Ph=new M,Ka=new M,Gp=new M,oa=new M,zl=new M,ka=new M,Dc=(new ne,[]),Hp=new z;Nr.prototype[he.types.TRIMESH]=Nr.prototype._intersectTrimesh;const Ws=new M,qo=new M;class ms extends nr{constructor(r){super(),this.axisList=[],this.world=null,this.axisIndex=0;const h=this.axisList;this._addBodyHandler=d=>{h.push(d.body)},this._removeBodyHandler=d=>{const y=h.indexOf(d.body);-1!==y&&h.splice(y,1)},r&&this.setWorld(r)}setWorld(r){this.axisList.length=0;for(let h=0;h<r.bodies.length;h++)this.axisList.push(r.bodies[h]);r.removeEventListener("addBody",this._addBodyHandler),r.removeEventListener("removeBody",this._removeBodyHandler),r.addEventListener("addBody",this._addBodyHandler),r.addEventListener("removeBody",this._removeBodyHandler),this.world=r,this.dirty=!0}collisionPairs(r,h,d){const y=this.axisList,b=y.length,N=this.axisIndex;let k,T;for(this.dirty&&(this.sortList(),this.dirty=!1),k=0;k!==b;k++){const H=y[k];for(T=k+1;T<b;T++){const Y=y[T];if(this.needBroadphaseCollision(H,Y)){if(!ms.checkBounds(H,Y,N))break;this.intersectionTest(H,Y,h,d)}}}}sortList(){const r=this.axisList,h=this.axisIndex,d=r.length;for(let y=0;y!==d;y++){const b=r[y];b.aabbNeedsUpdate&&b.computeAABB()}0===h?ms.insertionSortX(r):1===h?ms.insertionSortY(r):2===h&&ms.insertionSortZ(r)}autoDetectAxis(){let r=0,h=0,d=0,y=0,b=0,N=0;const k=this.axisList,T=k.length,H=1/T;for(let ge=0;ge!==T;ge++){const we=k[ge],Se=we.position.x;r+=Se,h+=Se*Se;const $e=we.position.y;d+=$e,y+=$e*$e;const Re=we.position.z;b+=Re,N+=Re*Re}const Y=h-r*r*H,le=y-d*d*H,ae=N-b*b*H;this.axisIndex=Y>le?Y>ae?0:2:le>ae?1:2}aabbQuery(r,h,d=[]){this.dirty&&(this.sortList(),this.dirty=!1);const y=this.axisIndex;let b="x";1===y&&(b="y"),2===y&&(b="z");const N=this.axisList;for(let k=0;k<N.length;k++){const T=N[k];T.aabbNeedsUpdate&&T.computeAABB(),T.aabb.overlaps(h)&&d.push(T)}return d}}function Ou(){}ms.insertionSortX=a=>{for(let r=1,h=a.length;r<h;r++){const d=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.x<=d.aabb.lowerBound.x);y--)a[y+1]=a[y];a[y+1]=d}return a},ms.insertionSortY=a=>{for(let r=1,h=a.length;r<h;r++){const d=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.y<=d.aabb.lowerBound.y);y--)a[y+1]=a[y];a[y+1]=d}return a},ms.insertionSortZ=a=>{for(let r=1,h=a.length;r<h;r++){const d=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.z<=d.aabb.lowerBound.z);y--)a[y+1]=a[y];a[y+1]=d}return a},ms.checkBounds=(a,r,h)=>{let d,y;return 0===h?(d=a.position.x,y=r.position.x):1===h?(d=a.position.y,y=r.position.y):2===h&&(d=a.position.z,y=r.position.z),y-r.boundingRadius<d+a.boundingRadius},Ou.defaults=(a={},r)=>{for(let h in r)h in a||(a[h]=r[h]);return a};class uu{constructor(r,h,d={}){d=Ou.defaults(d,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=r,this.bodyB=h,this.id=uu.idCounter++,this.collideConnected=d.collideConnected,d.wakeUpBodies&&(r&&r.wakeUp(),h&&h.wakeUp())}update(){throw new Error("method update() not implmemented in this Constraint subclass!")}enable(){const r=this.equations;for(let h=0;h<r.length;h++)r[h].enabled=!0}disable(){const r=this.equations;for(let h=0;h<r.length;h++)r[h].enabled=!1}}uu.idCounter=0;class hu{constructor(){this.spatial=new M,this.rotational=new M}multiplyElement(r){return r.spatial.dot(this.spatial)+r.rotational.dot(this.rotational)}multiplyVectors(r,h){return r.dot(this.spatial)+h.dot(this.rotational)}}class Ts{constructor(r,h,d=-1e6,y=1e6){this.id=Ts.id++,this.minForce=d,this.maxForce=y,this.bi=r,this.bj=h,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new hu,this.jacobianElementB=new hu,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(r,h,d){const y=h,b=r,N=d;this.a=4/(N*(1+4*y)),this.b=4*y/(1+4*y),this.eps=4/(N*N*b*(1+4*y))}computeB(r,h,d){const y=this.computeGW();return-this.computeGq()*r-y*h-this.computeGiMf()*d}computeGq(){const h=this.jacobianElementB,N=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+h.spatial.dot(N)}computeGW(){const h=this.jacobianElementB,d=this.bi,y=this.bj,N=y.velocity,T=y.angularVelocity;return this.jacobianElementA.multiplyVectors(d.velocity,d.angularVelocity)+h.multiplyVectors(N,T)}computeGWlambda(){const h=this.jacobianElementB,d=this.bi,y=this.bj,N=y.vlambda,T=y.wlambda;return this.jacobianElementA.multiplyVectors(d.vlambda,d.wlambda)+h.multiplyVectors(N,T)}computeGiMf(){const r=this.jacobianElementA,h=this.jacobianElementB,d=this.bi,y=this.bj,N=d.torque,k=y.force,T=y.torque,Y=y.invMassSolve;return d.force.scale(d.invMassSolve,pp),k.scale(Y,Is),d.invInertiaWorldSolve.vmult(N,mo),y.invInertiaWorldSolve.vmult(T,Uc),r.multiplyVectors(pp,mo)+h.multiplyVectors(Is,Uc)}computeGiMGt(){const r=this.jacobianElementA,h=this.jacobianElementB,d=this.bi,y=this.bj,T=y.invInertiaWorldSolve;let H=d.invMassSolve+y.invMassSolve;return d.invInertiaWorldSolve.vmult(r.rotational,ku),H+=ku.dot(r.rotational),T.vmult(h.rotational,ku),H+=ku.dot(h.rotational),H}addToWlambda(r){const h=this.jacobianElementA,d=this.jacobianElementB,y=this.bi,b=this.bj,N=ph;y.vlambda.addScaledVector(y.invMassSolve*r,h.spatial,y.vlambda),b.vlambda.addScaledVector(b.invMassSolve*r,d.spatial,b.vlambda),y.invInertiaWorldSolve.vmult(h.rotational,N),y.wlambda.addScaledVector(r,N,y.wlambda),b.invInertiaWorldSolve.vmult(d.rotational,N),b.wlambda.addScaledVector(r,N,b.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}Ts.id=0;const pp=new M,Is=new M,mo=new M,Uc=new M,ku=new M,ph=new M;class Lo extends Ts{constructor(r,h,d=1e6){super(r,h,0,d),this.restitution=0,this.ri=new M,this.rj=new M,this.ni=new M}computeB(r){const h=this.a,d=this.b,y=this.bi,b=this.bj,N=this.ri,k=this.rj,T=qs,H=Vp,Y=y.velocity,le=y.angularVelocity,ae=b.velocity,ge=b.angularVelocity,we=el,Se=this.jacobianElementA,$e=this.jacobianElementB,Re=this.ni;N.cross(Re,T),k.cross(Re,H),Re.negate(Se.spatial),T.negate(Se.rotational),$e.spatial.copy(Re),$e.rotational.copy(H),we.copy(b.position),we.vadd(k,we),we.vsub(y.position,we),we.vsub(N,we);const Pe=Re.dot(we),Oe=this.restitution+1;return-Pe*h-(Oe*ae.dot(Re)-Oe*Y.dot(Re)+ge.dot(H)-le.dot(T))*d-r*this.computeGiMf()}getImpactVelocityAlongNormal(){const r=pu,h=dp,d=fp,y=dh,b=Ih;return this.bi.position.vadd(this.ri,d),this.bj.position.vadd(this.rj,y),this.bi.getVelocityAtWorldPoint(d,r),this.bj.getVelocityAtWorldPoint(y,h),r.vsub(h,b),this.ni.dot(b)}}const qs=new M,Vp=new M,el=new M,pu=new M,dp=new M,fp=new M,dh=new M,Ih=new M;class cc extends uu{constructor(r,h=new M,d,y=new M,b=1e6){super(r,d),this.pivotA=h.clone(),this.pivotB=y.clone();const N=this.equationX=new Lo(r,d),k=this.equationY=new Lo(r,d),T=this.equationZ=new Lo(r,d);this.equations.push(N,k,T),N.minForce=k.minForce=T.minForce=-b,N.maxForce=k.maxForce=T.maxForce=b,N.ni.set(1,0,0),k.ni.set(0,1,0),T.ni.set(0,0,1)}update(){const h=this.bodyB,d=this.equationX,y=this.equationY,b=this.equationZ;this.bodyA.quaternion.vmult(this.pivotA,d.ri),h.quaternion.vmult(this.pivotB,d.rj),y.ri.copy(d.ri),y.rj.copy(d.rj),b.ri.copy(d.ri),b.rj.copy(d.rj)}}class Oh extends Ts{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6;super(r,h,-y,y),this.axisA=d.axisA?d.axisA.clone():new M(1,0,0),this.axisB=d.axisB?d.axisB.clone():new M(0,1,0),this.angle=void 0!==d.angle?d.angle:0}computeB(r){const h=this.a,d=this.b,y=this.axisA,b=this.axisB,N=fh,k=kh,T=this.jacobianElementA,H=this.jacobianElementB;return y.cross(b,N),b.cross(y,k),T.rotational.copy(k),H.rotational.copy(N),-(Math.cos(this.angle)-y.dot(b))*h-this.computeGW()*d-r*this.computeGiMf()}}const fh=new M,kh=new M;class yl extends Ts{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6;super(r,h,-y,y),this.axisA=d.axisA?d.axisA.clone():new M(1,0,0),this.axisB=d.axisB?d.axisB.clone():new M(0,1,0),this.maxAngle=Math.PI/2}computeB(r){const h=this.a,d=this.b,y=this.axisA,b=this.axisB,N=xl,k=jl,T=this.jacobianElementA,H=this.jacobianElementB;return y.cross(b,N),b.cross(y,k),T.rotational.copy(k),H.rotational.copy(N),-(Math.cos(this.maxAngle)-y.dot(b))*h-this.computeGW()*d-r*this.computeGiMf()}}const xl=new M,jl=new M;class Fu extends cc{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6;super(r,d.pivotA?d.pivotA.clone():new M,h,d.pivotB?d.pivotB.clone():new M,y),this.axisA=d.axisA?d.axisA.clone():new M,this.axisB=d.axisB?d.axisB.clone():new M,this.collideConnected=!!d.collideConnected,this.angle=void 0!==d.angle?d.angle:0;const b=this.coneEquation=new Oh(r,h,d),N=this.twistEquation=new yl(r,h,d);this.twistAngle=void 0!==d.twistAngle?d.twistAngle:0,b.maxForce=0,b.minForce=-y,N.maxForce=0,N.minForce=-y,this.equations.push(b,N)}update(){const r=this.bodyA,h=this.bodyB,d=this.coneEquation,y=this.twistEquation;super.update(),r.vectorToWorldFrame(this.axisA,d.axisA),h.vectorToWorldFrame(this.axisB,d.axisB),this.axisA.tangents(y.axisA,y.axisA),r.vectorToWorldFrame(y.axisA,y.axisA),this.axisB.tangents(y.axisB,y.axisB),h.vectorToWorldFrame(y.axisB,y.axisB),d.angle=this.angle,y.maxAngle=this.twistAngle}}class gs extends uu{constructor(r,h,d,y=1e6){super(r,h),void 0===d&&(d=r.position.distanceTo(h.position)),this.distance=d;const b=this.distanceEquation=new Lo(r,h);this.equations.push(b),b.minForce=-y,b.maxForce=y}update(){const d=this.distanceEquation,y=.5*this.distance,b=d.ni;this.bodyB.position.vsub(this.bodyA.position,b),b.normalize(),b.scale(y,d.ri),b.scale(-y,d.rj)}}class Gl extends cc{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6,b=new M,N=new M,k=new M;r.position.vadd(h.position,k),k.scale(.5,k),h.pointToLocalFrame(k,N),r.pointToLocalFrame(k,b),super(r,b,h,N,y),this.xA=r.vectorToLocalFrame(M.UNIT_X),this.xB=h.vectorToLocalFrame(M.UNIT_X),this.yA=r.vectorToLocalFrame(M.UNIT_Y),this.yB=h.vectorToLocalFrame(M.UNIT_Y),this.zA=r.vectorToLocalFrame(M.UNIT_Z),this.zB=h.vectorToLocalFrame(M.UNIT_Z);const T=this.rotationalEquation1=new yl(r,h,d),H=this.rotationalEquation2=new yl(r,h,d),Y=this.rotationalEquation3=new yl(r,h,d);this.equations.push(T,H,Y)}update(){const r=this.bodyA,h=this.bodyB,d=this.rotationalEquation1,y=this.rotationalEquation2,b=this.rotationalEquation3;super.update(),r.vectorToWorldFrame(this.xA,d.axisA),h.vectorToWorldFrame(this.yB,d.axisB),r.vectorToWorldFrame(this.yA,y.axisA),h.vectorToWorldFrame(this.zB,y.axisB),r.vectorToWorldFrame(this.zA,b.axisA),h.vectorToWorldFrame(this.xB,b.axisB)}}class Du extends Ts{constructor(r,h,d=1e6){super(r,h,-d,d),this.axisA=new M,this.axisB=new M,this.targetVelocity=0}computeB(r){const h=this.b,y=this.axisB,N=this.jacobianElementB;return this.jacobianElementA.rotational.copy(this.axisA),y.negate(N.rotational),-(this.computeGW()-this.targetVelocity)*h-r*this.computeGiMf()}}class mp extends cc{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6;super(r,d.pivotA?d.pivotA.clone():new M,h,d.pivotB?d.pivotB.clone():new M,y),(this.axisA=d.axisA?d.axisA.clone():new M(1,0,0)).normalize(),(this.axisB=d.axisB?d.axisB.clone():new M(1,0,0)).normalize(),this.collideConnected=!!d.collideConnected;const b=this.rotationalEquation1=new yl(r,h,d),N=this.rotationalEquation2=new yl(r,h,d),k=this.motorEquation=new Du(r,h,y);k.enabled=!1,this.equations.push(b,N,k)}enableMotor(){this.motorEquation.enabled=!0}disableMotor(){this.motorEquation.enabled=!1}setMotorSpeed(r){this.motorEquation.targetVelocity=r}setMotorMaxForce(r){this.motorEquation.maxForce=r,this.motorEquation.minForce=-r}update(){const r=this.bodyA,h=this.bodyB,d=this.motorEquation,y=this.rotationalEquation1,b=this.rotationalEquation2,N=_p,k=zc,T=this.axisA,H=this.axisB;super.update(),r.quaternion.vmult(T,N),h.quaternion.vmult(H,k),N.tangents(y.axisA,b.axisA),y.axisB.copy(k),b.axisB.copy(k),this.motorEquation.enabled&&(r.quaternion.vmult(this.axisA,d.axisA),h.quaternion.vmult(this.axisB,d.axisB))}}const _p=new M,zc=new M;class uc extends Ts{constructor(r,h,d){super(r,h,-d,d),this.ri=new M,this.rj=new M,this.t=new M}computeB(r){const h=this.b,y=this.rj,b=mh,N=gp,k=this.t;this.ri.cross(k,b),y.cross(k,N);const T=this.jacobianElementA,H=this.jacobianElementB;return k.negate(T.spatial),b.negate(T.rotational),H.spatial.copy(k),H.rotational.copy(N),-this.computeGW()*h-r*this.computeGiMf()}}const mh=new M,gp=new M;class Uu{constructor(r,h,d){d=Ou.defaults(d,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=Uu.idCounter++,this.materials=[r,h],this.friction=d.friction,this.restitution=d.restitution,this.contactEquationStiffness=d.contactEquationStiffness,this.contactEquationRelaxation=d.contactEquationRelaxation,this.frictionEquationStiffness=d.frictionEquationStiffness,this.frictionEquationRelaxation=d.frictionEquationRelaxation}}Uu.idCounter=0;class zu{constructor(r={}){let h="";"string"==typeof r&&(h=r,r={}),this.name=h,this.id=zu.idCounter++,this.friction=void 0!==r.friction?r.friction:-1,this.restitution=void 0!==r.restitution?r.restitution:-1}}zu.idCounter=0;class tl{constructor(r,h,d={}){this.restLength="number"==typeof d.restLength?d.restLength:1,this.stiffness=d.stiffness||100,this.damping=d.damping||1,this.bodyA=r,this.bodyB=h,this.localAnchorA=new M,this.localAnchorB=new M,d.localAnchorA&&this.localAnchorA.copy(d.localAnchorA),d.localAnchorB&&this.localAnchorB.copy(d.localAnchorB),d.worldAnchorA&&this.setWorldAnchorA(d.worldAnchorA),d.worldAnchorB&&this.setWorldAnchorB(d.worldAnchorB)}setWorldAnchorA(r){this.bodyA.pointToLocalFrame(r,this.localAnchorA)}setWorldAnchorB(r){this.bodyB.pointToLocalFrame(r,this.localAnchorB)}getWorldAnchorA(r){this.bodyA.pointToWorldFrame(this.localAnchorA,r)}getWorldAnchorB(r){this.bodyB.pointToWorldFrame(this.localAnchorB,r)}applyForce(){const r=this.stiffness,h=this.damping,d=this.restLength,y=this.bodyA,b=this.bodyB,N=Fh,k=nl,T=Dh,H=ju,Y=Gc,le=hc,ae=pc,ge=_h,we=du,Se=jc,$e=vp;this.getWorldAnchorA(le),this.getWorldAnchorB(ae),le.vsub(y.position,ge),ae.vsub(b.position,we),ae.vsub(le,N);const Re=N.length();k.copy(N),k.normalize(),b.velocity.vsub(y.velocity,T),b.angularVelocity.cross(we,Y),T.vadd(Y,T),y.angularVelocity.cross(ge,Y),T.vsub(Y,T),k.scale(-r*(Re-d)-h*T.dot(k),H),y.force.vsub(H,y.force),b.force.vadd(H,b.force),ge.cross(H,Se),we.cross(H,$e),y.torque.vsub(Se,y.torque),b.torque.vadd($e,b.torque)}}const Fh=new M,nl=new M,Dh=new M,ju=new M,hc=new M,pc=new M,_h=new M,du=new M,jc=new M,vp=new M,Gc=new M;class Gu{constructor(r={}){r=Ou.defaults(r,{chassisConnectionPointLocal:new M,chassisConnectionPointWorld:new M,directionLocal:new M,directionWorld:new M,axleLocal:new M,axleWorld:new M,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,slipInfo:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=r.maxSuspensionTravel,this.customSlidingRotationalSpeed=r.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=r.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=r.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=r.chassisConnectionPointWorld.clone(),this.directionLocal=r.directionLocal.clone(),this.directionWorld=r.directionWorld.clone(),this.axleLocal=r.axleLocal.clone(),this.axleWorld=r.axleWorld.clone(),this.suspensionRestLength=r.suspensionRestLength,this.suspensionMaxLength=r.suspensionMaxLength,this.radius=r.radius,this.suspensionStiffness=r.suspensionStiffness,this.dampingCompression=r.dampingCompression,this.dampingRelaxation=r.dampingRelaxation,this.frictionSlip=r.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=r.rollInfluence,this.maxSuspensionForce=r.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=r.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.slipInfo=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new mi,this.worldTransform=new z,this.isInContact=!1}updateWheel(r){const h=this.raycastResult;if(this.isInContact){const d=h.hitNormalWorld.dot(h.directionWorld);h.hitPointWorld.vsub(r.position,yp),r.getVelocityAtWorldPoint(yp,Hl);const y=h.hitNormalWorld.dot(Hl);if(d>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{const b=-1/d;this.suspensionRelativeVelocity=y*b,this.clippedInvContactDotSuspension=b}}else h.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,h.directionWorld.scale(-1,h.hitNormalWorld),this.clippedInvContactDotSuspension=1}}const Hl=new M,yp=new M;class Uh{constructor(r){this.chassisBody=r.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==r.indexRightAxis?r.indexRightAxis:1,this.indexForwardAxis=void 0!==r.indexForwardAxis?r.indexForwardAxis:0,this.indexUpAxis=void 0!==r.indexUpAxis?r.indexUpAxis:2,this.constraints=[],this.preStepCallback=()=>{},this.currentVehicleSpeedKmHour=0}addWheel(r={}){const h=new Gu(r),d=this.wheelInfos.length;return this.wheelInfos.push(h),d}setSteeringValue(r,h){this.wheelInfos[h].steering=r}applyEngineForce(r,h){this.wheelInfos[h].engineForce=r}setBrake(r,h){this.wheelInfos[h].brake=r}addToWorld(r){r.addBody(this.chassisBody);const h=this;this.preStepCallback=()=>{h.updateVehicle(r.dt)},r.addEventListener("preStep",this.preStepCallback),this.world=r}getVehicleAxisWorld(r,h){h.set(0===r?1:0,1===r?1:0,2===r?1:0),this.chassisBody.vectorToWorldFrame(h,h)}updateVehicle(r){const h=this.wheelInfos,d=h.length,y=this.chassisBody;for(let le=0;le<d;le++)this.updateWheelTransform(le);this.currentVehicleSpeedKmHour=3.6*y.velocity.length();const b=new M;this.getVehicleAxisWorld(this.indexForwardAxis,b),b.dot(y.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(let le=0;le<d;le++)this.castRay(h[le]);this.updateSuspension(r);const N=new M,k=new M;for(let le=0;le<d;le++){const ae=h[le];let ge=ae.suspensionForce;ge>ae.maxSuspensionForce&&(ge=ae.maxSuspensionForce),ae.raycastResult.hitNormalWorld.scale(ge*r,N),ae.raycastResult.hitPointWorld.vsub(y.position,k),y.applyImpulse(N,k)}this.updateFriction(r);const T=new M,H=new M,Y=new M;for(let le=0;le<d;le++){const ae=h[le];y.getVelocityAtWorldPoint(ae.chassisConnectionPointWorld,Y);let ge=1;if(1===this.indexUpAxis&&(ge=-1),ae.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,H);const we=H.dot(ae.raycastResult.hitNormalWorld);ae.raycastResult.hitNormalWorld.scale(we,T),H.vsub(T,H);const Se=H.dot(Y);ae.deltaRotation=ge*Se*r/ae.radius}!ae.sliding&&ae.isInContact||0===ae.engineForce||!ae.useCustomSlidingRotationalSpeed||(ae.deltaRotation=(ae.engineForce>0?1:-1)*ae.customSlidingRotationalSpeed*r),Math.abs(ae.brake)>Math.abs(ae.engineForce)&&(ae.deltaRotation=0),ae.rotation+=ae.deltaRotation,ae.deltaRotation*=.99}}updateSuspension(r){const h=this.chassisBody.mass,d=this.wheelInfos,y=d.length;for(let b=0;b<y;b++){const N=d[b];if(N.isInContact){let k;k=N.suspensionStiffness*(N.suspensionRestLength-N.suspensionLength)*N.clippedInvContactDotSuspension;const H=N.suspensionRelativeVelocity;let Y;Y=H<0?N.dampingCompression:N.dampingRelaxation,k-=Y*H,N.suspensionForce=k*h,N.suspensionForce<0&&(N.suspensionForce=0)}else N.suspensionForce=0}}removeFromWorld(r){r.removeBody(this.chassisBody),r.removeEventListener("preStep",this.preStepCallback),this.world=null}castRay(r){const h=Wp,d=fu;this.updateWheelTransformWorld(r);const y=this.chassisBody;let b=-1;r.directionWorld.scale(r.suspensionRestLength+r.radius,h);const k=r.chassisConnectionPointWorld;k.vadd(h,d);const T=r.raycastResult;T.reset();const H=y.collisionResponse;y.collisionResponse=!1,this.world.rayTest(k,d,T),y.collisionResponse=H;const Y=T.body;if(r.raycastResult.groundObject=0,Y){b=T.distance,r.raycastResult.hitNormalWorld=T.hitNormalWorld,r.isInContact=!0,r.suspensionLength=T.distance-r.radius;const ae=r.suspensionRestLength-r.maxSuspensionTravel,ge=r.suspensionRestLength+r.maxSuspensionTravel;r.suspensionLength<ae&&(r.suspensionLength=ae),r.suspensionLength>ge&&(r.suspensionLength=ge,r.raycastResult.reset());const we=r.raycastResult.hitNormalWorld.dot(r.directionWorld),Se=new M;y.getVelocityAtWorldPoint(r.raycastResult.hitPointWorld,Se);const $e=r.raycastResult.hitNormalWorld.dot(Se);if(we>=-.1)r.suspensionRelativeVelocity=0,r.clippedInvContactDotSuspension=10;else{const Re=-1/we;r.suspensionRelativeVelocity=$e*Re,r.clippedInvContactDotSuspension=Re}}else r.suspensionLength=r.suspensionRestLength+0*r.maxSuspensionTravel,r.suspensionRelativeVelocity=0,r.directionWorld.scale(-1,r.raycastResult.hitNormalWorld),r.clippedInvContactDotSuspension=1;return b}updateWheelTransformWorld(r){r.isInContact=!1;const h=this.chassisBody;h.pointToWorldFrame(r.chassisConnectionPointLocal,r.chassisConnectionPointWorld),h.vectorToWorldFrame(r.directionLocal,r.directionWorld),h.vectorToWorldFrame(r.axleLocal,r.axleWorld)}updateWheelTransform(r){const h=bp,d=xp,y=zh,b=this.wheelInfos[r];this.updateWheelTransformWorld(b),b.directionLocal.scale(-1,h),d.copy(b.axleLocal),h.cross(d,y),y.normalize(),d.normalize();const N=b.steering,k=new Q;k.setFromAxisAngle(h,N);const T=new Q;T.setFromAxisAngle(d,b.rotation);const H=b.worldTransform.quaternion;this.chassisBody.quaternion.mult(k,H),H.mult(T,H),H.normalize();const Y=b.worldTransform.position;Y.copy(b.directionWorld),Y.scale(b.suspensionLength,Y),Y.vadd(b.chassisConnectionPointWorld,Y)}getWheelTransformWorld(r){return this.wheelInfos[r].worldTransform}updateFriction(r){const h=dc,d=this.wheelInfos,y=d.length,b=this.chassisBody,N=Wl,k=Vl;for(let T=0;T<y;T++){const H=d[T];H.sideImpulse=0,H.forwardImpulse=0,N[T]||(N[T]=new M),k[T]||(k[T]=new M)}for(let T=0;T<y;T++){const H=d[T],Y=H.raycastResult.body;if(Y){const le=k[T];this.getWheelTransformWorld(T).vectorToWorldFrame(Fa[this.indexRightAxis],le);const ae=H.raycastResult.hitNormalWorld,ge=le.dot(ae);ae.scale(ge,h),le.vsub(h,le),le.normalize(),ae.cross(le,N[T]),N[T].normalize(),H.sideImpulse=Gh(b,H.raycastResult.hitPointWorld,Y,H.raycastResult.hitPointWorld,le),H.sideImpulse*=Hu}}this.sliding=!1;for(let T=0;T<y;T++){const H=d[T],Y=H.raycastResult.body;let le=0;if(H.slipInfo=1,Y){const ge=H.brake?H.brake:0;le=Vu(b,Y,H.raycastResult.hitPointWorld,N[T],ge),le+=H.engineForce*r,H.slipInfo*=ge/le}if(H.forwardImpulse=0,H.skidInfo=1,Y){H.skidInfo=1;const ae=H.suspensionForce*r*H.frictionSlip,ge=ae*ae;H.forwardImpulse=le;const we=.5*H.forwardImpulse,Se=1*H.sideImpulse,$e=we*we+Se*Se;if(H.sliding=!1,$e>ge){this.sliding=!0,H.sliding=!0;const Re=ae/Math.sqrt($e);H.skidInfo*=Re}}}if(this.sliding)for(let T=0;T<y;T++){const H=d[T];0!==H.sideImpulse&&H.skidInfo<1&&(H.forwardImpulse*=H.skidInfo,H.sideImpulse*=H.skidInfo)}for(let T=0;T<y;T++){const H=d[T],Y=new M;if(H.raycastResult.hitPointWorld.vsub(b.position,Y),0!==H.forwardImpulse){const le=new M;N[T].scale(H.forwardImpulse,le),b.applyImpulse(le,Y)}if(0!==H.sideImpulse){const le=H.raycastResult.body,ae=new M;H.raycastResult.hitPointWorld.vsub(le.position,ae);const ge=new M;k[T].scale(H.sideImpulse,ge),b.vectorToLocalFrame(Y,Y),Y["xyz"[this.indexUpAxis]]*=H.rollInfluence,b.vectorToWorldFrame(Y,Y),b.applyImpulse(ge,Y),ge.scale(-1,ge),le.applyImpulse(ge,ae)}}}}const bp=new M,xp=new M,zh=new M,Wp=(new Nr,new M),fu=new M,Fa=[new M(1,0,0),new M(0,1,0),new M(0,0,1)],dc=new M,Vl=[],Wl=[],Hu=1,ba=new M,sa=new M,wl=new M;function Vu(a,r,h,d,y){let b=0;const N=h,k=ba,T=sa,H=wl;return a.getVelocityAtWorldPoint(N,k),r.getVelocityAtWorldPoint(N,T),k.vsub(T,H),b=-d.dot(H)*(1/(Ki(a,h,d)+Ki(r,h,d))),y<b&&(b=y),b<-y&&(b=-y),b}const Wu=new M,jh=new M,wp=new M,Sp=new M;function Ki(a,r,h){const d=Wu,y=jh,b=wp,N=Sp;return r.vsub(a.position,d),d.cross(h,y),a.invInertiaWorld.vmult(y,N),N.cross(d,b),a.invMass+h.dot(b)}const rl=new M,ql=new M,Hc=new M;function Gh(a,r,h,d,y){if(y.lengthSquared()>1.1)return 0;const b=rl,N=ql,k=Hc;return a.getVelocityAtWorldPoint(r,b),h.getVelocityAtWorldPoint(d,N),b.vsub(N,k),-.2*y.dot(k)*(1/(a.invMass+h.invMass))}class mc extends he{constructor(r){if(super({type:he.types.SPHERE}),this.radius=void 0!==r?r:1,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}calculateLocalInertia(r,h=new M){const d=2*r*this.radius*this.radius/5;return h.x=d,h.y=d,h.z=d,h}volume(){return 4*Math.PI*Math.pow(this.radius,3)/3}updateBoundingSphereRadius(){this.boundingSphereRadius=this.radius}calculateWorldAABB(r,h,d,y){const b=this.radius,N=["x","y","z"];for(let k=0;k<N.length;k++){const T=N[k];d[T]=r[T]-b,y[T]=r[T]+b}}}class qu{constructor(r={}){this.wheelBodies=[],this.coordinateSystem=void 0!==r.coordinateSystem?r.coordinateSystem.clone():new M(1,2,3),this.chassisBody=r.chassisBody?r.chassisBody:new ht({mass:1,shape:new je(new M(5,2,.5))}),this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}addWheel(r={}){let h;h=r.body?r.body:new ht({mass:1,shape:new mc(1.2)}),this.wheelBodies.push(h),this.wheelForces.push(0);const d=void 0!==r.position?r.position.clone():new M,y=new M;this.chassisBody.pointToWorldFrame(d,y),h.position.set(y.x,y.y,y.z);const b=void 0!==r.axis?r.axis.clone():new M(0,1,0);this.wheelAxes.push(b);const N=new mp(this.chassisBody,h,{pivotA:d,axisA:b,pivotB:M.ZERO,axisB:b,collideConnected:!1});return this.constraints.push(N),this.wheelBodies.length-1}setSteeringValue(r,h){const d=this.wheelAxes[h],y=Math.cos(r),b=Math.sin(r),N=d.x,k=d.y;this.constraints[h].axisA.set(y*N-b*k,b*N+y*k,0)}setMotorSpeed(r,h){const d=this.constraints[h];d.enableMotor(),d.motorTargetVelocity=r}disableMotor(r){this.constraints[r].disableMotor()}setWheelForce(r,h){this.wheelForces[h]=r}applyWheelForce(r,h){const y=this.wheelBodies[h],b=y.torque;this.wheelAxes[h].scale(r,mu),y.vectorToWorldFrame(mu,mu),b.vadd(mu,b)}addToWorld(r){const h=this.constraints,d=this.wheelBodies.concat([this.chassisBody]);for(let y=0;y<d.length;y++)r.addBody(d[y]);for(let y=0;y<h.length;y++)r.addConstraint(h[y]);r.addEventListener("preStep",this._update.bind(this))}_update(){const r=this.wheelForces;for(let h=0;h<r.length;h++)this.applyWheelForce(r[h],h)}removeFromWorld(r){const h=this.constraints,d=this.wheelBodies.concat([this.chassisBody]);for(let y=0;y<d.length;y++)r.removeBody(d[y]);for(let y=0;y<h.length;y++)r.removeConstraint(h[y])}getWheelSpeed(r){const d=this.wheelBodies[r].angularVelocity;return this.chassisBody.vectorToWorldFrame(this.wheelAxes[r],q),d.dot(q)}}const mu=new M,q=new M;class pe{constructor(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}add(r){this.particles.push(r),this.neighbors.length<this.particles.length&&this.neighbors.push([])}remove(r){const h=this.particles.indexOf(r);-1!==h&&(this.particles.splice(h,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())}getNeighbors(r,h){const d=this.particles.length,y=r.id,b=this.smoothingRadius*this.smoothingRadius,N=Ee;for(let k=0;k!==d;k++){const T=this.particles[k];T.position.vsub(r.position,N),y!==T.id&&N.lengthSquared()<b&&h.push(T)}}update(){const r=this.particles.length,h=Ce,d=this.speedOfSound,y=this.eps;for(let Y=0;Y!==r;Y++){const le=this.particles[Y],ae=this.neighbors[Y];ae.length=0,this.getNeighbors(le,ae),ae.push(this.particles[Y]);const ge=ae.length;let we=0;for(let Se=0;Se!==ge;Se++){le.position.vsub(ae[Se].position,h);const $e=h.length(),Re=this.w($e);we+=ae[Se].mass*Re}this.densities[Y]=we,this.pressures[Y]=d*d*(this.densities[Y]-this.density)}const b=He,N=Ve,k=et,T=Et,H=At;for(let Y=0;Y!==r;Y++){const le=this.particles[Y];let ae,ge;b.set(0,0,0),N.set(0,0,0);const we=this.neighbors[Y],Se=we.length;for(let $e=0;$e!==Se;$e++){const Re=we[$e];le.position.vsub(Re.position,T);const Pe=T.length();ae=-Re.mass*(this.pressures[Y]/(this.densities[Y]*this.densities[Y]+y)+this.pressures[$e]/(this.densities[$e]*this.densities[$e]+y)),this.gradw(T,k),k.scale(ae,k),b.vadd(k,b),Re.velocity.vsub(le.velocity,H),H.scale(1/(1e-4+this.densities[Y]*this.densities[$e])*this.viscosity*Re.mass,H),ge=this.nablaw(Pe),H.scale(ge,H),N.vadd(H,N)}N.scale(le.mass,N),b.scale(le.mass,b),le.force.vadd(N,le.force),le.force.vadd(b,le.force)}}w(r){const h=this.smoothingRadius;return 315/(64*Math.PI*h**9)*(h*h-r*r)**3}gradw(r,h){const d=r.length(),y=this.smoothingRadius;r.scale(945/(32*Math.PI*y**9)*(y*y-d*d)**2,h)}nablaw(r){const h=this.smoothingRadius;return 945/(32*Math.PI*h**9)*(h*h-r*r)*(7*r*r-3*h*h)}}const Ee=new M,Ce=new M,He=new M,Ve=new M,et=new M,Et=new M,At=new M;class Yt extends K{constructor(r,h,d,y){const b=y,N=[],k=[],T=[],H=[],Y=[],le=Math.cos,ae=Math.sin;N.push(new M(h*le(0),h*ae(0),.5*-d)),H.push(0),N.push(new M(r*le(0),r*ae(0),.5*d)),Y.push(1);for(let we=0;we<b;we++){const Se=2*Math.PI/b*(we+1),$e=2*Math.PI/b*(we+.5);we<b-1?(N.push(new M(h*le(Se),h*ae(Se),.5*-d)),H.push(2*we+2),N.push(new M(r*le(Se),r*ae(Se),.5*d)),Y.push(2*we+3),T.push([2*we+2,2*we+3,2*we+1,2*we])):T.push([0,1,2*we+1,2*we]),(b%2==1||we<b/2)&&k.push(new M(le($e),ae($e),0))}T.push(Y),k.push(new M(0,0,1));const ge=[];for(let we=0;we<H.length;we++)ge.push(H[H.length-we-1]);T.push(ge),super({vertices:N,faces:T,axes:k})}}class dn extends he{constructor(){super({type:he.types.PARTICLE})}calculateLocalInertia(r,h=new M){return h.set(0,0,0),h}volume(){return 0}updateBoundingSphereRadius(){this.boundingSphereRadius=0}calculateWorldAABB(r,h,d,y){d.copy(r),y.copy(r)}}class kn extends he{constructor(){super({type:he.types.PLANE}),this.worldNormal=new M,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}computeWorldNormal(r){const h=this.worldNormal;h.set(0,0,1),r.vmult(h,h),this.worldNormalNeedsUpdate=!1}calculateLocalInertia(r,h=new M){return h}volume(){return Number.MAX_VALUE}calculateWorldAABB(r,h,d,y){nn.set(0,0,1),h.vmult(nn,nn);const b=Number.MAX_VALUE;d.set(-b,-b,-b),y.set(b,b,b),1===nn.x?y.x=r.x:-1===nn.x&&(d.x=r.x),1===nn.y?y.y=r.y:-1===nn.y&&(d.y=r.y),1===nn.z?y.z=r.z:-1===nn.z&&(d.z=r.z)}updateBoundingSphereRadius(){this.boundingSphereRadius=Number.MAX_VALUE}}const nn=new M;class wn extends he{constructor(r,h={}){h=Ou.defaults(h,{maxValue:null,minValue:null,elementSize:1}),super({type:he.types.HEIGHTFIELD}),this.data=r,this.maxValue=h.maxValue,this.minValue=h.minValue,this.elementSize=h.elementSize,null===h.minValue&&this.updateMinValue(),null===h.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,this.pillarConvex=new K,this.pillarOffset=new M,this.updateBoundingSphereRadius(),this._cachedPillars={}}update(){this._cachedPillars={}}updateMinValue(){const r=this.data;let h=r[0][0];for(let d=0;d!==r.length;d++)for(let y=0;y!==r[d].length;y++){const b=r[d][y];b<h&&(h=b)}this.minValue=h}updateMaxValue(){const r=this.data;let h=r[0][0];for(let d=0;d!==r.length;d++)for(let y=0;y!==r[d].length;y++){const b=r[d][y];b>h&&(h=b)}this.maxValue=h}setHeightValueAtIndex(r,h,d){this.data[r][h]=d,this.clearCachedConvexTrianglePillar(r,h,!1),r>0&&(this.clearCachedConvexTrianglePillar(r-1,h,!0),this.clearCachedConvexTrianglePillar(r-1,h,!1)),h>0&&(this.clearCachedConvexTrianglePillar(r,h-1,!0),this.clearCachedConvexTrianglePillar(r,h-1,!1)),h>0&&r>0&&this.clearCachedConvexTrianglePillar(r-1,h-1,!0)}getRectMinMax(r,h,d,y,b=[]){const N=this.data;let k=this.minValue;for(let T=r;T<=d;T++)for(let H=h;H<=y;H++){const Y=N[T][H];Y>k&&(k=Y)}b[0]=this.minValue,b[1]=k}getIndexOfPosition(r,h,d,y){const b=this.elementSize,N=this.data;let k=Math.floor(r/b),T=Math.floor(h/b);return d[0]=k,d[1]=T,y&&(k<0&&(k=0),T<0&&(T=0),k>=N.length-1&&(k=N.length-1),T>=N[0].length-1&&(T=N[0].length-1)),!(k<0||T<0||k>=N.length-1||T>=N[0].length-1)}getTriangleAt(r,h,d,y,b,N){const k=wr;this.getIndexOfPosition(r,h,k,d);let T=k[0],H=k[1];const Y=this.data;d&&(T=Math.min(Y.length-2,Math.max(0,T)),H=Math.min(Y[0].length-2,Math.max(0,H)));const le=this.elementSize,ae=(r/le-T)**2+(h/le-H)**2>(r/le-(T+1))**2+(h/le-(H+1))**2;return this.getTriangle(T,H,ae,y,b,N),ae}getNormalAt(r,h,d,y){const b=aa,N=yi,k=Lr,T=Da,H=Vi;this.getTriangleAt(r,h,d,b,N,k),N.vsub(b,T),k.vsub(b,H),T.cross(H,y),y.normalize()}getAabbAtIndex(r,h,{lowerBound:d,upperBound:y}){const b=this.data,N=this.elementSize;d.set(r*N,h*N,b[r][h]),y.set((r+1)*N,(h+1)*N,b[r+1][h+1])}getHeightAt(r,h,d){const y=this.data,b=Tr,N=vs,k=Qo,T=wr;this.getIndexOfPosition(r,h,T,d);let H=T[0],Y=T[1];d&&(H=Math.min(y.length-2,Math.max(0,H)),Y=Math.min(y[0].length-2,Math.max(0,Y)));const le=this.getTriangleAt(r,h,d,b,N,k);var ge,we,Se,$e,Re,Pe,Oe,Fe,De;return(De=ei).x=(((Pe=N.y)-(Fe=k.y))*((ge=r)-(Oe=k.x))+(Oe-(Re=N.x))*((we=h)-Fe))/((Pe-Fe)*((Se=b.x)-Oe)+(Oe-Re)*(($e=b.y)-Fe)),De.y=((Fe-$e)*(ge-Oe)+(Se-Oe)*(we-Fe))/((Pe-Fe)*(Se-Oe)+(Oe-Re)*($e-Fe)),De.z=1-De.x-De.y,le?y[H+1][Y+1]*ei.x+y[H][Y+1]*ei.y+y[H+1][Y]*ei.z:y[H][Y]*ei.x+y[H+1][Y]*ei.y+y[H][Y+1]*ei.z}getCacheConvexTrianglePillarKey(r,h,d){return r+"_"+h+"_"+(d?1:0)}getCachedConvexTrianglePillar(r,h,d){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,d)]}setCachedConvexTrianglePillar(r,h,d,y,b){this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,d)]={convex:y,offset:b}}clearCachedConvexTrianglePillar(r,h,d){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,d)]}getTriangle(r,h,d,y,b,N){const k=this.data,T=this.elementSize;d?(y.set((r+1)*T,(h+1)*T,k[r+1][h+1]),b.set(r*T,(h+1)*T,k[r][h+1]),N.set((r+1)*T,h*T,k[r+1][h])):(y.set(r*T,h*T,k[r][h]),b.set((r+1)*T,h*T,k[r+1][h]),N.set(r*T,(h+1)*T,k[r][h+1]))}getConvexTrianglePillar(r,h,d){let y=this.pillarConvex,b=this.pillarOffset;if(this.cacheEnabled){const le=this.getCachedConvexTrianglePillar(r,h,d);if(le)return this.pillarConvex=le.convex,void(this.pillarOffset=le.offset);y=new K,b=new M,this.pillarConvex=y,this.pillarOffset=b}const N=this.data,k=this.elementSize,T=y.faces;y.vertices.length=6;for(let le=0;le<6;le++)y.vertices[le]||(y.vertices[le]=new M);T.length=5;for(let le=0;le<5;le++)T[le]||(T[le]=[]);const H=y.vertices,Y=(Math.min(N[r][h],N[r+1][h],N[r][h+1],N[r+1][h+1])-this.minValue)/2+this.minValue;d?(b.set((r+.75)*k,(h+.75)*k,Y),H[0].set(.25*k,.25*k,N[r+1][h+1]-Y),H[1].set(-.75*k,.25*k,N[r][h+1]-Y),H[2].set(.25*k,-.75*k,N[r+1][h]-Y),H[3].set(.25*k,.25*k,-Y-1),H[4].set(-.75*k,.25*k,-Y-1),H[5].set(.25*k,-.75*k,-Y-1),T[0][0]=0,T[0][1]=1,T[0][2]=2,T[1][0]=5,T[1][1]=4,T[1][2]=3,T[2][0]=2,T[2][1]=5,T[2][2]=3,T[2][3]=0,T[3][0]=3,T[3][1]=4,T[3][2]=1,T[3][3]=0,T[4][0]=1,T[4][1]=4,T[4][2]=5,T[4][3]=2):(b.set((r+.25)*k,(h+.25)*k,Y),H[0].set(-.25*k,-.25*k,N[r][h]-Y),H[1].set(.75*k,-.25*k,N[r+1][h]-Y),H[2].set(-.25*k,.75*k,N[r][h+1]-Y),H[3].set(-.25*k,-.25*k,-Y-1),H[4].set(.75*k,-.25*k,-Y-1),H[5].set(-.25*k,.75*k,-Y-1),T[0][0]=0,T[0][1]=1,T[0][2]=2,T[1][0]=5,T[1][1]=4,T[1][2]=3,T[2][0]=0,T[2][1]=2,T[2][2]=5,T[2][3]=3,T[3][0]=1,T[3][1]=0,T[3][2]=3,T[3][3]=4,T[4][0]=4,T[4][1]=5,T[4][2]=2,T[4][3]=1),y.computeNormals(),y.computeEdges(),y.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(r,h,d,y,b)}calculateLocalInertia(r,h=new M){return h.set(0,0,0),h}volume(){return Number.MAX_VALUE}calculateWorldAABB(r,h,d,y){d.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),y.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}updateBoundingSphereRadius(){const r=this.data,h=this.elementSize;this.boundingSphereRadius=new M(r.length*h,r[0].length*h,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).length()}setHeightsFromImage(r,h){const{x:d,z:y,y:b}=h,N=document.createElement("canvas");N.width=r.width,N.height=r.height;const k=N.getContext("2d");k.drawImage(r,0,0);const T=k.getImageData(0,0,r.width,r.height),H=this.data;H.length=0,this.elementSize=Math.abs(d)/T.width;for(let Y=0;Y<T.height;Y++){const le=[];for(let ae=0;ae<T.width;ae++){const ge=(T.data[4*(Y*T.height+ae)]+T.data[4*(Y*T.height+ae)+1]+T.data[4*(Y*T.height+ae)+2])/4/255*y;d<0?le.push(ge):le.unshift(ge)}b<0?H.unshift(le):H.push(le)}this.updateMaxValue(),this.updateMinValue(),this.update()}}const wr=[],ei=new M,Tr=new M,vs=new M,Qo=new M,aa=new M,yi=new M,Lr=new M,Da=new M,Vi=new M;class Xi{constructor(r={}){this.root=r.root||null,this.aabb=r.aabb?r.aabb.clone():new ne,this.data=[],this.children=[]}reset(){this.children.length=this.data.length=0}insert(r,h,d=0){const y=this.data;if(!this.aabb.contains(r))return!1;const b=this.children;if(d<(this.maxDepth||this.root.maxDepth)){let N=!1;b.length||(this.subdivide(),N=!0);for(let k=0;8!==k;k++)if(b[k].insert(r,h,d+1))return!0;N&&(b.length=0)}return y.push(h),!0}subdivide(){const r=this.aabb,h=r.lowerBound,d=r.upperBound,y=this.children;y.push(new Xi({aabb:new ne({lowerBound:new M(0,0,0)})}),new Xi({aabb:new ne({lowerBound:new M(1,0,0)})}),new Xi({aabb:new ne({lowerBound:new M(1,1,0)})}),new Xi({aabb:new ne({lowerBound:new M(1,1,1)})}),new Xi({aabb:new ne({lowerBound:new M(0,1,1)})}),new Xi({aabb:new ne({lowerBound:new M(0,0,1)})}),new Xi({aabb:new ne({lowerBound:new M(1,0,1)})}),new Xi({aabb:new ne({lowerBound:new M(0,1,0)})})),d.vsub(h,_c),_c.scale(.5,_c);const b=this.root||this;for(let N=0;8!==N;N++){const k=y[N];k.root=b;const T=k.aabb.lowerBound;T.x*=_c.x,T.y*=_c.y,T.z*=_c.z,T.vadd(h,T),T.vadd(_c,k.aabb.upperBound)}}aabbQuery(r,h){const d=[this];for(;d.length;){const y=d.pop();y.aabb.overlaps(r)&&Array.prototype.push.apply(h,y.data),Array.prototype.push.apply(d,y.children)}return h}rayQuery(r,h,d){return r.getAABB(la),la.toLocalFrame(h,la),this.aabbQuery(la,d),d}removeEmptyNodes(){for(let r=this.children.length-1;r>=0;r--)this.children[r].removeEmptyNodes(),this.children[r].children.length||this.children[r].data.length||this.children.splice(r,1)}}class Hh extends Xi{constructor(r,h={}){super({root:null,aabb:r}),this.maxDepth=void 0!==h.maxDepth?h.maxDepth:8}}const _c=new M,la=new ne;class il extends he{constructor(r,h){super({type:he.types.TRIMESH}),this.vertices=new Float32Array(r),this.indices=new Int16Array(h),this.normals=new Float32Array(h.length),this.aabb=new ne,this.edges=null,this.scale=new M(1,1,1),this.tree=new Hh,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}updateTree(){const r=this.tree;r.reset(),r.aabb.copy(this.aabb);const h=this.scale;r.aabb.lowerBound.x*=1/h.x,r.aabb.lowerBound.y*=1/h.y,r.aabb.lowerBound.z*=1/h.z,r.aabb.upperBound.x*=1/h.x,r.aabb.upperBound.y*=1/h.y,r.aabb.upperBound.z*=1/h.z;const d=new ne,y=new M,b=new M,N=new M,k=[y,b,N];for(let T=0;T<this.indices.length/3;T++){const H=3*T;this._getUnscaledVertex(this.indices[H],y),this._getUnscaledVertex(this.indices[H+1],b),this._getUnscaledVertex(this.indices[H+2],N),d.setFromPoints(k),r.insert(d,T)}r.removeEmptyNodes()}getTrianglesInAABB(r,h){ki.copy(r);const d=this.scale,y=d.x,b=d.y,N=d.z,k=ki.lowerBound,T=ki.upperBound;return k.x/=y,k.y/=b,k.z/=N,T.x/=y,T.y/=b,T.z/=N,this.tree.aabbQuery(ki,h)}setScale(r){this.scale.x===this.scale.y&&this.scale.y===this.scale.z&&r.x===r.y&&r.y===r.z||this.updateNormals(),this.scale.copy(r),this.updateAABB(),this.updateBoundingSphereRadius()}updateNormals(){const r=ca,h=this.normals;for(let d=0;d<this.indices.length/3;d++){const y=3*d,N=this.indices[y+1],k=this.indices[y+2];this.getVertex(this.indices[y],ss),this.getVertex(N,eo),this.getVertex(k,Gr),il.computeNormal(eo,ss,Gr,r),h[y]=r.x,h[y+1]=r.y,h[y+2]=r.z}}updateEdges(){const r={},h=(y,b)=>{r[y<b?y+"_"+b:b+"_"+y]=!0};for(let y=0;y<this.indices.length/3;y++){const b=3*y,N=this.indices[b],k=this.indices[b+1],T=this.indices[b+2];h(N,k),h(k,T),h(T,N)}const d=Object.keys(r);this.edges=new Int16Array(2*d.length);for(let y=0;y<d.length;y++){const b=d[y].split("_");this.edges[2*y]=parseInt(b[0],10),this.edges[2*y+1]=parseInt(b[1],10)}}getEdgeVertex(r,h,d){this.getVertex(this.edges[2*r+(h?1:0)],d)}getEdgeVector(r,h){const d=Os,y=er;this.getEdgeVertex(r,0,d),this.getEdgeVertex(r,1,y),y.vsub(d,h)}getVertex(r,h){const d=this.scale;return this._getUnscaledVertex(r,h),h.x*=d.x,h.y*=d.y,h.z*=d.z,h}_getUnscaledVertex(r,h){const d=3*r,y=this.vertices;return h.set(y[d],y[d+1],y[d+2])}getWorldVertex(r,h,d,y){return this.getVertex(r,y),z.pointToWorldFrame(h,d,y,y),y}getTriangleVertices(r,h,d,y){const b=3*r;this.getVertex(this.indices[b],h),this.getVertex(this.indices[b+1],d),this.getVertex(this.indices[b+2],y)}getNormal(r,h){const d=3*r;return h.set(this.normals[d],this.normals[d+1],this.normals[d+2])}calculateLocalInertia(r,h){this.computeLocalAABB(di);const d=di.upperBound.x-di.lowerBound.x,y=di.upperBound.y-di.lowerBound.y,b=di.upperBound.z-di.lowerBound.z;return h.set(1/12*r*(2*y*2*y+2*b*2*b),1/12*r*(2*d*2*d+2*b*2*b),1/12*r*(2*y*2*y+2*d*2*d))}computeLocalAABB(r){const h=r.lowerBound,d=r.upperBound,y=this.vertices.length,b=bi;this.getVertex(0,b),h.copy(b),d.copy(b);for(let N=0;N!==y;N++)this.getVertex(N,b),b.x<h.x?h.x=b.x:b.x>d.x&&(d.x=b.x),b.y<h.y?h.y=b.y:b.y>d.y&&(d.y=b.y),b.z<h.z?h.z=b.z:b.z>d.z&&(d.z=b.z)}updateAABB(){this.computeLocalAABB(this.aabb)}updateBoundingSphereRadius(){let r=0;const h=this.vertices,d=new M;for(let y=0,b=h.length/3;y!==b;y++){this.getVertex(y,d);const N=d.lengthSquared();N>r&&(r=N)}this.boundingSphereRadius=Math.sqrt(r)}calculateWorldAABB(r,h,d,y){const b=ks,N=Vh;b.position=r,b.quaternion=h,this.aabb.toWorldFrame(b,N),d.copy(N.lowerBound),y.copy(N.upperBound)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}}const ca=new M,ki=new ne,Os=new M,er=new M,Sn=new M,jo=new M;il.computeNormal=(a,r,h,d)=>{r.vsub(a,jo),h.vsub(r,Sn),Sn.cross(jo,d),d.isZero()||d.normalize()};const ss=new M,eo=new M,Gr=new M,di=new ne,bi=new M,ks=new z,Vh=new ne;il.createTorus=(a=1,r=.5,h=8,d=6,y=2*Math.PI)=>{const b=[],N=[];for(let k=0;k<=h;k++)for(let T=0;T<=d;T++){const H=T/d*y,Y=k/h*Math.PI*2,le=(a+r*Math.cos(Y))*Math.cos(H),ae=(a+r*Math.cos(Y))*Math.sin(H),ge=r*Math.sin(Y);b.push(le,ae,ge)}for(let k=1;k<=h;k++)for(let T=1;T<=d;T++){const Y=(d+1)*(k-1)+T-1,le=(d+1)*(k-1)+T,ae=(d+1)*k+T;N.push((d+1)*k+T-1,Y,ae),N.push(Y,le,ae)}return new il(b,N)};class So{constructor(){this.equations=[]}solve(r,h){return 0}addEquation(r){r.enabled&&this.equations.push(r)}removeEquation(r){const h=this.equations,d=h.indexOf(r);-1!==d&&h.splice(d,1)}removeAllEquations(){this.equations.length=0}}class _u extends So{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(r,h){let d=0;const y=this.iterations,b=this.tolerance*this.tolerance,N=this.equations,k=N.length,T=h.bodies,H=T.length,Y=r;let le,ae,ge,we,Se,$e;if(0!==k)for(let Fe=0;Fe!==H;Fe++)T[Fe].updateSolveMassProperties();const Re=ot,Pe=Sl,Oe=Un;Re.length=k,Pe.length=k,Oe.length=k;for(let Fe=0;Fe!==k;Fe++){const De=N[Fe];Oe[Fe]=0,Pe[Fe]=De.computeB(Y),Re[Fe]=1/De.computeC()}if(0!==k){for(let Qe=0;Qe!==H;Qe++){const it=T[Qe],_t=it.wlambda;it.vlambda.set(0,0,0),_t.set(0,0,0)}for(d=0;d!==y;d++){we=0;for(let Qe=0;Qe!==k;Qe++){const it=N[Qe];le=Pe[Qe],ae=Re[Qe],$e=Oe[Qe],Se=it.computeGWlambda(),ge=ae*(le-Se-it.eps*$e),$e+ge<it.minForce?ge=it.minForce-$e:$e+ge>it.maxForce&&(ge=it.maxForce-$e),Oe[Qe]+=ge,we+=ge>0?ge:-ge,it.addToWlambda(ge)}if(we*we<b)break}for(let Qe=0;Qe!==H;Qe++){const it=T[Qe],ct=it.velocity,_t=it.angularVelocity;it.vlambda.vmul(it.linearFactor,it.vlambda),ct.vadd(it.vlambda,ct),it.wlambda.vmul(it.angularFactor,it.wlambda),_t.vadd(it.wlambda,_t)}let Fe=N.length;const De=1/Y;for(;Fe--;)N[Fe].multiplier=Oe[Fe]*De}return d}}const Un=[],ot=[],Sl=[];class Ms extends So{constructor(r){for(super(),this.iterations=10,this.tolerance=1e-7,this.subsolver=r,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}createNode(){return{body:null,children:[],eqs:[],visited:!1}}solve(r,h){const d=Ep,y=this.nodePool,b=h.bodies,N=this.equations,k=N.length,T=b.length,H=this.subsolver;for(;y.length<T;)y.push(this.createNode());d.length=T;for(let we=0;we<T;we++)d[we]=y[we];for(let we=0;we!==T;we++){const Se=d[we];Se.body=b[we],Se.children.length=0,Se.eqs.length=0,Se.visited=!1}for(let we=0;we!==k;we++){const Se=N[we],$e=b.indexOf(Se.bi),Re=b.indexOf(Se.bj),Pe=d[$e],Oe=d[Re];Pe.children.push(Oe),Pe.eqs.push(Se),Oe.children.push(Pe),Oe.eqs.push(Se)}let Y,le=0,ae=As;H.tolerance=this.tolerance,H.iterations=this.iterations;const ge=vc;for(;Y=lo(d);){ae.length=0,ge.bodies.length=0,Vc(Y,Ci,ge.bodies,ae);const we=ae.length;ae=ae.sort(at);for(let Se=0;Se!==we;Se++)H.addEquation(ae[Se]);H.solve(r,ge),H.removeAllEquations(),le++}return le}}const Ep=[],As=[],vc={bodies:[]},ji=ht.STATIC;function lo(a){const r=a.length;for(let h=0;h!==r;h++){const d=a[h];if(!(d.visited||d.body.type&ji))return d}return!1}const ni=[];function Vc(a,r,h,d){for(ni.push(a),a.visited=!0,r(a,h,d);ni.length;){const y=ni.pop();let b;for(;b=lo(y.children);)b.visited=!0,r(b,h,d),ni.push(b)}}function Ci(a,r,h){r.push(a.body);const d=a.eqs.length;for(let y=0;y!==d;y++){const b=a.eqs[y];h.includes(b)||h.push(b)}}function at(a,r){return r.id-a.id}class gu{constructor(){this.objects=[],this.type=Object}release(...r){const h=r.length;for(let d=0;d!==h;d++)this.objects.push(r[d]);return this}get(){return 0===this.objects.length?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(r){const h=this.objects;for(;h.length>r;)h.pop();for(;h.length<r;)h.push(this.constructObject());return this}}class Tp extends gu{constructor(){super(),this.type=M}constructObject(){return new M}}const Gi={sphereSphere:he.types.SPHERE,spherePlane:he.types.SPHERE|he.types.PLANE,boxBox:0|he.types.BOX,sphereBox:he.types.SPHERE|he.types.BOX,planeBox:he.types.PLANE|he.types.BOX,convexConvex:he.types.CONVEXPOLYHEDRON,sphereConvex:he.types.SPHERE|he.types.CONVEXPOLYHEDRON,planeConvex:he.types.PLANE|he.types.CONVEXPOLYHEDRON,boxConvex:he.types.BOX|he.types.CONVEXPOLYHEDRON,sphereHeightfield:he.types.SPHERE|he.types.HEIGHTFIELD,boxHeightfield:he.types.BOX|he.types.HEIGHTFIELD,convexHeightfield:he.types.CONVEXPOLYHEDRON|he.types.HEIGHTFIELD,sphereParticle:he.types.PARTICLE|he.types.SPHERE,planeParticle:he.types.PLANE|he.types.PARTICLE,boxParticle:he.types.BOX|he.types.PARTICLE,convexParticle:he.types.PARTICLE|he.types.CONVEXPOLYHEDRON,sphereTrimesh:he.types.SPHERE|he.types.TRIMESH,planeTrimesh:he.types.PLANE|he.types.TRIMESH};class kr{constructor(r){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new Tp,this.world=r,this.currentContactMaterial=r.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(r,h,d,y,b,N){let k;this.contactPointPool.length?(k=this.contactPointPool.pop(),k.bi=r,k.bj=h):k=new Lo(r,h),k.enabled=r.collisionResponse&&h.collisionResponse&&d.collisionResponse&&y.collisionResponse;const T=this.currentContactMaterial;k.restitution=T.restitution,k.setSpookParams(T.contactEquationStiffness,T.contactEquationRelaxation,this.world.dt);const H=d.material||r.material,Y=y.material||h.material;return H&&Y&&H.restitution>=0&&Y.restitution>=0&&(k.restitution=H.restitution*Y.restitution),k.si=b||d,k.sj=N||y,k}createFrictionEquationsFromContact(r,h){const d=r.bi,y=r.bj,k=this.world,T=this.currentContactMaterial;let H=T.friction;const Y=r.si.material||d.material,le=r.sj.material||y.material;if(Y&&le&&Y.friction>=0&&le.friction>=0&&(H=Y.friction*le.friction),H>0){const ae=H*k.gravity.length();let ge=d.invMass+y.invMass;ge>0&&(ge=1/ge);const we=this.frictionEquationPool,Se=we.length?we.pop():new uc(d,y,ae*ge),$e=we.length?we.pop():new uc(d,y,ae*ge);return Se.bi=$e.bi=d,Se.bj=$e.bj=y,Se.minForce=$e.minForce=-ae*ge,Se.maxForce=$e.maxForce=ae*ge,Se.ri.copy(r.ri),Se.rj.copy(r.rj),$e.ri.copy(r.ri),$e.rj.copy(r.rj),r.ni.tangents(Se.t,$e.t),Se.setSpookParams(T.frictionEquationStiffness,T.frictionEquationRelaxation,k.dt),$e.setSpookParams(T.frictionEquationStiffness,T.frictionEquationRelaxation,k.dt),Se.enabled=$e.enabled=r.enabled,h.push(Se,$e),!0}return!1}createFrictionFromAverage(r){let h=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(h,this.frictionResult)||1===r)return;const d=this.frictionResult[this.frictionResult.length-2],y=this.frictionResult[this.frictionResult.length-1];Wr.setZero(),Ua.setZero(),Eo.setZero();const b=h.bi;for(let k=0;k!==r;k++)h=this.result[this.result.length-1-k],h.bi!==b?(Wr.vadd(h.ni,Wr),Ua.vadd(h.ri,Ua),Eo.vadd(h.rj,Eo)):(Wr.vsub(h.ni,Wr),Ua.vadd(h.rj,Ua),Eo.vadd(h.ri,Eo));const N=1/r;Ua.scale(N,d.ri),Eo.scale(N,d.rj),y.ri.copy(d.ri),y.rj.copy(d.rj),Wr.normalize(),Wr.tangents(d.t,y.t)}getContacts(r,h,d,y,b,N,k){this.contactPointPool=b,this.frictionEquationPool=k,this.result=y,this.frictionResult=N;const T=yc,H=Wc,Y=ua,le=vu;for(let ae=0,ge=r.length;ae!==ge;ae++){const we=r[ae],Se=h[ae];let $e=null;we.material&&Se.material&&($e=d.getContactMaterial(we.material,Se.material)||null);const Re=we.type&ht.KINEMATIC&&Se.type&ht.STATIC||we.type&ht.STATIC&&Se.type&ht.KINEMATIC||we.type&ht.KINEMATIC&&Se.type&ht.KINEMATIC;for(let Pe=0;Pe<we.shapes.length;Pe++){we.quaternion.mult(we.shapeOrientations[Pe],T),we.quaternion.vmult(we.shapeOffsets[Pe],Y),Y.vadd(we.position,Y);const Oe=we.shapes[Pe];for(let Fe=0;Fe<Se.shapes.length;Fe++){Se.quaternion.mult(Se.shapeOrientations[Fe],H),Se.quaternion.vmult(Se.shapeOffsets[Fe],le),le.vadd(Se.position,le);const De=Se.shapes[Fe];if(!(Oe.collisionFilterMask&De.collisionFilterGroup&&De.collisionFilterMask&Oe.collisionFilterGroup)||Y.distanceTo(le)>Oe.boundingSphereRadius+De.boundingSphereRadius)continue;let Qe=null;Oe.material&&De.material&&(Qe=d.getContactMaterial(Oe.material,De.material)||null),this.currentContactMaterial=Qe||$e||d.defaultContactMaterial;const it=this[Oe.type|De.type];if(it){let ct=!1;ct=Oe.type<De.type?it.call(this,Oe,De,Y,le,T,H,we,Se,Oe,De,Re):it.call(this,De,Oe,le,Y,H,T,Se,we,Oe,De,Re),ct&&Re&&(d.shapeOverlapKeeper.set(Oe.id,De.id),d.bodyOverlapKeeper.set(we.id,Se.id))}}}}}sphereSphere(r,h,d,y,b,N,k,T,H,Y,le){if(le)return d.distanceSquared(y)<(r.radius+h.radius)**2;const ae=this.createContactEquation(k,T,r,h,H,Y);y.vsub(d,ae.ni),ae.ni.normalize(),ae.ri.copy(ae.ni),ae.rj.copy(ae.ni),ae.ri.scale(r.radius,ae.ri),ae.rj.scale(-h.radius,ae.rj),ae.ri.vadd(d,ae.ri),ae.ri.vsub(k.position,ae.ri),ae.rj.vadd(y,ae.rj),ae.rj.vsub(T.position,ae.rj),this.result.push(ae),this.createFrictionEquationsFromContact(ae,this.frictionResult)}spherePlane(r,h,d,y,b,N,k,T,H,Y,le){const ae=this.createContactEquation(k,T,r,h,H,Y);if(ae.ni.set(0,0,1),N.vmult(ae.ni,ae.ni),ae.ni.negate(ae.ni),ae.ni.normalize(),ae.ni.scale(r.radius,ae.ri),d.vsub(y,mn),ae.ni.scale(ae.ni.dot(mn),Kt),mn.vsub(Kt,ae.rj),-mn.dot(ae.ni)<=r.radius){if(le)return!0;const ge=ae.ri,we=ae.rj;ge.vadd(d,ge),ge.vsub(k.position,ge),we.vadd(y,we),we.vsub(T.position,we),this.result.push(ae),this.createFrictionEquationsFromContact(ae,this.frictionResult)}}boxBox(r,h,d,y,b,N,k,T,H,Y,le){return r.convexPolyhedronRepresentation.material=r.material,h.convexPolyhedronRepresentation.material=h.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,h.convexPolyhedronRepresentation.collisionResponse=h.collisionResponse,this.convexConvex(r.convexPolyhedronRepresentation,h.convexPolyhedronRepresentation,d,y,b,N,k,T,r,h,le)}sphereBox(r,h,d,y,b,N,k,T,H,Y,le){const ae=this.v3pool,ge=Ko;d.vsub(y,_r),h.getSideNormals(ge,N);const we=r.radius;let Se=!1;const $e=Xs,Re=Io,Pe=Yl;let Oe=null,Fe=0,De=0,Qe=0,it=null;for(let Tt=0,Qt=ge.length;Tt!==Qt&&!1===Se;Tt++){const vn=qr;vn.copy(ge[Tt]);const gn=vn.length();vn.normalize();const fr=_r.dot(vn);if(fr<gn+we&&fr>0){const sr=fi,Rn=Rr;sr.copy(ge[(Tt+1)%3]),Rn.copy(ge[(Tt+2)%3]);const Jn=sr.length(),Kn=Rn.length();sr.normalize(),Rn.normalize();const Er=_r.dot(sr),vi=_r.dot(Rn);if(Er<Jn&&Er>-Jn&&vi<Kn&&vi>-Kn){const no=Math.abs(fr-gn-we);if((null===it||no<it)&&(it=no,De=Er,Qe=vi,Oe=gn,$e.copy(vn),Re.copy(sr),Pe.copy(Rn),Fe++,le))return!0}}}if(Fe){Se=!0;const Tt=this.createContactEquation(k,T,r,h,H,Y);$e.scale(-we,Tt.ri),Tt.ni.copy($e),Tt.ni.negate(Tt.ni),$e.scale(Oe,$e),Re.scale(De,Re),$e.vadd(Re,$e),Pe.scale(Qe,Pe),$e.vadd(Pe,Tt.rj),Tt.ri.vadd(d,Tt.ri),Tt.ri.vsub(k.position,Tt.ri),Tt.rj.vadd(y,Tt.rj),Tt.rj.vsub(T.position,Tt.rj),this.result.push(Tt),this.createFrictionEquationsFromContact(Tt,this.frictionResult)}let ct=ae.get();const _t=_o;for(let Tt=0;2!==Tt&&!Se;Tt++)for(let Qt=0;2!==Qt&&!Se;Qt++)for(let vn=0;2!==vn&&!Se;vn++)if(ct.set(0,0,0),Tt?ct.vadd(ge[0],ct):ct.vsub(ge[0],ct),Qt?ct.vadd(ge[1],ct):ct.vsub(ge[1],ct),vn?ct.vadd(ge[2],ct):ct.vsub(ge[2],ct),y.vadd(ct,_t),_t.vsub(d,_t),_t.lengthSquared()<we*we){if(le)return!0;Se=!0;const gn=this.createContactEquation(k,T,r,h,H,Y);gn.ri.copy(_t),gn.ri.normalize(),gn.ni.copy(gn.ri),gn.ri.scale(we,gn.ri),gn.rj.copy(ct),gn.ri.vadd(d,gn.ri),gn.ri.vsub(k.position,gn.ri),gn.rj.vadd(y,gn.rj),gn.rj.vsub(T.position,gn.rj),this.result.push(gn),this.createFrictionEquationsFromContact(gn,this.frictionResult)}ae.release(ct),ct=null;const $t=ae.get(),rn=ae.get(),Dt=ae.get(),Lt=ae.get(),Ct=ae.get(),ut=ge.length;for(let Tt=0;Tt!==ut&&!Se;Tt++)for(let Qt=0;Qt!==ut&&!Se;Qt++)if(Tt%3!=Qt%3){ge[Qt].cross(ge[Tt],$t),$t.normalize(),ge[Tt].vadd(ge[Qt],rn),Dt.copy(d),Dt.vsub(rn,Dt),Dt.vsub(y,Dt);const vn=Dt.dot($t);$t.scale(vn,Lt);let gn=0;for(;gn===Tt%3||gn===Qt%3;)gn++;Ct.copy(d),Ct.vsub(Lt,Ct),Ct.vsub(rn,Ct),Ct.vsub(y,Ct);const fr=Math.abs(vn),sr=Ct.length();if(fr<ge[gn].length()&&sr<we){if(le)return!0;Se=!0;const Rn=this.createContactEquation(k,T,r,h,H,Y);rn.vadd(Lt,Rn.rj),Rn.rj.copy(Rn.rj),Ct.negate(Rn.ni),Rn.ni.normalize(),Rn.ri.copy(Rn.rj),Rn.ri.vadd(y,Rn.ri),Rn.ri.vsub(d,Rn.ri),Rn.ri.normalize(),Rn.ri.scale(we,Rn.ri),Rn.ri.vadd(d,Rn.ri),Rn.ri.vsub(k.position,Rn.ri),Rn.rj.vadd(y,Rn.rj),Rn.rj.vsub(T.position,Rn.rj),this.result.push(Rn),this.createFrictionEquationsFromContact(Rn,this.frictionResult)}}ae.release($t,rn,Dt,Lt,Ct)}planeBox(r,h,d,y,b,N,k,T,H,Y,le){return h.convexPolyhedronRepresentation.material=h.material,h.convexPolyhedronRepresentation.collisionResponse=h.collisionResponse,h.convexPolyhedronRepresentation.id=h.id,this.planeConvex(r,h.convexPolyhedronRepresentation,d,y,b,N,k,T,r,h,le)}convexConvex(r,h,d,y,b,N,k,T,H,Y,le,ae,ge){const we=Ap;if(!(d.distanceTo(y)>r.boundingSphereRadius+h.boundingSphereRadius)&&r.findSeparatingAxis(h,d,b,y,N,we,ae,ge)){const Se=[],$e=or;r.clipAgainstHull(d,b,h,y,N,we,-100,100,Se);let Re=0;for(let Pe=0;Pe!==Se.length;Pe++){if(le)return!0;const Oe=this.createContactEquation(k,T,r,h,H,Y),Fe=Oe.ri,De=Oe.rj;we.negate(Oe.ni),Se[Pe].normal.negate($e),$e.scale(Se[Pe].depth,$e),Se[Pe].point.vadd($e,Fe),De.copy(Se[Pe].point),Fe.vsub(d,Fe),De.vsub(y,De),Fe.vadd(d,Fe),Fe.vsub(k.position,Fe),De.vadd(y,De),De.vsub(T.position,De),this.result.push(Oe),Re++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Oe,this.frictionResult)}this.enableFrictionReduction&&Re&&this.createFrictionFromAverage(Re)}}sphereConvex(r,h,d,y,b,N,k,T,H,Y,le){const ae=this.v3pool;d.vsub(y,Xo);const ge=h.faceNormals,we=h.faces,Se=h.vertices,$e=r.radius;let Re=!1;for(let Pe=0;Pe!==Se.length;Pe++){const Fe=Xu;N.vmult(Se[Pe],Fe),y.vadd(Fe,Fe);const De=Wh;if(Fe.vsub(d,De),De.lengthSquared()<$e*$e){if(le)return!0;Re=!0;const Qe=this.createContactEquation(k,T,r,h,H,Y);return Qe.ri.copy(De),Qe.ri.normalize(),Qe.ni.copy(Qe.ri),Qe.ri.scale($e,Qe.ri),Fe.vsub(y,Qe.rj),Qe.ri.vadd(d,Qe.ri),Qe.ri.vsub(k.position,Qe.ri),Qe.rj.vadd(y,Qe.rj),Qe.rj.vsub(T.position,Qe.rj),this.result.push(Qe),void this.createFrictionEquationsFromContact(Qe,this.frictionResult)}}for(let Pe=0,Oe=we.length;Pe!==Oe&&!1===Re;Pe++){const De=we[Pe],Qe=Mp;N.vmult(ge[Pe],Qe);const it=vh;N.vmult(Se[De[0]],it),it.vadd(y,it);const ct=_d;Qe.scale(-$e,ct),d.vadd(ct,ct);const _t=yh;ct.vsub(it,_t);const $t=_t.dot(Qe),rn=Fd;if(d.vsub(it,rn),$t<0&&rn.dot(Qe)>0){const Dt=[];for(let Lt=0,Ct=De.length;Lt!==Ct;Lt++){const ut=ae.get();N.vmult(Se[De[Lt]],ut),y.vadd(ut,ut),Dt.push(ut)}if(Mr(Dt,Qe,d)){if(le)return!0;Re=!0;const Lt=this.createContactEquation(k,T,r,h,H,Y);Qe.scale(-$e,Lt.ri),Qe.negate(Lt.ni);const Ct=ae.get();Qe.scale(-$t,Ct);const ut=ae.get();Qe.scale(-$e,ut),d.vsub(y,Lt.rj),Lt.rj.vadd(ut,Lt.rj),Lt.rj.vadd(Ct,Lt.rj),Lt.rj.vadd(y,Lt.rj),Lt.rj.vsub(T.position,Lt.rj),Lt.ri.vadd(d,Lt.ri),Lt.ri.vsub(k.position,Lt.ri),ae.release(Ct),ae.release(ut),this.result.push(Lt),this.createFrictionEquationsFromContact(Lt,this.frictionResult);for(let Tt=0,Qt=Dt.length;Tt!==Qt;Tt++)ae.release(Dt[Tt]);return}for(let Lt=0;Lt!==De.length;Lt++){const Ct=ae.get(),ut=ae.get();N.vmult(Se[De[(Lt+1)%De.length]],Ct),N.vmult(Se[De[(Lt+2)%De.length]],ut),y.vadd(Ct,Ct),y.vadd(ut,ut);const Tt=Yi;ut.vsub(Ct,Tt);const Qt=wc;Tt.unit(Qt);const vn=ae.get(),gn=ae.get();d.vsub(Ct,gn);const fr=gn.dot(Qt);Qt.scale(fr,vn),vn.vadd(Ct,vn);const sr=ae.get();if(vn.vsub(d,sr),fr>0&&fr*fr<Tt.lengthSquared()&&sr.lengthSquared()<$e*$e){if(le)return!0;const Rn=this.createContactEquation(k,T,r,h,H,Y);vn.vsub(y,Rn.rj),vn.vsub(d,Rn.ni),Rn.ni.normalize(),Rn.ni.scale($e,Rn.ri),Rn.rj.vadd(y,Rn.rj),Rn.rj.vsub(T.position,Rn.rj),Rn.ri.vadd(d,Rn.ri),Rn.ri.vsub(k.position,Rn.ri),this.result.push(Rn),this.createFrictionEquationsFromContact(Rn,this.frictionResult);for(let Jn=0,Kn=Dt.length;Jn!==Kn;Jn++)ae.release(Dt[Jn]);return ae.release(Ct),ae.release(ut),ae.release(vn),ae.release(sr),void ae.release(gn)}ae.release(Ct),ae.release(ut),ae.release(vn),ae.release(sr),ae.release(gn)}for(let Lt=0,Ct=Dt.length;Lt!==Ct;Lt++)ae.release(Dt[Lt])}}}planeConvex(r,h,d,y,b,N,k,T,H,Y,le){const ae=gd,ge=Pr;ge.set(0,0,1),b.vmult(ge,ge);let we=0;const Se=Sc;for(let $e=0;$e!==h.vertices.length;$e++)if(ae.copy(h.vertices[$e]),N.vmult(ae,ae),y.vadd(ae,ae),ae.vsub(d,Se),ge.dot(Se)<=0){if(le)return!0;const Re=this.createContactEquation(k,T,r,h,H,Y),Pe=Ys;ge.scale(ge.dot(Se),Pe),ae.vsub(Pe,Pe),Pe.vsub(d,Re.ri),Re.ni.copy(ge),ae.vsub(y,Re.rj),Re.ri.vadd(d,Re.ri),Re.ri.vsub(k.position,Re.ri),Re.rj.vadd(y,Re.rj),Re.rj.vsub(T.position,Re.rj),this.result.push(Re),we++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Re,this.frictionResult)}this.enableFrictionReduction&&we&&this.createFrictionFromAverage(we)}boxConvex(r,h,d,y,b,N,k,T,H,Y,le){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexConvex(r.convexPolyhedronRepresentation,h,d,y,b,N,k,T,r,h,le)}sphereHeightfield(r,h,d,y,b,N,k,T,H,Y,le){const ae=h.data,ge=r.radius,we=h.elementSize,Se=Xh,$e=Yu;z.pointToLocalFrame(y,N,d,$e);let Re=Math.floor(($e.x-ge)/we)-1,Pe=Math.ceil(($e.x+ge)/we)+1,Oe=Math.floor(($e.y-ge)/we)-1,Fe=Math.ceil(($e.y+ge)/we)+1;if(Pe<0||Fe<0||Re>ae.length||Oe>ae[0].length)return;Re<0&&(Re=0),Pe<0&&(Pe=0),Oe<0&&(Oe=0),Fe<0&&(Fe=0),Re>=ae.length&&(Re=ae.length-1),Pe>=ae.length&&(Pe=ae.length-1),Fe>=ae[0].length&&(Fe=ae[0].length-1),Oe>=ae[0].length&&(Oe=ae[0].length-1);const De=[];if(h.getRectMinMax(Re,Oe,Pe,Fe,De),$e.z-ge>De[1]||$e.z+ge<De[0])return;const ct=this.result;for(let _t=Re;_t<Pe;_t++)for(let $t=Oe;$t<Fe;$t++){const rn=ct.length;let Dt=!1;if(h.getConvexTrianglePillar(_t,$t,!1),z.pointToWorldFrame(y,N,h.pillarOffset,Se),d.distanceTo(Se)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(Dt=this.sphereConvex(r,h.pillarConvex,d,Se,b,N,k,T,r,h,le)),le&&Dt||(h.getConvexTrianglePillar(_t,$t,!0),z.pointToWorldFrame(y,N,h.pillarOffset,Se),d.distanceTo(Se)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(Dt=this.sphereConvex(r,h.pillarConvex,d,Se,b,N,k,T,r,h,le)),le&&Dt))return!0;if(ct.length-rn>2)return}}boxHeightfield(r,h,d,y,b,N,k,T,H,Y,le){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexHeightfield(r.convexPolyhedronRepresentation,h,d,y,b,N,k,T,r,h,le)}convexHeightfield(r,h,d,y,b,N,k,T,H,Y,le){const ae=h.data,ge=h.elementSize,we=r.boundingSphereRadius,Se=ol,$e=Ec,Re=Hr;z.pointToLocalFrame(y,N,d,Re);let Pe=Math.floor((Re.x-we)/ge)-1,Oe=Math.ceil((Re.x+we)/ge)+1,Fe=Math.floor((Re.y-we)/ge)-1,De=Math.ceil((Re.y+we)/ge)+1;if(Oe<0||De<0||Pe>ae.length||Fe>ae[0].length)return;Pe<0&&(Pe=0),Oe<0&&(Oe=0),Fe<0&&(Fe=0),De<0&&(De=0),Pe>=ae.length&&(Pe=ae.length-1),Oe>=ae.length&&(Oe=ae.length-1),De>=ae[0].length&&(De=ae[0].length-1),Fe>=ae[0].length&&(Fe=ae[0].length-1);const Qe=[];if(h.getRectMinMax(Pe,Fe,Oe,De,Qe),!(Re.z-we>Qe[1]||Re.z+we<Qe[0]))for(let _t=Pe;_t<Oe;_t++)for(let $t=Fe;$t<De;$t++){let rn=!1;if(h.getConvexTrianglePillar(_t,$t,!1),z.pointToWorldFrame(y,N,h.pillarOffset,Se),d.distanceTo(Se)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(rn=this.convexConvex(r,h.pillarConvex,d,Se,b,N,k,T,null,null,le,$e,null)),le&&rn||(h.getConvexTrianglePillar(_t,$t,!0),z.pointToWorldFrame(y,N,h.pillarOffset,Se),d.distanceTo(Se)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(rn=this.convexConvex(r,h.pillarConvex,d,Se,b,N,k,T,null,null,le,$e,null)),le&&rn))return!0}}sphereParticle(r,h,d,y,b,N,k,T,H,Y,le){const ae=ha;if(ae.set(0,0,1),y.vsub(d,ae),ae.lengthSquared()<=r.radius*r.radius){if(le)return!0;const ge=this.createContactEquation(T,k,h,r,H,Y);ae.normalize(),ge.rj.copy(ae),ge.rj.scale(r.radius,ge.rj),ge.ni.copy(ae),ge.ni.negate(ge.ni),ge.ri.set(0,0,0),this.result.push(ge),this.createFrictionEquationsFromContact(ge,this.frictionResult)}}planeParticle(r,h,d,y,b,N,k,T,H,Y,le){const ae=Tl;ae.set(0,0,1),k.quaternion.vmult(ae,ae);const ge=bh;if(y.vsub(k.position,ge),ae.dot(ge)<=0){if(le)return!0;const we=this.createContactEquation(T,k,h,r,H,Y);we.ni.copy(ae),we.ni.negate(we.ni),we.ri.set(0,0,0);const Se=qh;ae.scale(ae.dot(y),Se),y.vsub(Se,Se),we.rj.copy(Se),this.result.push(we),this.createFrictionEquationsFromContact(we,this.frictionResult)}}boxParticle(r,h,d,y,b,N,k,T,H,Y,le){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexParticle(r.convexPolyhedronRepresentation,h,d,y,b,N,k,T,r,h,le)}convexParticle(r,h,d,y,b,N,k,T,H,Y,le){let ae=-1;const ge=ro,we=$s;let Se=null;const $e=zr;if($e.copy(y),$e.vsub(d,$e),b.conjugate(vd),vd.vmult($e,$e),r.pointIsInside($e)){r.worldVerticesNeedsUpdate&&r.computeWorldVertices(d,b),r.worldFaceNormalsNeedsUpdate&&r.computeWorldFaceNormals(b);for(let Re=0,Pe=r.faces.length;Re!==Pe;Re++){const Fe=r.worldFaceNormals[Re];y.vsub(r.worldVertices[r.faces[Re][0]],Oo);const De=-Fe.dot(Oo);if(null===Se||Math.abs(De)<Math.abs(Se)){if(le)return!0;Se=De,ae=Re,ge.copy(Fe)}}if(-1!==ae){const Re=this.createContactEquation(T,k,h,r,H,Y);ge.scale(Se,we),we.vadd(y,we),we.vsub(d,we),Re.rj.copy(we),ge.negate(Re.ni),Re.ri.set(0,0,0);const Pe=Re.ri,Oe=Re.rj;Pe.vadd(y,Pe),Pe.vsub(T.position,Pe),Oe.vadd(d,Oe),Oe.vsub(k.position,Oe),this.result.push(Re),this.createFrictionEquationsFromContact(Re,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}sphereTrimesh(r,h,d,y,b,N,k,T,H,Y,le){const ae=Xl,ge=bu,we=wa,Se=To,$e=Fs,Re=xc,Pe=yn,Oe=xa,Fe=El,De=Xt;z.pointToLocalFrame(y,N,d,$e);const Qe=r.radius;Pe.lowerBound.set($e.x-Qe,$e.y-Qe,$e.z-Qe),Pe.upperBound.set($e.x+Qe,$e.y+Qe,$e.z+Qe),h.getTrianglesInAABB(Pe,De);const it=za,ct=r.radius*r.radius;for(let Lt=0;Lt<De.length;Lt++)for(let Ct=0;Ct<3;Ct++)if(h.getVertex(h.indices[3*De[Lt]+Ct],it),it.vsub($e,Fe),Fe.lengthSquared()<=ct){if(Oe.copy(it),z.pointToWorldFrame(y,N,Oe,it),it.vsub(d,Fe),le)return!0;let ut=this.createContactEquation(k,T,r,h,H,Y);ut.ni.copy(Fe),ut.ni.normalize(),ut.ri.copy(ut.ni),ut.ri.scale(r.radius,ut.ri),ut.ri.vadd(d,ut.ri),ut.ri.vsub(k.position,ut.ri),ut.rj.copy(it),ut.rj.vsub(T.position,ut.rj),this.result.push(ut),this.createFrictionEquationsFromContact(ut,this.frictionResult)}for(let Lt=0;Lt<De.length;Lt++)for(let Ct=0;Ct<3;Ct++){h.getVertex(h.indices[3*De[Lt]+Ct],ae),h.getVertex(h.indices[3*De[Lt]+(Ct+1)%3],ge),ge.vsub(ae,we),$e.vsub(ge,Re);const ut=Re.dot(we);$e.vsub(ae,Re);let Tt=Re.dot(we);if(Tt>0&&ut<0&&($e.vsub(ae,Re),Se.copy(we),Se.normalize(),Tt=Re.dot(Se),Se.scale(Tt,Re),Re.vadd(ae,Re),Re.distanceTo($e)<r.radius)){if(le)return!0;const Qt=this.createContactEquation(k,T,r,h,H,Y);Re.vsub($e,Qt.ni),Qt.ni.normalize(),Qt.ni.scale(r.radius,Qt.ri),Qt.ri.vadd(d,Qt.ri),Qt.ri.vsub(k.position,Qt.ri),z.pointToWorldFrame(y,N,Re,Re),Re.vsub(T.position,Qt.rj),z.vectorToWorldFrame(N,Qt.ni,Qt.ni),z.vectorToWorldFrame(N,Qt.ri,Qt.ri),this.result.push(Qt),this.createFrictionEquationsFromContact(Qt,this.frictionResult)}}const _t=tt,$t=bt,rn=kt,Dt=Zn;for(let Lt=0,Ct=De.length;Lt!==Ct;Lt++){h.getTriangleVertices(De[Lt],_t,$t,rn),h.getNormal(De[Lt],Dt),$e.vsub(_t,Re);let ut=Re.dot(Dt);if(Dt.scale(ut,Re),$e.vsub(Re,Re),ut=Re.distanceTo($e),Nr.pointInTriangle(Re,_t,$t,rn)&&ut<r.radius){if(le)return!0;let Tt=this.createContactEquation(k,T,r,h,H,Y);Re.vsub($e,Tt.ni),Tt.ni.normalize(),Tt.ni.scale(r.radius,Tt.ri),Tt.ri.vadd(d,Tt.ri),Tt.ri.vsub(k.position,Tt.ri),z.pointToWorldFrame(y,N,Re,Re),Re.vsub(T.position,Tt.rj),z.vectorToWorldFrame(N,Tt.ni,Tt.ni),z.vectorToWorldFrame(N,Tt.ri,Tt.ri),this.result.push(Tt),this.createFrictionEquationsFromContact(Tt,this.frictionResult)}}De.length=0}planeTrimesh(r,h,d,y,b,N,k,T,H,Y,le){const ae=new M,ge=yu;ge.set(0,0,1),b.vmult(ge,ge);for(let we=0;we<h.vertices.length/3;we++){h.getVertex(we,ae);const Se=new M;Se.copy(ae),z.pointToWorldFrame(y,N,Se,ae);const $e=gh;if(ae.vsub(d,$e),ge.dot($e)<=0){if(le)return!0;const Re=this.createContactEquation(k,T,r,h,H,Y);Re.ni.copy(ge);const Pe=bc;ge.scale($e.dot(ge),Pe),ae.vsub(Pe,Pe),Re.ri.copy(Pe),Re.ri.vsub(k.position,Re.ri),Re.rj.copy(ae),Re.rj.vsub(T.position,Re.rj),this.result.push(Re),this.createFrictionEquationsFromContact(Re,this.frictionResult)}}}}const Wr=new M,Ua=new M,Eo=new M,ua=new M,vu=new M,yc=new Q,Wc=new Q;kr.prototype[Gi.boxBox]=kr.prototype.boxBox,kr.prototype[Gi.boxConvex]=kr.prototype.boxConvex,kr.prototype[Gi.boxParticle]=kr.prototype.boxParticle,kr.prototype[Gi.sphereSphere]=kr.prototype.sphereSphere;const yu=new M,gh=new M,bc=new M;kr.prototype[Gi.planeTrimesh]=kr.prototype.planeTrimesh;const Zn=new M,El=new M,za=new M,xa=new M,Xl=new M,bu=new M,wa=new M,To=new M,Fs=new M,xc=new M,tt=new M,bt=new M,kt=new M,yn=new ne,Xt=[];kr.prototype[Gi.sphereTrimesh]=kr.prototype.sphereTrimesh;const mn=new M,Kt=new M;kr.prototype[Gi.spherePlane]=kr.prototype.spherePlane;const qn=new M,zn=new M,xr=new M;function Mr(a,r,h){let d=null;const y=a.length;for(let b=0;b!==y;b++){const N=a[b],k=qn;a[(b+1)%y].vsub(N,k);const T=zn;k.cross(r,T);const H=xr;h.vsub(N,H);const Y=T.dot(H);if(!(null===d||Y>0&&!0===d||Y<=0&&!1===d))return!1;null===d&&(d=Y>0)}return!0}const _r=new M,qr=new M,fi=new M,Rr=new M,Ko=[new M,new M,new M,new M,new M,new M],_o=new M,Xs=new M,Io=new M,Yl=new M;kr.prototype[Gi.sphereBox]=kr.prototype.sphereBox;const Xo=new M,Yi=new M,wc=new M,Wh=new M,Xu=new M,Mp=new M,vh=new M,_d=new M,yh=new M,Fd=new M;kr.prototype[Gi.sphereConvex]=kr.prototype.sphereConvex,kr.prototype[Gi.planeBox]=kr.prototype.planeBox;const gd=new M,Pr=new M,Sc=new M,Ys=new M;kr.prototype[Gi.planeConvex]=kr.prototype.planeConvex;const Ap=new M,or=new M;kr.prototype[Gi.convexConvex]=kr.prototype.convexConvex;const Tl=new M,bh=new M,qh=new M;kr.prototype[Gi.planeParticle]=kr.prototype.planeParticle;const ha=new M;kr.prototype[Gi.sphereParticle]=kr.prototype.sphereParticle;const vd=new Q,zr=new M,ro=new M,Oo=new M,$s=new M;kr.prototype[Gi.convexParticle]=kr.prototype.convexParticle,kr.prototype[Gi.boxHeightfield]=kr.prototype.boxHeightfield;const Hr=new M,ol=new M,Ec=[0];kr.prototype[Gi.convexHeightfield]=kr.prototype.convexHeightfield;const Yu=new M,Xh=new M;kr.prototype[Gi.sphereHeightfield]=kr.prototype.sphereHeightfield;class Ml{constructor(){this.current=[],this.previous=[]}getKey(r,h){if(h<r){const d=h;h=r,r=d}return r<<16|h}set(r,h){const d=this.getKey(r,h),y=this.current;let b=0;for(;d>y[b];)b++;if(d!==y[b]){for(let N=y.length-1;N>=b;N--)y[N+1]=y[N];y[b]=d}}tick(){const r=this.current;this.current=this.previous,this.previous=r,this.current.length=0}getDiff(r,h){const d=this.current,y=this.previous,b=d.length,N=y.length;let k=0;for(let T=0;T<b;T++){let H=!1;const Y=d[T];for(;Y>y[k];)k++;H=Y===y[k],H||Qn(r,Y)}k=0;for(let T=0;T<N;T++){let H=!1;const Y=y[T];for(;Y>d[k];)k++;H=d[k]===Y,H||Qn(h,Y)}}}function Qn(a,r){a.push((4294901760&r)>>16,65535&r)}class sl{constructor(){this.data={keys:[]}}get(r,h){if(r>h){const d=h;h=r,r=d}return this.data[r+"-"+h]}set(r,h,d){if(r>h){const b=h;h=r,r=b}const y=r+"-"+h;this.get(r,h)||this.data.keys.push(y),this.data[y]=d}reset(){const r=this.data,h=r.keys;for(;h.length>0;)delete r[h.pop()]}}class Dn extends W{constructor(r={}){super(),this.dt=-1,this.allowSleep=!!r.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=void 0!==r.quatNormalizeSkip?r.quatNormalizeSkip:0,this.quatNormalizeFast=void 0!==r.quatNormalizeFast&&r.quatNormalizeFast,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new M,r.gravity&&this.gravity.copy(r.gravity),this.broadphase=void 0!==r.broadphase?r.broadphase:new mr,this.bodies=[],this.hasActiveBodies=!1,this.solver=void 0!==r.solver?r.solver:new _u,this.constraints=[],this.narrowphase=new kr(this),this.collisionMatrix=new ie,this.collisionMatrixPrevious=new ie,this.bodyOverlapKeeper=new Ml,this.shapeOverlapKeeper=new Ml,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new sl,this.defaultMaterial=new zu("default"),this.defaultContactMaterial=new Uu(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(r,h){return this.contactMaterialTable.get(r.id,h.id)}numObjects(){return this.bodies.length}collisionMatrixTick(){const r=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=r,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(r){this.constraints.push(r)}removeConstraint(r){const h=this.constraints.indexOf(r);-1!==h&&this.constraints.splice(h,1)}rayTest(r,h,d){d instanceof mi?this.raycastClosest(r,h,{skipBackfaces:!0},d):this.raycastAll(r,h,{skipBackfaces:!0},d)}raycastAll(r,h,d={},y){return d.mode=Nr.ALL,d.from=r,d.to=h,d.callback=y,Al.intersectWorld(this,d)}raycastAny(r,h,d={},y){return d.mode=Nr.ANY,d.from=r,d.to=h,d.result=y,Al.intersectWorld(this,d)}raycastClosest(r,h,d={},y){return d.mode=Nr.CLOSEST,d.from=r,d.to=h,d.result=y,Al.intersectWorld(this,d)}addBody(r){this.bodies.includes(r)||(r.index=this.bodies.length,this.bodies.push(r),r.world=this,r.initPosition.copy(r.position),r.initVelocity.copy(r.velocity),r.timeLastSleepy=this.time,r instanceof ht&&(r.initAngularVelocity.copy(r.angularVelocity),r.initQuaternion.copy(r.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=r,this.idToBodyMap[r.id]=r,this.dispatchEvent(this.addBodyEvent))}removeBody(r){r.world=null;const h=this.bodies.length-1,d=this.bodies,y=d.indexOf(r);if(-1!==y){d.splice(y,1);for(let b=0;b!==d.length;b++)d[b].index=b;this.collisionMatrix.setNumObjects(h),this.removeBodyEvent.body=r,delete this.idToBodyMap[r.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(r){return this.idToBodyMap[r]}getShapeById(r){const h=this.bodies;for(let d=0,y=h.length;d<y;d++){const b=h[d].shapes;for(let N=0,k=b.length;N<k;N++){const T=b[N];if(T.id===r)return T}}}addMaterial(r){this.materials.push(r)}addContactMaterial(r){this.contactmaterials.push(r),this.contactMaterialTable.set(r.materials[0].id,r.materials[1].id,r)}step(r,h=0,d=10){if(0===h)this.internalStep(r),this.time+=r;else{this.accumulator+=h;let y=0;for(;this.accumulator>=r&&y<d;)this.internalStep(r),this.accumulator-=r,y++;const b=this.accumulator%r/r;for(let N=0;N!==this.bodies.length;N++){const k=this.bodies[N];k.previousPosition.lerp(k.position,b,k.interpolatedPosition),k.previousQuaternion.slerp(k.quaternion,b,k.interpolatedQuaternion),k.previousQuaternion.normalize()}this.time+=h}}internalStep(r){this.dt=r;const h=this.contacts,d=Zu,y=Ea,b=this.numObjects(),N=this.bodies,k=this.solver,T=this.gravity,H=this.doProfiling,Y=this.profile,le=ht.DYNAMIC;let ae=-1/0;const ge=this.constraints,we=Ju,Se=(T.length(),T.x),$e=T.y,Re=T.z;let Pe=0;for(H&&(ae=performance.now()),Pe=0;Pe!==b;Pe++){const Dt=N[Pe];if(Dt.type===le){const Lt=Dt.force,Ct=Dt.mass;Lt.x+=Ct*Se,Lt.y+=Ct*$e,Lt.z+=Ct*Re}}for(let Dt=0,Lt=this.subsystems.length;Dt!==Lt;Dt++)this.subsystems[Dt].update();H&&(ae=performance.now()),d.length=0,y.length=0,this.broadphase.collisionPairs(this,d,y),H&&(Y.broadphase=performance.now()-ae);let Oe=ge.length;for(Pe=0;Pe!==Oe;Pe++){const Dt=ge[Pe];if(!Dt.collideConnected)for(let Lt=d.length-1;Lt>=0;Lt-=1)(Dt.bodyA===d[Lt]&&Dt.bodyB===y[Lt]||Dt.bodyB===d[Lt]&&Dt.bodyA===y[Lt])&&(d.splice(Lt,1),y.splice(Lt,1))}this.collisionMatrixTick(),H&&(ae=performance.now());const Fe=Sa,De=h.length;for(Pe=0;Pe!==De;Pe++)Fe.push(h[Pe]);h.length=0;const Qe=this.frictionEquations.length;for(Pe=0;Pe!==Qe;Pe++)we.push(this.frictionEquations[Pe]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(d,y,this,h,Fe,this.frictionEquations,we),H&&(Y.narrowphase=performance.now()-ae),H&&(ae=performance.now()),Pe=0;Pe<this.frictionEquations.length;Pe++)k.addEquation(this.frictionEquations[Pe]);const it=h.length;for(let Dt=0;Dt!==it;Dt++){const Lt=h[Dt],Ct=Lt.bi,ut=Lt.bj,Tt=Lt.si,Qt=Lt.sj;let vn;vn=Ct.material&&ut.material&&this.getContactMaterial(Ct.material,ut.material)||this.defaultContactMaterial;let gn=vn.friction;Ct.material&&ut.material&&(Ct.material.friction>=0&&ut.material.friction>=0&&(gn=Ct.material.friction*ut.material.friction),Ct.material.restitution>=0&&ut.material.restitution>=0&&(Lt.restitution=Ct.material.restitution*ut.material.restitution)),k.addEquation(Lt),Ct.allowSleep&&Ct.type===ht.DYNAMIC&&Ct.sleepState===ht.SLEEPING&&ut.sleepState===ht.AWAKE&&ut.type!==ht.STATIC&&ut.velocity.lengthSquared()+ut.angularVelocity.lengthSquared()>=2*ut.sleepSpeedLimit**2&&(Ct.wakeUpAfterNarrowphase=!0),ut.allowSleep&&ut.type===ht.DYNAMIC&&ut.sleepState===ht.SLEEPING&&Ct.sleepState===ht.AWAKE&&Ct.type!==ht.STATIC&&Ct.velocity.lengthSquared()+Ct.angularVelocity.lengthSquared()>=2*Ct.sleepSpeedLimit**2&&(ut.wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(Ct,ut,!0),this.collisionMatrixPrevious.get(Ct,ut)||($p.body=ut,$p.contact=Lt,Ct.dispatchEvent($p),$p.body=Ct,ut.dispatchEvent($p)),this.bodyOverlapKeeper.set(Ct.id,ut.id),this.shapeOverlapKeeper.set(Tt.id,Qt.id)}for(this.emitContactEvents(),H&&(Y.makeContactConstraints=performance.now()-ae,ae=performance.now()),Pe=0;Pe!==b;Pe++){const Dt=N[Pe];Dt.wakeUpAfterNarrowphase&&(Dt.wakeUp(),Dt.wakeUpAfterNarrowphase=!1)}for(Oe=ge.length,Pe=0;Pe!==Oe;Pe++){const Dt=ge[Pe];Dt.update();for(let Lt=0,Ct=Dt.equations.length;Lt!==Ct;Lt++)k.addEquation(Dt.equations[Lt])}k.solve(r,this),H&&(Y.solve=performance.now()-ae),k.removeAllEquations();const ct=Math.pow;for(Pe=0;Pe!==b;Pe++){const Dt=N[Pe];if(Dt.type&le){const Lt=ct(1-Dt.linearDamping,r),Ct=Dt.velocity;Ct.scale(Lt,Ct);const ut=Dt.angularVelocity;if(ut){const Tt=ct(1-Dt.angularDamping,r);ut.scale(Tt,ut)}}}for(this.dispatchEvent(Dd),Pe=0;Pe!==b;Pe++){const Dt=N[Pe];Dt.preStep&&Dt.preStep.call(Dt)}H&&(ae=performance.now());const _t=this.stepnumber%(this.quatNormalizeSkip+1)==0,$t=this.quatNormalizeFast;for(Pe=0;Pe!==b;Pe++)N[Pe].integrate(r,_t,$t);for(this.clearForces(),this.broadphase.dirty=!0,H&&(Y.integrate=performance.now()-ae),this.time+=r,this.stepnumber+=1,this.dispatchEvent(Fi),Pe=0;Pe!==b;Pe++){const Dt=N[Pe],Lt=Dt.postStep;Lt&&Lt.call(Dt)}let rn=!0;if(this.allowSleep)for(rn=!1,Pe=0;Pe!==b;Pe++){const Dt=N[Pe];Dt.sleepTick(this.time),Dt.sleepState!==ht.SLEEPING&&(rn=!0)}this.hasActiveBodies=rn}clearForces(){const r=this.bodies,h=r.length;for(let d=0;d!==h;d++){const y=r[d];y.force.set(0,0,0),y.torque.set(0,0,0)}}}new ne;const Al=new Nr;if(typeof performance>"u"&&(performance={}),!performance.now){let a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart),performance.now=()=>Date.now()-a}const Fi={type:"postStep"},Dd={type:"preStep"},$p={type:ht.COLLIDE_EVENT_NAME,body:null,contact:null},Sa=[],Ju=[],Zu=[],Ea=[];function li(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function Jr(a,r){this._keys=new Array(5),this._position=new l.Vector2(0,0),this._positionUpdated=!1,this._delta=new l.Vector2(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=new Array(5),this.keys=new Array(5),this.position=new l.Vector2(0,0),this.delta=new l.Vector2(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.domElement=void 0!==a?a:window,this.canvas=null,this.events=new pn;for(var h=0;h<5;h++)this._doubleClicked[h]=!1,this.doubleClicked[h]=!1,this._keys[h]=new li,this.keys[h]=new li;var d=this;if(void 0!==window.onmousewheel?this.events.add(this.domElement,"mousewheel",function(b){d._wheel=b.deltaY,d._wheelUpdated=!0}):void 0!==window.addEventListener?this.events.add(this.domElement,"DOMMouseScroll",function(b){d._wheel=30*b.detail,d._wheelUpdated=!0}):this.events.add(this.domElement,"wheel",function(b){d._wheel=b.deltaY,d._wheelUpdated=!0}),"ontouchstart"in window||navigator.msMaxTouchPoints>0){var y=new l.Vector2(0,0);this.events.add(this.domElement,"touchstart",function(b){var N=b.touches[0];d.updatePosition(N.screenX,N.screenY,0,0),d.updateKey(Jr.LEFT,li.DOWN),y.set(N.screenX,N.screenY)}),this.events.add(this.domElement,"touchend",function(b){d.updateKey(Jr.LEFT,li.UP)}),this.events.add(this.domElement,"touchcancel",function(b){d.updateKey(Jr.LEFT,li.UP)}),this.events.add(document.body,"touchmove",function(b){var N=b.touches[0];d.updatePosition(N.screenX,N.screenY,N.screenX-y.x,N.screenY-y.y),y.set(N.screenX,N.screenY)})}this.events.add(this.domElement,"mousemove",function(b){d.updatePosition(b.clientX,b.clientY,b.movementX,b.movementY)}),this.events.add(this.domElement,"mousedown",function(b){d.updateKey(b.which-1,li.DOWN)}),this.events.add(this.domElement,"mouseup",function(b){d.updateKey(b.which-1,li.UP)}),this.events.add(this.domElement,"dragstart",function(b){d.updateKey(b.which-1,li.UP)}),this.events.add(this.domElement,"dblclick",function(b){d._doubleClicked[b.which-1]=!0}),!0!==r&&this.create()}function pn(){this.events=[]}function qc(){}function ci(){}function pa(){}function ja(){}function Bn(){}Dn.prototype.emitContactEvents=(()=>{const a=[],r=[],h={type:"beginContact",bodyA:null,bodyB:null},d={type:"endContact",bodyA:null,bodyB:null},y={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},b={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null};return function(){const N=this.hasAnyEventListener("beginContact"),k=this.hasAnyEventListener("endContact");if((N||k)&&this.bodyOverlapKeeper.getDiff(a,r),N){for(let Y=0,le=a.length;Y<le;Y+=2)h.bodyA=this.getBodyById(a[Y]),h.bodyB=this.getBodyById(a[Y+1]),this.dispatchEvent(h);h.bodyA=h.bodyB=null}if(k){for(let Y=0,le=r.length;Y<le;Y+=2)d.bodyA=this.getBodyById(r[Y]),d.bodyB=this.getBodyById(r[Y+1]),this.dispatchEvent(d);d.bodyA=d.bodyB=null}a.length=r.length=0;const T=this.hasAnyEventListener("beginShapeContact"),H=this.hasAnyEventListener("endShapeContact");if((T||H)&&this.shapeOverlapKeeper.getDiff(a,r),T){for(let Y=0,le=a.length;Y<le;Y+=2){const ae=this.getShapeById(a[Y]),ge=this.getShapeById(a[Y+1]);y.shapeA=ae,y.shapeB=ge,y.bodyA=ae.body,y.bodyB=ge.body,this.dispatchEvent(y)}y.bodyA=y.bodyB=y.shapeA=y.shapeB=null}if(H){for(let Y=0,le=r.length;Y<le;Y+=2){const ae=this.getShapeById(r[Y]),ge=this.getShapeById(r[Y+1]);b.shapeA=ae,b.shapeB=ge,b.bodyA=ae.body,b.bodyB=ge.body,this.dispatchEvent(b)}b.bodyA=b.bodyB=b.shapeA=b.shapeB=null}}})(),li.DOWN=-1,li.UP=1,li.RESET=0,li.prototype.constructor=li,li.prototype.update=function(a){this.justPressed=!1,this.justReleased=!1,a===li.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):a===li.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):a===li.RESET&&(this.justReleased=!1,this.justPressed=!1)},li.prototype.set=function(a,r,h){this.justPressed=a,this.pressed=r,this.justReleased=h},li.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},(Jr.prototype=Jr).constructor=Jr,Jr.LEFT=0,Jr.MIDDLE=1,Jr.RIGHT=2,Jr.BACK=3,Jr.FORWARD=4,Jr.setCanvas=function(a){this.canvas=a,a.pointerInside=!1,a.addEventListener("mouseenter",function(){this.pointerInside=!0}),a.addEventListener("mouseleave",function(){this.pointerInside=!1})},Jr.insideCanvas=function(){return null!==this.canvas&&this.canvas.pointerInside},Jr.setLock=function(a){null!==this.canvas&&(a?(this.canvas.requestPointerLock=this.canvas.requestPointerLock||this.canvas.mozRequestPointerLock||this.canvas.webkitRequestPointerLock,void 0!==this.canvas.requestPointerLock&&this.canvas.requestPointerLock()):void 0!==document.exitPointerLock?document.exitPointerLock():void 0!==document.mozExitPointerLock?document.mozExitPointerLock():void 0!==document.webkitExitPointerLock&&document.webkitExitPointerLock())},Jr.buttonPressed=function(a){return this.keys[a].pressed},Jr.buttonDoubleClicked=function(a){return this.doubleClicked[a]},Jr.buttonJustPressed=function(a){return this.keys[a].justPressed},Jr.buttonJustReleased=function(a){return this.keys[a].justReleased},Jr.updatePosition=function(a,r,h,d){if(null!==this.canvas){var y=this.canvas.getBoundingClientRect();a-=y.left,r-=y.top}this._position.set(a,r),this._delta.x+=h,this._delta.y+=d,this._positionUpdated=!0},Jr.updateKey=function(a,r){a>-1&&this._keys[a].update(r)},Jr.update=function(){for(var a=0;a<5;a++)this._keys[a].justPressed&&this.keys[a].justPressed&&(this._keys[a].justPressed=!1),this._keys[a].justReleased&&this.keys[a].justReleased&&(this._keys[a].justReleased=!1),this.keys[a].set(this._keys[a].justPressed,this._keys[a].pressed,this._keys[a].justReleased),!0===this._doubleClicked[a]?(this.doubleClicked[a]=!0,this._doubleClicked[a]=!1):this.doubleClicked[a]=!1;this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._positionUpdated?(this.delta.copy(this._delta),this.position.copy(this._position),this._delta.set(0,0),this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},Jr.create=function(){this.events.create()},Jr.dispose=function(){this.events.destroy()},pn.prototype.addAndCreate=function(a,r,h){var d=[a,r,h,!0];d[0].addEventListener(d[1],d[2]),d[3]=!0,this.events.push(d)},pn.prototype.remove=function(a,r){for(var h=this.events.length-1;h>=0;h--)this.events[h][0]===a&&this.events[h][1]===r&&(this.events[h][3]&&(this.events[h][0].removeEventListener(this.events[h][1],this.events[h][2]),this.events[h][3]=!1),this.events.splice(h,1))},pn.prototype.add=function(a,r,h){this.events.push([a,r,h,!1])},pn.prototype.clear=function(){this.destroy(),this.events=[]},pn.prototype.create=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].addEventListener(r[1],r[2]),r[3]=!0}},pn.prototype.destroy=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].removeEventListener(r[1],r[2]),r[3]=!1}},pn.prototype.addScrollEvent=function(a,r){void 0!==window.onmousewheel?this.add(a,"mousewheel",r):void 0!==window.addEventListener?this.add(a,"DOMMouseScroll",function(h){h.deltaY=30*h.detail,r(h)}):this.add(a,"wheel",r)},qc.PI2=2*Math.PI,qc.PID3=Math.PI/3,qc.PID2=Math.PI/2,qc.randomColor=function(){for(var a="#",r=0;r<6;r++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a},ci.encoding="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ci.isBase64=function(a){if("string"!=typeof a)return!1;if(a.startsWith("data:"))return!0;for(var r=0;r<a.length;r++)if(!ci.encoding.includes(a.charAt(r)))return!1;return!0},ci.removeHeader=function(a){return a.slice(a.search(";base64,")+8)},ci.getFileFormat=function(a){var r=a.indexOf("/")+1,h=a.indexOf(";");return a.substr(r,h-r)},ci.fromArraybuffer=function(a){for(var r,b,N="",k=new Uint8Array(a),T=k.byteLength%3,H=k.byteLength-T,Y=0;Y<H;Y+=3)r=(16515072&(b=k[Y]<<16|k[Y+1]<<8|k[Y+2]))>>18,N+=ci.encoding[r]+ci.encoding[(258048&b)>>12]+ci.encoding[(4032&b)>>6]+ci.encoding[63&b];return 1===T?(r=(252&(b=k[H]))>>2,N+=ci.encoding[r]+ci.encoding[(3&b)<<4]+"=="):2===T&&(r=(64512&(b=k[H]<<8|k[H+1]))>>10,N+=ci.encoding[r]+ci.encoding[(1008&b)>>4]+ci.encoding[(15&b)<<2]+"="),N},ci.fromBinaryString=function(a){for(var r,h,d,y="",b=a.length%3,N=a.length-b,k=0;k<N;k+=3)r=255&a.charCodeAt(k),h=a.charCodeAt(k+1),d=a.charCodeAt(k+2),y+=ci.encoding.charAt(r>>2),y+=ci.encoding.charAt((3&r)<<4|(240&h)>>4),y+=ci.encoding.charAt((15&h)<<2|(192&d)>>6),y+=ci.encoding.charAt(63&d);return 1===b?(r=255&a.charCodeAt(k),y+=ci.encoding.charAt(r>>2),y+=ci.encoding.charAt((3&r)<<4),y+="=="):2===b&&(r=255&a.charCodeAt(k),h=a.charCodeAt(k+1),y+=ci.encoding.charAt(r>>2),y+=ci.encoding.charAt((3&r)<<4|(240&h)>>4),y+=ci.encoding.charAt((15&h)<<2),y+="="),y},pa.fromBinaryString=function(a){for(var r=a.length,h=new ArrayBuffer(r),d=new Uint8Array(h),y=0;y<r;y++)d[y]=a.charCodeAt(y);return h},pa.fromBase64=function(a){for(var r,h,d,y,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N=a.length/4*3,k=new ArrayBuffer(N),T=new Uint8Array(k),H=0,Y=0;H<N;H+=3)r=b.indexOf(a.charAt(Y++)),h=b.indexOf(a.charAt(Y++)),d=b.indexOf(a.charAt(Y++)),y=b.indexOf(a.charAt(Y++)),T[H]=r<<2|h>>4,64!==d&&(T[H+1]=(15&h)<<4|d>>2),64!==y&&(T[H+2]=(3&d)<<6|y);return k},pa.fromBuffer=function(a){for(var r=new ArrayBuffer(a.length),h=new Uint8Array(r),d=0;d<a.length;d++)h[d]=a[d];return r},ja.fromArrayBuffer=function(a){for(var r=new Buffer(a.byteLength),h=new Uint8Array(a),d=0;d<r.length;d++)r[d]=h[d];return r};try{Bn.fs=window.require?window.require("fs"):null}catch{}function xi(a,r){this.name=a,this.uuid=l.Math.generateUUID(),this.type=r,this.format="",this.encoding="",this.data=null}function ys(a,r){if(xi.call(this,"image","Image"),this.width=-1,this.height=-1,void 0!==a)if(a instanceof ArrayBuffer)this.loadArrayBufferData(a,r);else if(ci.isBase64(a))this.encoding=ci.getFileFormat(a),this.format="base64",this.data=a;else if(a.startsWith("blob")){var h=Bn.readFileArrayBuffer(a,!0);this.loadArrayBufferData(h)}else this.encoding=Bn.getFileExtension(a),this.format="url",this.data=a;else this.createSolidColor()}function bs(a,r,h,d,y,b,N,k,T,H){this.source="string"==typeof a?new ys(a):void 0===a?new ys:a,l.Texture.call(this,document.createElement("img"),r,h,d,y,b,N,k,T,H);var Y=this;if(this.name="texture",this.category="Image",this.disposed=!1,this.format=this.source.hasTransparency()?l.RGBAFormat:l.RGBFormat,this.updateSource(),"gif"===this.source.encoding){let le=function(){Y.disposed||(Y.needsUpdate=!0,requestAnimationFrame(le))};this.generateMipmaps=!1,this.magFilter=l.LinearFilter,this.minFilter=l.LinearFilter,le()}}function Cs(a){l.AmbientLight.call(this,a),this.name="ambient",this.matrixAutoUpdate=!1}function ri(a){l.Object3D.call(this),this.name="audio",this.type="Audio",this.listener=new l.AudioListener,this.context=this.listener.context,this.matrixAutoUpdate=!1,this.gain=this.context.createGain(),this.gain.connect(this.listener.getInput()),this.buffer=null,this.filters=[],this.sourceType="empty",this.audio=void 0!==a?a:null,this.autoplay=!0,this.volume=1,this.playbackRate=1,this.startTime=0,this.loop=!0,this.detune=0,this.isPlaying=!1,this.hasPlaybackControl=!0,this.filters=[]}function Sr(a,r,h,d,y,b,N,k,T,H){void 0===r&&(r=l.CubeReflectionMapping);for(var Y=[],le=0;le<6;le++)Y.push(document.createElement("canvas"));l.Texture.call(this,Y,r,h,d,y,b,N,k,T,H),this.images=void 0!==a?a:[],this.size=512,this.flipY=!1,this.mode=6===this.images.length?Sr.CUBE:Sr.CROSS,this.images.length>0&&this.updateImages(),this.name="cubetexture",this.category="Cube"}function gr(a,r,h,d){l.Object3D.call(this),this.name="cubecamera",this.type="CubeCamera",this.near=void 0!==a?a:.01,this.far=void 0!==r?r:1e4,this.resolution=void 0!==h?h:256,this.autoUpdate=void 0!==d&&d,this.cameras=[];for(var y=0;y<6;y++){var b=new l.PerspectiveCamera(90,1,this.near,this.far);b.parent=this,this.cameras.push(b)}this.cameras[0].up.set(0,-1,0),this.cameras[0].lookAt(new l.Vector3(1,0,0)),this.cameras[1].up.set(0,-1,0),this.cameras[1].lookAt(new l.Vector3(-1,0,0)),this.cameras[2].up.set(0,0,1),this.cameras[2].lookAt(new l.Vector3(0,1,0)),this.cameras[3].up.set(0,0,-1),this.cameras[3].lookAt(new l.Vector3(0,-1,0)),this.cameras[4].up.set(0,-1,0),this.cameras[4].lookAt(new l.Vector3(0,0,1)),this.cameras[5].up.set(0,-1,0),this.cameras[5].lookAt(new l.Vector3(0,0,-1)),this.renderTarget=new l.WebGLCubeRenderTarget(this.resolution,{format:l.RGBFormat,magFilter:l.LinearFilter,minFilter:l.LinearFilter,generateMipmaps:!1});var N=this;Object.defineProperties(this,{cube:{get:function(){return N.renderTarget.texture},set:function(){}}}),this.scene=null,this.renderer=null}function ll(a,r){l.DirectionalLight.call(this,a,r),this.name="directional",this.castShadow=!0,this.shadow.camera.near=.5,this.shadow.camera.far=1e4}Bn.isLocalFile=function(a){return!(a.startsWith("http")||a.startsWith("blob")||a.startsWith("data"))},Bn.readFile=function(a,r,h,d,y){if(void 0===r&&(r=!0),Bn.fs&&Bn.isLocalFile(a)){if(!0===r){var b=Bn.fs.readFileSync(a,"utf8");return void 0!==h&&h(b),b}return Bn.fs.readFile(a,"utf8",function(k,T){null!==k?void 0!==y&&y(k):void 0!==h&&h(T)}),null}var N=new XMLHttpRequest;return N.overrideMimeType("text/plain"),N.open("GET",a,!r),void 0!==h&&(N.onload=function(){h(N.response)}),void 0!==d&&(N.onprogress=d),void 0!==y&&(N.onerror=y),N.send(null),!0===r?N.response:null},Bn.readFileArrayBuffer=function(a,r,h,d,y){if(void 0===r&&(r=!0),Bn.fs&&Bn.isLocalFile(a)){if(!0===r){var b=Bn.fs.readFileSync(a);return pa.fromBuffer(b)}return Bn.fs.readFile(a,function(k,T){null!==k?void 0!==y&&y(k):void 0!==h&&h(pa.fromBuffer(T))}),null}var N=new XMLHttpRequest;return N.open("GET",a,!r),N.overrideMimeType("text/plain; charset=x-user-defined"),void 0!==h&&(N.onload=function(){h(pa.fromBinaryString(N.response))}),void 0!==d&&(N.onprogress=d),void 0!==y&&(N.onerror=y),N.send(null),!0===r?pa.fromBinaryString(N.response):null},Bn.readFileBase64=function(a,r,h,d,y){if(void 0===r&&(r=!0),Bn.fs&&Bn.isLocalFile(a)){if(!0===r){var b=Bn.fs.readFileSync(a);return new Buffer(b).toString("base64")}return Bn.fs.readFile(a,function(k,T){null!==k?void 0!==y&&y(k):void 0!==h&&h(new Buffer(T).toString("base64"))}),null}var N=new XMLHttpRequest;return N.open("GET",a,!r),N.overrideMimeType("text/plain; charset=x-user-defined"),void 0!==h&&(N.onload=function(){h(ci.fromBinaryString(N.response))}),void 0!==d&&(N.onprogress=d),void 0!==y&&(N.onerror=y),N.send(null),!0===r?ci.fromBinaryString(N.response):null},Bn.writeFile=function(a,r,h,d){if(Bn.fs)if(void 0!==Bn.fs.writeFileSync)!1!==h?(Bn.fs.writeFileSync(a,r,"utf8"),void 0!==d&&d()):Bn.fs.writeFile(a,r,"utf8",d);else{var y=Bn.fs.createWriteStream(a,"utf8");y.write(r),y.end()}else{var b=new Blob([r],{type:"octet/stream"}),N=document.createElement("a");N.download=a,N.href=window.URL.createObjectURL(b),N.style.display="none",N.onclick=function(){document.body.removeChild(this)},document.body.appendChild(N),N.click(),void 0!==d&&d()}},Bn.writeFileBase64=function(a,r,h,d){if(Bn.fs){var y=Buffer.from(ci.removeHeader(r),"base64");if(void 0!==Bn.fs.writeFile)!1!==h?(Bn.fs.writeFileSync(a,y),void 0!==d&&d()):Bn.fs.writeFile(a,y,d);else{var b=Bn.fs.createWriteStream(a);b.write(y),b.end()}}else{var N=pa.fromBase64(ci.removeHeader(r)),k=new Blob([N]),T=document.createElement("a");T.download=a,T.href=window.URL.createObjectURL(k),T.onclick=function(){document.body.removeChild(this)},T.style.display="none",document.body.appendChild(T),T.click(),void 0!==d&&d()}},Bn.writeFileArrayBuffer=function(a,r,h,d){if(Bn.fs){var y=ja.fromArrayBuffer(r);if(void 0!==Bn.fs.writeFileSync)!1!==h?(Bn.fs.writeFileSync(a,y),void 0!==d&&d()):Bn.fs.writeFile(a,y,d);else{var b=Bn.fs.createWriteStream(a);b.write(y),b.end()}}else{var N=new Blob([r]),k=document.createElement("a");k.download=a,k.href=window.URL.createObjectURL(N),k.onclick=function(){document.body.removeChild(this)},k.style.display="none",document.body.appendChild(k),k.click(),void 0!==d&&d()}},Bn.chooseFileWrite=function(a,r){vo.runningOnDesktop()?Bn.chooseFile(function(h){h.length>0&&a(h[0].path)},r,!0):Bn.chooseFileName(function(h){a(h)},r)},Bn.chooseDirectory=function(){return new Promise(function(a,r){var h=document.createElement("input");h.type="file",h.style.display="none",h.nwdirectory=!0,document.body.appendChild(h),h.onchange=function(){a(h.value),document.body.removeChild(h)},h.onerror=r,h.onabort=r,h.click()})},Bn.chooseFile=function(a,r,h,d){var y=document.createElement("input");y.type="file",y.style.display="none",document.body.appendChild(y),void 0!==r&&(y.accept=r),!0===d&&(y.multiple=!0),y.onchange=function(){void 0!==a&&a(y.files),document.body.removeChild(y)},void 0!==h&&(y.nwsaveas=!0!==h?h:"file"),y.click()},Bn.chooseFileName=function(a,r,h){var d=prompt("Save As",void 0!==h?h:"file");null!==d&&(void 0===r||d.endsWith(r)||(d+=r),void 0!==a&&a(d))},Bn.copyFile=function(a,r){Bn.fs&&(void 0!==Bn.fs.copyFileSync?Bn.fs.copyFileSync(a,r):(a.replace(new RegExp("/","g"),"\\"),r.replace(new RegExp("/","g"),"\\"),Bn.fs.createReadStream(a).pipe(Bn.fs.createWriteStream(r))))},Bn.makeDirectory=function(a){Bn.fs&&(a.replace(new RegExp("/","g"),"\\"),Bn.fs.mkdirSync(a,{recursive:!0}))},Bn.getFilesDirectory=function(a){if(Bn.fs)try{return a.replace(new RegExp("/","g"),"\\"),Bn.fs.readdirSync(a)}catch{return[]}return[]},Bn.deleteFolder=function(a){Bn.fs&&Bn.fs.existsSync(a)&&(Bn.fs.readdirSync(a).forEach(function(r){var h=a+"/"+r;Bn.fs.lstatSync(h).isDirectory()?Bn.deleteFolder(h):Bn.fs.unlinkSync(h)}),Bn.fs.rmdirSync(a))},Bn.copyFolder=function(a,r){if(Bn.fs){a.replace(new RegExp("/","g"),"\\"),r.replace(new RegExp("/","g"),"\\"),Bn.makeDirectory(r);for(var h=Bn.fs.readdirSync(a),d=0;d<h.length;d++){var y=a+"\\"+h[d],b=r+"\\"+h[d],N=Bn.fs.statSync(y);N.isDirectory()?Bn.copyFolder(y,b):N.isSymbolicLink()?Bn.fs.symlinkSync(Bn.fs.readlinkSync(y),b):Bn.copyFile(y,b)}}},Bn.fileExists=function(a){return!!Bn.fs&&(a.replace(new RegExp("/","g"),"\\"),Bn.fs.existsSync(a))},Bn.getFileName=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(r>h?r+1:h+1,a.lastIndexOf("."))}return""},Bn.getFileNameWithExtension=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(r>h?r+1:h+1,a.length)}return""},Bn.getNameWithoutExtension=function(a){return void 0!==a?(a instanceof File&&(a=a.name),a.substring(0,a.lastIndexOf("."))):""},Bn.getFilePath=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(0,r>h?r+1:h+1)}return""},Bn.getFileExtension=function(a){return void 0!==a?(a instanceof File&&(a=a.name),a.substring(a.lastIndexOf(".")+1,a.length).toLowerCase()):""},xi.prototype.export=function(a){"base64"===this.format?Bn.writeFileBase64(a,this.data):"arraybuffer"===this.format?Bn.writeFileArrayBuffer(a,void 0!==this.arraybuffer?this.arraybuffer:this.data):"string"===this.format?Bn.writeFile(a,this.data):"json"===this.format?Bn.writeFile(a,JSON.stringify(this.data)):"url"===this.format&&Bn.writeFileArrayBuffer(a,Bn.readFileArrayBuffer(this.data))},xi.prototype.dispose=function(){},xi.prototype.toJSON=function(a){var r={};return r.name=this.name,r.uuid=this.uuid,r.type=this.type,r},ys.prototype=Object.create(xi.prototype),ys.fileIsImage=function(a){return void 0!==a&&(!!a.type.startsWith("image")||(a=a.name.toLocaleLowerCase()).endsWith("tga")||a.endsWith("dds")||a.endsWith("pvr")||a.endsWith("ktx")||a.endsWith("basis"))},ys.prototype.getImageSize=function(a){if(this.width>-1&&this.height>-1)a(this.width,this.height);else{var r=this,h=document.createElement("img");h.src=this.data,h.onload=function(){r.width=h.naturalWidth,r.height=h.naturalHeight,a(r.width,r.height)}}},ys.prototype.getImageData=function(a){var r=this,h=document.createElement("img");h.src=this.data,h.onload=function(){r.width=h.naturalWidth,r.height=h.naturalHeight;var d=document.createElement("canvas");d.width=h.naturalWidth,d.height=h.naturalWidth;var y=d.getContext("2d");y.drawImage(h,0,0,h.width,h.height),a(y.getImageData(0,0,h.width,h.height),r.width,r.height)}},ys.prototype.createSolidColor=function(a){var r=document.createElement("canvas");r.width=1,r.height=1;var h=r.getContext("2d");h.fillStyle=void 0!==a?a:qc.randomColor(),h.fillRect(0,0,1,1),this.data=r.toDataURL("image/png"),this.format="base64",this.encoding="png"},ys.prototype.loadArrayBufferData=function(a,r){var h=new Uint8Array(a),d=new Blob([h],{type:"image/"+r});this.data=URL.createObjectURL(d),this.arraybuffer=a,this.encoding=void 0!==r?r:"",this.format="arraybuffer"},ys.prototype.hasTransparency=function(a){if(!0===a&&this.width>-1&&this.height>-1){var r=document.createElement("img"),h=document.createElement("canvas");h.width=r.width,h.height=r.height;var d=h.getContext("2d");d.drawImage(r,0,0,r.width,r.height);for(var y=d.getImageData(0,0,r.width,r.height).data,b=3;b<y.length;b+=4)if(255!==y[b])return!0;return!1}return"png"===this.encoding||"gif"===this.encoding},ys.prototype.compressJPEG=function(a){var r=document.createElement("img");r.src=this.data;var h=document.createElement("canvas");h.width=r.width,h.height=r.height,h.getContext("2d").drawImage(r,0,0,r.width,r.height);var d=this;h.toBlob(function(y){var b=new FileReader;b.onload=function(){d.encoding="jpeg",d.format="arraybuffer",d.data=b.result},b.readAsArrayBuffer(y)},"image/jpeg",void 0!==a?a:.7)},ys.prototype.dispose=function(){"arraybuffer"===this.format&&URL.revokeObjectURL(this.data)},ys.prototype.toJSON=function(a){if(void 0!==a.images[this.uuid])return a.images[this.uuid];var r=xi.prototype.toJSON.call(this,a);return"url"===this.format&&this.loadArrayBufferData(Bn.readFileArrayBuffer(this.data),this.encoding),r.width=this.width,r.height=this.height,r.encoding=this.encoding,"arraybuffer"===this.format?(r.format=this.format,r.data=this.arraybuffer):"base64"===this.format?(r.format="arraybuffer",r.data=pa.fromBase64(ci.removeHeader(this.data))):(r.format=this.format,r.data=this.data),a.images[this.uuid]=r,r},bs.prototype=Object.create(l.Texture.prototype),bs.isTexture=!0,bs.prototype.updateSource=function(){if(null!==this.source){var a=this;this.image.crossOrigin="anonymous",this.image.src=this.source.data,this.image.onload=function(){a.needsUpdate=!0},this.image.onerror=function(){console.log("nunuStudio: Failed to load image "+a.source.uuid+" data."),a.source.createSolidColor(),a.image.src=a.source.data,a.needsUpdate=!0}}else console.warn("nunuStudio: Texture source is null."),this.source.createSolidColor(),this.image.src=a.source.data,this.needsUpdate=!0},bs.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disposed=!0},bs.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a),h=this.source.toJSON(a);return r.image=h.uuid,r},Cs.prototype=Object.create(l.AmbientLight.prototype),ri.prototype=Object.create(l.Object3D.prototype),ri.SOURCE={EMPTY:"empty",BUFFER:"buffer",NODE:"audioNode"},ri.prototype.onEnded=function(){this.isPlaying=!1},ri.prototype.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var a=1,r=this.filters.length;a<r;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},ri.prototype.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var a=1,r=this.filters.length;a<r;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},ri.prototype.initialize=function(){if(null!==this.audio){var a=this;this.audio.getAudioBuffer(this.context,function(r){a.setBuffer(r)})}else console.warn("nunuStudio: AudioEmitter audio is null.");this.setVolume(this.volume),this.setPlaybackRate(this.playbackRate),l.Object3D.prototype.initialize.call(this)},ri.prototype.setBuffer=function(a){return this.buffer=a,this.sourceType="buffer",!0===this.autoplay&&this.play(),this},ri.prototype.play=function(){if(null!==this.buffer){this.isPlaying&&console.warn("nunuStudio: Audio is already playing, its only possible to control the last playing instance.");var a=this.context.createBufferSource();return a.buffer=this.buffer,a.detune.value=this.detune,a.loop=this.loop,a.onended=this.onEnded.bind(this),a.playbackRate.setValueAtTime(this.playbackRate,this.startTime),a.start(0,this.startTime),this.isPlaying=!0,this.source=a,this.connect()}console.warn("nunuStudio: Audio buffer not ready, audio will not play.")},ri.prototype.pause=function(){return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this},ri.prototype.stop=function(){return this.source.stop(),this.startTime=0,this.isPlaying=!1,this},ri.prototype.setAudio=function(a){this.audio=a,null!==this.buffer&&(this.isPlaying&&this.stop(),this.disconnect());var r=this;this.audio.getAudioBuffer(this.context,function(h){r.setBuffer(h)})},ri.prototype.getVolume=function(){return this.gain.gain.value},ri.prototype.setVolume=function(a){return this.volume=a,this.gain.gain.value=a,this},ri.prototype.setLoop=function(a){return this.loop=a,this.isPlaying&&(this.source.loop=this.loop),this},ri.prototype.setDetune=function(a){return this.detune=a,!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},ri.prototype.getLoop=function(){return this.loop},ri.prototype.setPlaybackRate=function(a){return this.playbackRate=a,this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this},ri.prototype.getPlaybackRate=function(){return this.playbackRate},ri.prototype.getFilters=function(){return this.filters},ri.prototype.setFilters=function(a){return a||(a=[]),this.isPlaying?(this.disconnect(),this.filters=a,this.connect()):this.filters=a,this},ri.prototype.getFilter=function(a){return this.getFilters()[void 0!==a?a:0]},ri.prototype.setFilter=function(a){return this.setFilters(a?[a]:[])},ri.prototype.setNodeSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this},ri.prototype.getOutput=function(){return this.gain},ri.prototype.dispose=function(){this.isPlaying&&(this.stop(),this.disconnect()),l.Object3D.prototype.dispose.call(this)},ri.prototype.toJSON=function(a){var r=this.audio,h=l.Object3D.prototype.toJSON.call(this,a,function(d,y){r=r.toJSON(d)});return h.object.audio=r.uuid,h.object.volume=this.volume,h.object.autoplay=this.autoplay,h.object.startTime=this.startTime,h.object.playbackRate=this.playbackRate,h.object.loop=this.loop,h},(Sr.prototype=Object.create(l.Texture.prototype)).constructor=Sr,Sr.prototype.isCubeTexture=!0,Sr.RIGHT=0,Sr.LEFT=1,Sr.TOP=2,Sr.BOTTOM=3,Sr.FRONT=4,Sr.BACK=5,Sr.CUBE=20,Sr.CROSS=21,Sr.EQUIRECTANGULAR=22,Sr.prototype.setSize=function(a){a&a-1?console.warn("nunuStudio: CubeTexture new size is not a power of two."):this.size=a},Sr.prototype.setImages=function(a,r){this.mode=void 0!==r?r:Sr.CUBE,this.images=a},Sr.prototype.updateImages=function(){var a=this;if(this.mode===Sr.CUBE)for(var r=0;r<this.images.length;r++)"string"==typeof this.images[r]&&(this.images[r]=new ys(this.images[r])),(h=document.createElement("img")).crossOrigin="anonymous",h.index=r,h.src=this.images[r].data,h.onload=function(){a.image[this.index].width=a.size,a.image[this.index].height=a.size,a.image[this.index].getContext("2d").drawImage(this,0,0,a.size,a.size),a.needsUpdate=!0};else if(this.mode===Sr.CROSS){for(r=0;r<this.image.length;r++)this.image[r].width=this.size,this.image[r].height=this.size;(h=document.createElement("img")).src=this.images[0].data,h.onload=function(){var d=this.naturalWidth/4,y=this.naturalHeight/3;a.image[Sr.LEFT].getContext("2d").drawImage(this,0,y,d,y,0,0,a.size,a.size),a.image[Sr.FRONT].getContext("2d").drawImage(this,d,y,d,y,0,0,a.size,a.size),a.image[Sr.RIGHT].getContext("2d").drawImage(this,2*d,y,d,y,0,0,a.size,a.size),a.image[Sr.BACK].getContext("2d").drawImage(this,3*d,y,d,y,0,0,a.size,a.size),a.image[Sr.TOP].getContext("2d").drawImage(this,d,0,d,y,0,0,a.size,a.size),a.image[Sr.BOTTOM].getContext("2d").drawImage(this,d,2*y,d,y,0,0,a.size,a.size),a.needsUpdate=!0}}else if(this.mode===Sr.EQUIRECTANGULAR){for(r=0;r<this.image.length;r++)this.image[r].width=this.size,this.image[r].height=this.size;var h;(h=document.createElement("img")).src=this.images[0].data,h.onload=function(){var d=document.createElement("canvas");d.width=h.naturalWidth,d.height=h.naturalHeight;var y=d.getContext("2d");y.drawImage(h,0,0);for(var b=y.getImageData(0,0,d.width,d.height),N=0;N<6;N++){var k=Sr.renderEquirectFace(b,N,Math.PI,a.size);a.image[N].getContext("2d").putImageData(k,0,0)}a.needsUpdate=!0}}},Sr.resampleBilinear=function(a,r,h,d,y){for(var b=a.width,N=a.height,k=a.data,T=l.Math.clamp(Math.floor(h),0,b-1),H=l.Math.clamp(Math.ceil(h),0,b-1),Y=h-T,le=l.Math.clamp(Math.floor(d),0,N-1),ae=l.Math.clamp(Math.ceil(d),0,N-1),ge=d-le,we=4*(le*b+T),Se=4*(le*b+H),$e=4*(ae*b+T),Re=4*(ae*b+H),Pe=0;Pe<3;Pe++)r.data[y+Pe]=Math.ceil((k[we+Pe]*(1-Y)+k[Se+Pe]*Y)*(1-ge)+(k[$e+Pe]*(1-Y)+k[Re+Pe]*Y)*ge)},Sr.renderEquirectFace=function(a,r,h,d){for(var y=new ImageData(d,d),b=Sr.faces[r],N=0;N<d;N++)for(var k=0;k<d;k++){var T=4*(k*d+N);y.data[T+3]=255;var H=b(2*(N+.5)/d-1,2*(k+.5)/d-1),Y=Math.sqrt(H.x*H.x+H.y*H.y+H.z*H.z),le=l.Math.euclideanModulo(Math.atan2(H.y,H.x)+h,2*Math.PI),ae=Math.acos(H.z/Y),ge=a.width*le/Math.PI/2-.5,we=a.height*ae/Math.PI-.5;Sr.resampleBilinear(a,y,ge,we,T)}return y},Sr.faces=[function(a,r){return new l.Vector3(a,-1,-r)},function(a,r){return new l.Vector3(-a,1,-r)},function(a,r){return new l.Vector3(-r,-a,1)},function(a,r){return new l.Vector3(r,-a,-1)},function(a,r){return new l.Vector3(-1,-a,-r)},function(a,r){return new l.Vector3(1,a,-r)}],Sr.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);if(r.size=this.size,r.mode=this.mode,r.images=[],this.mode===Sr.EQUIRECTANGULAR||this.mode===Sr.CROSS){var h=this.images[0].toJSON(a);r.images.push(h.uuid)}else for(var d=0;d<this.images.length;d++)h=this.images[d].toJSON(a),r.images.push(h.uuid);return r},(gr.prototype=Object.create(l.Object3D.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Po?this.scene=a:a instanceof ii&&(this.renderer=a.renderer);l.Object3D.prototype.initialize.call(this)},gr.prototype.update=function(a){this.autoUpdate&&this.updateCubeMap(this.renderer,this.scene),l.Object3D.prototype.update.call(this,a)},gr.prototype.setResolution=function(a){this.resolution=a,this.renderTarget.setSize(a,a)},gr.prototype.clear=function(a,r,h,d){for(var y=a.getRenderTarget(),b=0;b<6;b++)a.setRenderTarget(this.renderTarget,b),a.clear(r,h,d);a.setRenderTarget(y)},gr.prototype.updateCubeMap=function(a,r){var h=a.autoClear;a.autoClear=!1;var d=a.getRenderTarget(),y=this.renderTarget.texture.generateMipmaps;this.renderTarget.texture.generateMipmaps=!1;for(var b=0;b<6;b++)5===b&&(this.renderTarget.texture.generateMipmaps=y),this.cameras[b].updateMatrixWorld(),a.setRenderTarget(this.renderTarget,b),a.clear(!0,!0,!0),a.render(r,this.cameras[b]);a.autoClear=h,a.setRenderTarget(d)},gr.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.near=this.near,r.object.far=this.far,r.object.resolution=this.resolution,r.object.autoUpdate=this.autoUpdate,r},(ll.prototype=Object.create(l.DirectionalLight.prototype)).updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()};var Tc,Qu,Ga,es={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")};function Li(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(Li.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Li.FullScreenQuad=(Tc=new l.OrthographicCamera(-1,1,1,-1,0,1),Qu=new l.PlaneBufferGeometry(2,2),Ga=function(a){this._mesh=new l.Mesh(Qu,a)},Object.defineProperty(Ga.prototype,"material",{get:function(){return this._mesh.material},set:function(a){this._mesh.material=a}}),Object.assign(Ga.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(a){a.render(this._mesh,Tc)}}),Ga);var Yh=function(a,r){Li.call(this),this.scene=a,this.camera=r,this.clear=!0,this.needsSwap=!1,this.inverse=!1};Yh.prototype=Object.assign(Object.create(Li.prototype),{constructor:Yh,render:function(a,r,h){var d,y,b=a.getContext(),N=a.state;N.buffers.color.setMask(!1),N.buffers.depth.setMask(!1),N.buffers.color.setLocked(!0),N.buffers.depth.setLocked(!0),this.inverse?(d=0,y=1):(d=1,y=0),N.buffers.stencil.setTest(!0),N.buffers.stencil.setOp(b.REPLACE,b.REPLACE,b.REPLACE),N.buffers.stencil.setFunc(b.ALWAYS,d,4294967295),N.buffers.stencil.setClear(y),N.buffers.stencil.setLocked(!0),a.setRenderTarget(h),this.clear&&a.clear(),a.render(this.scene,this.camera),a.setRenderTarget(r),this.clear&&a.clear(),a.render(this.scene,this.camera),N.buffers.color.setLocked(!1),N.buffers.depth.setLocked(!1),N.buffers.stencil.setLocked(!1),N.buffers.stencil.setFunc(b.EQUAL,1,4294967295),N.buffers.stencil.setOp(b.KEEP,b.KEEP,b.KEEP),N.buffers.stencil.setLocked(!0)}});var xh=function(){Li.call(this),this.needsSwap=!1};function Jh(){this.autoClear=!1,this.autoClearColor=!1,this.autoClearStencil=!1,this.autoClearDepth=!1,this.sortObjects=!0,this.clearColor=new l.Color,this.clearAlpha=1}function ur(){this.uuid=l.Math.generateUUID(),this.type="Pass",this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1,this.copyToScreen=!1}function Yo(a,r){ur.call(this),this.type="Shader",this.textureID=void 0!==r?r:"tDiffuse",a instanceof l.ShaderMaterial?(this.uniforms=a.uniforms,this.material=a):a&&(this.uniforms=l.UniformsUtils.clone(a.uniforms),this.material=new l.ShaderMaterial({defines:Object.assign({},a.defines),uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader})),this.createQuadScene()}function cl(){ur.call(this),this.type="Render",this.clear=!0}xh.prototype=Object.create(Li.prototype),Object.assign(xh.prototype,{render:function(a){a.state.buffers.stencil.setLocked(!1),a.state.buffers.stencil.setTest(!1)}}),Jh.prototype.backup=function(a){this.autoClear=a.autoClear,this.autoClearColor=a.autoClearColor,this.autoClearStencil=a.autoClearStencil,this.autoClearDepth=a.autoClearDepth,this.sortObjects=a.sortObjects,this.clearColor.copy(a.getClearColor()),this.clearAlpha=a.getClearAlpha()},Jh.prototype.restore=function(a){a.autoClear=this.autoClear,a.autoClearColor=this.autoClearColor,a.autoClearStencil=this.autoClearStencil,a.autoClearDepth=this.autoClearDepth,a.sortObjects=this.sortObjects,a.setClearColor(this.clearColor),a.setClearAlpha(this.clearAlpha)},ur.RGBALinear={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat},ur.RGBLinear={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBFormat},ur.RGBANearest={minFilter:l.NearestFilter,magFilter:l.NearestFilter,format:l.RGBAFormat},ur.prototype.createQuadScene=function(){this.camera=new l.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new l.Scene,this.quad=new l.Mesh(new l.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)},ur.prototype.setSize=function(a,r){},ur.prototype.render=function(a,r,h,d,y,b,N){},ur.prototype.dispose=function(){},ur.prototype.toJSON=function(a){var r={};return r.uuid=this.uuid,r.type=this.type,r.clear=this.clear,r.enabled=this.enabled,r.needsSwap=this.needsSwap,r.renderToScreen=this.renderToScreen,r.copyToScreen=this.copyToScreen,r},(Yo.prototype=Object.create(ur.prototype)).render=function(a,r,h,d,y,b,N){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=h.texture),this.quad.material=this.material,a.setRenderTarget(this.renderToScreen?null:r),this.clear&&a.clear(),a.render(this.scene,this.camera)},(cl.prototype=Object.create(ur.prototype)).render=function(a,r,h,d,y,b,N){this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(b,N)};var Fr={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new l.Color(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")};function Ls(a,r,h){ur.call(this),this.type="UnrealBloom",this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;for(var d=0;d<this.nMips;d++){var y;(y=new l.WebGLRenderTarget(0,0,ur.RGBALinear)).texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(y),(y=new l.WebGLRenderTarget(0,0,ur.RGBALinear)).texture.generateMipmaps=!1,this.renderTargetsVertical.push(y)}this.renderTargetBright=new l.WebGLRenderTarget(0,0,ur.RGBALinear),this.renderTargetBright.texture.generateMipmaps=!1;var b=Fr;this.highPassUniforms=l.UniformsUtils.clone(b.uniforms),this.materialHighPassFilter=new l.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var N=[3,5,7,9,11];for(d=0;d<this.nMips;d++)this.separableBlurMaterials.push(Ls.getSeperableBlurMaterial(N[d])),this.separableBlurMaterials[d].uniforms.texSize.value=new l.Vector2(0,0);this.compositeMaterial=Ls.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.highPassUniforms.luminosityThreshold.value=void 0!==h?h:.7,this.highPassUniforms.smoothWidth.value=.01,this.compositeMaterial.uniforms.bloomStrength.value=void 0!==a?a:.8,this.compositeMaterial.uniforms.bloomRadius.value=void 0!==r?r:.3,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.compositeMaterial.uniforms.bloomTintColors.value=[new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1)],this.compositeMaterial.needsUpdate=!0,this.copyUniforms=l.UniformsUtils.clone(es.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:es.vertexShader,fragmentShader:es.fragmentShader,blending:l.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.createQuadScene(),this.basic=new l.MeshBasicMaterial,Object.defineProperties(this,{strength:{get:function(){return this.compositeMaterial.uniforms.bloomStrength.value},set:function(k){this.compositeMaterial.uniforms.bloomStrength.value=k}},radius:{get:function(){return this.compositeMaterial.uniforms.bloomRadius.value},set:function(k){this.compositeMaterial.uniforms.bloomRadius.value=k}},threshold:{get:function(){return this.highPassUniforms.luminosityThreshold.value},set:function(k){}},smooth:{get:function(){return this.highPassUniforms.smoothWidth.value},set:function(k){}},bloomFactors:{get:function(){return this.compositeMaterial.uniforms.bloomFactors.value},set:function(k){}},bloomTintColors:{get:function(){return this.compositeMaterial.uniforms.bloomTintColors.value},set:function(k){this.compositeMaterial.uniforms.bloomTintColors.value=k}}})}Ls.prototype=Object.create(ur.prototype),Ls.BlurDirectionX=new l.Vector2(1,0),Ls.BlurDirectionY=new l.Vector2(0,1),Ls.prototype.dispose=function(){for(var a=0;a<this.renderTargetsHorizontal.length;a++)this.renderTargetsHorizontal[a].dispose();for(a=0;a<this.renderTargetsVertical.length;a++)this.renderTargetsVertical[a].dispose();this.renderTargetBright.dispose()},Ls.prototype.setSize=function(a,r){var h=Math.round(a/2),d=Math.round(r/2);this.renderTargetBright.setSize(h,d);for(var y=0;y<this.nMips;y++)this.renderTargetsHorizontal[y].setSize(h,d),this.renderTargetsVertical[y].setSize(h,d),this.separableBlurMaterials[y].uniforms.texSize.value.set(h,d),h=Math.round(h/2),d=Math.round(d/2)},Ls.prototype.render=function(a,r,h,d,y,b,N){a.autoClear=!1,a.setClearColor(new l.Color(0,0,0),0),y&&a.context.disable(a.context.STENCIL_TEST),this.renderToScreen&&(this.quad.material=this.basic,this.basic.map=h.texture,a.setRenderTarget(null),a.clear(),a.render(this.scene,this.camera)),this.highPassUniforms.tDiffuse.value=h.texture,this.quad.material=this.materialHighPassFilter,a.setRenderTarget(this.renderTargetBright),a.clear(),a.render(this.scene,this.camera);for(var k=this.renderTargetBright,T=0;T<this.nMips;T++)this.quad.material=this.separableBlurMaterials[T],this.separableBlurMaterials[T].uniforms.colorTexture.value=k.texture,this.separableBlurMaterials[T].uniforms.direction.value=Ls.BlurDirectionX,a.setRenderTarget(this.renderTargetsHorizontal[T]),a.clear(),a.render(this.scene,this.camera),this.separableBlurMaterials[T].uniforms.colorTexture.value=this.renderTargetsHorizontal[T].texture,this.separableBlurMaterials[T].uniforms.direction.value=Ls.BlurDirectionY,a.setRenderTarget(this.renderTargetsVertical[T]),a.clear(),a.render(this.scene,this.camera),k=this.renderTargetsVertical[T];this.quad.material=this.compositeMaterial,a.setRenderTarget(this.renderTargetsHorizontal[0]),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,y&&a.context.enable(a.context.STENCIL_TEST),a.setRenderTarget(this.renderToScreen?null:h),a.render(this.scene,this.camera)},Ls.prototype.toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);r.strength=this.strength,r.radius=this.radius,r.threshold=this.threshold,r.bloomFactors=this.bloomFactors,r.bloomTintColors=[];for(var h=0;h<this.bloomTintColors.length;h++)r.bloomTintColors.push(this.bloomTintColors[h].toArray());return r},Ls.getSeperableBlurMaterial=function(a){return new l.ShaderMaterial({defines:{KERNEL_RADIUS:a,SIGMA:a},uniforms:{colorTexture:{value:null},texSize:{value:new l.Vector2(.5,.5)},direction:{value:new l.Vector2(.5,.5)}},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\t}",fragmentShader:"\n\t\t\t#include <common>\n\t\t\tvarying vec2 vUv;\n\t\t\tuniform sampler2D colorTexture;\n\t\t\tuniform vec2 texSize;\n\t\t\tuniform vec2 direction;\n\t\t\t\n\t\t\tfloat gaussianPdf(in float x, in float sigma)\n\t\t\t{\n\t\t\t\treturn 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n\t\t\t}\n\t\t\t\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\tvec3 diffuseSum = texture2D(colorTexture, vUv).rgb * weightSum;\n\t\t\t\tfor(int i = 1; i < KERNEL_RADIUS; i++)\n\t\t\t\t{\n\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\tvec3 sample1 = texture2D(colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\tvec3 sample2 = texture2D(colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t}\n\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t}"})},Ls.getCompositeMaterial=function(a){return new l.ShaderMaterial({defines:{NUM_MIPS:a},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\t}",fragmentShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tuniform sampler2D blurTexture1;\n\t\t\tuniform sampler2D blurTexture2;\n\t\t\tuniform sampler2D blurTexture3;\n\t\t\tuniform sampler2D blurTexture4;\n\t\t\tuniform sampler2D blurTexture5;\n\t\t\tuniform sampler2D dirtTexture;\n\t\t\tuniform float bloomStrength;\n\t\t\tuniform float bloomRadius;\n\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\t\t\t\n\t\t\tfloat lerpBloomFactor(const in float factor)\n\t\t\t{\n\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t}\n\t\t\t\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = bloomStrength * (lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv));\n\t\t\t}"})};var Ku={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","\tvec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","\tgl_FragColor = newTex;","}"].join("\n")};function Xc(){Yo.call(this,Ku),this.type="Technicolor"}Xc.prototype=Object.create(Yo.prototype);var Bs={uniforms:{tDiffuse:{value:null},tDepth:{value:null},size:{value:new l.Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},radius:{value:32},onlyAO:{value:0},aoClamp:{value:.25},lumInfluence:{value:.7}},vertexShader:"varying vec2 vUv;\r\n\r\nvoid main()\r\n{\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n}",fragmentShader:"uniform float cameraNear;\r\nuniform float cameraFar;\r\n\r\n#ifdef USE_LOGDEPTHBUF\r\n\tuniform float logDepthBufFC;\r\n#endif\r\n\r\nuniform float radius; // ao radius \r\nuniform bool onlyAO; // use only ambient occlusion pass?\r\n\r\nuniform vec2 size; // texture width, height\r\nuniform float aoClamp; // depth clamp - reduces haloing at screen edges\r\n\r\nuniform float lumInfluence; // how much luminance affects occlusion\r\n\r\nuniform sampler2D tDiffuse;\r\nuniform sampler2D tDepth;\r\n\r\nvarying vec2 vUv;\r\n\r\n#define DL 2.399963229728653 // PI *(3.0 - sqrt(5.0))\r\n#define EULER 2.718281828459045\r\n\r\n// user variables\r\nconst int samples = 64; // ao sample count\r\nconst bool useNoise = true; // use noise instead of pattern for sample dithering\r\nconst float noiseAmount = 0.0004; // dithering amount\r\nconst float diffArea = 0.4; // self-shadowing reduction\r\nconst float gDisplace = 0.4; // gauss bell center\r\n\r\n// RGBA depth\r\n#include <packing>\r\n\r\n// generating noise / pattern texture for dithering\r\nvec2 rand(const vec2 coord)\r\n{\r\n\tvec2 noise;\r\n\r\n\tif(useNoise)\r\n\t{\r\n\t\tfloat nx = dot(coord, vec2(12.9898, 78.233));\r\n\t\tfloat ny = dot(coord, vec2(12.9898, 78.233) * 2.0);\r\n\t\tnoise = clamp(fract(43758.5453 * sin(vec2(nx, ny))), 0.0, 1.0);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tfloat ff = fract(1.0 - coord.s *(size.x / 2.0));\r\n\t\tfloat gg = fract(coord.t *(size.y / 2.0));\r\n\t\tnoise = vec2(0.25, 0.75) * vec2(ff) + vec2(0.75, 0.25) * gg;\r\n\t}\r\n\r\n\treturn(noise * 2.0  - 1.0) * noiseAmount;\r\n}\r\n\r\nfloat readDepth(const in vec2 coord) {\r\n\r\n\tfloat cameraFarPlusNear = cameraFar + cameraNear;\r\n\tfloat cameraFarMinusNear = cameraFar - cameraNear;\r\n\tfloat cameraCoef = 2.0 * cameraNear;\r\n\r\n\t#ifdef USE_LOGDEPTHBUF\r\n\t\tfloat logz = unpackRGBAToDepth(texture2D(tDepth, coord));\r\n\t\tfloat w = pow(2.0, (logz / logDepthBufFC)) - 1.0;\r\n\t\tfloat z = (logz / w) + 1.0;\r\n\t#else\r\n\t\tfloat z = unpackRGBAToDepth(texture2D(tDepth, coord));\r\n\t#endif\r\n\r\n\treturn cameraCoef /(cameraFarPlusNear - z * cameraFarMinusNear);\r\n}\r\n\r\nfloat compareDepths(const in float depth1, const in float depth2, inout int far)\r\n{\r\n\tfloat garea = 8.0; // gauss bell width\r\n\tfloat diff =(depth1 - depth2) * 100.0; // depth difference (0-100)\r\n\r\n\t// reduce left bell width to avoid self-shadowing\r\n\tif(diff < gDisplace)\r\n\t{\r\n\t\tgarea = diffArea;\r\n\r\n\t}\r\n\telse\r\n\t{\r\n\t\tfar = 1;\r\n\t}\r\n\r\n\tfloat dd = diff - gDisplace;\r\n\tfloat gauss = pow(EULER, -2.0 *(dd * dd) /(garea * garea));\r\n\treturn gauss;\r\n}\r\n\r\nfloat calcAO(float depth, float dw, float dh)\r\n{\r\n\tvec2 vv = vec2(dw, dh);\r\n\tvec2 coord1 = vUv + radius * vv;\r\n\tvec2 coord2 = vUv - radius * vv;\r\n\r\n\tfloat temp1 = 0.0;\r\n\tfloat temp2 = 0.0;\r\n\r\n\tint far = 0;\r\n\ttemp1 = compareDepths(depth, readDepth(coord1), far);\r\n\r\n\t// DEPTH EXTRAPOLATION\r\n\tif(far > 0)\r\n\t{\r\n\t\ttemp2 = compareDepths(readDepth(coord2), depth, far);\r\n\t\ttemp1 +=(1.0 - temp1) * temp2;\r\n\t}\r\n\r\n\treturn temp1;\r\n}\r\n\r\nvoid main()\r\n{\r\n\tvec2 noise = rand(vUv);\r\n\tfloat depth = readDepth(vUv);\r\n\r\n\tfloat tt = clamp(depth, aoClamp, 1.0);\r\n\r\n\tfloat w =(1.0 / size.x) / tt +(noise.x *(1.0 - noise.x));\r\n\tfloat h =(1.0 / size.y) / tt +(noise.y *(1.0 - noise.y));\r\n\r\n\tfloat ao = 0.0;\r\n\r\n\tfloat dz = 1.0 / float(samples);\r\n\tfloat l = 0.0;\r\n\tfloat z = 1.0 - dz / 2.0;\r\n\r\n\tfor(int i = 0; i <= samples; i ++)\r\n\t{\r\n\t\tfloat r = sqrt(1.0 - z);\r\n\r\n\t\tfloat pw = cos(l) * r;\r\n\t\tfloat ph = sin(l) * r;\r\n\t\tao += calcAO(depth, pw * w, ph * h);\r\n\t\tz = z - dz;\r\n\t\tl = l + DL;\r\n\t}\r\n\r\n\tao /= float(samples);\r\n\tao = 1.0 - ao;\r\n\r\n\tvec3 color = texture2D(tDiffuse, vUv).rgb;\r\n\r\n\tvec3 lumcoeff = vec3(0.299, 0.587, 0.114);\r\n\tfloat lum = dot(color.rgb, lumcoeff);\r\n\tvec3 luminance = vec3(lum);\r\n\r\n\tvec3 final = vec3(color * mix(vec3(ao), vec3(1.0), luminance * lumInfluence)); // mix(color * ao, white, luminance)\r\n\r\n\tif(onlyAO)\r\n\t{\r\n\t\tfinal = vec3(mix(vec3(ao), vec3(1.0), luminance * lumInfluence)); // ambient occlusion only\r\n\t}\r\n\r\n\tgl_FragColor = vec4(final, 1.0);\r\n}"};function ko(){Yo.call(this,Bs),this.type="SSAO",this.depthMaterial=new l.MeshDepthMaterial,this.depthMaterial.depthPacking=l.RGBADepthPacking,this.depthMaterial.blending=l.NoBlending,this.depthRenderTarget=new l.WebGLRenderTarget(2,2,{minFilter:l.LinearFilter,magFilter:l.LinearFilter}),this.uniforms.tDepth.value=this.depthRenderTarget.texture,this.uniforms.size.value.set(2,2),Object.defineProperties(this,{radius:{get:function(){return this.uniforms.radius.value},set:function(a){this.uniforms.radius.value=a}},onlyAO:{get:function(){return this.uniforms.onlyAO.value},set:function(a){this.uniforms.onlyAO.value=a}},aoClamp:{get:function(){return this.uniforms.aoClamp.value},set:function(a){this.uniforms.aoClamp.value=a}},lumInfluence:{get:function(){return this.uniforms.lumInfluence.value},set:function(a){this.uniforms.lumInfluence.value=a}}}),this.radius=4,this.onlyAO=!1,this.aoClamp=.25,this.lumInfluence=.7}(ko.prototype=Object.create(Yo.prototype)).render=function(a,r,h,d,y,b,N){this.uniforms.cameraNear.value=N.near,this.uniforms.cameraFar.value=N.far,b.overrideMaterial=this.depthMaterial,a.setRenderTarget(this.depthRenderTarget),a.clear(!0,!0,!0),a.render(b,N),b.overrideMaterial=null,Yo.prototype.render.call(this,a,r,h,d,y)},ko.prototype.setSize=function(a,r){this.uniforms.size.value.set(a,r),this.depthRenderTarget.setSize(a,r)},ko.prototype.toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.onlyAO=this.onlyAO,r.radius=this.radius,r.aoClamp=this.aoClamp,r.lumInfluence=this.lumInfluence,r};var Zh={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new l.Vector2},cameraProjectionMatrix:{value:new l.Matrix4},cameraInverseProjectionMatrix:{value:new l.Matrix4},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tDepth;","uniform sampler2D tNoise;","uniform vec3 kernel[ KERNEL_SIZE ];","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float kernelRadius;","uniform float minDistance;","uniform float maxDistance;","varying vec2 vUv;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\treturn texture2D( tDepth, screenPosition ).x;","}","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec2 screenPosition ) {","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","}","void main() {","\tfloat depth = getDepth( vUv );","\tfloat viewZ = getViewZ( depth );","\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );","\tvec3 viewNormal = getViewNormal( vUv );"," vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );","\tvec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;","\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );","\tvec3 bitangent = cross( viewNormal, tangent );","\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );"," float occlusion = 0.0;"," for ( int i = 0; i < KERNEL_SIZE; i ++ ) {","\t\tvec3 sampleVector = kernelMatrix * kernel[ i ];","\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );","\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );","\t\tsamplePointNDC /= samplePointNDC.w;","\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;","\t\tfloat realDepth = getLinearDepth( samplePointUv );","\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );","\t\tfloat delta = sampleDepth - realDepth;","\t\tif ( delta > minDistance && delta < maxDistance ) {","\t\t\tocclusion += 1.0;","\t\t}","\t}","\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );","\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );","}"].join("\n")},Jl=(["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","varying vec2 vUv;","#include <packing>","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","void main() {","\tfloat depth = getLinearDepth( vUv );","\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );","}"].join("\n"),{uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texelSize = ( 1.0 / resolution );","\tfloat result = 0.0;","\tfor ( int i = - 2; i <= 2; i ++ ) {","\t\tfor ( int j = - 2; j <= 2; j ++ ) {","\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;","\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;","\t\t}","\t}","\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );","}"].join("\n")});function go(a){void 0===a&&(a=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var r=0;r<256;r++)this.p[r]=Math.floor(256*a.random());for(this.perm=[],r=0;r<512;r++)this.perm[r]=this.p[255&r];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}function Ai(){ur.call(this),this.type="SSAONOH",this.kernel=[],this.noiseTexture=null,this.createQuadScene(),this.depthTexture=new l.DepthTexture,this.depthTexture.type=l.UnsignedShortType,this.depthTexture.minFilter=l.NearestFilter,this.depthTexture.maxFilter=l.NearestFilter,this.normalMaterial=new l.MeshNormalMaterial,this.normalMaterial.blending=l.NoBlending,this.normalRenderTarget=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat,depthTexture:this.depthTexture,depthBuffer:!0}),this.ssaoRenderTarget=new l.WebGLRenderTarget(1,1,ur.RGBALinear),this.blurRenderTarget=new l.WebGLRenderTarget(1,1,ur.RGBALinear),this.blurMaterial=new l.ShaderMaterial({defines:Object.assign({},Jl.defines),uniforms:l.UniformsUtils.clone(Jl.uniforms),vertexShader:Jl.vertexShader,fragmentShader:Jl.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.ssaoMaterial=new l.ShaderMaterial({defines:Object.assign({},Zh.defines),uniforms:l.UniformsUtils.clone(Zh.uniforms),vertexShader:Zh.vertexShader,fragmentShader:Zh.fragmentShader,blending:l.NoBlending}),this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.copyMaterial=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(es.uniforms),vertexShader:es.vertexShader,fragmentShader:es.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:l.DstColorFactor,blendDst:l.ZeroFactor,blendEquation:l.AddEquation,blendSrcAlpha:l.DstAlphaFactor,blendDstAlpha:l.ZeroFactor,blendEquationAlpha:l.AddEquation}),this._kernelSize=0;var a=this;Object.defineProperties(this,{kernelRadius:{get:function(){return a.ssaoMaterial.uniforms.kernelRadius.value},set:function(r){a.ssaoMaterial.uniforms.kernelRadius.value=r}},minDistance:{get:function(){return a.ssaoMaterial.uniforms.minDistance.value},set:function(r){a.ssaoMaterial.uniforms.minDistance.value=r}},maxDistance:{get:function(){return a.ssaoMaterial.uniforms.maxDistance.value},set:function(r){a.ssaoMaterial.uniforms.maxDistance.value=r}},kernelSize:{get:function(){return a._kernelSize},set:function(r){a._kernelSize=r,a.generateSampleKernel(),a.generateRandomKernelRotations(),a.ssaoMaterial.uniforms.tNoise.value=a.noiseTexture,a.ssaoMaterial.uniforms.kernel.value=a.kernel}}}),this.kernelSize=64,this.kernelRadius=8,this.minDistance=.1,this.maxDistance=1e3}go.prototype.dot=function(a,r,h){return a[0]*r+a[1]*h},go.prototype.dot3=function(a,r,h,d){return a[0]*r+a[1]*h+a[2]*d},go.prototype.dot4=function(a,r,h,d,y){return a[0]*r+a[1]*h+a[2]*d+a[3]*y},go.prototype.noise=function(a,r){var h,d,y=(a+r)*(.5*(Math.sqrt(3)-1)),b=Math.floor(a+y),N=Math.floor(r+y),k=(3-Math.sqrt(3))/6,T=(b+N)*k,H=a-(b-T),Y=r-(N-T);H>Y?(h=1,d=0):(h=0,d=1);var le=H-h+k,ae=Y-d+k,ge=H-1+2*k,we=Y-1+2*k,Se=255&b,$e=255&N,Pe=this.perm[Se+h+this.perm[$e+d]]%12,Oe=this.perm[Se+1+this.perm[$e+1]]%12,Fe=.5-H*H-Y*Y,De=.5-le*le-ae*ae,Qe=.5-ge*ge-we*we;return 70*((Fe<0?0:(Fe*=Fe)*Fe*this.dot(this.grad3[this.perm[Se+this.perm[$e]]%12],H,Y))+(De<0?0:(De*=De)*De*this.dot(this.grad3[Pe],le,ae))+(Qe<0?0:(Qe*=Qe)*Qe*this.dot(this.grad3[Oe],ge,we)))},go.prototype.noise3d=function(a,r,h){var d,y,b,N,k,T,H=.3333333333333333*(a+r+h),Y=Math.floor(a+H),le=Math.floor(r+H),ae=Math.floor(h+H),ge=1/6,we=(Y+le+ae)*ge,Se=a-(Y-we),$e=r-(le-we),Re=h-(ae-we);Se>=$e?$e>=Re?(d=1,y=0,b=0,N=1,k=1,T=0):Se>=Re?(d=1,y=0,b=0,N=1,k=0,T=1):(d=0,y=0,b=1,N=1,k=0,T=1):$e<Re?(d=0,y=0,b=1,N=0,k=1,T=1):Se<Re?(d=0,y=1,b=0,N=0,k=1,T=1):(d=0,y=1,b=0,N=1,k=1,T=0);var Pe=Se-d+ge,Oe=$e-y+ge,Fe=Re-b+ge,De=Se-N+2*ge,Qe=$e-k+2*ge,it=Re-T+2*ge,ct=Se-1+.5,_t=$e-1+.5,$t=Re-1+.5,rn=255&Y,Dt=255&le,Lt=255&ae,ut=this.perm[rn+d+this.perm[Dt+y+this.perm[Lt+b]]]%12,Tt=this.perm[rn+N+this.perm[Dt+k+this.perm[Lt+T]]]%12,Qt=this.perm[rn+1+this.perm[Dt+1+this.perm[Lt+1]]]%12,vn=.6-Se*Se-$e*$e-Re*Re,gn=.6-Pe*Pe-Oe*Oe-Fe*Fe,fr=.6-De*De-Qe*Qe-it*it,sr=.6-ct*ct-_t*_t-$t*$t;return 32*((vn<0?0:(vn*=vn)*vn*this.dot3(this.grad3[this.perm[rn+this.perm[Dt+this.perm[Lt]]]%12],Se,$e,Re))+(gn<0?0:(gn*=gn)*gn*this.dot3(this.grad3[ut],Pe,Oe,Fe))+(fr<0?0:(fr*=fr)*fr*this.dot3(this.grad3[Tt],De,Qe,it))+(sr<0?0:(sr*=sr)*sr*this.dot3(this.grad3[Qt],ct,_t,$t)))},go.prototype.noise4d=function(a,r,h,d){var y,b,N,k,T,H,Y,le,ae,ge,we,Se,$e=this.grad4,Re=this.simplex,Pe=this.perm,Oe=(Math.sqrt(5)-1)/4,Fe=(5-Math.sqrt(5))/20,De=(a+r+h+d)*Oe,Qe=Math.floor(a+De),it=Math.floor(r+De),ct=Math.floor(h+De),_t=Math.floor(d+De),$t=(Qe+it+ct+_t)*Fe,rn=a-(Qe-$t),Dt=r-(it-$t),Lt=h-(ct-$t),Ct=d-(_t-$t),ut=(rn>Dt?32:0)+(rn>Lt?16:0)+(Dt>Lt?8:0)+(rn>Ct?4:0)+(Dt>Ct?2:0)+(Lt>Ct?1:0),Tt=rn-(y=Re[ut][0]>=3?1:0)+Fe,Qt=Dt-(b=Re[ut][1]>=3?1:0)+Fe,vn=Lt-(N=Re[ut][2]>=3?1:0)+Fe,gn=Ct-(k=Re[ut][3]>=3?1:0)+Fe,fr=rn-(T=Re[ut][0]>=2?1:0)+2*Fe,sr=Dt-(H=Re[ut][1]>=2?1:0)+2*Fe,Rn=Lt-(Y=Re[ut][2]>=2?1:0)+2*Fe,Jn=Ct-(le=Re[ut][3]>=2?1:0)+2*Fe,Kn=rn-(ae=Re[ut][0]>=1?1:0)+3*Fe,Er=Dt-(ge=Re[ut][1]>=1?1:0)+3*Fe,vi=Lt-(we=Re[ut][2]>=1?1:0)+3*Fe,no=Ct-(Se=Re[ut][3]>=1?1:0)+3*Fe,fo=rn-1+4*Fe,Vo=Dt-1+4*Fe,Uo=Lt-1+4*Fe,Gs=Ct-1+4*Fe,hs=255&Qe,ps=255&it,ds=255&ct,Ic=255&_t,Up=Pe[hs+y+Pe[ps+b+Pe[ds+N+Pe[Ic+k]]]]%32,ip=Pe[hs+T+Pe[ps+H+Pe[ds+Y+Pe[Ic+le]]]]%32,sp=Pe[hs+ae+Pe[ps+ge+Pe[ds+we+Pe[Ic+Se]]]]%32,Ad=Pe[hs+1+Pe[ps+1+Pe[ds+1+Pe[Ic+1]]]]%32,Oc=.6-rn*rn-Dt*Dt-Lt*Lt-Ct*Ct,ap=.6-Tt*Tt-Qt*Qt-vn*vn-gn*gn,au=.6-fr*fr-sr*sr-Rn*Rn-Jn*Jn,Na=.6-Kn*Kn-Er*Er-vi*vi-no*no,$d=.6-fo*fo-Vo*Vo-Uo*Uo-Gs*Gs;return 27*((Oc<0?0:(Oc*=Oc)*Oc*this.dot4($e[Pe[hs+Pe[ps+Pe[ds+Pe[Ic]]]]%32],rn,Dt,Lt,Ct))+(ap<0?0:(ap*=ap)*ap*this.dot4($e[Up],Tt,Qt,vn,gn))+(au<0?0:(au*=au)*au*this.dot4($e[ip],fr,sr,Rn,Jn))+(Na<0?0:(Na*=Na)*Na*this.dot4($e[sp],Kn,Er,vi,no))+($d<0?0:($d*=$d)*$d*this.dot4($e[Ad],fo,Vo,Uo,Gs)))},(Ai.prototype=Object.create(ur.prototype)).generateSampleKernel=function(){for(var a=0;a<this._kernelSize;a++){var r=new l.Vector3;r.x=2*Math.random()-1,r.y=2*Math.random()-1,r.z=Math.random(),r.normalize();var h=a/this._kernelSize;h=l.Math.lerp(.1,1,h*h),r.multiplyScalar(h),this.kernel.push(r)}},Ai.prototype.generateRandomKernelRotations=function(){for(var a=new go,r=new Float32Array(16),h=0;h<16;h++){var d=2*Math.random()-1,y=2*Math.random()-1;r[h]=a.noise3d(d,y,0)}this.noiseTexture=new l.DataTexture(r,4,4,l.LuminanceFormat,l.FloatType),this.noiseTexture.wrapS=l.RepeatWrapping,this.noiseTexture.wrapT=l.RepeatWrapping,this.noiseTexture.needsUpdate=!0},Ai.prototype.render=function(a,r,h,d,y,b,N){a.autoClear=!1,a.setClearColor(7829503),a.setClearAlpha(1),b.overrideMaterial=this.normalMaterial,a.setRenderTarget(this.normalRenderTarget),a.clear(!0,!0,!0),a.render(b,N),b.overrideMaterial=null,this.ssaoMaterial.uniforms.tDepth.value=this.depthTexture,this.ssaoMaterial.uniforms.tDiffuse.value=h.texture,this.ssaoMaterial.uniforms.cameraNear.value=N.near,this.ssaoMaterial.uniforms.cameraFar.value=N.far,this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(N.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(N.projectionMatrix),this.renderPass(a,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(a,this.blurMaterial,this.blurRenderTarget),this.renderToScreen?(this.copyMaterial.uniforms.tDiffuse.value=h.texture,this.copyMaterial.blending=l.NoBlending,this.renderPass(a,this.copyMaterial,null,this.clear),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=l.CustomBlending,this.renderPass(a,this.copyMaterial,null,!1)):(this.copyMaterial.uniforms.tDiffuse.value=h.texture,this.copyMaterial.blending=l.NoBlending,this.renderPass(a,this.copyMaterial,r,this.clear),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=l.CustomBlending,this.renderPass(a,this.copyMaterial,r,!1))},Ai.prototype.renderPass=function(a,r,h,d){this.quad.material=r,a.autoClear=!1,a.setRenderTarget(h),d&&a.clear(!0,!0,!0),a.render(this.scene,this.camera)},Ai.prototype.dispose=function(){this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.quad.geometry.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose()},Ai.prototype.setSize=function(a,r){this.ssaoMaterial.uniforms.resolution.value.set(a,r),this.blurMaterial.uniforms.resolution.value.set(a,r),this.normalRenderTarget.setSize(a,r),this.ssaoRenderTarget.setSize(a,r),this.blurRenderTarget.setSize(a,r)},Ai.prototype.toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.kernelSize=this.kernelSize,r.kernelRadius=this.kernelRadius,r.minDistance=this.minDistance,r.maxDistance=this.maxDistance,r};var Ns={uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","\tconst mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","\tconst mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","\tfloat tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","\tfloat tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","\tfloat tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","\tfloat tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","\tfloat tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","\tfloat tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","\tfloat tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","\tfloat tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","\tfloat tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","\tfloat valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","\t\tGx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","\t\tGx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","\tfloat valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","\t\tGy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","\t\tGy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","\tfloat G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","\tgl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n")};function Rs(){Yo.call(this,Ns),this.type="Sobel"}(Rs.prototype=Object.create(Yo.prototype)).setSize=function(a,r){this.uniforms.resolution.value.set(a,r)};var $l={uniforms:{tDiffuse:{value:null},hue:{value:0},saturation:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tfloat angle = hue * 3.14159265;","\tfloat s = sin(angle), c = cos(angle);","\tvec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","\tfloat len = length(gl_FragColor.rgb);","\tgl_FragColor.rgb = vec3(","\t\tdot(gl_FragColor.rgb, weights.xyz),","\t\tdot(gl_FragColor.rgb, weights.zxy),","\t\tdot(gl_FragColor.rgb, weights.yzx)","\t);","\tfloat average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","\tif (saturation > 0.0) {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","\t} else {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","\t}","}"].join("\n")};function Fo(a,r){Yo.call(this,$l),this.type="HueSaturation",Object.defineProperties(this,{hue:{get:function(){return this.uniforms.hue.value},set:function(h){this.uniforms.hue.value=h}},saturation:{get:function(){return this.uniforms.saturation.value},set:function(h){this.uniforms.saturation.value=h}}}),this.hue=void 0!==a?a:0,this.saturation=void 0!==r?r:0}(Fo.prototype=Object.create(Yo.prototype)).toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.hue=this.hue,r.saturation=this.saturation,r};var Cl={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );","\tfloat dx = rand( vUv + time );","\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","\tif( grayscale ) {","\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","\t}","\tgl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")};function ul(a,r,h,d){ur.call(this),this.type="Film",this.createQuadScene(),this.uniforms=l.UniformsUtils.clone(Cl.uniforms),this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Cl.vertexShader,fragmentShader:Cl.fragmentShader});var y=this;Object.defineProperties(this,{grayscale:{get:function(){return y.uniforms.grayscale.value},set:function(b){y.uniforms.grayscale.value=b}},noiseIntensity:{get:function(){return y.uniforms.nIntensity.value},set:function(b){y.uniforms.nIntensity.value=b}},scanlinesIntensity:{get:function(){return y.uniforms.sIntensity.value},set:function(b){y.uniforms.sIntensity.value=b}},scanlinesCount:{get:function(){return y.uniforms.sCount.value},set:function(b){y.uniforms.sCount.value=b}}}),this.grayscale=void 0!==d&&d,this.noiseIntensity=void 0!==a?a:.35,this.scanlinesIntensity=void 0!==r?r:.5,this.scanlinesCount=void 0!==h?h:512}(ul.prototype=Object.create(ur.prototype)).render=function(a,r,h,d,y,b,N){this.uniforms.time.value+=d,this.uniforms.tDiffuse.value=h.texture,this.quad.material=this.material,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},ul.prototype.toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.grayscale=this.grayscale,r.noiseIntensity=this.noiseIntensity,r.scanlinesIntensity=this.scanlinesIntensity,r.scanlinesCount=this.scanlinesCount,r};var Zl={uniforms:{tDiffuse:{value:null},tSize:{value:new l.Vector2(256,256)},center:{value:new l.Vector2(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","\tfloat s = sin( angle ), c = cos( angle );","\tvec2 tex = vUv * tSize - center;","\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","\tvec4 color = texture2D( tDiffuse, vUv );","\tfloat average = ( color.r + color.g + color.b ) / 3.0;","\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")};function Mc(a,r,h){ur.call(this),this.type="DotScreen",this.createQuadScene(),this.uniforms=l.UniformsUtils.clone(Zl.uniforms),this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Zl.vertexShader,fragmentShader:Zl.fragmentShader}),Object.defineProperties(this,{center:{get:function(){return this.uniforms.center.value},set:function(d){this.uniforms.center.value=d}},angle:{get:function(){return this.uniforms.angle.value},set:function(d){this.uniforms.angle.value=d}},scale:{get:function(){return this.uniforms.scale.value},set:function(d){this.uniforms.scale.value=d}}}),void 0!==a&&this.center.copy(a),this.angle=void 0!==r?r:.5,this.scale=void 0!==h?h:.8}function Yc(){Yo.call(this,es),this.type="Copy"}(Mc.prototype=Object.create(ur.prototype)).render=function(a,r,h,d,y,b,N){this.uniforms.tDiffuse.value=h.texture,this.uniforms.tSize.value.set(h.width,h.height),this.quad.material=this.material,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},Mc.prototype.toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.center=this.center.toArray(),r.angle=this.angle,r.scale=this.scale,r},Yc.prototype=Object.create(Yo.prototype);var cr={uniforms:{tDiffuse:{value:null},color:{value:new l.Color(16777215)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tgl_FragColor = vec4( v * color, texel.w );","}"].join("\n")};function Cp(){Yo.call(this,cr),this.type="Colorify",Object.defineProperties(this,{color:{get:function(){return this.uniforms.color.value},set:function(a){this.uniforms.color.value=a}}})}(Cp.prototype=Object.create(Yo.prototype)).toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.color=this.color.getHex(),r};var Ta={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","\tvec2 aspectcorrect = vec2( 1.0, aspect );","\tfloat viewZ = getViewZ( getDepth( vUv ) );","\tfloat factor = ( focus + viewZ );","\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","\tvec2 dofblur9 = dofblur * 0.9;","\tvec2 dofblur7 = dofblur * 0.7;","\tvec2 dofblur4 = dofblur * 0.4;","\tvec4 col = vec4( 0.0 );","\tcol += texture2D( tColor, vUv.xy );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","\tgl_FragColor = col / 41.0;","\tgl_FragColor.a = 1.0;","}"].join("\n")};function Ha(a,r,h){ur.call(this),this.type="Bokeh",this.renderTargetColor=new l.WebGLRenderTarget(0,0,ur.RGBLinear),this.renderTargetDepth=this.renderTargetColor.clone(),this.materialDepth=new l.MeshDepthMaterial,this.materialDepth.depthPacking=l.RGBADepthPacking,this.materialDepth.blending=l.NoBlending,this.uniforms=l.UniformsUtils.clone(Ta.uniforms),this.uniforms.tDepth.value=this.renderTargetDepth.texture,this.materialBokeh=new l.ShaderMaterial({defines:Ta.defines,uniforms:this.uniforms,vertexShader:Ta.vertexShader,fragmentShader:Ta.fragmentShader}),this.createQuadScene(),this.quad.material=this.materialBokeh;var d=this;Object.defineProperties(this,{aperture:{get:function(){return d.uniforms.aperture.value},set:function(y){d.uniforms.aperture.value=y}},focus:{get:function(){return d.uniforms.focus.value},set:function(y){d.uniforms.focus.value=y}},maxblur:{get:function(){return d.uniforms.maxblur.value},set:function(y){d.uniforms.maxblur.value=y}}}),this.focus=void 0!==a?a:1,this.aperture=void 0!==r?r:1,this.maxblur=void 0!==h?h:.2}(Ha.prototype=Object.create(ur.prototype)).render=function(a,r,h,d,y,b,N){b.overrideMaterial=this.materialDepth,a.autoClear=!1,a.setClearColor(16777215),a.setClearAlpha(1),a.setRenderTarget(this.renderTargetDepth),a.clear(!0,!0,!0),a.render(b,N),this.uniforms.tColor.value=h.texture,this.uniforms.nearClip.value=N.near,this.uniforms.farClip.value=N.far,this.uniforms.aspect.value=N.aspect,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera),b.overrideMaterial=null},Ha.prototype.setSize=function(a,r){this.renderTargetColor.setSize(a,r),this.renderTargetDepth.setSize(a,r)},Ha.prototype.toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.aperture=this.aperture,r.focus=this.focus,r.maxblur=this.maxblur,r};var Ll={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new l.Vector2(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvec2 imageCoord = vUv;","\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","\t\timageCoord += uImageIncrement;","\t}","\tgl_FragColor = sum;","}"].join("\n"),buildKernel:function(a){var h,d,y,b,k,T,N=2*Math.ceil(3*a)+1;for(N>25&&(N=25),b=.5*(N-1),d=new Array(N),y=0,h=0;h<N;++h)d[h]=(k=h-b,T=a,Math.exp(-k*k/(2*T*T))),y+=d[h];for(h=0;h<N;++h)d[h]/=y;return d}};function Dr(a,r,h,d){ur.call(this),this.type="Bloom",this.copyToScreen=!0,this.createQuadScene(),a=void 0!==a?a:1,r=void 0!==r?r:25,h=void 0!==h?h:4,this.renderTargetX=new l.WebGLRenderTarget(d=void 0!==d?d:256,d,ur.RGBALinear),this.renderTargetY=new l.WebGLRenderTarget(d,d,ur.RGBALinear),this.copyUniforms=l.UniformsUtils.clone(es.uniforms),this.copyUniforms.opacity.value=a,this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:es.vertexShader,fragmentShader:es.fragmentShader,blending:l.AdditiveBlending,transparent:!0}),this.convolutionUniforms=l.UniformsUtils.clone(Ll.uniforms),this.convolutionUniforms.uImageIncrement.value=Dr.blurX,this.convolutionUniforms.cKernel.value=Ll.buildKernel(h),this.materialConvolution=new l.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:Ll.vertexShader,fragmentShader:Ll.fragmentShader,defines:{KERNEL_SIZE_FLOAT:r.toFixed(1),KERNEL_SIZE_INT:r.toFixed(0)}})}Dr.blurX=new l.Vector2(.001953125,0),Dr.blurY=new l.Vector2(0,.001953125),(Dr.prototype=Object.create(ur.prototype)).render=function(a,r,h,d,y,b,N){y&&a.context.disable(a.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=h.texture,this.convolutionUniforms.uImageIncrement.value=Dr.blurX,a.setRenderTarget(this.renderTargetX),a.clear(!0,!0,!0),a.render(this.scene,this.camera),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Dr.blurY,a.setRenderTarget(this.renderTargetY),a.clear(!0,!0,!0),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,y&&a.context.enable(a.context.STENCIL_TEST),a.setRenderTarget(r),a.render(this.scene,this.camera)},Dr.prototype.toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.strength=this.strength,r.kernelSize=this.kernelSize,r.sigma=this.sigma,r.resolution=this.resolution,r};var Ac={uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};function qp(){Yo.call(this,Ac),this.type="FXAA"}(qp.prototype=Object.create(Yo.prototype)).setSize=function(a,r){this.uniforms.resolution.value.set(1/a,1/r)};var xu={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float damp;","uniform sampler2D tOld;","uniform sampler2D tNew;","varying vec2 vUv;","vec4 when_gt( vec4 x, float y ) {","\treturn max( sign( x - y ), 0.0 );","}","void main() {","\tvec4 texelOld = texture2D( tOld, vUv );","\tvec4 texelNew = texture2D( tNew, vUv );","\ttexelOld *= damp * when_gt( texelOld, 0.1 );","\tgl_FragColor = max(texelNew, texelOld);","}"].join("\n")};function ui(a){ur.call(this),this.type="Afterimage",this.uniforms=l.UniformsUtils.clone(xu.uniforms),this.textureComp=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.NearestFilter,format:l.RGBAFormat}),this.textureOld=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.NearestFilter,format:l.RGBAFormat}),this.shaderMaterial=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:xu.vertexShader,fragmentShader:xu.fragmentShader}),this.basicMaterial=new l.MeshBasicMaterial,this.createQuadScene(),Object.defineProperties(this,{damp:{get:function(){return this.uniforms.damp.value},set:function(r){this.uniforms.damp.value=r}}}),this.damp=void 0!==a?a:.96}(ui.prototype=Object.create(ur.prototype)).render=function(a,r,h,d,y,b,N){var k=this.textureOld;this.textureOld=this.textureComp,this.textureComp=k,this.uniforms.tNew.value=h.texture,this.uniforms.tOld.value=this.textureOld.texture,this.quad.material=this.shaderMaterial,a.autoClear=!1,a.setRenderTarget(this.textureComp),a.render(this.scene,this.camera),this.basicMaterial.map=this.textureComp.texture,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,this.quad.material=this.basicMaterial,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},ui.prototype.setSize=function(a,r){this.textureComp.setSize(a,r),this.textureOld.setSize(a,r)},ui.prototype.toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.damp=this.damp,r};var ir={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tfloat l = linearToRelativeLuminance( texel.rgb );","\tgl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")},Bl={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","\tuniform sampler2D luminanceMap;","#else","\tuniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","\t#ifdef ADAPTED_LUMINANCE","\t\tfloat fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","\t#else","\t\tfloat fLumAvg = averageLuminance;","\t#endif","\tfloat fLumPixel = linearToRelativeLuminance( vColor );","\tfloat fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","\tfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","\treturn fLumCompressed * vColor;","}","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")};function Jc(a,r){ur.call(this);var h=this;this.type="AdaptiveToneMapping",this.needsInit=!0,this.resolution=void 0!==r?r:256,this._adaptive=void 0===a||a,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,this.copyUniforms=l.UniformsUtils.clone(es.uniforms),this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:es.vertexShader,fragmentShader:es.fragmentShader,blending:l.NoBlending,depthTest:!1}),this.materialLuminance=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(ir.uniforms),vertexShader:ir.vertexShader,fragmentShader:ir.fragmentShader,blending:l.NoBlending}),this.createShader(),void 0===Bl&&console.error("nunuStudio: AdaptiveToneMappingPass relies on ToneMapShader"),this.materialToneMap=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(Bl.uniforms),vertexShader:Bl.vertexShader,fragmentShader:Bl.fragmentShader,blending:l.NoBlending}),this.createQuadScene(),Object.defineProperties(this,{minLuminance:{get:function(){return h.adaptLuminanceShader.uniforms.minLuminance.value},set:function(d){h.adaptLuminanceShader.uniforms.minLuminance.value=d}},tau:{get:function(){return h.adaptLuminanceShader.uniforms.tau.value},set:function(d){h.adaptLuminanceShader.uniforms.tau.value=d}},adaptive:{get:function(){return h._adaptive},set:function(d){d?(this._adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this._adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0}}})}function Bo(){this.uuid=l.Math.generateUUID(),this.width=1,this.height=1,this.passes=[],this.writeBuffer=new l.WebGLRenderTarget(this.width,this.height,Bo.bufferParameters),this.readBuffer=new l.WebGLRenderTarget(this.width,this.height,Bo.bufferParameters),this.copyPass=new Yo(es),this.rendererState=new Jh}function Wn(a){this.keys=[],this.actions=[];var r=this,h=this.actions;this.events=new pn,this.events.add(window,"keydown",function(d){h.push(d.keyCode),h.push(li.DOWN)}),this.events.add(window,"keyup",function(d){h.push(d.keyCode),h.push(li.UP)}),this.events.add(window,"focus",function(d){r.reset()}),!0!==a&&this.create()}function Zc(){l.Group.call(this),this.name="controls",this.type="FirstPersonControls",this.sensitivity=.005,this.needsButtonPressed=!0,this.movementEnabled=!0,this.moveSpeed=.05,this.moveOnPlane=!1,this.moveKeys=[Wn.W,Wn.S,Wn.A,Wn.D],this.vector=new l.Vector2(0,0),this.mouse=null,this.keyboard=null,this.tempVector=new l.Vector3}function wu(){l.Group.call(this),this.name="group",this.type="Group"}function hl(a){l.Object3D.call(this),this.element=a,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)});var r=this,h=!0;Object.defineProperties(this,{visible:{get:function(){return h},set:function(d){h=d,r.element.style.display=d?"block":"none"}}})}function Ql(a){var r=document.createElement("iframe");r.style.border="none",hl.call(this,r),this.type="HTMLView",this.name="webview";var h,d,y=this;Object.defineProperties(this,{url:{get:function(){return a},set:function(b){a=void 0!==b?Ql.processURL(b):"",y.element.src=a}},width:{get:function(){return h},set:function(b){y.element.style.width=(h=b)+"px"}},height:{get:function(){return d},set:function(b){y.element.style.height=(d=b)+"px"}}}),this.width=512,this.height=512,this.url=void 0!==a?a:""}function Su(a,r,h){l.HemisphereLight.call(this,a,r,h),this.name="hemisphere"}function as(a,r,h){l.InstancedMesh.call(this,a,r,h),this.name="instanced",this.type="InstancedMesh",this.receiveShadow=!0,this.castShadow=!0,Object.defineProperties(this,{count:{get:function(){return h},set:function(d){d>h&&(this.instanceMatrix=new l.BufferAttribute(new Float32Array(16*d),16)),h=d}}})}(Jc.prototype=Object.create(ur.prototype)).constructor=Jc,Jc.prototype.render=function(a,r,h,d,y){this.needsInit&&(this.reset(),this.luminanceRT.texture.type=h.texture.type,this.previousLuminanceRT.texture.type=h.texture.type,this.currentLuminanceRT.texture.type=h.texture.type,this.needsInit=!1),this._adaptive&&(this.quad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=h.texture,a.setRenderTarget(this.currentLuminanceRT),a.render(this.scene,this.camera),this.quad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=d,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,a.setRenderTarget(this.luminanceRT),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,a.setRenderTarget(this.previousLuminanceRT),a.render(this.scene,this.camera)),this.quad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=h.texture,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},Jc.prototype.createShader=function(){this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:"varying vec2 vUv;\n\t\tvoid main(){\n\t\t\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\n\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\n\t\tuniform sampler2D lastLum;\n\t\tuniform sampler2D currentLum;\n\t\tuniform float minLuminance;\n\t\tuniform float delta;\n\t\tuniform float tau;\n\t\t\n\t\tvoid main()\n\t\t{\n\t\t\tvec4 lastLum = texture2D(lastLum, vUv, MIP_LEVEL_1X1);\n\t\t\tvec4 currentLum = texture2D(currentLum, vUv, MIP_LEVEL_1X1);\n\t\t\t\n\t\t\tfloat fLastLum = max(minLuminance, lastLum.r);\n\t\t\tfloat fCurrentLum = max(minLuminance, currentLum.r);\n\t\t\t\n\t\t\t// The adaption seems to work better in extreme lighting differences if the input luminance is squared.\t\t\tfCurrentLum *= fCurrentLum;\n\t\t\t\n\t\t\t// Adapt the luminance using Pattanaik's technique\t\t\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));\n\t\t\tgl_FragColor.r = fAdaptedLum;\n\t\t}"},this.materialAdaptiveLum=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:this.adaptLuminanceShader.defines,blending:l.NoBlending})},Jc.prototype.reset=function(){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.luminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,ur.RGBALinear),this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,ur.RGBALinear),this.previousLuminanceRT.texture.generateMipmaps=!1,this.currentLuminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,{minFilter:l.LinearMipMapLinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat}),this._adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.quad.material=new l.MeshBasicMaterial({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},Jc.prototype.dispose=function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()},Jc.prototype.toJSON=function(a){var r=ur.prototype.toJSON.call(this,a);return r.minLuminance=this.minLuminance,r.tau=this.tau,r.adaptive=this._adaptive,r},Bo.bufferParameters={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat,stencilBuffer:!1},Bo.prototype.swapBuffers=function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=a},Bo.prototype.addPass=function(a){this.passes.push(a)},Bo.prototype.moveBack=function(a){var r=this.passes.indexOf(a);if(r>0){for(var h=r;h!==r-1;h-=1)this.passes[h]=this.passes[h-1];return this.passes[r-1]=a,!0}return!1},Bo.prototype.moveForward=function(a){var r=this.passes.indexOf(a);if(-1!==r&&r<this.passes.length-1){for(var h=r;h!==r+1;h+=1)this.passes[h]=this.passes[h+1];return this.passes[r+1]=a,!0}return!1},Bo.prototype.removePass=function(a){var r=this.passes.indexOf(a);-1!==r&&this.passes.splice(r,1)},Bo.prototype.insertPass=function(a,r){this.passes.splice(r,0,a)},Bo.prototype.render=function(a,r,h,d){var y=!1;this.rendererState.backup(a);for(var b=0;b<this.passes.length;b++){var N=this.passes[b];if(N.enabled){if(N.render(a,this.writeBuffer,this.readBuffer,d,y,r,h),N.renderToScreen){N.copyToScreen&&(this.copyPass.renderToScreen=!0,this.copyPass.render(a,this.readBuffer,this.writeBuffer,d));break}N.needsSwap&&(y&&(a.context.stencilFunc(a.context.NOTEQUAL,1,4294967295),this.copyPass.renderToScreen=!1,this.copyPass.render(a,this.writeBuffer,this.readBuffer,d),a.context.stencilFunc(a.context.EQUAL,1,4294967295)),this.swapBuffers()),void 0!==Yh&&(N instanceof Yh?y=!0:N instanceof xh&&(y=!1))}}this.rendererState.restore(a)},Bo.prototype.setSize=function(a,r){a=Math.floor(a),r=Math.floor(r),this.width=a,this.height=r,this.writeBuffer.setSize(a,r),this.readBuffer.setSize(a,r);for(var h=0;h<this.passes.length;h++)this.passes[h].setSize(a,r)},Bo.prototype.reset=function(){this.dispose(),this.writeBuffer=new l.WebGLRenderTarget(this.width,this.height,Bo.bufferParameters),this.readBuffer=new l.WebGLRenderTarget(this.width,this.height,Bo.bufferParameters)},Bo.prototype.dispose=function(){this.writeBuffer.dispose(),this.readBuffer.dispose(),this.writeBuffer=null,this.readBuffer=null},Bo.prototype.toJSON=function(){var a={};a.uuid=this.uuid,a.passes=[];for(var r=0;r<this.passes.length;r++)a.passes.push(this.passes[r].toJSON());return a},Bo.fromJSON=function(a){var r=new Bo;r.uuid=a.uuid;for(var h=0;h<a.passes.length;h++){var d=a.passes[h],y=null;if("Render"===d.type)y=new cl;else if("UnrealBloom"===d.type)for((y=new Ls).strength=d.strength,y.radius=d.radius,y.threshold=d.threshold,y.bloomFactors=d.bloomFactors,h=0;h<y.bloomTintColors.length;h++)y.bloomTintColors[h].fromArray(d.bloomTintColors[h]);else"Bloom"===d.type?y=new Dr(d.strength,d.kernelSize,d.sigma,d.resolution):"SSAONOH"===d.type?((y=new Ai).kernelRadius=d.kernelRadius,y.minDistance=d.minDistance,y.maxDistance=d.maxDistance,y.kernelSize=d.kernelSize):"SSAO"===d.type?((y=new ko).onlyAO=d.onlyAO,y.radius=d.radius,y.aoClamp=d.aoClamp,y.lumInfluence=d.lumInfluence):"Bokeh"===d.type?y=new Ha(d.focus,d.aperture,d.maxblur):"FXAA"===d.type?y=new qp:"Copy"===d.type?y=new Yc:"Film"===d.type?((y=new ul).grayscale=d.grayscale,y.noiseIntensity=d.noiseIntensity,y.scanlinesIntensity=d.scanlinesIntensity,y.scanlinesCount=d.scanlinesCount):"DotScreen"===d.type?((y=new Mc).center.fromArray(d.center),y.angle=d.angle,y.scale=d.scale):"Colorify"===d.type?(y=new Cp).color.setHex(d.color):"Sobel"===d.type?y=new Rs:"Technicolor"===d.type?y=new Xc:"HueSaturation"===d.type?((y=new Fo).hue=d.hue,y.saturation=d.saturation):"AdaptiveToneMapping"===d.type?((y=new Jc(d.adaptive)).tau=d.tau,y.minLuminance=d.minLuminance):"Afterimage"===d.type?(y=new ui).damp=d.damp:y=new cl;y.uuid=d.uuid,y.enabled=d.enabled,y.needsSwap=d.needsSwap,y.renderToScreen=d.renderToScreen,y.clear=d.clear,y.copyToScreen=!0===d.copyToScreen,r.addPass(y)}return r},(Wn.prototype=Wn).constructor=Wn,Wn.update=function(){for(var a=0;this.actions.length>a;){var r=this.actions.shift(),h=this.actions.shift();void 0===this.keys[r]&&(this.keys[r]=new li),this.keys[r].update(h),(this.keys[r].justReleased||this.keys[r].justPressed)&&(this.actions.push(r),this.actions.push(li.RESET),a+=2)}},Wn.reset=function(){for(var a=0;a<this.keys.length;a++)void 0!==this.keys[a]&&this.keys[a].reset()},Wn.keyPressed=function(a){return void 0!==this.keys[a]&&this.keys[a].pressed},Wn.keyJustPressed=function(a){return void 0!==this.keys[a]&&this.keys[a].justPressed},Wn.keyJustReleased=function(a){return void 0!==this.keys[a]&&this.keys[a].justReleased},Wn.create=function(){this.events.create()},Wn.dispose=function(){this.events.destroy()},Wn.TAB=9,Wn.ENTER=13,Wn.SHIFT=16,Wn.CTRL=17,Wn.ALT=18,Wn.CAPS_LOCK=20,Wn.ESC=27,Wn.SPACEBAR=32,Wn.PAGE_UP=33,Wn.PAGE_DOWN=34,Wn.END=35,Wn.HOME=36,Wn.INSERT=45,Wn.DEL=46,Wn.LEFT=37,Wn.RIGHT=39,Wn.UP=38,Wn.DOWN=40,Wn.NUM0=48,Wn.NUM1=49,Wn.NUM2=50,Wn.NUM3=51,Wn.NUM4=52,Wn.NUM5=53,Wn.NUM6=54,Wn.NUM7=55,Wn.NUM8=56,Wn.NUM9=57,Wn.A=65,Wn.B=66,Wn.C=67,Wn.D=68,Wn.E=69,Wn.F=70,Wn.G=71,Wn.H=72,Wn.I=73,Wn.J=74,Wn.K=75,Wn.L=76,Wn.M=77,Wn.N=78,Wn.O=79,Wn.P=80,Wn.Q=81,Wn.R=82,Wn.S=83,Wn.T=84,Wn.U=85,Wn.V=86,Wn.W=87,Wn.X=88,Wn.Y=89,Wn.Z=90,Wn.F1=112,Wn.F2=113,Wn.F3=114,Wn.F4=115,Wn.F5=116,Wn.F6=117,Wn.F7=118,Wn.F8=119,Wn.F9=120,Wn.F10=121,Wn.F11=122,Wn.F12=123,Zc.UP=new l.Vector3(0,1,0),(Zc.prototype=Object.create(l.Group.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof ii&&(this.mouse=a.mouse,this.keyboard=a.keyboard);this.updateControls(),l.Group.prototype.initialize.call(this)},Zc.prototype.update=function(a){if(this.needsButtonPressed&&!this.mouse.buttonPressed(Jr.LEFT)||(this.vector.y-=this.sensitivity*this.mouse.delta.y,this.vector.x-=this.sensitivity*this.mouse.delta.x,this.vector.y<-1.57?this.vector.y=-1.57:this.vector.y>1.57&&(this.vector.y=1.57),this.updateControls()),this.movementEnabled){if(this.keyboard.keyPressed(this.moveKeys[0])){var r=this.getWorldDirection(this.tempVector);this.moveOnPlane&&(r.y=0),r.normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r)}this.keyboard.keyPressed(this.moveKeys[1])&&(r=this.getWorldDirection(this.tempVector),this.moveOnPlane&&(r.y=0),r.normalize(),r.multiplyScalar(this.moveSpeed),this.position.add(r)),this.keyboard.keyPressed(this.moveKeys[2])&&((r=new l.Vector3(Math.sin(this.vector.x-1.57),0,Math.cos(this.vector.x-1.57))).normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r)),this.keyboard.keyPressed(this.moveKeys[3])&&((r=new l.Vector3(Math.sin(this.vector.x+1.57),0,Math.cos(this.vector.x+1.57))).normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r))}l.Object3D.prototype.update.call(this,a)},Zc.prototype.updateControls=function(){var a=Math.cos(this.vector.y),r=new l.Vector3(Math.sin(this.vector.x)*a,Math.sin(this.vector.y),Math.cos(this.vector.x)*a);r.add(this.position);var h=new l.Matrix4;h.lookAt(this.position,r,Zc.UP),this.quaternion.setFromRotationMatrix(h)},Zc.prototype.getDirection=function(){var a=this.getWorldDirection(this.tempVector);return a.normalize(),a},Zc.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.moveSpeed=this.moveSpeed,r.object.sensitivity=this.sensitivity,r.object.needsButtonPressed=this.needsButtonPressed,r.object.movementEnabled=this.movementEnabled,r.object.moveOnPlane=this.moveOnPlane,r.object.moveKeys=this.moveKeys,r},(wu.prototype=Object.create(l.Group.prototype)).constructor=wu,(hl.prototype=Object.create(l.Object3D.prototype)).constructor=hl,hl.prototype.isCSS3DObject=!0,(Ql.prototype=Object.create(hl.prototype)).constructor=Ql,Ql.processURL=function(a){return a.replace("watch?v=","embed/")},Ql.prototype.toJSON=function(a){var r=hl.prototype.toJSON.call(this,a);return r.object.height=this.height,r.object.width=this.width,r.object.url=this.url,r},Su.prototype=Object.create(l.HemisphereLight.prototype),(as.prototype=Object.create(l.InstancedMesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},as.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.instanceMatrix=this.instanceMatrix.toJSON(),r.object.count=this.count,r};var Va=function(){l.Mesh.call(this,Va.Geometry,new l.MeshBasicMaterial({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var a=new l.Vector3,r=new l.Vector3,h=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);h.minFilter=l.NearestFilter,h.magFilter=l.NearestFilter,h.wrapS=l.ClampToEdgeWrapping,h.wrapT=l.ClampToEdgeWrapping;var d=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);d.minFilter=l.NearestFilter,d.magFilter=l.NearestFilter,d.wrapS=l.ClampToEdgeWrapping,d.wrapT=l.ClampToEdgeWrapping;var y=Va.Geometry,b=new l.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),N=new l.RawShaderMaterial({uniforms:{map:{value:h},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),k=new l.Mesh(y,b),T=[],H=Eu.Shader,Y=new l.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:d},color:{value:new l.Color(16777215)},scale:{value:new l.Vector2},screenPosition:{value:new l.Vector3}},vertexShader:H.vertexShader,fragmentShader:H.fragmentShader,blending:l.AdditiveBlending,transparent:!0,depthWrite:!1}),le=new l.Mesh(y,Y);this.addElement=function($e){T.push($e)};var ae=new l.Vector2,ge=new l.Vector2,we=new l.Box2,Se=new l.Vector4;this.onBeforeRender=function($e,Re,Pe){$e.getCurrentViewport(Se);var Oe=Se.w/Se.z,Fe=Se.z/2,De=Se.w/2,Qe=16/Se.w;if(ae.set(Qe*Oe,Qe),we.min.set(Se.x,Se.y),we.max.set(Se.x+(Se.z-16),Se.y+(Se.w-16)),r.setFromMatrixPosition(this.matrixWorld),r.applyMatrix4(Pe.matrixWorldInverse),!(r.z>0)&&(a.copy(r).applyMatrix4(Pe.projectionMatrix),ge.x=Se.x+a.x*Fe+Fe-8,ge.y=Se.y+a.y*De+De-8,we.containsPoint(ge))){$e.copyFramebufferToTexture(ge,h),(rn=b.uniforms).scale.value=ae,rn.screenPosition.value=a,$e.renderBufferDirect(Pe,null,y,b,k,null),$e.copyFramebufferToTexture(ge,d),(rn=N.uniforms).scale.value=ae,rn.screenPosition.value=a,$e.renderBufferDirect(Pe,null,y,N,k,null);for(var it=2*-a.x,ct=2*-a.y,_t=0,$t=T.length;_t<$t;_t++){var rn,Dt=T[_t];(rn=Y.uniforms).color.value.copy(Dt.color),rn.map.value=Dt.texture,rn.screenPosition.value.x=a.x+it*Dt.distance,rn.screenPosition.value.y=a.y+ct*Dt.distance,rn.scale.value.set((Qe=Dt.size/Se.w)*(Oe=Se.w/Se.z),Qe),Y.uniformsNeedUpdate=!0,$e.renderBufferDirect(Pe,null,y,Y,le,null)}}},this.dispose=function(){b.dispose(),N.dispose(),Y.dispose(),h.dispose(),d.dispose();for(var $e=0,Re=T.length;$e<Re;$e++)T[$e].texture.dispose()}};Va.prototype=Object.create(l.Mesh.prototype),Va.prototype.constructor=Va,Va.prototype.isLensflare=!0;var a,r,h,Eu=function(a,r,h,d){this.texture=a,this.size=r||1,this.distance=h||0,this.color=d||new l.Color(16777215)};function Ma(){l.Mesh.call(this,Va.Geometry,new l.MeshBasicMaterial({opacity:0,transparent:!0})),this.name="lensflare",this.type="LensFlare",this.renderOrder=1/0,this.frustumCulled=!1,this.receiveShadow=!1,this.castShadow=!1,this.elements=[];var a=new l.Vector3,r=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);r.minFilter=l.NearestFilter,r.magFilter=l.NearestFilter,r.wrapS=l.ClampToEdgeWrapping,r.wrapT=l.ClampToEdgeWrapping,r.needsUpdate=!0;var h=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);h.minFilter=l.NearestFilter,h.magFilter=l.NearestFilter,h.wrapS=l.ClampToEdgeWrapping,h.wrapT=l.ClampToEdgeWrapping,h.needsUpdate=!0;var y,d=Va.Geometry,b=new l.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:"precision highp float;\n\t\t\tuniform vec3 screenPosition;\n\t\t\tuniform vec2 scale;\n\t\t\tattribute vec3 position;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_Position = vec4(position.xy * scale + screenPosition.xy, screenPosition.z, 1.0);\n\t\t\t}",fragmentShader:"precision highp float;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n\t\t\t}",depthTest:!0,depthWrite:!1,transparent:!1}),N=new l.RawShaderMaterial({uniforms:{map:{value:r},scale:{value:null},screenPosition:{value:null}},vertexShader:"precision highp float;\n\t\t\tuniform vec3 screenPosition;\n\t\t\tuniform vec2 scale;\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\t\t\tvarying vec2 vUV;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUV = uv;\n\t\t\t\tgl_Position = vec4(position.xy * scale + screenPosition.xy, screenPosition.z, 1.0);\n\t\t\t}",fragmentShader:"precision highp float;\n\t\t\tuniform sampler2D map;\n\t\t\tvarying vec2 vUV;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = texture2D(map, vUV);\n\t\t\t}",depthTest:!1,depthWrite:!1,transparent:!1}),k=new l.Mesh(d,b),T=(y=Eu.Shader,new l.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:h},color:{value:new l.Color(16777215)},scale:{value:new l.Vector2},screenPosition:{value:new l.Vector3}},vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,blending:l.AdditiveBlending,transparent:!0,depthWrite:!1})),H=new l.Mesh(d,T),Y=new l.Vector2,le=new l.Vector2,ae=new l.Box2,ge=new l.Vector4;this.onBeforeRender=function(we,Se,$e){we.getCurrentViewport(ge);var Re=ge.w/ge.z,Pe=ge.z/2,Oe=ge.w/2,Fe=16/ge.w;if(Y.set(Fe*Re,Fe),ae.min.set(ge.x,ge.y),ae.max.set(ge.x+(ge.z-16),ge.y+(ge.w-16)),a.setFromMatrixPosition(this.matrixWorld),a.applyMatrix4($e.matrixWorldInverse),a.applyMatrix4($e.projectionMatrix),le.x=ge.x+a.x*Pe+Pe-8,le.y=ge.y+a.y*Oe+Oe-8,ae.containsPoint(le)){we.copyFramebufferToTexture(le,r),(_t=b.uniforms).scale.value=Y,_t.screenPosition.value=a,we.renderBufferDirect($e,null,d,b,k,null),we.copyFramebufferToTexture(le,h),(_t=N.uniforms).scale.value=Y,_t.screenPosition.value=a,we.renderBufferDirect($e,null,d,N,k,null);for(var De=2*-a.x,Qe=2*-a.y,it=0,ct=this.elements.length;it<ct;it++){var _t,$t=this.elements[it];(_t=T.uniforms).color.value.copy($t.color),_t.map.value=$t.texture,_t.screenPosition.value.x=a.x+De*$t.distance,_t.screenPosition.value.y=a.y+Qe*$t.distance,_t.scale.value.set((Fe=$t.size/ge.w)*(Re=ge.w/ge.z),Fe),T.uniformsNeedUpdate=!0,we.renderBufferDirect($e,null,d,T,H,null)}}},this.dispose=function(){b.dispose(),N.dispose(),T.dispose(),r.dispose(),h.dispose();for(var we=0;we<this.elements.length;we++)this.elements[we].texture.dispose()}}Eu.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},Va.Geometry=(a=new l.BufferGeometry,r=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),h=new l.InterleavedBuffer(r,5),a.setIndex([0,1,2,0,2,3]),a.setAttribute("position",new l.InterleavedBufferAttribute(h,3,0,!1)),a.setAttribute("uv",new l.InterleavedBufferAttribute(h,2,3,!1)),a),(Ma.prototype=Object.create(l.Mesh.prototype)).addFlare=function(a,r,h,d){void 0===r&&(r=-1),void 0===h&&(h=0),void 0===d&&(d=new l.Color(16777215)),h=Math.min(h,Math.max(0,h)),this.addElement(new Eu(a,r,h,d))},Ma.prototype.addElement=function(a){this.elements.push(a)},Ma.prototype.toJSON=function(a){var r=this,h=[],d=l.Object3D.prototype.toJSON.call(this,a,function(y,b){for(var N=0;N<r.elements.length;N++){var k={};k.texture=r.elements[N].texture.toJSON(y).uuid,k.size=r.elements[N].size,k.distance=r.elements[N].distance,k.color=r.elements[N].color.getHex(),h.push(k)}});return d.object.elements=h,d};var Xp,Lp=function(a,r){switch(r){case l.sRGBEncoding:a.convertSRGBToLinear();break;case l.LinearEncoding:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.")}return a},Qh=__webpack_require__(412);function Qc(a,r){l.LightProbe.call(this,a,r),this.type="LightProbe",this.name="probe"}function eh(a,r){l.Mesh.call(this,a,r),this.name="model",this.receiveShadow=!0,this.castShadow=!0}function Aa(){l.Group.call(this),this.name="orbit",this.type="OrbitControls",this.distance=4,this.maxDistance=20,this.minDistance=2,this.sensitivity=.002,this.zoomSensitivity=.001,this.limitUp=1.57,this.limitDown=-1.57,this.needsButtonPressed=!0,this.zoomEnabled=!0,this.movementEnabled=!0,this.center=new l.Vector3(0,0,0),this.vector=new l.Vector2(Math.PI/2,0),this.smooth=!0,this.friction=.8,this.speed=.3,this.invertNavigation=!1,this.mouse=null,this.keyboard=null,this.speedDistance=0,this.speedCenter=new l.Vector3(0,0,0),this.speedOrientation=new l.Vector2(0,0),this.tempVector=new l.Vector3}function io(a){this.offset=new l.Vector2(0,0),this.size=new l.Vector2(1,1),this.mode=void 0!==a?a:io.RELATIVE,this.anchor=io.TOP_LEFT,this.width=1,this.height=1,this.viewport=new l.Vector4(0,0,1,1)}function ts(a,r,h,d,y){l.OrthographicCamera.call(this,-1,1,1,-1,d,y),this.name="camera",this.size=void 0!==a?a:10,this.aspect=void 0!==r?r:1,this.mode=void 0!==h?h:ts.RESIZE_HORIZONTAL,this.viewport=new io,this.clearColor=!0,this.clearDepth=!0,this.clearStencil=!0,this.order=0,this.updateProjectionMatrix(),this.composer=new Bo;var b=new cl;b.renderToScreen=!0,this.composer.addPass(b)}function Ie(a,r,h,d){this.viewport=new io,l.PerspectiveCamera.call(this,a,r,h,d),this.name="camera",this.clearColor=!0,this.clearDepth=!0,this.clearStencil=!0,this.order=0,this.composer=new Bo;var y=new cl;y.renderToScreen=!0,this.composer.addPass(y)}function Ue(){l.Group.call(this),this.name="physics",this.type="Physics",this.body=new ht,this.body.type=ht.DYNAMIC,this.body.mass=1,this.mode=Ue.LOCAL,this.world=null}function Ge(a,r,h,d){l.PointLight.call(this,a,r,h,d),this.name="point",this.castShadow=!0,this.shadow.camera.near=.1,this.shadow.camera.far=1e3,this.shadow.bias=0}(Qc.prototype=Object.create(l.LightProbe.prototype)).generate=function(){var a=this.getScene();if(null!==a){var r=new OffscreenCanvas(256,256),h=new l.WebGLRenderer({canvas:r,alpha:!0}),d=new TCubeCamera(1,1e3,256,{format:l.RGBAFormat,magFilter:l.LinearFilter,minFilter:l.LinearFilter});d.matrixAutoUpdate=!1,d.matrix.copy(this.matrix),d.matrixWorld.copy(this.matrixWorld),d.renderTarget.texture.encoding=Qh.sRGBEncoding,d.update(h,a);var y=function(b,N){for(var k,T,H,Y=0,le=new l.Vector3,ae=new l.Vector3,ge=new l.Color,we=[0,0,0,0,0,0,0,0,0],Se=new l.SphericalHarmonics3,$e=Se.coefficients,Re=0;Re<6;Re++){var Pe=N.width,Oe=new Uint8Array(Pe*Pe*4);b.readRenderTargetPixels(N,0,0,Pe,Pe,Oe,Re);for(var Fe=2/Pe,De=0,Qe=Oe.length;De<Qe;De+=4){ge.setRGB(Oe[De]/255,Oe[De+1]/255,Oe[De+2]/255),Lp(ge,N.texture.encoding);var it=De/4,ct=(it%Pe+.5)*Fe-1,_t=1-(Math.floor(it/Pe)+.5)*Fe;switch(Re){case 0:le.set(1,_t,-ct);break;case 1:le.set(-1,_t,ct);break;case 2:le.set(ct,1,-_t);break;case 3:le.set(ct,-1,_t);break;case 4:le.set(ct,_t,1);break;case 5:le.set(-ct,_t,-1)}T=le.lengthSq(),Y+=H=4/(Math.sqrt(T)*T),ae.copy(le).normalize(),l.SphericalHarmonics3.getBasisAt(ae,we);for(var $t=0;$t<9;$t++)$e[$t].x+=we[$t]*ge.r*H,$e[$t].y+=we[$t]*ge.g*H,$e[$t].z+=we[$t]*ge.b*H}}for(k=4*Math.PI/Y,$t=0;$t<9;$t++)$e[$t].x*=k,$e[$t].y*=k,$e[$t].z*=k;return new l.LightProbe(Se)}(h,d.renderTarget);this.sh=y.sh}else console.warn("nunuStudio: LightProbe cannot generate, no scene.",this)},Qc.prototype.toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.sh=this.sh.toArray(),r},(eh.prototype=Object.create(l.Mesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},Aa.UP=new l.Vector3(0,1,0),Aa.ZERO=new l.Vector3(0,0,0),(Aa.prototype=Object.create(l.Group.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof ii&&(this.mouse=a.mouse,this.keyboard=a.keyboard);this.center.copy(this.position),this.updateControls(),l.Group.prototype.initialize.call(this)},Aa.prototype.update=function(a){var r=!1;if(this.needsButtonPressed&&!this.mouse.buttonPressed(Jr.LEFT)||(!0===this.smooth?(this.speedOrientation.y+=this.speed*this.sensitivity*(this.invertNavigation?this.mouse.delta.y:-this.mouse.delta.y),this.speedOrientation.x-=this.speed*this.sensitivity*this.mouse.delta.x):(this.vector.y-=this.sensitivity*(this.invertNavigation?this.mouse.delta.y:-this.mouse.delta.y),this.vector.x-=this.sensitivity*this.mouse.delta.x),r=!0),this.zoomEnabled&&(this.mouse.buttonPressed(Jr.MIDDLE)&&(!0===this.smooth?this.speedCenter.y+=this.speed*this.sensitivity*this.mouse.delta.y*this.distance:this.center.y+=this.sensitivity*this.mouse.delta.y*this.distance,r=!0),0!==this.mouse.wheel&&(!0===this.smooth?this.speedDistance+=this.speed*this.mouse.wheel*this.position.distanceTo(this.center)*this.sensitivity:this.distance+=this.mouse.wheel*this.position.distanceTo(this.center)*this.sensitivity,r=!0)),this.movementEnabled&&this.mouse.buttonPressed(Jr.RIGHT)){var h=this.getWorldDirection(this.tempVector);if(h.y=0,h.normalize(),!0===this.smooth){var d=this.speed*this.mouse.delta.y*this.sensitivity*this.distance;this.speedCenter.x+=-h.x*d,this.speedCenter.z+=-h.z*d,h.applyAxisAngle(Aa.UP,Math.PI/2);var y=this.speed*this.mouse.delta.x*this.sensitivity*this.distance;this.speedCenter.x-=h.x*y,this.speedCenter.z-=h.z*y}else this.center.x+=-h.x*(d=this.mouse.delta.y*this.sensitivity*this.distance),this.center.z+=-h.z*d,h.applyAxisAngle(Aa.UP,Math.PI/2),this.center.x-=h.x*(y=this.mouse.delta.x*this.sensitivity*this.distance),this.center.z-=h.z*y;r=!0}if(!0===this.smooth)return this.distance+=this.speedDistance,this.center.add(this.speedCenter),this.vector.add(this.speedOrientation),this.speedDistance*=this.friction,this.speedOrientation.multiplyScalar(this.friction),this.speedCenter.multiplyScalar(this.friction),void this.updateControls();!0===r&&this.updateControls(),l.Object3D.prototype.update.call(this,a)},Aa.prototype.updateControls=function(){this.vector.y<this.limitDown?this.vector.y=this.limitDown:this.vector.y>this.limitUp&&(this.vector.y=this.limitUp),this.distance<this.minDistance?this.distance=this.minDistance:this.distance>this.maxDistance&&(this.distance=this.maxDistance);var a=this.distance*Math.cos(this.vector.y);this.position.set(Math.cos(this.vector.x)*a,this.distance*Math.sin(this.vector.y),Math.sin(this.vector.x)*a),this.position.add(this.center);var r=new l.Matrix4;r.lookAt(this.position,this.center,Aa.UP),this.quaternion.setFromRotationMatrix(r)},Aa.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.distance=this.distance,r.object.maxDistance=this.maxDistance,r.object.minDistance=this.minDistance,r.object.sensitivity=this.sensitivity,r.object.limitUp=this.limitUp,r.object.limitDown=this.limitDown,r.object.needsButtonPressed=this.needsButtonPressed,r.object.zoomEnabled=this.zoomEnabled,r.object.movementEnabled=this.movementEnabled,r.object.smooth=this.smooth,r.object.friction=this.friction,r.object.speed=this.speed,r.object.invertNavigation=this.invertNavigation,r.object.center=this.center.toArray(),r.object.vector=this.vector.toArray(),r},io.RELATIVE=200,io.ABSOLUTE=201,io.TOP_LEFT=301,io.TOP_RIGHT=302,io.BOTTOM_LEFT=303,io.BOTTOM_RIGHT=304,io.prototype.update=function(a){var r,h,d,y,b,N;void 0===a?(d=0,y=0,r=this.width,h=this.height):(d=a.viewport.x,y=a.viewport.y,r=a.viewport.z,h=a.viewport.w),this.mode===io.RELATIVE?(b=new l.Vector2(this.offset.x*r,this.offset.y*h),N=new l.Vector2(this.size.x*r,this.size.y*h)):this.mode===io.ABSOLUTE&&(b=this.offset,N=this.size),this.anchor===io.BOTTOM_LEFT?this.viewport.set(b.x+d,b.y+y,N.x,N.y):this.anchor===io.BOTTOM_RIGHT?this.viewport.set(r-N.x-b.x+d,b.y+y,N.x,N.y):this.anchor===io.TOP_LEFT?this.viewport.set(b.x+d,h-N.y-b.y+y,N.x,N.y):this.anchor===io.TOP_RIGHT&&this.viewport.set(r-N.x-b.x+d,h-N.y-b.y+y,N.x,N.y)},io.prototype.getAspectRatio=function(){return this.viewport.z/this.viewport.w},io.prototype.isInside=function(a,r){return r.position.x>this.viewport.x&&r.position.x<this.viewport.x+this.viewport.z&&r.position.y<this.height-this.viewport.y&&r.position.y>this.height-this.viewport.y-this.viewport.w},io.prototype.getNormalized=(Xp=new l.Vector2,function(a,r){return Xp.set((r.position.x-this.viewport.z-this.viewport.x)/this.viewport.z*2+1,-(r.position.y-(this.height-(this.viewport.y+this.viewport.w)))/this.viewport.w*2+1),Xp}),io.prototype.enable=function(a){a.setViewport(this.viewport),a.setScissor(this.viewport)},io.prototype.toJSON=function(){return{offset:this.offset.toArray(),size:this.size.toArray(),mode:this.mode,anchor:this.anchor}},io.prototype.fromJSON=function(a){this.offset.fromArray(a.offset),this.size.fromArray(a.size),this.mode=a.mode,this.anchor=a.anchor},ts.prototype=Object.create(l.OrthographicCamera.prototype),ts.RESIZE_HORIZONTAL=0,ts.RESIZE_VERTICAL=1,ts.prototype.resize=function(a,r,h){this.viewport.width=a,this.viewport.height=r,this.viewport.update(h),this.aspect=this.viewport.getAspectRatio(),this.updateProjectionMatrix(),this.composer.setSize(this.viewport.viewport.z,this.viewport.viewport.w)},ts.prototype.setupRenderer=function(a){this.viewport.enable(a),a.clear(this.clearColor,this.clearDepth,this.clearStencil)},ts.prototype.render=function(a,r){this.composer.render(a,r,this,.016)},ts.prototype.destroy=function(){var a=this.getScene();null!==a&&a.removeCamera(this),l.Object3D.prototype.destroy.call(this)},ts.prototype.updateProjectionMatrix=function(){this.mode===ts.RESIZE_HORIZONTAL?(this.top=this.size/2,this.bottom=-this.top,this.right=this.top*this.aspect,this.left=-this.right):this.mode===ts.RESIZE_VERTICAL&&(this.right=this.size/2,this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top),l.OrthographicCamera.prototype.updateProjectionMatrix.call(this)},ts.prototype.toJSON=function(a){var r=l.OrthographicCamera.prototype.toJSON.call(this,a);return r.object.size=this.size,r.object.aspect=this.aspect,r.object.mode=this.mode,r.object.clearColor=this.clearColor,r.object.clearDepth=this.clearDepth,r.object.clearStencil=this.clearStencil,r.object.viewport=this.viewport.toJSON(),r.object.order=this.order,r.object.composer=this.composer.toJSON(),r},(Ie.prototype=Object.create(l.PerspectiveCamera.prototype)).resize=function(a,r,h){this.viewport.width=a,this.viewport.height=r,this.viewport.update(h),this.aspect=this.viewport.getAspectRatio(),this.updateProjectionMatrix(),this.composer.setSize(this.viewport.viewport.z,this.viewport.viewport.w)},Ie.prototype.setupRenderer=function(a){this.viewport.enable(a),a.clear(this.clearColor,this.clearDepth,this.clearStencil)},Ie.prototype.render=function(a,r){this.composer.render(a,r,this,.016)},Ie.prototype.destroy=function(){var a=this.getScene();null!==a&&a.removeCamera(this),l.Object3D.prototype.destroy.call(this)},Ie.prototype.updateProjectionMatrix=function(){var a=this.near*Math.tan(.5*l.Math.DEG2RAD*this.fov)/this.zoom,r=2*a,h=this.aspect*r,d=-.5*h;0!==this.filmOffset&&(d+=this.near*this.filmOffset/this.getFilmWidth()),this.projectionMatrix.makePerspective(d,d+h,a,a-r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},Ie.prototype.toJSON=function(a){var r=l.PerspectiveCamera.prototype.toJSON.call(this,a);return r.object.clearColor=this.clearColor,r.object.clearDepth=this.clearDepth,r.object.clearStencil=this.clearStencil,r.object.viewport=this.viewport.toJSON(),r.object.order=this.order,r.object.composer=this.composer.toJSON(),r},Ue.prototype=Object.create(l.Group.prototype),Ue.LOCAL=100,Ue.WORLD=101,Ue.prototype.initialize=function(){if(this.mode===Ue.LOCAL)this.body.position.copy(this.position),this.body.quaternion.copy(this.quaternion);else if(this.mode===Ue.WORLD){var a=new l.Vector3;this.getWorldPosition(a),this.body.position.copy(a);var r=new l.Quaternion;this.getWorldQuaternion(r),this.body.quaternion.copy(r)}for(var h=this;null!==h.parent;)(h=h.parent)instanceof Po&&(this.world=h.world,this.world.addBody(this.body));l.Object3D.prototype.initialize.call(this)},Ue.prototype.update=function(a){if(this.mode===Ue.LOCAL)this.position.copy(this.body.position),this.body.fixedRotation||this.quaternion.copy(this.body.quaternion);else if(this.mode===Ue.WORLD){var r=new l.Matrix4;if(this.body.fixedRotation)r.setPosition(this.body.position.x,this.body.position.y,this.body.position.z);else{var h=new l.Quaternion;h.copy(this.body.quaternion),r.makeRotationFromQuaternion(h),r.setPosition(this.body.position.x,this.body.position.y,this.body.position.z)}var d=new l.Matrix4;d.getInverse(this.parent.matrixWorld);var y=new l.Vector3;d.multiply(r),d.decompose(this.position,this.quaternion,y)}l.Object3D.prototype.update.call(this,a)},Ue.prototype.addShape=function(a){a instanceof he&&this.body.addShape(a)},Ue.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);r.object.mode=this.mode,r.object.body={},r.object.body.type=this.body.type,r.object.body.mass=this.body.mass,r.object.body.linearDamping=this.body.linearDamping,r.object.body.angularDamping=this.body.angularDamping,r.object.body.allowSleep=this.body.allowSleep,r.object.body.sleepSpeedLimit=this.body.sleepSpeedLimit,r.object.body.sleepTimeLimit=this.body.sleepTimeLimit,r.object.body.collisionFilterGroup=this.body.collisionFilterGroup,r.object.body.collisionFilterMask=this.body.collisionFilterMask,r.object.body.fixedRotation=this.body.fixedRotation,r.object.body.shapes=[];for(var h=this.body.shapes,d=0;d<h.length;d++){var y=h[d],b={};b.type=y.type,y.type===he.types.SPHERE?b.radius=y.radius:y.type===he.types.BOX?(b.halfExtents={},b.halfExtents.x=y.halfExtents.x,b.halfExtents.y=y.halfExtents.y,b.halfExtents.z=y.halfExtents.z):y.type===he.types.CONVEXPOLYHEDRON?(b.vertices=y.vertices,b.faces=y.faces):y.type===he.types.HEIGHTFIELD?(b.data=y.data,b.maxValue=y.maxValue,b.minValue=y.minValue,b.elementSize=y.elementSize):y.type===he.types.TRIMESH&&(b.vertices=y.vertices,b.normals=y.normals,b.edges=y.edges,b.indices=y.indices),r.object.body.shapes[d]=b}return r},Ue.fromJSON=function(a){var r=new Ue;void 0!==a.mode&&(r.mode=a.mode),r.body.type=a.body.type,r.body.mass=a.body.mass,r.body.linearDamping=a.body.linearDamping,r.body.angularDamping=a.body.angularDamping,r.body.allowSleep=a.body.allowSleep,r.body.sleepSpeedLimit=a.body.sleepSpeedLimit,r.body.sleepTimeLimit=a.body.sleepTimeLimit,r.body.collisionFilterGroup=a.body.collisionFilterGroup,r.body.collisionFilterMask=a.body.collisionFilterMask,r.body.fixedRotation=a.body.fixedRotation;for(var h=a.body.shapes,d=0;d<h.length;d++){var y=h[d];if(y.type===he.types.SPHERE)r.body.addShape(new mc(y.radius));else if(y.type===he.types.BOX)r.body.addShape(new je(new M(y.halfExtents.x,y.halfExtents.y,y.halfExtents.z)));else if(y.type===he.types.PARTICLE)r.body.addShape(new dn);else if(y.type===he.types.PLANE)r.body.addShape(new kn);else if(y.type===he.types.HEIGHTFIELD)r.body.addShape(new wn(y.data,{maxValue:y.maxValue,minValue:y.minValue,elementSize:y.elementSize}));else if(y.type===he.types.CONVEXPOLYHEDRON){for(var b=0;b<y.vertices.length;b++)y.vertices[b]=new M(y.vertices[b].x,y.vertices[b].y,y.vertices[b].z);r.body.addShape(new K(y.vertices,y.faces))}}return r},(Ge.prototype=Object.create(l.PointLight.prototype)).updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()};var xe=__webpack_require__(759),ze=function(a){l.Loader.call(this,a),this.reversed=!1};function Xe(a){xi.call(this,"font","Font"),this.reversed=!1,this.font=null,void 0!==a&&(a instanceof ArrayBuffer?(this.data=a,this.format="arraybuffer",this.loadTTF()):"object"==typeof a?(this.data=a,this.font=a,this.format="json",this.encoding="json"):(this.encoding=Bn.getFileExtension(a),this.name=Bn.getFileName(a),"json"===this.encoding?(this.data=JSON.parse(Bn.readFile(a)),this.format="json",this.font=this.data):"ttf"!==this.encoding&&"otf"!==this.encoding&&"ttc"!==this.encoding&&"otc"!==this.encoding||(this.data=Bn.readFileArrayBuffer(a),this.format="arraybuffer",this.loadTTF())))}function yt(){xi.call(this,"model","Model")}function Nt(a,r){xi.call(this,"audio","Audio"),void 0!==a&&(a instanceof ArrayBuffer?(this.data=a,this.encoding=void 0!==r?r:"",this.format="arraybuffer"):ci.isBase64(a)?(this.encoding=void 0!==r?r:"",this.data=pa.fromBase64(a),this.format="arraybuffer"):(this.data=Bn.readFileArrayBuffer(a),this.encoding=Bn.getFileExtension(a),this.format="arraybuffer"))}function qt(a){ri.call(this,a),this.type="PositionalAudio",this.matrixAutoUpdate=!0,this.distanceModel="inverse",this.panningModel="HRTF",this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.panner.panningModel=this.panningModel,this.panner.distanceModel=this.distanceModel,this.panner.refDistance=1,this.panner.maxDistance=1e4,this.panner.rolloffFactor=1,this.panner.coneInnerAngle=360,this.panner.coneOuterAngle=0,this.panner.coneOuterGain=0,this.scene=null,this.tempPosition=new l.Vector3,this.tempPositionCamera=new l.Vector3,this.tempQuaternionCamera=new l.Quaternion}function Pn(a,r,h,d){l.RectAreaLight.call(this,a,r,h,d),this.name="rectarea"}function En(a,r){l.Group.call(this),this.type="Script",this.name="script",this.code=void 0!==a?a:En.DEFAULT,this.mode=void 0!==r?r:En.APPEND,this.script={},this.program=null,this.scene=null}function Gn(a,r){l.SkinnedMesh.call(this,a,r),this.name="skinned",this.receiveShadow=!0,this.castShadow=!0,this.skeleton=null}ze.prototype=Object.assign(Object.create(l.Loader.prototype),{constructor:ze,load:function(a,r,h,d){var y=this,b=new l.FileLoader(this.manager);b.setPath(this.path),b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.load(a,function(N){try{r(y.parse(N))}catch(k){d?d(k):console.error(k),y.manager.itemError(a)}},h,d)},parse:function(a){function r(h){var d,y=[];h.forEach(function(N){"m"===N.type.toLowerCase()?y.push(d=[N]):"z"!==N.type.toLowerCase()&&d.push(N)});var b=[];return y.forEach(function(N){var k={type:"m",x:N[N.length-1].x,y:N[N.length-1].y};b.push(k);for(var T=N.length-1;T>0;T--){var H=N[T];k={type:H.type},void 0!==H.x2&&void 0!==H.y2?(k.x1=H.x2,k.y1=H.y2,k.x2=H.x1,k.y2=H.y1):void 0!==H.x1&&void 0!==H.y1&&(k.x1=H.x1,k.y1=H.y1),k.x=N[T-1].x,k.y=N[T-1].y,b.push(k)}}),b}return void 0===xe.U?(console.warn("THREE.TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(h,d){for(var y=Math.round,b={},N=1e5/(72*(h.unitsPerEm||2048)),k=h.encoding.cmap.glyphIndexMap,T=Object.keys(k),H=0;H<T.length;H++){var Y=T[H],le=h.glyphs.glyphs[k[Y]];if(void 0!==Y){var ae={ha:y(le.advanceWidth*N),x_min:y(le.xMin*N),x_max:y(le.xMax*N),o:""};d&&(le.path.commands=r(le.path.commands)),le.path.commands.forEach(function(ge){"c"===ge.type.toLowerCase()&&(ge.type="b"),ae.o+=ge.type.toLowerCase()+" ",void 0!==ge.x&&void 0!==ge.y&&(ae.o+=y(ge.x*N)+" "+y(ge.y*N)+" "),void 0!==ge.x1&&void 0!==ge.y1&&(ae.o+=y(ge.x1*N)+" "+y(ge.y1*N)+" "),void 0!==ge.x2&&void 0!==ge.y2&&(ae.o+=y(ge.x2*N)+" "+y(ge.y2*N)+" ")}),b[String.fromCodePoint(le.unicode)]=ae}}return{glyphs:b,familyName:h.getEnglishName("fullName"),ascender:y(h.ascender*N),descender:y(h.descender*N),underlinePosition:h.tables.post.underlinePosition,underlineThickness:h.tables.post.underlineThickness,boundingBox:{xMin:h.tables.head.xMin,xMax:h.tables.head.xMax,yMin:h.tables.head.yMin,yMax:h.tables.head.yMax},resolution:1e3,original_font_information:h.tables.name}}(xe.U.parse(a),this.reversed)}}),Xe.prototype=Object.create(xi.prototype),Xe.fileIsFont=function(a){return void 0!==a&&((a=a.name.toLocaleLowerCase()).endsWith("ttf")||a.endsWith("otf")||a.endsWith("ttc")||a.endsWith("otc")||a.endsWith("json"))},Xe.prototype.isFont=!0,Xe.prototype.reverseGlyphs=function(){this.reversed=!this.reversed,this.loadTTF()},Xe.prototype.loadTTF=function(){var a=new ze;a.reversed=this.reversed,this.font=a.parse(this.data)},Xe.prototype.toJSON=function(a){if(void 0!==a.fonts[this.uuid])return a.fonts[this.uuid];var r=xi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.reversed=this.reversed,"arraybuffer"===this.format?(r.data=this.data,r.format=this.format):"base64"===this.format?(r.data=pa.fromBase64(this.data),r.format="arraybuffer"):(r.data=this.data,r.format=this.format),a.fonts[this.uuid]=r,r},Xe.prototype.generateShapes=function(a,r,h){void 0===r&&(r=100),void 0===h&&(h=10);for(var d=this.font,y=function(T){for(var H=String(T).split(""),Y=r/d.resolution,le=(d.boundingBox.yMax-d.boundingBox.yMin)*Y,ae=0,ge=0,we=[],Se=0;Se<H.length;Se++){var $e=H[Se];if("\n"===$e)ge-=le,ae=0;else{var Re=k($e,Y,ae,ge);ae+=Re.width,we.push(Re.path)}}return we}(a),b=[],N=0;N<y.length;N++)Array.prototype.push.apply(b,y[N].toShapes());return b;function k(T,H,Y,le){var ae=d.glyphs[T]||d.glyphs["?"];if(ae){var ge,we,Se,$e,Re,Pe,Oe,Fe,De,Qe,it,ct=new l.ShapePath,_t=[],$t=l.ShapeUtils.b2,rn=l.ShapeUtils.b3;if(ae.o)for(var Dt=ae._cachedOutline||(ae._cachedOutline=ae.o.split(" ")),Lt=0,Ct=Dt.length;Lt<Ct;){var ut=Dt[Lt++];if("m"===ut&&(ge=Dt[Lt++]*H+Y,we=Dt[Lt++]*H+le,ct.moveTo(ge,we)),"l"===ut)ge=Dt[Lt++]*H+Y,we=Dt[Lt++]*H+le,ct.lineTo(ge,we);else if("q"===ut){if(Se=Dt[Lt++]*H+Y,$e=Dt[Lt++]*H+le,Oe=Dt[Lt++]*H+Y,Fe=Dt[Lt++]*H+le,ct.quadraticCurveTo(Oe,Fe,Se,$e),it=_t[_t.length-1]){Re=it.x,Pe=it.y;for(var Tt=1;Tt<=h;Tt++)$t(Qt=Tt/h,Re,Oe,Se),$t(Qt,Pe,Fe,$e)}}else if("b"===ut&&(Se=Dt[Lt++]*H+Y,$e=Dt[Lt++]*H+le,Oe=Dt[Lt++]*H+Y,Fe=Dt[Lt++]*H+le,De=Dt[Lt++]*H+Y,Qe=Dt[Lt++]*H+le,ct.bezierCurveTo(Oe,Fe,De,Qe,Se,$e),it=_t[_t.length-1]))for(Re=it.x,Pe=it.y,Tt=1;Tt<=h;Tt++){var Qt;rn(Qt=Tt/h,Re,Oe,De,Se),rn(Qt,Pe,Fe,Qe,$e)}}return{width:ae.ha*H,path:ct}}}},yt.prototype=Object.create(xi.prototype),yt.extensions=["gcode","drc","assimp","assimp.json","blend","amf","babylon","prwm","svg","obj","3ds","dae","gltf","glb","3mf","awd","ply","vtk","vtp","wrl","vrml","fbx","pcd","stl","json","x"],yt.fileIsModel=function(a){if(void 0!==a){a=a.name.toLocaleLowerCase();for(var r=0;r<yt.extensions.length;r++)if(a.endsWith(yt.extensions[r]))return!0}return!1},Nt.prototype=Object.create(xi.prototype),Nt.fileIsAudio=function(a){return!(void 0===a||!a.type.startsWith("audio"))},Nt.prototype.getAudioBuffer=function(a,r){a.decodeAudioData(this.data.slice(0),r,function(h){console.error("nunuStudio: Cannot decode audio buffer ("+h+")")})},Nt.prototype.toJSON=function(a){if(void 0!==a.audio[this.uuid])return a.audio[this.uuid];var r=xi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.data=this.data,r.format=this.format,a.audio[this.uuid]=r,r},(qt.prototype=Object.create(ri.prototype)).initialize=function(){ri.prototype.initialize.call(this);for(var a=this.parent;null!==a;){if(a instanceof Po){this.scene=a;break}a=a.parent}},qt.prototype.update=function(a){if(this.scene.cameras.length>0){var r=this.scene.cameras[0];this.getWorldPosition(this.tempPosition),r.getWorldPosition(this.tempPositionCamera),r.getWorldQuaternion(this.tempQuaternionCamera),this.tempPosition.sub(this.tempPositionCamera),this.tempPosition.z=-this.tempPosition.z,this.tempPosition.applyQuaternion(this.tempQuaternionCamera),this.panner.setPosition(this.tempPosition.x,this.tempPosition.z,this.tempPosition.y)}else this.panner.setPosition(0,0,0),this.panner.setOrientation(0,0,0);l.Object3D.prototype.update.call(this,a)},qt.prototype.getOutput=function(){return this.panner},qt.prototype.getRefDistance=function(){return this.panner.refDistance},qt.prototype.setRefDistance=function(a){this.panner.refDistance=a},qt.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},qt.prototype.setRolloffFactor=function(a){this.panner.rolloffFactor=a},qt.prototype.getDistanceModel=function(){return this.panner.distanceModel},qt.prototype.setDistanceModel=function(a){this.panner.distanceModel=a},qt.prototype.getMaxDistance=function(){return this.panner.maxDistance},qt.prototype.setMaxDistance=function(a){this.panner.maxDistance=a},qt.prototype.toJSON=function(a){var r=ri.prototype.toJSON.call(this,a);return r.object.distanceModel=this.distanceModel,r.object.panningModel=this.panningModel,r},(Pn.prototype=Object.create(l.RectAreaLight.prototype)).toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.width=this.width,r.object.height=this.height,r},En.prototype=Object.create(l.Group.prototype),En.includeRegex=/include[ ]*\([ \n]*["'].+?["'][ \n]*\);*/gi,En.includeRegexStart=/include[ ]*\([ \n]*["']/gi,En.includeRegexEnd=/["'][ \n]*\);*/gi,En.DEFAULT="function initialize() {\n\t// TODO ADD CODE\n}\n\nfunction update(delta) {\n\t// TODO ADD CODE\n}",En.METHODS=["initialize","update","dispose","onMouseOver","onResize","onAppData"],En.APPEND=100,En.EVALUATE=101,En.INCLUDE=102,En.getIncludes=function(a){for(var r=[],h=new RegExp(En.includeRegex,"gi");;){var d=h.exec(a);if(null===d)break;var y=d[0];y=(y=y.replace(En.includeRegexStart,"")).replace(En.includeRegexEnd,""),r.push(y)}return r},En.removeComments=function(a){return a.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")},En.removeIncludes=function(a){return a.replace(En.includeRegex,"")},En.prototype.initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Po?this.scene=a:a instanceof ii&&(this.program=a);l.Object3D.prototype.initialize.call(this);var r=this;this.compileCode(this.code,function(){void 0!==r.script.initialize&&r.script.initialize.call(r)})},En.prototype.update=function(a){if(void 0!==this.script.onMouseOver){var r=this.scene.raycaster.intersectObjects(this.children,!0);r.length>0&&this.script.onMouseOver.call(this,r)}void 0!==this.script.update&&this.script.update.call(this,a),l.Object3D.prototype.update.call(this,a)},En.prototype.dispose=function(){void 0!==this.script.dispose&&this.script.dispose.call(this),l.Object3D.prototype.dispose.call(this)},En.prototype.resize=function(a,r){void 0!==this.script.onResize&&this.script.onResize.call(this,a,r)},En.prototype.appData=function(a){void 0!==this.script.onAppData&&this.script.onAppData.call(this,a)},En.prototype.compileCode=function(a,r){try{a=this.code;for(var h=0;h<En.METHODS.length;h++){var d=En.METHODS[h];a+="\nif(this."+d+" == undefined && typeof "+d+" !== 'undefined'){this."+d+" = "+d+";}"}if(this.mode===En.APPEND){a=En.removeComments(a);var y=En.getIncludes(a);for(a=En.removeIncludes(a),h=0;h<y.length;h++){var b=this.program.getResourceByName(y[h]);if(null===b){if(null===(b=Bn.readFile(y[h],!0)))throw new Error("Script include() library "+y[h]+" not found.");a=b+"\n"+a}else a=b.data+"\n"+a}a+='\nfunction include(name)\t\t\t{\t\t\t\tconsole.warn("nunuStudio: Script running in append mode, " + name + " cannot be included in runtime.");\t\t\t}'}else if(this.mode===En.EVALUATE)a+='\nfunction include(name)\t\t\t{\t\t\t\tvar text = program.getResourceByName(name);\t\t\t\tif(text === null)\t\t\t\t{\t\t\t\t\ttext = FileSystem.readFile(name, true);\t\t\t\t\tif(text !== null)\t\t\t\t\t{\t\t\t\t\t\tnew Function(text).call(this);\t\t\t\t\t}\t\t\t\t\telse\t\t\t\t\t{\t\t\t\t\t\tconsole.warn("nunuStudio: Javascript file " + name + " not found.");\t\t\t\t\t}\t\t\t\t}\t\t\t\telse\t\t\t\t{\t\t\t\t\tnew Function(text.data).call(this);\t\t\t\t}\t\t\t}';else if(this.mode===En.INCLUDE){y=En.getIncludes(a),a=En.removeIncludes(a);var N=0,k=[];for(h=0;h<y.length;h++){var T=this.program.getResourceByName(y[h]);if(null!==T){var H=new Blob([T.data],{type:"text/plain"});k.push(URL.createObjectURL(H))}else{var Y=Bn.readFile(y[h],!0);if(null===Y)throw new Error("Script include() library "+y[h]+" not found.");H=new Blob([Y],{type:"text/plain"}),k.push(URL.createObjectURL(H))}}if(k.length>0)for(h=0;h<k.length;h++){var le=document.createElement("script");le.type="text/javascript",le.async=!0,le.src=url,le.onload=function(){++N===k.length&&void 0!==r&&r()},le.onerror=le.onload,document.body.appendChild(le)}else void 0!==r&&r()}var ae=new Function("__context__","for(var p in __context__){eval('var ' + p + ' = __context__[p];');}"+a);try{var ge=this.createContextObject();this.script=new ae(ge)}catch(we){throw this.script={},console.warn("nunuStudio: Error initializing script code",we),new Error("Error initializing script code")}this.mode!==En.INCLUDE&&r()}catch(we){throw this.script={},console.warn("nunuStudio: Error compiling script code",we),new Error("Error compiling script code")}},En.prototype.createContextObject=function(){var a={};Object.assign(a,n),Object.assign(a,l),Object.assign(a,o);var r={};for(var h of["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atan2","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc"])r[h]=window.Math[h];return Object.assign(r,l.Math),Object.assign(a,{self:this,program:this.program,scene:this.scene,THREE:l,CANNON:n,Math:r,Keyboard:this.program.keyboard,Mouse:this.program.mouse}),a},En.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.code=this.code,r.object.mode=this.mode,r},(Gn.prototype=Object.create(l.SkinnedMesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},Gn.prototype.toJSON=function(a){var r=this,h=l.Object3D.prototype.toJSON.call(this,a,function(d,y){null!==r.skeleton&&(void 0===d.skeletons[r.skeleton.uuid]&&(d.skeletons[r.skeleton.uuid]=r.skeleton.toJSON(d)),y.skeleton=r.skeleton.uuid)});return void 0!==this.bindMode&&(h.object.bindMode=this.bindMode),void 0!==this.bindMatrix&&(h.object.bindMatrix=this.bindMatrix.toArray()),h};const Ar="uniform vec3 topColor;\r\nuniform vec3 bottomColor;\r\nuniform float offset;\r\nuniform float exponent;\r\nvarying vec3 vWorldPosition;\r\n\r\nvoid main()\r\n{\r\n\tfloat h = normalize(vWorldPosition + offset).y;\r\n\tgl_FragColor = vec4(mix(bottomColor, topColor, max(pow(max(h , 0.0), exponent), 0.0)), 1.0);\r\n}\r\n",Ur="varying vec3 vWorldPosition;\r\n\r\nvoid main()\r\n{\r\n\tvec4 worldPosition = modelMatrix * vec4(position, 1.0);\r\n\tvWorldPosition = worldPosition.xyz;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n}";function $r(a,r,h,d){l.Group.call(this),this.name="sky",this.type="Sky",this.colorTop=[new l.Color(7844859),new l.Color(30463),new l.Color(220086),new l.Color(9273)],this.colorBottom=[new l.Color(15461606),new l.Color(16777215),new l.Color(16705495),new l.Color(26023)],this.sunColor=16777130,this.intensity=.3,this.moonColor=5592507,this.hemisphere=new l.HemisphereLight(3310847,16764031,.5),this.hemisphere.name="hemisphere",this.hemisphere.locked=!0,this.hemisphere.matrixAutoUpdate=!1,this.add(this.hemisphere),this.sun=new ll(this.sunColor,this.intensity),this.sun.castShadow=!0,this.sun.locked=!0,this.add(this.sun);var y={topColor:{type:"c",value:new l.Color(0,.46,1)},bottomColor:{type:"c",value:new l.Color(1,1,1)},offset:{type:"f",value:20},exponent:{type:"f",value:.2}};y.topColor.value.copy(this.hemisphere.color);var b=new l.SphereBufferGeometry(1500,16,16),N=new l.ShaderMaterial({vertexShader:Ur,fragmentShader:Ar,uniforms:y,side:l.BackSide});this.sky=new l.Mesh(b,N),this.sky.locked=!0,this.sky.matrixAutoUpdate=!1,this.sky.name="sky",this.add(this.sky),this.sky.raycast=function(){return null},this.autoUpdate=void 0===a||a,this.sunDistance=void 0!==h?h:100,this.dayTime=void 0!==r?r:120,this.time=void 0!==d?d:75,this.updateSky()}($r.prototype=Object.create(l.Group.prototype)).initialize=function(){this.updateSky(),l.Object3D.prototype.initialize.call(this)},$r.prototype.update=function(a){this.autoUpdate&&(this.time+=a,this.time>this.dayTime&&(this.time-=this.dayTime),this.updateSky()),l.Object3D.prototype.update.call(this,a)},$r.prototype.updateSky=function(){var a=this.time/this.dayTime;if(a<.25)this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[3].r,this.colorTop[3].g,this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[3].r,this.colorBottom[3].g,this.colorBottom[3].b);else if(a<.292){var r=1-(h=23.81*(a-.25));this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[3].r+h*this.colorTop[0].r,r*this.colorTop[3].g+h*this.colorTop[0].g,r*this.colorTop[3].b+h*this.colorTop[0].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[3].r+h*this.colorBottom[0].r,r*this.colorBottom[3].g+h*this.colorBottom[0].g,r*this.colorBottom[3].b+h*this.colorBottom[0].b)}else a<.4167?(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[0].r,this.colorTop[0].g,this.colorTop[0].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[0].r,this.colorBottom[0].g,this.colorBottom[0].b)):a<.5?(r=1-(h=12*(a-.4167)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[0].r+h*this.colorTop[1].r,r*this.colorTop[0].g+h*this.colorTop[1].g,r*this.colorTop[0].b+h*this.colorTop[1].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[0].r+h*this.colorBottom[1].r,r*this.colorBottom[0].g+h*this.colorBottom[1].g,r*this.colorBottom[0].b+h*this.colorBottom[1].b)):a<.708?(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[1].r,this.colorTop[1].g,this.colorTop[1].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[1].r,this.colorBottom[1].g,this.colorBottom[1].b)):a<.75?(r=1-(h=23.81*(a-.708)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[1].r+h*this.colorTop[2].r,r*this.colorTop[1].g+h*this.colorTop[2].g,r*this.colorTop[1].b+h*this.colorTop[2].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[1].r+h*this.colorBottom[2].r,r*this.colorBottom[1].g+h*this.colorBottom[2].g,r*this.colorBottom[1].b+h*this.colorBottom[2].b)):a<.8333?(r=1-(h=12.048*(a-.75)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[2].r+h*this.colorTop[3].r,r*this.colorTop[2].g+h*this.colorTop[3].g,r*this.colorTop[2].b+h*this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[2].r+h*this.colorBottom[3].r,r*this.colorBottom[2].g+h*this.colorBottom[3].g,r*this.colorBottom[2].b+h*this.colorBottom[3].b)):(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[3].r,this.colorTop[3].g,this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[3].r,this.colorBottom[3].g,this.colorBottom[3].b));if(a<.2)this.sun.intensity=this.intensity,this.sun.color.setHex(this.moonColor);else if(a<.3)r=1-(h=10*(a-.2)),h<.5?(this.sun.intensity=(r=2-2*h)*this.intensity,this.sun.color.setHex(this.moonColor)):(this.sun.intensity=(h*=2)*this.intensity,this.sun.color.setHex(this.sunColor));else if(a<.7)this.sun.intensity=this.intensity,this.sun.color.setHex(this.sunColor);else if(a<.8){var h;(h=10*(a-.7))<.5?(this.sun.intensity=(r=2-2*h)*this.intensity,this.sun.color.setHex(this.sunColor)):(this.sun.intensity=(h*=2)*this.intensity,this.sun.color.setHex(this.moonColor))}else this.sun.intensity=this.intensity,this.sun.color.setHex(this.moonColor);var d=qc.PI2*a-qc.PID2;a>.25&&a<.75?(this.sun.position.x=this.sunDistance*Math.cos(d),this.sun.position.y=this.sunDistance*Math.sin(d)):(this.sun.position.x=this.sunDistance*Math.cos(d+Math.PI),this.sun.position.y=this.sunDistance*Math.sin(d+Math.PI))},$r.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);r.object.colorTop=[];for(var h=0;h<this.colorTop.length;h++)r.object.colorTop.push(this.colorTop[h].toJSON());for(r.object.colorBottom=[],h=0;h<this.colorBottom.length;h++)r.object.colorBottom.push(this.colorBottom[h].toJSON());return r.object.sunColor=this.sunColor,r.object.moonColor=this.moonColor,r.object.intensity=this.intensity,r.object.autoUpdate=this.autoUpdate,r.object.sunDistance=this.sunDistance,r.object.dayTime=this.dayTime,r.object.time=this.time,r.object.sun={},r.object.sun.castShadow=this.sun.castShadow,r.object.sun.shadow=this.sun.shadow.toJSON(),r};var Zt,No,$c,pl=__webpack_require__(175);if(pl){let a=window.require;window.require=r=>a?a(r):"three"===r?pl:void 0}class da{constructor(){this.entries={},this.size=0}add(r){let h=this.entries[r];return this.entries[r]=!0,!h&&(this.size++,!0)}addAll(r){let h=this.size;for(var d=0,y=r.length;d<y;d++)this.add(r[d]);return h!=this.size}contains(r){return this.entries[r]}clear(){this.entries={},this.size=0}}class Kr{constructor(r=0,h=0,d=0,y=0){this.r=r,this.g=h,this.b=d,this.a=y}set(r,h,d,y){return this.r=r,this.g=h,this.b=d,this.a=y,this.clamp()}setFromColor(r){return this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this}setFromString(r){return r="#"==r.charAt(0)?r.substr(1):r,this.r=parseInt(r.substr(0,2),16)/255,this.g=parseInt(r.substr(2,2),16)/255,this.b=parseInt(r.substr(4,2),16)/255,this.a=8!=r.length?1:parseInt(r.substr(6,2),16)/255,this}add(r,h,d,y){return this.r+=r,this.g+=h,this.b+=d,this.a+=y,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(r,h){r.r=((4278190080&h)>>>24)/255,r.g=((16711680&h)>>>16)/255,r.b=((65280&h)>>>8)/255,r.a=(255&h)/255}static rgb888ToColor(r,h){r.r=((16711680&h)>>>16)/255,r.g=((65280&h)>>>8)/255,r.b=(255&h)/255}static fromString(r){return(new Kr).setFromString(r)}}Kr.WHITE=new Kr(1,1,1,1),Kr.RED=new Kr(1,0,0,1),Kr.GREEN=new Kr(0,1,0,1),Kr.BLUE=new Kr(0,0,1,1),Kr.MAGENTA=new Kr(1,0,1,1);class Ln{static clamp(r,h,d){return r<h?h:r>d?d:r}static cosDeg(r){return Math.cos(r*Ln.degRad)}static sinDeg(r){return Math.sin(r*Ln.degRad)}static signum(r){return r>0?1:r<0?-1:0}static toInt(r){return r>0?Math.floor(r):Math.ceil(r)}static cbrt(r){let h=Math.pow(Math.abs(r),.3333333333333333);return r<0?-h:h}static randomTriangular(r,h){return Ln.randomTriangularWith(r,h,.5*(r+h))}static randomTriangularWith(r,h,d){let y=Math.random(),b=h-r;return y<=(d-r)/b?r+Math.sqrt(y*b*(d-r)):h-Math.sqrt((1-y)*b*(h-d))}static isPowerOfTwo(r){return r&&!(r&r-1)}}Ln.PI=3.1415927,Ln.PI2=2*Ln.PI,Ln.radiansToDegrees=180/Ln.PI,Ln.radDeg=Ln.radiansToDegrees,Ln.degreesToRadians=Ln.PI/180,Ln.degRad=Ln.degreesToRadians;class sf{apply(r,h,d){return r+(h-r)*this.applyInternal(d)}}class Xf extends sf{constructor(r){super(),this.power=2,this.power=r}applyInternal(r){return r<=.5?Math.pow(2*r,this.power)/2:Math.pow(2*(r-1),this.power)/(this.power%2==0?-2:2)+1}}class dr{static arrayCopy(r,h,d,y,b){for(let N=h,k=y;N<h+b;N++,k++)d[k]=r[N]}static arrayFill(r,h,d,y){for(let b=h;b<d;b++)r[b]=y}static setArraySize(r,h,d=0){let y=r.length;if(y==h)return r;if(r.length=h,y<h)for(let b=y;b<h;b++)r[b]=d;return r}static ensureArrayCapacity(r,h,d=0){return r.length>=h?r:dr.setArraySize(r,h,d)}static newArray(r,h){let d=new Array(r);for(let y=0;y<r;y++)d[y]=h;return d}static newFloatArray(r){if(dr.SUPPORTS_TYPED_ARRAYS)return new Float32Array(r);{let h=new Array(r);for(let d=0;d<h.length;d++)h[d]=0;return h}}static newShortArray(r){if(dr.SUPPORTS_TYPED_ARRAYS)return new Int16Array(r);{let h=new Array(r);for(let d=0;d<h.length;d++)h[d]=0;return h}}static toFloatArray(r){return dr.SUPPORTS_TYPED_ARRAYS?new Float32Array(r):r}static toSinglePrecision(r){return dr.SUPPORTS_TYPED_ARRAYS?Math.fround(r):r}static webkit602BugfixHelper(r,h){}static contains(r,h,d=!0){for(var y=0;y<r.length;y++)if(r[y]==h)return!0;return!1}static enumValue(r,h){return r[h[0].toUpperCase()+h.slice(1)]}}dr.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u";class af{constructor(r){this.items=new Array,this.instantiator=r}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(r){r.reset&&r.reset(),this.items.push(r)}freeAll(r){for(let h=0;h<r.length;h++)this.free(r[h])}clear(){this.items.length=0}}class lf{constructor(r=0,h=0){this.x=r,this.y=h}set(r,h){return this.x=r,this.y=h,this}length(){let r=this.x,h=this.y;return Math.sqrt(r*r+h*h)}normalize(){let r=this.length();return 0!=r&&(this.x/=r,this.y/=r),this}}class Sf{constructor(r){if(!r)throw new Error("name cannot be null.");this.name=r}}class Tu extends Sf{constructor(r){super(r),this.id=Tu.nextID++,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVertices(r,h,d,y,b,N){d=b+(d>>1)*N;let k=r.bone.skeleton,T=r.deform,H=this.vertices,Y=this.bones;if(!Y){T.length>0&&(H=T);let we=r.bone,Se=we.worldX,$e=we.worldY,Re=we.a,Pe=we.b,Oe=we.c,Fe=we.d;for(let De=h,Qe=b;Qe<d;De+=2,Qe+=N){let it=H[De],ct=H[De+1];y[Qe]=it*Re+ct*Pe+Se,y[Qe+1]=it*Oe+ct*Fe+$e}return}let le=0,ae=0;for(let we=0;we<h;we+=2){let Se=Y[le];le+=Se+1,ae+=Se}let ge=k.bones;if(0==T.length)for(let we=b,Se=3*ae;we<d;we+=N){let $e=0,Re=0,Pe=Y[le++];for(Pe+=le;le<Pe;le++,Se+=3){let Oe=ge[Y[le]],Fe=H[Se],De=H[Se+1],Qe=H[Se+2];$e+=(Fe*Oe.a+De*Oe.b+Oe.worldX)*Qe,Re+=(Fe*Oe.c+De*Oe.d+Oe.worldY)*Qe}y[we]=$e,y[we+1]=Re}else{let we=T;for(let Se=b,$e=3*ae,Re=ae<<1;Se<d;Se+=N){let Pe=0,Oe=0,Fe=Y[le++];for(Fe+=le;le<Fe;le++,$e+=3,Re+=2){let De=ge[Y[le]],Qe=H[$e]+we[Re],it=H[$e+1]+we[Re+1],ct=H[$e+2];Pe+=(Qe*De.a+it*De.b+De.worldX)*ct,Oe+=(Qe*De.c+it*De.d+De.worldY)*ct}y[Se]=Pe,y[Se+1]=Oe}}}copyTo(r){this.bones?(r.bones=new Array(this.bones.length),dr.arrayCopy(this.bones,0,r.bones,0,this.bones.length)):r.bones=null,this.vertices?(r.vertices=dr.newFloatArray(this.vertices.length),dr.arrayCopy(this.vertices,0,r.vertices,0,this.vertices.length)):r.vertices=null,r.worldVerticesLength=this.worldVerticesLength,r.deformAttachment=this.deformAttachment}}Tu.nextID=0;class Yp{constructor(r,h,d){if(!r)throw new Error("name cannot be null.");this.name=r,this.setTimelines(h),this.duration=d}setTimelines(r){if(!r)throw new Error("timelines cannot be null.");this.timelines=r,this.timelineIds=new da;for(var h=0;h<r.length;h++)this.timelineIds.addAll(r[h].getPropertyIds())}hasTimeline(r){for(let h=0;h<r.length;h++)if(this.timelineIds.contains(r[h]))return!0;return!1}apply(r,h,d,y,b,N,k,T){if(!r)throw new Error("skeleton cannot be null.");y&&0!=this.duration&&(d%=this.duration,h>0&&(h%=this.duration));let H=this.timelines;for(let Y=0,le=H.length;Y<le;Y++)H[Y].apply(r,h,d,b,N,k,T)}}(function(a){a[a.setup=0]="setup",a[a.first=1]="first",a[a.replace=2]="replace",a[a.add=3]="add"})(Zt||(Zt={})),function(a){a[a.mixIn=0]="mixIn",a[a.mixOut=1]="mixOut"}(No||(No={}));class co{constructor(r,h){this.propertyIds=h,this.frames=dr.newFloatArray(r*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(r,h){let d=r.length;for(let y=1;y<d;y++)if(r[y]>h)return y-1;return d-1}static search(r,h,d){let y=r.length;for(let b=d;b<y;b+=d)if(r[b]>h)return b-d;return y-d}}class ls extends co{constructor(r,h,d){super(r,d),this.curves=dr.newFloatArray(r+18*h),this.curves[r-1]=1}setLinear(r){this.curves[r]=0}setStepped(r){this.curves[r]=1}shrink(r){let h=this.getFrameCount()+18*r;if(this.curves.length>h){let d=dr.newFloatArray(h);dr.arrayCopy(this.curves,0,d,0,h),this.curves=d}}setBezier(r,h,d,y,b,N,k,T,H,Y,le){let ae=this.curves,ge=this.getFrameCount()+18*r;0==d&&(ae[h]=2+ge);let we=.03*(y-2*N+T),Se=.03*(b-2*k+H),$e=.006*(3*(N-T)-y+Y),Re=.006*(3*(k-H)-b+le),Pe=2*we+$e,Oe=2*Se+Re,Fe=.3*(N-y)+we+.16666667*$e,De=.3*(k-b)+Se+.16666667*Re,Qe=y+Fe,it=b+De;for(let ct=ge+18;ge<ct;ge+=2)ae[ge]=Qe,ae[ge+1]=it,Fe+=Pe,De+=Oe,Pe+=$e,Oe+=Re,Qe+=Fe,it+=De}getBezierValue(r,h,d,y){let b=this.curves;if(b[y]>r){let H=this.frames[h],Y=this.frames[h+d];return Y+(r-H)/(b[y]-H)*(b[y+1]-Y)}let N=y+18;for(y+=2;y<N;y+=2)if(b[y]>=r){let H=b[y-2],Y=b[y-1];return Y+(r-H)/(b[y]-H)*(b[y+1]-Y)}h+=this.getFrameEntries();let k=b[N-2],T=b[N-1];return T+(r-k)/(this.frames[h]-k)*(this.frames[h+d]-T)}}class th extends ls{constructor(r,h,d){super(r,h,[d])}getFrameEntries(){return 2}setFrame(r,h,d){this.frames[r<<=1]=h,this.frames[r+1]=d}getCurveValue(r){let h=this.frames,d=h.length-2;for(let b=2;b<=d;b+=2)if(h[b]>r){d=b-2;break}let y=this.curves[d>>1];switch(y){case 0:let b=h[d],N=h[d+1];return N+(r-b)/(h[d+2]-b)*(h[d+2+1]-N);case 1:return h[d+1]}return this.getBezierValue(r,d,1,y-2)}}class Ef extends ls{constructor(r,h,d,y){super(r,h,[d,y])}getFrameEntries(){return 3}setFrame(r,h,d,y){this.frames[r*=3]=h,this.frames[r+1]=d,this.frames[r+2]=y}}class Tf extends th{constructor(r,h,d){super(r,h,"0|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;if(d<this.frames[0]){switch(N){case Zt.setup:return void(T.rotation=T.data.rotation);case Zt.first:T.rotation+=(T.data.rotation-T.rotation)*b}return}let H=this.getCurveValue(d);switch(N){case Zt.setup:T.rotation=T.data.rotation+H*b;break;case Zt.first:case Zt.replace:H+=T.data.rotation-T.rotation;case Zt.add:T.rotation+=H*b}}}class Yf extends Ef{constructor(r,h,d){super(r,h,"1|"+d,"2|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;let H=this.frames;if(d<H[0]){switch(N){case Zt.setup:return T.x=T.data.x,void(T.y=T.data.y);case Zt.first:T.x+=(T.data.x-T.x)*b,T.y+=(T.data.y-T.y)*b}return}let Y=0,le=0,ae=co.search(H,d,3),ge=this.curves[ae/3];switch(ge){case 0:let we=H[ae];Y=H[ae+1],le=H[ae+2];let Se=(d-we)/(H[ae+3]-we);Y+=(H[ae+3+1]-Y)*Se,le+=(H[ae+3+2]-le)*Se;break;case 1:Y=H[ae+1],le=H[ae+2];break;default:Y=this.getBezierValue(d,ae,1,ge-2),le=this.getBezierValue(d,ae,2,ge+18-2)}switch(N){case Zt.setup:T.x=T.data.x+Y*b,T.y=T.data.y+le*b;break;case Zt.first:case Zt.replace:T.x+=(T.data.x+Y-T.x)*b,T.y+=(T.data.y+le-T.y)*b;break;case Zt.add:T.x+=Y*b,T.y+=le*b}}}class Jf extends th{constructor(r,h,d){super(r,h,"1|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;if(d<this.frames[0]){switch(N){case Zt.setup:return void(T.x=T.data.x);case Zt.first:T.x+=(T.data.x-T.x)*b}return}let H=this.getCurveValue(d);switch(N){case Zt.setup:T.x=T.data.x+H*b;break;case Zt.first:case Zt.replace:T.x+=(T.data.x+H-T.x)*b;break;case Zt.add:T.x+=H*b}}}class Mf extends th{constructor(r,h,d){super(r,h,"2|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;if(d<this.frames[0]){switch(N){case Zt.setup:return void(T.y=T.data.y);case Zt.first:T.y+=(T.data.y-T.y)*b}return}let H=this.getCurveValue(d);switch(N){case Zt.setup:T.y=T.data.y+H*b;break;case Zt.first:case Zt.replace:T.y+=(T.data.y+H-T.y)*b;break;case Zt.add:T.y+=H*b}}}class Zf extends Ef{constructor(r,h,d){super(r,h,"3|"+d,"4|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;let H,Y,le=this.frames;if(d<le[0]){switch(N){case Zt.setup:return T.scaleX=T.data.scaleX,void(T.scaleY=T.data.scaleY);case Zt.first:T.scaleX+=(T.data.scaleX-T.scaleX)*b,T.scaleY+=(T.data.scaleY-T.scaleY)*b}return}let ae=co.search(le,d,3),ge=this.curves[ae/3];switch(ge){case 0:let we=le[ae];H=le[ae+1],Y=le[ae+2];let Se=(d-we)/(le[ae+3]-we);H+=(le[ae+3+1]-H)*Se,Y+=(le[ae+3+2]-Y)*Se;break;case 1:H=le[ae+1],Y=le[ae+2];break;default:H=this.getBezierValue(d,ae,1,ge-2),Y=this.getBezierValue(d,ae,2,ge+18-2)}if(H*=T.data.scaleX,Y*=T.data.scaleY,1==b)N==Zt.add?(T.scaleX+=H-T.data.scaleX,T.scaleY+=Y-T.data.scaleY):(T.scaleX=H,T.scaleY=Y);else{let we=0,Se=0;if(k==No.mixOut)switch(N){case Zt.setup:we=T.data.scaleX,Se=T.data.scaleY,T.scaleX=we+(Math.abs(H)*Ln.signum(we)-we)*b,T.scaleY=Se+(Math.abs(Y)*Ln.signum(Se)-Se)*b;break;case Zt.first:case Zt.replace:we=T.scaleX,Se=T.scaleY,T.scaleX=we+(Math.abs(H)*Ln.signum(we)-we)*b,T.scaleY=Se+(Math.abs(Y)*Ln.signum(Se)-Se)*b;break;case Zt.add:T.scaleX=(H-T.data.scaleX)*b,T.scaleY=(Y-T.data.scaleY)*b}else switch(N){case Zt.setup:we=Math.abs(T.data.scaleX)*Ln.signum(H),Se=Math.abs(T.data.scaleY)*Ln.signum(Y),T.scaleX=we+(H-we)*b,T.scaleY=Se+(Y-Se)*b;break;case Zt.first:case Zt.replace:we=Math.abs(T.scaleX)*Ln.signum(H),Se=Math.abs(T.scaleY)*Ln.signum(Y),T.scaleX=we+(H-we)*b,T.scaleY=Se+(Y-Se)*b;break;case Zt.add:T.scaleX+=(H-T.data.scaleX)*b,T.scaleY+=(Y-T.data.scaleY)*b}}}}class Am extends th{constructor(r,h,d){super(r,h,"3|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;if(d<this.frames[0]){switch(N){case Zt.setup:return void(T.scaleX=T.data.scaleX);case Zt.first:T.scaleX+=(T.data.scaleX-T.scaleX)*b}return}let H=this.getCurveValue(d)*T.data.scaleX;if(1==b)N==Zt.add?T.scaleX+=H-T.data.scaleX:T.scaleX=H;else{let Y=0;if(k==No.mixOut)switch(N){case Zt.setup:Y=T.data.scaleX,T.scaleX=Y+(Math.abs(H)*Ln.signum(Y)-Y)*b;break;case Zt.first:case Zt.replace:Y=T.scaleX,T.scaleX=Y+(Math.abs(H)*Ln.signum(Y)-Y)*b;break;case Zt.add:T.scaleX=(H-T.data.scaleX)*b}else switch(N){case Zt.setup:Y=Math.abs(T.data.scaleX)*Ln.signum(H),T.scaleX=Y+(H-Y)*b;break;case Zt.first:case Zt.replace:Y=Math.abs(T.scaleX)*Ln.signum(H),T.scaleX=Y+(H-Y)*b;break;case Zt.add:T.scaleX+=(H-T.data.scaleX)*b}}}}class Bp extends th{constructor(r,h,d){super(r,h,"4|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;if(d<this.frames[0]){switch(N){case Zt.setup:return void(T.scaleY=T.data.scaleY);case Zt.first:T.scaleY+=(T.data.scaleY-T.scaleY)*b}return}let H=this.getCurveValue(d)*T.data.scaleY;if(1==b)N==Zt.add?T.scaleY+=H-T.data.scaleY:T.scaleY=H;else{let Y=0;if(k==No.mixOut)switch(N){case Zt.setup:Y=T.data.scaleY,T.scaleY=Y+(Math.abs(H)*Ln.signum(Y)-Y)*b;break;case Zt.first:case Zt.replace:Y=T.scaleY,T.scaleY=Y+(Math.abs(H)*Ln.signum(Y)-Y)*b;break;case Zt.add:T.scaleY=(H-T.data.scaleY)*b}else switch(N){case Zt.setup:Y=Math.abs(T.data.scaleY)*Ln.signum(H),T.scaleY=Y+(H-Y)*b;break;case Zt.first:case Zt.replace:Y=Math.abs(T.scaleY)*Ln.signum(H),T.scaleY=Y+(H-Y)*b;break;case Zt.add:T.scaleY+=(H-T.data.scaleY)*b}}}}class Qf extends Ef{constructor(r,h,d){super(r,h,"5|"+d,"6|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;let H=this.frames;if(d<H[0]){switch(N){case Zt.setup:return T.shearX=T.data.shearX,void(T.shearY=T.data.shearY);case Zt.first:T.shearX+=(T.data.shearX-T.shearX)*b,T.shearY+=(T.data.shearY-T.shearY)*b}return}let Y=0,le=0,ae=co.search(H,d,3),ge=this.curves[ae/3];switch(ge){case 0:let we=H[ae];Y=H[ae+1],le=H[ae+2];let Se=(d-we)/(H[ae+3]-we);Y+=(H[ae+3+1]-Y)*Se,le+=(H[ae+3+2]-le)*Se;break;case 1:Y=H[ae+1],le=H[ae+2];break;default:Y=this.getBezierValue(d,ae,1,ge-2),le=this.getBezierValue(d,ae,2,ge+18-2)}switch(N){case Zt.setup:T.shearX=T.data.shearX+Y*b,T.shearY=T.data.shearY+le*b;break;case Zt.first:case Zt.replace:T.shearX+=(T.data.shearX+Y-T.shearX)*b,T.shearY+=(T.data.shearY+le-T.shearY)*b;break;case Zt.add:T.shearX+=Y*b,T.shearY+=le*b}}}class $m extends th{constructor(r,h,d){super(r,h,"5|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;if(d<this.frames[0]){switch(N){case Zt.setup:return void(T.shearX=T.data.shearX);case Zt.first:T.shearX+=(T.data.shearX-T.shearX)*b}return}let H=this.getCurveValue(d);switch(N){case Zt.setup:T.shearX=T.data.shearX+H*b;break;case Zt.first:case Zt.replace:T.shearX+=(T.data.shearX+H-T.shearX)*b;break;case Zt.add:T.shearX+=H*b}}}class Kf extends th{constructor(r,h,d){super(r,h,"6|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,N,k){let T=r.bones[this.boneIndex];if(!T.active)return;if(d<this.frames[0]){switch(N){case Zt.setup:return void(T.shearY=T.data.shearY);case Zt.first:T.shearY+=(T.data.shearY-T.shearY)*b}return}let H=this.getCurveValue(d);switch(N){case Zt.setup:T.shearY=T.data.shearY+H*b;break;case Zt.first:case Zt.replace:T.shearY+=(T.data.shearY+H-T.shearY)*b;break;case Zt.add:T.shearY+=H*b}}}class em extends ls{constructor(r,h,d){super(r,h,["7|"+d,"8|"+d]),this.slotIndex=0,this.slotIndex=d}getFrameEntries(){return 5}setFrame(r,h,d,y,b,N){this.frames[r*=5]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=N}apply(r,h,d,y,b,N,k){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let H=this.frames,Y=T.color;if(d<H[0]){let Re=T.data.color;switch(N){case Zt.setup:return void Y.setFromColor(Re);case Zt.first:Y.add((Re.r-Y.r)*b,(Re.g-Y.g)*b,(Re.b-Y.b)*b,(Re.a-Y.a)*b)}return}let le=0,ae=0,ge=0,we=0,Se=co.search(H,d,5),$e=this.curves[Se/5];switch($e){case 0:let Re=H[Se];le=H[Se+1],ae=H[Se+2],ge=H[Se+3],we=H[Se+4];let Pe=(d-Re)/(H[Se+5]-Re);le+=(H[Se+5+1]-le)*Pe,ae+=(H[Se+5+2]-ae)*Pe,ge+=(H[Se+5+3]-ge)*Pe,we+=(H[Se+5+4]-we)*Pe;break;case 1:le=H[Se+1],ae=H[Se+2],ge=H[Se+3],we=H[Se+4];break;default:le=this.getBezierValue(d,Se,1,$e-2),ae=this.getBezierValue(d,Se,2,$e+18-2),ge=this.getBezierValue(d,Se,3,$e+36-2),we=this.getBezierValue(d,Se,4,$e+54-2)}1==b?Y.set(le,ae,ge,we):(N==Zt.setup&&Y.setFromColor(T.data.color),Y.add((le-Y.r)*b,(ae-Y.g)*b,(ge-Y.b)*b,(we-Y.a)*b))}}class Ud extends ls{constructor(r,h,d){super(r,h,["7|"+d]),this.slotIndex=0,this.slotIndex=d}getFrameEntries(){return 4}setFrame(r,h,d,y,b){this.frames[r<<=2]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b}apply(r,h,d,y,b,N,k){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let H=this.frames,Y=T.color;if(d<H[0]){let $e=T.data.color;switch(N){case Zt.setup:return Y.r=$e.r,Y.g=$e.g,void(Y.b=$e.b);case Zt.first:Y.r+=($e.r-Y.r)*b,Y.g+=($e.g-Y.g)*b,Y.b+=($e.b-Y.b)*b}return}let le=0,ae=0,ge=0,we=co.search(H,d,4),Se=this.curves[we>>2];switch(Se){case 0:let $e=H[we];le=H[we+1],ae=H[we+2],ge=H[we+3];let Re=(d-$e)/(H[we+4]-$e);le+=(H[we+4+1]-le)*Re,ae+=(H[we+4+2]-ae)*Re,ge+=(H[we+4+3]-ge)*Re;break;case 1:le=H[we+1],ae=H[we+2],ge=H[we+3];break;default:le=this.getBezierValue(d,we,1,Se-2),ae=this.getBezierValue(d,we,2,Se+18-2),ge=this.getBezierValue(d,we,3,Se+36-2)}if(1==b)Y.r=le,Y.g=ae,Y.b=ge;else{if(N==Zt.setup){let $e=T.data.color;Y.r=$e.r,Y.g=$e.g,Y.b=$e.b}Y.r+=(le-Y.r)*b,Y.g+=(ae-Y.g)*b,Y.b+=(ge-Y.b)*b}}}class Cm extends th{constructor(r,h,d){super(r,h,"8|"+d),this.slotIndex=0,this.slotIndex=d}apply(r,h,d,y,b,N,k){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let H=T.color;if(d<this.frames[0]){let le=T.data.color;switch(N){case Zt.setup:return void(H.a=le.a);case Zt.first:H.a+=(le.a-H.a)*b}return}let Y=this.getCurveValue(d);1==b?H.a=Y:(N==Zt.setup&&(H.a=T.data.color.a),H.a+=(Y-H.a)*b)}}class Lm extends ls{constructor(r,h,d){super(r,h,["7|"+d,"8|"+d,"9|"+d]),this.slotIndex=0,this.slotIndex=d}getFrameEntries(){return 8}setFrame(r,h,d,y,b,N,k,T,H){this.frames[r<<=3]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=N,this.frames[r+5]=k,this.frames[r+6]=T,this.frames[r+7]=H}apply(r,h,d,y,b,N,k){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let H=this.frames,Y=T.color,le=T.darkColor;if(d<H[0]){let De=T.data.color,Qe=T.data.darkColor;switch(N){case Zt.setup:return Y.setFromColor(De),le.r=Qe.r,le.g=Qe.g,void(le.b=Qe.b);case Zt.first:Y.add((De.r-Y.r)*b,(De.g-Y.g)*b,(De.b-Y.b)*b,(De.a-Y.a)*b),le.r+=(Qe.r-le.r)*b,le.g+=(Qe.g-le.g)*b,le.b+=(Qe.b-le.b)*b}return}let ae=0,ge=0,we=0,Se=0,$e=0,Re=0,Pe=0,Oe=co.search(H,d,8),Fe=this.curves[Oe>>3];switch(Fe){case 0:let De=H[Oe];ae=H[Oe+1],ge=H[Oe+2],we=H[Oe+3],Se=H[Oe+4],$e=H[Oe+5],Re=H[Oe+6],Pe=H[Oe+7];let Qe=(d-De)/(H[Oe+8]-De);ae+=(H[Oe+8+1]-ae)*Qe,ge+=(H[Oe+8+2]-ge)*Qe,we+=(H[Oe+8+3]-we)*Qe,Se+=(H[Oe+8+4]-Se)*Qe,$e+=(H[Oe+8+5]-$e)*Qe,Re+=(H[Oe+8+6]-Re)*Qe,Pe+=(H[Oe+8+7]-Pe)*Qe;break;case 1:ae=H[Oe+1],ge=H[Oe+2],we=H[Oe+3],Se=H[Oe+4],$e=H[Oe+5],Re=H[Oe+6],Pe=H[Oe+7];break;default:ae=this.getBezierValue(d,Oe,1,Fe-2),ge=this.getBezierValue(d,Oe,2,Fe+18-2),we=this.getBezierValue(d,Oe,3,Fe+36-2),Se=this.getBezierValue(d,Oe,4,Fe+54-2),$e=this.getBezierValue(d,Oe,5,Fe+72-2),Re=this.getBezierValue(d,Oe,6,Fe+90-2),Pe=this.getBezierValue(d,Oe,7,Fe+108-2)}if(1==b)Y.set(ae,ge,we,Se),le.r=$e,le.g=Re,le.b=Pe;else{if(N==Zt.setup){Y.setFromColor(T.data.color);let De=T.data.darkColor;le.r=De.r,le.g=De.g,le.b=De.b}Y.add((ae-Y.r)*b,(ge-Y.g)*b,(we-Y.b)*b,(Se-Y.a)*b),le.r+=($e-le.r)*b,le.g+=(Re-le.g)*b,le.b+=(Pe-le.b)*b}}}class zd extends ls{constructor(r,h,d){super(r,h,["7|"+d,"9|"+d]),this.slotIndex=0,this.slotIndex=d}getFrameEntries(){return 7}setFrame(r,h,d,y,b,N,k,T){this.frames[r*=7]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=N,this.frames[r+5]=k,this.frames[r+6]=T}apply(r,h,d,y,b,N,k){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let H=this.frames,Y=T.color,le=T.darkColor;if(d<H[0]){let Fe=T.data.color,De=T.data.darkColor;switch(N){case Zt.setup:return Y.r=Fe.r,Y.g=Fe.g,Y.b=Fe.b,le.r=De.r,le.g=De.g,void(le.b=De.b);case Zt.first:Y.r+=(Fe.r-Y.r)*b,Y.g+=(Fe.g-Y.g)*b,Y.b+=(Fe.b-Y.b)*b,le.r+=(De.r-le.r)*b,le.g+=(De.g-le.g)*b,le.b+=(De.b-le.b)*b}return}let ae=0,ge=0,we=0,Se=0,$e=0,Re=0,Pe=co.search(H,d,7),Oe=this.curves[Pe/7];switch(Oe){case 0:let Fe=H[Pe];ae=H[Pe+1],ge=H[Pe+2],we=H[Pe+3],Se=H[Pe+4],$e=H[Pe+5],Re=H[Pe+6];let De=(d-Fe)/(H[Pe+7]-Fe);ae+=(H[Pe+7+1]-ae)*De,ge+=(H[Pe+7+2]-ge)*De,we+=(H[Pe+7+3]-we)*De,Se+=(H[Pe+7+4]-Se)*De,$e+=(H[Pe+7+5]-$e)*De,Re+=(H[Pe+7+6]-Re)*De;break;case 1:ae=H[Pe+1],ge=H[Pe+2],we=H[Pe+3],Se=H[Pe+4],$e=H[Pe+5],Re=H[Pe+6];break;default:ae=this.getBezierValue(d,Pe,1,Oe-2),ge=this.getBezierValue(d,Pe,2,Oe+18-2),we=this.getBezierValue(d,Pe,3,Oe+36-2),Se=this.getBezierValue(d,Pe,4,Oe+54-2),$e=this.getBezierValue(d,Pe,5,Oe+72-2),Re=this.getBezierValue(d,Pe,6,Oe+90-2)}if(1==b)Y.r=ae,Y.g=ge,Y.b=we,le.r=Se,le.g=$e,le.b=Re;else{if(N==Zt.setup){let Fe=T.data.color,De=T.data.darkColor;Y.r=Fe.r,Y.g=Fe.g,Y.b=Fe.b,le.r=De.r,le.g=De.g,le.b=De.b}Y.r+=(ae-Y.r)*b,Y.g+=(ge-Y.g)*b,Y.b+=(we-Y.b)*b,le.r+=(Se-le.r)*b,le.g+=($e-le.g)*b,le.b+=(Re-le.b)*b}}}class yd extends co{constructor(r,h){super(r,["10|"+h]),this.slotIndex=0,this.slotIndex=h,this.attachmentNames=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,d){this.frames[r]=h,this.attachmentNames[r]=d}apply(r,h,d,y,b,N,k){let T=r.slots[this.slotIndex];T.bone.active&&(k!=No.mixOut?d<this.frames[0]?N!=Zt.setup&&N!=Zt.first||this.setAttachment(r,T,T.data.attachmentName):this.setAttachment(r,T,this.attachmentNames[co.search1(this.frames,d)]):N==Zt.setup&&this.setAttachment(r,T,T.data.attachmentName))}setAttachment(r,h,d){h.setAttachment(d?r.getAttachment(this.slotIndex,d):null)}}class tm extends ls{constructor(r,h,d,y){super(r,h,["11|"+d+"|"+y.id]),this.slotIndex=0,this.slotIndex=d,this.attachment=y,this.vertices=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,d){this.frames[r]=h,this.vertices[r]=d}setBezier(r,h,d,y,b,N,k,T,H,Y,le){let ae=this.curves,ge=this.getFrameCount()+18*r;0==d&&(ae[h]=2+ge);let we=.03*(y-2*N+T),Se=.03*H-.06*k,$e=.006*(3*(N-T)-y+Y),Re=.018*(k-H+.33333333),Pe=2*we+$e,Oe=2*Se+Re,Fe=.3*(N-y)+we+.16666667*$e,De=.3*k+Se+.16666667*Re,Qe=y+Fe,it=De;for(let ct=ge+18;ge<ct;ge+=2)ae[ge]=Qe,ae[ge+1]=it,Fe+=Pe,De+=Oe,Pe+=$e,Oe+=Re,Qe+=Fe,it+=De}getCurvePercent(r,h){let d=this.curves,y=d[h];switch(y){case 0:let T=this.frames[h];return(r-T)/(this.frames[h+this.getFrameEntries()]-T);case 1:return 0}if(y-=2,d[y]>r){let T=this.frames[h];return d[y+1]*(r-T)/(d[y]-T)}let b=y+18;for(y+=2;y<b;y+=2)if(d[y]>=r){let T=d[y-2],H=d[y-1];return H+(r-T)/(d[y]-T)*(d[y+1]-H)}let N=d[b-2],k=d[b-1];return k+(1-k)*(r-N)/(this.frames[h+this.getFrameEntries()]-N)}apply(r,h,d,y,b,N,k){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let H=T.getAttachment();if(!(H instanceof Tu)||H.deformAttachment!=this.attachment)return;let Y=T.deform;0==Y.length&&(N=Zt.setup);let le=this.vertices,ae=le[0].length,ge=this.frames;if(d<ge[0]){let Oe=H;switch(N){case Zt.setup:return void(Y.length=0);case Zt.first:if(1==b)return void(Y.length=0);if(Y.length=ae,Oe.bones)for(b=1-b,we=0;we<ae;we++)Y[we]*=b;else{let Fe=Oe.vertices;for(var we=0;we<ae;we++)Y[we]+=(Fe[we]-Y[we])*b}}return}if(Y.length=ae,d>=ge[ge.length-1]){let Oe=le[ge.length-1];if(1==b)if(N==Zt.add){let Fe=H;if(Fe.bones)for(let De=0;De<ae;De++)Y[De]+=Oe[De];else{let De=Fe.vertices;for(let Qe=0;Qe<ae;Qe++)Y[Qe]+=Oe[Qe]-De[Qe]}}else dr.arrayCopy(Oe,0,Y,0,ae);else switch(N){case Zt.setup:{let De=H;if(De.bones)for(let Qe=0;Qe<ae;Qe++)Y[Qe]=Oe[Qe]*b;else{let Qe=De.vertices;for(let it=0;it<ae;it++){let ct=Qe[it];Y[it]=ct+(Oe[it]-ct)*b}}break}case Zt.first:case Zt.replace:for(let De=0;De<ae;De++)Y[De]+=(Oe[De]-Y[De])*b;break;case Zt.add:let Fe=H;if(Fe.bones)for(let De=0;De<ae;De++)Y[De]+=Oe[De]*b;else{let De=Fe.vertices;for(let Qe=0;Qe<ae;Qe++)Y[Qe]+=(Oe[Qe]-De[Qe])*b}}return}let Se=co.search1(ge,d),$e=this.getCurvePercent(d,Se),Re=le[Se],Pe=le[Se+1];if(1==b)if(N==Zt.add){let Oe=H;if(Oe.bones)for(let Fe=0;Fe<ae;Fe++){let De=Re[Fe];Y[Fe]+=De+(Pe[Fe]-De)*$e}else{let Fe=Oe.vertices;for(let De=0;De<ae;De++){let Qe=Re[De];Y[De]+=Qe+(Pe[De]-Qe)*$e-Fe[De]}}}else for(let Oe=0;Oe<ae;Oe++){let Fe=Re[Oe];Y[Oe]=Fe+(Pe[Oe]-Fe)*$e}else switch(N){case Zt.setup:{let Fe=H;if(Fe.bones)for(let De=0;De<ae;De++){let Qe=Re[De];Y[De]=(Qe+(Pe[De]-Qe)*$e)*b}else{let De=Fe.vertices;for(let Qe=0;Qe<ae;Qe++){let it=Re[Qe],ct=De[Qe];Y[Qe]=ct+(it+(Pe[Qe]-it)*$e-ct)*b}}break}case Zt.first:case Zt.replace:for(let Fe=0;Fe<ae;Fe++){let De=Re[Fe];Y[Fe]+=(De+(Pe[Fe]-De)*$e-Y[Fe])*b}break;case Zt.add:let Oe=H;if(Oe.bones)for(let Fe=0;Fe<ae;Fe++){let De=Re[Fe];Y[Fe]+=(De+(Pe[Fe]-De)*$e)*b}else{let Fe=Oe.vertices;for(let De=0;De<ae;De++){let Qe=Re[De];Y[De]+=(Qe+(Pe[De]-Qe)*$e-Fe[De])*b}}}}}class jd extends co{constructor(r){super(r,jd.propertyIds),this.events=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h){this.frames[r]=h.time,this.events[r]=h}apply(r,h,d,y,b,N,k){if(!y)return;let T=this.frames,H=this.frames.length;if(h>d)this.apply(r,h,Number.MAX_VALUE,y,b,N,k),h=-1;else if(h>=T[H-1])return;if(d<T[0])return;let Y=0;if(h<T[0])Y=0;else{Y=co.search1(T,h)+1;let le=T[Y];for(;Y>0&&T[Y-1]==le;)Y--}for(;Y<H&&d>=T[Y];Y++)y.push(this.events[Y])}}jd.propertyIds=["12"];class Kh extends co{constructor(r){super(r,Kh.propertyIds),this.drawOrders=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,d){this.frames[r]=h,this.drawOrders[r]=d}apply(r,h,d,y,b,N,k){if(k==No.mixOut)return void(N==Zt.setup&&dr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length));if(d<this.frames[0])return void(N!=Zt.setup&&N!=Zt.first||dr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length));let T=this.drawOrders[co.search1(this.frames,d)];if(T){let H=r.drawOrder,Y=r.slots;for(let le=0,ae=T.length;le<ae;le++)H[le]=Y[T[le]]}else dr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length)}}Kh.propertyIds=["13"];class Bm extends ls{constructor(r,h,d){super(r,h,["14|"+d]),this.ikConstraintIndex=d}getFrameEntries(){return 6}setFrame(r,h,d,y,b,N,k){this.frames[r*=6]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=N?1:0,this.frames[r+5]=k?1:0}apply(r,h,d,y,b,N,k){let T=r.ikConstraints[this.ikConstraintIndex];if(!T.active)return;let H=this.frames;if(d<H[0]){switch(N){case Zt.setup:return T.mix=T.data.mix,T.softness=T.data.softness,T.bendDirection=T.data.bendDirection,T.compress=T.data.compress,void(T.stretch=T.data.stretch);case Zt.first:T.mix+=(T.data.mix-T.mix)*b,T.softness+=(T.data.softness-T.softness)*b,T.bendDirection=T.data.bendDirection,T.compress=T.data.compress,T.stretch=T.data.stretch}return}let Y=0,le=0,ae=co.search(H,d,6),ge=this.curves[ae/6];switch(ge){case 0:let we=H[ae];Y=H[ae+1],le=H[ae+2];let Se=(d-we)/(H[ae+6]-we);Y+=(H[ae+6+1]-Y)*Se,le+=(H[ae+6+2]-le)*Se;break;case 1:Y=H[ae+1],le=H[ae+2];break;default:Y=this.getBezierValue(d,ae,1,ge-2),le=this.getBezierValue(d,ae,2,ge+18-2)}N==Zt.setup?(T.mix=T.data.mix+(Y-T.data.mix)*b,T.softness=T.data.softness+(le-T.data.softness)*b,k==No.mixOut?(T.bendDirection=T.data.bendDirection,T.compress=T.data.compress,T.stretch=T.data.stretch):(T.bendDirection=H[ae+3],T.compress=0!=H[ae+4],T.stretch=0!=H[ae+5])):(T.mix+=(Y-T.mix)*b,T.softness+=(le-T.softness)*b,k==No.mixIn&&(T.bendDirection=H[ae+3],T.compress=0!=H[ae+4],T.stretch=0!=H[ae+5]))}}class Nm extends ls{constructor(r,h,d){super(r,h,["15|"+d]),this.transformConstraintIndex=d}getFrameEntries(){return 7}setFrame(r,h,d,y,b,N,k,T){let H=this.frames;H[r*=7]=h,H[r+1]=d,H[r+2]=y,H[r+3]=b,H[r+4]=N,H[r+5]=k,H[r+6]=T}apply(r,h,d,y,b,N,k){let T=r.transformConstraints[this.transformConstraintIndex];if(!T.active)return;let H,Y,le,ae,ge,we,Se=this.frames;if(d<Se[0]){let Pe=T.data;switch(N){case Zt.setup:return T.mixRotate=Pe.mixRotate,T.mixX=Pe.mixX,T.mixY=Pe.mixY,T.mixScaleX=Pe.mixScaleX,T.mixScaleY=Pe.mixScaleY,void(T.mixShearY=Pe.mixShearY);case Zt.first:T.mixRotate+=(Pe.mixRotate-T.mixRotate)*b,T.mixX+=(Pe.mixX-T.mixX)*b,T.mixY+=(Pe.mixY-T.mixY)*b,T.mixScaleX+=(Pe.mixScaleX-T.mixScaleX)*b,T.mixScaleY+=(Pe.mixScaleY-T.mixScaleY)*b,T.mixShearY+=(Pe.mixShearY-T.mixShearY)*b}return}let $e=co.search(Se,d,7),Re=this.curves[$e/7];switch(Re){case 0:let Pe=Se[$e];H=Se[$e+1],Y=Se[$e+2],le=Se[$e+3],ae=Se[$e+4],ge=Se[$e+5],we=Se[$e+6];let Oe=(d-Pe)/(Se[$e+7]-Pe);H+=(Se[$e+7+1]-H)*Oe,Y+=(Se[$e+7+2]-Y)*Oe,le+=(Se[$e+7+3]-le)*Oe,ae+=(Se[$e+7+4]-ae)*Oe,ge+=(Se[$e+7+5]-ge)*Oe,we+=(Se[$e+7+6]-we)*Oe;break;case 1:H=Se[$e+1],Y=Se[$e+2],le=Se[$e+3],ae=Se[$e+4],ge=Se[$e+5],we=Se[$e+6];break;default:H=this.getBezierValue(d,$e,1,Re-2),Y=this.getBezierValue(d,$e,2,Re+18-2),le=this.getBezierValue(d,$e,3,Re+36-2),ae=this.getBezierValue(d,$e,4,Re+54-2),ge=this.getBezierValue(d,$e,5,Re+72-2),we=this.getBezierValue(d,$e,6,Re+90-2)}if(N==Zt.setup){let Pe=T.data;T.mixRotate=Pe.mixRotate+(H-Pe.mixRotate)*b,T.mixX=Pe.mixX+(Y-Pe.mixX)*b,T.mixY=Pe.mixY+(le-Pe.mixY)*b,T.mixScaleX=Pe.mixScaleX+(ae-Pe.mixScaleX)*b,T.mixScaleY=Pe.mixScaleY+(ge-Pe.mixScaleY)*b,T.mixShearY=Pe.mixShearY+(we-Pe.mixShearY)*b}else T.mixRotate+=(H-T.mixRotate)*b,T.mixX+=(Y-T.mixX)*b,T.mixY+=(le-T.mixY)*b,T.mixScaleX+=(ae-T.mixScaleX)*b,T.mixScaleY+=(ge-T.mixScaleY)*b,T.mixShearY+=(we-T.mixShearY)*b}}class Rm extends th{constructor(r,h,d){super(r,h,"16|"+d),this.pathConstraintIndex=d}apply(r,h,d,y,b,N,k){let T=r.pathConstraints[this.pathConstraintIndex];if(!T.active)return;if(d<this.frames[0]){switch(N){case Zt.setup:return void(T.position=T.data.position);case Zt.first:T.position+=(T.data.position-T.position)*b}return}let H=this.getCurveValue(d);N==Zt.setup?T.position=T.data.position+(H-T.data.position)*b:T.position+=(H-T.position)*b}}class nm extends th{constructor(r,h,d){super(r,h,"17|"+d),this.pathConstraintIndex=0,this.pathConstraintIndex=d}apply(r,h,d,y,b,N,k){let T=r.pathConstraints[this.pathConstraintIndex];if(!T.active)return;if(d<this.frames[0]){switch(N){case Zt.setup:return void(T.spacing=T.data.spacing);case Zt.first:T.spacing+=(T.data.spacing-T.spacing)*b}return}let H=this.getCurveValue(d);N==Zt.setup?T.spacing=T.data.spacing+(H-T.data.spacing)*b:T.spacing+=(H-T.spacing)*b}}class Pm extends ls{constructor(r,h,d){super(r,h,["18|"+d]),this.pathConstraintIndex=0,this.pathConstraintIndex=d}getFrameEntries(){return 4}setFrame(r,h,d,y,b){let N=this.frames;N[r<<=2]=h,N[r+1]=d,N[r+2]=y,N[r+3]=b}apply(r,h,d,y,b,N,k){let T=r.pathConstraints[this.pathConstraintIndex];if(!T.active)return;let H,Y,le,ae=this.frames;if(d<ae[0]){switch(N){case Zt.setup:return T.mixRotate=T.data.mixRotate,T.mixX=T.data.mixX,void(T.mixY=T.data.mixY);case Zt.first:T.mixRotate+=(T.data.mixRotate-T.mixRotate)*b,T.mixX+=(T.data.mixX-T.mixX)*b,T.mixY+=(T.data.mixY-T.mixY)*b}return}let ge=co.search(ae,d,4),we=this.curves[ge>>2];switch(we){case 0:let Se=ae[ge];H=ae[ge+1],Y=ae[ge+2],le=ae[ge+3];let $e=(d-Se)/(ae[ge+4]-Se);H+=(ae[ge+4+1]-H)*$e,Y+=(ae[ge+4+2]-Y)*$e,le+=(ae[ge+4+3]-le)*$e;break;case 1:H=ae[ge+1],Y=ae[ge+2],le=ae[ge+3];break;default:H=this.getBezierValue(d,ge,1,we-2),Y=this.getBezierValue(d,ge,2,we+18-2),le=this.getBezierValue(d,ge,3,we+36-2)}if(N==Zt.setup){let Se=T.data;T.mixRotate=Se.mixRotate+(H-Se.mixRotate)*b,T.mixX=Se.mixX+(Y-Se.mixX)*b,T.mixY=Se.mixY+(le-Se.mixY)*b}else T.mixRotate+=(H-T.mixRotate)*b,T.mixX+=(Y-T.mixX)*b,T.mixY+=(le-T.mixY)*b}}class Gd{constructor(r){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Im(this),this.propertyIDs=new da,this.animationsChanged=!1,this.trackEntryPool=new af(()=>new rm),this.data=r}static emptyAnimation(){return $f||($f=new Yp("<empty>",[],0)),$f}update(r){r*=this.timeScale;let h=this.tracks;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(!b)continue;b.animationLast=b.nextAnimationLast,b.trackLast=b.nextTrackLast;let N=r*b.timeScale;if(b.delay>0){if(b.delay-=N,b.delay>0)continue;N=-b.delay,b.delay=0}let k=b.next;if(k){let T=b.trackLast-k.delay;if(T>=0){for(k.delay=0,k.trackTime+=0==b.timeScale?0:(T/b.timeScale+r)*k.timeScale,b.trackTime+=N,this.setCurrent(d,k,!0);k.mixingFrom;)k.mixTime+=r,k=k.mixingFrom;continue}}else if(b.trackLast>=b.trackEnd&&!b.mixingFrom){h[d]=null,this.queue.end(b),this.clearNext(b);continue}if(b.mixingFrom&&this.updateMixingFrom(b,r)){let T=b.mixingFrom;for(b.mixingFrom=null,T&&(T.mixingTo=null);T;)this.queue.end(T),T=T.mixingFrom}b.trackTime+=N}this.queue.drain()}updateMixingFrom(r,h){let d=r.mixingFrom;if(!d)return!0;let y=this.updateMixingFrom(d,h);return d.animationLast=d.nextAnimationLast,d.trackLast=d.nextTrackLast,r.mixTime>0&&r.mixTime>=r.mixDuration?(0!=d.totalAlpha&&0!=r.mixDuration||(r.mixingFrom=d.mixingFrom,d.mixingFrom&&(d.mixingFrom.mixingTo=r),r.interruptAlpha=d.interruptAlpha,this.queue.end(d)),y):(d.trackTime+=h*d.timeScale,r.mixTime+=h,!1)}apply(r){if(!r)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let h=this.events,d=this.tracks,y=!1;for(let ae=0,ge=d.length;ae<ge;ae++){let we=d[ae];if(!we||we.delay>0)continue;y=!0;let Se=0==ae?Zt.first:we.mixBlend,$e=we.alpha;we.mixingFrom?$e*=this.applyMixingFrom(we,r,Se):we.trackTime>=we.trackEnd&&!we.next&&($e=0);let Re=we.animationLast,Pe=we.getAnimationTime(),Oe=Pe,Fe=h;we.reverse&&(Oe=we.animation.duration-Oe,Fe=null);let De=we.animation.timelines,Qe=De.length;if(0==ae&&1==$e||Se==Zt.add)for(let it=0;it<Qe;it++){dr.webkit602BugfixHelper($e,Se);var b=De[it];b instanceof yd?this.applyAttachmentTimeline(b,r,Oe,Se,!0):b.apply(r,Re,Oe,Fe,$e,Se,No.mixIn)}else{let it=we.timelineMode,ct=we.timelinesRotation.length!=Qe<<1;ct&&(we.timelinesRotation.length=Qe<<1);for(let _t=0;_t<Qe;_t++){let $t=De[_t],rn=it[_t]==Af?Se:Zt.setup;$t instanceof Tf?this.applyRotateTimeline($t,r,Oe,$e,rn,we.timelinesRotation,_t<<1,ct):$t instanceof yd?this.applyAttachmentTimeline($t,r,Oe,Se,!0):(dr.webkit602BugfixHelper($e,Se),$t.apply(r,Re,Oe,Fe,$e,rn,No.mixIn))}}this.queueEvents(we,Pe),h.length=0,we.nextAnimationLast=Pe,we.nextTrackLast=we.trackTime}for(var N=this.unkeyedState+sm,k=r.slots,T=0,H=r.slots.length;T<H;T++){var Y=k[T];if(Y.attachmentState==N){var le=Y.data.attachmentName;Y.setAttachment(le?r.getAttachment(Y.data.index,le):null)}}return this.unkeyedState+=2,this.queue.drain(),y}applyMixingFrom(r,h,d){let y=r.mixingFrom;y.mixingFrom&&this.applyMixingFrom(y,h,d);let b=0;0==r.mixDuration?(b=1,d==Zt.first&&(d=Zt.setup)):(b=r.mixTime/r.mixDuration,b>1&&(b=1),d!=Zt.first&&(d=y.mixBlend));let N=b<y.attachmentThreshold,k=b<y.drawOrderThreshold,T=y.animation.timelines,H=T.length,Y=y.alpha*r.interruptAlpha,le=Y*(1-b),ae=y.animationLast,ge=y.getAnimationTime(),we=ge,Se=null;if(y.reverse?we=y.animation.duration-we:b<y.eventThreshold&&(Se=this.events),d==Zt.add)for(let $e=0;$e<H;$e++)T[$e].apply(h,ae,we,Se,le,d,No.mixOut);else{let $e=y.timelineMode,Re=y.timelineHoldMix,Pe=y.timelinesRotation.length!=H<<1;Pe&&(y.timelinesRotation.length=H<<1),y.totalAlpha=0;for(let Oe=0;Oe<H;Oe++){let Fe,De=T[Oe],Qe=No.mixOut,it=0;switch($e[Oe]){case Af:if(!k&&De instanceof Kh)continue;Fe=d,it=le;break;case im:Fe=Zt.setup,it=le;break;case om:Fe=d,it=Y;break;case cf:Fe=Zt.setup,it=Y;break;default:Fe=Zt.setup;let ct=Re[Oe];it=Y*Math.max(0,1-ct.mixTime/ct.mixDuration)}y.totalAlpha+=it,De instanceof Tf?this.applyRotateTimeline(De,h,we,it,Fe,y.timelinesRotation,Oe<<1,Pe):De instanceof yd?this.applyAttachmentTimeline(De,h,we,Fe,N):(dr.webkit602BugfixHelper(it,d),k&&De instanceof Kh&&Fe==Zt.setup&&(Qe=No.mixIn),De.apply(h,ae,we,Se,it,Fe,Qe))}}return r.mixDuration>0&&this.queueEvents(y,ge),this.events.length=0,y.nextAnimationLast=ge,y.nextTrackLast=y.trackTime,b}applyAttachmentTimeline(r,h,d,y,b){var N=h.slots[r.slotIndex];N.bone.active&&(d<r.frames[0]?y!=Zt.setup&&y!=Zt.first||this.setAttachment(h,N,N.data.attachmentName,b):this.setAttachment(h,N,r.attachmentNames[co.search1(r.frames,d)],b),N.attachmentState<=this.unkeyedState&&(N.attachmentState=this.unkeyedState+sm))}setAttachment(r,h,d,y){h.setAttachment(d?r.getAttachment(h.data.index,d):null),y&&(h.attachmentState=this.unkeyedState+km)}applyRotateTimeline(r,h,d,y,b,N,k,T){if(T&&(N[k]=0),1==y)return void r.apply(h,0,d,null,1,b,No.mixIn);let H=h.bones[r.boneIndex];if(!H.active)return;let Y=0,le=0;if(d<r.frames[0])switch(b){case Zt.setup:H.rotation=H.data.rotation;default:return;case Zt.first:Y=H.rotation,le=H.data.rotation}else Y=b==Zt.setup?H.data.rotation:H.rotation,le=H.data.rotation+r.getCurveValue(d);let ae=0,ge=le-Y;if(ge-=360*(16384-(16384.499999999996-ge/360|0)),0==ge)ae=N[k];else{let we=0,Se=0;T?(we=0,Se=ge):(we=N[k],Se=N[k+1]);let $e=ge>0,Re=we>=0;Ln.signum(Se)!=Ln.signum(ge)&&Math.abs(Se)<=90&&(Math.abs(we)>180&&(we+=360*Ln.signum(we)),Re=$e),ae=ge+we-we%360,Re!=$e&&(ae+=360*Ln.signum(we)),N[k]=ae}N[k+1]=ge,H.rotation=Y+ae*y}queueEvents(r,h){let d=r.animationStart,y=r.animationEnd,b=y-d,N=r.trackLast%b,k=this.events,T=0,H=k.length;for(;T<H;T++){let le=k[T];if(le.time<N)break;le.time>y||this.queue.event(r,le)}let Y=!1;for(Y=r.loop?0==b||N>r.trackTime%b:h>=y&&r.animationLast<y,Y&&this.queue.complete(r);T<H;T++){let le=k[T];le.time<d||this.queue.event(r,le)}}clearTracks(){let r=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let h=0,d=this.tracks.length;h<d;h++)this.clearTrack(h);this.tracks.length=0,this.queue.drainDisabled=r,this.queue.drain()}clearTrack(r){if(r>=this.tracks.length)return;let h=this.tracks[r];if(!h)return;this.queue.end(h),this.clearNext(h);let d=h;for(;;){let y=d.mixingFrom;if(!y)break;this.queue.end(y),d.mixingFrom=null,d.mixingTo=null,d=y}this.tracks[h.trackIndex]=null,this.queue.drain()}setCurrent(r,h,d){let y=this.expandToIndex(r);this.tracks[r]=h,h.previous=null,y&&(d&&this.queue.interrupt(y),h.mixingFrom=y,y.mixingTo=h,h.mixTime=0,y.mixingFrom&&y.mixDuration>0&&(h.interruptAlpha*=Math.min(1,y.mixTime/y.mixDuration)),y.timelinesRotation.length=0),this.queue.start(h)}setAnimation(r,h,d=!1){let y=this.data.skeletonData.findAnimation(h);if(!y)throw new Error("Animation not found: "+h);return this.setAnimationWith(r,y,d)}setAnimationWith(r,h,d=!1){if(!h)throw new Error("animation cannot be null.");let y=!0,b=this.expandToIndex(r);b&&(-1==b.nextTrackLast?(this.tracks[r]=b.mixingFrom,this.queue.interrupt(b),this.queue.end(b),this.clearNext(b),b=b.mixingFrom,y=!1):this.clearNext(b));let N=this.trackEntry(r,h,d,b);return this.setCurrent(r,N,y),this.queue.drain(),N}addAnimation(r,h,d=!1,y=0){let b=this.data.skeletonData.findAnimation(h);if(!b)throw new Error("Animation not found: "+h);return this.addAnimationWith(r,b,d,y)}addAnimationWith(r,h,d=!1,y=0){if(!h)throw new Error("animation cannot be null.");let b=this.expandToIndex(r);if(b)for(;b.next;)b=b.next;let N=this.trackEntry(r,h,d,b);return b?(b.next=N,N.previous=b,y<=0&&(y+=b.getTrackComplete()-N.mixDuration)):(this.setCurrent(r,N,!0),this.queue.drain()),N.delay=y,N}setEmptyAnimation(r,h=0){let d=this.setAnimationWith(r,Gd.emptyAnimation(),!1);return d.mixDuration=h,d.trackEnd=h,d}addEmptyAnimation(r,h=0,d=0){let y=this.addAnimationWith(r,Gd.emptyAnimation(),!1,d);return d<=0&&(y.delay+=y.mixDuration-h),y.mixDuration=h,y.trackEnd=h,y}setEmptyAnimations(r=0){let h=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let d=0,y=this.tracks.length;d<y;d++){let b=this.tracks[d];b&&this.setEmptyAnimation(b.trackIndex,r)}this.queue.drainDisabled=h,this.queue.drain()}expandToIndex(r){return r<this.tracks.length?this.tracks[r]:(dr.ensureArrayCapacity(this.tracks,r+1,null),this.tracks.length=r+1,null)}trackEntry(r,h,d,y){let b=this.trackEntryPool.obtain();return b.trackIndex=r,b.animation=h,b.loop=d,b.holdPrevious=!1,b.eventThreshold=0,b.attachmentThreshold=0,b.drawOrderThreshold=0,b.animationStart=0,b.animationEnd=h.duration,b.animationLast=-1,b.nextAnimationLast=-1,b.delay=0,b.trackTime=0,b.trackLast=-1,b.nextTrackLast=-1,b.trackEnd=Number.MAX_VALUE,b.timeScale=1,b.alpha=1,b.interruptAlpha=1,b.mixTime=0,b.mixDuration=y?this.data.getMix(y.animation,h):0,b.mixBlend=Zt.replace,b}clearNext(r){let h=r.next;for(;h;)this.queue.dispose(h),h=h.next;r.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let r=this.tracks;for(let h=0,d=r.length;h<d;h++){let y=r[h];if(y){for(;y.mixingFrom;)y=y.mixingFrom;do{y.mixingTo&&y.mixBlend==Zt.add||this.computeHold(y),y=y.mixingTo}while(y)}}}computeHold(r){let h=r.mixingTo,d=r.animation.timelines,y=r.animation.timelines.length,b=r.timelineMode;b.length=y;let N=r.timelineHoldMix;N.length=0;let k=this.propertyIDs;if(h&&h.holdPrevious)for(let T=0;T<y;T++)b[T]=k.addAll(d[T].getPropertyIds())?cf:om;else e:for(let T=0;T<y;T++){let H=d[T],Y=H.getPropertyIds();if(k.addAll(Y))if(!h||H instanceof yd||H instanceof Kh||H instanceof jd||!h.animation.hasTimeline(Y))b[T]=im;else{for(let le=h.mixingTo;le;le=le.mixingTo)if(!le.animation.hasTimeline(Y)){if(r.mixDuration>0){b[T]=Om,N[T]=le;continue e}break}b[T]=cf}else b[T]=Af}}getCurrent(r){return r>=this.tracks.length?null:this.tracks[r]}addListener(r){if(!r)throw new Error("listener cannot be null.");this.listeners.push(r)}removeListener(r){let h=this.listeners.indexOf(r);h>=0&&this.listeners.splice(h,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}}class rm{constructor(){this.mixBlend=Zt.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let r=this.animationEnd-this.animationStart;return 0==r?this.animationStart:this.trackTime%r+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(r){this.animationLast=r,this.nextAnimationLast=r}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let r=this.animationEnd-this.animationStart;if(0!=r){if(this.loop)return r*(1+(this.trackTime/r|0));if(this.trackTime<r)return r}return this.trackTime}}class Im{constructor(r){this.objects=[],this.drainDisabled=!1,this.animState=r}start(r){this.objects.push($c.start),this.objects.push(r),this.animState.animationsChanged=!0}interrupt(r){this.objects.push($c.interrupt),this.objects.push(r)}end(r){this.objects.push($c.end),this.objects.push(r),this.animState.animationsChanged=!0}dispose(r){this.objects.push($c.dispose),this.objects.push(r)}complete(r){this.objects.push($c.complete),this.objects.push(r)}event(r,h){this.objects.push($c.event),this.objects.push(r),this.objects.push(h)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let r=this.objects,h=this.animState.listeners;for(let d=0;d<r.length;d+=2){let b=r[d+1];switch(r[d]){case $c.start:b.listener&&b.listener.start&&b.listener.start(b);for(let k=0;k<h.length;k++)h[k].start&&h[k].start(b);break;case $c.interrupt:b.listener&&b.listener.interrupt&&b.listener.interrupt(b);for(let k=0;k<h.length;k++)h[k].interrupt&&h[k].interrupt(b);break;case $c.end:b.listener&&b.listener.end&&b.listener.end(b);for(let k=0;k<h.length;k++)h[k].end&&h[k].end(b);case $c.dispose:b.listener&&b.listener.dispose&&b.listener.dispose(b);for(let k=0;k<h.length;k++)h[k].dispose&&h[k].dispose(b);this.animState.trackEntryPool.free(b);break;case $c.complete:b.listener&&b.listener.complete&&b.listener.complete(b);for(let k=0;k<h.length;k++)h[k].complete&&h[k].complete(b);break;case $c.event:let N=r[2+d++];b.listener&&b.listener.event&&b.listener.event(b,N);for(let k=0;k<h.length;k++)h[k].event&&h[k].event(b,N)}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}!function(a){a[a.start=0]="start",a[a.interrupt=1]="interrupt",a[a.end=2]="end",a[a.dispose=3]="dispose",a[a.complete=4]="complete",a[a.event=5]="event"}($c||($c={}));const Af=0,im=1,om=2,cf=3,Om=4,sm=1,km=2;let $f=null;class am{constructor(r){if(this.animationToMixTime={},this.defaultMix=0,!r)throw new Error("skeletonData cannot be null.");this.skeletonData=r}setMix(r,h,d){let y=this.skeletonData.findAnimation(r);if(!y)throw new Error("Animation not found: "+r);let b=this.skeletonData.findAnimation(h);if(!b)throw new Error("Animation not found: "+h);this.setMixWith(y,b,d)}setMixWith(r,h,d){if(!r)throw new Error("from cannot be null.");if(!h)throw new Error("to cannot be null.");this.animationToMixTime[r.name+"."+h.name]=d}getMix(r,h){let y=this.animationToMixTime[r.name+"."+h.name];return void 0===y?this.defaultMix:y}}class Hd extends Tu{constructor(r){super(r),this.color=new Kr(1,1,1,1)}copy(){let r=new Hd(this.name);return this.copyTo(r),r.color.setFromColor(this.color),r}}class bd extends Tu{constructor(r){super(r),this.color=new Kr(.2275,.2275,.8078,1)}copy(){let r=new bd(this.name);return this.copyTo(r),r.endSlot=this.endSlot,r.color.setFromColor(this.color),r}}class ep{constructor(r){this._image=r}getImage(){return this._image}}var $a,Nl,Kl,Np,ec,Jp,tp,Vd,tc,Mu,Wd;(function(a){a[a.Nearest=9728]="Nearest",a[a.Linear=9729]="Linear",a[a.MipMap=9987]="MipMap",a[a.MipMapNearestNearest=9984]="MipMapNearestNearest",a[a.MipMapLinearNearest=9985]="MipMapLinearNearest",a[a.MipMapNearestLinear=9986]="MipMapNearestLinear",a[a.MipMapLinearLinear=9987]="MipMapLinearLinear"})($a||($a={})),function(a){a[a.MirroredRepeat=33648]="MirroredRepeat",a[a.ClampToEdge=33071]="ClampToEdge",a[a.Repeat=10497]="Repeat"}(Nl||(Nl={}));class lm{constructor(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.degrees=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0}}class qd{constructor(r){this.pages=new Array,this.regions=new Array;let h=new Xd(r),d=new Array(4),y=null,b=null,N={size:()=>{y.width=parseInt(d[1]),y.height=parseInt(d[2])},format:()=>{},filter:()=>{y.minFilter=dr.enumValue($a,d[1]),y.magFilter=dr.enumValue($a,d[2])},repeat:()=>{-1!=d[1].indexOf("x")&&(y.uWrap=Nl.Repeat),-1!=d[1].indexOf("y")&&(y.vWrap=Nl.Repeat)},pma:()=>{y.pma="true"==d[1]}};var k={xy:()=>{b.x=parseInt(d[1]),b.y=parseInt(d[2])},size:()=>{b.width=parseInt(d[1]),b.height=parseInt(d[2])},bounds:()=>{b.x=parseInt(d[1]),b.y=parseInt(d[2]),b.width=parseInt(d[3]),b.height=parseInt(d[4])},offset:()=>{b.offsetX=parseInt(d[1]),b.offsetY=parseInt(d[2])},orig:()=>{b.originalWidth=parseInt(d[1]),b.originalHeight=parseInt(d[2])},offsets:()=>{b.offsetX=parseInt(d[1]),b.offsetY=parseInt(d[2]),b.originalWidth=parseInt(d[3]),b.originalHeight=parseInt(d[4])},rotate:()=>{let le=d[1];"true"==le?b.degrees=90:"false"!=le&&(b.degrees=parseInt(le))},index:()=>{b.index=parseInt(d[1])}};let T=h.readLine();for(;T&&0==T.trim().length;)T=h.readLine();for(;T&&0!=T.trim().length&&0!=h.readEntry(d,T);)T=h.readLine();let H=null,Y=null;for(;null!==T;)if(0==T.trim().length)y=null,T=h.readLine();else if(y){for(b=new Yd,b.page=y,b.name=T;;){let le=h.readEntry(d,T=h.readLine());if(0==le)break;let ae=k[d[0]];if(ae)ae();else{H||(H=[],Y=[]),H.push(d[0]);let ge=[];for(let we=0;we<le;we++)ge.push(parseInt(d[we+1]));Y.push(ge)}}0==b.originalWidth&&0==b.originalHeight&&(b.originalWidth=b.width,b.originalHeight=b.height),H&&H.length>0&&(b.names=H,b.values=Y,H=null,Y=null),b.u=b.x/y.width,b.v=b.y/y.height,90==b.degrees?(b.u2=(b.x+b.height)/y.width,b.v2=(b.y+b.width)/y.height):(b.u2=(b.x+b.width)/y.width,b.v2=(b.y+b.height)/y.height),this.regions.push(b)}else{for(y=new uf,y.name=T.trim();0!=h.readEntry(d,T=h.readLine());){let le=N[d[0]];le&&le()}this.pages.push(y)}}findRegion(r){for(let h=0;h<this.regions.length;h++)if(this.regions[h].name==r)return this.regions[h];return null}setTextures(r,h=""){for(let d of this.pages)d.setTexture(r.get(h+d.name))}dispose(){for(let r=0;r<this.pages.length;r++)this.pages[r].texture.dispose()}}class Xd{constructor(r){this.index=0,this.lines=r.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(r,h){if(!h||0==(h=h.trim()).length)return 0;let d=h.indexOf(":");if(-1==d)return 0;r[0]=h.substr(0,d).trim();for(let y=1,b=d+1;;y++){let N=h.indexOf(",",b);if(-1==N)return r[y]=h.substr(b).trim(),y;if(r[y]=h.substr(b,N-b).trim(),b=N+1,4==y)return 4}}}class uf{constructor(){this.minFilter=$a.Nearest,this.magFilter=$a.Nearest,this.uWrap=Nl.ClampToEdge,this.vWrap=Nl.ClampToEdge}setTexture(r){this.texture=r,r.setFilters(this.minFilter,this.magFilter),r.setWraps(this.uWrap,this.vWrap)}}class Yd extends lm{}class Ca extends Tu{constructor(r){super(r),this.color=new Kr(1,1,1,1),this.tempColor=new Kr(0,0,0,0)}updateUVs(){let r=this.regionUVs;this.uvs&&this.uvs.length==r.length||(this.uvs=dr.newFloatArray(r.length));let h=this.uvs,d=this.uvs.length,y=this.region.u,b=this.region.v,N=0,k=0;if(this.region instanceof Yd){let T=this.region,H=T.page.texture.getImage(),Y=H.width,le=H.height;switch(T.degrees){case 90:y-=(T.originalHeight-T.offsetY-T.height)/Y,b-=(T.originalWidth-T.offsetX-T.width)/le,N=T.originalHeight/Y,k=T.originalWidth/le;for(let ae=0;ae<d;ae+=2)h[ae]=y+r[ae+1]*N,h[ae+1]=b+(1-r[ae])*k;return;case 180:y-=(T.originalWidth-T.offsetX-T.width)/Y,b-=T.offsetY/le,N=T.originalWidth/Y,k=T.originalHeight/le;for(let ae=0;ae<d;ae+=2)h[ae]=y+(1-r[ae])*N,h[ae+1]=b+(1-r[ae+1])*k;return;case 270:y-=T.offsetY/Y,b-=T.offsetX/le,N=T.originalHeight/Y,k=T.originalWidth/le;for(let ae=0;ae<d;ae+=2)h[ae]=y+(1-r[ae+1])*N,h[ae+1]=b+r[ae]*k;return}y-=T.offsetX/Y,b-=(T.originalHeight-T.offsetY-T.height)/le,N=T.originalWidth/Y,k=T.originalHeight/le}else this.region?(N=this.region.u2-y,k=this.region.v2-b):(y=b=0,N=k=1);for(let T=0;T<d;T+=2)h[T]=y+r[T]*N,h[T+1]=b+r[T+1]*k}getParentMesh(){return this.parentMesh}setParentMesh(r){this.parentMesh=r,r&&(this.bones=r.bones,this.vertices=r.vertices,this.worldVerticesLength=r.worldVerticesLength,this.regionUVs=r.regionUVs,this.triangles=r.triangles,this.hullLength=r.hullLength,this.worldVerticesLength=r.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let r=new Ca(this.name);return r.region=this.region,r.path=this.path,r.color.setFromColor(this.color),this.copyTo(r),r.regionUVs=new Array(this.regionUVs.length),dr.arrayCopy(this.regionUVs,0,r.regionUVs,0,this.regionUVs.length),r.uvs=new Array(this.uvs.length),dr.arrayCopy(this.uvs,0,r.uvs,0,this.uvs.length),r.triangles=new Array(this.triangles.length),dr.arrayCopy(this.triangles,0,r.triangles,0,this.triangles.length),r.hullLength=this.hullLength,this.edges&&(r.edges=new Array(this.edges.length),dr.arrayCopy(this.edges,0,r.edges,0,this.edges.length)),r.width=this.width,r.height=this.height,r}newLinkedMesh(){let r=new Ca(this.name);return r.region=this.region,r.path=this.path,r.color.setFromColor(this.color),r.deformAttachment=this.deformAttachment,r.setParentMesh(this.parentMesh?this.parentMesh:this),r.updateUVs(),r}}class Kc extends Tu{constructor(r){super(r),this.closed=!1,this.constantSpeed=!1,this.color=new Kr(1,1,1,1)}copy(){let r=new Kc(this.name);return this.copyTo(r),r.lengths=new Array(this.lengths.length),dr.arrayCopy(this.lengths,0,r.lengths,0,this.lengths.length),r.closed=closed,r.constantSpeed=this.constantSpeed,r.color.setFromColor(this.color),r}}class wh extends Tu{constructor(r){super(r),this.color=new Kr(.38,.94,0,1)}computeWorldPosition(r,h){return h.x=this.x*r.a+this.y*r.b+r.worldX,h.y=this.x*r.c+this.y*r.d+r.worldY,h}computeWorldRotation(r){let h=Ln.cosDeg(this.rotation),d=Ln.sinDeg(this.rotation);return Math.atan2(h*r.c+d*r.d,h*r.a+d*r.b)*Ln.radDeg}copy(){let r=new wh(this.name);return r.x=this.x,r.y=this.y,r.rotation=this.rotation,r.color.setFromColor(this.color),r}}class _i extends Sf{constructor(r){super(r),this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new Kr(1,1,1,1),this.offset=dr.newFloatArray(8),this.uvs=dr.newFloatArray(8),this.tempColor=new Kr(1,1,1,1)}updateOffset(){let r=this.width/this.region.originalWidth*this.scaleX,h=this.height/this.region.originalHeight*this.scaleY,d=-this.width/2*this.scaleX+this.region.offsetX*r,y=-this.height/2*this.scaleY+this.region.offsetY*h,b=d+this.region.width*r,N=y+this.region.height*h,k=this.rotation*Math.PI/180,T=Math.cos(k),H=Math.sin(k),Y=this.x,le=this.y,ae=d*T+Y,ge=d*H,we=y*T+le,Se=y*H,$e=b*T+Y,Re=b*H,Pe=N*T+le,Oe=N*H,Fe=this.offset;Fe[0]=ae-Se,Fe[1]=we+ge,Fe[2]=ae-Oe,Fe[3]=Pe+ge,Fe[4]=$e-Oe,Fe[5]=Pe+Re,Fe[6]=$e-Se,Fe[7]=we+Re}setRegion(r){this.region=r;let h=this.uvs;90==r.degrees?(h[2]=r.u,h[3]=r.v2,h[4]=r.u,h[5]=r.v,h[6]=r.u2,h[7]=r.v,h[0]=r.u2,h[1]=r.v2):(h[0]=r.u,h[1]=r.v2,h[2]=r.u,h[3]=r.v,h[4]=r.u2,h[5]=r.v,h[6]=r.u2,h[7]=r.v2)}computeWorldVertices(r,h,d,y){let b=this.offset,N=r.worldX,k=r.worldY,T=r.a,H=r.b,Y=r.c,le=r.d,ae=0,ge=0;ae=b[0],ge=b[1],h[d]=ae*T+ge*H+N,h[d+1]=ae*Y+ge*le+k,ae=b[2],ge=b[3],h[d+=y]=ae*T+ge*H+N,h[d+1]=ae*Y+ge*le+k,ae=b[4],ge=b[5],h[d+=y]=ae*T+ge*H+N,h[d+1]=ae*Y+ge*le+k,ae=b[6],ge=b[7],h[d+=y]=ae*T+ge*H+N,h[d+1]=ae*Y+ge*le+k}copy(){let r=new _i(this.name);return r.region=this.region,r.rendererObject=this.rendererObject,r.path=this.path,r.x=this.x,r.y=this.y,r.scaleX=this.scaleX,r.scaleY=this.scaleY,r.rotation=this.rotation,r.width=this.width,r.height=this.height,dr.arrayCopy(this.uvs,0,r.uvs,0,8),dr.arrayCopy(this.offset,0,r.offset,0,8),r.color.setFromColor(this.color),r}}_i.X1=0,_i.Y1=1,_i.C1R=2,_i.C1G=3,_i.C1B=4,_i.C1A=5,_i.U1=6,_i.V1=7,_i.X2=8,_i.Y2=9,_i.C2R=10,_i.C2G=11,_i.C2B=12,_i.C2A=13,_i.U2=14,_i.V2=15,_i.X3=16,_i.Y3=17,_i.C3R=18,_i.C3G=19,_i.C3B=20,_i.C3A=21,_i.U3=22,_i.V3=23,_i.X4=24,_i.Y4=25,_i.C4R=26,_i.C4G=27,_i.C4B=28,_i.C4A=29,_i.U4=30,_i.V4=31;class Zp{constructor(r){this.atlas=r}newRegionAttachment(r,h,d){let y=this.atlas.findRegion(d);if(!y)throw new Error("Region not found in atlas: "+d+" (region attachment: "+h+")");y.renderObject=y;let b=new _i(h);return b.setRegion(y),b}newMeshAttachment(r,h,d){let y=this.atlas.findRegion(d);if(!y)throw new Error("Region not found in atlas: "+d+" (mesh attachment: "+h+")");y.renderObject=y;let b=new Ca(h);return b.region=y,b}newBoundingBoxAttachment(r,h){return new Hd(h)}newPathAttachment(r,h){return new Kc(h)}newPointAttachment(r,h){return new wh(h)}newClippingAttachment(r,h){return new bd(h)}}class Jd{constructor(r,h,d){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Kl.Normal,this.skinRequired=!1,this.color=new Kr,r<0)throw new Error("index must be >= 0.");if(!h)throw new Error("name cannot be null.");this.index=r,this.name=h,this.parent=d}}!function(a){a[a.Normal=0]="Normal",a[a.OnlyTranslation=1]="OnlyTranslation",a[a.NoRotationOrReflection=2]="NoRotationOrReflection",a[a.NoScale=3]="NoScale",a[a.NoScaleOrReflection=4]="NoScaleOrReflection"}(Kl||(Kl={}));class Qp{constructor(r,h,d){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.skeleton=h,this.parent=d,this.setToSetupPose()}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(r,h,d,y,b,N,k){this.ax=r,this.ay=h,this.arotation=d,this.ascaleX=y,this.ascaleY=b,this.ashearX=N,this.ashearY=k;let T=this.parent;if(!T){let ge=this.skeleton,we=d+90+k,Se=ge.scaleX,$e=ge.scaleY;return this.a=Ln.cosDeg(d+N)*y*Se,this.b=Ln.cosDeg(we)*b*Se,this.c=Ln.sinDeg(d+N)*y*$e,this.d=Ln.sinDeg(we)*b*$e,this.worldX=r*Se+ge.x,void(this.worldY=h*$e+ge.y)}let H=T.a,Y=T.b,le=T.c,ae=T.d;switch(this.worldX=H*r+Y*h+T.worldX,this.worldY=le*r+ae*h+T.worldY,this.data.transformMode){case Kl.Normal:{let ge=d+90+k,we=Ln.cosDeg(d+N)*y,Se=Ln.cosDeg(ge)*b,$e=Ln.sinDeg(d+N)*y,Re=Ln.sinDeg(ge)*b;return this.a=H*we+Y*$e,this.b=H*Se+Y*Re,this.c=le*we+ae*$e,void(this.d=le*Se+ae*Re)}case Kl.OnlyTranslation:{let ge=d+90+k;this.a=Ln.cosDeg(d+N)*y,this.b=Ln.cosDeg(ge)*b,this.c=Ln.sinDeg(d+N)*y,this.d=Ln.sinDeg(ge)*b;break}case Kl.NoRotationOrReflection:{let ge=H*H+le*le,we=0;ge>1e-4?(ge=Math.abs(H*ae-Y*le)/ge,H/=this.skeleton.scaleX,le/=this.skeleton.scaleY,Y=le*ge,ae=H*ge,we=Math.atan2(le,H)*Ln.radDeg):(H=0,le=0,we=90-Math.atan2(ae,Y)*Ln.radDeg);let Se=d+N-we,$e=d+k-we+90,Re=Ln.cosDeg(Se)*y,Pe=Ln.cosDeg($e)*b,Oe=Ln.sinDeg(Se)*y,Fe=Ln.sinDeg($e)*b;this.a=H*Re-Y*Oe,this.b=H*Pe-Y*Fe,this.c=le*Re+ae*Oe,this.d=le*Pe+ae*Fe;break}case Kl.NoScale:case Kl.NoScaleOrReflection:{let ge=Ln.cosDeg(d),we=Ln.sinDeg(d),Se=(H*ge+Y*we)/this.skeleton.scaleX,$e=(le*ge+ae*we)/this.skeleton.scaleY,Re=Math.sqrt(Se*Se+$e*$e);Re>1e-5&&(Re=1/Re),Se*=Re,$e*=Re,Re=Math.sqrt(Se*Se+$e*$e),this.data.transformMode==Kl.NoScale&&H*ae-Y*le<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(Re=-Re);let Pe=Math.PI/2+Math.atan2($e,Se),Oe=Math.cos(Pe)*Re,Fe=Math.sin(Pe)*Re,De=Ln.cosDeg(N)*y,Qe=Ln.cosDeg(90+k)*b,it=Ln.sinDeg(N)*y,ct=Ln.sinDeg(90+k)*b;this.a=Se*De+Oe*it,this.b=Se*Qe+Oe*ct,this.c=$e*De+Fe*it,this.d=$e*Qe+Fe*ct;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let r=this.data;this.x=r.x,this.y=r.y,this.rotation=r.rotation,this.scaleX=r.scaleX,this.scaleY=r.scaleY,this.shearX=r.shearX,this.shearY=r.shearY}getWorldRotationX(){return Math.atan2(this.c,this.a)*Ln.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*Ln.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}updateAppliedTransform(){let r=this.parent;if(!r)return this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*Ln.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*Ln.radDeg);let h=r.a,d=r.b,y=r.c,b=r.d,N=1/(h*b-d*y),k=this.worldX-r.worldX,T=this.worldY-r.worldY;this.ax=k*b*N-T*d*N,this.ay=T*h*N-k*y*N;let H=N*b,Y=N*h,le=N*d,ae=N*y,ge=H*this.a-le*this.c,we=H*this.b-le*this.d,Se=Y*this.c-ae*this.a,$e=Y*this.d-ae*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(ge*ge+Se*Se),this.ascaleX>1e-4){let Re=ge*$e-we*Se;this.ascaleY=Re/this.ascaleX,this.ashearY=Math.atan2(ge*we+Se*$e,Re)*Ln.radDeg,this.arotation=Math.atan2(Se,ge)*Ln.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(we*we+$e*$e),this.ashearY=0,this.arotation=90-Math.atan2($e,we)*Ln.radDeg}worldToLocal(r){let h=1/(this.a*this.d-this.b*this.c),d=r.x-this.worldX,y=r.y-this.worldY;return r.x=d*this.d*h-y*this.b*h,r.y=y*this.a*h-d*this.c*h,r}localToWorld(r){let h=r.x,d=r.y;return r.x=h*this.a+d*this.b+this.worldX,r.y=h*this.c+d*this.d+this.worldY,r}worldToLocalRotation(r){let h=Ln.sinDeg(r),d=Ln.cosDeg(r);return Math.atan2(this.a*h-this.c*d,this.d*d-this.b*h)*Ln.radDeg+this.rotation-this.shearX}localToWorldRotation(r){let h=Ln.sinDeg(r-=this.rotation-this.shearX),d=Ln.cosDeg(r);return Math.atan2(d*this.c+h*this.d,d*this.a+h*this.b)*Ln.radDeg}rotateWorld(r){let h=this.a,d=this.b,y=this.c,b=this.d,N=Ln.cosDeg(r),k=Ln.sinDeg(r);this.a=N*h-k*y,this.b=N*d-k*b,this.c=k*h+N*y,this.d=k*d+N*b}}class xd{constructor(r,h){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.mix=r.mix,this.softness=r.softness,this.bendDirection=r.bendDirection,this.compress=r.compress,this.stretch=r.stretch,this.bones=new Array;for(let d=0;d<r.bones.length;d++)this.bones.push(h.findBone(r.bones[d].name));this.target=h.findBone(r.target.name)}isActive(){return this.active}update(){if(0==this.mix)return;let r=this.target,h=this.bones;switch(h.length){case 1:this.apply1(h[0],r.worldX,r.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(h[0],h[1],r.worldX,r.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(r,h,d,y,b,N,k){let T=r.parent,H=T.a,Y=T.b,le=T.c,ae=T.d,ge=-r.ashearX-r.arotation,we=0,Se=0;switch(r.data.transformMode){case Kl.OnlyTranslation:we=h-r.worldX,Se=d-r.worldY;break;case Kl.NoRotationOrReflection:let Pe=Math.abs(H*ae-Y*le)/(H*H+le*le),Oe=H/r.skeleton.scaleX,Fe=le/r.skeleton.scaleY;Y=-Fe*Pe*r.skeleton.scaleX,ae=Oe*Pe*r.skeleton.scaleY,ge+=Math.atan2(Fe,Oe)*Ln.radDeg;default:let De=h-T.worldX,Qe=d-T.worldY,it=H*ae-Y*le;we=(De*ae-Qe*Y)/it-r.ax,Se=(Qe*H-De*le)/it-r.ay}ge+=Math.atan2(Se,we)*Ln.radDeg,r.ascaleX<0&&(ge+=180),ge>180?ge-=360:ge<-180&&(ge+=360);let $e=r.ascaleX,Re=r.ascaleY;if(y||b){switch(r.data.transformMode){case Kl.NoScale:case Kl.NoScaleOrReflection:we=h-r.worldX,Se=d-r.worldY}let Pe=r.data.length*$e,Oe=Math.sqrt(we*we+Se*Se);if(y&&Oe<Pe||b&&Oe>Pe&&Pe>1e-4){let Fe=(Oe/Pe-1)*k+1;$e*=Fe,N&&(Re*=Fe)}}r.updateWorldTransformWith(r.ax,r.ay,r.arotation+ge*k,$e,Re,r.ashearX,r.ashearY)}apply2(r,h,d,y,b,N,k,T,H){let Y=r.ax,le=r.ay,ae=r.ascaleX,ge=r.ascaleY,we=ae,Se=ge,$e=h.ascaleX,Re=0,Pe=0,Oe=0;ae<0?(ae=-ae,Re=180,Oe=-1):(Re=0,Oe=1),ge<0&&(ge=-ge,Oe=-Oe),$e<0?($e=-$e,Pe=180):Pe=0;let Fe=h.ax,De=0,Qe=0,it=0,ct=r.a,_t=r.b,$t=r.c,rn=r.d,Dt=Math.abs(ae-ge)<=1e-4;!Dt||N?(De=0,Qe=ct*Fe+r.worldX,it=$t*Fe+r.worldY):(De=h.ay,Qe=ct*Fe+_t*De+r.worldX,it=$t*Fe+rn*De+r.worldY);let Lt=r.parent;ct=Lt.a,_t=Lt.b,$t=Lt.c,rn=Lt.d;let Ct,ut,Tt=1/(ct*rn-_t*$t),Qt=Qe-Lt.worldX,vn=it-Lt.worldY,gn=(Qt*rn-vn*_t)*Tt-Y,fr=(vn*ct-Qt*$t)*Tt-le,sr=Math.sqrt(gn*gn+fr*fr),Rn=h.data.length*$e;if(sr<1e-4)return this.apply1(r,d,y,!1,N,!1,H),void h.updateWorldTransformWith(Fe,De,0,h.ascaleX,h.ascaleY,h.ashearX,h.ashearY);Qt=d-Lt.worldX,vn=y-Lt.worldY;let Jn=(Qt*rn-vn*_t)*Tt-Y,Kn=(vn*ct-Qt*$t)*Tt-le,Er=Jn*Jn+Kn*Kn;if(0!=T){T*=ae*($e+1)*.5;let fo=Math.sqrt(Er),Vo=fo-sr-Rn*ae+T;if(Vo>0){let Uo=Math.min(1,Vo/(2*T))-1;Uo=(Vo-T*(1-Uo*Uo))/fo,Jn-=Uo*Jn,Kn-=Uo*Kn,Er=Jn*Jn+Kn*Kn}}e:if(Dt){Rn*=ae;let fo=(Er-sr*sr-Rn*Rn)/(2*sr*Rn);fo<-1?(fo=-1,ut=Math.PI*b):fo>1?(fo=1,ut=0,N&&(ct=(Math.sqrt(Er)/(sr+Rn)-1)*H+1,we*=ct,k&&(Se*=ct))):ut=Math.acos(fo)*b,ct=sr+Rn*fo,_t=Rn*Math.sin(ut),Ct=Math.atan2(Kn*ct-Jn*_t,Jn*ct+Kn*_t)}else{ct=ae*Rn,_t=ge*Rn;let fo=ct*ct,Vo=_t*_t,Uo=Math.atan2(Kn,Jn);$t=Vo*sr*sr+fo*Er-fo*Vo;let Gs=-2*Vo*sr,hs=Vo-fo;if(rn=Gs*Gs-4*hs*$t,rn>=0){let Oc=Math.sqrt(rn);Gs<0&&(Oc=-Oc),Oc=.5*-(Gs+Oc);let ap=Oc/hs,au=$t/Oc,Na=Math.abs(ap)<Math.abs(au)?ap:au;if(Na*Na<=Er){vn=Math.sqrt(Er-Na*Na)*b,Ct=Uo-Math.atan2(vn,Na),ut=Math.atan2(vn/ge,(Na-sr)/ae);break e}}let ps=Ln.PI,ds=sr-ct,Ic=ds*ds,ad=0,Up=0,ip=sr+ct,sp=ip*ip,Ad=0;$t=-ct*sr/(fo-Vo),$t>=-1&&$t<=1&&($t=Math.acos($t),Qt=ct*Math.cos($t)+sr,vn=_t*Math.sin($t),rn=Qt*Qt+vn*vn,rn<Ic&&(ps=$t,Ic=rn,ds=Qt,ad=vn),rn>sp&&(Up=$t,sp=rn,ip=Qt,Ad=vn)),Er<=.5*(Ic+sp)?(Ct=Uo-Math.atan2(ad*b,ds),ut=ps*b):(Ct=Uo-Math.atan2(Ad*b,ip),ut=Up*b)}let vi=Math.atan2(De,Fe)*Oe,no=r.arotation;Ct=(Ct-vi)*Ln.radDeg+Re-no,Ct>180?Ct-=360:Ct<-180&&(Ct+=360),r.updateWorldTransformWith(Y,le,no+Ct*H,we,Se,0,0),no=h.arotation,ut=((ut+vi)*Ln.radDeg-h.ashearX)*Oe+Pe-no,ut>180?ut-=360:ut<-180&&(ut+=360),h.updateWorldTransformWith(Fe,De,no+ut*H,h.ascaleX,h.ascaleY,h.ashearX,h.ashearY)}}class Rp{constructor(r,h,d){this.name=r,this.order=h,this.skinRequired=d}}class wd extends Rp{constructor(r){super(r,0,!1),this.bones=new Array,this.mixRotate=0,this.mixX=0,this.mixY=0}}(Mu=Np||(Np={}))[Mu.Fixed=0]="Fixed",Mu[Mu.Percent=1]="Percent",(tc=ec||(ec={}))[tc.Length=0]="Length",tc[tc.Fixed=1]="Fixed",tc[tc.Percent=2]="Percent",tc[tc.Proportional=3]="Proportional",function(a){a[a.Tangent=0]="Tangent",a[a.Chain=1]="Chain",a[a.ChainScale=2]="ChainScale"}(Jp||(Jp={}));class Rl{constructor(r,h){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.bones=new Array;for(let d=0,y=r.bones.length;d<y;d++)this.bones.push(h.findBone(r.bones[d].name));this.target=h.findSlot(r.target.name),this.position=r.position,this.spacing=r.spacing,this.mixRotate=r.mixRotate,this.mixX=r.mixX,this.mixY=r.mixY}isActive(){return this.active}update(){let r=this.target.getAttachment();if(!(r instanceof Kc))return;let h=this.mixRotate,d=this.mixX,y=this.mixY;if(0==h&&0==d&&0==y)return;let b=this.data,N=b.rotateMode==Jp.Tangent,k=b.rotateMode==Jp.ChainScale,T=this.bones,H=T.length,Y=N?H:H+1,le=dr.setArraySize(this.spaces,Y),ae=k?this.lengths=dr.setArraySize(this.lengths,H):null,ge=this.spacing;switch(b.spacingMode){case ec.Percent:if(k)for(let De=0,Qe=Y-1;De<Qe;De++){let it=T[De],ct=it.data.length;if(ct<Rl.epsilon)ae[De]=0;else{let _t=ct*it.a,$t=ct*it.c;ae[De]=Math.sqrt(_t*_t+$t*$t)}}dr.arrayFill(le,1,Y,ge);break;case ec.Proportional:let Oe=0;for(let De=0,Qe=Y-1;De<Qe;){let it=T[De],ct=it.data.length;if(ct<Rl.epsilon)k&&(ae[De]=0),le[++De]=ge;else{let _t=ct*it.a,$t=ct*it.c,rn=Math.sqrt(_t*_t+$t*$t);k&&(ae[De]=rn),le[++De]=rn,Oe+=rn}}if(Oe>0){Oe=Y/Oe*ge;for(let De=1;De<Y;De++)le[De]*=Oe}break;default:let Fe=b.spacingMode==ec.Length;for(let De=0,Qe=Y-1;De<Qe;){let it=T[De],ct=it.data.length;if(ct<Rl.epsilon)k&&(ae[De]=0),le[++De]=ge;else{let _t=ct*it.a,$t=ct*it.c,rn=Math.sqrt(_t*_t+$t*$t);k&&(ae[De]=rn),le[++De]=(Fe?ct+ge:ge)*rn/ct}}}let we=this.computeWorldPositions(r,Y,N),Se=we[0],$e=we[1],Re=b.offsetRotation,Pe=!1;if(0==Re)Pe=b.rotateMode==Jp.Chain;else{Pe=!1;let Oe=this.target.bone;Re*=Oe.a*Oe.d-Oe.b*Oe.c>0?Ln.degRad:-Ln.degRad}for(let Oe=0,Fe=3;Oe<H;Oe++,Fe+=3){let De=T[Oe];De.worldX+=(Se-De.worldX)*d,De.worldY+=($e-De.worldY)*y;let Qe=we[Fe],it=we[Fe+1],ct=Qe-Se,_t=it-$e;if(k){let $t=ae[Oe];if(0!=$t){let rn=(Math.sqrt(ct*ct+_t*_t)/$t-1)*h+1;De.a*=rn,De.c*=rn}}if(Se=Qe,$e=it,h>0){let $t=De.a,rn=De.b,Dt=De.c,Lt=De.d,Ct=0,ut=0,Tt=0;if(Ct=N?we[Fe-1]:0==le[Oe+1]?we[Fe+2]:Math.atan2(_t,ct),Ct-=Math.atan2(Dt,$t),Pe){ut=Math.cos(Ct),Tt=Math.sin(Ct);let Qt=De.data.length;Se+=(Qt*(ut*$t-Tt*Dt)-ct)*h,$e+=(Qt*(Tt*$t+ut*Dt)-_t)*h}else Ct+=Re;Ct>Ln.PI?Ct-=Ln.PI2:Ct<-Ln.PI&&(Ct+=Ln.PI2),Ct*=h,ut=Math.cos(Ct),Tt=Math.sin(Ct),De.a=ut*$t-Tt*Dt,De.b=ut*rn-Tt*Lt,De.c=Tt*$t+ut*Dt,De.d=Tt*rn+ut*Lt}De.updateAppliedTransform()}}computeWorldPositions(r,h,d){let y=this.target,b=this.position,N=this.spaces,k=dr.setArraySize(this.positions,3*h+2),T=null,H=r.closed,Y=r.worldVerticesLength,le=Y/6,ae=Rl.NONE;if(!r.constantSpeed){let vn=r.lengths;le-=H?1:2;let gn,fr=vn[le];switch(this.data.positionMode==Np.Percent&&(b*=fr),this.data.spacingMode){case ec.Percent:gn=fr;break;case ec.Proportional:gn=fr/h;break;default:gn=1}T=dr.setArraySize(this.world,8);for(let sr=0,Rn=0,Jn=0;sr<h;sr++,Rn+=3){let Kn=N[sr]*gn;b+=Kn;let Er=b;if(H)Er%=fr,Er<0&&(Er+=fr),Jn=0;else{if(Er<0){ae!=Rl.BEFORE&&(ae=Rl.BEFORE,r.computeWorldVertices(y,2,4,T,0,2)),this.addBeforePosition(Er,T,0,k,Rn);continue}if(Er>fr){ae!=Rl.AFTER&&(ae=Rl.AFTER,r.computeWorldVertices(y,Y-6,4,T,0,2)),this.addAfterPosition(Er-fr,T,0,k,Rn);continue}}for(;;Jn++){let vi=vn[Jn];if(!(Er>vi)){if(0==Jn)Er/=vi;else{let no=vn[Jn-1];Er=(Er-no)/(vi-no)}break}}Jn!=ae&&(ae=Jn,H&&Jn==le?(r.computeWorldVertices(y,Y-4,4,T,0,2),r.computeWorldVertices(y,0,4,T,4,2)):r.computeWorldVertices(y,6*Jn+2,8,T,0,2)),this.addCurvePosition(Er,T[0],T[1],T[2],T[3],T[4],T[5],T[6],T[7],k,Rn,d||sr>0&&0==Kn)}return k}H?(Y+=2,T=dr.setArraySize(this.world,Y),r.computeWorldVertices(y,2,Y-4,T,0,2),r.computeWorldVertices(y,0,2,T,Y-4,2),T[Y-2]=T[0],T[Y-1]=T[1]):(le--,Y-=4,T=dr.setArraySize(this.world,Y),r.computeWorldVertices(y,2,Y,T,0,2));let ge,we=dr.setArraySize(this.curves,le),Se=0,$e=T[0],Re=T[1],Pe=0,Oe=0,Fe=0,De=0,Qe=0,it=0,ct=0,_t=0,$t=0,rn=0,Dt=0,Lt=0,Ct=0,ut=0;for(let vn=0,gn=2;vn<le;vn++,gn+=6)Pe=T[gn],Oe=T[gn+1],Fe=T[gn+2],De=T[gn+3],Qe=T[gn+4],it=T[gn+5],ct=.1875*($e-2*Pe+Fe),_t=.1875*(Re-2*Oe+De),$t=.09375*(3*(Pe-Fe)-$e+Qe),rn=.09375*(3*(Oe-De)-Re+it),Dt=2*ct+$t,Lt=2*_t+rn,Ct=.75*(Pe-$e)+ct+.16666667*$t,ut=.75*(Oe-Re)+_t+.16666667*rn,Se+=Math.sqrt(Ct*Ct+ut*ut),Ct+=Dt,ut+=Lt,Dt+=$t,Lt+=rn,Se+=Math.sqrt(Ct*Ct+ut*ut),Ct+=Dt,ut+=Lt,Se+=Math.sqrt(Ct*Ct+ut*ut),Ct+=Dt+$t,ut+=Lt+rn,Se+=Math.sqrt(Ct*Ct+ut*ut),we[vn]=Se,$e=Qe,Re=it;switch(this.data.positionMode==Np.Percent&&(b*=Se),this.data.spacingMode){case ec.Percent:ge=Se;break;case ec.Proportional:ge=Se/h;break;default:ge=1}let Tt=this.segments,Qt=0;for(let vn=0,gn=0,fr=0,sr=0;vn<h;vn++,gn+=3){let Rn=N[vn]*ge;b+=Rn;let Jn=b;if(H)Jn%=Se,Jn<0&&(Jn+=Se),fr=0;else{if(Jn<0){this.addBeforePosition(Jn,T,0,k,gn);continue}if(Jn>Se){this.addAfterPosition(Jn-Se,T,Y-4,k,gn);continue}}for(;;fr++){let Kn=we[fr];if(!(Jn>Kn)){if(0==fr)Jn/=Kn;else{let Er=we[fr-1];Jn=(Jn-Er)/(Kn-Er)}break}}if(fr!=ae){ae=fr;let Kn=6*fr;for($e=T[Kn],Re=T[Kn+1],Pe=T[Kn+2],Oe=T[Kn+3],Fe=T[Kn+4],De=T[Kn+5],Qe=T[Kn+6],it=T[Kn+7],ct=.03*($e-2*Pe+Fe),_t=.03*(Re-2*Oe+De),$t=.006*(3*(Pe-Fe)-$e+Qe),rn=.006*(3*(Oe-De)-Re+it),Dt=2*ct+$t,Lt=2*_t+rn,Ct=.3*(Pe-$e)+ct+.16666667*$t,ut=.3*(Oe-Re)+_t+.16666667*rn,Qt=Math.sqrt(Ct*Ct+ut*ut),Tt[0]=Qt,Kn=1;Kn<8;Kn++)Ct+=Dt,ut+=Lt,Dt+=$t,Lt+=rn,Qt+=Math.sqrt(Ct*Ct+ut*ut),Tt[Kn]=Qt;Ct+=Dt,ut+=Lt,Qt+=Math.sqrt(Ct*Ct+ut*ut),Tt[8]=Qt,Ct+=Dt+$t,ut+=Lt+rn,Qt+=Math.sqrt(Ct*Ct+ut*ut),Tt[9]=Qt,sr=0}for(Jn*=Qt;;sr++){let Kn=Tt[sr];if(!(Jn>Kn)){if(0==sr)Jn/=Kn;else{let Er=Tt[sr-1];Jn=sr+(Jn-Er)/(Kn-Er)}break}}this.addCurvePosition(.1*Jn,$e,Re,Pe,Oe,Fe,De,Qe,it,k,gn,d||vn>0&&0==Rn)}return k}addBeforePosition(r,h,d,y,b){let N=h[d],k=h[d+1],Y=Math.atan2(h[d+3]-k,h[d+2]-N);y[b]=N+r*Math.cos(Y),y[b+1]=k+r*Math.sin(Y),y[b+2]=Y}addAfterPosition(r,h,d,y,b){let N=h[d+2],k=h[d+3],Y=Math.atan2(k-h[d+1],N-h[d]);y[b]=N+r*Math.cos(Y),y[b+1]=k+r*Math.sin(Y),y[b+2]=Y}addCurvePosition(r,h,d,y,b,N,k,T,H,Y,le,ae){if(0==r||isNaN(r))return Y[le]=h,Y[le+1]=d,void(Y[le+2]=Math.atan2(b-d,y-h));let ge=r*r,we=ge*r,Se=1-r,$e=Se*Se,Re=$e*Se,Pe=Se*r,Oe=3*Pe,Fe=Se*Oe,De=Oe*r,Qe=h*Re+y*Fe+N*De+T*we,it=d*Re+b*Fe+k*De+H*we;Y[le]=Qe,Y[le+1]=it,ae&&(Y[le+2]=r<.001?Math.atan2(b-d,y-h):Math.atan2(it-(d*$e+b*Pe*2+k*ge),Qe-(h*$e+y*Pe*2+N*ge)))}}Rl.NONE=-1,Rl.BEFORE=-2,Rl.AFTER=-3,Rl.epsilon=1e-5;class hf{constructor(r,h){if(this.deform=new Array,!r)throw new Error("data cannot be null.");if(!h)throw new Error("bone cannot be null.");this.data=r,this.bone=h,this.color=new Kr,this.darkColor=r.darkColor?new Kr:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(r){this.attachment!=r&&(r instanceof Tu&&this.attachment instanceof Tu&&r.deformAttachment==this.attachment.deformAttachment||(this.deform.length=0),this.attachment=r,this.attachmentTime=this.bone.skeleton.time)}setAttachmentTime(r){this.attachmentTime=this.bone.skeleton.time-r}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class Zd{constructor(r,h){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new lf,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.mixRotate=r.mixRotate,this.mixX=r.mixX,this.mixY=r.mixY,this.mixScaleX=r.mixScaleX,this.mixScaleY=r.mixScaleY,this.mixShearY=r.mixShearY,this.bones=new Array;for(let d=0;d<r.bones.length;d++)this.bones.push(h.findBone(r.bones[d].name));this.target=h.findBone(r.target.name)}isActive(){return this.active}update(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleX&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let r=this.mixRotate,h=this.mixX,d=this.mixY,y=this.mixScaleX,b=this.mixScaleY,N=this.mixShearY,k=0!=h||0!=d,T=this.target,H=T.a,Y=T.b,le=T.c,ae=T.d,ge=H*ae-Y*le>0?Ln.degRad:-Ln.degRad,we=this.data.offsetRotation*ge,Se=this.data.offsetShearY*ge,$e=this.bones;for(let Re=0,Pe=$e.length;Re<Pe;Re++){let Oe=$e[Re];if(0!=r){let Fe=Oe.a,De=Oe.b,Qe=Oe.c,it=Oe.d,ct=Math.atan2(le,H)-Math.atan2(Qe,Fe)+we;ct>Ln.PI?ct-=Ln.PI2:ct<-Ln.PI&&(ct+=Ln.PI2),ct*=r;let _t=Math.cos(ct),$t=Math.sin(ct);Oe.a=_t*Fe-$t*Qe,Oe.b=_t*De-$t*it,Oe.c=$t*Fe+_t*Qe,Oe.d=$t*De+_t*it}if(k){let Fe=this.temp;T.localToWorld(Fe.set(this.data.offsetX,this.data.offsetY)),Oe.worldX+=(Fe.x-Oe.worldX)*h,Oe.worldY+=(Fe.y-Oe.worldY)*d}if(0!=y){let Fe=Math.sqrt(Oe.a*Oe.a+Oe.c*Oe.c);0!=Fe&&(Fe=(Fe+(Math.sqrt(H*H+le*le)-Fe+this.data.offsetScaleX)*y)/Fe),Oe.a*=Fe,Oe.c*=Fe}if(0!=b){let Fe=Math.sqrt(Oe.b*Oe.b+Oe.d*Oe.d);0!=Fe&&(Fe=(Fe+(Math.sqrt(Y*Y+ae*ae)-Fe+this.data.offsetScaleY)*b)/Fe),Oe.b*=Fe,Oe.d*=Fe}if(N>0){let Fe=Oe.b,De=Oe.d,Qe=Math.atan2(De,Fe),it=Math.atan2(ae,Y)-Math.atan2(le,H)-(Qe-Math.atan2(Oe.c,Oe.a));it>Ln.PI?it-=Ln.PI2:it<-Ln.PI&&(it+=Ln.PI2),it=Qe+(it+Se)*N;let ct=Math.sqrt(Fe*Fe+De*De);Oe.b=Math.cos(it)*ct,Oe.d=Math.sin(it)*ct}Oe.updateAppliedTransform()}}applyRelativeWorld(){let r=this.mixRotate,h=this.mixX,d=this.mixY,y=this.mixScaleX,b=this.mixScaleY,N=this.mixShearY,k=0!=h||0!=d,T=this.target,H=T.a,Y=T.b,le=T.c,ae=T.d,ge=H*ae-Y*le>0?Ln.degRad:-Ln.degRad,we=this.data.offsetRotation*ge,Se=this.data.offsetShearY*ge,$e=this.bones;for(let Re=0,Pe=$e.length;Re<Pe;Re++){let Oe=$e[Re];if(0!=r){let Fe=Oe.a,De=Oe.b,Qe=Oe.c,it=Oe.d,ct=Math.atan2(le,H)+we;ct>Ln.PI?ct-=Ln.PI2:ct<-Ln.PI&&(ct+=Ln.PI2),ct*=r;let _t=Math.cos(ct),$t=Math.sin(ct);Oe.a=_t*Fe-$t*Qe,Oe.b=_t*De-$t*it,Oe.c=$t*Fe+_t*Qe,Oe.d=$t*De+_t*it}if(k){let Fe=this.temp;T.localToWorld(Fe.set(this.data.offsetX,this.data.offsetY)),Oe.worldX+=Fe.x*h,Oe.worldY+=Fe.y*d}if(0!=y){let Fe=(Math.sqrt(H*H+le*le)-1+this.data.offsetScaleX)*y+1;Oe.a*=Fe,Oe.c*=Fe}if(0!=b){let Fe=(Math.sqrt(Y*Y+ae*ae)-1+this.data.offsetScaleY)*b+1;Oe.b*=Fe,Oe.d*=Fe}if(N>0){let Fe=Math.atan2(ae,Y)-Math.atan2(le,H);Fe>Ln.PI?Fe-=Ln.PI2:Fe<-Ln.PI&&(Fe+=Ln.PI2);let De=Oe.b,Qe=Oe.d;Fe=Math.atan2(Qe,De)+(Fe-Ln.PI/2+Se)*N;let it=Math.sqrt(De*De+Qe*Qe);Oe.b=Math.cos(Fe)*it,Oe.d=Math.sin(Fe)*it}Oe.updateAppliedTransform()}}applyAbsoluteLocal(){let r=this.mixRotate,h=this.mixX,d=this.mixY,y=this.mixScaleX,b=this.mixScaleY,N=this.mixShearY,k=this.target,T=this.bones;for(let H=0,Y=T.length;H<Y;H++){let le=T[H],ae=le.arotation;if(0!=r){let Pe=k.arotation-ae+this.data.offsetRotation;Pe-=360*(16384-(16384.499999999996-Pe/360|0)),ae+=Pe*r}let ge=le.ax,we=le.ay;ge+=(k.ax-ge+this.data.offsetX)*h,we+=(k.ay-we+this.data.offsetY)*d;let Se=le.ascaleX,$e=le.ascaleY;0!=y&&0!=Se&&(Se=(Se+(k.ascaleX-Se+this.data.offsetScaleX)*y)/Se),0!=b&&0!=$e&&($e=($e+(k.ascaleY-$e+this.data.offsetScaleY)*b)/$e);let Re=le.ashearY;if(0!=N){let Pe=k.ashearY-Re+this.data.offsetShearY;Pe-=360*(16384-(16384.499999999996-Pe/360|0)),Re+=Pe*N}le.updateWorldTransformWith(ge,we,ae,Se,$e,le.ashearX,Re)}}applyRelativeLocal(){let r=this.mixRotate,h=this.mixX,d=this.mixY,y=this.mixScaleX,b=this.mixScaleY,N=this.mixShearY,k=this.target,T=this.bones;for(let H=0,Y=T.length;H<Y;H++){let le=T[H];le.updateWorldTransformWith(le.ax+(k.ax+this.data.offsetX)*h,le.ay+(k.ay+this.data.offsetY)*d,le.arotation+(k.arotation+this.data.offsetRotation)*r,le.ascaleX*((k.ascaleX-1+this.data.offsetScaleX)*y+1),le.ascaleY*((k.ascaleY-1+this.data.offsetScaleY)*b+1),le.ashearX,le.ashearY+(k.ashearY+this.data.offsetShearY)*N)}}}class pf{constructor(r){if(this._updateCache=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!r)throw new Error("data cannot be null.");this.data=r,this.bones=new Array;for(let h=0;h<r.bones.length;h++){let d,y=r.bones[h];if(y.parent){let b=this.bones[y.parent.index];d=new Qp(y,this,b),b.children.push(d)}else d=new Qp(y,this,null);this.bones.push(d)}this.slots=new Array,this.drawOrder=new Array;for(let h=0;h<r.slots.length;h++){let d=r.slots[h],b=new hf(d,this.bones[d.boneData.index]);this.slots.push(b),this.drawOrder.push(b)}this.ikConstraints=new Array;for(let h=0;h<r.ikConstraints.length;h++)this.ikConstraints.push(new xd(r.ikConstraints[h],this));this.transformConstraints=new Array;for(let h=0;h<r.transformConstraints.length;h++)this.transformConstraints.push(new Zd(r.transformConstraints[h],this));this.pathConstraints=new Array;for(let h=0;h<r.pathConstraints.length;h++)this.pathConstraints.push(new Rl(r.pathConstraints[h],this));this.color=new Kr(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;let r=this.bones;for(let H=0,Y=r.length;H<Y;H++){let le=r[H];le.sorted=le.data.skinRequired,le.active=!le.sorted}if(this.skin){let H=this.skin.bones;for(let Y=0,le=this.skin.bones.length;Y<le;Y++){let ae=this.bones[H[Y].index];do{ae.sorted=!1,ae.active=!0,ae=ae.parent}while(ae)}}let h=this.ikConstraints,d=this.transformConstraints,y=this.pathConstraints,b=h.length,N=d.length,k=y.length,T=b+N+k;e:for(let H=0;H<T;H++){for(let Y=0;Y<b;Y++){let le=h[Y];if(le.data.order==H){this.sortIkConstraint(le);continue e}}for(let Y=0;Y<N;Y++){let le=d[Y];if(le.data.order==H){this.sortTransformConstraint(le);continue e}}for(let Y=0;Y<k;Y++){let le=y[Y];if(le.data.order==H){this.sortPathConstraint(le);continue e}}}for(let H=0,Y=r.length;H<Y;H++)this.sortBone(r[H])}sortIkConstraint(r){if(r.active=r.target.isActive()&&(!r.data.skinRequired||this.skin&&dr.contains(this.skin.constraints,r.data,!0)),!r.active)return;this.sortBone(r.target);let d=r.bones,y=d[0];if(this.sortBone(y),1==d.length)this._updateCache.push(r),this.sortReset(y.children);else{let b=d[d.length-1];this.sortBone(b),this._updateCache.push(r),this.sortReset(y.children),b.sorted=!0}}sortPathConstraint(r){if(r.active=r.target.bone.isActive()&&(!r.data.skinRequired||this.skin&&dr.contains(this.skin.constraints,r.data,!0)),!r.active)return;let h=r.target,d=h.data.index,y=h.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,d,y),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,d,y);for(let T=0,H=this.data.skins.length;T<H;T++)this.sortPathConstraintAttachment(this.data.skins[T],d,y);let b=h.getAttachment();b instanceof Kc&&this.sortPathConstraintAttachmentWith(b,y);let N=r.bones,k=N.length;for(let T=0;T<k;T++)this.sortBone(N[T]);this._updateCache.push(r);for(let T=0;T<k;T++)this.sortReset(N[T].children);for(let T=0;T<k;T++)N[T].sorted=!0}sortTransformConstraint(r){if(r.active=r.target.isActive()&&(!r.data.skinRequired||this.skin&&dr.contains(this.skin.constraints,r.data,!0)),!r.active)return;this.sortBone(r.target);let h=r.bones,d=h.length;if(r.data.local)for(let y=0;y<d;y++){let b=h[y];this.sortBone(b.parent),this.sortBone(b)}else for(let y=0;y<d;y++)this.sortBone(h[y]);this._updateCache.push(r);for(let y=0;y<d;y++)this.sortReset(h[y].children);for(let y=0;y<d;y++)h[y].sorted=!0}sortPathConstraintAttachment(r,h,d){let y=r.attachments[h];if(y)for(let b in y)this.sortPathConstraintAttachmentWith(y[b],d)}sortPathConstraintAttachmentWith(r,h){if(!(r instanceof Kc))return;let d=r.bones;if(d){let y=this.bones;for(let b=0,N=d.length;b<N;){let k=d[b++];for(k+=b;b<k;)this.sortBone(y[d[b++]])}}else this.sortBone(h)}sortBone(r){if(r.sorted)return;let h=r.parent;h&&this.sortBone(h),r.sorted=!0,this._updateCache.push(r)}sortReset(r){for(let h=0,d=r.length;h<d;h++){let y=r[h];y.active&&(y.sorted&&this.sortReset(y.children),y.sorted=!1)}}updateWorldTransform(){let r=this.bones;for(let d=0,y=r.length;d<y;d++){let b=r[d];b.ax=b.x,b.ay=b.y,b.arotation=b.rotation,b.ascaleX=b.scaleX,b.ascaleY=b.scaleY,b.ashearX=b.shearX,b.ashearY=b.shearY}let h=this._updateCache;for(let d=0,y=h.length;d<y;d++)h[d].update()}updateWorldTransformWith(r){let h=this.getRootBone(),d=r.a,y=r.b,b=r.c,N=r.d;h.worldX=d*this.x+y*this.y+r.worldX,h.worldY=b*this.x+N*this.y+r.worldY;let k=h.rotation+90+h.shearY,T=Ln.cosDeg(h.rotation+h.shearX)*h.scaleX,H=Ln.cosDeg(k)*h.scaleY,Y=Ln.sinDeg(h.rotation+h.shearX)*h.scaleX,le=Ln.sinDeg(k)*h.scaleY;h.a=(d*T+y*Y)*this.scaleX,h.b=(d*H+y*le)*this.scaleX,h.c=(b*T+N*Y)*this.scaleY,h.d=(b*H+N*le)*this.scaleY;let ae=this._updateCache;for(let ge=0,we=ae.length;ge<we;ge++){let Se=ae[ge];Se!=h&&Se.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let r=this.bones;for(let b=0,N=r.length;b<N;b++)r[b].setToSetupPose();let h=this.ikConstraints;for(let b=0,N=h.length;b<N;b++){let k=h[b];k.mix=k.data.mix,k.softness=k.data.softness,k.bendDirection=k.data.bendDirection,k.compress=k.data.compress,k.stretch=k.data.stretch}let d=this.transformConstraints;for(let b=0,N=d.length;b<N;b++){let k=d[b],T=k.data;k.mixRotate=T.mixRotate,k.mixX=T.mixX,k.mixY=T.mixY,k.mixScaleX=T.mixScaleX,k.mixScaleY=T.mixScaleY,k.mixShearY=T.mixShearY}let y=this.pathConstraints;for(let b=0,N=y.length;b<N;b++){let k=y[b],T=k.data;k.position=T.position,k.spacing=T.spacing,k.mixRotate=T.mixRotate,k.mixX=T.mixX,k.mixY=T.mixY}}setSlotsToSetupPose(){let r=this.slots;dr.arrayCopy(r,0,this.drawOrder,0,r.length);for(let h=0,d=r.length;h<d;h++)r[h].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(r){if(!r)throw new Error("boneName cannot be null.");let h=this.bones;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}findSlot(r){if(!r)throw new Error("slotName cannot be null.");let h=this.slots;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}setSkinByName(r){let h=this.data.findSkin(r);if(!h)throw new Error("Skin not found: "+r);this.setSkin(h)}setSkin(r){if(r!=this.skin){if(r)if(this.skin)r.attachAll(this,this.skin);else{let h=this.slots;for(let d=0,y=h.length;d<y;d++){let b=h[d],N=b.data.attachmentName;if(N){let k=r.getAttachment(d,N);k&&b.setAttachment(k)}}}this.skin=r,this.updateCache()}}getAttachmentByName(r,h){return this.getAttachment(this.data.findSlot(r).index,h)}getAttachment(r,h){if(!h)throw new Error("attachmentName cannot be null.");if(this.skin){let d=this.skin.getAttachment(r,h);if(d)return d}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(r,h):null}setAttachment(r,h){if(!r)throw new Error("slotName cannot be null.");let d=this.slots;for(let y=0,b=d.length;y<b;y++){let N=d[y];if(N.data.name==r){let k=null;if(h&&(k=this.getAttachment(y,h),!k))throw new Error("Attachment not found: "+h+", for slot: "+r);return void N.setAttachment(k)}}throw new Error("Slot not found: "+r)}findIkConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.ikConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}findTransformConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.transformConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}findPathConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.pathConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}getBounds(r,h,d=new Array(2)){if(!r)throw new Error("offset cannot be null.");if(!h)throw new Error("size cannot be null.");let y=this.drawOrder,b=Number.POSITIVE_INFINITY,N=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,T=Number.NEGATIVE_INFINITY;for(let H=0,Y=y.length;H<Y;H++){let le=y[H];if(!le.bone.active)continue;let ae=0,ge=null,we=le.getAttachment();if(we instanceof _i)ae=8,ge=dr.setArraySize(d,ae,0),we.computeWorldVertices(le.bone,ge,0,2);else if(we instanceof Ca){let Se=we;ae=Se.worldVerticesLength,ge=dr.setArraySize(d,ae,0),Se.computeWorldVertices(le,0,ae,ge,0,2)}if(ge)for(let Se=0,$e=ge.length;Se<$e;Se+=2){let Re=ge[Se],Pe=ge[Se+1];b=Math.min(b,Re),N=Math.min(N,Pe),k=Math.max(k,Re),T=Math.max(T,Pe)}}r.set(b,N),h.set(k-b,T-N)}update(r){this.time+=r}}class Cf{constructor(r,h,d){this.slotIndex=r,this.name=h,this.attachment=d}}class Lf{constructor(r){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!r)throw new Error("name cannot be null.");this.name=r}setAttachment(r,h,d){if(!d)throw new Error("attachment cannot be null.");let y=this.attachments;r>=y.length&&(y.length=r+1),y[r]||(y[r]={}),y[r][h]=d}addSkin(r){for(let y=0;y<r.bones.length;y++){let b=r.bones[y],N=!1;for(let k=0;k<this.bones.length;k++)if(this.bones[k]==b){N=!0;break}N||this.bones.push(b)}for(let y=0;y<r.constraints.length;y++){let b=r.constraints[y],N=!1;for(let k=0;k<this.constraints.length;k++)if(this.constraints[k]==b){N=!0;break}N||this.constraints.push(b)}let h=r.getAttachments();for(let y=0;y<h.length;y++){var d=h[y];this.setAttachment(d.slotIndex,d.name,d.attachment)}}copySkin(r){for(let y=0;y<r.bones.length;y++){let b=r.bones[y],N=!1;for(let k=0;k<this.bones.length;k++)if(this.bones[k]==b){N=!0;break}N||this.bones.push(b)}for(let y=0;y<r.constraints.length;y++){let b=r.constraints[y],N=!1;for(let k=0;k<this.constraints.length;k++)if(this.constraints[k]==b){N=!0;break}N||this.constraints.push(b)}let h=r.getAttachments();for(let y=0;y<h.length;y++){var d=h[y];d.attachment&&(d.attachment instanceof Ca?(d.attachment=d.attachment.newLinkedMesh(),this.setAttachment(d.slotIndex,d.name,d.attachment)):(d.attachment=d.attachment.copy(),this.setAttachment(d.slotIndex,d.name,d.attachment)))}}getAttachment(r,h){let d=this.attachments[r];return d?d[h]:null}removeAttachment(r,h){let d=this.attachments[r];d&&(d[h]=null)}getAttachments(){let r=new Array;for(var h=0;h<this.attachments.length;h++){let d=this.attachments[h];if(d)for(let y in d){let b=d[y];b&&r.push(new Cf(h,y,b))}}return r}getAttachmentsForSlot(r,h){let d=this.attachments[r];if(d)for(let y in d){let b=d[y];b&&h.push(new Cf(r,y,b))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(r,h){let d=0;for(let y=0;y<r.slots.length;y++){let b=r.slots[y],N=b.getAttachment();if(N&&d<h.attachments.length){let k=h.attachments[d];for(let T in k)if(N==k[T]){let H=this.getAttachment(d,T);H&&b.setAttachment(H);break}}d++}}}class Bf{constructor(r,h,d){if(this.color=new Kr(1,1,1,1),r<0)throw new Error("index must be >= 0.");if(!h)throw new Error("name cannot be null.");if(!d)throw new Error("boneData cannot be null.");this.index=r,this.name=h,this.boneData=d}}(function(a){a[a.Normal=0]="Normal",a[a.Additive=1]="Additive",a[a.Multiply=2]="Multiply",a[a.Screen=3]="Screen"})(tp||(tp={})),function(a){a[a.Region=0]="Region",a[a.BoundingBox=1]="BoundingBox",a[a.Mesh=2]="Mesh",a[a.LinkedMesh=3]="LinkedMesh",a[a.Path=4]="Path",a[a.Point=5]="Point",a[a.Clipping=6]="Clipping"}(Vd||(Vd={}));class Wa{constructor(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new af(()=>new Array),this.polygonIndicesPool=new af(()=>new Array)}triangulate(r){let h=r,d=r.length>>1,y=this.indicesArray;y.length=0;for(let k=0;k<d;k++)y[k]=k;let b=this.isConcaveArray;b.length=0;for(let k=0,T=d;k<T;++k)b[k]=Wa.isConcave(k,d,h,y);let N=this.triangles;for(N.length=0;d>3;){let k=d-1,T=0,H=1;for(;;){e:if(!b[T]){let ae=y[k]<<1,ge=y[T]<<1,we=y[H]<<1,Se=h[ae],$e=h[ae+1],Re=h[ge],Pe=h[ge+1],Oe=h[we],Fe=h[we+1];for(let De=(H+1)%d;De!=k;De=(De+1)%d){if(!b[De])continue;let Qe=y[De]<<1,it=h[Qe],ct=h[Qe+1];if(Wa.positiveArea(Oe,Fe,Se,$e,it,ct)&&Wa.positiveArea(Se,$e,Re,Pe,it,ct)&&Wa.positiveArea(Re,Pe,Oe,Fe,it,ct))break e}break}if(0==H){do{if(!b[T])break;T--}while(T>0);break}k=T,T=H,H=(H+1)%d}N.push(y[(d+T-1)%d]),N.push(y[T]),N.push(y[(T+1)%d]),y.splice(T,1),b.splice(T,1),d--;let Y=(d+T-1)%d,le=T==d?0:T;b[Y]=Wa.isConcave(Y,d,h,y),b[le]=Wa.isConcave(le,d,h,y)}return 3==d&&(N.push(y[2]),N.push(y[0]),N.push(y[1])),N}decompose(r,h){let d=r,y=this.convexPolygons;this.polygonPool.freeAll(y),y.length=0;let b=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(b),b.length=0;let N=this.polygonIndicesPool.obtain();N.length=0;let k=this.polygonPool.obtain();k.length=0;let T=-1,H=0;for(let Y=0,le=h.length;Y<le;Y+=3){let ae=h[Y]<<1,ge=h[Y+1]<<1,we=h[Y+2]<<1,Se=d[ae],$e=d[ae+1],Re=d[ge],Pe=d[ge+1],Oe=d[we],Fe=d[we+1],De=!1;if(T==ae){let Qe=k.length-4,it=Wa.winding(k[Qe],k[Qe+1],k[Qe+2],k[Qe+3],Oe,Fe),ct=Wa.winding(Oe,Fe,k[0],k[1],k[2],k[3]);it==H&&ct==H&&(k.push(Oe),k.push(Fe),N.push(we),De=!0)}De||(k.length>0?(y.push(k),b.push(N)):(this.polygonPool.free(k),this.polygonIndicesPool.free(N)),k=this.polygonPool.obtain(),k.length=0,k.push(Se),k.push($e),k.push(Re),k.push(Pe),k.push(Oe),k.push(Fe),N=this.polygonIndicesPool.obtain(),N.length=0,N.push(ae),N.push(ge),N.push(we),H=Wa.winding(Se,$e,Re,Pe,Oe,Fe),T=ae)}k.length>0&&(y.push(k),b.push(N));for(let Y=0,le=y.length;Y<le;Y++){if(N=b[Y],0==N.length)continue;let ae=N[0],ge=N[N.length-1];k=y[Y];let we=k.length-4,Se=k[we],$e=k[we+1],Re=k[we+2],Pe=k[we+3],Oe=k[0],Fe=k[1],De=k[2],Qe=k[3],it=Wa.winding(Se,$e,Re,Pe,Oe,Fe);for(let ct=0;ct<le;ct++){if(ct==Y)continue;let _t=b[ct];if(3!=_t.length)continue;let Dt=_t[2],Lt=y[ct],Ct=Lt[Lt.length-2],ut=Lt[Lt.length-1];if(_t[0]!=ae||_t[1]!=ge)continue;let Tt=Wa.winding(Se,$e,Re,Pe,Ct,ut),Qt=Wa.winding(Ct,ut,Oe,Fe,De,Qe);Tt==it&&Qt==it&&(Lt.length=0,_t.length=0,k.push(Ct),k.push(ut),N.push(Dt),Se=Re,$e=Pe,Re=Ct,Pe=ut,ct=0)}}for(let Y=y.length-1;Y>=0;Y--)k=y[Y],0==k.length&&(y.splice(Y,1),this.polygonPool.free(k),N=b[Y],b.splice(Y,1),this.polygonIndicesPool.free(N));return y}static isConcave(r,h,d,y){let b=y[(h+r-1)%h]<<1,N=y[r]<<1,k=y[(r+1)%h]<<1;return!this.positiveArea(d[b],d[b+1],d[N],d[N+1],d[k],d[k+1])}static positiveArea(r,h,d,y,b,N){return r*(N-y)+d*(h-N)+b*(y-h)>=0}static winding(r,h,d,y,b,N){let k=d-r,T=y-h;return b*T-N*k+k*h-r*T>=0?1:-1}}class Sh{constructor(){this.triangulator=new Wa,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}clipStart(r,h){if(this.clipAttachment)return 0;this.clipAttachment=h;let d=h.worldVerticesLength,y=dr.setArraySize(this.clippingPolygon,d);h.computeWorldVertices(r,0,d,y,0,2);let b=this.clippingPolygon;Sh.makeClockwise(b);let N=this.clippingPolygons=this.triangulator.decompose(b,this.triangulator.triangulate(b));for(let k=0,T=N.length;k<T;k++){let H=N[k];Sh.makeClockwise(H),H.push(H[0]),H.push(H[1])}return N.length}clipEndWithSlot(r){this.clipAttachment&&this.clipAttachment.endSlot==r.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(r,h,d,y,b,N,k,T){let H=this.clipOutput,Y=this.clippedVertices,le=this.clippedTriangles,ae=this.clippingPolygons,ge=this.clippingPolygons.length,we=T?12:8,Se=0;Y.length=0,le.length=0;e:for(let $e=0;$e<y;$e+=3){let Re=d[$e]<<1,Pe=r[Re],Oe=r[Re+1],Fe=b[Re],De=b[Re+1];Re=d[$e+1]<<1;let Qe=r[Re],it=r[Re+1],ct=b[Re],_t=b[Re+1];Re=d[$e+2]<<1;let $t=r[Re],rn=r[Re+1],Dt=b[Re],Lt=b[Re+1];for(let Ct=0;Ct<ge;Ct++){let ut=Y.length;if(!this.clip(Pe,Oe,Qe,it,$t,rn,ae[Ct],H)){let Tt=dr.setArraySize(Y,ut+3*we);Tt[ut]=Pe,Tt[ut+1]=Oe,Tt[ut+2]=N.r,Tt[ut+3]=N.g,Tt[ut+4]=N.b,Tt[ut+5]=N.a,T?(Tt[ut+6]=Fe,Tt[ut+7]=De,Tt[ut+8]=k.r,Tt[ut+9]=k.g,Tt[ut+10]=k.b,Tt[ut+11]=k.a,Tt[ut+12]=Qe,Tt[ut+13]=it,Tt[ut+14]=N.r,Tt[ut+15]=N.g,Tt[ut+16]=N.b,Tt[ut+17]=N.a,Tt[ut+18]=ct,Tt[ut+19]=_t,Tt[ut+20]=k.r,Tt[ut+21]=k.g,Tt[ut+22]=k.b,Tt[ut+23]=k.a,Tt[ut+24]=$t,Tt[ut+25]=rn,Tt[ut+26]=N.r,Tt[ut+27]=N.g,Tt[ut+28]=N.b,Tt[ut+29]=N.a,Tt[ut+30]=Dt,Tt[ut+31]=Lt,Tt[ut+32]=k.r,Tt[ut+33]=k.g,Tt[ut+34]=k.b,Tt[ut+35]=k.a):(Tt[ut+6]=Fe,Tt[ut+7]=De,Tt[ut+8]=Qe,Tt[ut+9]=it,Tt[ut+10]=N.r,Tt[ut+11]=N.g,Tt[ut+12]=N.b,Tt[ut+13]=N.a,Tt[ut+14]=ct,Tt[ut+15]=_t,Tt[ut+16]=$t,Tt[ut+17]=rn,Tt[ut+18]=N.r,Tt[ut+19]=N.g,Tt[ut+20]=N.b,Tt[ut+21]=N.a,Tt[ut+22]=Dt,Tt[ut+23]=Lt),ut=le.length;let Qt=dr.setArraySize(le,ut+3);Qt[ut]=Se,Qt[ut+1]=Se+1,Qt[ut+2]=Se+2,Se+=3;continue e}{let Tt=H.length;if(0==Tt)continue;let Qt=it-rn,vn=$t-Qe,gn=Pe-$t,fr=rn-Oe,sr=1/(Qt*gn+vn*(Oe-rn)),Rn=Tt>>1,Jn=this.clipOutput,Kn=dr.setArraySize(Y,ut+Rn*we);for(let vi=0;vi<Tt;vi+=2){let no=Jn[vi],fo=Jn[vi+1];Kn[ut]=no,Kn[ut+1]=fo,Kn[ut+2]=N.r,Kn[ut+3]=N.g,Kn[ut+4]=N.b,Kn[ut+5]=N.a;let Vo=no-$t,Uo=fo-rn,Gs=(Qt*Vo+vn*Uo)*sr,hs=(fr*Vo+gn*Uo)*sr,ps=1-Gs-hs;Kn[ut+6]=Fe*Gs+ct*hs+Dt*ps,Kn[ut+7]=De*Gs+_t*hs+Lt*ps,T&&(Kn[ut+8]=k.r,Kn[ut+9]=k.g,Kn[ut+10]=k.b,Kn[ut+11]=k.a),ut+=we}ut=le.length;let Er=dr.setArraySize(le,ut+3*(Rn-2));Rn--;for(let vi=1;vi<Rn;vi++)Er[ut]=Se,Er[ut+1]=Se+vi,Er[ut+2]=Se+vi+1,ut+=3;Se+=Rn+1}}}}clip(r,h,d,y,b,N,k,T){let H=T,Y=!1,le=null;k.length%4>=2?(le=T,T=this.scratch):le=this.scratch,le.length=0,le.push(r),le.push(h),le.push(d),le.push(y),le.push(b),le.push(N),le.push(r),le.push(h),T.length=0;let ae=k,ge=k.length-4;for(let we=0;;we+=2){let Se=ae[we],$e=ae[we+1],Re=ae[we+2],Pe=ae[we+3],Oe=Se-Re,Fe=$e-Pe,De=le,Qe=le.length-2,it=T.length;for(let _t=0;_t<Qe;_t+=2){let $t=De[_t],rn=De[_t+1],Dt=De[_t+2],Lt=De[_t+3],Ct=Oe*(Lt-Pe)-Fe*(Dt-Re)>0;if(Oe*(rn-Pe)-Fe*($t-Re)>0){if(Ct){T.push(Dt),T.push(Lt);continue}let ut=Lt-rn,Tt=Dt-$t,Qt=ut*(Re-Se)-Tt*(Pe-$e);if(Math.abs(Qt)>1e-6){let vn=(Tt*($e-rn)-ut*(Se-$t))/Qt;T.push(Se+(Re-Se)*vn),T.push($e+(Pe-$e)*vn)}else T.push(Se),T.push($e)}else if(Ct){let ut=Lt-rn,Tt=Dt-$t,Qt=ut*(Re-Se)-Tt*(Pe-$e);if(Math.abs(Qt)>1e-6){let vn=(Tt*($e-rn)-ut*(Se-$t))/Qt;T.push(Se+(Re-Se)*vn),T.push($e+(Pe-$e)*vn)}else T.push(Se),T.push($e);T.push(Dt),T.push(Lt)}Y=!0}if(it==T.length)return H.length=0,!0;if(T.push(T[0]),T.push(T[1]),we==ge)break;let ct=T;(T=le).length=0,le=ct}if(H!=T){H.length=0;for(let we=0,Se=T.length-2;we<Se;we++)H[we]=T[we]}else H.length=H.length-2;return Y}static makeClockwise(r){let h=r,d=r.length,y=h[d-2]*h[1]-h[0]*h[d-1],b=0,N=0,k=0,T=0;for(let H=0,Y=d-3;H<Y;H+=2)b=h[H],N=h[H+1],k=h[H+2],T=h[H+3],y+=b*T-k*N;if(!(y<0))for(let H=0,Y=d-2,le=d>>1;H<le;H+=2){let ae=h[H],ge=h[H+1],we=Y-H;h[H]=h[we],h[H+1]=h[we+1],h[we]=ae,h[we+1]=ge}}}class Kp{constructor(r){this.name=r}}class cm{constructor(r,h){if(!h)throw new Error("data cannot be null.");this.time=r,this.data=h}}class Qd extends Rp{constructor(r){super(r,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}}class Kd{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(r){if(!r)throw new Error("boneName cannot be null.");let h=this.bones;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findSlot(r){if(!r)throw new Error("slotName cannot be null.");let h=this.slots;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findSkin(r){if(!r)throw new Error("skinName cannot be null.");let h=this.skins;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findEvent(r){if(!r)throw new Error("eventDataName cannot be null.");let h=this.events;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findAnimation(r){if(!r)throw new Error("animationName cannot be null.");let h=this.animations;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findIkConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.ikConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findTransformConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.transformConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findPathConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.pathConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}}class um extends Rp{constructor(r){super(r,0,!1),this.bones=new Array,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}}class Fm{constructor(r){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=r}readSkeletonData(r){let h=this.scale,d=new Kd,y="string"==typeof r?JSON.parse(r):r,b=y.skeleton;if(b&&(d.hash=b.hash,d.version=b.spine,d.x=b.x,d.y=b.y,d.width=b.width,d.height=b.height,d.fps=b.fps,d.imagesPath=b.images),y.bones)for(let N=0;N<y.bones.length;N++){let k=y.bones[N],T=null,H=cn(k,"parent",null);H&&(T=d.findBone(H));let Y=new Jd(d.bones.length,k.name,T);Y.length=cn(k,"length",0)*h,Y.x=cn(k,"x",0)*h,Y.y=cn(k,"y",0)*h,Y.rotation=cn(k,"rotation",0),Y.scaleX=cn(k,"scaleX",1),Y.scaleY=cn(k,"scaleY",1),Y.shearX=cn(k,"shearX",0),Y.shearY=cn(k,"shearY",0),Y.transformMode=dr.enumValue(Kl,cn(k,"transform","Normal")),Y.skinRequired=cn(k,"skin",!1);let le=cn(k,"color",null);le&&Y.color.setFromString(le),d.bones.push(Y)}if(y.slots)for(let N=0;N<y.slots.length;N++){let k=y.slots[N],T=d.findBone(k.bone),H=new Bf(d.slots.length,k.name,T),Y=cn(k,"color",null);Y&&H.color.setFromString(Y);let le=cn(k,"dark",null);le&&(H.darkColor=Kr.fromString(le)),H.attachmentName=cn(k,"attachment",null),H.blendMode=dr.enumValue(tp,cn(k,"blend","normal")),d.slots.push(H)}if(y.ik)for(let N=0;N<y.ik.length;N++){let k=y.ik[N],T=new Qd(k.name);T.order=cn(k,"order",0),T.skinRequired=cn(k,"skin",!1);for(let H=0;H<k.bones.length;H++)T.bones.push(d.findBone(k.bones[H]));T.target=d.findBone(k.target),T.mix=cn(k,"mix",1),T.softness=cn(k,"softness",0)*h,T.bendDirection=cn(k,"bendPositive",!0)?1:-1,T.compress=cn(k,"compress",!1),T.stretch=cn(k,"stretch",!1),T.uniform=cn(k,"uniform",!1),d.ikConstraints.push(T)}if(y.transform)for(let N=0;N<y.transform.length;N++){let k=y.transform[N],T=new um(k.name);T.order=cn(k,"order",0),T.skinRequired=cn(k,"skin",!1);for(let Y=0;Y<k.bones.length;Y++)T.bones.push(d.findBone(k.bones[Y]));T.target=d.findBone(k.target),T.local=cn(k,"local",!1),T.relative=cn(k,"relative",!1),T.offsetRotation=cn(k,"rotation",0),T.offsetX=cn(k,"x",0)*h,T.offsetY=cn(k,"y",0)*h,T.offsetScaleX=cn(k,"scaleX",0),T.offsetScaleY=cn(k,"scaleY",0),T.offsetShearY=cn(k,"shearY",0),T.mixRotate=cn(k,"mixRotate",1),T.mixX=cn(k,"mixX",1),T.mixY=cn(k,"mixY",T.mixX),T.mixScaleX=cn(k,"mixScaleX",1),T.mixScaleY=cn(k,"mixScaleY",T.mixScaleX),T.mixShearY=cn(k,"mixShearY",1),d.transformConstraints.push(T)}if(y.path)for(let N=0;N<y.path.length;N++){let k=y.path[N],T=new wd(k.name);T.order=cn(k,"order",0),T.skinRequired=cn(k,"skin",!1);for(let Y=0;Y<k.bones.length;Y++)T.bones.push(d.findBone(k.bones[Y]));T.target=d.findSlot(k.target),T.positionMode=dr.enumValue(Np,cn(k,"positionMode","Percent")),T.spacingMode=dr.enumValue(ec,cn(k,"spacingMode","Length")),T.rotateMode=dr.enumValue(Jp,cn(k,"rotateMode","Tangent")),T.offsetRotation=cn(k,"rotation",0),T.position=cn(k,"position",0),T.positionMode==Np.Fixed&&(T.position*=h),T.spacing=cn(k,"spacing",0),T.spacingMode!=ec.Length&&T.spacingMode!=ec.Fixed||(T.spacing*=h),T.mixRotate=cn(k,"mixRotate",1),T.mixX=cn(k,"mixX",1),T.mixY=cn(k,"mixY",T.mixX),d.pathConstraints.push(T)}if(y.skins)for(let N=0;N<y.skins.length;N++){let k=y.skins[N],T=new Lf(k.name);if(k.bones)for(let H=0;H<k.bones.length;H++)T.bones.push(d.findBone(k.bones[H]));if(k.ik)for(let H=0;H<k.ik.length;H++)T.constraints.push(d.findIkConstraint(k.ik[H]));if(k.transform)for(let H=0;H<k.transform.length;H++)T.constraints.push(d.findTransformConstraint(k.transform[H]));if(k.path)for(let H=0;H<k.path.length;H++)T.constraints.push(d.findPathConstraint(k.path[H]));for(let H in k.attachments){let Y=d.findSlot(H),le=k.attachments[H];for(let ae in le){let ge=this.readAttachment(le[ae],T,Y.index,ae,d);ge&&T.setAttachment(Y.index,ae,ge)}}d.skins.push(T),"default"==T.name&&(d.defaultSkin=T)}for(let N=0,k=this.linkedMeshes.length;N<k;N++){let T=this.linkedMeshes[N],H=(T.skin?d.findSkin(T.skin):d.defaultSkin).getAttachment(T.slotIndex,T.parent);T.mesh.deformAttachment=T.inheritDeform?H:T.mesh,T.mesh.setParentMesh(H),T.mesh.updateUVs()}if(this.linkedMeshes.length=0,y.events)for(let N in y.events){let k=y.events[N],T=new Kp(N);T.intValue=cn(k,"int",0),T.floatValue=cn(k,"float",0),T.stringValue=cn(k,"string",""),T.audioPath=cn(k,"audio",null),T.audioPath&&(T.volume=cn(k,"volume",1),T.balance=cn(k,"balance",0)),d.events.push(T)}if(y.animations)for(let N in y.animations)this.readAnimation(y.animations[N],N,d);return d}readAttachment(r,h,d,y,b){let N=this.scale;switch(y=cn(r,"name",y),cn(r,"type","region")){case"region":{let k=cn(r,"path",y),T=this.attachmentLoader.newRegionAttachment(h,y,k);if(!T)return null;T.path=k,T.x=cn(r,"x",0)*N,T.y=cn(r,"y",0)*N,T.scaleX=cn(r,"scaleX",1),T.scaleY=cn(r,"scaleY",1),T.rotation=cn(r,"rotation",0),T.width=r.width*N,T.height=r.height*N;let H=cn(r,"color",null);return H&&T.color.setFromString(H),T.updateOffset(),T}case"boundingbox":{let k=this.attachmentLoader.newBoundingBoxAttachment(h,y);if(!k)return null;this.readVertices(r,k,r.vertexCount<<1);let T=cn(r,"color",null);return T&&k.color.setFromString(T),k}case"mesh":case"linkedmesh":{let k=cn(r,"path",y),T=this.attachmentLoader.newMeshAttachment(h,y,k);if(!T)return null;T.path=k;let H=cn(r,"color",null);H&&T.color.setFromString(H),T.width=cn(r,"width",0)*N,T.height=cn(r,"height",0)*N;let Y=cn(r,"parent",null);if(Y)return this.linkedMeshes.push(new ef(T,cn(r,"skin",null),d,Y,cn(r,"deform",!0))),T;let le=r.uvs;return this.readVertices(r,T,le.length),T.triangles=r.triangles,T.regionUVs=le,T.updateUVs(),T.edges=cn(r,"edges",null),T.hullLength=2*cn(r,"hull",0),T}case"path":{let k=this.attachmentLoader.newPathAttachment(h,y);if(!k)return null;k.closed=cn(r,"closed",!1),k.constantSpeed=cn(r,"constantSpeed",!0);let T=r.vertexCount;this.readVertices(r,k,T<<1);let H=dr.newArray(T/3,0);for(let le=0;le<r.lengths.length;le++)H[le]=r.lengths[le]*N;k.lengths=H;let Y=cn(r,"color",null);return Y&&k.color.setFromString(Y),k}case"point":{let k=this.attachmentLoader.newPointAttachment(h,y);if(!k)return null;k.x=cn(r,"x",0)*N,k.y=cn(r,"y",0)*N,k.rotation=cn(r,"rotation",0);let T=cn(r,"color",null);return T&&k.color.setFromString(T),k}case"clipping":{let k=this.attachmentLoader.newClippingAttachment(h,y);if(!k)return null;let T=cn(r,"end",null);T&&(k.endSlot=b.findSlot(T)),this.readVertices(r,k,r.vertexCount<<1);let Y=cn(r,"color",null);return Y&&k.color.setFromString(Y),k}}return null}readVertices(r,h,d){let y=this.scale;h.worldVerticesLength=d;let b=r.vertices;if(d==b.length){let T=dr.toFloatArray(b);if(1!=y)for(let H=0,Y=b.length;H<Y;H++)T[H]*=y;return void(h.vertices=T)}let N=new Array,k=new Array;for(let T=0,H=b.length;T<H;){let Y=b[T++];k.push(Y);for(let le=T+4*Y;T<le;T+=4)k.push(b[T]),N.push(b[T+1]*y),N.push(b[T+2]*y),N.push(b[T+3])}h.bones=k,h.vertices=dr.toFloatArray(N)}readAnimation(r,h,d){let y=this.scale,b=new Array;if(r.slots)for(let k in r.slots){let T=r.slots[k],H=d.findSlot(k).index;for(let Y in T){let le=T[Y];if(!le)continue;let ae=le.length;if("attachment"==Y){let ge=new yd(ae,H);for(let we=0;we<ae;we++){let Se=le[we];ge.setFrame(we,cn(Se,"time",0),Se.name)}b.push(ge)}else if("rgba"==Y){let ge=new em(ae,ae<<2,H),we=le[0],Se=cn(we,"time",0),$e=Kr.fromString(we.color);for(let Re=0,Pe=0;;Re++){ge.setFrame(Re,Se,$e.r,$e.g,$e.b,$e.a);let Oe=le[Re+1];if(!Oe){ge.shrink(Pe);break}let Fe=cn(Oe,"time",0),De=Kr.fromString(Oe.color),Qe=we.curve;Qe&&(Pe=Ji(Qe,ge,Pe,Re,0,Se,Fe,$e.r,De.r,1),Pe=Ji(Qe,ge,Pe,Re,1,Se,Fe,$e.g,De.g,1),Pe=Ji(Qe,ge,Pe,Re,2,Se,Fe,$e.b,De.b,1),Pe=Ji(Qe,ge,Pe,Re,3,Se,Fe,$e.a,De.a,1)),Se=Fe,$e=De,we=Oe}b.push(ge)}else if("rgb"==Y){let ge=new Ud(ae,3*ae,H),we=le[0],Se=cn(we,"time",0),$e=Kr.fromString(we.color);for(let Re=0,Pe=0;;Re++){ge.setFrame(Re,Se,$e.r,$e.g,$e.b);let Oe=le[Re+1];if(!Oe){ge.shrink(Pe);break}let Fe=cn(Oe,"time",0),De=Kr.fromString(Oe.color),Qe=we.curve;Qe&&(Pe=Ji(Qe,ge,Pe,Re,0,Se,Fe,$e.r,De.r,1),Pe=Ji(Qe,ge,Pe,Re,1,Se,Fe,$e.g,De.g,1),Pe=Ji(Qe,ge,Pe,Re,2,Se,Fe,$e.b,De.b,1)),Se=Fe,$e=De,we=Oe}b.push(ge)}else if("alpha"==Y)b.push(Cc(le,new Cm(ae,ae,H),0,1));else if("rgba2"==Y){let ge=new Lm(ae,7*ae,H),we=le[0],Se=cn(we,"time",0),$e=Kr.fromString(we.light),Re=Kr.fromString(we.dark);for(let Pe=0,Oe=0;;Pe++){ge.setFrame(Pe,Se,$e.r,$e.g,$e.b,$e.a,Re.r,Re.g,Re.b);let Fe=le[Pe+1];if(!Fe){ge.shrink(Oe);break}let De=cn(Fe,"time",0),Qe=Kr.fromString(Fe.light),it=Kr.fromString(Fe.dark),ct=we.curve;ct&&(Oe=Ji(ct,ge,Oe,Pe,0,Se,De,$e.r,Qe.r,1),Oe=Ji(ct,ge,Oe,Pe,1,Se,De,$e.g,Qe.g,1),Oe=Ji(ct,ge,Oe,Pe,2,Se,De,$e.b,Qe.b,1),Oe=Ji(ct,ge,Oe,Pe,3,Se,De,$e.a,Qe.a,1),Oe=Ji(ct,ge,Oe,Pe,4,Se,De,Re.r,it.r,1),Oe=Ji(ct,ge,Oe,Pe,5,Se,De,Re.g,it.g,1),Oe=Ji(ct,ge,Oe,Pe,6,Se,De,Re.b,it.b,1)),Se=De,$e=Qe,Re=it,we=Fe}b.push(ge)}else if("rgb2"==Y){let ge=new zd(ae,6*ae,H),we=le[0],Se=cn(we,"time",0),$e=Kr.fromString(we.light),Re=Kr.fromString(we.dark);for(let Pe=0,Oe=0;;Pe++){ge.setFrame(Pe,Se,$e.r,$e.g,$e.b,Re.r,Re.g,Re.b);let Fe=le[Pe+1];if(!Fe){ge.shrink(Oe);break}let De=cn(Fe,"time",0),Qe=Kr.fromString(Fe.light),it=Kr.fromString(Fe.dark),ct=we.curve;ct&&(Oe=Ji(ct,ge,Oe,Pe,0,Se,De,$e.r,Qe.r,1),Oe=Ji(ct,ge,Oe,Pe,1,Se,De,$e.g,Qe.g,1),Oe=Ji(ct,ge,Oe,Pe,2,Se,De,$e.b,Qe.b,1),Oe=Ji(ct,ge,Oe,Pe,3,Se,De,Re.r,it.r,1),Oe=Ji(ct,ge,Oe,Pe,4,Se,De,Re.g,it.g,1),Oe=Ji(ct,ge,Oe,Pe,5,Se,De,Re.b,it.b,1)),Se=De,$e=Qe,Re=it,we=Fe}b.push(ge)}}}if(r.bones)for(let k in r.bones){let T=r.bones[k],H=d.findBone(k).index;for(let Y in T){let le=T[Y],ae=le.length;if(0!=ae)if("rotate"===Y)b.push(Cc(le,new Tf(ae,ae,H),0,1));else if("translate"===Y){let ge=new Yf(ae,ae<<1,H);b.push(Eh(le,ge,"x","y",0,y))}else if("translatex"===Y){let ge=new Jf(ae,ae,H);b.push(Cc(le,ge,0,y))}else if("translatey"===Y){let ge=new Mf(ae,ae,H);b.push(Cc(le,ge,0,y))}else if("scale"===Y){let ge=new Zf(ae,ae<<1,H);b.push(Eh(le,ge,"x","y",1,1))}else if("scalex"===Y){let ge=new Am(ae,ae,H);b.push(Cc(le,ge,1,1))}else if("scaley"===Y){let ge=new Bp(ae,ae,H);b.push(Cc(le,ge,1,1))}else if("shear"===Y){let ge=new Qf(ae,ae<<1,H);b.push(Eh(le,ge,"x","y",0,1))}else if("shearx"===Y){let ge=new $m(ae,ae,H);b.push(Cc(le,ge,0,1))}else if("sheary"===Y){let ge=new Kf(ae,ae,H);b.push(Cc(le,ge,0,1))}}}if(r.ik)for(let k in r.ik){let T=r.ik[k],H=T[0];if(!H)continue;let Y=d.findIkConstraint(k),le=d.ikConstraints.indexOf(Y),ae=new Bm(T.length,T.length<<1,le),ge=cn(H,"time",0),we=cn(H,"mix",1),Se=cn(H,"softness",0)*y;for(let $e=0,Re=0;;$e++){ae.setFrame($e,ge,we,Se,cn(H,"bendPositive",!0)?1:-1,cn(H,"compress",!1),cn(H,"stretch",!1));let Pe=T[$e+1];if(!Pe){ae.shrink(Re);break}let Oe=cn(Pe,"time",0),Fe=cn(Pe,"mix",1),De=cn(Pe,"softness",0)*y,Qe=H.curve;Qe&&(Re=Ji(Qe,ae,Re,$e,0,ge,Oe,we,Fe,1),Re=Ji(Qe,ae,Re,$e,1,ge,Oe,Se,De,y)),ge=Oe,we=Fe,Se=De,H=Pe}b.push(ae)}if(r.transform)for(let k in r.transform){let T=r.transform[k],H=T[0];if(!H)continue;let Y=d.findTransformConstraint(k),le=d.transformConstraints.indexOf(Y),ae=new Nm(T.length,6*T.length,le),ge=cn(H,"time",0),we=cn(H,"mixRotate",1),Se=cn(H,"mixX",1),$e=cn(H,"mixY",Se),Re=cn(H,"mixScaleX",1),Pe=cn(H,"mixScaleY",Re),Oe=cn(H,"mixShearY",1);for(let Fe=0,De=0;;Fe++){ae.setFrame(Fe,ge,we,Se,$e,Re,Pe,Oe);let Qe=T[Fe+1];if(!Qe){ae.shrink(De);break}let it=cn(Qe,"time",0),ct=cn(Qe,"mixRotate",1),_t=cn(Qe,"mixX",1),$t=cn(Qe,"mixY",_t),rn=cn(Qe,"mixScaleX",1),Dt=cn(Qe,"mixScaleY",rn),Lt=cn(Qe,"mixShearY",1),Ct=H.curve;Ct&&(De=Ji(Ct,ae,De,Fe,0,ge,it,we,ct,1),De=Ji(Ct,ae,De,Fe,1,ge,it,Se,_t,1),De=Ji(Ct,ae,De,Fe,2,ge,it,$e,$t,1),De=Ji(Ct,ae,De,Fe,3,ge,it,Re,rn,1),De=Ji(Ct,ae,De,Fe,4,ge,it,Pe,Dt,1),De=Ji(Ct,ae,De,Fe,5,ge,it,Oe,Lt,1)),ge=it,we=ct,Se=_t,$e=$t,Re=rn,Pe=Dt,Re=rn,H=Qe}b.push(ae)}if(r.path)for(let k in r.path){let T=r.path[k],H=d.findPathConstraint(k),Y=d.pathConstraints.indexOf(H);for(let le in T){let ae=T[le],ge=ae[0];if(!ge)continue;let we=ae.length;if("position"===le){let Se=new Rm(we,we,Y);b.push(Cc(ae,Se,0,H.positionMode==Np.Fixed?y:1))}else if("spacing"===le){let Se=new nm(we,we,Y);b.push(Cc(ae,Se,0,H.spacingMode==ec.Length||H.spacingMode==ec.Fixed?y:1))}else if("mix"===le){let Se=new Pm(we,3*we,Y),$e=cn(ge,"time",0),Re=cn(ge,"mixRotate",1),Pe=cn(ge,"mixX",1),Oe=cn(ge,"mixY",Pe);for(let Fe=0,De=0;;Fe++){Se.setFrame(Fe,$e,Re,Pe,Oe);let Qe=ae[Fe+1];if(!Qe){Se.shrink(De);break}let it=cn(Qe,"time",0),ct=cn(Qe,"mixRotate",1),_t=cn(Qe,"mixX",1),$t=cn(Qe,"mixY",_t),rn=ge.curve;rn&&(De=Ji(rn,Se,De,Fe,0,$e,it,Re,ct,1),De=Ji(rn,Se,De,Fe,1,$e,it,Pe,_t,1),De=Ji(rn,Se,De,Fe,2,$e,it,Oe,$t,1)),$e=it,Re=ct,Pe=_t,Oe=$t,ge=Qe}b.push(Se)}}}if(r.deform)for(let k in r.deform){let T=r.deform[k],H=d.findSkin(k);for(let Y in T){let le=T[Y],ae=d.findSlot(Y).index;for(let ge in le){let we=le[ge],Se=we[0];if(!Se)continue;let $e=H.getAttachment(ae,ge),Re=$e.bones,Pe=$e.vertices,Oe=Re?Pe.length/3*2:Pe.length,Fe=new tm(we.length,we.length,ae,$e),De=cn(Se,"time",0);for(let Qe=0,it=0;;Qe++){let ct,_t=cn(Se,"vertices",null);if(_t){ct=dr.newFloatArray(Oe);let Lt=cn(Se,"offset",0);if(dr.arrayCopy(_t,0,ct,Lt,_t.length),1!=y)for(let Ct=Lt,ut=Ct+_t.length;Ct<ut;Ct++)ct[Ct]*=y;if(!Re)for(let Ct=0;Ct<Oe;Ct++)ct[Ct]+=Pe[Ct]}else ct=Re?dr.newFloatArray(Oe):Pe;Fe.setFrame(Qe,De,ct);let $t=we[Qe+1];if(!$t){Fe.shrink(it);break}let rn=cn($t,"time",0),Dt=Se.curve;Dt&&(it=Ji(Dt,Fe,it,Qe,0,De,rn,0,1,1)),De=rn,Se=$t}b.push(Fe)}}}if(r.drawOrder){let k=new Kh(r.drawOrder.length),T=d.slots.length,H=0;for(let Y=0;Y<r.drawOrder.length;Y++,H++){let le=r.drawOrder[Y],ae=null,ge=cn(le,"offsets",null);if(ge){ae=dr.newArray(T,-1);let we=dr.newArray(T-ge.length,0),Se=0,$e=0;for(let Re=0;Re<ge.length;Re++){let Pe=ge[Re],Oe=d.findSlot(Pe.slot).index;for(;Se!=Oe;)we[$e++]=Se++;ae[Se+Pe.offset]=Se++}for(;Se<T;)we[$e++]=Se++;for(let Re=T-1;Re>=0;Re--)-1==ae[Re]&&(ae[Re]=we[--$e])}k.setFrame(H,cn(le,"time",0),ae)}b.push(k)}if(r.events){let k=new jd(r.events.length),T=0;for(let H=0;H<r.events.length;H++,T++){let Y=r.events[H],le=d.findEvent(Y.name),ae=new cm(dr.toSinglePrecision(cn(Y,"time",0)),le);ae.intValue=cn(Y,"int",le.intValue),ae.floatValue=cn(Y,"float",le.floatValue),ae.stringValue=cn(Y,"string",le.stringValue),ae.data.audioPath&&(ae.volume=cn(Y,"volume",1),ae.balance=cn(Y,"balance",0)),k.setFrame(T,ae)}b.push(k)}let N=0;for(let k=0,T=b.length;k<T;k++)N=Math.max(N,b[k].getDuration());d.animations.push(new Yp(h,b,N))}}class ef{constructor(r,h,d,y,b){this.mesh=r,this.skin=h,this.slotIndex=d,this.parent=y,this.inheritDeform=b}}function Cc(a,r,h,d){let y=a[0],b=cn(y,"time",0),N=cn(y,"value",h)*d,k=0;for(let T=0;;T++){r.setFrame(T,b,N);let H=a[T+1];if(!H)return r.shrink(k),r;let Y=cn(H,"time",0),le=cn(H,"value",h)*d;y.curve&&(k=Ji(y.curve,r,k,T,0,b,Y,N,le,d)),b=Y,N=le,y=H}}function Eh(a,r,h,d,y,b){let N=a[0],k=cn(N,"time",0),T=cn(N,h,y)*b,H=cn(N,d,y)*b,Y=0;for(let le=0;;le++){r.setFrame(le,k,T,H);let ae=a[le+1];if(!ae)return r.shrink(Y),r;let ge=cn(ae,"time",0),we=cn(ae,h,y)*b,Se=cn(ae,d,y)*b,$e=N.curve;$e&&(Y=Ji($e,r,Y,le,0,k,ge,T,we,b),Y=Ji($e,r,Y,le,1,k,ge,H,Se,b)),k=ge,T=we,H=Se,N=ae}}function Ji(a,r,h,d,y,b,N,k,T,H){if("stepped"==a)return r.setStepped(d),h;let Y=y<<2;return r.setBezier(h,d,y,b,k,a[Y],a[Y+1]*H,a[Y+2],a[Y+3]*H,N,T),h+1}function cn(a,r,h){return void 0!==a[r]?a[r]:h}void 0===Math.fround&&(Math.fround=(Wd=new Float32Array(1),function(a){return Wd[0]=a,Wd[0]}));class ed{constructor(r){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=r}begin(r){this.worldX=r.x+this.centerX,this.worldY=r.y+this.centerY}transform(r,h,d,y){let b=this.angle*Ln.degreesToRadians,N=r.x-this.worldX,k=r.y-this.worldY,T=Math.sqrt(N*N+k*k);if(T<this.radius){let H=ed.interpolation.apply(0,b,(this.radius-T)/this.radius),Y=Math.cos(H),le=Math.sin(H);r.x=Y*N-le*k+this.worldX,r.y=le*N+Y*k+this.worldY}}end(){}}ed.interpolation=new class extends Xf{constructor(a){super(a)}applyInternal(a){return Math.pow(a-1,this.power)*(this.power%2==0?-1:1)+1}}(2);var cs=__webpack_require__(175);class Ir extends ep{constructor(r){super(r),this.texture=new cs.Texture(r),this.texture.flipY=!1,this.texture.needsUpdate=!0}setFilters(r,h){this.texture.minFilter=Ir.toThreeJsTextureFilter(r),this.texture.magFilter=Ir.toThreeJsTextureFilter(h)}setWraps(r,h){this.texture.wrapS=Ir.toThreeJsTextureWrap(r),this.texture.wrapT=Ir.toThreeJsTextureWrap(h)}dispose(){this.texture.dispose()}static toThreeJsTextureFilter(r){if(r===$a.Linear)return cs.LinearFilter;if(r===$a.MipMap)return cs.LinearMipMapLinearFilter;if(r===$a.MipMapLinearNearest)return cs.LinearMipMapNearestFilter;if(r===$a.MipMapNearestLinear)return cs.NearestMipMapLinearFilter;if(r===$a.MipMapNearestNearest)return cs.NearestMipMapNearestFilter;if(r===$a.Nearest)return cs.NearestFilter;throw new Error("Unknown texture filter: "+r)}static toThreeJsTextureWrap(r){if(r===Nl.ClampToEdge)return cs.ClampToEdgeWrapping;if(r===Nl.MirroredRepeat)return cs.MirroredRepeatWrapping;if(r===Nl.Repeat)return cs.RepeatWrapping;throw new Error("Unknown texture wrap: "+r)}}class Nf extends cs.ShaderMaterial{constructor(r){let h={uniforms:{map:{type:"t",value:null}},vertexShader:"\n\t\t\t\tattribute vec4 color;\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvarying vec4 vColor;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tvColor = color;\n\t\t\t\t\tgl_Position = projectionMatrix*modelViewMatrix*vec4(position,1.0);\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\t\t\t\tuniform sampler2D map;\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvarying vec4 vColor;\n\t\t\t\tvoid main(void) {\n\t\t\t\t\tgl_FragColor = texture2D(map, vUv)*vColor;\n\t\t\t\t}\n\t\t\t",side:cs.DoubleSide,transparent:!0,alphaTest:.5};r(h),super(h)}}class eu extends cs.Object3D{constructor(r,h=d=>{}){super(),this.tempPos=new lf,this.tempUv=new lf,this.tempLight=new Kr,this.tempDark=new Kr,this.zOffset=.1,this.batches=new Array,this.nextBatchIndex=0,this.clipper=new Sh,this.vertices=dr.newFloatArray(1024),this.tempColor=new Kr,this.materialCustomizer=h,this.skeleton=new pf(r);let d=new am(r);this.state=new Gd(d)}update(r){let h=this.state,d=this.skeleton;h.update(r),h.apply(d),d.updateWorldTransform(),this.updateGeometry()}dispose(){for(var r=0;r<this.batches.length;r++)this.batches[r].dispose()}clearBatches(){for(var r=0;r<this.batches.length;r++)this.batches[r].clear(),this.batches[r].visible=!1;this.nextBatchIndex=0}nextBatch(){if(this.batches.length==this.nextBatchIndex){let h=new nh(10920,this.materialCustomizer);this.add(h),this.batches.push(h)}let r=this.batches[this.nextBatchIndex++];return r.visible=!0,r}updateGeometry(){this.clearBatches();let r=this.tempPos,h=this.tempUv,d=this.tempLight,y=this.tempDark,b=this.clipper,N=this.vertices,k=null,T=null,H=this.skeleton.drawOrder,Y=this.nextBatch();Y.begin();let le=0,ae=this.zOffset;for(let ge=0,we=H.length;ge<we;ge++){let Se=b.isClipping()?2:eu.VERTEX_SIZE,$e=H[ge];if(!$e.bone.active){b.clipEndWithSlot($e);continue}let Re=$e.getAttachment(),Pe=null,Oe=null,Fe=0;if(Re instanceof _i){let De=Re;Pe=De.color,N=this.vertices,Fe=4*Se,De.computeWorldVertices($e.bone,N,0,Se),k=eu.QUAD_TRIANGLES,T=De.uvs,Oe=De.region.renderObject.page.texture}else{if(!(Re instanceof Ca)){if(Re instanceof bd){b.clipStart($e,Re);continue}b.clipEndWithSlot($e);continue}{let De=Re;Pe=De.color,N=this.vertices,Fe=(De.worldVerticesLength>>1)*Se,Fe>N.length&&(N=this.vertices=dr.newFloatArray(Fe)),De.computeWorldVertices($e,0,De.worldVerticesLength,N,0,Se),k=De.triangles,T=De.uvs,Oe=De.region.renderObject.page.texture}}if(Oe){let De,Qe,it,ct,_t=$e.bone.skeleton.color,$t=$e.color,Dt=this.tempColor;if(Dt.set(_t.r*$t.r*Pe.r,_t.g*$t.g*Pe.g,_t.b*$t.b*Pe.b,_t.a*$t.a*Pe.a),b.isClipping()){b.clipTriangles(N,Fe,k,k.length,T,Dt,null,!1);let Ct=b.clippedVertices,ut=b.clippedTriangles;if(this.vertexEffect){let Tt=this.vertexEffect,Qt=Ct;for(let vn=0,gn=Ct.length;vn<gn;vn+=Se)r.x=Qt[vn],r.y=Qt[vn+1],d.setFromColor(Dt),y.set(0,0,0,0),h.x=Qt[vn+6],h.y=Qt[vn+7],Tt.transform(r,h,d,y),Qt[vn]=r.x,Qt[vn+1]=r.y,Qt[vn+2]=d.r,Qt[vn+3]=d.g,Qt[vn+4]=d.b,Qt[vn+5]=d.a,Qt[vn+6]=h.x,Qt[vn+7]=h.y}De=Ct,Qe=Ct.length,it=ut,ct=ut.length}else{let Ct=N;if(this.vertexEffect){let ut=this.vertexEffect;for(let Tt=0,Qt=0,vn=Fe;Tt<vn;Tt+=Se,Qt+=2)r.x=Ct[Tt],r.y=Ct[Tt+1],d.setFromColor(Dt),y.set(0,0,0,0),h.x=T[Qt],h.y=T[Qt+1],ut.transform(r,h,d,y),Ct[Tt]=r.x,Ct[Tt+1]=r.y,Ct[Tt+2]=d.r,Ct[Tt+3]=d.g,Ct[Tt+4]=d.b,Ct[Tt+5]=d.a,Ct[Tt+6]=h.x,Ct[Tt+7]=h.y}else for(let ut=2,Tt=0,Qt=Fe;ut<Qt;ut+=Se,Tt+=2)Ct[ut]=Dt.r,Ct[ut+1]=Dt.g,Ct[ut+2]=Dt.b,Ct[ut+3]=Dt.a,Ct[ut+4]=T[Tt],Ct[ut+5]=T[Tt+1];De=N,Qe=Fe,it=k,ct=k.length}if(0==Qe||0==ct){b.clipEndWithSlot($e);continue}Y.canBatch(Qe,ct)||(Y.end(),Y=this.nextBatch(),Y.begin());let Lt=Y.material;Lt.uniforms.map.value||(Lt.uniforms.map.value=Oe.texture),Lt.uniforms.map.value!=Oe.texture&&(Y.end(),Y=this.nextBatch(),Y.begin(),Lt=Y.material,Lt.uniforms.map.value=Oe.texture),Lt.needsUpdate=!0,Y.batch(De,Qe,it,ct,le),le+=ae}b.clipEndWithSlot($e)}b.clipEnd(),Y.end()}}eu.QUAD_TRIANGLES=[0,1,2,2,3,0],eu.VERTEX_SIZE=8;class nh extends cs.Mesh{constructor(r=10920,h=d=>{}){if(super(),this.verticesLength=0,this.indicesLength=0,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);let d=this.vertices=new Float32Array(r*nh.VERTEX_SIZE),y=this.indices=new Uint16Array(3*r),b=new cs.BufferGeometry,N=this.vertexBuffer=new cs.InterleavedBuffer(d,nh.VERTEX_SIZE);N.usage=WebGLRenderingContext.DYNAMIC_DRAW,b.setAttribute("position",new cs.InterleavedBufferAttribute(N,3,0,!1)),b.setAttribute("color",new cs.InterleavedBufferAttribute(N,4,3,!1)),b.setAttribute("uv",new cs.InterleavedBufferAttribute(N,2,7,!1)),b.setIndex(new cs.BufferAttribute(y,1)),b.getIndex().usage=WebGLRenderingContext.DYNAMIC_DRAW,b.drawRange.start=0,b.drawRange.count=0,this.geometry=b,this.material=new Nf(h)}dispose(){if(this.geometry.dispose(),this.material instanceof cs.Material)this.material.dispose();else if(this.material)for(let r=0;r<this.material.length;r++){let h=this.material[r];h instanceof cs.Material&&h.dispose()}}clear(){let r=this.geometry;return r.drawRange.start=0,r.drawRange.count=0,this.material.uniforms.map.value=null,this}begin(){this.verticesLength=0,this.indicesLength=0}canBatch(r,h){return!(this.indicesLength+h>=this.indices.byteLength/2||this.verticesLength+r>=this.vertices.byteLength/2)}batch(r,h,d,y,b=0){let N=this.verticesLength/nh.VERTEX_SIZE,k=this.vertices,T=this.verticesLength,H=0;for(;H<h;)k[T++]=r[H++],k[T++]=r[H++],k[T++]=b,k[T++]=r[H++],k[T++]=r[H++],k[T++]=r[H++],k[T++]=r[H++],k[T++]=r[H++],k[T++]=r[H++];this.verticesLength=T;let Y=this.indices;for(T=this.indicesLength,H=0;H<y;T++,H++)Y[T]=d[H]+N;this.indicesLength+=y}end(){this.vertexBuffer.needsUpdate=this.verticesLength>0,this.vertexBuffer.updateRange.offset=0,this.vertexBuffer.updateRange.count=this.verticesLength;let r=this.geometry;r.getIndex().needsUpdate=this.indicesLength>0,r.getIndex().updateRange.offset=0,r.getIndex().updateRange.count=this.indicesLength,r.drawRange.start=0,r.drawRange.count=this.indicesLength}}function rh(a){Ir.call(this,a.image),this.texture=a,this.texture.flipY=!1}function Js(a,r,h,d){void 0===d&&(d=[]);var y=new qd(r,function(k){for(var T=0;T<d.length;T++)if(d[T].name===k){var H=new rh(d[T].texture);break}T===d.length&&(H=new rh(new bs(new ys(h+"/"+k))),d.push({name:k,texture:H.texture}));var Y=H.texture.image,le=H.texture.source;if(le.width>0&&le.height>0)Y.width=le.width,Y.height=le.height;else if(0!==Y.naturalWidth&&0!==Y.naturalHeight)Y.width=Y.naturalWidth,Y.height=Y.naturalHeight,le.width=Y.width,le.height=Y.height;else{var ae=r.search("size: "),ge=r.search("\nformat"),we=r.substring(ae+6,ge);we=we.split(","),Y.width=parseInt(we[0]),Y.height=parseInt(we[1])}return H}),b=new Zp(y),N=new Fm(b).readSkeletonData(a);eu.call(this,N),this.name="spine",this.type="SpineAnimation",this.scale.set(.01,.01,.01),this.json=a,this.atlas=r,this.textures=d,this.skin=this.getSkins().length>0?this.getSkins()[0].name:null,this.animation=this.getAnimations().length>0?this.getAnimations()[0].name:null,this.track=0,this.loop=!0,this.clock=new l.Clock,this.play()}function Di(a,r,h,d,y,b){l.SpotLight.call(this,a,r,h,d,y,b),this.name="spotlight",this.castShadow=!0,this.shadow.camera.near=.05,this.shadow.camera.far=5e3,this.shadow.mapSize.width=512,this.shadow.mapSize.height=512}function nc(a){l.Sprite.call(this,a),this.name="sprite"}nh.VERTEX_SIZE=9,rh.prototype=Object.create(Ir.prototype),(Js.prototype=Object.create(eu.prototype)).update=function(a){eu.prototype.update.call(this,a),l.Object3D.prototype.update.call(this)},Js.prototype.onBeforeRender=function(){this.state.update(this.clock.getDelta()),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform(),this.updateGeometry()},Js.prototype.play=function(){null!==this.animation&&this.setAnimation(this.track,this.animation,this.loop),null!==this.skin&&this.setSkin(this.skin)},Js.prototype.getAnimations=function(){return this.state.data.skeletonData.animations},Js.prototype.setAnimation=function(a,r,h){try{void 0!==a&&(this.track=a),void 0!==r&&(this.animation=r),void 0!==h&&(this.loop=h),this.state.setAnimation(this.track,this.animation,this.loop)}catch{this.animation=null,console.warn("nunuStudio: Error setting spine animation "+name+" on track "+a)}},Js.prototype.getSkins=function(){return this.state.data.skeletonData.skins},Js.prototype.setSkin=function(a){try{this.skeleton.setSkinByName(a),this.skin=a}catch{this.skin=null,console.warn("nunuStudio: Error setting spine skin "+a)}},Js.prototype.toJSON=function(a){var r=[],h=this,d=l.Object3D.prototype.toJSON.call(this,a,function(y){for(var b=0;b<h.textures.length;b++){var N=h.textures[b].texture.toJSON(y);r.push({name:h.textures[b].name,texture:N.uuid})}});return d.object.json=this.json,d.object.atlas=this.atlas,d.object.textures=r,null!==this.animation&&(d.object.animation=this.animation,d.object.track=this.track,d.object.loop=this.loop),null!==this.skin&&(d.object.skin=this.skin),d},(Di.prototype=Object.create(l.SpotLight.prototype)).setTarget=function(a){this.target=a},Di.prototype.updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()},Di.prototype.toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.target=this.target.uuid,r},(nc.prototype=Object.create(l.Sprite.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),l.Object3D.prototype.dispose.call(this)};var td=__webpack_require__(980);function Wi(a){l.Group.call(this),this.type="PythonScript",this.name="script",this.code=void 0!==a?a:Wi.DEFAULT,this.script={},this.program=null,this.scene=null}Wi.prototype=Object.create(l.Group.prototype),Wi.DEFAULT="def initialize(obj, scene, program, keyboard, mouse):\n\t# TODO <ADD CODE HERE>\n\tpass\n\ndef update(delta, obj, scene, program, keyboard, mouse):\n\t# TODO <ADD CODE HERE>\n\tpass",Wi.prototype.initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Po?this.scene=a:a instanceof ii&&(this.program=a);l.Object3D.prototype.initialize.call(this),this.compileCode(this.code),void 0!==this.script.initialize&&this.script.initialize.call(this,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Wi.prototype.update=function(a){if(void 0!==this.script.onMouseOver){var r=this.scene.raycaster.intersectObjects(this.children,!0);r.length>0&&this.script.onMouseOver.call(this,r)}void 0!==this.script.update&&this.script.update.call(this,a,this,this.scene,this.program,this.program.keyboard,this.program.mouse),l.Object3D.prototype.update.call(this,a)},Wi.prototype.dispose=function(){void 0!==this.script.dispose&&this.script.dispose.call(this,this,this.scene,this.program,this.program.keyboard,this.program.mouse),l.Object3D.prototype.dispose.call(this)},Wi.prototype.resize=function(a,r){void 0!==this.script.onResize&&this.script.onResize.call(this,a,r,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Wi.prototype.appData=function(a){void 0!==this.script.onAppData&&this.script.onAppData.call(this,a,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Wi.prototype.compileCode=function(a){var r;try{r=(r=td.python_to_js(a)).substring(r.indexOf("\n")+1,r.lastIndexOf("\n"))}catch(b){throw new Error("Failed to transpile python into javascript code.",b)}for(var h=0;h<En.METHODS.length;h++){var d=En.METHODS[h];r+="\nif(this."+d+' == undefined && typeof $locals___main__["'+d+"\"] !== 'undefined'){this."+d+' = $locals___main__["'+d+'"];}'}var y=new Function(r);try{this.script=new y}catch(b){throw this.script={},console.warn("nunuStudio: Error initializing script code",b),new Error("Error initializing script code")}},Wi.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.code=this.code,r};var Pp=__webpack_require__(573),Pl=__webpack_require__.n(Pp);function Do(a,r,h,d){if(void 0===a.font)throw new Error("TextBitmap configuration font is required.");void 0===a.width&&(a.width=500),void 0===a.align&&(a.align=Do.CENTER),void 0===a.lineHeight&&(a.lineHeight=a.font.common.lineHeight),void 0===a.letterSpacing&&(a.letterSpacing=5),void 0===a.text&&(a.text=""),this.config=a,this.uniforms={map:{type:"t",value:r},color:{type:"v3",value:new l.Color(void 0!==d?d:16777215)},smoothing:{type:"f",value:0},threshold:{type:"f",value:.4}},l.Mesh.call(this,Pl()(this.config),null),this.name="text",this.type="TextBitmap",h=void 0!==h?h:Do.BITMAP;var y=.01;Object.defineProperties(this,{fontScale:{get:function(){return y},set:function(b){y=b,this.updateGeometry()}},shader:{get:function(){return h},set:function(b){h=b,this.updateShader()}},texture:{get:function(){return this.uniforms.map.value},set:function(b){this.uniforms.map.value=b,this.material.needsUpdate=!0}},font:{get:function(){return this.config.font},set:function(b){this.config.font=b,this.updateGeometry()}},text:{get:function(){return this.config.text},set:function(b){this.config.text!==b&&(this.config.text=b,this.updateGeometry())}},lineHeight:{get:function(){return this.config.lineHeight},set:function(b){this.config.lineHeight=b,this.updateGeometry()}},letterSpacing:{get:function(){return this.config.letterSpacing},set:function(b){this.config.letterSpacing=b,this.updateGeometry()}},align:{get:function(){return this.config.align},set:function(b){this.config.align=b,this.updateGeometry()}},width:{get:function(){return this.config.width},set:function(b){this.config.width=b,this.updateGeometry()}},color:{get:function(){return this.uniforms.color.value},set:function(b){this.uniforms.color.value=b}},threshold:{get:function(){return this.uniforms.threshold.value},set:function(b){this.uniforms.threshold.value=b}},smoothing:{get:function(){return this.uniforms.smoothing.value},set:function(b){this.uniforms.smoothing.value=b}}}),this.updateGeometry(),this.updateShader(r)}function Il(a,r){xi.call(this,"text","TextFile"),this.format="string",this.encoding=void 0!==r?r:"txt",this.data=void 0!==a?a:""}function fa(a,r,h,d,y,b,N,k,T,H){eh.call(this,fa.EMPTY_GEOMETRY,r),this.name="text",this.type="TextMesh",this.font=void 0!==h?h:null,this.extruded=void 0===H||H,this.size=void 0!==k?k:1,this.height=void 0!==d?d:.5,this.curveSegments=void 0!==T?T:15,this.bevel=void 0!==y&&y,this.bevelThickness=void 0!==b?b:.1,this.bevelSize=void 0!==N?N:.05,void 0!==a&&(a="text"),Object.defineProperties(this,{text:{get:function(){return a},set:function(Y){a!==Y&&(a=Y,this.updateGeometry())}}}),this.updateGeometry()}function rc(a,r,h,d,y,b,N,k,T,H,Y){l.Texture.call(this,document.createElement("canvas"),h,d,y,b,N,k,T,H,Y),this.name="canvas",this.category="Canvas",this.format=l.RGBAFormat,Object.defineProperties(this,{width:{get:function(){return this.image.width},set:function(le){this.image.width=le}},height:{get:function(){return this.image.height},set:function(le){this.image.height=le}}}),this.width=void 0!==a?a:1,this.height=void 0!==r?r:1,this.context=this.image.getContext("2d")}function tu(){this.texture=new rc,this.canvas=this.texture.image;var a=new l.SpriteMaterial({map:this.texture,color:16777215,transparent:!0,alphaTest:.4,depthTest:!0,depthWrite:!0,sizeAttenuation:!0});l.Sprite.call(this,a),this.name="sprite",this.type="CanvasSprite",Object.defineProperties(this,{sizeAttenuation:{get:function(){return this.material.sizeAttenuation},set:function(r){this.material.sizeAttenuation=r,this.material.needsUpdate=!0}}})}function qa(){tu.call(this),this.name="text",this.type="TextSprite";var a="",r="#FFFFFF",h=!0,d="#000000",y=1,b=32,N=qa.CENTER,k="arial";Object.defineProperties(this,{font:{get:function(){return k},set:function(T){k=T,this.drawText()}},align:{get:function(){return N},set:function(T){N=T,this.drawText()}},color:{get:function(){return r},set:function(T){r=T,this.drawText()}},text:{get:function(){return a},set:function(T){T!==a&&(a=T,this.drawText())}},outline:{get:function(){return h},set:function(T){h=T,this.drawText()}},outlineColor:{get:function(){return d},set:function(T){d=T,this.drawText()}},outlineWidth:{get:function(){return y},set:function(T){y=T,this.drawText()}},resolution:{get:function(){return b},set:function(T){b=T,this.drawText()}}}),this.text="text"}(Do.prototype=Object.create(l.Mesh.prototype)).constructor=Do,Do.BITMAP=100,Do.SDF=101,Do.MSDF=102,Do.LEFT="left",Do.CENTER="center",Do.RIGHT="right",Do.prototype.setText=function(a){this.text=a},Do.prototype.updateShader=function(){this.material=new l.ShaderMaterial({uniforms:this.uniforms,fragmentShader:this.shader===Do.SDF?"/**\r\n * Shader object used to render single channel SDF data.\r\n *\r\n * Contains only the fragment shader code, the vertex is the same for every render mode.\r\n * \r\n * Details about signed distance fields for vetorial shapes rendering.\r\n *    - https:// steamcdn-a.akamaihd.net/apps/valve/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\r\n */\r\nvarying vec2 vUv;\r\nuniform sampler2D map;\r\nuniform vec3 color;\r\nuniform float smoothing;\r\nuniform float threshold;\r\n\r\nvoid main()\r\n{\r\n\tfloat distance = texture2D(map, vUv).a;\r\n\tfloat alpha = smoothstep(threshold - smoothing, threshold + smoothing, distance);\r\n\tgl_FragColor = vec4(color, alpha);\r\n}":this.shader===Do.MSDF?"/*\r\n * Shader object used to render single channel MSDF data.\r\n *\r\n * Contains only the fragment shader code, the vertex is the same for every render mode.\r\n * \r\n * Details about Multi\u2010Channel Signed Distance Fields for vetorial shapes rendering.\r\n *    - https:// onlinelibrary.wiley.com/doi/full/10.1111/cgf.13265\r\n */\r\n\r\nvarying vec2 vUv;\r\nuniform sampler2D map;\r\nuniform vec3 color;\r\nuniform float smoothing;\r\nuniform float threshold;\r\n\r\nfloat median(float r, float g, float b)\r\n{\r\n\treturn max(min(r, g), min(max(r, g), b));\r\n}\r\n\r\nvoid main()\r\n{\r\n\tvec3 smpl = texture2D(map, vUv).rgb;\r\n\tfloat sigDist = median(smpl.r, smpl.g, smpl.b) - 0.5;\r\n\tfloat alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\r\n\tgl_FragColor = vec4(color, 1.0 - alpha);\r\n}\r\n":"/**\r\n * Shader object used to render the bitmap directly without any processing.\r\n *\r\n * Contains only the fragment shader code, the vertex is the same for every render mode.\r\n */\r\nvarying vec2 vUv;\r\nuniform sampler2D map;\r\n\r\nvoid main()\r\n{\r\n\tgl_FragColor = texture2D(map, vUv);\r\n}\r\n",vertexShader:"/**\r\n * Vertex shader used to draw the text, is responsible for applying the billboard effect by removing the rotation from the transformation matrix.\r\n */\r\n#define BILLBOARD 0 \r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main()\r\n{\r\n\tvUv = uv;\r\n\t\r\n\t#if BILLBOARD\r\n\t\tmat4 model = modelViewMatrix; \r\n\t\tmodel[0][0] = 1.0;\r\n\t\tmodel[0][1] = 0.0;\r\n\t\tmodel[0][2] = 0.0;\r\n\t\t\r\n\t\tmodel[1][0] = 0.0;\r\n\t\tmodel[1][1] = 1.0;\r\n\t\tmodel[1][2] = 0.0;\r\n\t\t\r\n\t\tmodel[2][0] = 0.0;\r\n\t\tmodel[2][1] = 0.0;\r\n\t\tmodel[2][2] = 1.0;\r\n\t\t\r\n\t\tgl_Position = projectionMatrix * model * vec4(position, 1.0);\r\n\t#else\r\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\t#endif\r\n\t\r\n}",side:l.DoubleSide,transparent:!0,depthTest:!0}),this.material.extensions.derivatives=this.shader===Do.MSDF},Do.prototype.updateGeometry=function(){if(this.geometry.update(this.config),1!==this.fontScale)for(var a=this.geometry.attributes.position.array,r=0;r<a.length;r++)a[r]*=this.fontScale},Do.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.texture=this.texture.toJSON(a).uuid,r.object.fontScale=this.fontScale,r.object.shader=this.shader,r.object.text=this.text,r.object.font=this.font,r.object.lineHeight=this.lineHeight,r.object.letterSpacing=this.letterSpacing,r.object.align=this.align,r.object.width=this.width,r.object.color=this.color,r.object.threshold=this.threshold,r.object.smoothing=this.smoothing,r},Do.fromJSON=function(a,r){var h=new Do(a,r,a.shader);return h.color=a.color,h.threshold=a.threshold,h.smoothing=a.smoothing,h.fontScale=a.fontScale,h},Il.prototype=Object.create(xi.prototype),Il.extensions=[".js",".txt",".glsl",".json",".xml",".yaml",".csv",".css",".html"],Il.fileIsText=function(a){a=a.name.toLocaleLowerCase();for(var r=0;r<Il.extensions.length;r++)if(a.endsWith(Il.extensions[r]))return!0;return!1},Il.prototype.toJSON=function(a){if(void 0!==a.resources[this.uuid])return a.resources[this.uuid];var r=xi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.data=this.data,r.format=this.format,a.resources[this.uuid]=r,r},fa.prototype=Object.create(eh.prototype),fa.EMPTY_GEOMETRY=new l.Geometry,fa.prototype.setFont=function(a){this.font!==a&&(this.font=a,this.updateGeometry())},fa.prototype.setText=function(a){this.text=a},fa.prototype.updateGeometry=function(){if(null!==this.font){if(void 0!==this.geometry&&this.geometry.dispose(),!0!==this.font.isFont)return console.warn("nunuStudio: Font parameter is not an instance of Font."),void(this.geometry=fa.EMPTY_GEOMETRY);var a=this.font.generateShapes(this.text,this.size);this.extruded?(this.geometry=new l.ExtrudeBufferGeometry(a,{curveSegments:this.curveSegments,depth:this.height,bevelEnabled:this.bevel,bevelSize:this.bevelSize,bevelThickness:this.bevelThickness}),this.geometry.computeVertexNormals()):this.geometry=new l.ShapeBufferGeometry(a,this.curveSegments)}},fa.prototype.clone=function(){return new fa(this.text,this.material,this.font,this.height,this.bevel,this.bevelThickness,this.bevelSize,this.size,this.curveSegments)},fa.prototype.toJSON=function(a){var r=this.geometry;this.geometry=void 0;var h=this.font,d=l.Object3D.prototype.toJSON.call(this,a,function(y,b){h=h.toJSON(y)});return d.object.text=this.text,d.object.font=h.uuid,d.object.size=this.size,d.object.curveSegments=this.curveSegments,d.object.height=this.height,d.object.bevel=this.bevel,d.object.bevelThickness=this.bevelThickness,d.object.bevelSize=this.bevelSize,d.object.extruded=this.extruded,this.geometry=r,d},(rc.prototype=Object.create(l.Texture.prototype)).constructor=rc,rc.prototype.isCanvasTexture=!0,rc.prototype.placeholder=function(){this.context.fillStyle="#000000",this.context.fillRect(0,0,this.width,this.height),this.context.font="Normal "+Math.round(this.width/12)+"px Arial",this.context.textAlign="center",this.context.fillStyle="#FF0000",this.context.fillText("Canvas Texture",this.width/2,this.height/2),this.needsUpdate=!0},rc.prototype.clear=function(a){void 0===a?this.context.clearRect(0,0,width,height):(this.context.fillStyle=a,this.context.fillRect(0,0,this.width,this.height))},rc.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.width=this.width,r.height=this.height,r},tu.prototype=Object.create(l.Sprite.prototype),qa.prototype=Object.create(tu.prototype),qa.LEFT="left",qa.CENTER="center",qa.RIGHT="right",qa.prototype.drawText=function(){var a=this.resolution,r=.8*a,h=this.texture.context;h.font=r+"px "+this.font;var d=h.measureText(this.text).width,y=l.Math.ceilPowerOfTwo(d),b=y/a;this.texture.width=y,this.texture.height=a,h.clearRect(0,0,y,a),0!==this.text.length&&(h.font=r+"px "+this.font,h.textAlign=this.align,h.textBaseline="middle",h.fillStyle=this.color,h.fillText(this.text,y/2,a/2),!0===this.outline&&(h.lineWidth=this.outlineWidth,h.strokeStyle=this.outlineColor,h.strokeText(this.text,y/2,a/2)),this.scale.x=b*this.scale.y,this.texture.needsUpdate=!0)},qa.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.text=this.text,r.object.color=this.color,r.object.outline=this.outline,r.object.outlineColor=this.outlineColor,r.object.outlineWidth=this.outlineWidth,r.object.resolution=this.resolution,r.object.align=this.align,r.object.font=this.font,r},qa.fromJSON=function(a){var r=new qa;return r.text=a.text,r.color=a.color,r.outline=a.outline,r.outlineColor=a.outlineColor,r.outlineWidth=a.outlineWidth,r.resolution=a.resolution,r.align=a.align,r.font=a.font,r};var Sd=__webpack_require__(412);function Au(){l.Mesh.call(this,new l.BufferGeometry,new l.MeshBasicMaterial({depthWrite:!1,colorWrite:!1})),this.name="billboard",this.type="BillboardGroup"}function $u(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.textures={}}function Cu(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.path="",this.crossOrigin="Anonymous"}function Ol(a,r,h,d,y,b){l.BufferGeometry.call(this),this.type="TerrainBufferGeometry",this.parameters={width:a||1,height:r||1,widthSegments:h||10,heightSegments:d||10,scale:y||1},this.image=b,this.generate()}function nu(a,r,h,d,y){l.BufferGeometry.call(this),this.type="RoundedBoxBufferGeometry",y=isNaN(y)?1:Math.max(1,Math.floor(y)),a=isNaN(a)?1:a,r=isNaN(r)?1:r,h=isNaN(h)?1:h,d=isNaN(d)?.15:d;var b=a/2-(d=Math.min(d,Math.min(a,Math.min(r,Math.min(h)))/2)),N=r/2-d,k=h/2-d;this.parameters={width:a,height:r,depth:h,radius:d,radiusSegments:y};var Qe,it,ct,T=y+1,H=T*y+1<<3,Y=new l.BufferAttribute(new Float32Array(3*H),3),le=new l.BufferAttribute(new Float32Array(3*H),3),ae=[],ge=[],we=(new l.Vector3,new l.Vector3),Se=[],$e=[],Re=[],Pe=T*y,Oe=Pe+1;(function(){for(var Qe=[new l.Vector3(1,1,1),new l.Vector3(1,1,-1),new l.Vector3(-1,1,-1),new l.Vector3(-1,1,1),new l.Vector3(1,-1,1),new l.Vector3(1,-1,-1),new l.Vector3(-1,-1,-1),new l.Vector3(-1,-1,1)],it=0;it<8;it++)ae.push([]),ge.push([]);for(var ct=Math.PI/2,_t=new l.Vector3(b,N,k),$t=0;$t<=y;$t++){var rn=$t/y*ct,Dt=Math.cos(rn),Lt=Math.sin(rn);if($t!==y)for(var Ct=0;Ct<=y;Ct++){var ut=Ct/y*ct;we.x=Dt*Math.cos(ut),we.y=Lt,we.z=Dt*Math.sin(ut),Tt=we.clone().multiplyScalar(d).add(_t),ae[0].push(Tt),Se.push(Tt),Qt=we.clone().normalize(),ge[0].push(Qt),$e.push(Qt)}else{we.set(0,1,0);var Tt=we.clone().multiplyScalar(d).add(_t);ae[0].push(Tt),Se.push(Tt);var Qt=we.clone();ge[0].push(Qt),$e.push(Qt)}}for(var vn=1;vn<8;vn++)for(it=0;it<ae[0].length;it++)Tt=ae[0][it].clone().multiply(Qe[vn]),ae[vn].push(Tt),Se.push(Tt),Qt=ge[0][it].clone().multiply(Qe[vn]),ge[vn].push(Qt),$e.push(Qt)})(),Re.push(Qe=Pe,it=Pe+Oe,ct=Pe+2*Oe,Qe,ct,Pe+3*Oe),Re.push(Qe=Pe+4*Oe,ct=Pe+6*Oe,it=Pe+5*Oe,Qe,Pe+7*Oe,ct),Re.push(Qe=0,ct=4*Oe,it=Oe,it,ct,5*Oe),Re.push(Qe=2*Oe,ct=6*Oe,it=3*Oe,it,ct,7*Oe),Re.push(Qe=y,it=y+3*Oe,ct=y+4*Oe,it,y+7*Oe,ct),Re.push(Qe=y+Oe,ct=y+5*Oe,it=y+2*Oe,it,ct,y+6*Oe),function(){for(var Qe=[!0,!1,!0,!1,!1,!0,!1,!0],it=T*(y-1),ct=0;ct<8;ct++){for(var _t=Oe*ct,$t=0;$t<y-1;$t++)for(var rn=$t*T,Dt=($t+1)*T,Lt=0;Lt<y;Lt++){var Ct=Lt+1,ut=_t+rn+Lt,Tt=_t+rn+Ct,Qt=_t+Dt+Lt,vn=_t+Dt+Ct;Qe[ct]?Re.push(ut,Qt,Tt,Tt,Qt,vn):Re.push(ut,Tt,Qt,Tt,vn,Qt)}for(Lt=0;Lt<y;Lt++)ut=_t+it+Lt,Tt=_t+it+Lt+1,Qt=_t+Pe,Qe[ct]?Re.push(ut,Qt,Tt):Re.push(ut,Tt,Qt)}}(),function(){for(var Qe=0;Qe<4;Qe++)for(var it=Qe*Oe,ct=4*Oe+it,_t=!0&Qe,$t=0;$t<y;$t++){var rn=$t+1,Dt=it+$t,Lt=it+rn,Ct=ct+$t,ut=ct+rn;_t?Re.push(Dt,Ct,Lt,Lt,Ct,ut):Re.push(Dt,Lt,Ct,Lt,ut,Ct)}}(),function(){for(var Qe=y-1,it=[0,1,4,5],ct=[3,2,7,6],_t=[0,1,1,0],$t=0;$t<4;$t++)for(var rn=it[$t]*Oe,Dt=ct[$t]*Oe,Lt=0;Lt<=Qe;Lt++){var Ct=rn+y+Lt*T,ut=rn+(Lt!==Qe?y+(Lt+1)*T:Oe-1),Tt=Dt+y+Lt*T,Qt=Dt+(Lt!==Qe?y+(Lt+1)*T:Oe-1);_t[$t]?Re.push(Ct,Tt,ut,ut,Tt,Qt):Re.push(Ct,ut,Tt,ut,Qt,Tt)}}(),function(){for(var Qe=[0,2,4,6],it=[1,3,5,7],ct=0;ct<4;ct++)for(var _t=Oe*Qe[ct],$t=Oe*it[ct],rn=1>=ct,Dt=0;Dt<y;Dt++){var Lt=Dt*T,Ct=(Dt+1)*T,ut=_t+Lt,Tt=_t+Ct,Qt=$t+Lt,vn=$t+Ct;rn?Re.push(ut,Qt,Tt,Tt,Qt,vn):Re.push(ut,Tt,Qt,Tt,vn,Qt)}}();for(var Fe=0,De=0;De<Se.length;De++)Y.setXYZ(Fe,Se[De].x,Se[De].y,Se[De].z),le.setXYZ(Fe,$e[De].x,$e[De].y,$e[De].z),Fe++;this.setIndex(new l.BufferAttribute(new Uint16Array(Re),1)),this.addAttribute("position",Y),this.addAttribute("normal",le)}function Lc(a,r,h,d,y,b,N,k,T){l.BufferGeometry.call(this),this.type="CapsuleBufferGeometry",this.parameters={radiusTop:a,radiusBottom:r,height:h,radialSegments:d,heightSegments:y,capsTopSegments:b,capsBottomSegments:N,thetaStart:k,thetaLength:T},a=void 0!==a?a:1,r=void 0!==r?r:1,h=void 0!==h?h:2,d=Math.floor(d)||8,y=Math.floor(y)||1,b=Math.floor(b)||2,N=Math.floor(N)||2,k=void 0!==k?k:0,T=void 0!==T?T:2*Math.PI;var H=Math.acos((r-a)/h),Y=(d+1)*(y+1+N+b),le=d*(y+N+b)*2*3,ae=new l.BufferAttribute(new(le>65535?Uint32Array:Uint16Array)(le),1),ge=new l.BufferAttribute(new Float32Array(3*Y),3),we=new l.BufferAttribute(new Float32Array(3*Y),3),Se=new l.BufferAttribute(new Float32Array(2*Y),2),$e=0,Re=0,Pe=[],Oe=h/2;(function(){var Fe,De,Qe=new l.Vector3,it=new l.Vector3,ct=Math.cos(H),_t=Math.sin(H),$t=new l.Vector2(a*_t,Oe+a*ct).sub(new l.Vector2(r*_t,r*ct-Oe)).length(),rn=a*H+$t+r*(Math.PI/2-H),Dt=0;for(De=0;De<=b;De++){var Lt=[],Ct=Math.PI/2-H*(De/b);Dt+=a*H/b;var ut=Math.cos(Ct),Tt=Math.sin(Ct),Qt=ut*a;for(Fe=0;Fe<=d;Fe++){var vn=(Jn=Fe/d)*T+k,gn=Math.sin(vn),fr=Math.cos(vn);it.x=Qt*gn,it.y=Oe+Tt*a,it.z=Qt*fr,ge.setXYZ($e,it.x,it.y,it.z),Qe.set(ut*gn,Tt,ut*fr),we.setXYZ($e,Qe.x,Qe.y,Qe.z),Se.setXY($e,Jn,1-Dt/rn),Lt.push($e),$e++}Pe.push(Lt)}var sr=h+ct*a-ct*r,Rn=_t*(r-a)/sr;for(De=1;De<=y;De++){for(Lt=[],Dt+=$t/y,Qt=_t*(De*(r-a)/y+a),Fe=0;Fe<=d;Fe++)vn=(Jn=Fe/d)*T+k,gn=Math.sin(vn),fr=Math.cos(vn),it.x=Qt*gn,it.y=Oe+ct*a-De*sr/y,it.z=Qt*fr,ge.setXYZ($e,it.x,it.y,it.z),Qe.set(gn,Rn,fr).normalize(),we.setXYZ($e,Qe.x,Qe.y,Qe.z),Se.setXY($e,Jn,1-Dt/rn),Lt.push($e),$e++;Pe.push(Lt)}for(De=1;De<=N;De++){for(Lt=[],Ct=Math.PI/2-H-(Math.PI-H)*(De/N),Dt+=r*H/N,ut=Math.cos(Ct),Tt=Math.sin(Ct),Qt=ut*r,Fe=0;Fe<=d;Fe++){var Jn;vn=(Jn=Fe/d)*T+k,gn=Math.sin(vn),fr=Math.cos(vn),it.x=Qt*gn,it.y=Tt*r-Oe,it.z=Qt*fr,ge.setXYZ($e,it.x,it.y,it.z),Qe.set(ut*gn,Tt,ut*fr),we.setXYZ($e,Qe.x,Qe.y,Qe.z),Se.setXY($e,Jn,1-Dt/rn),Lt.push($e),$e++}Pe.push(Lt)}for(Fe=0;Fe<d;Fe++)for(De=0;De<b+y+N;De++){var Er=Pe[De+1][Fe],vi=Pe[De+1][Fe+1],no=Pe[De][Fe+1];ae.setX(Re,Pe[De][Fe]),Re++,ae.setX(Re,Er),Re++,ae.setX(Re,no),Re++,ae.setX(Re,Er),Re++,ae.setX(Re,vi),Re++,ae.setX(Re,no),Re++}})(),this.setIndex(ae),this.setAttribute("position",ge),this.setAttribute("normal",we),this.setAttribute("uv",Se)}function Th(a,r,h){var d=this.compile(a);l.ParametricBufferGeometry.call(this,d,r,h),this.type="ParametricBufferGeometry",this.parameters={code:a,slices:r,stacks:h}}function Ds(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.withCredentials=!1}function Lu(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.shapes={},this.images={}}function ih(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function Mh(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function Zs(a,r,h,d,y){var b=document.createElement("video");b.autoplay=!0,b.loop=!0,l.Texture.call(this,b,a,r,h,l.LinearFilter,l.LinearFilter,l.RGBFormat,d,y);var N=this;this.generateMipmaps=!1,this.disposed=!1,this.name="webcam",this.category="Webcam",this.mode=Zs.USER,this.stream=null,this.connect(),requestAnimationFrame(function k(){b.readyState>=b.HAVE_CURRENT_DATA&&(N.needsUpdate=!0),N.disposed||requestAnimationFrame(k)})}function kl(a,r){xi.call(this,"video","Video"),void 0!==a&&(a instanceof ArrayBuffer?this.loadArrayBufferData(a,r):ci.isBase64(a)?(this.encoding=ci.getFileFormat(a),this.format="base64",this.data=a):this.loadArrayBufferData(Bn.readFileArrayBuffer(a),Bn.getFileExtension(a)))}function Ps(a,r,h,d,y,b){l.Texture.call(this,document.createElement("video"),r,h,d,l.LinearFilter,l.LinearFilter,l.RGBFormat,y,b),this.disposed=!1,this.generateMipmaps=!1,this.name="video",this.category="Video",this.autoplay=!0,this.loop=!0,this.playbackRate=1,this.volume=1,this.image.crossOrigin="anonymous",this.image.autoplay=this.autoplay,this.image.playbackRate=this.playbackRate,this.image.loop=this.loop,this.image.volume=this.volume,this.video=null,this.setVideo(a);var N=this;!function k(){N.disposed||(N.image.readyState>=N.image.HAVE_CURRENT_DATA&&(N.needsUpdate=!0),requestAnimationFrame(k))}()}function Xa(a,r,h,d,y,b,N){bs.call(this,a,y,l.RepeatWrapping,l.RepeatWrapping,l.LinearFilter,l.LinearFilter,l.RGBFormat,b,N),this.name="animation",this.category="SpriteSheet",this.disposed=!1,this.format=this.source.hasTransparency()?l.RGBAFormat:l.RGBFormat,this.repeat.set(1/r,1/h),this.loop=!0,this.animationSpeed=.1,this._totalFrames=d,this._beginFrame=0,this._endFrame=0,this._framesHorizontal=r,this._framesVertical=h;var k=this;Object.defineProperties(this,{framesHorizontal:{get:function(){return this._framesHorizontal},set:function(T){this._framesHorizontal=T,this.repeat.x=1/T,this.totalFrames=this._framesHorizontal*this._framesVertical}},framesVertical:{get:function(){return this._framesVertical},set:function(T){this._framesVertical=T,this.repeat.y=1/T,this.totalFrames=this._framesHorizontal*this._framesVertical}},endFrame:{get:function(){return this._endFrame},set:function(T){T>this._totalFrames&&(T=this._totalFrames),this._endFrame=T}},beginFrame:{get:function(){return this._beginFrame},set:function(T){T<0&&(T=0),this.currentFrame=T,this._beginFrame=T}},totalFrames:{get:function(){return this._totalFrames},set:function(T){this._beginFrame=0,this._endFrame=T,this._totalFrames=T}}}),this.currentFrame=0,function T(){k.disposed||(k.step(),setTimeout(T,1e3*k.animationSpeed))}()}function La(a,r,h,d,y,b,N,k,T,H,Y,le){l.Texture.call(this,null,b,N,k,T,H,d,y,Y,le),this.category="DataTexture",this.image={data:a||null,width:r||1,height:h||1},this.magFilter=void 0!==T?T:NearestFilter,this.minFilter=void 0!==H?H:NearestFilter,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}function Bc(a,r,h,d,y,b,N,k,T,H,Y,le){l.Texture.call(this,null,b,N,k,T,H,d,y,Y,le),this.category="Compressed",this.image={width:r,height:h},this.mipmaps=a,this.isCubeTexture=!1,this.flipY=!1,this.generateMipmaps=!1}function dl(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.path="",this.crossOrigin="anonymous",this.images=[],this.videos=[],this.fonts=[]}function Bu(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function Zi(a){B.call(this),this.manager=void 0!==a?a:l.DefaultLoadingManager,this.texturePath=""}(Au.prototype=Object.create(l.Mesh.prototype)).constructor=Au,Au.prototype.isScene=!0,Au.prototype.onBeforeRender=function(a,r,h,d,y,b){var N=new Sd.Quaternion;h.getWorldQuaternion(N),this.quaternion.copy(N)},$u.prototype.load=function(a,r,h,d){var y=this;new FileLoader(y.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,d)},$u.prototype.setTextures=function(a){this.textures=a},$u.prototype.parse=function(a){var r=l.MaterialLoader.prototype.parse.call(this,a);if(void 0!==a.materials)for(var h=0,d=a.materials.length;h<d;h++)r.materials.push(this.parse(a.materials[h]));return r},Cu.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},Cu.prototype.setPath=function(a){return this.path=a,this},Cu.prototype.loadJSON=function(a,r,h,d){var y=this;new l.FileLoader(this.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,d)},Cu.prototype.parse=function(a){var r=new ys(void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,a.encoding);return r.name=a.name,r.uuid=a.uuid,void 0!==a.width&&(r.width=a.width,r.height=a.height),r},Ol.prototype=Object.create(l.BufferGeometry.prototype),Ol.constructor=Ol,Ol.prototype.generate=function(){var a=this.parameters.width,r=this.parameters.height,h=this.parameters.widthSegments,d=this.parameters.heightSegments,y=this.parameters.scale,b=this;this.image.getImageData(function(N,k,T){for(var Qt,vn,gn,H=a/2,Y=r/2,le=Math.floor(h)||1,ae=le+1,ge=Math.floor(d)||1,we=a/le,Se=r/ge,$e=[],Re=[],Pe=[],Oe=[],Fe=k/(a+1),De=T/(r+1),it=0;it<=ge;it++)for(var ct=it*Se-Y,_t=0;_t<=le;_t++){var $t=_t*we-H,rn=(Qt=ct,void 0,void 0,vn=Math.round(($t+H)*Fe),gn=Math.round((Qt+Y)*De)*(4*k)+4*vn,N.data[gn]/255*y);Re.push($t,rn,ct),Pe.push(0,1,0),Oe.push(_t/le),Oe.push(1-it/ge)}for(it=0;it<ge;it++)for(_t=0;_t<le;_t++){var Lt=_t+ae*(it+1),Ct=_t+1+ae*(it+1),ut=_t+1+ae*it;$e.push(_t+ae*it,Lt,ut),$e.push(Lt,Ct,ut)}b.setIndex($e),b.setAttribute("position",new l.Float32BufferAttribute(Re,3)),b.setAttribute("normal",new l.Float32BufferAttribute(Pe,3)),b.setAttribute("uv",new l.Float32BufferAttribute(Oe,2)),b.computeVertexNormals(),b.boundingBox=null,b.boundingSphere=null})},Ol.prototype.toJSON=function(){var a=l.BufferGeometry.prototype.toJSON.call(this);return a.image=this.image.uuid,a},nu.prototype=Object.create(l.BufferGeometry.prototype),nu.constructor=nu,(Lc.prototype=Object.create(l.BufferGeometry.prototype)).constructor=Lc,(Th.prototype=Object.create(l.ParametricBufferGeometry.prototype)).compile=function(a){try{return new Function("u, v, target","target = target || new Vector3();\n"+a)}catch(r){console.error("nunuStudio: Error occured while compiling ParametricBufferGeometry code.",r)}return function(r,h,d){return d||new l.Vector3}},Ds.prototype.load=function(a,r,h,d){var y=this,b=void 0===this.path?LoaderUtils.extractUrlBase(a):this.path,N=new l.FileLoader(this.manager);N.setPath(this.path),N.setWithCredentials(this.withCredentials),N.load(a,function(k){var T=JSON.parse(k),H=T.metadata;if(void 0!==H){var Y=H.type;if(void 0!==Y&&"object"===Y.toLowerCase())return void console.error("nunuStudio: LegacyGeometryLoader: "+a+" should be loaded with ObjectLoader instead.")}var le=y.parse(T,b);r(le.geometry,le.materials)},h,d)},Ds.prototype.setPath=function(a){return this.path=a,this},Ds.prototype.setResourcePath=function(a){return this.resourcePath=a,this},Ds.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},Ds.prototype.parse=function(a,r){void 0!==a.data&&(a=a.data),a.scale=void 0!==a.scale?1/a.scale:1;var h=new l.Geometry;return function(d,y){function b(Jn,Kn){return Jn&1<<Kn}var N,k,T,H,Y,le,ae,ge,we,Se,$e,Re,Pe,Oe,Fe,De,Qe,it,ct,_t,$t,rn,Dt,Lt,Ct,ut,Qt=d.faces,vn=d.vertices,gn=d.normals,fr=d.colors,sr=d.scale,Rn=0;if(void 0!==d.uvs){for(N=0;N<d.uvs.length;N++)d.uvs[N].length&&Rn++;for(N=0;N<Rn;N++)y.faceVertexUvs[N]=[]}for(H=0,Y=vn.length;H<Y;)(it=new l.Vector3).x=vn[H++]*sr,it.y=vn[H++]*sr,it.z=vn[H++]*sr,y.vertices.push(it);for(H=0,Y=Qt.length;H<Y;)if($e=b(Se=Qt[H++],0),Re=b(Se,1),Pe=b(Se,3),Oe=b(Se,4),Fe=b(Se,5),De=b(Se,6),Qe=b(Se,7),$e){if((_t=new l.Face3).a=Qt[H],_t.b=Qt[H+1],_t.c=Qt[H+3],($t=new l.Face3).a=Qt[H+1],$t.b=Qt[H+2],$t.c=Qt[H+3],H+=4,Re&&(we=Qt[H++],_t.materialIndex=we,$t.materialIndex=we),T=y.faces.length,Pe)for(N=0;N<Rn;N++)for(Lt=d.uvs[N],y.faceVertexUvs[N][T]=[],y.faceVertexUvs[N][T+1]=[],k=0;k<4;k++)ut=Lt[2*(ge=Qt[H++])],Ct=new l.Vector2(ut,Lt[2*ge+1]),2!==k&&y.faceVertexUvs[N][T].push(Ct),0!==k&&y.faceVertexUvs[N][T+1].push(Ct);if(Oe&&(ae=3*Qt[H++],_t.normal.set(gn[ae++],gn[ae++],gn[ae]),$t.normal.copy(_t.normal)),Fe)for(N=0;N<4;N++)ae=3*Qt[H++],Dt=new l.Vector3(gn[ae++],gn[ae++],gn[ae]),2!==N&&_t.vertexNormals.push(Dt),0!==N&&$t.vertexNormals.push(Dt);if(De&&(rn=fr[le=Qt[H++]],_t.color.setHex(rn),$t.color.setHex(rn)),Qe)for(N=0;N<4;N++)rn=fr[le=Qt[H++]],2!==N&&_t.vertexColors.push(new Color(rn)),0!==N&&$t.vertexColors.push(new Color(rn));y.faces.push(_t),y.faces.push($t)}else{if((ct=new l.Face3).a=Qt[H++],ct.b=Qt[H++],ct.c=Qt[H++],Re&&(we=Qt[H++],ct.materialIndex=we),T=y.faces.length,Pe)for(N=0;N<Rn;N++)for(Lt=d.uvs[N],y.faceVertexUvs[N][T]=[],k=0;k<3;k++)ut=Lt[2*(ge=Qt[H++])],Ct=new l.Vector2(ut,Lt[2*ge+1]),y.faceVertexUvs[N][T].push(Ct);if(Oe&&(ae=3*Qt[H++],ct.normal.set(gn[ae++],gn[ae++],gn[ae])),Fe)for(N=0;N<3;N++)ae=3*Qt[H++],Dt=new l.Vector3(gn[ae++],gn[ae++],gn[ae]),ct.vertexNormals.push(Dt);if(De&&(le=Qt[H++],ct.color.setHex(fr[le])),Qe)for(N=0;N<3;N++)le=Qt[H++],ct.vertexColors.push(new Color(fr[le]));y.faces.push(ct)}}(a,h),function(d,y){var b=void 0!==d.influencesPerVertex?d.influencesPerVertex:2;if(d.skinWeights)for(var N=0,k=d.skinWeights.length;N<k;N+=b)y.skinWeights.push(new Vector4(d.skinWeights[N],b>1?d.skinWeights[N+1]:0,b>2?d.skinWeights[N+2]:0,b>3?d.skinWeights[N+3]:0));if(d.skinIndices)for(N=0,k=d.skinIndices.length;N<k;N+=b)y.skinIndices.push(new Vector4(d.skinIndices[N],b>1?d.skinIndices[N+1]:0,b>2?d.skinIndices[N+2]:0,b>3?d.skinIndices[N+3]:0));y.bones=d.bones,y.bones&&y.bones.length>0&&(y.skinWeights.length!==y.skinIndices.length||y.skinIndices.length!==y.vertices.length)&&console.warn("nunuStudio: When skinning, number of vertices ("+y.vertices.length+"), skinIndices ("+y.skinIndices.length+"), and skinWeights ("+y.skinWeights.length+") should match.")}(a,h),function(d,y){var b=d.scale;if(void 0!==d.morphTargets)for(var N=0,k=d.morphTargets.length;N<k;N++){y.morphTargets[N]={},y.morphTargets[N].name=d.morphTargets[N].name,y.morphTargets[N].vertices=[];for(var T=y.morphTargets[N].vertices,H=d.morphTargets[N].vertices,Y=0,le=H.length;Y<le;Y+=3){var ae=new l.Vector3;ae.x=H[Y]*b,ae.y=H[Y+1]*b,ae.z=H[Y+2]*b,T.push(ae)}}if(void 0!==d.morphColors&&d.morphColors.length>0){var ge=y.faces,we=d.morphColors[0].colors;for(N=0,k=ge.length;N<k;N++)ge[N].color.fromArray(we,3*N)}}(a,h),function(d,y){var b=[],N=[];void 0!==d.animation&&N.push(d.animation),void 0!==d.animations&&(d.animations.length?N=N.concat(d.animations):N.push(d.animations));for(var k=0;k<N.length;k++){var T=l.AnimationClip.parseAnimation(N[k],y.bones);T&&b.push(T)}if(y.morphTargets){var H=l.AnimationClip.CreateClipsFromMorphTargetSequences(y.morphTargets,10);b=b.concat(H)}b.length>0&&(y.animations=b)}(a,h),h.computeFaceNormals(),h.computeBoundingSphere(),void 0===a.materials||0===a.materials.length?{geometry:h}:{geometry:h,materials:Loader.prototype.initMaterials(a.materials,this.resourcePath||r,this.crossOrigin)}},Lu.prototype.setImages=function(a){return this.images=a,this},Lu.prototype.setShapes=function(a){return this.shapes=a,this},Lu.prototype.load=function(a,r,h,d){new l.FileLoader(this.manager).load(a,function(y){r(self.parse(JSON.parse(y)))},h,d)},Lu.prototype.parse=function(a){var r=null;if("CapsuleBufferGeometry"===a.type)r=new Lc(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.capsTopSegments,a.capsBottomSegments,a.thetaStart,a.thetaLength);else if("RoundedBoxBufferGeometry"===a.type)r=new nu(a.width,a.height,a.depth,a.radius,a.radiusSegments);else if("TerrainBufferGeometry"===a.type)r=new Ol(a.width,a.height,a.widthSegments,a.heightSegments,a.scale,this.images[a.image]);else if("ParametricBufferGeometry"===a.type)r=new Th(a.code,a.slices,a.stacks);else if("Geometry"===a.type)r=(new Ds).parse(a.data).geometry;else{var h=l.ObjectLoader.prototype.parseGeometries([a],this.shapes);for(var d in h){r=h[d];break}}return r.uuid=a.uuid,r.name=void 0!==a.name?a.name:"geometry",r},ih.prototype.load=function(a,r,h,d){new l.FileLoader(this.manager).load(a,function(y){r(new Xe(JSON.parse(y)))},h,d)},ih.prototype.parse=function(a){if(void 0!==a.data){var r=new Xe;return r.name=a.name,r.uuid=a.uuid,r.encoding=a.encoding,void 0!==a.reversed&&(r.reversed=a.reversed),"arraybuffer"===a.format?(r.format=a.format,r.data=void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,r.loadTTF()):"base64"===a.format?(r.format="arraybuffer",r.data=pa.fromBase64(a.data),r.loadTTF()):(r.format=a.format,r.data=a.data,r.font=a.data),r}return new Xe(a)},Mh.prototype.load=function(a,r,h,d){new l.FileLoader(this.manager).load(a,function(y){r(self.parse(JSON.parse(y)))},h,d)},Mh.prototype.parse=function(a){var r=new Nt;return r.name=a.name,r.uuid=a.uuid,r.encoding=a.encoding,"base64"===a.format?(r.format="arraybuffer",r.data=pa.fromBase64(a.data)):"arraybuffer"===a.format?(r.format=a.format,r.data=void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data):(r.format=a.format,r.data=a.data),r},Zs.USER=21,Zs.ENVIRONMENT=22,(Zs.prototype=Object.create(l.Texture.prototype)).constructor=Zs,Zs.isTexture=!0,Zs.prototype.connect=function(){var a={facingMode:this.mode===Zs.USER?"user":{exact:"environment"}},r=this;void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:a}).then(function(h){r.stream=h,r.image.srcObject=h,r.image.play()}).catch(function(h){console.warn("nunuStudio: No webcam available")}):navigator.getUserMedia&&navigator.getUserMedia({video:!0},function(h){r.stream=h,r.image.src=URL.createObjectURL(h)},function(h){console.warn("nunuStudio: No webcam available")})},Zs.prototype.disconnect=function(){if(null!==this.stream)for(var a=this.stream.getTracks(),r=0;r<a.length;r++)a[r].stop()},Zs.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disconnect(),this.disposed=!0,this.image.paused||this.image.pause()},Zs.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.mode=this.mode,r},kl.prototype=Object.create(xi.prototype),kl.fileIsVideo=function(a){return!(void 0===a||!a.type.startsWith("video"))},kl.prototype.loadArrayBufferData=function(a,r){var h=new Uint8Array(a),d=new Blob([h],{type:"video/"+r});this.data=URL.createObjectURL(d),this.arraybuffer=a,this.encoding=r,this.format="arraybuffer"},kl.prototype.toJSON=function(a){if(void 0!==a.videos[this.uuid])return a.videos[this.uuid];var r=xi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,"arraybuffer"===this.format?(r.format=this.format,r.data=this.arraybuffer):"base64"===this.format?(r.format="arraybuffer",r.data=pa.fromBase64(ci.removeHeader(this.data))):(r.format=this.format,r.data=this.data),a.videos[this.uuid]=r,r},Ps.prototype=Object.create(l.Texture.prototype),Ps.isVideoTexture=!0,Ps.prototype.setVideo=function(a){if(null==a)return this.video=null,void(this.image.src=null);this.video="string"==typeof a?new kl(a):a,this.image.src=this.video.data},Ps.prototype.setTime=function(a){this.image.currentTime=a},Ps.prototype.setLoop=function(a){this.loop=a,this.image.loop=a},Ps.prototype.setVolume=function(a){this.volume=a>=0&&a<=1?a:a>=0?1:0,this.image.volume=this.volume},Ps.prototype.setAutoPlay=function(a){this.autoplay=a,this.image.autoplay=this.autoplay},Ps.prototype.setPlaybackRate=function(a){this.playbackRate=a,this.image.playbackRate=a},Ps.prototype.pause=function(){this.image.paused||this.image.pause()},Ps.prototype.play=function(){this.image.paused&&this.image.play()},Ps.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disposed=!0,this.image.pause(),this.image.src="",this.image.load()},Ps.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a),h=this.video.toJSON(a);return r.video=h.uuid,r.loop=this.loop,r.autoplay=this.autoplay,r.playbackRate=this.playbackRate,r.volume=this.volume,r},Xa.prototype=Object.create(bs.prototype),Xa.isTexture=!0,Xa.prototype.step=function(){this.currentFrame++,this.currentFrame>=this._endFrame&&(this.currentFrame=this._beginFrame),this.offset.x=this.currentFrame%this.framesHorizontal/this.framesHorizontal,this.offset.y=1-this.repeat.y-Math.floor(this.currentFrame/this.framesHorizontal)/this.framesVertical},Xa.prototype.setAnimationSpeed=function(a){this.animationSpeed=a},Xa.prototype.setFrameGrid=function(a,r){this._framesHorizontal=a,this._framesVertical=r,this._totalFrames=a*r,this.repeat.set(1/a,1/r)},Xa.prototype.setAnimationFrames=function(a,r){this.beginFrame=a,this.endFrame=r},Xa.prototype.dispose=function(){bs.prototype.dispose.call(this),this.disposed=!0},Xa.prototype.toJSON=function(a){var r=bs.prototype.toJSON.call(this,a),h=this.source.toJSON(a);return r.image=h.uuid,r.loop=this.loop,r.animationSpeed=this.animationSpeed,r.framesHorizontal=this._framesHorizontal,r.framesVertical=this._framesVertical,r.totalFrames=this._totalFrames,r.beginFrame=this._beginFrame,r.endFrame=this._endFrame,r},(La.prototype=Object.create(l.Texture.prototype)).constructor=La,La.prototype.isDataTexture=!0,La.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.image={height:this.image.height,width:this.image.width,data:Array.from(this.image.data)},r},(Bc.prototype=Object.create(l.Texture.prototype)).constructor=Bc,Bc.prototype.isCompressedTexture=!0,Bc.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);if(r.isCubeTexture=this.isCubeTexture,this.isCubeTexture){r.image=[];for(var h=0;h<this.image.length;h++){for(var d={mipmaps:[],format:this.image[h].format,width:this.image[h].width,height:this.image[h].height},y=0;y<this.image[h].mipmaps.length;y++)d.mipmaps.push({width:this.image[h].mipmaps[y].width,height:this.image[h].mipmaps[y].height,data:this.image[h].mipmaps[y].data});r.image.push(d)}}else for(r.mipmaps=[],r.width=this.image.width,r.height=this.image.height,y=0;y<this.mipmaps.length;y++)r.mipmaps.push({width:this.mipmaps[y].width,height:this.mipmaps[y].height,data:this.mipmaps[y].data});return r},dl.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},dl.prototype.setPath=function(a){return this.path=a,this},dl.prototype.setImages=function(a){return this.images=a,this},dl.prototype.setVideos=function(a){return this.videos=a,this},dl.prototype.setFonts=function(a){return this.fonts=a,this},dl.prototype.load=function(a,r,h,d){try{var y=new bs(this.path+a);return void 0!==r&&r(y),y}catch(b){return void 0!==d&&d(b),console.warn("nunuStudio: Texture not found",b),new bs}},dl.prototype.loadJSON=function(a,r,h,d){var y=this;new l.FileLoader(this.manager).load(a,function(b){y.parse(JSON.parse(b),r)},h,d)},dl.prototype.parse=function(a,r){var h=null,d=a.category;if("Video"===d)void 0===a.video&&console.warn("nunuStudio: TextureLoader, No video specified for",a.uuid),void 0===this.videos[a.video]&&console.warn("nunuStudio: TextureLoader, Undefined video",a.video),(h=new Ps(this.videos[a.video])).setLoop(a.loop),h.setAutoPlay(a.autoplay),h.setPlaybackRate(a.playbackRate),h.setVolume(a.volume);else if("Webcam"===d)h=new Zs,void 0!==a.mode&&(h.mode=a.mode);else if("Compressed"===d)if(a.isCubeTexture){(h=new Bc).image=[],h.isCubeTexture=!0;for(var y=0;y<a.image.length;y++){for(var b=0;b<a.image[y].mipmaps.length;b++)void 0!==a.image[y].mipmaps[b].data.toArrayBuffer&&(a.image[y].mipmaps[b].data=new Uint8Array(a.image[y].mipmaps[b].data.toArrayBuffer()));h.image.push(a.image[y])}}else{for(b=0;b<a.mipmaps.length;b++)void 0!==a.mipmaps[b].data.toArrayBuffer&&(a.mipmaps[b].data=new Uint8Array(a.mipmaps[b].data.toArrayBuffer()));h=new Bc(a.mipmaps,a.width,a.height)}else if("Cube"===d){var N=[];for(b=0;b<a.images.length;b++)void 0===this.images[a.images[b]]&&console.warn("nunuStudio: TextureLoader, undefined image",a.images[b]),N.push(this.images[a.images[b]]);(h=new Sr).setImages(N,a.mode),h.setSize(a.size),h.updateImages()}else"Canvas"===d?h=new rc(a.width,a.height):"DataTexture"===d?h=new La(new Float32Array(a.image.data),a.image.width,a.image.height):(void 0===a.image&&console.warn("nunuStudio: TextureLoader, no image specified for",a.uuid),void 0===this.images[a.image]&&console.warn("nunuStudio: TextureLoader, undefined image",a.image),"SpriteSheet"===d?((h=new Xa(this.images[a.image],a.framesHorizontal,a.framesVertical,a.totalFrames)).loop=a.loop,h.animationSpeed=a.animationSpeed,h.beginFrame=a.beginFrame,h.endFrame=a.endFrame):h=new bs(this.images[a.image]));return h.needsUpdate=!0,h.uuid=a.uuid,h.name=a.name,h.mapping=a.mapping,h.repeat.set(a.repeat[0],a.repeat[1]),h.offset.set(a.offset[0],a.offset[1]),void 0!==a.center&&h.center.set(a.center[0],a.center[1]),void 0!==a.rotation&&(h.rotation=a.rotation),h.wrapS=a.wrap[0],h.wrapT=a.wrap[1],void 0!==a.format&&(h.format=a.format),void 0!==a.type&&(h.type=a.type),void 0!==a.encoding&&(h.encoding=a.encoding),h.minFilter=a.minFilter,h.magFilter=a.magFilter,h.anisotropy=a.anisotropy,h.flipY=a.flipY,void 0!==a.premultiplyAlpha&&(h.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(h.unpackAlignment=a.unpackAlignment),void 0!==r&&r(h),h},Bu.prototype.load=function(a,r,h,d){var y=this;new l.FileLoader(this.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,d)},Bu.prototype.parse=function(a){var r=new kl(void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,a.encoding);return r.name=a.name,r.uuid=a.uuid,r},(Zi.prototype=Object.create(B.prototype)).load=function(a,r,h,d){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var y=this;new l.FileLoader(this.manager).load(a,function(b){y.parse(JSON.parse(b),r)},h,d)},Zi.prototype.parse=function(a,r){this.parseResources(a.resources),this.parseShape(a.shapes),this.parseImages(a.images),this.parseGeometries(a.geometries),this.parseVideos(a.videos),this.parseAudio(a.audio),this.parseFonts(a.fonts),this.parseTextures(a.textures),this.parseMaterials(a.materials);var h=this.parseObject(a.object);return void 0!==a.skeletons&&(this.parseSkeletons(a.skeletons,h),this.bindSkeletons(h)),void 0!==a.images&&0!==a.images.length||void 0!==r&&r(h),h},Zi.prototype.setTexturePath=function(a){this.texturePath=a},Zi.prototype.setCrossOrigin=function(a){this.crossOrigin=a},Zi.prototype.parseResources=function(a){if(void 0!==a)for(var r in a){var h=new Il(a[r].data,a[r].encoding);h.format=a[r].format,h.name=a[r].name,h.uuid=a[r].uuid,this.resources[h.uuid]=h}return this.resources},Zi.prototype.parseShape=function(a){if(void 0!==a)for(var r=0,h=a.length;r<h;r++){var d=(new Shape).fromJSON(a[r]);this.shapes[d.uuid]=d}return this.shapes},Zi.prototype.parseGeometries=function(a){if(void 0!==a){var r=new Lu;r.setShapes(this.shapes),r.setImages(this.images);for(var h=0;h<a.length;h++)this.geometries[a[h].uuid]=r.parse(a[h])}return this.geometries},Zi.prototype.parseMaterials=function(a){if(void 0!==a){var r=new $u;for(var h in r.setTextures(this.textures),a)this.materials[a[h].uuid]=r.parse(a[h])}return this.materials},Zi.prototype.parseImages=function(a){if(void 0!==a){var r=new Cu;for(var h in a)this.images[a[h].uuid]=r.parse(a[h])}return this.images},Zi.prototype.parseVideos=function(a){if(void 0!==a){var r=new Bu;for(var h in a)this.videos[a[h].uuid]=r.parse(a[h])}return this.videos},Zi.prototype.parseAudio=function(a){if(void 0!==a){var r=new Mh;for(var h in a)this.audio[a[h].uuid]=r.parse(a[h])}return this.audio},Zi.prototype.parseFonts=function(a){if(void 0!==a){var r=new ih;for(var h in a)this.fonts[a[h].uuid]=r.parse(a[h])}return this.fonts},Zi.prototype.parseTextures=function(a){if(void 0!==a){var r=new dl;for(var h in r.setImages(this.images),r.setVideos(this.videos),a)this.textures[a[h].uuid]=r.parse(a[h])}return this.textures},Zi.prototype.parseSkeletons=function(a,r){if(void 0!==a)for(var h=0;h<a.length;h++)this.skeletons[a[h].uuid]=l.Skeleton.fromJSON(a[h],r,this);return this.skeletons},Zi.prototype.bindSkeletons=function(a){var r=this;a.traverse(function(h){if(h.isSkinnedMesh&&void 0!==h.skeletonUUID){var d=r.skeletons[h.skeletonUUID];if(void 0===d)return void console.warn("nunuStudio: ObjectLoader Skeleton not found.",h.skeletonUUID);delete h.skeletonUUID,h.bind(d,h.bindMatrix)}})},Zi.prototype.parseObject=function(a){var r;try{switch(a.type){case"SpineAnimation":for(var h=0;h<a.textures.length;h++)a.textures[h].texture=this.getTexture(a.textures[h].texture);r=new Js(a.json,a.atlas,"",a.textures),void 0!==a.animation&&(r.animation=a.animation,r.track=a.track,r.loop=a.loop),void 0!==a.skin&&(r.skin=a.skin);break;case"Audio":(r=new ri(this.getAudio(a.audio))).autoplay=a.autoplay,r.startTime=a.startTime,r.playbackRate=a.playbackRate,r.loop=void 0!==a.source?a.source.loop:a.loop,void 0!==a.volume&&(r.volume=a.volume);break;case"PositionalAudio":(r=new qt(this.getAudio(a.audio))).autoplay=a.autoplay,r.startTime=a.startTime,r.playbackRate=a.playbackRate,r.loop=void 0!==a.source?a.source.loop:a.loop,void 0!==a.volume&&(r.volume=a.volume),r.distanceModel=a.distanceModel,r.panningModel=a.panningModel;break;case"Physics":r=Ue.fromJSON(a);break;case"ParticleEmiter":r=to.fromJSON(a,this);break;case"LensFlare":for(r=new Ma,void 0!==a.lensFlares&&(a.elements=a.lensFlares),h=0;h<a.elements.length;h++)r.addFlare(this.getTexture(a.elements[h].texture),a.elements[h].size,a.elements[h].distance,new l.Color(a.elements[h].color));break;case"TextMesh":case"Text3D":r=new fa(a.text,this.getMaterial(a.material),this.getFont(a.font),a.height,a.bevel,a.bevelThickness,a.bevelSize,a.size,a.curveSegments,a.extruded);break;case"Program":(r=new ii(a.name)).description=a.description,r.author=a.author,r.version=a.version,r.ar=!0===a.ar,r.vr=a.vr,r.vrScale=a.vrScale,void 0!==a.rendererConfig?r.rendererConfig.fromJSON(a.rendererConfig):(r.rendererConfig.antialiasing=a.antialiasing,r.rendererConfig.shadows=a.shadows,r.rendererConfig.shadowsType=a.shadowsType,r.rendererConfig.toneMapping=a.toneMapping,r.rendererConfig.toneMappingExposure=a.toneMappingExposure),void 0!==a.lockPointer&&(r.lockPointer=a.lockPointer),void 0!==a.defaultScene&&(r.defaultScene=a.defaultScene),void 0!==a.handlePixelRatio&&(r.handlePixelRatio=a.handlePixelRatio);break;case"Sky":if(r=new $r(a.autoUpdate,a.dayTime,a.sunDistance,a.time),void 0!==a.sun&&(r.sun.shadow.fromJSON(a.sun.shadow),void 0!==a.sun.castShadow&&(r.sun.castShadow=a.sun.castShadow)),void 0!==a.colorTop)for(r.colorTop=[],h=0;h<a.colorTop.length;h++)r.colorTop.push(new l.Color(a.colorTop[h]));if(void 0!==a.colorBottom)for(r.colorBottom=[],h=0;h<a.colorBottom.length;h++)r.colorBottom.push(new l.Color(a.colorBottom[h]));void 0!==a.sunColor&&(r.sunColor=a.sunColor),void 0!==a.moonColor&&(r.moonColor=a.moonColor),void 0!==a.intensity&&(r.intensity=a.intensity);break;case"CubeCamera":r=new gr(a.near,a.far,a.resolution,a.autoUpdate);break;case"FirstPersonControls":(r=new Zc).sensitivity=a.sensitivity,r.needsButtonPressed=a.needsButtonPressed,r.movementEnabled=a.movementEnabled,r.moveSpeed=a.moveSpeed,r.moveOnPlane=a.moveOnPlane,r.moveKeys=a.moveKeys;break;case"OrbitControls":(r=new Aa).distance=a.distance,r.maxDistance=a.maxDistance,r.minDistance=a.minDistance,r.sensitivity=a.sensitivity,r.limitUp=a.limitUp,r.limitDown=a.limitDown,r.needsButtonPressed=a.needsButtonPressed,r.zoomEnabled=a.zoomEnabled,r.movementEnabled=a.movementEnabled,void 0!==a.smooth&&(r.smooth=a.smooth,r.friction=a.friction,r.speed=a.speed,r.invertNavigation=a.invertNavigation),void 0!==a.center&&(r.center.fromArray(a.center),r.vector.fromArray(a.vector));break;case"Scene":r=new Po,void 0!==a.background&&(r.background=Number.isInteger(a.background)?new l.Color(a.background):this.getTexture(a.background)),void 0!==a.environment&&(r.environment=this.getTexture(a.environment)),void 0!==a.fog&&("Fog"===a.fog.type?r.fog=new l.Fog(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(r.fog=new l.FogExp2(a.fog.color,a.fog.density))),void 0!==a.defaultCamera&&(r.defaultCamera=this.parse(a.defaultCamera)),void 0!==a.cameras&&(r.cameras=a.cameras),void 0!==a.usePhysics&&(r.usePhysics=a.usePhysics),void 0!==a.world&&(r.world.gravity.set(a.world.gravity.x,a.world.gravity.y,a.world.gravity.z),r.world.quatNormalizeSkip=a.world.quatNormalizeSkip,r.world.quatNormalizeFast=a.world.quatNormalizeFast,r.world.solver.tolerance=a.world.solver.tolerance,r.world.solver.iterations=a.world.solver.iterations);break;case"PerspectiveCamera":r=new Ie(a.fov,a.aspect,a.near,a.far),void 0!==a.focus&&(r.focus=a.focus),void 0!==a.zoom&&(r.zoom=a.zoom),void 0!==a.filmGauge&&(r.filmGauge=a.filmGauge),void 0!==a.filmOffset&&(r.filmOffset=a.filmOffset),void 0!==a.view&&(r.view=Object.assign({},a.view)),void 0!==a.viewport&&(a.viewport instanceof Array?(r.viewport.size.fromArray(a.viewport),r.viewport.offset.fromArray(a.offset)):r.viewport.fromJSON(a.viewport)),void 0!==a.clearColor&&(r.clearColor=a.clearColor),void 0!==a.clearDepth&&(r.clearDepth=a.clearDepth),void 0!==a.clearStencil&&(r.clearStencil=a.clearStencil),void 0!==a.order&&(r.order=a.order),void 0!==a.composer&&(r.composer=Bo.fromJSON(a.composer));break;case"OrthographicCamera":r=new ts(a.size,a.aspect,a.mode,a.near,a.far),void 0!==a.viewport&&(a.viewport instanceof Array?(r.viewport.size.fromArray(a.viewport),r.viewport.offset.fromArray(a.offset)):r.viewport.fromJSON(a.viewport)),void 0!==a.clearColor&&(r.clearColor=a.clearColor),void 0!==a.clearDepth&&(r.clearDepth=a.clearDepth),void 0!==a.clearStencil&&(r.clearStencil=a.clearStencil),void 0!==a.order&&(r.order=a.order),void 0!==a.composer&&(r.composer=Bo.fromJSON(a.composer)),void 0!==a.zoom&&(r.zoom=a.zoom),void 0!==a.view&&(r.view=Object.assign({},a.view));break;case"Script":r=new En(a.code,a.mode);break;case"PythonScript":r=new Wi(a.code);break;case"NodeScript":(r=new NodeScript).graph=Object2D.parse(a.graph);break;case"RectAreaLight":r=new Pn(a.color,a.intensity,a.width,a.height);break;case"AmbientLight":r=new Cs(a.color,a.intensity);break;case"DirectionalLight":r=new ll(a.color,a.intensity);break;case"PointLight":r=new Ge(a.color,a.intensity,a.distance,a.decay);break;case"SpotLight":r=new Di(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case"HemisphereLight":r=new Su(a.color,a.groundColor,a.intensity);break;case"HTMLView":(r=new Ql).height=a.height,r.width=a.width,r.url=a.url;break;case"LightProbe":(r=new Qc).sh.fromArray(a.sh);break;case"InstancedMesh":(r=new as(this.getGeometry(a.geometry),this.getMaterial(a.material),a.count)).instanceMatrix=new l.BufferAttribute(new Float32Array(a.instanceMatrix.array),16);break;case"SkinnedMesh":r=new Gn(this.getGeometry(a.geometry),this.getMaterial(a.material)),void 0!==a.skeleton&&(r.skeletonUUID=a.skeleton),void 0!==a.bindMode&&(r.bindMode=a.bindMode),void 0!==a.bindMatrix&&r.bindMatrix.fromArray(a.bindMatrix);break;case"Mesh":r=new eh(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"TextBitmap":r=Do.fromJSON(a,this.getTexture(a.texture));break;case"TextSprite":r=qa.fromJSON(a);break;case"LOD":r=new l.LOD;break;case"Line":r=new l.Line(this.getGeometry(a.geometry),this.getMaterial(a.material),a.mode);break;case"LineLoop":r=new l.LineLoop(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"LineSegments":r=new l.LineSegments(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"PointCloud":case"Points":r=new l.Points(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"Sprite":r=new nc(this.getMaterial(a.material));break;case"Group":default:r=new wu;break;case"BillboardGroup":r=new Au;break;case"Bone":r=new l.Bone}}catch(H){console.error("nunuStudio: Error parsing and creating object "+a.uuid+", object skiped.",H,a),r=new wu}if(r.uuid=a.uuid,r.name=a.name,r.locked=!0===a.locked||!0===a.hidden,r.folded=!0===a.folded,void 0!==a.frustumCulled&&(r.frustumCulled=a.frustumCulled),void 0!==a.renderOrder&&(r.renderOrder=a.renderOrder),void 0!==a.animations)for(r.animations=[],h=0;h<a.animations.length;h++){var d=l.AnimationClip.parse(a.animations[h]);void 0!==a.animations[h].uuid&&(d.uuid=a.animations[h].uuid),r.animations.push(d)}if(void 0!==a.matrix&&(r.matrix.fromArray(a.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)),void 0!==a.position&&r.position.fromArray(a.position),void 0!==a.rotation&&r.rotation.fromArray(a.rotation),void 0!==a.quaternion&&r.quaternion.fromArray(a.quaternion),void 0!==a.scale&&r.scale.fromArray(a.scale),r.castShadow=!0===a.castShadow,r.receiveShadow=!0===a.receiveShadow,void 0!==a.shadow&&r.shadow.fromJSON(a.shadow),r.visible=!0===a.visible,void 0!==a.userData&&(r.userData=a.userData),void 0!==a.layers&&(r.layers.mask=a.layers),void 0!==a.children)for(var y in a.children)r.add(this.parseObject(a.children[y]));if(void 0!==a.matrixAutoUpdate&&(r.matrixAutoUpdate=a.matrixAutoUpdate,r.matrixAutoUpdate||(r.updateMatrix(),r.updateMatrixWorld(!0))),"Program"===a.type)r.copyResources(this);else if("Scene"===a.type)for(h=0;h<r.cameras.length;h++){var b=r.getCamera(r.cameras[h]);null!==b?r.cameras[h]=b:r.cameras.splice(h,1)}else if("LOD"===a.type)for(var N=a.levels,k=0;k<N.length;k++){var T=N[k];void 0!==(y=r.getObjectByProperty("uuid",T.object))&&r.addLevel(y,T.distance)}return r};const nd="// All uniforms used by vertex / fragment shaders\r\nuniform float deltaTime;\r\nuniform float runTime;\r\nuniform sampler2D textureSampler;\r\nuniform vec4 textureAnimation;\r\nuniform float scale;\r\n",Ip="varying vec4 vColor;\r\n\r\n#ifdef SHOULD_ROTATE_TEXTURE\r\n    varying float vAngle;\r\n#endif\r\n\r\n#ifdef SHOULD_CALCULATE_SPRITE\r\n    varying vec4 vSpriteSheet;\r\n#endif",Ed="// Branch-avoiding comparison fns\r\n//- http:// theorangeduck.com/page/avoiding-shader-conditionals\r\nfloat when_gt(float x, float y) {\r\n    return max(sign(x - y), 0.0);\r\n}\r\n\r\nfloat when_lt(float x, float y) {\r\n    return min(max(1.0 - sign(x - y), 0.0), 1.0);\r\n}\r\n\r\nfloat when_eq(float x, float y) {\r\n    return 1.0 - abs(sign(x - y));\r\n}\r\n\r\nfloat when_ge(float x, float y) {\r\n  return 1.0 - when_lt(x, y);\r\n}\r\n\r\nfloat when_le(float x, float y) {\r\n  return 1.0 - when_gt(x, y);\r\n}\r\n\r\n// Branch-avoiding logical operators (to be used with above comparison fns)\r\nfloat and(float a, float b) {\r\n    return a * b;\r\n}\r\n\r\nfloat or(float a, float b) {\r\n    return min(a + b, 1.0);\r\n}";var ic={vertex:["// Register color-packing define statements.\r\n#define PACKED_COLOR_SIZE 256.0\r\n#define PACKED_COLOR_DIVISOR 255.0",nd,"// All attributes used by the vertex shader.\r\n//\r\n// Note that some attributes are squashed into other ones\r\n//\r\n// Drag is stored in acceleration.w\r\nattribute vec4 acceleration;\r\nattribute vec3 velocity;\r\nattribute vec4 rotation;\r\nattribute vec3 rotationCenter;\r\nattribute vec4 params;\r\nattribute vec4 size;\r\nattribute vec4 angle;\r\nattribute vec4 color;\r\nattribute vec4 opacity;",Ip,l.ShaderChunk.common,l.ShaderChunk.logdepthbuf_pars_vertex,l.ShaderChunk.fog_pars_vertex,Ed,"// From:\r\n//- http:// stackoverflow.com/a/12553149\r\n//- https:// stackoverflow.com/questions/22895237/hexadecimal-to-rgb-values-in-webgl-shader\r\n// unpackColor\r\nvec3 unpackColor(in float hex) {\r\n    vec3 c = vec3(0.0);\r\n\r\n    float r = mod((hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\r\n    float g = mod((hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\r\n    float b = mod(hex, PACKED_COLOR_SIZE);\r\n\r\n    c.r = r / PACKED_COLOR_DIVISOR;\r\n    c.g = g / PACKED_COLOR_DIVISOR;\r\n    c.b = b / PACKED_COLOR_DIVISOR;\r\n\r\n    return c;\r\n}\r\n\r\n// unpackRotationAxis\r\nvec3 unpackRotationAxis(in float hex) {\r\n    vec3 c = vec3(0.0);\r\n\r\n    float r = mod((hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\r\n    float g = mod((hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\r\n    float b = mod(hex, PACKED_COLOR_SIZE);\r\n\r\n    c.r = r / PACKED_COLOR_DIVISOR;\r\n    c.g = g / PACKED_COLOR_DIVISOR;\r\n    c.b = b / PACKED_COLOR_DIVISOR;\r\n\r\n    c *= vec3(2.0);\r\n    c -= vec3(1.0);\r\n\r\n    return c;\r\n}\r\n\r\n// floatOverLifetime:\r\nfloat getFloatOverLifetime(in float positionInTime, in vec4 attr) {\r\n    highp float value = 0.0;\r\n    float deltaAge = positionInTime * float(VALUE_OVER_LIFETIME_LENGTH - 1);\r\n    float fIndex = 0.0;\r\n    float shouldApplyValue = 0.0;\r\n\r\n    // This might look a little odd, but it's faster in the testing I\"ve done than using branches. Uses basic maths to avoid branching.\r\n    //\r\n    // Take a look at the branch-avoidance functions defined above, and be sure to check out The Orange Duck site where I got this from (link above).\r\n    //\r\n    // Fix for static emitters (age is always zero).\r\n    value += attr[0] * when_eq(deltaAge, 0.0);\r\n\r\n    for(int i = 0; i < VALUE_OVER_LIFETIME_LENGTH - 1; ++i) {\r\n        fIndex = float(i);\r\n        shouldApplyValue = and(when_gt(deltaAge, fIndex), when_le(deltaAge, fIndex + 1.0));\r\n        value += shouldApplyValue * mix(attr[i], attr[i + 1], deltaAge - fIndex);\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// colorOverLifetime\r\nvec3 getColorOverLifetime(in float positionInTime, in vec3 color1, in vec3 color2, in vec3 color3, in vec3 color4) {\r\n    vec3 value = vec3(0.0);\r\n    value.x = getFloatOverLifetime(positionInTime, vec4(color1.x, color2.x, color3.x, color4.x));\r\n    value.y = getFloatOverLifetime(positionInTime, vec4(color1.y, color2.y, color3.y, color4.y));\r\n    value.z = getFloatOverLifetime(positionInTime, vec4(color1.z, color2.z, color3.z, color4.z));\r\n    return value;\r\n}\r\n\r\n// paramFetchingFunctions\r\nfloat getAlive() {\r\n    return params.x;\r\n}\r\n\r\nfloat getAge() {\r\n    return params.y;\r\n}\r\n\r\nfloat getMaxAge() {\r\n    return params.z;\r\n}\r\n\r\nfloat getWiggle() {\r\n    return params.w;\r\n}\r\n\r\n// forceFetchingFunctions\r\nvec4 getPosition(in float age) {\r\n    return modelViewMatrix * vec4(position, 1.0);\r\n}\r\n\r\nvec3 getVelocity(in float age) {\r\n    return velocity * age;\r\n}\r\n\r\nvec3 getAcceleration(in float age) {\r\n    return acceleration.xyz * age;\r\n}\r\n\r\n\r\n// rotationFunctions\r\n// Huge thanks to:\r\n//- http:// www.neilmendoza.com/glsl-rotation-about-an-arbitrary-axis/\r\n#ifdef SHOULD_ROTATE_PARTICLES\r\nmat4 getRotationMatrix(in vec3 axis, in float angle) {\r\n   axis = normalize(axis);\r\n   float s = sin(angle);\r\n   float c = cos(angle);\r\n   float oc = 1.0 - c;\r\n\r\n   return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\r\n               oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\r\n               oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\r\n               0.0,                                0.0,                                0.0,                                1.0);\r\n}\r\n\r\nvec3 getRotation(in vec3 pos, in float positionInTime) {\r\n  if(rotation.y == 0.0) {\r\n       return pos;\r\n  }\r\n\r\n  vec3 axis = unpackRotationAxis(rotation.x);\r\n  vec3 center = rotationCenter;\r\n  vec3 translated;\r\n  mat4 rotationMatrix;\r\n\r\n  float angle = 0.0;\r\n  angle += when_eq(rotation.z, 0.0) * rotation.y;\r\n  angle += when_gt(rotation.z, 0.0) * mix(0.0, rotation.y, positionInTime);\r\n  translated = rotationCenter - pos;\r\n  rotationMatrix = getRotationMatrix(axis, angle);\r\n  return center - vec3(rotationMatrix * vec4(translated, 0.0));\r\n}\r\n#endif\r\n","void main() {","// Setup\r\nhighp float age = getAge();\r\nhighp float alive = getAlive();\r\nhighp float maxAge = getMaxAge();\r\nhighp float positionInTime = (age / maxAge);\r\nhighp float isAlive = when_gt(alive, 0.0);\r\n#ifdef SHOULD_WIGGLE_PARTICLES\r\n\tfloat wiggleAmount = positionInTime * getWiggle();\r\n\tfloat wiggleSin = isAlive * sin(wiggleAmount);\r\n\tfloat wiggleCos = isAlive * cos(wiggleAmount);\r\n#endif\r\n\r\n// Forces\r\n// Get forces & position\r\nvec3 vel = getVelocity(age);\r\nvec3 accel = getAcceleration(age);\r\nvec3 force = vec3(0.0);\r\nvec3 pos = vec3(position);\r\n\r\n// Calculate the required drag to apply to the forces.\r\nfloat drag = 1.0 - (positionInTime * 0.5) * acceleration.w;\r\n\r\n// Integrate forces\r\nforce += vel;\r\nforce *= drag;\r\nforce += accel * age;\r\npos += force;\r\n\r\n// Wiggly wiggly wiggle!\r\n#ifdef SHOULD_WIGGLE_PARTICLES\r\n\tpos.x += wiggleSin;\r\n\tpos.y += wiggleCos;\r\n\tpos.z += wiggleSin;\r\n#endif\r\n\r\n// Rotate the emitter around it's central point\r\n#ifdef SHOULD_ROTATE_PARTICLES\r\n\tpos = getRotation(pos, positionInTime);\r\n#endif\r\n\r\n// Convert pos to a world-space value\r\nvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\r\n\r\n// Determine point size.\r\nhighp float pointSize = getFloatOverLifetime(positionInTime, size) * isAlive;\r\n\r\n// Determine perspective\r\n#ifdef HAS_PERSPECTIVE\r\n\tfloat perspective = scale / length(mvPosition.xyz);\r\n#else\r\n\tfloat perspective = 1.0;\r\n#endif\r\n\r\n// Apply perpective to pointSize value\r\nfloat pointSizePerspective = pointSize * perspective;\r\n\r\n// Determine color and opacity for this particle\r\n#ifdef COLORIZE\r\n\tvec3 c = isAlive * getColorOverLifetime(\r\n\t\tpositionInTime,\r\n\t\tunpackColor(color.x),\r\n\t\tunpackColor(color.y),\r\n\t\tunpackColor(color.z),\r\n\t\tunpackColor(color.w)\r\n\t);\r\n#else\r\n\tvec3 c = vec3(1.0);\r\n#endif\r\n\r\nfloat o = isAlive * getFloatOverLifetime(positionInTime, opacity);\r\n\r\n// Assign color to vColor varying.\r\nvColor = vec4(c, o);\r\n\r\n// Determine angle\r\n#ifdef SHOULD_ROTATE_TEXTURE\r\n\tvAngle = isAlive * getFloatOverLifetime(positionInTime, angle);\r\n#endif\r\n\r\n// If this particle is using a sprite-sheet as a texture, we\"ll have to figure out what frame of the texture the particle is using at it's current position in time.\r\n#ifdef SHOULD_CALCULATE_SPRITE\r\n\tfloat framesX = textureAnimation.x;\r\n\tfloat framesY = textureAnimation.y;\r\n\tfloat loopCount = textureAnimation.w;\r\n\tfloat totalFrames = textureAnimation.z;\r\n\tfloat frameNumber = mod((positionInTime * loopCount) * totalFrames, totalFrames);\r\n\r\n\tfloat column = floor(mod(frameNumber, framesX));\r\n\tfloat row = floor((frameNumber - column) / framesX);\r\n\r\n\tfloat columnNorm = column / framesX;\r\n\tfloat rowNorm = row / framesY;\r\n\r\n\tvSpriteSheet.x = 1.0 / framesX;\r\n\tvSpriteSheet.y = 1.0 / framesY;\r\n\tvSpriteSheet.z = columnNorm;\r\n\tvSpriteSheet.w = rowNorm;\r\n#endif\r\n\r\n// Write values\r\n// Set PointSize according to size at current point in time.\r\ngl_PointSize = pointSizePerspective;\r\ngl_Position = projectionMatrix * mvPosition;",l.ShaderChunk.logdepthbuf_vertex,l.ShaderChunk.fog_vertex,"}"].join("\n"),fragment:[nd,l.ShaderChunk.common,l.ShaderChunk.fog_pars_fragment,l.ShaderChunk.logdepthbuf_pars_fragment,Ip,Ed,"void main() {","    vec3 outgoingLight = vColor.xyz;","    ","    #ifdef ALPHATEST","       if(vColor.w < float(ALPHATEST)) discard;","    #endif","// Rotate Texture\r\nvec2 vUv = vec2(gl_PointCoord.x, 1.0 - gl_PointCoord.y);\r\n\r\n#ifdef SHOULD_ROTATE_TEXTURE\r\n   float x = gl_PointCoord.x - 0.5;\r\n   float y = 1.0 - gl_PointCoord.y - 0.5;\r\n   float c = cos(-vAngle);\r\n   float s = sin(-vAngle);\r\n\r\n   vUv = vec2(c * x + s * y + 0.5, c * y - s * x + 0.5);\r\n#endif\r\n\r\n// Spritesheets overwrite angle calculations.\r\n#ifdef SHOULD_CALCULATE_SPRITE\r\n    float framesX = vSpriteSheet.x;\r\n    float framesY = vSpriteSheet.y;\r\n    float columnNorm = vSpriteSheet.z;\r\n    float rowNorm = vSpriteSheet.w;\r\n\r\n    vUv.x = gl_PointCoord.x * framesX + columnNorm;\r\n    vUv.y = 1.0 - (gl_PointCoord.y * framesY + rowNorm);\r\n#endif\r\n\r\nvec4 rotatedTexture = texture2D(textureSampler, vUv);\r\n",l.ShaderChunk.logdepthbuf_fragment,"    outgoingLight = vColor.xyz * rotatedTexture.xyz;","    gl_FragColor = vec4(outgoingLight.xyz, rotatedTexture.w * vColor.w);",l.ShaderChunk.fog_fragment,"}"].join("\n")};function Go(a,r,h,d){this.componentSize=h||1,this.size=r||1,this.TypedArrayConstructor=a||Float32Array,this.array=new a(r*this.componentSize),this.indexOffset=d||0}function wi(a,r,h){this.type="string"==typeof a&&wi.typeSizeMap.hasOwnProperty(a)?a:"f",this.componentSize=wi.typeSizeMap[this.type],this.arrayType=h||Float32Array,this.typedArray=null,this.bufferAttribute=null,this.dynamicBuffer=!!r,this.updateMin=0,this.updateMax=0}Go.constructor=Go,Go.prototype.setSize=function(a,r){var h=this.array.length;return r||(a*=this.componentSize),a<h?this.shrink(a):a>h?this.grow(a):void 0},Go.prototype.shrink=function(a){return this.array=this.array.subarray(0,a),this.size=a,this},Go.prototype.grow=function(a){var r=this.array,h=new this.TypedArrayConstructor(a);return h.set(r),this.array=h,this.size=a,this},Go.prototype.splice=function(a,r){a*=this.componentSize,r*=this.componentSize;for(var h=[],d=this.array,y=d.length,b=0;b<y;++b)(b<a||b>=r)&&h.push(d[b]);return this.setFromArray(0,h),this},Go.prototype.setFromArray=function(a,r){var h=a+r.length;return h>this.array.length?this.grow(h):h<this.array.length&&this.shrink(h),this.array.set(r,this.indexOffset+a),this},Go.prototype.setVec2=function(a,r){return this.setVec2Components(a,r.x,r.y)},Go.prototype.setVec2Components=function(a,r,h){var d=this.array,y=this.indexOffset+a*this.componentSize;return d[y]=r,d[y+1]=h,this},Go.prototype.setVec3=function(a,r){return this.setVec3Components(a,r.x,r.y,r.z)},Go.prototype.setVec3Components=function(a,r,h,d){var y=this.array,b=this.indexOffset+a*this.componentSize;return y[b]=r,y[b+1]=h,y[b+2]=d,this},Go.prototype.setVec4=function(a,r){return this.setVec4Components(a,r.x,r.y,r.z,r.w)},Go.prototype.setVec4Components=function(a,r,h,d,y){var b=this.array,N=this.indexOffset+a*this.componentSize;return b[N]=r,b[N+1]=h,b[N+2]=d,b[N+3]=y,this},Go.prototype.setMat3=function(a,r){return this.setFromArray(this.indexOffset+a*this.componentSize,r.elements)},Go.prototype.setMat4=function(a,r){return this.setFromArray(this.indexOffset+a*this.componentSize,r.elements)},Go.prototype.setColor=function(a,r){return this.setVec3Components(a,r.r,r.g,r.b)},Go.prototype.setNumber=function(a,r){return this.array[this.indexOffset+a*this.componentSize]=r,this},Go.prototype.getValueAtIndex=function(a){return this.array[this.indexOffset+a]},Go.prototype.getComponentValueAtIndex=function(a){return this.array.subarray(this.indexOffset+a*this.componentSize)},wi.constructor=wi,wi.typeSizeMap={f:1,v2:2,v3:3,v4:4,c:3,m3:9,m4:16},wi.prototype.setUpdateRange=function(a,r){this.updateMin=Math.min(a*this.componentSize,this.updateMin*this.componentSize),this.updateMax=Math.max(r*this.componentSize,this.updateMax*this.componentSize)},wi.prototype.flagUpdate=function(){var a=this.bufferAttribute.updateRange;a.offset=this.updateMin,a.count=Math.min(this.updateMax-this.updateMin+this.componentSize,this.typedArray.array.length),this.bufferAttribute.needsUpdate=!0},wi.prototype.resetUpdateRange=function(){this.updateMin=0,this.updateMax=0},wi.prototype.resetDynamic=function(){this.bufferAttribute.usage=this.dynamicBuffer?l.DynamicDrawUsage:l.StaticDrawUsage},wi.prototype.splice=function(a,r){this.typedArray.splice(a,r),this.forceUpdateAll()},wi.prototype.forceUpdateAll=function(){this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.updateRange.offset=0,this.bufferAttribute.updateRange.count=-1,this.bufferAttribute.usage=l.StaticDrawUsage,this.bufferAttribute.needsUpdate=!0},wi.prototype._ensureTypedArray=function(a){null!==this.typedArray&&this.typedArray.size===a*this.componentSize||(null!==this.typedArray&&this.typedArray.size!==a?this.typedArray.setSize(a):null===this.typedArray&&(this.typedArray=new Go(this.arrayType,a,this.componentSize)))},wi.prototype._createBufferAttribute=function(a){if(this._ensureTypedArray(a),null!==this.bufferAttribute)return this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.count=this.bufferAttribute.array.length/this.bufferAttribute.itemSize,void(this.bufferAttribute.needsUpdate=!0);this.bufferAttribute=new l.BufferAttribute(this.typedArray.array,this.componentSize),this.bufferAttribute.usage=this.dynamicBuffer?l.DynamicDrawUsage:l.StaticDrawUsage},wi.prototype.getLength=function(){return null===this.typedArray?0:this.typedArray.array.length};var ru,zt={types:{BOOLEAN:"boolean",STRING:"string",NUMBER:"number",OBJECT:"object"},ensureTypedArg:function(a,r,h){return typeof a===r?a:h},ensureArrayTypedArg:function(a,r,h){if(Array.isArray(a)){for(var d=a.length-1;d>=0;--d)if(typeof a[d]!==r)return h;return a}return this.ensureTypedArg(a,r,h)},ensureInstanceOf:function(a,r,h){return void 0!==r&&a instanceof r?a:h},ensureArrayInstanceOf:function(a,r,h){if(Array.isArray(a)){for(var d=a.length-1;d>=0;--d)if(void 0!==r&&a[d]instanceof r==0)return h;return a}return this.ensureInstanceOf(a,r,h)},ensureValueOverLifetimeCompliance:function(a,r,h){r=r||3,h=h||3,!1===Array.isArray(a._value)&&(a._value=[a._value]),!1===Array.isArray(a._spread)&&(a._spread=[a._spread]);var d=this.clamp(a._value.length,r,h),y=this.clamp(a._spread.length,r,h),b=Math.max(d,y);a._value.length!==b&&(a._value=this.interpolateArray(a._value,b)),a._spread.length!==b&&(a._spread=this.interpolateArray(a._spread,b))},interpolateArray:function(a,r){for(var h=a.length,d=["function"==typeof a[0].clone?a[0].clone():a[0]],y=(h-1)/(r-1),b=1;b<r-1;++b){var N=b*y,k=Math.floor(N),T=Math.ceil(N);d[b]=this.lerpTypeAgnostic(a[k],a[T],N-k)}return d.push("function"==typeof a[h-1].clone?a[h-1].clone():a[h-1]),d},clamp:function(a,r,h){return Math.max(r,Math.min(a,h))},zeroToEpsilon:function(a,r){var h=1e-5,d=a;return d=r?Math.random()*h*10:h,a<0&&a>-1e-5&&(d=-d),d},lerpTypeAgnostic:function(a,r,h){var d,y=this.types;return typeof a===y.NUMBER&&typeof r===y.NUMBER?a+(r-a)*h:a instanceof l.Vector2&&r instanceof l.Vector2?((d=a.clone()).x=this.lerp(a.x,r.x,h),d.y=this.lerp(a.y,r.y,h),d):a instanceof l.Vector3&&r instanceof l.Vector3?((d=a.clone()).x=this.lerp(a.x,r.x,h),d.y=this.lerp(a.y,r.y,h),d.z=this.lerp(a.z,r.z,h),d):a instanceof l.Vector4&&r instanceof l.Vector4?((d=a.clone()).x=this.lerp(a.x,r.x,h),d.y=this.lerp(a.y,r.y,h),d.z=this.lerp(a.z,r.z,h),d.w=this.lerp(a.w,r.w,h),d):a instanceof l.Color&&r instanceof l.Color?((d=a.clone()).r=this.lerp(a.r,r.r,h),d.g=this.lerp(a.g,r.g,h),d.b=this.lerp(a.b,r.b,h),d):void console.warn("nunuStudio: Invalid argument types, or argument types do not match.",a,r)},lerp:function(a,r,h){return a+(r-a)*h},roundToNearestMultiple:function(a,r){var h;return 0===r||0==(h=Math.abs(a)%r)?a:a<0?-(Math.abs(a)-h):a+r-h},arrayValuesAreEqual:function(a){for(var r=0;r<a.length-1;++r)if(a[r]!==a[r+1])return!1;return!0},randomFloat:function(a,r){return a+r*(Math.random()-.5)},randomVector3:function(a,r,h,d,y){var b=h.x+(Math.random()*d.x-.5*d.x),N=h.y+(Math.random()*d.y-.5*d.y),k=h.z+(Math.random()*d.z-.5*d.z);y&&(b=.5*-y.x+this.roundToNearestMultiple(b,y.x),N=.5*-y.y+this.roundToNearestMultiple(N,y.y),k=.5*-y.z+this.roundToNearestMultiple(k,y.z)),a.typedArray.setVec3Components(r,b,N,k)},randomColor:function(a,r,h,d){var y=h.r+Math.random()*d.x,b=h.g+Math.random()*d.y,N=h.b+Math.random()*d.z;y=this.clamp(y,0,1),b=this.clamp(b,0,1),N=this.clamp(N,0,1),a.typedArray.setVec3Components(r,y,b,N)},randomColorAsHex:(ru=new l.Color,function(a,r,h,d){for(var y=h.length,b=[],N=0;N<y;++N){var k=d[N];ru.copy(h[N]),ru.r+=Math.random()*k.x-.5*k.x,ru.g+=Math.random()*k.y-.5*k.y,ru.b+=Math.random()*k.z-.5*k.z,ru.r=this.clamp(ru.r,0,1),ru.g=this.clamp(ru.g,0,1),ru.b=this.clamp(ru.b,0,1),b.push(ru.getHex())}a.typedArray.setVec4Components(r,b[0],b[1],b[2],b[3])}),randomVector3OnSphere:function(a,r,h,d,y,b,N,k){var T=2*Math.random()-1,H=6.2832*Math.random(),Y=Math.sqrt(1-T*T),le=this.randomFloat(d,y),ae=0,ge=0,we=0;N&&(le=Math.round(le/N)*N),ae=Y*Math.cos(H)*le,ge=Y*Math.sin(H)*le,we=T*le,ae*=b.x,ge*=b.y,we*=b.z,a.typedArray.setVec3Components(r,ae+=h.x,ge+=h.y,we+=h.z)},seededRandom:function(a){var r=1e4*Math.sin(a);return r-(0|r)},randomVector3OnDisc:function(a,r,h,d,y,b,N){var k=6.2832*Math.random(),T=Math.abs(this.randomFloat(d,y)),H=0,Y=0,le=0;N&&(T=Math.round(T/N)*N),H=Math.cos(k)*T,Y=Math.sin(k)*T,H*=b.x,Y*=b.y,a.typedArray.setVec3Components(r,H+=h.x,Y+=h.y,le+=h.z)},randomDirectionVector3OnSphere:function(){var a=new l.Vector3;return function(r,h,d,y,b,N,k,T){a.copy(N),a.x-=d,a.y-=y,a.z-=b,a.normalize().multiplyScalar(-this.randomFloat(k,T)),r.typedArray.setVec3Components(h,a.x,a.y,a.z)}}(),randomDirectionVector3OnDisc:function(){var a=new l.Vector3;return function(r,h,d,y,b,N,k,T){a.copy(N),a.x-=d,a.y-=y,a.z-=b,a.normalize().multiplyScalar(-this.randomFloat(k,T)),r.typedArray.setVec3Components(h,a.x,a.y,0)}}(),getPackedRotationAxis:function(){var a=new l.Vector3,r=new l.Vector3,h=new l.Color,d=new l.Vector3(1,1,1);return function(y,b){return a.copy(y).normalize(),r.copy(b).normalize(),a.x+=.5*-b.x+Math.random()*b.x,a.y+=.5*-b.y+Math.random()*b.y,a.z+=.5*-b.z+Math.random()*b.z,a.normalize().add(d).multiplyScalar(.5),h.setRGB(a.x,a.y,a.z),h.getHex()}}()},Op={BOX:1,SPHERE:2,DISC:3};function Ui(a){for(var r in(a=zt.ensureTypedArg(a,zt.types.OBJECT,{})).position=zt.ensureTypedArg(a.position,zt.types.OBJECT,{}),a.velocity=zt.ensureTypedArg(a.velocity,zt.types.OBJECT,{}),a.acceleration=zt.ensureTypedArg(a.acceleration,zt.types.OBJECT,{}),a.radius=zt.ensureTypedArg(a.radius,zt.types.OBJECT,{}),a.drag=zt.ensureTypedArg(a.drag,zt.types.OBJECT,{}),a.rotation=zt.ensureTypedArg(a.rotation,zt.types.OBJECT,{}),a.color=zt.ensureTypedArg(a.color,zt.types.OBJECT,{}),a.opacity=zt.ensureTypedArg(a.opacity,zt.types.OBJECT,{}),a.size=zt.ensureTypedArg(a.size,zt.types.OBJECT,{}),a.angle=zt.ensureTypedArg(a.angle,zt.types.OBJECT,{}),a.wiggle=zt.ensureTypedArg(a.wiggle,zt.types.OBJECT,{}),a.maxAge=zt.ensureTypedArg(a.maxAge,zt.types.OBJECT,{}),a.onParticleSpawn&&console.warn("nunuStudio: onParticleSpawn has been removed. Please set properties directly to alter values at runtime."),this.uuid=l.Math.generateUUID(),this.type=zt.ensureTypedArg(a.type,zt.types.NUMBER,Op.BOX),this.position={_value:zt.ensureInstanceOf(a.position.value,l.Vector3,new l.Vector3),_spread:zt.ensureInstanceOf(a.position.spread,l.Vector3,new l.Vector3),_spreadClamp:zt.ensureInstanceOf(a.position.spreadClamp,l.Vector3,new l.Vector3),_distribution:zt.ensureTypedArg(a.position.distribution,zt.types.NUMBER,this.type),_randomise:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1),_radius:zt.ensureTypedArg(a.position.radius,zt.types.NUMBER,10),_radiusScale:zt.ensureInstanceOf(a.position.radiusScale,l.Vector3,new l.Vector3(1,1,1)),_distributionClamp:zt.ensureTypedArg(a.position.distributionClamp,zt.types.NUMBER,0)},this.velocity={_value:zt.ensureInstanceOf(a.velocity.value,l.Vector3,new l.Vector3),_spread:zt.ensureInstanceOf(a.velocity.spread,l.Vector3,new l.Vector3),_distribution:zt.ensureTypedArg(a.velocity.distribution,zt.types.NUMBER,this.type),_randomise:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1)},this.acceleration={_value:zt.ensureInstanceOf(a.acceleration.value,l.Vector3,new l.Vector3),_spread:zt.ensureInstanceOf(a.acceleration.spread,l.Vector3,new l.Vector3),_distribution:zt.ensureTypedArg(a.acceleration.distribution,zt.types.NUMBER,this.type),_randomise:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1)},this.drag={_value:zt.ensureTypedArg(a.drag.value,zt.types.NUMBER,0),_spread:zt.ensureTypedArg(a.drag.spread,zt.types.NUMBER,0),_randomise:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1)},this.wiggle={_value:zt.ensureTypedArg(a.wiggle.value,zt.types.NUMBER,0),_spread:zt.ensureTypedArg(a.wiggle.spread,zt.types.NUMBER,0)},this.rotation={_axis:zt.ensureInstanceOf(a.rotation.axis,l.Vector3,new l.Vector3(0,1,0)),_axisSpread:zt.ensureInstanceOf(a.rotation.axisSpread,l.Vector3,new l.Vector3),_angle:zt.ensureTypedArg(a.rotation.angle,zt.types.NUMBER,0),_angleSpread:zt.ensureTypedArg(a.rotation.angleSpread,zt.types.NUMBER,0),_static:zt.ensureTypedArg(a.rotation.static,zt.types.BOOLEAN,!1),_center:zt.ensureInstanceOf(a.rotation.center,l.Vector3,this.position._value.clone()),_randomise:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1)},this.maxAge={_value:zt.ensureTypedArg(a.maxAge.value,zt.types.NUMBER,2),_spread:zt.ensureTypedArg(a.maxAge.spread,zt.types.NUMBER,0)},this.color={_value:zt.ensureArrayInstanceOf(a.color.value,l.Color,new l.Color),_spread:zt.ensureArrayInstanceOf(a.color.spread,l.Vector3,new l.Vector3),_randomise:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1)},this.opacity={_value:zt.ensureArrayTypedArg(a.opacity.value,zt.types.NUMBER,1),_spread:zt.ensureArrayTypedArg(a.opacity.spread,zt.types.NUMBER,0),_randomise:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1)},this.size={_value:zt.ensureArrayTypedArg(a.size.value,zt.types.NUMBER,1),_spread:zt.ensureArrayTypedArg(a.size.spread,zt.types.NUMBER,0),_randomise:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1)},this.angle={_value:zt.ensureArrayTypedArg(a.angle.value,zt.types.NUMBER,0),_spread:zt.ensureArrayTypedArg(a.angle.spread,zt.types.NUMBER,0),_randomise:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1)},this.particleCount=zt.ensureTypedArg(a.particleCount,zt.types.NUMBER,100),this.duration=zt.ensureTypedArg(a.duration,zt.types.NUMBER,null),this.isStatic=zt.ensureTypedArg(a.isStatic,zt.types.BOOLEAN,!1),this.activeMultiplier=zt.ensureTypedArg(a.activeMultiplier,zt.types.NUMBER,1),this.direction=zt.ensureTypedArg(a.direction,zt.types.NUMBER,1),this.alive=zt.ensureTypedArg(a.alive,zt.types.BOOLEAN,!0),this.particlesPerSecond=0,this.activationIndex=0,this.attributeOffset=0,this.attributeEnd=0,this.age=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.resetFlags={position:zt.ensureTypedArg(a.position.randomise,zt.types.BOOLEAN,!1)||zt.ensureTypedArg(a.radius.randomise,zt.types.BOOLEAN,!1),velocity:zt.ensureTypedArg(a.velocity.randomise,zt.types.BOOLEAN,!1),acceleration:zt.ensureTypedArg(a.acceleration.randomise,zt.types.BOOLEAN,!1)||zt.ensureTypedArg(a.drag.randomise,zt.types.BOOLEAN,!1),rotation:zt.ensureTypedArg(a.rotation.randomise,zt.types.BOOLEAN,!1),rotationCenter:zt.ensureTypedArg(a.rotation.randomise,zt.types.BOOLEAN,!1),size:zt.ensureTypedArg(a.size.randomise,zt.types.BOOLEAN,!1),color:zt.ensureTypedArg(a.color.randomise,zt.types.BOOLEAN,!1),opacity:zt.ensureTypedArg(a.opacity.randomise,zt.types.BOOLEAN,!1),angle:zt.ensureTypedArg(a.angle.randomise,zt.types.BOOLEAN,!1)},this.updateFlags={},this.updateCounts={},this.updateMap={maxAge:"params",position:"position",velocity:"velocity",acceleration:"acceleration",drag:"acceleration",wiggle:"params",rotation:"rotation",size:"size",color:"color",opacity:"opacity",angle:"angle"},this.updateMap)this.updateMap.hasOwnProperty(r)&&(this.updateCounts[this.updateMap[r]]=0,this.updateFlags[this.updateMap[r]]=!1,this._createGetterSetters(this[r],r));this.bufferUpdateRanges={},this.attributeKeys=null,this.attributeCount=0,zt.ensureValueOverLifetimeCompliance(this.color,to.valueOverLifetimeLength,to.valueOverLifetimeLength),zt.ensureValueOverLifetimeCompliance(this.opacity,to.valueOverLifetimeLength,to.valueOverLifetimeLength),zt.ensureValueOverLifetimeCompliance(this.size,to.valueOverLifetimeLength,to.valueOverLifetimeLength),zt.ensureValueOverLifetimeCompliance(this.angle,to.valueOverLifetimeLength,to.valueOverLifetimeLength)}function xs(a){(a=zt.ensureTypedArg(a,zt.types.OBJECT,{})).texture=zt.ensureTypedArg(a.texture,zt.types.OBJECT,{}),this.uuid=l.Math.generateUUID(),this.fixedTimeStep=zt.ensureTypedArg(a.fixedTimeStep,zt.types.NUMBER,.016),this.texture=zt.ensureInstanceOf(a.texture.value,l.Texture,null),this.textureFrames=zt.ensureInstanceOf(a.texture.frames,l.Vector2,new l.Vector2(1,1)),this.textureFrameCount=zt.ensureTypedArg(a.texture.frameCount,zt.types.NUMBER,this.textureFrames.x*this.textureFrames.y),this.textureLoop=zt.ensureTypedArg(a.texture.loop,zt.types.NUMBER,1),this.textureFrames.max(new l.Vector2(1,1)),this.hasPerspective=zt.ensureTypedArg(a.hasPerspective,zt.types.BOOLEAN,!0),this.colorize=zt.ensureTypedArg(a.colorize,zt.types.BOOLEAN,!0),this.maxParticleCount=zt.ensureTypedArg(a.maxParticleCount,zt.types.NUMBER,null),this.blending=zt.ensureTypedArg(a.blending,zt.types.NUMBER,l.AdditiveBlending),this.transparent=zt.ensureTypedArg(a.transparent,zt.types.BOOLEAN,!0),this.alphaTest=parseFloat(zt.ensureTypedArg(a.alphaTest,zt.types.NUMBER,0)),this.depthWrite=zt.ensureTypedArg(a.depthWrite,zt.types.BOOLEAN,!1),this.depthTest=zt.ensureTypedArg(a.depthTest,zt.types.BOOLEAN,!0),this.fog=zt.ensureTypedArg(a.fog,zt.types.BOOLEAN,!0),this.scale=zt.ensureTypedArg(a.scale,zt.types.NUMBER,300),this.emitters=[],this.emitterIDs=[],this.pool=[],this.poolCreationSettings=null,this._createNewWhenPoolEmpty=0,this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!1,this.particleCount=0,this.uniforms={textureSampler:{type:"t",value:this.texture},textureAnimation:{type:"v4",value:new l.Vector4(this.textureFrames.x,this.textureFrames.y,this.textureFrameCount,Math.max(Math.abs(this.textureLoop),1))},fogColor:{type:"c",value:null},fogNear:{type:"f",value:10},fogFar:{type:"f",value:200},fogDensity:{type:"f",value:.5},deltaTime:{type:"f",value:0},runTime:{type:"f",value:0},scale:{type:"f",value:this.scale}},this.defines={HAS_PERSPECTIVE:this.hasPerspective,COLORIZE:this.colorize,VALUE_OVER_LIFETIME_LENGTH:to.valueOverLifetimeLength,SHOULD_ROTATE_TEXTURE:!1,SHOULD_ROTATE_PARTICLES:!1,SHOULD_WIGGLE_PARTICLES:!1,SHOULD_CALCULATE_SPRITE:this.textureFrames.x>1||this.textureFrames.y>1},this.attributes={position:new wi("v3",!0),acceleration:new wi("v4",!0),velocity:new wi("v3",!0),rotation:new wi("v4",!0),rotationCenter:new wi("v3",!0),params:new wi("v4",!0),size:new wi("v4",!0),angle:new wi("v4",!0),color:new wi("v4",!0),opacity:new wi("v4",!0)},this.attributeKeys=Object.keys(this.attributes),this.attributeCount=this.attributeKeys.length,this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:ic.vertex,fragmentShader:ic.fragment,blending:this.blending,transparent:this.transparent,alphaTest:this.alphaTest,depthWrite:this.depthWrite,depthTest:this.depthTest,defines:this.defines,fog:this.fog}),this.geometry=new l.BufferGeometry,this.mesh=new l.Points(this.geometry,this.material),null===this.maxParticleCount&&console.warn("nunuStudio: No maxParticleCount specified. Adding emitters after rendering will probably cause errors.")}function to(a,r){this.group=new xs(void 0!==a?a:to.defaultGroup),this.emitter=new Ui(void 0!==r?r:to.defaultEmitter),this.group.addEmitter(this.emitter),l.Points.call(this,this.group.geometry,this.group.material),this.type="ParticleEmiter",this.name="particle",this.frustumCulled=!1,this.dynamicEmitter=!1,this.clock=new l.Clock,this.temp=new l.Vector4;var h=this;Object.defineProperties(this,{texture:{get:function(){return h.group.texture},set:function(d){h.group.texture=d}}})}function Mo(){l.Object3D.call(this),B.call(this)}function Nu(a){if(this.backgroundColor=null,this.backend=Nu.WEBGL2,this.autoClear=!1,this.autoClearColor=!1,this.autoClearDepth=!1,this.autoClearStencil=!1,this.antialiasing=!0,this.shadows=!0,this.stencil=!0,this.shadowsType=l.PCFSoftShadowMap,this.shadowsAutoUpdate=!0,this.toneMapping=l.NoToneMapping,this.toneMappingExposure=1,this.sortObjects=!0,this.gammaFactor=2,this.precision="highp",this.alpha=!0,this.premultipliedAlpha=!0,this.preserveDrawingBuffer=!1,this.powerPreference="high-performance",this.logarithmicDepthBuffer=!1,this.physicallyCorrectLights=!1,this.checkShaderErrors=!0,this.maxMorphTargets=8,this.maxMorphNormals=4,void 0!==a)for(var r in this)void 0!==a[r]&&(this[r]=a[r])}function Qs(){this.desktop={fullscreen:!1,frame:!0,resizable:!0}}Ui.constructor=Ui,Ui.prototype._createGetterSetters=function(a,r){var h=this;for(var d in a)if(a.hasOwnProperty(d)){var y=d.replace("_","");Object.defineProperty(a,y,{get:function(b){return function(){return this[b]}}(d),set:function(b){return function(N){var k=h.updateMap[r],T=this[b],H=to.valueOverLifetimeLength;"_rotationCenter"===b?(h.updateFlags.rotationCenter=!0,h.updateCounts.rotationCenter=0):"_randomise"===b?h.resetFlags[k]=N:(h.updateFlags[k]=!0,h.updateCounts[k]=0),h.group._updateDefines(),this[b]=N,Array.isArray(T)&&zt.ensureValueOverLifetimeCompliance(h[r],H,H)}}(d)})}},Ui.prototype._setBufferUpdateRanges=function(a){this.attributeKeys=a,this.attributeCount=a.length;for(var r=this.attributeCount-1;r>=0;--r)this.bufferUpdateRanges[a[r]]={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY}},Ui.prototype._calculatePPSValue=function(a){var r=this.particleCount;this.particlesPerSecond=this.duration?r/(a<this.duration?a:this.duration):r/a},Ui.prototype._setAttributeOffset=function(a){this.attributeOffset=a,this.activationIndex=a,this.activationEnd=a+this.particleCount},Ui.prototype._assignValue=function(a,r){switch(a){case"position":this._assignPositionValue(r);break;case"velocity":case"acceleration":this._assignForceValue(r,a);break;case"size":case"opacity":this._assignAbsLifetimeValue(r,a);break;case"angle":this._assignAngleValue(r);break;case"params":this._assignParamsValue(r);break;case"rotation":this._assignRotationValue(r);break;case"color":this._assignColorValue(r)}},Ui.prototype._assignPositionValue=function(a){var r=this.position,h=this.attributes.position,d=r._value,y=r._spread;switch(r._distribution){case Op.BOX:zt.randomVector3(h,a,d,y,r._spreadClamp);break;case Op.SPHERE:zt.randomVector3OnSphere(h,a,d,r._radius,r._spread.x,r._radiusScale,r._spreadClamp.x,r._distributionClamp||this.particleCount);break;case Op.DISC:zt.randomVector3OnDisc(h,a,d,r._radius,r._spread.x,r._radiusScale,r._spreadClamp.x)}},Ui.prototype._assignForceValue=function(a,r){var h,d,N,k=this[r],T=k._value,H=k._spread;switch(k._distribution){case Op.BOX:zt.randomVector3(this.attributes[r],a,T,H);break;case Op.SPHERE:d=(h=this.attributes.position.typedArray.array)[N=3*a],zt.randomDirectionVector3OnSphere(this.attributes[r],a,d,h[N+1],h[N+2],this.position._value,k._value.x,k._spread.x);break;case Op.DISC:d=(h=this.attributes.position.typedArray.array)[N=3*a],zt.randomDirectionVector3OnDisc(this.attributes[r],a,d,h[N+1],h[N+2],this.position._value,k._value.x,k._spread.x)}if("acceleration"===r){var Y=zt.clamp(zt.randomFloat(this.drag._value,this.drag._spread),0,1);this.attributes.acceleration.typedArray.array[4*a+3]=Y}},Ui.prototype._assignAbsLifetimeValue=function(a,r){var h,d=this.attributes[r].typedArray,y=this[r];zt.arrayValuesAreEqual(y._value)&&zt.arrayValuesAreEqual(y._spread)?(h=Math.abs(zt.randomFloat(y._value[0],y._spread[0])),d.setVec4Components(a,h,h,h,h)):d.setVec4Components(a,Math.abs(zt.randomFloat(y._value[0],y._spread[0])),Math.abs(zt.randomFloat(y._value[1],y._spread[1])),Math.abs(zt.randomFloat(y._value[2],y._spread[2])),Math.abs(zt.randomFloat(y._value[3],y._spread[3])))},Ui.prototype._assignAngleValue=function(a){var r,h=this.attributes.angle.typedArray,d=this.angle;zt.arrayValuesAreEqual(d._value)&&zt.arrayValuesAreEqual(d._spread)?(r=zt.randomFloat(d._value[0],d._spread[0]),h.setVec4Components(a,r,r,r,r)):h.setVec4Components(a,zt.randomFloat(d._value[0],d._spread[0]),zt.randomFloat(d._value[1],d._spread[1]),zt.randomFloat(d._value[2],d._spread[2]),zt.randomFloat(d._value[3],d._spread[3]))},Ui.prototype._assignParamsValue=function(a){this.attributes.params.typedArray.setVec4Components(a,this.isStatic?1:0,0,Math.abs(zt.randomFloat(this.maxAge._value,this.maxAge._spread)),zt.randomFloat(this.wiggle._value,this.wiggle._spread))},Ui.prototype._assignRotationValue=function(a){this.attributes.rotation.typedArray.setVec3Components(a,zt.getPackedRotationAxis(this.rotation._axis,this.rotation._axisSpread),zt.randomFloat(this.rotation._angle,this.rotation._angleSpread),this.rotation._static?0:1),this.attributes.rotationCenter.typedArray.setVec3(a,this.rotation._center)},Ui.prototype._assignColorValue=function(a){zt.randomColorAsHex(this.attributes.color,a,this.color._value,this.color._spread)},Ui.prototype._resetParticle=function(a){for(var r,h,d=this.resetFlags,y=this.updateFlags,b=this.updateCounts,N=this.attributeKeys,k=this.attributeCount-1;k>=0;--k)h=y[r=N[k]],!0!==d[r]&&!0!==h||(this._assignValue(r,a),this._updateAttributeUpdateRange(r,a),!0===h&&b[r]===this.particleCount?(y[r]=!1,b[r]=0):!0===h&&++b[r])},Ui.prototype._updateAttributeUpdateRange=function(a,r){var h=this.bufferUpdateRanges[a];h.min=Math.min(r,h.min),h.max=Math.max(r,h.max)},Ui.prototype._resetBufferRanges=function(){for(var a=this.bufferUpdateRanges,r=this.bufferUpdateKeys,h=this.bufferUpdateCount-1;h>=0;--h){var d=r[h];a[d].min=Number.POSITIVE_INFINITY,a[d].max=Number.NEGATIVE_INFINITY}},Ui.prototype._onRemove=function(){this.particlesPerSecond=0,this.attributeOffset=0,this.activationIndex=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.age=0},Ui.prototype._decrementParticleCount=function(){--this.activeParticleCount},Ui.prototype._incrementParticleCount=function(){++this.activeParticleCount},Ui.prototype._checkParticleAges=function(a,r,h,d){for(var y,b,N,k,T=r-1;T>=a;--T)0!==(k=h[y=4*T])&&(N=h[y+1],b=h[y+2],1===this.direction?(N+=d)>=b&&(N=0,k=0,this._decrementParticleCount()):(N-=d)<=0&&(N=b,k=0,this._decrementParticleCount()),h[y]=k,h[y+1]=N,this._updateAttributeUpdateRange("params",T))},Ui.prototype._activateParticles=function(a,r,h,d){for(var y,b,N=this.direction,k=a;k<r;++k)0!==h[y=4*k]&&1!==this.particleCount||(this._incrementParticleCount(),h[y]=1,this._resetParticle(k),b=d*(k-a),h[y+1]=-1===N?h[y+2]-b:b,this._updateAttributeUpdateRange("params",k))},Ui.prototype.tick=function(a){if(!this.isStatic){null===this.paramsArray&&(this.paramsArray=this.attributes.params.typedArray.array);var r=this.attributeOffset,h=r+this.particleCount,d=this.paramsArray,y=this.particlesPerSecond*this.activeMultiplier*a,b=this.activationIndex;if(this._resetBufferRanges(),this._checkParticleAges(r,h,d,a),!1!==this.alive){if(null!==this.duration&&this.age>this.duration)return this.alive=!1,void(this.age=0);var N=1===this.particleCount?b:0|b,k=Math.min(N+y,this.activationEnd),T=k-this.activationIndex|0;this._activateParticles(N,k,d,T>0?a/T:0),this.activationIndex+=y,this.activationIndex>h&&(this.activationIndex=r),this.age+=a}else this.age=0}},Ui.prototype.reset=function(a){if(this.age=0,this.alive=!1,!0===a){for(var r,h=this.attributeOffset,y=this.paramsArray,b=this.attributes.params.bufferAttribute,N=h+this.particleCount-1;N>=h;--N)y[r=4*N]=0,y[r+1]=0;b.updateRange.offset=0,b.updateRange.count=-1,b.needsUpdate=!0}return this},Ui.prototype.enable=function(){return this.alive=!0,this},Ui.prototype.disable=function(){return this.alive=!1,this},Ui.prototype.remove=function(){return null!==this.group?this.group.removeEmitter(this):console.error("nunuStudio: ParticleEmitterControl does not belong to a group, cannot remove."),this},Ui.prototype.toJSON=function(a){var r={};r.uuid=this.uuid,r.type=this.type,r.direction=this.direction,r.particleCount=this.particleCount,r.duration=this.duration,r.isStatic=this.isStatic,r.maxAge={},r.maxAge.value=this.maxAge.value,r.maxAge.spread=this.maxAge.spread,r.position={},r.position.value=this.position.value.toArray(),r.position.spread=this.position.spread.toArray(),r.position.radius=this.position.radius,r.position.radiusScale=this.position.radiusScale.toArray(),r.velocity={},r.velocity.value=this.velocity.value.toArray(),r.velocity.spread=this.velocity.spread.toArray(),r.acceleration={},r.acceleration.value=this.acceleration.value.toArray(),r.acceleration.spread=this.acceleration.spread.toArray(),r.wiggle={},r.wiggle.value=this.wiggle.value,r.wiggle.spread=this.wiggle.spread,r.opacity={},r.opacity.value=this.opacity.value.slice(0),r.opacity.spread=this.opacity.spread,r.size={},r.size.value=this.size.value.slice(0),r.size.spread=this.size.spread,r.angle={},r.angle.value=this.angle.value.slice(0),r.angle.spread=this.angle.spread,r.color={},r.color.value=[];for(var h=0;h<this.color.value.length;h++)r.color.value.push(this.color.value[h].getHex());for(r.color.spread=[],h=0;h<this.color.spread.length;h++)r.color.spread.push(this.color.spread[h].toArray());return r},xs.constructor=xs,xs.prototype._updateDefines=function(){for(var a,r=this.emitters,h=this.defines,d=r.length-1;d>=0;--d)a=r[d],h.SHOULD_CALCULATE_SPRITE||(h.SHOULD_ROTATE_TEXTURE=h.SHOULD_ROTATE_TEXTURE||!!Math.max(Math.max.apply(null,a.angle.value),Math.max.apply(null,a.angle.spread))),h.SHOULD_ROTATE_PARTICLES=h.SHOULD_ROTATE_PARTICLES||!!Math.max(a.rotation.angle,a.rotation.angleSpread),h.SHOULD_WIGGLE_PARTICLES=h.SHOULD_WIGGLE_PARTICLES||!!Math.max(a.wiggle.value,a.wiggle.spread);this.material.needsUpdate=!0},xs.prototype._applyAttributesToGeometry=function(){var a,r,h=this.attributes,d=this.geometry,y=d.attributes;for(var b in h)h.hasOwnProperty(b)&&(a=h[b],(r=y[b])?r.array=a.typedArray.array:d.setAttribute(b,a.bufferAttribute),a.bufferAttribute.needsUpdate=!0);this.geometry.setDrawRange(0,this.particleCount)},xs.prototype.addEmitter=function(a){if(a instanceof Ui!=0)if(this.emitterIDs.indexOf(a.uuid)>-1)console.error("nunuStudio: ParticleEmitterControl already exists in this group.");else{if(null===a.group){var r=this.attributes,h=this.particleCount,d=h+a.particleCount;for(var y in this.particleCount=d,null!==this.maxParticleCount&&this.particleCount>this.maxParticleCount&&console.warn("nunuStudio: ParticleGroup maxParticleCount exceeded. Requesting",this.particleCount,"particles, can support only",this.maxParticleCount),a._calculatePPSValue(a.maxAge._value+a.maxAge._spread),a._setBufferUpdateRanges(this.attributeKeys),a._setAttributeOffset(h),a.group=this,a.attributes=this.attributes,r)r.hasOwnProperty(y)&&r[y]._createBufferAttribute(null!==this.maxParticleCount?this.maxParticleCount:this.particleCount);for(var b=h;b<d;++b)a._assignPositionValue(b),a._assignForceValue(b,"velocity"),a._assignForceValue(b,"acceleration"),a._assignAbsLifetimeValue(b,"opacity"),a._assignAbsLifetimeValue(b,"size"),a._assignAngleValue(b),a._assignRotationValue(b),a._assignParamsValue(b),a._assignColorValue(b);return this._applyAttributesToGeometry(),this.emitters.push(a),this.emitterIDs.push(a.uuid),this._updateDefines(a),this.material.needsUpdate=!0,this.geometry.needsUpdate=!0,this._attributesNeedRefresh=!0,this}console.error("nunuStudio: ParticleEmitterControl already belongs to another group.")}else console.error("nunuStudio: emitter argument must be instance of ParticleEmitterControl.",a)},xs.prototype.removeEmitter=function(a){var r=this.emitterIDs.indexOf(a.uuid);if(a instanceof Ui!=0)if(-1!==r){for(var h=a.attributeOffset,d=h+a.particleCount,y=this.attributes.params.typedArray,b=h;b<d;++b)y.array[4*b]=0,y.array[4*b+1]=0;for(var N in this.emitters.splice(r,1),this.emitterIDs.splice(r,1),this.attributes)this.attributes.hasOwnProperty(N)&&this.attributes[N].splice(h,d);this.particleCount-=a.particleCount,a._onRemove(),this._attributesNeedRefresh=!0}else console.error("nunuStudio: ParticleEmitterControl does not exist in this group. Will not remove.");else console.error("nunuStudio: emitter argument must be instance of ParticleEmitterControl. Was provided with:",a)},xs.prototype.getFromPool=function(){var a=this.pool,r=this._createNewWhenPoolEmpty;if(a.length)return a.pop();if(r){var h=new Ui(this.poolCreationSettings);return this.addEmitter(h),h}return null},xs.prototype.releaseIntoPool=function(a){if(a instanceof Ui!=0)return a.reset(),this.pool.unshift(a),this;console.error("nunuStudio: Argument is not instanceof ParticleEmitterControl:",a)},xs.prototype.getPool=function(){return this.pool},xs.prototype.addPool=function(a,r,h){var d;this.poolCreationSettings=r,this._createNewWhenPoolEmpty=!!h;for(var y=0;y<a;++y)d=Array.isArray(r)?new Ui(r[y]):new Ui(r),this.addEmitter(d),this.releaseIntoPool(d);return this},xs.prototype._triggerSingleEmitter=function(a){var r=this.getFromPool(),h=this;if(null!==r)return a instanceof l.Vector3&&(r.position.value.copy(a),r.position.value=r.position.value),r.enable(),setTimeout(function(){r.disable(),h.releaseIntoPool(r)},1e3*Math.max(r.duration,r.maxAge.value+r.maxAge.spread)),this;console.log("nunuStudio: ParticleGroup pool ran out.")},xs.prototype.triggerEmitter=function(a,r){if("number"==typeof a&&a>1)for(var h=0;h<a;++h)this._triggerSingleEmitter(r);else this._triggerSingleEmitter(r);return this},xs.prototype._updateUniforms=function(a){this.uniforms.runTime.value+=a,this.uniforms.deltaTime.value=a},xs.prototype._resetBufferRanges=function(){for(var a=this.attributeKeys,r=this.attributeCount-1;r>=0;--r)this.attributes[a[r]].resetUpdateRange()},xs.prototype._updateBuffers=function(a){for(var r,h,d,y=this.attributeKeys,b=this.attributes,N=a.bufferUpdateRanges,k=this.attributeCount-1;k>=0;--k)h=N[r=y[k]],(d=b[r]).setUpdateRange(h.min,h.max),d.flagUpdate()},xs.prototype.tick=function(a){var r=this.emitters,h=r.length,d=a||this.fixedTimeStep,y=this.attributeKeys,b=this.attributes;if(this._updateUniforms(d),this._resetBufferRanges(),0!==h||!1!==this._attributesNeedRefresh||!1!==this._attributesNeedDynamicReset){for(var N,k=0;k<h;++k)(N=r[k]).tick(d),this._updateBuffers(N);if(!0===this._attributesNeedDynamicReset){for(k=this.attributeCount-1;k>=0;--k)b[y[k]].resetDynamic();this._attributesNeedDynamicReset=!1}if(!0===this._attributesNeedRefresh){for(k=this.attributeCount-1;k>=0;--k)b[y[k]].forceUpdateAll();this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!0}}},xs.prototype.dispose=function(){return this.geometry.dispose(),this.material.dispose(),this},xs.prototype.toJSON=function(a){var r={texture:{}};return r.texture.value=this.texture.uuid,r.texture.frames=this.textureFrames.toArray(),r.texture.frameCount=this.textureFrameCount,r.texture.loop=this.textureLoop,r.fixedTimeStep=this.fixedTimeStep,r.hasPerspective=this.hasPerspective,r.colorize=this.colorize,r.maxParticleCount=this.maxParticleCount,r.transparent=this.transparent,r.blending=this.blending,r.alphaTest=this.alphaTest,r.depthWrite=this.depthWrite,r.depthTest=this.depthTest,r.fog=this.fog,r.scale=this.scale,r},to.valueOverLifetimeLength=4,to.prototype=Object.create(l.Points.prototype),to.defaultEmitter={particleCount:200,velocity:{value:new l.Vector3(0,0,0),spread:new l.Vector3(3,3,3)},acceleration:{value:new l.Vector3(0,0,0),spread:new l.Vector3(0,0,0)}},to.defaultGroup={texture:{value:null},maxParticleCount:200,blending:l.AdditiveBlending,fog:!1,depthWrite:!1,depthTest:!0,transparent:!0,hasPerspective:!0},to.prototype.reload=function(){this.dispose();var a=this.children;this.children=[];var r=(new Zi).parse(this.toJSON());this.children=a,this.group=r.group,this.emitter=r.emitter,this.geometry=this.group.geometry,this.material=this.group.material},to.prototype.updateMatrix=function(){this.dynamicEmitter?(this.matrix.makeRotationFromQuaternion(this.quaternion),this.matrix.scale(this.scale)):this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},to.prototype.onBeforeRender=function(a,r,h,d){this.group.uniforms.scale.value=a.getCurrentViewport(this.temp).w,this.group.tick(this.clock.getDelta()),!0===this.dynamicEmitter&&(this.emitter.position.value=this.position)},to.prototype.dispose=function(){this.group.dispose(),l.Object3D.prototype.dispose.call(this)},to.prototype.toJSON=function(a){var r=this.material,h=this.geometry;this.material=void 0,this.geometry=void 0;var d=this.group.texture,y=l.Object3D.prototype.toJSON.call(this,a,function(b,N){d=d.toJSON(b)});return this.material=r,this.geometry=h,y.object.group=this.group.toJSON(a),y.object.emitter=this.emitter.toJSON(a),y},to.fromJSON=function(a,r){function h(N){return Array.isArray(N)?(new l.Vector3).fromArray(N):new l.Vector3(N.x,N.y,N.z)}if(void 0!==a.group){var d=a.group;d.texture.value=r.getTexture(d.texture.value),d.texture.frames=(new l.Vector2).fromArray(d.texture.frames||[1,1])}if(void 0!==a.emitter){var y=a.emitter;y.position.value=h(y.position.value),y.position.spread=h(y.position.spread),y.velocity.value=h(y.velocity.value),y.velocity.spread=h(y.velocity.spread),y.acceleration.value=h(y.acceleration.value),y.acceleration.spread=h(y.acceleration.spread);for(var b=0;b<y.color.value.length;b++)y.color.value[b]=new l.Color(y.color.value[b]),y.color.spread[b]=h(y.color.spread[b])}return new to(a.group,a.emitter)},Mo.prototype=Object.create(l.Object3D.prototype),Object.assign(Mo.prototype,B.prototype),Mo.prototype.dispose=function(){for(var a=0;a<B.libraries.length;a++){var r=B.libraries[a];for(var h in this[r])this[r][h].dispose instanceof Function&&this[r][h].dispose()}},Mo.prototype.removeGeometry=function(a,r){this.traverse(function(h){void 0!==h.geometry&&h.geometry.uuid===a.uuid&&(h.geometry=r)}),delete this.geometries[a.uuid]},Mo.prototype.getResourceByName=function(a){for(var r in this.resources)if(this.resources[r].name===a)return this.resources[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},Mo.prototype.addResource=function(a){a instanceof xi&&(this.resources[a.uuid]=a)},Mo.prototype.removeResource=function(a){delete this.resources[a.uuid]},Mo.prototype.getImageByName=function(a){for(var r in this.images)if(this.images[r].name===a)return this.images[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},Mo.prototype.removeImage=function(a){a instanceof ys&&delete this.images[a.uuid]},Mo.prototype.getVideoByName=function(a){for(var r in this.videos)if(this.videos[r].name===a)return this.videos[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},Mo.prototype.removeVideo=function(a){a instanceof kl&&delete this.videos[a.uuid]},Mo.prototype.getMaterialByName=function(a){for(var r in this.materials)if(this.materials[r].name===a)return this.materials[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},Mo.prototype.addMaterial=function(a){a instanceof l.Material&&(this.materials[a.uuid]=a)},Mo.prototype.removeMaterial=function(a,r,h){void 0===r&&(r=new l.MeshBasicMaterial),void 0===h&&(h=new l.SpriteMaterial),a instanceof l.Material&&(delete this.materials[a.uuid],this.traverse(function(d){void 0!==d.material&&d.material.uuid===a.uuid&&(d.material=d instanceof l.Sprite?h:r)}))},Mo.prototype.getTextureByName=function(a){for(var r in this.textures)if(this.textures[r].name===a)return this.textures[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},Mo.prototype.addTexture=function(a){material instanceof l.Texture&&(this.textures[a.uuid]=a)},Mo.prototype.removeTexture=function(a,r){void 0===r&&(r=new l.Texture),a instanceof l.Texture&&(delete this.textures[a.uuid],this.traverse(function(h){if(void 0!==h.material){var d=h.material;d.map&&d.map.uuid===a.uuid&&(d.map=r,d.needsUpdate=!0),d.bumpMap&&d.bumpMap.uuid===a.uuid&&(d.bumpMap=r,d.needsUpdate=!0),d.normalMap&&d.normalMap.uuid===a.uuid&&(d.normalMap=r,d.needsUpdate=!0),d.displacementMap&&d.displacementMap.uuid===a.uuid&&(d.displacementMap=r,d.needsUpdate=!0),d.specularMap&&d.specularMap.uuid===a.uuid&&(d.specularMap=r,d.needsUpdate=!0),d.emissiveMap&&d.emissiveMap.uuid===a.uuid&&(d.emissiveMap=r,d.needsUpdate=!0),d.alphaMap&&d.alphaMap.uuid===a.uuid&&(d.alphaMap=r,d.needsUpdate=!0),d.roughnessMap&&d.roughnessMap.uuid===a.uuid&&(d.roughnessMap=r,d.needsUpdate=!0),d.metalnessMap&&d.metalnessMap.uuid===a.uuid&&(d.metalnessMap=r,d.needsUpdate=!0),d.envMap&&d.envMap.uuid===a.uuid&&(d.envMap=null,d.needsUpdate=!0)}else h instanceof to&&h.group.texture.uuid===a.uuid&&(h.group.texture=r)}))},Mo.prototype.getFontByName=function(a){for(var r in this.fonts)if(this.fonts[r].name===a)return this.fonts[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},Mo.prototype.addFont=function(a){a instanceof Xe&&(this.fonts[a.uuid]=a)},Mo.prototype.removeFont=function(a,r){void 0===r&&(r=new Xe),a instanceof Xe&&(delete this.fonts[a.uuid],this.traverse(function(h){void 0!==h.font&&h.font.uuid===a.uuid&&h.setFont(r)}))},Mo.prototype.getAudioByName=function(a){for(var r in this.audio)if(this.audio[r].name===a)return this.audio[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},Mo.prototype.addAudio=function(a){a instanceof Nt&&(this.audio[a.uuid]=a)},Mo.prototype.removeAudio=function(a,r){void 0===r&&(r=new Nt),a instanceof Nt&&(delete this.audio[a.uuid],this.traverse(function(h){void 0!==h.audio&&h.audio.uuid===a.uuid&&h.setAudio(r)}))},Nu.WEBGL=1,Nu.WEBGL2=2,Nu.prototype.createRenderer=function(a){var r=null;if(this.backend===Nu.WEBGL2)try{r=a.getContext("webgl2",{xrCompatible:!0})}catch(y){console.warn("nunuStudio: Failed to create WebGL2 context",y)}var d=new l.WebGLRenderer({canvas:a,context:r,precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,antialias:this.antialiasing,stencil:this.stencil,preserveDrawingBuffer:this.preserveDrawingBuffer,powerPreference:this.powerPreference,logarithmicDepthBuffer:this.logarithmicDepthBuffer});return this.apply(d),null!==this.backgroundColor&&(a.style.backgroundColor=this.backgroundColor),d},Nu.prototype.apply=function(a){a.autoClear=this.autoClear,a.autoClearColor=this.autoClearColor,a.autoClearDepth=this.autoClearDepth,a.autoClearStencil=this.autoClearStencil,a.shadowMap.enabled=this.shadows,a.shadowMap.type=this.shadowsType,a.shadowMap.autoUpdate=this.shadowsAutoUpdate,a.shadowMap.needsUpdate=!0,a.toneMapping=this.toneMapping,a.toneMappingExposure=this.toneMappingExposure,a.debug.checkShaderErrors=this.checkShaderErrors,a.sortObjects=this.sortObjects,a.gammaFactor=this.gammaFactor,a.physicallyCorrectLights=this.physicallyCorrectLights,a.maxMorphTargets=this.maxMorphTargets,a.maxMorphNormals=this.maxMorphNormals},Nu.prototype.toJSON=function(){return{backgroundColor:this.backgroundColor,backend:this.backend,autoClear:this.autoClear,autoClearColor:this.autoClearColor,autoClearDepth:this.autoClearDepth,autoClearStencil:this.autoClearStencil,antialiasing:this.antialiasing,shadows:this.shadows,stencil:this.stencil,shadowsType:this.shadowsType,shadowsAutoUpdate:this.shadowsAutoUpdate,toneMapping:this.toneMapping,toneMappingExposure:this.toneMappingExposure,sortObjects:this.sortObjects,checkShaderErrors:this.checkShaderErrors,gammaFactor:this.gammaFactor,precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer,powerPreference:this.powerPreference,logarithmicDepthBuffer:this.logarithmicDepthBuffer,physicallyCorrectLights:this.physicallyCorrectLights,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals}},Nu.prototype.fromJSON=function(a){this.backgroundColor=a.backgroundColor,this.backend=a.backend,this.autoClear=a.autoClear,this.autoClearColor=a.autoClearColor,this.autoClearDepth=a.autoClearDepth,this.autoClearStencil=a.autoClearStencil,this.antialiasing=a.antialiasing,this.shadows=a.shadows,this.stencil=a.stencil,this.shadowsType=a.shadowsType,this.shadowsAutoUpdate=a.shadowsAutoUpdate,this.toneMapping=a.toneMapping,this.toneMappingExposure=a.toneMappingExposure,this.sortObjects=a.sortObjects,this.checkShaderErrors=a.checkShaderErrors,this.gammaFactor=a.gammaFactor,this.precision=a.precision,this.alpha=a.alpha,this.premultipliedAlpha=a.premultipliedAlpha,this.preserveDrawingBuffer=a.preserveDrawingBuffer,this.powerPreference=a.powerPreference,this.logarithmicDepthBuffer=a.logarithmicDepthBuffer,this.physicallyCorrectLights=a.physicallyCorrectLights,this.maxMorphTargets=a.maxMorphTargets,this.maxMorphNormals=a.maxMorphNormals};var df=__webpack_require__(872);function br(a,r){this.element=document.createElement(void 0!==r?r:"div"),this.element.style.position="absolute",this.element.style.overflow="hidden",this.event=new pn,this.parent=null,void 0!==a&&this.attachTo(a),this.visible=!0,this.size=new l.Vector2(0,0),this.position=new l.Vector2(0,0),this._mode=br.TOP_LEFT}function ns(a){this.program=null,this.renderer=null,this.running=!1,this.canvasFitWindow=!1,this.canvas=a,this.events=new pn,void 0===a&&(this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.left="0px",this.canvas.style.top="0px",this.canvasFitWindow=!0,document.body.appendChild(this.canvas))}function $i(){}function Ro(){}function ii(){Mo.call(this),this.type="Program",this.matrixAutoUpdate=!1,this.app=null,this.name="program",this.description="",this.author="",this.version="0.0.0",this.lockPointer=!1,this.handlePixelRatio=!0,this.ar=!0,this.vr=!0,this.vrScale=1,this.rendererConfig=new Nu,this.targetConfig=new Qs,this.defaultScene=null,this.defaultCamera=null,this.scene=null,this.keyboard=null,this.mouse=null,this.renderer=null,this.canvas=null,this.division=null,this.manager=new pn,this.clock=new l.Clock,this.xrEnabled=!1,this.xrMode=ii.XR_NONE}function Po(){l.Scene.call(this),this.name="scene",this.matrixAutoUpdate=!1,this.usePhysics=!0,this.world=new Dn,this.world.defaultContactMaterial.contactEquationStiffness=1e9,this.world.defaultContactMaterial.contactEquationRelaxation=4,this.world.quatNormalizeSkip=0,this.world.quatNormalizeFast=!1,this.world.gravity.set(0,-9.8,0),this.world.broadphase=new mr,this.world.solver=new Ms(new _u),this.world.solver.tolerance=.05,this.world.solver.iterations=7,this.background=null,this.alpha=1,this.cameras=[],this.defaultCamera=null,this.delta=0,this.raycaster=new l.Raycaster,this.useOctree=!1,this.octree=null,this.octreeUpdateScheduled=!1,this.octreeMatches=[],this.program=null,this.canvas=null,this.mouse=new l.Vector2(0,0)}function iu(a){l.AnimationMixer.call(this,a),this.playing=!1}br.prototype.constructor=br,br.prototype.isComponent=!0,br.TOP_LEFT=0,br.TOP_RIGHT=1,br.BOTTOM_LEFT=2,br.BOTTOM_RIGHT=3,br.preventDefault=function(a){a.preventDefault()},br.prototype.addEvent=function(a,r){this.event.addAndCreate(this.element,a,r)},br.prototype.removeEvent=function(a){this.event.remove(this.element,a)},br.prototype.replaceEvent=function(a,r){this.event.remove(this.element,a),this.event.addAndCreate(this.element,a,r)},br.prototype.addClass=function(a){this.element.classList.add(a)},br.prototype.removeClass=function(a){this.element.classList.contains(a)&&this.element.classList.remove(a)},br.prototype.setStyle=function(a,r){this.element.style[a]=r},br.prototype.setStyles=function(a){for(var r in a)this.element.style[r]=a[r]},br.prototype.preventDragEvents=function(){this.element.ondrop=br.preventDefault,this.element.ondragover=br.preventDefault},br.prototype.setAltText=function(a){var r=document.createElement("div");r.style.position="absolute",r.style.display="none",r.style.alignItems="center",r.style.zIndex="10000",r.style.border="3px solid",r.style.borderRadius="5px",r.style.color="var(--color-light)",r.style.backgroundColor="var(--bar-color)",r.style.borderColor="var(--bar-color)",r.style.height="fit-content",document.body.appendChild(r);var h=document.createTextNode(a);r.appendChild(h);var d=this.destroy;return this.destroy=function(){d.call(this),document.body.contains(r)&&document.body.removeChild(r)},this.element.style.pointerEvents="auto",this.addEvent("mousemove",function(y){r.style.display="flex",r.style.left=y.clientX+8+"px",r.style.top=y.clientY-20+"px"}),this.addEvent("mouseout",function(){r.style.display="none"}),r},br.prototype.setOnClick=function(a){this.addEvent("click",a)},br.prototype.removeAllChildren=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild)},br.prototype.attachTo=function(a){this.parent!==a&&void 0!==a&&(null!==this.parent&&br.prototype.destroy.call(this),this.parent=a,!0===a.isComponent?a.element.appendChild(this.element):(console.warn("nunuStudio: Parent is not a Component.",this),this.parent.appendChild(this.element)))},br.prototype.watchPointer=function(){var a=this;this.pointerInside=!1,this.element.addEventListener("mouseenter",function(){a.pointerInside=!0}),this.element.addEventListener("mouseleave",function(){a.pointerInside=!1})},br.prototype.destroy=function(){null!==this.parent&&(!0===this.parent.isComponent?this.parent.element.contains(this.element)&&(this.parent.element.removeChild(this.element),this.parent=null):(console.warn("nunuStudio: Parent is not a Component.",this),this.parent.contains(this.element)&&(this.parent.removeChild(this.element),this.parent=null)))},br.prototype.setMode=function(a){this._mode=a,this.element.style.bottom=null,this.element.style.top=null,this.element.style.right=null,this.element.style.left=null},br.prototype.center=function(){this.position.set((this.parent.size.x-this.size.x)/2,(this.parent.size.y-this.size.y)/2)},br.prototype.setVisibility=function(a){this.visible=a,this.updateVisibility()},br.prototype.updateVisibility=function(){this.element.style.display=this.visible?"block":"none"},br.prototype.updatePosition=function(a){void 0!==a&&(this._mode=a),this._mode===br.TOP_LEFT||this._mode===br.TOP_RIGHT?this.element.style.top=this.position.y+"px":this.element.style.bottom=this.position.y+"px",this._mode===br.TOP_LEFT||this._mode===br.BOTTOM_LEFT?this.element.style.left=this.position.x+"px":this.element.style.right=this.position.x+"px"},br.prototype.updateSize=function(){this.element.style.width=this.size.x+"px",this.element.style.height=this.size.y+"px"},br.prototype.updateInterface=function(){this.updateVisibility(),this.visible&&(this.updateSize(),this.updatePosition())},ns.loadApp=function(a,r){"string"==typeof r&&(r=document.getElementById(r));var h=new ns(r);h.loadRunProgram(a),window.addEventListener("resize",function(){vo.isFullscreen()?(h.canvas.width=window.innerWidth,h.canvas.height=window.innerHeight):h.canvas.parentElement&&(h.canvas.width=h.canvas.parentElement.offsetWidth,h.canvas.height=h.canvas.parentElement.offsetHeight),h.resize()})},ns.prototype.run=function(){if(null!==this.program){if(this.renderer=this.program.rendererConfig.createRenderer(this.canvas),this.program.app=this,this.program.defaultCamera=new Ie(60,1,.1,1e5),this.program.defaultCamera.position.set(0,5,-5),this.program.setRenderer(this.renderer),this.program.initialize(),this.program.lockPointer){var r=this.mouse;this.events.add(this.canvas,"click",function(){r.setLock(!0)})}var h=this;this.events.add(window,"beforeunload",function(){h.exit()}),this.events.create(),this.resize(),this.resume()}else console.warn("nunuStudio: no program is loaded [app.loadPogram(fname)]")},ns.prototype.loadRunProgram=function(a,r,h){this.loadProgramAsync(a,function(d){d.run(),void 0!==r&&r(d)},h)},ns.prototype.loadProgram=function(a){if(a.endsWith(".isp")){var r=new Zi,h=Bn.readFile(a);this.program=r.parse(JSON.parse(h))}else if(a.endsWith(".nsp")){r=new Zi,h=Bn.readFileArrayBuffer(a);var d=new df.fG}this.program=r.parse(d.decode(h))},ns.prototype.loadProgramAsync=function(a,r,h){var d=this;a.endsWith(".isp")?Bn.readFile(a,!1,function(y){var b=new Zi;d.program=b.parse(JSON.parse(y)),void 0!==r&&r(d)},function(y){h(y.lengthComputable?y.loaded/y.total*100:0,y)}):a.endsWith(".nsp")&&Bn.readFileArrayBuffer(a,!1,function(y){var b=new Zi,N=new df.fG;d.program=b.parse(N.decode(y)),void 0!==r&&r(d)},function(y){h(y.lengthComputable?y.loaded/y.total*100:0,y)})},ns.prototype.update=function(){this.program.update(),this.program.render(this.renderer)},ns.prototype.exit=function(){this.events.destroy(),null!==this.program&&(this.program.dispose(),this.program=null),null!==this.renderer&&(this.renderer.dispose(),this.renderer=null),void 0!==this.onExit&&this.onExit()},ns.prototype.resume=function(){if(null!==this.program&&!this.running){var a=this;this.renderer.setAnimationLoop(function(){a.update()}),this.running=!0}},ns.prototype.pause=function(){this.running=!1,this.renderer.setAnimationLoop(null)},ns.prototype.setCanvas=function(a){this.canvas=a,this.canvasFitWindow=!1},ns.prototype.resize=function(){if(null!==this.canvas&&null!==this.program&&null!==this.renderer){var a=1,r=1;this.canvasFitWindow?(this.canvas.style.width=window.innerWidth+"px",this.canvas.style.height=window.innerHeight+"px",a=window.innerWidth,r=window.innerHeight):(a=this.canvas.offsetWidth,r=this.canvas.offsetHeight),this.program.handlePixelRatio&&(a*=window.devicePixelRatio,r*=window.devicePixelRatio),this.renderer.setSize(a,r,!1),this.program.resize(a,r)}},ns.prototype.sendData=function(a){null!==this.program&&this.program.receiveDataApp(a)},ns.prototype.setOnDataReceived=function(a){this.onDataReceived=a},ns.prototype.setOnExit=function(a){this.onExit=a},ns.prototype.vrAvailable=function(){return null!==this.program&&this.program.vrAvailable()},ns.prototype.toggleVR=function(){this.vrAvailable()?this.program.xrEnabled?this.program.exitVR():this.program.enterVR():console.warn("nunuStudio: Loaded program is not VR enabled.")},ns.prototype.arAvailable=function(){return null!==this.program&&this.program.arAvailable()},ns.prototype.toggleAR=function(){this.arAvailable()?this.program.xrEnabled?this.program.exitAR():this.program.enterAR():console.warn("nunuStudio: Loaded program is not AR enabled.")},ns.prototype.toggleFullscreen=function(a){var r=vo.isFullscreen();void 0===a&&(a=this.canvas),vo.setFullscreen(!r,a)},$i.webXRAvailable=!1,$i.webXRSession=null,$i.webVRAvailable=!1,$i.webVRDisplay=null,$i.vrAvailable=function(){return $i.webXRAvailable||$i.webVRAvailable},$i.enterVR=function(a,r){$i.webXRAvailable?$i.getWebXRSession().then(function(h){a.xr.enabled=!0,a.xr.setSession(h),$i.webXRSession=h,void 0!==r&&r()}).catch(function(h){console.warn("nunuStudio: Failed to start VR WebXR session.",h)}):$i.webVRAvailable?$i.getWebVRDisplay().then(function(h){displays.length>0&&(($i.webVRDisplay=displays[0]).isPresenting||(a.xr.enabled=!0,a.xr.setDevice($i.webVRDisplay),$i.webVRDisplay.requestPresent([{source:a.domElement}]),void 0!==r&&r()))}).catch(function(h){console.warn("nunuStudio: Failed to start VR WebVR session.",h)}):console.warn("nunuStudio: VR support is not available.")},$i.exitVR=function(a){$i.webXRAvailable&&null!==$i.webXRSession?(a.xr.enabled=!1,a.xr.setSession(null),$i.webXRSession.end(),$i.webXRSession=null):$i.webVRAvailable&&null!==$i.webVRDisplay&&$i.webVRDisplay.isPresenting&&(a.xr.enabled=!1,a.xr.setDevice(null),$i.webVRDisplay.exitPresent(),$i.webVRDisplay=null)},$i.getWebXRSession=function(){return $i.webXRAvailable?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor"]}):Promise.reject("WebXR support is not available.")},$i.getWebVRDisplay=function(a){return $i.webVRAvailable?navigator.getVRDisplays():Promise.reject("WebVR support is not available.")},void 0!==navigator.xr&&void 0!==navigator.xr.isSessionSupported?navigator.xr.isSessionSupported("immersive-vr").then(function(a){$i.webXRAvailable=a}):void 0!==navigator.getVRDisplays&&navigator.getVRDisplays().then(function(a){$i.webVRAvailable=a.length>0}),Ro.OPAQUE="opaque",Ro.ADDITIVE="additive",Ro.ALPHA_BLEND="alpha-blend",Ro.webXRAvailable=!1,Ro.webXRSession=null,Ro.arAvailable=function(){return Ro.webXRAvailable},Ro.enterAR=function(a,r){Ro.webXRAvailable?Ro.getWebXRSession().then(function(h){a.xr.enabled=!0,a.xr.setReferenceSpaceType("local"),a.xr.setSession(h),console.log("nunuStudio: New AR WebXR session created",h),Ro.webXRSession=h,void 0!==r&&r()}).catch(function(h){console.warn("nunuStudio: Failed to start AR WebXR session.",h)}):console.warn("nunuStudio: AR support is not available.")},Ro.exitAR=function(a){Ro.webXRAvailable&&null!==Ro.webXRSession&&(a.xr.enabled=!1,a.xr.setSession(null),Ro.webXRSession.end(),Ro.webXRSession=null)},Ro.getWebXRSession=function(){return Ro.webXRAvailable?navigator.xr.requestSession("immersive-ar",{}):Promise.reject("WebXR support is not available.")},void 0!==navigator.xr&&void 0!==navigator.xr.isSessionSupported&&navigator.xr.isSessionSupported("immersive-ar").then(function(a){Ro.webXRAvailable=a}),ii.XR_NONE=0,ii.XR_VR=1,ii.XR_AR=2,(ii.prototype=Object.create(Mo.prototype)).initialize=function(){if(null===this.mouse&&(this.mouse=new Jr,this.mouse.setCanvas(this.canvas),this.mouse.create()),null===this.keyboard&&(this.keyboard=new Wn,this.keyboard.create()),this.manager.create(),null!==this.defaultScene){for(var a=0;a<this.children.length;a++)if(this.children[a].uuid===this.defaultScene){this.setScene(this.children[a]);break}}else this.children.length>0&&this.setScene(this.children[0]);this.lockPointer&&null!==this.mouse&&this.mouse.setLock(!0),this.clock.start()},ii.prototype.setMouseKeyboard=function(a,r){this.mouse!==a&&(null!==this.mouse&&this.mouse.dispose(),this.mouse=a),this.keyboard!==r&&(null!==this.keyboard&&this.keyboard.dispose(),this.keyboard=r)},ii.prototype.setRenderer=function(a,r){this.renderer=a,this.renderer.autoClear=!1,this.canvas=a.domElement,this.division=this.canvas.parentElement,r&&this.updateRenderer()},ii.prototype.update=function(){var a=this.clock.getDelta();this.mouse.update(),this.keyboard.update(),this.scene.update(a)},ii.prototype.render=function(a){this.scene.render(a)},ii.prototype.resize=function(a,r){null!==this.defaultCamera&&this.defaultCamera.resize(a,r),this.scene.resize(a,r)},ii.prototype.updateRenderer=function(){null!==this.renderer&&this.rendererConfig.apply(this.renderer)},ii.prototype.arAvailable=function(){return this.ar&&Ro.arAvailable()},ii.prototype.enterAR=function(){if(this.arAvailable()&&!this.xrEnabled){var a=this;Ro.enterAR(this.renderer,function(){a.xrMode=ii.XR_AR,a.xrEnabled=!0})}},ii.prototype.exitAR=function(){this.xrEnabled&&(Ro.exitAR(this.renderer),this.xrMode=ii.XR_NONE,this.xrEnabled=!1)},ii.prototype.vrAvailable=function(){return this.vr&&$i.vrAvailable()},ii.prototype.enterVR=function(){if(this.vrAvailable()&&!this.xrEnabled){var a=this;$i.enterVR(this.renderer,function(){a.xrMode=ii.XR_VR,a.xrEnabled=!0})}},ii.prototype.exitVR=function(){this.vr&&($i.exitVR(this.renderer),this.xrMode=ii.XR_NONE,this.xrEnabled=!1)},ii.prototype.setScene=function(a){"string"==typeof a&&(a=this.getObjectByName(a)),null!==this.scene&&this.scene.dispose(),this.scene=a,null!==this.scene?(null===this.scene.defaultCamera&&(this.scene.defaultCamera=this.defaultCamera),this.scene.initialize(),null!==this.canvas&&this.scene.resize(this.canvas.width,this.canvas.height)):console.warn("nunuStudio: Program setScene scene is null.")},ii.prototype.remove=function(a){if(a instanceof l.Scene){var r=this.children.indexOf(a);r>-1&&(this.children.splice(r,1),a.parent=null),a===this.scene&&(this.scene.dispose(),this.scene=null),0===this.children.length&&(this.scene=null)}else console.warn("nunuStudio: Trying to remove Object3D from program, only Scene objects allowed.")},ii.prototype.add=function(a){a instanceof l.Scene?(a.parent=this,this.children.push(a)):console.warn("nunuStudio: Trying to add Object3D to program, only Scene objects allowed.")},ii.prototype.clone=function(){return(new Zi).parse(this.toJSON())},ii.prototype.setInitialScene=function(a){this.defaultScene=a.uuid},ii.prototype.dispose=function(){null!==this.mouse&&(this.lockPointer&&this.mouse.setLock(!1),this.mouse.dispose()),null!==this.keyboard&&this.keyboard.dispose(),this.manager.destroy(),null!==this.scene?this.scene.dispose():console.warn("nunuStudio: Program dispose() scene is null.",this),Mo.prototype.dispose.call(this),l.Object3D.prototype.dispose.call(this)},ii.prototype.receiveDataApp=function(a){var r=!1;this.traverse(function(h){h instanceof En&&(h.appData(a),r=!0)}),r||console.warn("nunuStudio: No script with onAppData found",a)},ii.prototype.sendDataApp=function(a){null!==this.app?void 0!==this.app.onDataReceived?this.app.onDataReceived(a):console.warn("nunuStudio: Send app data communication",a):console.warn("nunuStudio: Data sent to app",a)},ii.prototype.toJSON=function(a,r){var h=this,d=l.Object3D.prototype.toJSON.call(this,a,function(y){if(!1!==r)for(var b=0;b<B.libraries.length;b++){var N=h[B.libraries[b]];for(var k in N){var T=N[k];void 0===y[B.libraries[b]][T.uuid]&&(y[B.libraries[b]][T.uuid]=T.toJSON(y))}}});return null!==this.defaultScene&&(d.object.defaultScene=this.defaultScene),d.object.author=this.author,d.object.description=this.description,d.object.version=this.version,d.object.lockPointer=this.lockPointer,d.object.handlePixelRatio=this.handlePixelRatio,d.object.ar=this.ar,d.object.vr=this.vr,d.object.vrScale=this.vrScale,d.object.rendererConfig=this.rendererConfig.toJSON(),d},(Po.prototype=Object.create(l.Scene.prototype)).initialize=function(){this.program=this.parent,this.canvas=this.parent.canvas,l.Object3D.prototype.initialize.call(this);for(var a=0;a<this.children.length;a++)this.children[a].traverse(function(r){r.initialize()})},Po.prototype.update=function(a){this.mouse.set(this.program.mouse.position.x/this.canvas.width*2-1,-2*this.program.mouse.position.y/this.canvas.height+1),this.cameras.length>0?this.raycaster.setFromCamera(this.mouse,this.cameras[0]):null!==this.defaultCamera&&this.raycaster.setFromCamera(this.mouse,this.defaultCamera),this.usePhysics&&this.world.step(a<.05?a:.05);for(var r=0;r<this.children.length;r++)this.children[r].traverse(function(h){h.update(a)})},Po.prototype.resize=function(a,r){null!==this.defaultCamera&&this.defaultCamera.resize(a,r);for(var h=0;h<this.cameras.length;h++)this.cameras[h].resize(a,r);for(h=0;h<this.children.length;h++)this.children[h].traverse(function(d){d.resize(a,r)})},Po.prototype.dispose=function(){for(var a=0;a<this.children.length;a++)this.children[a].traverse(function(r){r.dispose()})},Po.prototype.render=function(a){if(a.setClearColor(this.background,this.alpha),this.cameras.length>0)if(this.program.xrEnabled){if(this.program.xrMode===ii.XR_VR)for(var r=0;r<this.cameras.length;r++)this.cameras[r].render(a,this);else if(this.program.xrMode===ii.XR_AR)for(a.setClearColor(null),r=0;r<this.cameras.length;r++)a.render(this,this.cameras[r])}else{for(a.setScissorTest(!0),r=0;r<this.cameras.length;r++)this.cameras[r].setupRenderer(a),this.cameras[r].render(a,this);a.setScissorTest(!1)}else null!==this.defaultCamera&&(this.program.xrMode===ii.XR_AR?(a.setClearColor(null),a.render(this,this.defaultCamera)):this.defaultCamera.render(a,this))},Po.prototype.getCamera=function(a,r){if(void 0===r&&(r=this),a===r.uuid)return r;for(var h=r.children,d=0;d<h.length;d++){var y=this.getCamera(a,h[d]);if(null!==y)return y}return null},Po.prototype.addCamera=function(a){-1===this.cameras.indexOf(a)&&(this.cameras.push(a),this.updateCameraOrder())},Po.prototype.updateCameraOrder=function(){this.cameras.sort(function(a,r){return a.order>r.order})},Po.prototype.removeCamera=function(a){var r=this.cameras.indexOf(a);r>-1&&this.cameras.splice(r,1)},Po.prototype.isCameraActive=function(a){return this.cameras.indexOf(a)>-1},Po.prototype.setFogMode=function(a){var r=null!==this.fog?this.fog.color.getHex():"#FFFFFF";a===l.Fog.LINEAR?this.fog=new l.Fog(r,5,20):a===l.Fog.EXPONENTIAL?this.fog=new l.FogExp2(r,.01):a===l.Fog.NONE&&(this.fog=null)},Po.prototype.toJSON=function(a){if(!this.parent||"Program"!==this.parent.type)return console.warn("nunuStudio: Scene is not on top level serializing as Group."),this.type="Group",l.Object3D.prototype.toJSON.call(this,a);var r=this,h=l.Object3D.prototype.toJSON.call(this,a,function(T,H){r.background instanceof l.Color?H.background=r.background.toJSON(T):r.background instanceof l.Texture&&(H.background=r.background.toJSON(T).uuid),r.environment instanceof l.Texture&&(H.environment=r.environment.toJSON(T).uuid)});if(null!==this.defaultCamera){var d=new l.Vector3,y=new l.Quaternion,b=new l.Vector3;this.defaultCamera.matrixWorld.decompose(d,y,b);var N=this.defaultCamera.toJSON(a);N.object.position=d.toArray(),N.object.quaternion=y.toArray(),N.object.scale=b.toArray(),h.object.defaultCamera=N}null!==this.fog&&(h.object.fog=this.fog.toJSON()),h.object.usePhysics=this.usePhysics,h.object.cameras=[];for(var k=0;k<this.cameras.length;k++)h.object.cameras.push(this.cameras[k].uuid);return h.object.world={},h.object.world.gravity=this.world.gravity,h.object.world.quatNormalizeSkip=this.world.quatNormalizeSkip,h.object.world.quatNormalizeFast=this.world.quatNormalizeFast,h.object.world.solver={},h.object.world.solver.tolerance=this.world.solver.tolerance,h.object.world.solver.iterations=this.world.solver.iterations,h},(iu.prototype=Object.create(l.AnimationMixer.prototype)).createActions=function(a){for(var r=0;r<a.length;r++){var h=this.clipAction(a[r]);h.setLoop(a[r].loop),h.weight=a[r].weight,h.timeScale=a[r].timeScale,h.enabled=a[r].enabled,h.play()}return this._actions},iu.prototype.setTime=function(a){this.time=a;for(var r=0;r<this._actions.length;r++)this._actions[r].time=a;this.update(0,!0)},iu.prototype.play=function(){this.playing=!0},iu.prototype.stop=function(){this.setTime(0),this.playing=!1},iu.prototype.pause=function(){this.playing=!1},iu.prototype.dispose=function(){this.stopAllAction(),this.uncacheRoot(this._root)},iu.prototype.update=function(a,r){if(this.playing||r){this.time+=a;for(var h=Math.sign(a),d=0;d<this._actions.length;d++)this._actions[d]._update(this.time,a,h,this._accuIndex);for(d=0;d<this._bindings.length;d++)this._bindings[d].apply(this._accuIndex)}return this};var Ya=__webpack_require__(412);Ya.Object3D.prototype.folded=!1,Ya.Object3D.prototype.locked=!1,Ya.Object3D.prototype.contains=function(a){for(var r=0;r<this.children.length;r++)if(this.children[r].uuid===a.uuid||this.children[r].contains(a))return!0;return!1},Ya.Object3D.prototype.playAnimation=function(){void 0!==this.mixer&&this.mixer.play()},Ya.Object3D.prototype.stopAnimation=function(){void 0!==this.mixer&&this.mixer.stop()},Ya.Object3D.prototype.initialize=function(){void 0!==this.animations&&(this.mixer=new iu(this),this.mixer.createActions(this.animations),this.mixer.play())},Ya.Object3D.prototype.update=function(a){void 0!==this.mixer&&this.mixer.update(a)},Ya.Object3D.prototype.resize=function(a,r){},Ya.Object3D.prototype.dispose=function(){void 0!==this.mixer&&this.mixer.dispose()},Ya.Object3D.prototype.addAbove=function(a,r){if(a===this)return console.error("Object3D.add: object can't be added as a child of itself.",a),this;if(a&&a.isTHREE.Object3D){null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"});var h=this.children.indexOf(r);this.children.splice(h,0,a)}else console.error("Object3D.add: object not an instance of THREE.Object3D.",a);return this},Ya.Object3D.prototype.addBellow=function(a,r){if(a===this)return console.error("Object3D.add: object can't be added as a child of itself.",a),this;if(a&&a.isTHREE.Object3D){null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"});var h=this.children.indexOf(r)+1;this.children.splice(h,0,a)}else console.error("Object3D.add: object not an instance of THREE.Object3D.",a);return this},Ya.Object3D.prototype.getScene=function(){for(var a=this;null!==a.parent;)if((a=a.parent)instanceof Po)return a;return null},Ya.Object3D.prototype.removeAll=function(){for(;this.children.length>0;)this.remove(this.children[0])},Ya.Object3D.prototype.isEmpty=function(){return 0===this.children.length},Ya.Object3D.prototype.destroy=function(){for(;this.children.length>0;)this.children[0].destroy();null!==this.parent&&(this.dispose&&this.dispose(),this.parent.remove(this),this.parent=null)},Ya.Object3D.prototype.toJSON=function(a,r,h){var d=void 0===a,y={};d&&(a=new B,y.metadata={version:VERSION,type:"Object3D"});var b={};if(b.uuid=this.uuid,b.type=this.type,b.name=this.name,b.folded=this.folded,b.locked=this.locked,b.castShadow=this.castShadow,b.receiveShadow=this.receiveShadow,b.visible=this.visible,b.matrixAutoUpdate=this.matrixAutoUpdate,b.frustumCulled=this.frustumCulled,b.renderOrder=this.renderOrder,b.position=this.position.toArray(),b.quaternion=this.quaternion.toArray(),b.scale=this.scale.toArray(),b.layers=this.layers.mask,b.userData=this.userData,void 0!==this.geometry){b.geometry=ae(a.geometries,this.geometry);var N=this.geometry.parameters;if(void 0!==N&&void 0!==N.shapes){var k=N.shapes;if(Array.isArray(k))for(var T=0,H=k.length;T<H;T++)ae(a.shapes,k[T]);else ae(a.shapes,k)}}if(void 0!==this.material)if(this.material instanceof l.Material)b.material=ae(a.materials,this.material);else if(this.material instanceof Array){var le=[];for(T=0;T<this.material.length;T++)le.push(ae(a.materials,this.material[T]));b.material=le}if(void 0!==this.animations&&this.animations.length>0)for(b.animations=[],T=0;T<this.animations.length;T++)b.animations.push(l.AnimationClip.toJSON(this.animations[T]));if(y.object=b,void 0!==r&&r(a,b,y),!1!==h&&this.children.length>0)for(b.children=[],T=0;T<this.children.length;T++)this.children[T].locked||b.children.push(this.children[T].toJSON(a).object);return d&&(y.geometries=ge(a.geometries),y.materials=ge(a.materials),y.textures=ge(a.textures),y.images=ge(a.images),y.videos=ge(a.videos),y.audio=ge(a.audio),y.fonts=ge(a.fonts),y.skeletons=ge(a.skeletons),y.resources=ge(a.resources),y.shapes=ge(a.shapes)),y;function ae(we,Se){return void 0===we[Se.uuid]&&(we[Se.uuid]=Se.toJSON(a)),Se.uuid}function ge(we){var Se=[];for(var $e in we){var Re=we[$e];delete Re.metadata,Se.push(Re)}return Se}},__webpack_require__(870);var rd=__webpack_require__(412),kp={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},oh=function(a){if(void 0!==a.array){var r=new kp[a.type](a.array),h=new(a.isInstancedBufferAttribute?l.InstancedBufferAttribute:l.BufferAttribute)(r,a.itemSize,a.normalized);return void 0!==a.name&&(h.name=a.name),h}if("BufferAttribute"===a.type)r=new kp[a.typedArray.type](a.typedArray.array),h=new l.BufferAttribute(r,a.itemSize,a.normalized);else if("InstancedBufferAttribute"===a.type)r=new kp[a.typedArray.type](a.typedArray.array),h=new l.InstancedBufferAttribute(r,a.itemSize,a.normalized,a.meshPerAttribute);else if("InterleavedBufferAttribute"===a.type){r=new kp[a.data.typedArray.type](a.data.typedArray.array);var d=new l.InterleavedBuffer(r,a.data.stride);d.setUsage(a.data.usage),d.count=a.data.count,h=new l.InterleavedBufferAttribute(d,a.itemSize,a.offset,a.normalized)}return void 0!==a.name&&(h.name=a.name),h};rd.BufferGeometryLoader.prototype.parse=function(a){var r=a.isInstancedBufferGeometry?new l.InstancedBufferGeometry:new l.BufferGeometry,h=a.data.index;if(void 0!==h){var d=new kp[h.type](h.array);r.setIndex(new l.BufferAttribute(d,1))}var y=a.data.attributes;for(var b in y)r.setAttribute(b,oh(y[b]));var N=a.data.morphAttributes;if(N)for(var b in N){for(var k=N[b],T=[],H=0,Y=k.length;H<Y;H++)T.push(oh(k[H]));r.morphAttributes[b]=T}a.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);var le=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==le){H=0;for(var ae=le.length;H!==ae;++H){var ge=le[H];r.addGroup(ge.start,ge.count,ge.materialIndex)}}var we=a.data.boundingSphere;if(void 0!==we){var Se=new l.Vector3;void 0!==we.center&&Se.fromArray(we.center),r.boundingSphere=new l.Sphere(Se,we.radius)}return a.name&&(r.name=a.name),a.userData&&(r.userData=a.userData),r};var Fp=__webpack_require__(412);Fp.Material.prototype.dispose=function(){function a(r){r?.dispose()}this.dispatchEvent({type:"dispose"}),a(this.map),a(this.bumpMap),a(this.normalMap),a(this.displacementMap),a(this.specularMap),a(this.emissiveMap),a(this.alphaMap),a(this.roughnessMap),a(this.metalnessMap),a(this.envMap)},Fp.Material.prototype.toJSON=function(a){void 0===a&&(a={textures:{},images:{},videos:{}});var r={};function h(N){var k=[];for(var T in N){var H=N[T];delete H.metadata,k.push(H)}return k}if(r.uuid=this.uuid,r.type=this.type,r.name=this.name,r.toneMapped=this.toneMapped,r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),void 0!==this.transmission&&(r.transmission=this.transmission),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(a).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(a).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(a).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(a).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(a).uuid),this.aoMapIntensity&&(r.aoMapIntensity=this.aoMapIntensity),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(a).uuid,r.reflectivity=this.reflectivity,this.combine&&(r.combine=this.combine),this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),this.refractionRatio&&(r.refractionRatio=this.refractionRatio)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),void 0!==this.rotation&&(r.rotation=this.rotation),void 0!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),this.blending!==l.NormalBlending&&(r.blending=this.blending),this.side!==l.FrontSide&&(r.side=this.side),this.vertexColors!==l.NoColors&&(r.vertexColors=this.vertexColors),r.flatShading=this.flatShading,this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),r.skinning=this.skinning,r.morphTargets=this.morphTargets,void 0!==this.morphNormals&&(r.morphNormals=this.morphNormals),void 0===a){var d=h(a.textures),y=h(a.images),b=h(a.videos);d.length>0&&(r.textures=d),y.length>0&&(r.images=y),b.length>0&&(r.videos=b)}return r},__webpack_require__(412).Points.prototype.raycast=function(a,r){null===this.geometry.boundingBox&&this.geometry.computeBoundingBox();var h=new l.Box3;h.copy(this.geometry.boundingBox),h.applyMatrix4(this.matrixWorld),null!==a.ray.intersectBox(h,new l.Vector3)&&r.push({object:this})};var sh,ou,ma,od,sd=__webpack_require__(412);function vo(){}function Cr(){}function Xr(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[];for(var a=navigator.getGamepads(),r=0;r<a.length;r++)if(null!==a[r]){this.setGamepad(a[r]);break}null===this.gamepad&&console.warn("nunuStudio: No gamepad found")}function Ru(){this.alpha=0,this.beta=0,this.gamma=0,this.orientation=0,this.events=new pn;var a=this;this.events.add(window,"orientationchange",function(r){a.orientation=l.Math.degToRad(window.orientation)}),this.events.add(window,"deviceorientation",function(r){a.alpha=l.Math.degToRad(r.alpha),a.beta=l.Math.degToRad(r.beta),a.gamma=l.Math.degToRad(r.gamma)}),this.events.create()}function Ks(a){this.size=new l.Vector2(2,2),this.halfSize=new l.Vector2(1,1),this.matrix=new l.Matrix4,this.cache={camera:{fov:0,style:""},objects:new WeakMap},this.domElement=void 0!==a?a:document.createElement("div"),this.domElement.style.overflow="hidden",this.domElement.style.pointerEvents="none",this.cameraElement=document.createElement("div"),this.cameraElement.style.WebkitTransformStyle="preserve-3d",this.cameraElement.style.transformStyle="preserve-3d",this.domElement.appendChild(this.cameraElement)}function oc(a){hl.call(this,a)}function np(a){kl.call(this),this.format="url",this.encoding=Bn.getFileExtension(a),this.data=a}function Ah(a,r,h){this.bufferGeometry=!1,this.direction=new l.Vector3(0,1,0),this.angle=void 0!==a?a:Math.PI,this.start=void 0!==r?r:0,this.end=void 0!==h?h:1}function Nc(){this.events=[]}function Xn(a,r){this.x=a||0,this.y=r||0}function Hi(a){void 0!==a?this.m=a:this.identity()}function $h(){}function Nn(){this.uuid=$h.generate(),this.children=[],this.parent=null,this.level=0,this.position=new Xn(0,0),this.origin=new Xn(0,0),this.scale=new Xn(1,1),this.rotation=0,this.visible=!0,this.layer=0,this.matrix=new Hi,this.globalMatrix=new Hi,this.inverseGlobalMatrix=new Hi,this.masks=[],this.matrixAutoUpdate=!0,this.matrixNeedsUpdate=!0,this.draggable=!1,this.pointerEvents=!0,this.ignoreViewport=!1,this.saveContextState=!0,this.restoreContextState=!0,this.pointerInside=!1,this.beingDragged=!1,this.serializable=!0}function Ho(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function Bi(a,r){this._keys=new Array(5),this._position=new Xn(0,0),this._positionUpdated=!1,this._delta=new Xn(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=new Array(5),this.keys=new Array(5),this.position=new Xn(0,0),this.delta=new Xn(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.domElement=void 0!==a?a:window,this.canvas=null,void 0!==r&&this.setCanvas(r),this.events=new Nc;for(var h=0;h<5;h++)this._doubleClicked[h]=!1,this.doubleClicked[h]=!1,this._keys[h]=new Ho,this.keys[h]=new Ho;var d=this;if(void 0!==window.onmousewheel?this.events.add(this.domElement,"mousewheel",function(b){d._wheel=b.deltaY,d._wheelUpdated=!0}):void 0!==window.addEventListener?this.events.add(this.domElement,"DOMMouseScroll",function(b){d._wheel=30*b.detail,d._wheelUpdated=!0}):this.events.add(this.domElement,"wheel",function(b){d._wheel=b.deltaY,d._wheelUpdated=!0}),void 0!==window.ontouchstart||navigator.msMaxTouchPoints>0){var y=new Xn(0,0);this.events.add(this.domElement,"touchstart",function(b){var N=b.touches[0];d.updatePosition(N.clientX,N.clientY,0,0),d.updateKey(Bi.LEFT,Ho.DOWN),y.set(N.clientX,N.clientY)}),this.events.add(this.domElement,"touchend",function(b){d.updateKey(Bi.LEFT,Ho.UP)}),this.events.add(this.domElement,"touchcancel",function(b){d.updateKey(Bi.LEFT,Ho.UP)}),this.events.add(document.body,"touchmove",function(b){var N=b.touches[0];d.updatePosition(N.clientX,N.clientY,N.clientX-y.x,N.clientY-y.y),y.set(N.clientX,N.clientY)})}this.events.add(this.domElement,"mousemove",function(b){d.updatePosition(b.clientX,b.clientY,b.movementX,b.movementY)}),this.events.add(this.domElement,"mousedown",function(b){d.updateKey(b.which-1,Ho.DOWN)}),this.events.add(this.domElement,"mouseup",function(b){d.updateKey(b.which-1,Ho.UP)}),this.events.add(this.domElement,"dragstart",function(b){d.updateKey(b.which-1,Ho.UP)}),this.events.add(this.domElement,"dblclick",function(b){d._doubleClicked[b.which-1]=!0}),this.create()}function Ch(a){this.uuid=$h.generate(),this.canvas=a,this.position=new Xn(0,0),this.scale=1,this.rotation=0,this.matrix=new Hi,this.inverseMatrix=new Hi,this.matrixNeedsUpdate=!0,this.moveOnScale=!1,this.rotationPoint=null}function rp(a){this.viewport=a,this.dragButton=Bi.RIGHT,this.allowScale=!0,this.moveOnScale=!1,this.allowRotation=!0,this.rotationPoint=null,this.rotationInitial=0}function Lh(a){this.callback=a,this.running=!1,this.id=-1}function Us(a,r){void 0===r&&(r={alpha:!0,imageSmoothingEnabled:!0,imageSmoothingQuality:"low",globalCompositeOperation:"source-over"}),this.canvas=a,this.container=null,this.context=this.canvas.getContext("2d",{alpha:r.alpha}),this.context.imageSmoothingEnabled=r.imageSmoothingEnabled,this.context.imageSmoothingQuality=r.imageSmoothingQuality,this.context.globalCompositeOperation=r.globalCompositeOperation,this.pointer=new Bi(window,this.canvas),this.autoClear=!0}function oo(a,r){this.min=void 0!==a?a:new Xn,this.max=void 0!==r?r:new Xn}function _a(){Nn.call(this)}function Ja(){_a.call(this),this.box=new oo(new Xn(-50,-35),new Xn(50,35)),this.invert=!1}function uo(){this.cache=null,this.needsUpdate=!0}function Jo(a){uo.call(this),this.color=a||"#000000"}function zs(){Nn.call(this),this.box=new oo(new Xn(-50,-50),new Xn(50,50)),this.strokeStyle=new Jo("#000000"),this.lineWidth=1,this.fillStyle=new Jo("#FFFFFF")}function qi(){Nn.call(this),this.radius=10,this.strokeStyle=new Jo("#000000"),this.lineWidth=1,this.fillStyle=new Jo("#FFFFFF")}function Ao(){Nn.call(this),this.from=new Xn,this.to=new Xn,this.dashPattern=[5,5],this.strokeStyle=new Jo("#000000"),this.lineWidth=1}function Ba(){Nn.call(this),this.text="",this.font="16px Arial",this.strokeStyle=null,this.lineWidth=1,this.fillStyle=new Jo("#000000"),this.textAlign="center",this.textBaseline="middle"}function Fl(a){Nn.call(this),this.box=new oo,this.image=document.createElement("img"),void 0!==a&&this.setImage(a)}function Bh(a){Nn.call(this),this.parentElement=null,this.element=document.createElement(a||"div"),this.element.style.transformStyle="preserve-3d",this.element.style.position="absolute",this.element.style.top="0px",this.element.style.bottom="0px",this.element.style.transformOrigin="0px 0px",this.element.style.overflow="auto",this.element.style.pointerEvents="none",this.size=new Xn(100,100)}function ho(a){Nn.call(this),this.box=new oo,this.image=document.createElement("img"),this.repetition="repeat",void 0!==a&&this.setImage(a)}function ga(){Ba.call(this),this.maxWidth=null,this.lineHeight=null}function fl(){Ao.call(this),this.fromCp=new Xn,this.toCp=new Xn}function su(){Ao.call(this),this.controlPoint=new Xn}function ea(){zs.call(this),this.radius=5}function us(){Nn.call(this),this.box=new oo(new Xn(-50,-35),new Xn(50,35)),this.strokeStyle=new Jo("rgb(0, 153, 255)"),this.lineWidth=1,this.fillStyle=new Jo("rgba(0, 153, 255, 0.3)"),this.min=0,this.max=10,this.data=[]}function Nh(a,r){this.offset=a,this.color=r}function ml(){uo.call(this),this.colors=[]}function po(){ml.call(this),this.start=new Xn(-100,0),this.end=new Xn(100,0)}function sc(){Nn.call(this),this.value=50,this.min=0,this.max=100,this.radius=80,this.lineWidth=10,this.startAngle=Math.PI,this.endAngle=2*Math.PI,this.dial=!1,this.baseStyle=new Jo("#e9ecf1"),this.barStyle=new po,this.barStyle.start.set(-100,0),this.barStyle.end.set(100,0),this.barStyle.addColorStop(0,"#e5ff50"),this.barStyle.addColorStop(.5,"#50ff67"),this.barStyle.addColorStop(1,"#32adff")}function ah(a){uo.call(this),this.source=a||document.createElement("img"),this.repetition="repeat",this.matrix=new Hi}function lh(){ml.call(this),this.start=new Xn(0,0),this.startRadius=10,this.end=new Xn(0,0),this.endRadius=50}function ac(){Nn.call(this)}function rs(){fl.call(this),this.lineWidth=2,this.outputSocket=null,this.inputSocket=null}function Qi(a,r,h,d){qi.call(this),this.draggable=!0,this.radius=6,this.layer=1,this.name=void 0!==d?d:"",this.category=void 0!==h?h:"",this.multiple=!0,this.direction=r,this.node=a,this.connectors=[],this.creatingConnection=!1,this.text=new Ba,this.text.text=this.name,this.direction===Qi.INPUT?(this.text.position.x-=10,this.text.textAlign="right"):this.direction===Qi.OUTPUT&&(this.text.position.x+=10,this.text.textAlign="left"),this.add(this.text)}function ta(){ea.call(this),this.draggable=!0,this.inputs=[],this.outputs=[]}function Dp(){}function Td(){}function hi(){l.Group.call(this),this.type="NodeScript",this.name="script",this.graph=new ac}function Rc(a,r){this.uuid=l.Math.generateUUID(),this.data=a,this.callback=r}function Dl(a,r){this.size=r,this.file=a,this.workers=[],this.next=0,this.createWorkers(),this.tasks={}}function Ul(a,r){this.callback=a,this.time=r,this.running=!1,this.id=-1}function Md(a){this.callback=a,this.running=!1,this.id=-1}function Pc(){}function Za(){}sd.Skeleton.prototype.toJSON=function(){var a={};void 0===this.uuid&&(this.uuid=l.Math.generateUUID()),a.uuid=this.uuid,a.bones=[];for(var r=0;r<this.bones.length;r++)a.bones.push(this.bones[r].uuid);for(a.boneInverses=[],r=0;r<this.boneInverses.length;r++)a.boneInverses.push(this.boneInverses[r].toArray());return a},sd.Skeleton.fromJSON=function(a,r){for(var h=[],d=[],y=0;y<a.bones.length;y++){var b=r.getObjectByProperty("uuid",a.bones[y]);void 0===b&&(console.warn("Skeleton.fromJSON: Not found Bone with uuid "+a.bones[y]),b=new l.Bone),h.push(b),d.push((new l.Matrix4).fromArray(a.boneInverses[y]))}var N=new sd.Skeleton(h,d);return N.uuid=a.uuid,N},__webpack_require__(819),__webpack_require__(412).Texture.prototype.toJSON=function(a){if(void 0!==a.textures[this.uuid])return a.textures[this.uuid];var r={metadata:{version:VERSION,type:"Texture"},uuid:this.uuid,name:this.name,category:this.category,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return a.textures[this.uuid]=r,r},vo.NAME="nunuStudio",vo.NWJS=200,vo.BROWSER=201,vo.CORDOVA=202,vo.copyNamespace=function(a,r){for(var h in void 0===r&&(r=window),a)h in r||(r[h]=a[h])},vo.getQueryParameters=function(){for(var a=location.search.substring(1).split("&"),r={},h=0;h<a.length;h++){var d=a[h].split("=");if(d.length>1){var y=unescape(d[0]).replace(new RegExp('"',"g"),""),b=unescape(d[1]).replace(new RegExp('"',"g"),"");r[y]=b}}return r},vo.createWorker=function(a,r){var h=new Blob([a],{type:"application/javascript"}),d=new Worker(URL.createObjectURL(h));return void 0!==r&&(d.onmessage=r),d},vo.webAudioAvailable=function(){return void 0!==window.AudioContext||void 0!==window.webkitAudioContext},vo.webGLAvailable=function(){try{var a=document.createElement("canvas");return(a.getContext("webgl")||a.getContext("experimental-webgl")).getSupportedExtensions(),!0}catch{}return!1},vo.getPlatform=function(){return void 0!==window.nw?vo.NWJS:void 0!==window.cordova?vo.CORDOVA:vo.BROWSER},vo.runningOnDesktop=function(){return void 0!==window.nw},vo.openWebpage=function(a){vo.runningOnDesktop()?window.require("nw.gui").Shell.openExternal(a):window.open(a)},vo.isFullscreen=function(){return!0===document.webkitIsFullScreen||!0===document.mozFullScreen||!0===document.webkitIsFullScreen||!0===document.webkitIsFullScreen||!0===document.fullscreen||!1},vo.setFullscreen=function(a,r){var h=vo.isFullscreen();void 0===a&&(a=!h),!0===a?(void 0===r&&(r=document.body),!1===h&&(r.requestFullscreen=r.requestFullscreen||r.mozRequestFullScreen||r.webkitRequestFullscreen||r.msRequestFullscreen,void 0!==r.requestFullscreen&&r.requestFullscreen())):!0===h&&(document.exitFullscreen=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen,void 0!==document.exitFullscreen&&document.exitFullscreen())},Cr.ARROW_LEFT=37,Cr.ARROW_UP=38,Cr.ARROW_RIGHT=39,Cr.ARROW_DOWN=40,Cr.ENTER=13,Cr.BACK=10009,Cr.VOLUME_UP=447,Cr.VOLUME_DOWN=448,Cr.VOLUME_MUTE=449,Cr.CHANNEL_UP=427,Cr.CHANNEL_DOWN=428,Cr.F0_RED=403,Cr.F1_GREEN=404,Cr.F2_YELLOW=405,Cr.F3_BLUE=406,Cr.NUM_0=48,Cr.NUM_1=49,Cr.NUM_2=50,Cr.NUM_3=51,Cr.NUM_4=52,Cr.NUM_5=53,Cr.NUM_6=54,Cr.NUM_7=55,Cr.NUM_8=56,Cr.NUM_9=57,Cr.MINUS=189,Cr.E_MANUAL=10146,Cr.PREVIOUS_CHANNEL=10190,Cr.PICTURE_SIZE=10140,Cr.SOCCER=10228,Cr.TELETEXT=10200,Cr.SEARCH=10225,Cr.GUIDE=458,Cr.SOURCE=10072,Cr.EXTRA=10253,Cr.MTS=10195,Cr.MEDIA_PLAY_PAUSE=10252,Cr.MENU=18,Cr.MEDIA_REWIND=412,Cr.TOOLS=10135,Cr.MEDIA_FAST_FORWARD=417,Cr.INFO=457,Cr.MEDIA_PLAY=415,Cr.EXIT=10182,Cr.MEDIA_PAUSE=19,Cr.MEDIA_STOP=413,Cr.CAPTION=10221,Cr.MEDIA_RECORD=416,Cr.CHANNEL_LIST=10073,Cr.MEDIA_TRACK_PREVIOUS=10232,Cr.MEDIA_TRACK_NEXT=10233,Cr.MEDIA_3D=10199,(Xr.prototype=Xr).constructor=Xr,Xr.prototype.setGamepad=function(a){if(null!=a){this.index=a.index,this.gamepad=a,this.buttons=[];for(var r=0;r<a.buttons.length;r++)this.buttons.push(new li);this.setProductVendor(a),this.connected=!0}else console.warn("nunuStudio: No gamepad found"),this.disconnect()},Xr.prototype.disconnect=function(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[]},Xr.prototype.setProductVendor=function(a){try{var r=a.id.split(":");return this.vendor=r[1].split(" ")[1],void(this.product=r[2].replace(" ","").replace(")",""))}catch{}try{return r=a.id.split("-"),this.vendor=r[0],void(this.product=r[1])}catch{}},Xr.prototype.update=function(a){if(this.gamepad=navigator.getGamepads()[this.index],void 0!==this.gamepad)for(var r=0;r<this.buttons.length;r++)this.buttons[r].update(this.gamepad.buttons[r].pressed?li.DOWN:li.UP)},Xr.prototype.getAnalogueButton=function(a){return a>this.buttons.length||a<0?0:this.gamepad.buttons[a].value},Xr.prototype.getAxis=function(a){return a>this.gamepad.axes.length||a<0?0:this.gamepad.axes[a]},Xr.prototype.buttonExists=function(a){return a>=0&&a<this.buttons.length},Xr.prototype.buttonPressed=function(a){return!!this.buttons[a]&&this.buttons[a].pressed},Xr.prototype.buttonJustPressed=function(a){return!!this.buttons[a]&&this.buttons[a].justPressed},Xr.prototype.buttonJustReleased=function(a){return!!this.buttons[a]&&this.buttons[a].justReleased},Xr.LEFT=14,Xr.RIGHT=15,Xr.DOWN=13,Xr.UP=12,Xr.SELECT=8,Xr.START=9,Xr.HOME=16,Xr.LEFT_TRIGGER_A=4,Xr.LEFT_TRIGGER_B=6,Xr.RIGHT_TRIGGER_A=5,Xr.RIGHT_TRIGGER_B=7,Xr.L1=4,Xr.L2=6,Xr.L3=6,Xr.R1=5,Xr.R2=7,Xr.R3=11,Xr.A=0,Xr.B=1,Xr.C=2,Xr.D=3,Xr.X=2,Xr.Y=3,Xr.LEFT_ANALOGUE_BUT=10,Xr.LEFT_ANALOGUE_HOR=0,Xr.LEFT_ANALOGUE_VERT=1,Xr.RIGHT_ANALOGUE_BUT=11,Xr.RIGHT_ANALOGUE_HOR=2,Xr.RIGHT_ANALOGUE_VERT=3,Ru.prototype.setObjectQuaternion=(sh=new l.Euler,ou=new l.Quaternion,ma=new l.Vector3(0,0,1),od=new l.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(a){sh.set(this.beta,this.alpha,-this.gamma,"YXZ"),a.quaternion.setFromEuler(sh),a.quaternion.multiply(od),a.quaternion.multiply(ou.setFromAxisAngle(ma,-this.orientation))}),Ru.prototype.dispose=function(){this.events.destroy()},Ks.prototype.getSize=function(){return{width:this.size.x,height:this.size.y}},Ks.prototype.setSize=function(a,r){this.size.set(a,r),this.halfSize.set(a/2,r/2),this.domElement.style.width=a+"px",this.domElement.style.height=r+"px",this.cameraElement.style.width=a+"px",this.cameraElement.style.height=r+"px"},Ks.prototype.render=function(a,r){function h(T){var H=T.elements;return"matrix3d("+H[0]+","+-H[1]+","+H[2]+","+H[3]+","+H[4]+","+-H[5]+","+H[6]+","+H[7]+","+H[8]+","+-H[9]+","+H[10]+","+H[11]+","+H[12]+","+-H[13]+","+H[14]+","+H[15]+")"}function d(T,H){var Y=T.elements;return"translate(-50%,-50%)matrix3d("+Y[0]+","+Y[1]+","+Y[2]+","+Y[3]+","+-Y[4]+","+-Y[5]+","+-Y[6]+","+-Y[7]+","+Y[8]+","+Y[9]+","+Y[10]+","+Y[11]+","+Y[12]+","+Y[13]+","+Y[14]+","+Y[15]+")"}var y,b=this,N=r.projectionMatrix.elements[5]*this.halfSize.y;this.cache.camera.fov!==N&&(r.isPerspectiveCamera&&(this.domElement.style.WebkitPerspective=N+"px",this.domElement.style.perspective=N+"px"),this.cache.camera.fov=N),a.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld();var k=(y=r.isOrthographicCamera?"scale("+N+")translate("+-(r.right+r.left)/2+"px,"+(r.top+r.bottom)/2+"px)"+h(r.matrixWorldInverse):"translateZ("+N+"px)"+h(r.matrixWorldInverse))+"translate("+this.halfSize.x+"px,"+this.halfSize.y+"px)";this.cache.camera.style!==k&&(this.cameraElement.style.WebkitTransform=k,this.cameraElement.style.transform=k,this.cache.camera.style=k),function T(H,Y,le){if(!0===H.isCSS3DObject){var ae;!0===H.isCSS3DSprite?(matrix.copy(Y.matrixWorldInverse),matrix.transpose(),matrix.copyPosition(H.matrixWorld),matrix.scale(H.scale),matrix.elements[3]=0,matrix.elements[7]=0,matrix.elements[11]=0,matrix.elements[15]=1,ae=d(matrix)):ae=d(H.matrixWorld);var ge=H.element,we=b.cache.objects.get(H);void 0!==we&&we.style===ae||(ge.style.WebkitTransform=ae,ge.style.transform=ae,b.cache.objects.set(H,{style:ae})),ge.parentNode!==b.cameraElement&&b.cameraElement.appendChild(ge)}for(var Se=0,$e=H.children.length;Se<$e;Se++)T(H.children[Se],Y,le)}(a,r,y)},(oc.prototype=Object.create(hl.prototype)).constructor=oc,oc.prototype.isCSS3DSprite=!0,np.prototype=Object.create(kl.prototype),Ah.prototype.modify=function(a){a instanceof l.BufferGeometry?((a=new l.Geometry).fromBufferGeometry(Editor.selection[0].geometry),a.mergeVertices()):a=a.clone();for(var r=new l.Quaternion,h=0;h<a.vertices.length;h++){var d=a.vertices[h].y;d>=this.start&&d<=this.end?(r.setFromAxisAngle(this.direction,this.angle*((d-this.start)/(this.end-this.start))),a.vertices[h].applyQuaternion(r)):d>this.end&&(r.setFromAxisAngle(this.direction,this.angle),a.vertices[h].applyQuaternion(r))}if(a.computeVertexNormals(),a.verticesNeedUpdate=!0,this.bufferGeometry){var b=new l.BufferGeometry;return b.fromGeometry(a),b}return a},Nc.prototype.add=function(a,r,h){this.events.push([a,r,h,!1])},Nc.prototype.clear=function(){this.destroy(),this.events=[]},Nc.prototype.create=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].addEventListener(r[1],r[2]),r[3]=!0}},Nc.prototype.destroy=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].removeEventListener(r[1],r[2]),r[3]=!1}},Xn.prototype.set=function(a,r){this.x=a,this.y=r},Xn.prototype.setScalar=function(a){this.x=a,this.y=a},Xn.prototype.clone=function(){return new Xn(this.x,this.y)},Xn.prototype.copy=function(a){this.x=a.x,this.y=a.y},Xn.prototype.add=function(a){this.x+=a.x,this.y+=a.y},Xn.prototype.addScalar=function(a){this.x+=a,this.y+=a},Xn.prototype.addVectors=function(a,r){this.x=a.x+r.x,this.y=a.y+r.y},Xn.prototype.addScaledVector=function(a,r){this.x+=a.x*r,this.y+=a.y*r},Xn.prototype.sub=function(a){this.x-=a.x,this.y-=a.y},Xn.prototype.subScalar=function(a){this.x-=a,this.y-=a},Xn.prototype.subVectors=function(a,r){this.x=a.x-r.x,this.y=a.y-r.y},Xn.prototype.multiply=function(a){this.x*=a.x,this.y*=a.y},Xn.prototype.multiplyScalar=function(a){this.x*=a,this.y*=a},Xn.prototype.divide=function(a){this.x/=a.x,this.y/=a.y},Xn.prototype.divideScalar=function(a){return this.multiplyScalar(1/a)},Xn.prototype.min=function(a){this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y)},Xn.prototype.max=function(a){this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y)},Xn.prototype.clamp=function(a,r){this.x=Math.max(a.x,Math.min(r.x,this.x)),this.y=Math.max(a.y,Math.min(r.y,this.y))},Xn.prototype.clampScalar=function(a,r){this.x=Math.max(a,Math.min(r,this.x)),this.y=Math.max(a,Math.min(r,this.y))},Xn.prototype.clampLength=function(a,r){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(a,Math.min(r,h)))},Xn.prototype.floor=function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},Xn.prototype.ceil=function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y)},Xn.prototype.round=function(){this.x=Math.round(this.x),this.y=Math.round(this.y)},Xn.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Xn.prototype.dot=function(a){return this.x*a.x+this.y*a.y},Xn.prototype.cross=function(a){return this.x*a.y-this.y*a.x},Xn.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Xn.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Xn.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},Xn.prototype.normalize=function(){return this.divideScalar(this.length()||1)},Xn.prototype.angle=function(){var a=Math.atan2(this.y,this.x);return a<0&&(a+=2*Math.PI),a},Xn.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},Xn.prototype.distanceToSquared=function(a){var r=this.x-a.x,h=this.y-a.y;return r*r+h*h},Xn.prototype.manhattanDistanceTo=function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},Xn.prototype.setLength=function(a){return this.normalize().multiplyScalar(a)},Xn.prototype.lerp=function(a,r){this.x+=(a.x-this.x)*r,this.y+=(a.y-this.y)*r},Xn.prototype.lerpVectors=function(a,r,h){return this.subVectors(r,a).multiplyScalar(h).add(a)},Xn.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},Xn.prototype.fromArray=function(a){this.set(a[0],a[1])},Xn.prototype.toArray=function(){return[this.x,this.y]},Xn.prototype.rotateAround=function(a,r){var h=Math.cos(r),d=Math.sin(r),y=this.x-a.x,b=this.y-a.y;this.x=y*h-b*d+a.x,this.y=y*d+b*h+a.y},Hi.prototype.copy=function(a){this.m=a.m.slice(0)},Hi.prototype.clone=function(){return new Hi(this.m.slice(0))},Hi.prototype.identity=function(){this.m=[1,0,0,1,0,0]},Hi.prototype.multiply=function(a){this.m=[this.m[0]*a.m[0]+this.m[2]*a.m[1],this.m[1]*a.m[0]+this.m[3]*a.m[1],this.m[0]*a.m[2]+this.m[2]*a.m[3],this.m[1]*a.m[2]+this.m[3]*a.m[3],this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5]]},Hi.prototype.premultiply=function(a){this.m=[a.m[0]*this.m[0]+a.m[2]*this.m[1],a.m[1]*this.m[0]+a.m[3]*this.m[1],a.m[0]*this.m[2]+a.m[2]*this.m[3],a.m[1]*this.m[2]+a.m[3]*this.m[3],a.m[0]*this.m[4]+a.m[2]*this.m[5]+a.m[4],a.m[1]*this.m[4]+a.m[3]*this.m[5]+a.m[5]]},Hi.prototype.compose=function(a,r,h,d,y,b,N){if(this.m=[1,0,0,1,a,r],0!==N){var k=Math.cos(N),T=Math.sin(N);this.multiply(new Hi([k,T,-T,k,0,0]))}1===h&&1===d||this.scale(h,d),0===y&&0===b||this.multiply(new Hi([1,0,0,1,-y,-b]))},Hi.prototype.translate=function(a,r){this.m[4]+=this.m[0]*a+this.m[2]*r,this.m[5]+=this.m[1]*a+this.m[3]*r},Hi.prototype.rotate=function(a){var r=Math.cos(a),h=Math.sin(a),y=this.m[1]*r+this.m[3]*h,b=this.m[0]*-h+this.m[2]*r,N=this.m[1]*-h+this.m[3]*r;this.m[0]=this.m[0]*r+this.m[2]*h,this.m[1]=y,this.m[2]=b,this.m[3]=N},Hi.prototype.scale=function(a,r){this.m[0]*=a,this.m[1]*=a,this.m[2]*=r,this.m[3]*=r},Hi.prototype.setPosition=function(a,r){this.m[4]=a,this.m[5]=r},Hi.prototype.getScale=function(){return new Xn(this.m[0],this.m[3])},Hi.prototype.getPosition=function(){return new Xn(this.m[4],this.m[5])},Hi.prototype.skew=function(a,r){this.multiply(new Hi([1,Math.tan(r),Math.tan(a),1,0,0]))},Hi.prototype.determinant=function(){return 1/(this.m[0]*this.m[3]-this.m[1]*this.m[2])},Hi.prototype.getInverse=function(){var a=this.determinant();return new Hi([this.m[3]*a,-this.m[1]*a,-this.m[2]*a,this.m[0]*a,a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a*(this.m[1]*this.m[4]-this.m[0]*this.m[5])])},Hi.prototype.transformPoint=function(a){return new Xn(a.x*this.m[0]+a.y*this.m[2]+this.m[4],a.x*this.m[1]+a.y*this.m[3]+this.m[5])},Hi.prototype.setContextTransform=function(a){a.setTransform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},Hi.prototype.tranformContext=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},Hi.prototype.cssTransform=function(){return"matrix("+this.m[0]+","+this.m[1]+","+this.m[2]+","+this.m[3]+","+this.m[4]+","+this.m[5]+")"},$h.generate=function(){for(var a=[],r=0;r<256;r++)a[r]=(r<16?"0":"")+r.toString(16);return function(){var h=4294967295*Math.random()|0,d=4294967295*Math.random()|0,y=4294967295*Math.random()|0,b=4294967295*Math.random()|0;return(a[255&h]+a[h>>8&255]+a[h>>16&255]+a[h>>24&255]+"-"+a[255&d]+a[d>>8&255]+"-"+a[d>>16&15|64]+a[d>>24&255]+"-"+a[63&y|128]+a[y>>8&255]+"-"+a[y>>16&255]+a[y>>24&255]+a[255&b]+a[b>>8&255]+a[b>>16&255]+a[b>>24&255]).toUpperCase()}}(),Nn.prototype.constructor=Nn,Nn.prototype.type="Object2D",Nn.types=new Map([[Nn.prototype.type,Nn]]),Nn.register=function(a,r){Nn.types.set(r,a)},Nn.prototype.getWorldPointIntersections=function(a,r){void 0===r&&(r=[]);var h=this.inverseGlobalMatrix.transformPoint(a);this.isInside(h)&&r.push(this);for(var d=0;d<this.children.length;d++)this.children[d].getWorldPointIntersections(a,r);return r},Nn.prototype.isWorldPointInside=function(a,r){var h=this.inverseGlobalMatrix.transformPoint(a);if(this.isInside(h))return!0;if(r)for(var d=0;d<this.children.length;d++)if(this.children[d].isWorldPointInside(a,!0))return!0;return!1},Nn.prototype.destroy=function(){null!==this.parent&&this.parent.remove(this)},Nn.prototype.traverse=function(a){a(this);for(var r=0;r<this.children.length;r++)this.children[r].traverse(a)},Nn.prototype.getChildByUUID=function(a){var r=null;return this.traverse(function(h){h.uuid===a&&(r=h)}),r},Nn.prototype.add=function(a){a.parent=this,a.level=this.level+1,a.traverse(function(r){null!==r.onAdd&&r.onAdd(this)}),this.children.push(a)},Nn.prototype.remove=function(a){var r=this.children.indexOf(a);if(-1!==r){var h=this.children[r];h.parent=null,h.level=0,h.traverse(function(d){null!==d.onRemove&&d.onRemove(this)}),this.children.splice(r,1)}},Nn.prototype.isInside=function(a){return!1},Nn.prototype.updateMatrix=function(a){(this.matrixAutoUpdate||this.matrixNeedsUpdate)&&(this.matrix.compose(this.position.x,this.position.y,this.scale.x,this.scale.y,this.origin.x,this.origin.y,this.rotation),this.globalMatrix.copy(this.matrix),null!==this.parent&&this.globalMatrix.premultiply(this.parent.globalMatrix),this.inverseGlobalMatrix=this.globalMatrix.getInverse(),this.matrixNeedsUpdate=!1)},Nn.prototype.transform=function(a,r,h,d){this.globalMatrix.tranformContext(a)},Nn.prototype.style=null,Nn.prototype.draw=null,Nn.prototype.onPointerDrag=function(a,r,h,d){this.position.add(h)},Nn.prototype.onPointerDragStart=null,Nn.prototype.onPointerDragEnd=null,Nn.prototype.onAdd=null,Nn.prototype.onRemove=null,Nn.prototype.onUpdate=null,Nn.prototype.onPointerEnter=null,Nn.prototype.onPointerLeave=null,Nn.prototype.onPointerOver=null,Nn.prototype.onButtonPressed=null,Nn.prototype.onDoubleClick=null,Nn.prototype.onButtonDown=null,Nn.prototype.onButtonUp=null,Nn.prototype.serialize=function(a){var r={uuid:this.uuid,type:this.type,position:this.position.toArray(),origin:this.origin.toArray(),scale:this.scale.toArray(),rotation:this.rotation,visible:this.visible,layer:this.layer,matrix:this.matrix.m,globalMatrix:this.globalMatrix.m,inverseGlobalMatrix:this.inverseGlobalMatrix.m,matrixAutoUpdate:this.matrixAutoUpdate,draggable:this.draggable,pointerEvents:this.pointerEvents,ignoreViewport:this.ignoreViewport,saveContextState:this.saveContextState,restoreContextState:this.restoreContextState,children:[],masks:[]};if(!1!==a)for(var h=0;h<this.children.length;h++)this.children[h].serializable&&r.children.push(this.children[h].serialize());for(h=0;h<this.masks.length;h++)r.masks.push(this.masks[h].uuid);return r},Nn.prototype.parse=function(a,r){this.uuid=a.uuid,this.position.fromArray(a.position),this.origin.fromArray(a.origin),this.scale.fromArray(a.scale),this.rotation=a.rotation,this.visible=a.visible,this.layer=a.layer,this.matrix=new Hi(a.matrix),this.globalMatrix=new Hi(a.globalMatrix),this.inverseGlobalMatrix=new Hi(a.inverseGlobalMatrix),this.matrixAutoUpdate=a.matrixAutoUpdate,this.draggable=a.draggable,this.pointerEvents=a.pointerEvents,this.ignoreViewport=a.ignoreViewport,this.saveContextState=a.saveContextState,this.restoreContextState=a.restoreContextState;for(var h=0;h<this.masks.length;h++)a.masks.push(r.getChildByUUID(a.masks[h]))},Nn.parse=function(a){for(var r=[],h=function y(b){if(!Nn.types.has(b.type))throw new Error("Object type "+b.type+" unknown. Cannot parse data.");var N=new(Nn.types.get(b.type));N.uuid=b.uuid,r.push({object:N,data:b});for(var k=0;k<b.children.length;k++)N.add(y(b.children[k]));return N}(a),d=0;d<r.length;d++)r[d].object.parse(r[d].data,h);return h},Ho.DOWN=-1,Ho.UP=1,Ho.RESET=0,Ho.prototype.constructor=Ho,Ho.prototype.update=function(a){this.justPressed=!1,this.justReleased=!1,a===Ho.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):a===Ho.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):a===Ho.RESET&&(this.justReleased=!1,this.justPressed=!1)},Ho.prototype.set=function(a,r,h){this.justPressed=a,this.pressed=r,this.justReleased=h},Ho.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},(Bi.prototype=Bi).constructor=Bi,Bi.LEFT=0,Bi.MIDDLE=1,Bi.RIGHT=2,Bi.BACK=3,Bi.FORWARD=4,Bi.setCanvas=function(a){this.canvas=a,a.pointerInside=!1,a.addEventListener("mouseenter",function(){this.pointerInside=!0}),a.addEventListener("mouseleave",function(){this.pointerInside=!1})},Bi.insideCanvas=function(){return null!==this.canvas&&this.canvas.pointerInside},Bi.buttonPressed=function(a){return this.keys[a].pressed},Bi.buttonDoubleClicked=function(a){return this.doubleClicked[a]},Bi.buttonJustPressed=function(a){return this.keys[a].justPressed},Bi.buttonJustReleased=function(a){return this.keys[a].justReleased},Bi.updatePosition=function(a,r,h,d){if(null!==this.canvas){var y=this.canvas.getBoundingClientRect();a-=y.left,r-=y.top}this._position.set(a,r),this._delta.x+=h,this._delta.y+=d,this._positionUpdated=!0},Bi.updateKey=function(a,r){a>-1&&this._keys[a].update(r)},Bi.update=function(){for(var a=0;a<5;a++)this._keys[a].justPressed&&this.keys[a].justPressed&&(this._keys[a].justPressed=!1),this._keys[a].justReleased&&this.keys[a].justReleased&&(this._keys[a].justReleased=!1),this.keys[a].set(this._keys[a].justPressed,this._keys[a].pressed,this._keys[a].justReleased),!0===this._doubleClicked[a]?(this.doubleClicked[a]=!0,this._doubleClicked[a]=!1):this.doubleClicked[a]=!1;this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._positionUpdated?(this.delta.copy(this._delta),this.position.copy(this._position),this._delta.set(0,0),this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},Bi.create=function(){this.events.create()},Bi.dispose=function(){this.events.destroy()},Ch.prototype.updateMatrix=function(){if(this.matrixNeedsUpdate){if(this.matrix.m=[1,0,0,1,this.position.x,this.position.y],0!==this.rotation){var a=Math.cos(this.rotation),r=Math.sin(this.rotation);this.matrix.multiply(new Hi([a,r,-r,a,0,0]))}1!==this.scale&&this.matrix.scale(this.scale,this.scale),this.inverseMatrix=this.matrix.getInverse(),this.matrixNeedsUpdate=!1}},Ch.prototype.centerObject=function(a,r){var h=a.globalMatrix.transformPoint(new Xn);h.multiplyScalar(-this.scale),h.x+=r.width/2,h.y+=r.height/2,this.position.copy(h),this.matrixNeedsUpdate=!0},rp.prototype.update=function(a){if(this.allowScale&&0!==a.wheel&&(this.viewport.scale-=.001*a.wheel*this.viewport.scale,this.viewport.matrixNeedsUpdate=!0,this.moveOnScale&&null!==a.canvas)){this.viewport.updateMatrix();var h=this.viewport.inverseMatrix.transformPoint(a.position),d=new Xn(a.canvas.width/2,a.canvas.height/2);d=this.viewport.inverseMatrix.transformPoint(d);var y=h.clone();y.sub(d),y.multiplyScalar(.1),this.viewport.position.sub(y),this.viewport.matrixNeedsUpdate=!0}if(this.allowRotation&&a.buttonPressed(Bi.RIGHT)&&a.buttonPressed(Bi.LEFT))if(null===this.rotationPoint)this.rotationPoint=a.position.clone(),this.rotationInitial=this.viewport.rotation;else{var b=a.position.clone();b.sub(this.rotationPoint),this.viewport.rotation=this.rotationInitial+b.angle(),this.viewport.matrixNeedsUpdate=!0}else this.rotationPoint=null,a.buttonPressed(this.dragButton)&&(this.viewport.position.x+=a.delta.x,this.viewport.position.y+=a.delta.y,this.viewport.matrixNeedsUpdate=!0)},Lh.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=requestAnimationFrame(r))}()}},Lh.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},Us.prototype.getDomContainer=function(){return null!==this.container?this.container:this.canvas.parentElement},Us.prototype.createRenderLoop=function(a,r,h){var d=this,y=new rp(r),b=new Lh(function(){void 0!==h&&h(),y.update(d.pointer),d.update(a,r)});return b.start(),b},Us.prototype.dispose=function(a,r,h){this.pointer.dispose()},Us.prototype.update=function(a,r){var h=[];a.traverse(function(Se){Se.visible&&h.push(Se)}),h.sort(function(Se,$e){return $e.layer===Se.layer?$e.level-Se.level:$e.layer-Se.layer});var d=this.pointer;d.update(),r.updateMatrix();for(var y=d.position.clone(),b=r.inverseMatrix.transformPoint(y),N=0;N<h.length;N++)if((T=h[N]).pointerEvents){var k=T.inverseGlobalMatrix.transformPoint(T.ignoreViewport?y:b);if(T.isInside(k)){if(T.pointerInside||null===T.onPointerEnter||T.onPointerEnter(d,r),null!==T.onPointerOver&&T.onPointerOver(d,r),d.buttonDoubleClicked(Bi.LEFT)&&null!==T.onDoubleClick&&T.onDoubleClick(d,r),d.buttonPressed(Bi.LEFT)&&null!==T.onButtonPressed&&T.onButtonPressed(d,r),d.buttonJustReleased(Bi.LEFT)&&null!==T.onButtonUp&&T.onButtonUp(d,r),d.buttonJustPressed(Bi.LEFT)&&(null!==T.onButtonDown&&T.onButtonDown(d,r),T.draggable)){T.beingDragged=!0,null!==T.onPointerDragStart&&T.onPointerDragStart(d,r);break}T.pointerInside=!0}else T.pointerInside&&(null!==T.onPointerLeave&&T.onPointerLeave(d,r),T.pointerInside=!1);d.buttonJustReleased(Bi.LEFT)&&T.draggable&&(!0===T.beingDragged&&null!==T.onPointerDragEnd&&T.onPointerDragEnd(d,r),T.beingDragged=!1)}for(N=0;N<h.length;N++){var T;if((T=h[N]).beingDragged&&null!==T.onPointerDrag){var H=d.position.clone();H.sub(d.delta);var Y=r.inverseMatrix.transformPoint(d.position),le=r.inverseMatrix.transformPoint(H),ae=Y.clone();ae.sub(le),T.onPointerDrag(d,r,ae,Y)}null!==T.onUpdate&&T.onUpdate()}for(a.traverse(function(Se){Se.updateMatrix()}),this.context.setTransform(1,0,0,1,0,0),this.autoClear&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),N=h.length-1;N>=0;N--)if(!h[N].isMask){h[N].saveContextState&&this.context.save();for(var ge=h[N].masks,we=0;we<ge.length;we++)ge[we].ignoreViewport||r.matrix.setContextTransform(this.context),ge[we].transform(this.context,r,this.canvas,this),ge[we].clip(this.context,r,this.canvas);h[N].ignoreViewport?ge.length>0&&this.context.setTransform(1,0,0,1,0,0):r.matrix.setContextTransform(this.context),h[N].transform(this.context,r,this.canvas,this),null!==h[N].style&&h[N].style(this.context,r,this.canvas),null!==h[N].draw&&h[N].draw(this.context,r,this.canvas),h[N].restoreContextState&&this.context.restore()}},oo.prototype.set=function(a,r){return this.min.copy(a),this.max.copy(r),this},oo.prototype.setFromPoints=function(a){this.min=new Xn(1/0,1/0),this.max=new Xn(-1/0,-1/0);for(var r=0,h=a.length;r<h;r++)this.expandByPoint(a[r]);return this},oo.prototype.setFromCenterAndSize=function(a,r){var h=(new Xn).copy(r).multiplyScalar(.5);return this.min.copy(a).sub(h),this.max.copy(a).add(h),this},oo.prototype.clone=function(){var a=new oo;return a.copy(this),a},oo.prototype.copy=function(a){this.min.copy(a.min),this.max.copy(a.max)},oo.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},oo.prototype.getCenter=function(a){return void 0===a&&(a=new Xn),this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5),a},oo.prototype.getSize=function(a){return void 0===a&&(a=new Xn),this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min),a},oo.prototype.expandByPoint=function(a){return this.min.min(a),this.max.max(a),this},oo.prototype.expandByVector=function(a){this.min.sub(a),this.max.add(a)},oo.prototype.expandByScalar=function(a){this.min.addScalar(-a),this.max.addScalar(a)},oo.prototype.containsPoint=function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},oo.prototype.containsBox=function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},oo.prototype.intersectsBox=function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},oo.prototype.distanceToPoint=function(a){return(new Xn).copy(a).clamp(this.min,this.max).sub(a).length()},oo.prototype.intersect=function(a){this.min.max(a.min),this.max.min(a.max)},oo.prototype.union=function(a){this.min.min(a.min),this.max.max(a.max)},oo.prototype.translate=function(a){this.min.add(a),this.max.add(a)},oo.prototype.equals=function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},oo.prototype.toArray=function(){return[this.min.x,this.min.y,this.max.x,this.max.y]},oo.prototype.fromArray=function(a){this.min.set(a[0],a[1]),this.max.set(a[2],a[3])},(_a.prototype=Object.create(Nn.prototype)).constructor=_a,_a.prototype.type="Mask",Nn.register(_a,"Mask"),_a.prototype.isMask=!0,_a.prototype.clip=function(a,r,h){},(Ja.prototype=Object.create(_a.prototype)).constructor=Ja,Ja.prototype.type="BoxMask",Nn.register(Ja,"BoxMask"),Ja.prototype.isInside=function(a){return this.box.containsPoint(a)},Ja.prototype.clip=function(a,r,h){a.beginPath();var d=this.box.max.x-this.box.min.x;this.invert?(a.rect(this.box.min.x-1e4,-5e3,1e4,1e4),a.rect(this.box.max.x,-5e3,1e4,1e4),a.rect(this.box.min.x,this.box.min.y-1e4,d,1e4),a.rect(this.box.min.x,this.box.max.y,d,1e4)):a.fillRect(this.box.min.x,this.box.min.y,d,this.box.max.y-this.box.min.y),a.clip()},uo.prototype.get=function(a){},uo.prototype.serialize=function(){},uo.prototype.parse=function(a){},uo.types=new Map([]),uo.register=function(a,r){uo.types.set(r,a)},uo.parse=function(a){var r=new(uo.types.get(a.type));return r.parse(a),r},Jo.prototype=Object.create(uo.prototype),uo.register(Jo,"Color"),Jo.prototype.get=function(a){return this.color},Jo.prototype.serialize=function(){return{type:"Color",color:this.color}},Jo.prototype.parse=function(a){this.color=a.color},(zs.prototype=Object.create(Nn.prototype)).constructor=zs,zs.prototype.type="Box",Nn.register(zs,"Box"),zs.prototype.onPointerEnter=function(a,r){this.fillStyle=new Jo("#CCCCCC")},zs.prototype.onPointerLeave=function(a,r){this.fillStyle=new Jo("#FFFFFF")},zs.prototype.isInside=function(a){return this.box.containsPoint(a)},zs.prototype.draw=function(a,r,h){var d=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillRect(this.box.min.x,this.box.min.y,d,y)),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.strokeRect(this.box.min.x,this.box.min.y,d,y))},zs.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r},zs.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.strokeStyle=null!==a.strokeStyle?uo.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?uo.parse(a.fillStyle):null},(qi.prototype=Object.create(Nn.prototype)).constructor=qi,qi.prototype.type="Circle",Nn.register(qi,"Circle"),qi.prototype.isInside=function(a){return a.length()<=this.radius},qi.prototype.onPointerEnter=function(a,r){this.fillStyle=new Jo("#CCCCCC")},qi.prototype.onPointerLeave=function(a,r){this.fillStyle=new Jo("#FFFFFF")},qi.prototype.draw=function(a,r,h){a.beginPath(),a.arc(0,0,this.radius,0,2*Math.PI),null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fill()),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.stroke())},qi.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.radius=this.radius,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r},qi.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.radius=a.radius,this.strokeStyle=null!==a.strokeStyle?uo.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?uo.parse(a.fillStyle):null},(Ao.prototype=Object.create(Nn.prototype)).constructor=Ao,Ao.prototype.type="Line",Nn.register(Ao,"Line"),Ao.prototype.style=function(a,r,h){a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.setLineDash(this.dashPattern)},Ao.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.lineTo(this.to.x,this.to.y),a.stroke()},Ao.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.from=this.from.toArray(),r.to=this.to.toArray(),r.dashPattern=this.dashPattern,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r},Ao.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.to.fromArray(a.to),this.from.fromArray(a.from),this.dashPattern=a.dashPattern,this.strokeStyle=null!==a.strokeStyle?uo.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth},(Ba.prototype=Object.create(Nn.prototype)).constructor=Ba,Ba.prototype.type="Text",Nn.register(Ba,"Text"),Ba.prototype.draw=function(a,r,h){a.font=this.font,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline,null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillText(this.text,0,0)),null!==this.strokeStyle&&(a.strokeStyle=this.strokeStyle.get(a),a.strokeText(this.text,0,0))},Ba.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.text=this.text,r.font=this.font,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r.textAlign=this.textAlign,r.textBaseline=this.textBaseline,r},Ba.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.text=a.text,this.font=a.font,this.strokeStyle=null!==a.strokeStyle?Style.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?Style.parse(a.fillStyle):null,this.textAlign=a.textAlign,this.textBaseline=a.textBaseline},(Fl.prototype=Object.create(Nn.prototype)).constructor=Fl,Fl.prototype.type="Image",Nn.register(Fl,"Image"),Fl.prototype.setImage=function(a){var r=this;this.image.onload=function(){r.box.min.set(0,0),r.box.max.set(this.naturalWidth,this.naturalHeight)},this.image.src=a},Fl.prototype.isInside=function(a){return this.box.containsPoint(a)},Fl.prototype.draw=function(a,r,h){this.image.src.length>0&&a.drawImage(this.image,0,0,this.image.naturalWidth,this.image.naturalHeight,this.box.min.x,this.box.min.y,this.box.max.x-this.box.min.x,this.box.max.y-this.box.min.y)},Fl.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.image=this.image.src,r},Fl.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.image.src=a.image},(Bh.prototype=Object.create(Nn.prototype)).constructor=Bh,Bh.prototype.type="DOM",Nn.register(Bh,"DOM"),Bh.prototype.onAdd=function(){null!==this.parentElement&&this.parentElement.appendChild(this.element)},Bh.prototype.onRemove=function(){null!==this.parentElement&&this.parentElement.removeChild(this.element)},Bh.prototype.transform=function(a,r,h,d){if(null===this.parentElement&&(this.parentElement=d.getDomContainer(),this.parentElement.appendChild(this.element)),this.ignoreViewport)this.element.style.transform=this.globalMatrix.cssTransform();else{var y=r.matrix.clone();y.multiply(this.globalMatrix),this.element.style.transform=y.cssTransform()}this.element.style.width=this.size.x+"px",this.element.style.height=this.size.y+"px",this.element.style.display=this.visible?"block":"none"},Bh.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.size=this.size.toArray(),r.element=this.element.outerHTML,r},Bh.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.size.fromArray(a.size);var h=(new DOMParser).parseFromString(this.element.outerHTML,"text/html");this.element=h.body.children[0]},(ho.prototype=Object.create(Nn.prototype)).constructor=ho,ho.prototype.type="Pattern",Nn.register(ho,"Pattern"),ho.prototype.setImage=function(a){var r=this;this.image.onload=function(){r.box.min.set(0,0),r.box.max.set(this.naturalWidth,this.naturalHeight)},this.image.src=a},ho.prototype.isInside=function(a){return this.box.containsPoint(a)},ho.prototype.draw=function(a,r,h){var d=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;if(this.image.src.length>0){var b=a.createPattern(this.image,this.repetition);a.fillStyle=b,a.fillRect(this.box.min.x,this.box.min.y,d,y)}},ho.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.image=this.image.src,r.repetition=this.repetition,r},ho.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.image.src=a.image,this.repetition=a.repetition},(ga.prototype=Object.create(Ba.prototype)).constructor=ga,ga.prototype.type="MultiLineText",Nn.register(ga,"MultiLineText"),ga.prototype.draw=function(a,r,h){a.font=this.font,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline;for(var d=this.lineHeight||Number.parseFloat(this.font),y=this.text.split("\n"),b=0,N=0;N<y.length;N++){var k=y[N],T=a.measureText(k),H=[];if(null!==this.maxWidth&&T.width>this.maxWidth)for(;k.length>0;){for(var Y="",le=a.measureText(Y+k[0]);le.width<this.maxWidth&&k.length>0;)Y+=k[0],k=k.substr(1),le=a.measureText(Y+k[0]);H.push(Y)}else H=[k];for(var ae=0;ae<H.length;ae++)null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillText(H[ae],this.position.x,this.position.y+b)),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.strokeText(H[ae],this.position.x,this.position.y+b)),b+=d}},ga.prototype.serialize=function(a){var r=Ba.prototype.serialize.call(this,a);return r.maxWidth=this.maxWidth,r.lineHeight=this.lineHeight,r},ga.prototype.parse=function(a,r){Ba.prototype.parse.call(this,a,r),this.maxWidth=a.maxWidth,this.lineHeight=a.lineHeight},(fl.prototype=Object.create(Ao.prototype)).constructor=fl,fl.prototype.type="BezierCurve",Nn.register(fl,"BezierCurve"),fl.curveHelper=function(a){var r=new qi;r.radius=3,r.layer=a.layer+1,r.draggable=!0,r.onPointerDrag=function(b,N,k){Nn.prototype.onPointerDrag.call(this,b,N,k),a.fromCp.copy(r.position)},a.parent.add(r);var h=new Ao;h.from=a.from,h.to=a.fromCp,a.parent.add(h);var d=new qi;d.radius=3,d.layer=a.layer+1,d.draggable=!0,d.onPointerDrag=function(b,N,k){Nn.prototype.onPointerDrag.call(this,b,N,k),a.toCp.copy(d.position)},a.parent.add(d);var y=new Ao;y.from=a.to,y.to=a.toCp,a.parent.add(y)},fl.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.bezierCurveTo(this.fromCp.x,this.fromCp.y,this.toCp.x,this.toCp.y,this.to.x,this.to.y),a.stroke()},fl.prototype.serialize=function(a){var r=Ao.prototype.serialize.call(this,a);return r.fromCp=this.fromCp.toArray(),r.toCp=this.toCp.toArray(),r},fl.prototype.parse=function(a,r){Ao.prototype.parse.call(this,a,r),this.fromCp.fromArray(a.fromCp),this.toCp.fromArray(a.toCp)},(su.prototype=Object.create(Ao.prototype)).constructor=su,su.prototype.type="QuadraticCurve",Nn.register(su,"QuadraticCurve"),su.curveHelper=function(a){var r=new Ao;r.from=a.from,r.to=a.controlPoint,a.parent.add(r);var h=new qi;h.radius=3,h.layer=a.layer+1,h.draggable=!0,h.position=a.controlPoint,h.onPointerDrag=function(y,b,N){Nn.prototype.onPointerDrag.call(this,y,b,N),a.controlPoint.copy(h.position)},a.parent.add(h);var d=new Ao;d.from=a.to,d.to=a.controlPoint,a.parent.add(d)},su.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.quadraticCurveTo(this.controlPoint.x,this.controlPoint.y,this.to.x,this.to.y),a.stroke()},su.prototype.serialize=function(a){var r=Ao.prototype.serialize.call(this,a);return r.controlPoint=this.controlPoint.toArray(),r},su.prototype.parse=function(a,r){Ao.prototype.parse.call(this,a,r),this.controlPoint.fromArray(a.controlPoint)},(ea.prototype=Object.create(zs.prototype)).constructor=ea,ea.prototype.type="RoundedBox",Nn.register(ea,"RoundedBox"),ea.roundRect=function(a,r,h,d,y,b){a.beginPath(),a.moveTo(r+b,h),a.lineTo(r+d-b,h),a.quadraticCurveTo(r+d,h,r+d,h+b),a.lineTo(r+d,h+y-b),a.quadraticCurveTo(r+d,h+y,r+d-b,h+y),a.lineTo(r+b,h+y),a.quadraticCurveTo(r,h+y,r,h+y-b),a.lineTo(r,h+b),a.quadraticCurveTo(r,h,r+b,h),a.closePath()},ea.prototype.draw=function(a,r,h){var d=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),ea.roundRect(a,this.box.min.x,this.box.min.y,d,y,this.radius),a.fill()),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),ea.roundRect(a,this.box.min.x,this.box.min.y,d,y,this.radius),a.stroke())},ea.prototype.serialize=function(a){var r=zs.prototype.serialize.call(this,a);return r.radius=this.radius,r},ea.prototype.parse=function(a,r){zs.prototype.parse.call(this,a,r),this.radius=a.radius},(us.prototype=Object.create(Nn.prototype)).constructor=us,us.prototype.type="Graph",Nn.register(us,"Graph"),us.prototype.isInside=function(a){return this.box.containsPoint(a)},us.prototype.draw=function(a,r,h){if(0!==this.data.length){var d=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.beginPath();var b=d/(this.data.length-1),N=this.max-this.min;a.moveTo(this.box.min.x,this.box.max.y-(this.data[0]-this.min)/N*y);for(var k=1,T=b;k<this.data.length;T+=b,k++)a.lineTo(this.box.min.x+T,this.box.max.y-(this.data[k]-this.min)/N*y);a.stroke(),null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.lineTo(this.box.max.x,this.box.max.y),a.lineTo(this.box.min.x,this.box.max.y),a.fill())}},us.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r.min=this.min,r.max=this.max,r.data=this.data,r},us.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.strokeStyle=null!==a.strokeStyle?Style.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?Style.parse(a.fillStyle):null,this.min=a.min,this.max=a.max,this.data=a.data},(ml.prototype=Object.create(uo.prototype)).addColorStop=function(a,r){this.colors.push(new Nh(a,r))},ml.prototype.serialize=function(){return{colors:this.colors}},ml.prototype.parse=function(a){for(var r=[],h=0;h<a.colors.length;h++)r.push(new Nh(a.colors[h].offset,a.colors[h].color));this.colors=r},po.prototype=Object.create(ml.prototype),uo.register(po,"LinearGradient"),po.prototype.get=function(a){for(var r=a.createLinearGradient(this.start.x,this.start.y,this.end.x,this.end.y),h=0;h<this.colors.length;h++)r.addColorStop(this.colors[h].offset,this.colors[h].color);return r},po.prototype.serialize=function(){var a=ml.prototype.serialize.call(this);return Object.assign(a,{type:"LinearGradient",start:this.start.toArray(),end:this.end.toArray()}),a},po.prototype.parse=function(a){ml.prototype.parse.call(this,a),this.start.fromArray(a.start),this.end.fromArray(a.end)},(sc.prototype=Object.create(Nn.prototype)).constructor=sc,sc.prototype.type="Gauge",Nn.register(sc,"Gauge"),sc.prototype.isInside=function(a){return a.length()<=this.radius},sc.prototype.draw=function(a,r,h){var d=this.value/(this.max-this.min),y=[this.startAngle,this.endAngle],b=y[0]+(y[1]-y[0])*d,N=[0,0];a.lineWidth=this.lineWidth,a.lineCap="round",a.strokeStyle=this.baseStyle.get(a),a.beginPath(),a.arc(N[0],N[1],this.radius,y[0],y[1]),a.stroke();var k=a.createLinearGradient(-this.radius,0,this.radius,0);if(a.strokeStyle=this.barStyle.get(a),a.lineWidth=this.lineWidth,a.beginPath(),a.arc(N[0],N[1],this.radius,y[0],b),a.stroke(),this.dial){var T=(this.startAngle-this.endAngle)*d,H=[Math.cos(T)*this.radius,Math.sin(T)*this.radius];H[0]=H[0]-N[0],H[1]=H[1]-N[1],a.fillStyle="#FFFFFF",a.beginPath(),a.arc(H[0],H[1],this.lineWidth/2,0,2*Math.PI),a.fill(),a.fillStyle=k,a.beginPath(),a.arc(H[0],H[1],this.lineWidth/3,0,2*Math.PI),a.fill()}},sc.prototype.serialize=function(a){return Nn.prototype.serialize.call(this,a)},sc.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r)},ah.prototype=Object.create(uo.prototype),uo.register(ah,"Pattern"),ah.prototype.setTransform=function(a){this.matrix.m=a,this.needsUpdate=!0},ah.prototype.get=function(a){return(this.needsUpdate||null===this.cache)&&(this.cache=a.createPattern(this.source,this.repetition),this.cache.setTransform(this.matrix.cssTransform()),this.needsUpdate=!1),this.cache},ah.prototype.serialize=function(){var a=ml.prototype.serialize.call(this);return Object.assign(a,{type:"Pattern",matrix:this.matrix.m,repetition:this.repetition,source:this.source}),a},ah.prototype.parse=function(a){ml.prototype.parse.call(this,a),this.matrix=new Hi(a.matrix),this.repetition=a.repetition,this.source=a.source},lh.prototype=Object.create(ml.prototype),uo.register(lh,"RadialGradient"),lh.prototype.get=function(a){for(var r=a.createRadialGradient(this.start.x,this.start.y,this.startRadius,this.end.x,this.end.y,this.endRadius),h=0;h<this.colors.length;h++)r.addColorStop(this.colors[h].offset,this.colors[h].color);return r},lh.prototype.serialize=function(){var a=ml.prototype.serialize.call(this);return Object.assign(a,{type:"RadialGradient",start:this.start.toArray(),end:this.end.toArray(),startRadius:this.startRadius,endRadius:this.endRadius}),a},lh.prototype.parse=function(a){ml.prototype.parse.call(this,a),this.start.fromArray(a.start),this.end.fromArray(a.end),this.startRadius=a.startRadius,this.endRadius=a.endRadius},(ac.prototype=Object.create(Nn.prototype)).constructor=ac,ac.prototype.type="NodeGraph",Nn.register(ac,"NodeGraph"),ac.prototype.addNode=function(a){for(var r=0,h=0,d=0;d<this.children.length;d++)this.children[d].position.x>r&&(r=this.children[d].position.x),this.children[d].position.y>h&&(h=this.children[d].position.y);return a.position.set(r+200,h/2),this.add(a),null!==a.registerSockets&&a.registerSockets(),a},(rs.prototype=Object.create(fl.prototype)).constructor=rs,rs.prototype.type="NodeConnector",Nn.register(rs,"NodeConnector"),rs.prototype.destroy=function(){fl.prototype.destroy.call(this),null!==this.outputSocket&&(this.outputSocket.removeConnector(this),this.outputSocket=null),null!==this.inputSocket&&(this.inputSocket.removeConnector(this),this.inputSocket=null)},rs.prototype.onUpdate=function(){null!==this.outputSocket&&this.from.copy(this.outputSocket.position),null!==this.inputSocket&&this.to.copy(this.inputSocket.position),this.fromCp.copy(this.from),this.fromCp.add(this.to),this.fromCp.multiplyScalar(.5),this.toCp.copy(this.fromCp);var a=.5,r=this.to.y-this.from.y,h=this.to.x-this.from.x;Math.abs(h)>Math.abs(r)?(this.toCp.x+=h*a,this.fromCp.x-=h*a):(this.toCp.y+=r*a,this.fromCp.y-=r*a)},rs.prototype.serialize=function(a){var r=fl.prototype.serialize.call(this,a);return r.outputSocket=null!==this.outputSocket?this.outputSocket.uuid:null,r.inputSocket=null!==this.inputSocket?this.inputSocket.uuid:null,r},rs.prototype.parse=function(a,r){fl.prototype.parse.call(this,a,r),null!==a.outputSocket&&(this.outputSocket=r.getChildByUUID(a.outputSocket)),null!==a.inputSocket&&(this.inputSocket=r.getChildByUUID(a.inputSocket))},(Qi.prototype=Object.create(qi.prototype)).constructor=Qi,Qi.prototype.type="NodeSocket",Nn.register(Qi,"NodeSocket"),Qi.INPUT=1,Qi.OUTPUT=2,Qi.prototype.getValue=function(){return this.direction===Qi.INPUT&&this.connectors.length>0&&null!==this.connectors[0].outputSocket?this.connectors[0].outputSocket.getValue():null},Qi.prototype.connectTo=function(a){if(!this.isCompatible(a))throw new Error("Sockets are not compatible they cannot be connected.");var r=new rs;return this.attachConnector(r),a.attachConnector(r),r},Qi.prototype.attachConnector=function(a){this.canAddConnector()||this.destroyConnectors(),this.direction===Qi.INPUT?a.inputSocket=this:this.direction===Qi.OUTPUT&&(a.outputSocket=this),this.connectors.push(a),null===a.parent&&this.parent.add(a)},Qi.prototype.isCompatible=function(a){return this.direction!==a.direction&&this.category===a.category},Qi.prototype.canAddConnector=function(){return!(this.connectors.length>0&&(this.direction===Qi.INPUT||this.direction===Qi.OUTPUT&&!this.multiple))},Qi.prototype.canConnect=function(a){return this.isCompatible(a)&&this.canAddConnector()},Qi.prototype.removeConnector=function(a){var r=this.connectors.indexOf(a);-1!==r&&(this.connectors.splice(r,1),a.destroy())},Qi.prototype.destroyConnectors=function(){for(var a=0;a<this.connectors.length;a++)this.connectors[a].destroy()},Qi.prototype.destroy=function(){qi.prototype.destroy.call(this),this.destroyConnectors()},Qi.prototype.onPointerDragStart=function(a,r){this.creatingConnection=!0,this.attachConnector(new rs)},Qi.prototype.onPointerDrag=function(a,r,h,d){this.creatingConnection&&(this.direction===Qi.INPUT?this.connectors[this.connectors.length-1].from.copy(d):this.direction===Qi.OUTPUT&&this.connectors[this.connectors.length-1].to.copy(d))},Qi.prototype.onPointerDragEnd=function(a,r){if(this.creatingConnection){for(var h=r.inverseMatrix.transformPoint(a.position),d=this.parent.getWorldPointIntersections(h),y=!1,b=0;b<d.length;b++)if(d[b]instanceof Qi&&this.isCompatible(d[b])){d[b].attachConnector(this.connectors[this.connectors.length-1]),y=!0;break}y||this.connectors[this.connectors.length-1].destroy()}this.creatingConnection=!1},Qi.prototype.serialize=function(a){var r=qi.prototype.serialize.call(this,a);r.name=this.name,r.category=this.category,r.multiple=this.multiple,r.direction=this.direction,r.node=this.node.uuid,r.connectors=[];for(var h=0;h<this.connectors.length;h++)r.connectors.push(this.connectors[h].uuid);return r},Qi.prototype.parse=function(a,r){qi.prototype.parse.call(this,a,r),this.name=a.name,this.category=a.category,this.multiple=a.multiple,this.direction=a.direction,this.node=r.getChildByUUID(a.node);for(var h=0;h<a.connectors.length;h++)this.connectors.push(r.getChildByUUID(a.connectors[h]))},(ta.prototype=Object.create(ea.prototype)).constructor=ta,ta.prototype.type="Node",Nn.register(ta,"Node"),ta.prototype.registerSockets=null,ta.prototype.addInput=function(a,r){var h=new Qi(this,Qi.INPUT,a,r);return this.inputs.push(h),this.parent.add(h),h},ta.prototype.addOutput=function(a,r){var h=new Qi(this,Qi.OUTPUT,a,r);return this.outputs.push(h),this.parent.add(h),h},ta.prototype.getOutput=function(a){for(var r=0;r<this.outputs.length;r++)if(this.outputs[r].name===a)return this.outputs[r];return null},ta.prototype.getInput=function(a){for(var r=0;r<this.inputs.length;r++)if(this.inputs[r].name===a)return this.inputs[r];return null},ta.prototype.destroy=function(){ea.prototype.destroy.call(this);for(var a=0;a<this.inputs.length;a++)this.inputs[a].destroy();for(a=0;a<this.outputs.length;a++)this.outputs[a].destroy()},ta.prototype.onUpdate=function(){for(var a=this.box.max.y-this.box.min.y,r=a/(this.inputs.length+1),h=this.box.min.y+r,d=0;d<this.inputs.length;d++)this.inputs[d].position.set(this.position.x+this.box.min.x,this.position.y+(h+r*d));for(h=this.box.min.y+(r=a/(this.outputs.length+1)),d=0;d<this.outputs.length;d++)this.outputs[d].position.set(this.position.x+this.box.max.x,this.position.y+(h+r*d))},ta.prototype.serialize=function(a){var r=ea.prototype.serialize.call(this,a);r.inputs=[];for(var h=0;h<this.inputs.length;h++)r.inputs.push(this.inputs[h].uuid);for(r.outputs=[],h=0;h<this.outputs.length;h++)r.outputs.push(this.outputs[h].uuid);return r},ta.prototype.parse=function(a,r){ea.prototype.parse.call(this,a,r);for(var h=0;h<a.inputs.length;h++)this.inputs.push(r.getChildByUUID(a.inputs[h]));for(h=0;h<a.outputs.length;h++)this.outputs.push(r.getChildByUUID(a.outputs[h]))},Dp.rotateTool=function(a){var r=new qi;r.radius=4,r.layer=a.layer+1,r.onPointerDrag=function(h,d,y){a.rotation+=.001*y.x},a.add(r)},Dp.boxResizeTool=function(a){if(void 0!==a.box){var r=new qi;r.radius=4,r.layer=a.layer+1,r.draggable=!0,r.onPointerDrag=function(N,k,T){Nn.prototype.onPointerDrag.call(this,N,k,T),a.box.min.copy(r.position),b()},a.add(r);var h=new qi;h.radius=4,h.layer=a.layer+1,h.draggable=!0,h.onPointerDrag=function(N,k,T){Nn.prototype.onPointerDrag.call(this,N,k,T),a.box.max.x=h.position.x,a.box.min.y=h.position.y,b()},a.add(h);var d=new qi;d.radius=4,d.layer=a.layer+1,d.draggable=!0,d.onPointerDrag=function(N,k,T){Nn.prototype.onPointerDrag.call(this,N,k,T),a.box.max.copy(d.position),b()},a.add(d);var y=new qi;y.radius=4,y.layer=a.layer+1,y.draggable=!0,y.onPointerDrag=function(N,k,T){Nn.prototype.onPointerDrag.call(this,N,k,T),a.box.min.x=y.position.x,a.box.max.y=y.position.y,b()},a.add(y),b()}else console.warn("escher.js: Helpers.boxResizeTool(), object box property missing.");function b(){r.position.copy(a.box.min),d.position.copy(a.box.max),h.position.set(a.box.max.x,a.box.min.y),y.position.set(a.box.min.x,a.box.max.y)}},Td.read=function(a,r,h){var d=new XMLHttpRequest;d.overrideMimeType("text/plain"),d.open("GET",a,!0),void 0!==r&&(d.onload=function(){r(d.response)}),void 0!==h&&(d.onerror=h),d.send(null)},Td.write=function(a,r){var h=new Blob([r],{type:"octet/stream"}),d=document.createElement("a");d.download=a,d.href=window.URL.createObjectURL(h),d.style.display="none",d.onclick=function(){document.body.removeChild(this)},document.body.appendChild(d),d.click()},Td.select=function(a,r){var h=document.createElement("input");h.type="file",h.style.display="none",document.body.appendChild(h),void 0!==r&&(h.accept=r),h.onchange=function(d){void 0!==a&&a(h.files),document.body.removeChild(h)},h.click()},(hi.prototype=Object.create(l.Group.prototype)).addNode=function(a){this.graph.addNode(a)},hi.prototype.initialize=function(){l.Object3D.prototype.initialize.call(this)},hi.prototype.update=function(a){l.Object3D.prototype.update.call(this,a)},hi.prototype.dispose=function(){l.Object3D.prototype.dispose.call(this)},hi.prototype.resize=function(a,r){},hi.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.graph=this.graph.serialize(),r},Dl.prototype.createWorkers=function(){for(var a=0;a<this.workers.length;a++)this.workers[a].terminate();var r=this;function h(y){var b=y.data.uuid;if(void 0===r.tasks[b])throw new Error("Unknown worker task "+b);r.tasks[b].callback(y.data.data),delete r.tasks[b]}for(this.workers=[],this.next=0,a=0;a<this.size;a++){var d=new Worker(this.file);d.onmessage=h,this.workers.push(d)}},Dl.prototype.runTask=function(a,r){var h=new Rc(a,r);this.tasks[h.uuid]=h,this.workers[this.next].postMessage({data:h.data,uuid:h.uuid}),this.next++,this.next>=this.workers.length&&(this.next=0)},Ul.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=setTimeout(r,a.time))}()}},Ul.prototype.stop=function(){this.running=!1,clearTimeout(self.id)},Md.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=requestAnimationFrame(r))}()}},Md.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},Pc.set=function(a,r){"object"==typeof r?window.localStorage.setItem(a,JSON.stringify(r)):window.localStorage.setItem(a,r)},Pc.get=function(a){var r=window.localStorage.getItem(a);try{return JSON.parse(r)}catch{return r}},Pc.exists=function(a){return null!==window.localStorage.getItem(a)},Pc.delete=function(a){return window.localStorage.removeItem(a)},Za.getRoot=function(a){for(var r=a;null!==r.parent;)r=r.parent;return r},Za.centerUnitary=function(a){var r=Za.calculateBoundingBox(a);if(null!==r){var h=new l.Vector3;r.getSize(h);var d=1/(h.x>h.y?h.x>h.z?h.x:h.z:h.y>h.z?h.y:h.z),y=new l.Vector3;r.getCenter(y),y.multiplyScalar(d),a.scale.set(d,d,d),a.position.set(-y.x,-d*r.min.y,-y.z)}},Za.calculateBoundingBox=function(a){var r=null;return a.traverse(function(h){var d=null;if(!0===h.isSprite){var y=new l.Vector3;h.getWorldPosition(y),d=new l.Box3(y.clone().subScalar(.5),y.clone().addScalar(.5))}else void 0!==h.geometry&&(h.geometry.computeBoundingBox(),(d=h.geometry.boundingBox.clone()).applyMatrix4(h.matrixWorld),h.geometry.computeBoundingBox(),d=h.geometry.boundingBox);null!==d&&(null===r?r=d:(d.min.x<r.min.x&&(r.min.x=d.min.x),d.max.x>r.max.x&&(r.max.x=d.max.x),d.min.y<r.min.y&&(r.min.y=d.min.y),d.max.y>r.max.y&&(r.max.y=d.max.y),d.min.z<r.min.z&&(r.min.z=d.min.z),d.max.z>r.max.z&&(r.max.z=d.max.z)))}),r},Za.centerGeometryOrigin=function(a){a.traverse(function(r){if(void 0!==r.geometry){r.geometry.computeBoundingBox();var h=r.geometry.boundingBox.clone().getCenter(new l.Vector3);r.position.add(h);var d=new l.Matrix4;d.makeTranslation(-h.x,-h.y,-h.z),r.geometry.applyMatrix4(d)}})},Za.convertToBufferGeometry=function(a){a.traverse(function(r){void 0!==r.geometry&&!0===r.geometry.isGeometry&&(r.geometry=(new l.BufferGeometry).fromGeometry(r.geometry))})};var Rh=function(){var a,r,h,d,y=new l.Vector3;function b(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new H,this.unassigned=new H,this.vertices=[]}function N(){this.normal=new l.Vector3,this.midpoint=new l.Vector3,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}function k(Y,le){this.vertex=Y,this.prev=null,this.next=null,this.twin=null,this.face=le}function T(Y){this.point=Y,this.prev=null,this.next=null,this.face=null}function H(){this.head=null,this.tail=null}return Object.assign(b.prototype,{setFromPoints:function(Y){!0!==Array.isArray(Y)&&console.error("THREE.ConvexHull: Points parameter is not an array."),Y.length<4&&console.error("THREE.ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var le=0,ae=Y.length;le<ae;le++)this.vertices.push(new T(Y[le]));return this.compute(),this},setFromObject:function(Y){var le=[];return Y.updateMatrixWorld(!0),Y.traverse(function(ae){var ge,we,Se,$e=ae.geometry;if(void 0!==$e)if($e.isGeometry){var Re=$e.vertices;for(ge=0,we=Re.length;ge<we;ge++)(Se=Re[ge].clone()).applyMatrix4(ae.matrixWorld),le.push(Se)}else if($e.isBufferGeometry){var Pe=$e.attributes.position;if(void 0!==Pe)for(ge=0,we=Pe.count;ge<we;ge++)(Se=new l.Vector3).fromBufferAttribute(Pe,ge).applyMatrix4(ae.matrixWorld),le.push(Se)}}),this.setFromPoints(le)},containsPoint:function(Y){for(var le=this.faces,ae=0,ge=le.length;ae<ge;ae++)if(le[ae].distanceToPoint(Y)>this.tolerance)return!1;return!0},intersectRay:function(Y,le){for(var ae=this.faces,ge=-1/0,we=1/0,Se=0,$e=ae.length;Se<$e;Se++){var Re=ae[Se],Pe=Re.distanceToPoint(Y.origin),Oe=Re.normal.dot(Y.direction);if(Pe>0&&Oe>=0)return null;var Fe=0!==Oe?-Pe/Oe:0;if(!(Fe<=0)&&(Oe>0?we=Math.min(Fe,we):ge=Math.max(Fe,ge),ge>we))return null}return Y.at(ge!==-1/0?ge:we,le),le},intersectsRay:function(Y){return null!==this.intersectRay(Y,y)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(Y,le){return Y.face=le,null===le.outside?this.assigned.append(Y):this.assigned.insertBefore(le.outside,Y),le.outside=Y,this},removeVertexFromFace:function(Y,le){return Y===le.outside&&(le.outside=null!==Y.next&&Y.next.face===le?Y.next:null),this.assigned.remove(Y),this},removeAllVerticesFromFace:function(Y){if(null!==Y.outside){for(var le=Y.outside,ae=Y.outside;null!==ae.next&&ae.next.face===Y;)ae=ae.next;return this.assigned.removeSubList(le,ae),le.prev=ae.next=null,Y.outside=null,le}},deleteFaceVertices:function(Y,le){var ae=this.removeAllVerticesFromFace(Y);if(void 0!==ae)if(void 0===le)this.unassigned.appendChain(ae);else{var ge=ae;do{var we=ge.next;le.distanceToPoint(ge.point)>this.tolerance?this.addVertexToFace(ge,le):this.unassigned.append(ge),ge=we}while(null!==ge)}return this},resolveUnassignedPoints:function(Y){if(!1===this.unassigned.isEmpty()){var le=this.unassigned.first();do{for(var ae=le.next,ge=this.tolerance,we=null,Se=0;Se<Y.length;Se++){var $e=Y[Se];if(0===$e.mark){var Re=$e.distanceToPoint(le.point);if(Re>ge&&(ge=Re,we=$e),ge>1e3*this.tolerance)break}}null!==we&&this.addVertexToFace(le,we),le=ae}while(null!==le)}return this},computeExtremes:function(){var Y,le,ae,ge=new l.Vector3,we=new l.Vector3,Se=[],$e=[];for(Y=0;Y<3;Y++)Se[Y]=$e[Y]=this.vertices[0];for(ge.copy(this.vertices[0].point),we.copy(this.vertices[0].point),Y=0,le=this.vertices.length;Y<le;Y++){var Re=this.vertices[Y],Pe=Re.point;for(ae=0;ae<3;ae++)Pe.getComponent(ae)<ge.getComponent(ae)&&(ge.setComponent(ae,Pe.getComponent(ae)),Se[ae]=Re);for(ae=0;ae<3;ae++)Pe.getComponent(ae)>we.getComponent(ae)&&(we.setComponent(ae,Pe.getComponent(ae)),$e[ae]=Re)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(ge.x),Math.abs(we.x))+Math.max(Math.abs(ge.y),Math.abs(we.y))+Math.max(Math.abs(ge.z),Math.abs(we.z))),{min:Se,max:$e}},computeInitialHull:function(){void 0===a&&(a=new l.Line3,r=new l.Plane,h=new l.Vector3);var Y,le,ae,ge,we,Se,$e,Re,Pe,Oe=this.vertices,Fe=this.computeExtremes(),De=Fe.min,Qe=Fe.max,it=0,ct=0;for(Se=0;Se<3;Se++)(Pe=Qe[Se].point.getComponent(Se)-De[Se].point.getComponent(Se))>it&&(it=Pe,ct=Se);for(it=0,a.set((le=De[ct]).point,(ae=Qe[ct]).point),Se=0,$e=this.vertices.length;Se<$e;Se++)(Y=Oe[Se])!==le&&Y!==ae&&(a.closestPointToPoint(Y.point,!0,h),(Pe=h.distanceToSquared(Y.point))>it&&(it=Pe,ge=Y));for(it=-1,r.setFromCoplanarPoints(le.point,ae.point,ge.point),Se=0,$e=this.vertices.length;Se<$e;Se++)(Y=Oe[Se])!==le&&Y!==ae&&Y!==ge&&(Pe=Math.abs(r.distanceToPoint(Y.point)))>it&&(it=Pe,we=Y);var _t=[];if(r.distanceToPoint(we.point)<0)for(_t.push(N.create(le,ae,ge),N.create(we,ae,le),N.create(we,ge,ae),N.create(we,le,ge)),Se=0;Se<3;Se++)Re=(Se+1)%3,_t[Se+1].getEdge(2).setTwin(_t[0].getEdge(Re)),_t[Se+1].getEdge(1).setTwin(_t[Re+1].getEdge(0));else for(_t.push(N.create(le,ge,ae),N.create(we,le,ae),N.create(we,ae,ge),N.create(we,ge,le)),Se=0;Se<3;Se++)Re=(Se+1)%3,_t[Se+1].getEdge(2).setTwin(_t[0].getEdge((3-Se)%3)),_t[Se+1].getEdge(0).setTwin(_t[Re+1].getEdge(1));for(Se=0;Se<4;Se++)this.faces.push(_t[Se]);for(Se=0,$e=Oe.length;Se<$e;Se++)if((Y=Oe[Se])!==le&&Y!==ae&&Y!==ge&&Y!==we){it=this.tolerance;var $t=null;for(Re=0;Re<4;Re++)(Pe=this.faces[Re].distanceToPoint(Y.point))>it&&(it=Pe,$t=this.faces[Re]);null!==$t&&this.addVertexToFace(Y,$t)}return this},reindexFaces:function(){for(var Y=[],le=0;le<this.faces.length;le++){var ae=this.faces[le];0===ae.mark&&Y.push(ae)}return this.faces=Y,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var Y,le=0,ae=this.assigned.first().face,ge=ae.outside;do{var we=ae.distanceToPoint(ge.point);we>le&&(le=we,Y=ge),ge=ge.next}while(null!==ge&&ge.face===ae);return Y}},computeHorizon:function(Y,le,ae,ge){var we;this.deleteFaceVertices(ae),ae.mark=1,we=null===le?le=ae.getEdge(0):le.next;do{var Se=we.twin,$e=Se.face;0===$e.mark&&($e.distanceToPoint(Y)>this.tolerance?this.computeHorizon(Y,Se,$e,ge):ge.push(we)),we=we.next}while(we!==le);return this},addAdjoiningFace:function(Y,le){var ae=N.create(Y,le.tail(),le.head());return this.faces.push(ae),ae.getEdge(-1).setTwin(le.twin),ae.getEdge(0)},addNewFaces:function(Y,le){this.newFaces=[];for(var ae=null,ge=null,we=0;we<le.length;we++){var $e=this.addAdjoiningFace(Y,le[we]);null===ae?ae=$e:$e.next.setTwin(ge),this.newFaces.push($e.face),ge=$e}return ae.next.setTwin(ge),this},addVertexToHull:function(Y){var le=[];return this.unassigned.clear(),this.removeVertexFromFace(Y,Y.face),this.computeHorizon(Y.point,null,Y.face,le),this.addNewFaces(Y,le),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var Y;for(this.computeInitialHull();void 0!==(Y=this.nextVertexToAdd());)this.addVertexToHull(Y);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(N,{create:function(Y,le,ae){var ge=new N,we=new k(Y,ge),Se=new k(le,ge),$e=new k(ae,ge);return we.next=$e.prev=Se,Se.next=we.prev=$e,$e.next=Se.prev=we,ge.edge=we,ge.compute()}}),Object.assign(N.prototype,{getEdge:function(Y){for(var le=this.edge;Y>0;)le=le.next,Y--;for(;Y<0;)le=le.prev,Y++;return le},compute:function(){void 0===d&&(d=new l.Triangle);var Y=this.edge.tail(),le=this.edge.head(),ae=this.edge.next.head();return d.set(Y.point,le.point,ae.point),d.getNormal(this.normal),d.getMidpoint(this.midpoint),this.area=d.getArea(),this.constant=this.normal.dot(this.midpoint),this},distanceToPoint:function(Y){return this.normal.dot(Y)-this.constant}}),Object.assign(k.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var Y=this.head(),le=this.tail();return null!==le?le.point.distanceTo(Y.point):-1},lengthSquared:function(){var Y=this.head(),le=this.tail();return null!==le?le.point.distanceToSquared(Y.point):-1},setTwin:function(Y){return this.twin=Y,Y.twin=this,this}}),Object.assign(H.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(Y,le){return le.prev=Y.prev,le.next=Y,null===le.prev?this.head=le:le.prev.next=le,Y.prev=le,this},insertAfter:function(Y,le){return le.prev=Y,le.next=Y.next,null===le.next?this.tail=le:le.next.prev=le,Y.next=le,this},append:function(Y){return null===this.head?this.head=Y:this.tail.next=Y,Y.prev=this.tail,Y.next=null,this.tail=Y,this},appendChain:function(Y){for(null===this.head?this.head=Y:this.tail.next=Y,Y.prev=this.tail;null!==Y.next;)Y=Y.next;return this.tail=Y,this},remove:function(Y){return null===Y.prev?this.head=Y.next:Y.prev.next=Y.next,null===Y.next?this.tail=Y.prev:Y.next.prev=Y.prev,this},removeSubList:function(Y,le){return null===Y.prev?this.head=le.next:Y.prev.next=le.next,null===le.next?this.tail=Y.prev:le.next.prev=Y.prev,this},isEmpty:function(){return null===this.head}}),b}();function Si(){}function yr(){}Si.Type={BOX:"Box",CYLINDER:"Cylinder",SPHERE:"Sphere",HULL:"ConvexPolyhedron"},Si.createShape=function(a,r){if(void 0!==r)return r===Si.Type.BOX?Si.createBoundingBoxShape(a):r===Si.Type.CYLINDER?Si.createBoundingCylinderShape(a):r===Si.Type.SPHERE?Si.createBoundingSphereShape(a):r===Si.Type.HULL?Si.createConvexPolyhedron(a):null;var h=Si.getGeometry(a);if(!h)return null;switch(h.type){case"BoxGeometry":case"BoxBufferGeometry":default:return Si.createBoxShape(h);case"CylinderGeometry":case"CylinderBufferGeometry":return Si.createCylinderShape(h);case"PlaneGeometry":case"PlaneBufferGeometry":return Si.createPlaneShape(h);case"SphereGeometry":case"SphereBufferGeometry":return Si.createSphereShape(h);case"TubeGeometry":return Si.createTubeShape(h);case"Geometry":case"BufferGeometry":return Si.createConvexPolyhedron(a)}},Si.createBoxShape=function(a){if(!Si.getVertices(a).length)return null;a.computeBoundingBox();var r=a.boundingBox;return new je(new M((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2))},Si.createBoundingBoxShape=function(a){var r=new Box3;if(r.setFromObject(a),!isFinite(r.min.lengthSq()))return null;var h=new je(new M((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2));return a.updateMatrixWorld(),(new l.Vector3).setFromMatrixPosition(a.matrixWorld),h},Si.createConvexPolyhedron=function(a){var r=new Rh;r.setFromObject(a);for(var h=[],d=[],y=[],b=0;b<r.faces.length;b++){var N=r.faces[b],k=N.edge;do{var T=k.head().point;h.push(new M(T.x,T.y,T.z)),k=k.next}while(k!==N.edge);d.push([h.length-3,h.length-2,h.length-1]),y.push(new M(N.normal.x,N.normal.y,N.normal.z))}return new K(h,d,y)},Si.createCylinderShape=function(a){var r=a.parameters,h=new Yt(r.radiusTop,r.radiusBottom,r.height,r.radialSegments);return h.orientation=new Q,h.orientation.setFromEuler(0,0,0,"XYZ").normalize(),h},Si.createBoundingCylinderShape=function(a){var r=["x","y","z"],h=r.splice(r.indexOf("y"),1)&&r,d=Si.getGeometry(a);d.computeBoundingBox(),d.computeBoundingSphere();var y=d.boundingBox.max.y-d.boundingBox.min.y,b=.5*Math.max(d.boundingBox.max[h[0]]-d.boundingBox.min[h[0]],d.boundingBox.max[h[1]]-d.boundingBox.min[h[1]]),N=new Yt(b,b,y,12);return N.orientation=new Q,N.orientation.setFromEuler(Math.PI/2,0,0,"XYZ").normalize(),N},Si.createPlaneShape=function(a){a.computeBoundingBox();var r=a.boundingBox;return new je(new M((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2))},Si.createSphereShape=function(a){return new mc(a.parameters.radius)},Si.createBoundingSphereShape=function(a){var r=Si.getGeometry(a);return r.computeBoundingSphere(),new mc(r.boundingSphere.radius)},Si.createTubeShape=function(a){var r=new l.BufferGeometry;return r.fromGeometry(a),createTrimeshShape(r)},Si.createTrimeshShape=function(a){var r=Si.getVertices(a);if(!r||0===r.length)return null;var h=Object.keys(r).map(Number);return new il(r,h)},Si.getGeometry=function(a){var r=Si.getMeshes(a);if(0===r.length)return null;var h=new l.Geometry;if(1===r.length){var d=new l.Vector3,y=new l.Quaternion,b=new l.Vector3(1,1,1);return h=r[0].geometry.clone(),r[0].updateMatrixWorld(),r[0].matrixWorld.decompose(d,y,b),h.scale(b.x,b.y,b.z)}for(var N=new l.Geometry,k=r.pop();void 0!==k;)k.updateMatrixWorld(),k.geometry instanceof l.BufferGeometry?(h.fromBufferGeometry(k.geometry),N.merge(h,k.matrixWorld)):N.merge(k.geometry,k.matrixWorld),k=r.pop();var T=new l.Matrix4;return T.scale(a.scale),N.applyMatrix4(T),N},Si.getVertices=function(a){return a instanceof l.Geometry&&(a=(new l.BufferGeometry).fromGeometry(a)),a.attributes.position.array},Si.getMeshes=function(a){var r=[];return a.traverse(function(h){h instanceof l.Mesh&&r.push(h)}),r},yr.scales=new Map([["Y",1e24],["Z",1e21],["E",1e18],["P",1e15],["T",1e12],["G",1e9],["M",1e6],["k",1e3],["m",.001],["u",1e-6],["n",1e-9],["p",1e-12],["f",1e-15],["a",1e-18],["z",1e-21],["y",1e-24]]),yr.units=new Map([["m",new Map([["i",function(a){return a/39.3701}]])],["i",new Map([["m",function(a){return 39.3701*a}]])],["g",null],["s",null],["c",new Map([["k",function(a){return a-273.15}],["f",function(a){return(a-32)/1.8}]])],["k",new Map([["c",function(a){return a+273.15}],["f",function(a){return(a-32)/1.8+273.15}]])],["f",new Map([["c",function(a){return 1.8*a+32}],["k",function(a){return 1.8*a-459.67}]])],["d",new Map([["r",function(a){return a*(180/Math.PI)}]])],["r",new Map([["d",function(a){return a/(180/Math.PI)}]])]]),yr.convert=function(a,r,h){r.length>1&&(a*=yr.scales.get(r.charAt(0)),r=r.slice(1));var d=1;return h.length>1&&(d=yr.scales.get(h.charAt(0)),h=h.slice(1)),r===h?a/d:yr.units.get(h).get(r)(a)/d}})(),__webpack_exports__})()),function(n,o){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=n.document?o(n,!0):function(l){if(!l.document)throw new Error("jQuery requires a window with a document");return o(l)}:o(n)}(typeof window<"u"?window:this,function(n,o){"use strict";var l=[],x=Object.getPrototypeOf,B=l.slice,D=l.flat?function(q){return l.flat.call(q)}:function(q){return l.concat.apply([],q)},G=l.push,M=l.indexOf,P={},fe=P.toString,ye=P.hasOwnProperty,ne=ye.toString,ue=ne.call(Object),me={},ie=function(pe){return"function"==typeof pe&&"number"!=typeof pe.nodeType},W=function(pe){return null!=pe&&pe===pe.window},Q=n.document,A={type:!0,src:!0,nonce:!0,noModule:!0};function R(q,pe,Ee){var Ce,He,Ve=(Ee=Ee||Q).createElement("script");if(Ve.text=q,pe)for(Ce in A)(He=pe[Ce]||pe.getAttribute&&pe.getAttribute(Ce))&&Ve.setAttribute(Ce,He);Ee.head.appendChild(Ve).parentNode.removeChild(Ve)}function X(q){return null==q?q+"":"object"==typeof q||"function"==typeof q?P[fe.call(q)]||"object":typeof q}var z=function(q,pe){return new z.fn.init(q,pe)};function Le(q){var pe=!!q&&"length"in q&&q.length,Ee=X(q);return!ie(q)&&!W(q)&&("array"===Ee||0===pe||"number"==typeof pe&&pe>0&&pe-1 in q)}z.fn=z.prototype={jquery:"3.5.1",constructor:z,length:0,toArray:function(){return B.call(this)},get:function(q){return null==q?B.call(this):q<0?this[q+this.length]:this[q]},pushStack:function(q){var pe=z.merge(this.constructor(),q);return pe.prevObject=this,pe},each:function(q){return z.each(this,q)},map:function(q){return this.pushStack(z.map(this,function(pe,Ee){return q.call(pe,Ee,pe)}))},slice:function(){return this.pushStack(B.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(z.grep(this,function(q,pe){return(pe+1)%2}))},odd:function(){return this.pushStack(z.grep(this,function(q,pe){return pe%2}))},eq:function(q){var pe=this.length,Ee=+q+(q<0?pe:0);return this.pushStack(Ee>=0&&Ee<pe?[this[Ee]]:[])},end:function(){return this.prevObject||this.constructor()},push:G,sort:l.sort,splice:l.splice},z.extend=z.fn.extend=function(){var q,pe,Ee,Ce,He,Ve,et=arguments[0]||{},Et=1,At=arguments.length,Yt=!1;for("boolean"==typeof et&&(Yt=et,et=arguments[Et]||{},Et++),"object"!=typeof et&&!ie(et)&&(et={}),Et===At&&(et=this,Et--);Et<At;Et++)if(null!=(q=arguments[Et]))for(pe in q)Ce=q[pe],"__proto__"!==pe&&et!==Ce&&(Yt&&Ce&&(z.isPlainObject(Ce)||(He=Array.isArray(Ce)))?(Ee=et[pe],Ve=He&&!Array.isArray(Ee)?[]:He||z.isPlainObject(Ee)?Ee:{},He=!1,et[pe]=z.extend(Yt,Ve,Ce)):void 0!==Ce&&(et[pe]=Ce));return et},z.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(q){throw new Error(q)},noop:function(){},isPlainObject:function(q){var pe,Ee;return!(!q||"[object Object]"!==fe.call(q)||(pe=x(q))&&("function"!=typeof(Ee=ye.call(pe,"constructor")&&pe.constructor)||ne.call(Ee)!==ue))},isEmptyObject:function(q){var pe;for(pe in q)return!1;return!0},globalEval:function(q,pe,Ee){R(q,{nonce:pe&&pe.nonce},Ee)},each:function(q,pe){var Ee,Ce=0;if(Le(q))for(Ee=q.length;Ce<Ee&&!1!==pe.call(q[Ce],Ce,q[Ce]);Ce++);else for(Ce in q)if(!1===pe.call(q[Ce],Ce,q[Ce]))break;return q},makeArray:function(q,pe){var Ee=pe||[];return null!=q&&(Le(Object(q))?z.merge(Ee,"string"==typeof q?[q]:q):G.call(Ee,q)),Ee},inArray:function(q,pe,Ee){return null==pe?-1:M.call(pe,q,Ee)},merge:function(q,pe){for(var Ee=+pe.length,Ce=0,He=q.length;Ce<Ee;Ce++)q[He++]=pe[Ce];return q.length=He,q},grep:function(q,pe,Ee){for(var He=[],Ve=0,et=q.length,Et=!Ee;Ve<et;Ve++)!pe(q[Ve],Ve)!==Et&&He.push(q[Ve]);return He},map:function(q,pe,Ee){var Ce,He,Ve=0,et=[];if(Le(q))for(Ce=q.length;Ve<Ce;Ve++)null!=(He=pe(q[Ve],Ve,Ee))&&et.push(He);else for(Ve in q)null!=(He=pe(q[Ve],Ve,Ee))&&et.push(He);return D(et)},guid:1,support:me}),"function"==typeof Symbol&&(z.fn[Symbol.iterator]=l[Symbol.iterator]),z.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(q,pe){P["[object "+pe+"]"]=pe.toLowerCase()});var K=
/*!
     * Sizzle CSS Selector Engine v2.3.5
     * https://sizzlejs.com/
     *
     * Copyright JS Foundation and other contributors
     * Released under the MIT license
     * https://js.foundation/
     *
     * Date: 2020-03-14
     */function(q){var pe,Ee,Ce,He,Ve,et,Et,At,Yt,dn,kn,nn,wn,wr,ei,Tr,vs,Qo,aa,yi="sizzle"+1*new Date,Lr=q.document,Da=0,Vi=0,Xi=Ua(),Hh=Ua(),_c=Ua(),la=Ua(),il=function(tt,bt){return tt===bt&&(kn=!0),0},ca={}.hasOwnProperty,ki=[],Os=ki.pop,er=ki.push,Sn=ki.push,jo=ki.slice,ss=function(tt,bt){for(var kt=0,yn=tt.length;kt<yn;kt++)if(tt[kt]===bt)return kt;return-1},eo="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Gr="[\\x20\\t\\r\\n\\f]",di="(?:\\\\[\\da-fA-F]{1,6}"+Gr+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",bi="\\["+Gr+"*("+di+")(?:"+Gr+"*([*^$|!~]?=)"+Gr+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+di+"))|)"+Gr+"*\\]",ks=":("+di+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+bi+")*)|.*)\\)|)",Vh=new RegExp(Gr+"+","g"),So=new RegExp("^"+Gr+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Gr+"+$","g"),_u=new RegExp("^"+Gr+"*,"+Gr+"*"),Un=new RegExp("^"+Gr+"*([>+~]|"+Gr+")"+Gr+"*"),ot=new RegExp(Gr+"|>"),Sl=new RegExp(ks),Ms=new RegExp("^"+di+"$"),Ep={ID:new RegExp("^#("+di+")"),CLASS:new RegExp("^\\.("+di+")"),TAG:new RegExp("^("+di+"|[*])"),ATTR:new RegExp("^"+bi),PSEUDO:new RegExp("^"+ks),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Gr+"*(even|odd|(([+-]|)(\\d*)n|)"+Gr+"*(?:([+-]|)"+Gr+"*(\\d+)|))"+Gr+"*\\)|)","i"),bool:new RegExp("^(?:"+eo+")$","i"),needsContext:new RegExp("^"+Gr+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Gr+"*((?:-\\d)?\\d*)"+Gr+"*\\)|)(?=[^-]|$)","i")},As=/HTML$/i,vc=/^(?:input|select|textarea|button)$/i,ji=/^h\d$/i,lo=/^[^{]+\{\s*\[native \w/,ni=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Vc=/[+~]/,Ci=new RegExp("\\\\[\\da-fA-F]{1,6}"+Gr+"?|\\\\([^\\r\\n\\f])","g"),at=function(tt,bt){var kt="0x"+tt.slice(1)-65536;return bt||(kt<0?String.fromCharCode(kt+65536):String.fromCharCode(kt>>10|55296,1023&kt|56320))},gu=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Tp=function(tt,bt){return bt?"\0"===tt?"\ufffd":tt.slice(0,-1)+"\\"+tt.charCodeAt(tt.length-1).toString(16)+" ":"\\"+tt},Gi=function(){nn()},kr=xa(function(tt){return!0===tt.disabled&&"fieldset"===tt.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{Sn.apply(ki=jo.call(Lr.childNodes),Lr.childNodes)}catch{Sn={apply:ki.length?function(bt,kt){er.apply(bt,jo.call(kt))}:function(bt,kt){for(var yn=bt.length,Xt=0;bt[yn++]=kt[Xt++];);bt.length=yn-1}}}function Wr(tt,bt,kt,yn){var Xt,mn,Kt,qn,zn,xr,Mr,_r=bt&&bt.ownerDocument,qr=bt?bt.nodeType:9;if(kt=kt||[],"string"!=typeof tt||!tt||1!==qr&&9!==qr&&11!==qr)return kt;if(!yn&&(nn(bt),bt=bt||wn,ei)){if(11!==qr&&(zn=ni.exec(tt)))if(Xt=zn[1]){if(9===qr){if(!(Kt=bt.getElementById(Xt)))return kt;if(Kt.id===Xt)return kt.push(Kt),kt}else if(_r&&(Kt=_r.getElementById(Xt))&&aa(bt,Kt)&&Kt.id===Xt)return kt.push(Kt),kt}else{if(zn[2])return Sn.apply(kt,bt.getElementsByTagName(tt)),kt;if((Xt=zn[3])&&Ee.getElementsByClassName&&bt.getElementsByClassName)return Sn.apply(kt,bt.getElementsByClassName(Xt)),kt}if(Ee.qsa&&!la[tt+" "]&&(!Tr||!Tr.test(tt))&&(1!==qr||"object"!==bt.nodeName.toLowerCase())){if(Mr=tt,_r=bt,1===qr&&(ot.test(tt)||Un.test(tt))){for(((_r=Vc.test(tt)&&Zn(bt.parentNode)||bt)!==bt||!Ee.scope)&&((qn=bt.getAttribute("id"))?qn=qn.replace(gu,Tp):bt.setAttribute("id",qn=yi)),mn=(xr=et(tt)).length;mn--;)xr[mn]=(qn?"#"+qn:":scope")+" "+za(xr[mn]);Mr=xr.join(",")}try{return Sn.apply(kt,_r.querySelectorAll(Mr)),kt}catch{la(tt,!0)}finally{qn===yi&&bt.removeAttribute("id")}}}return At(tt.replace(So,"$1"),bt,kt,yn)}function Ua(){var tt=[];return function bt(kt,yn){return tt.push(kt+" ")>Ce.cacheLength&&delete bt[tt.shift()],bt[kt+" "]=yn}}function Eo(tt){return tt[yi]=!0,tt}function ua(tt){var bt=wn.createElement("fieldset");try{return!!tt(bt)}catch{return!1}finally{bt.parentNode&&bt.parentNode.removeChild(bt),bt=null}}function vu(tt,bt){for(var kt=tt.split("|"),yn=kt.length;yn--;)Ce.attrHandle[kt[yn]]=bt}function yc(tt,bt){var kt=bt&&tt,yn=kt&&1===tt.nodeType&&1===bt.nodeType&&tt.sourceIndex-bt.sourceIndex;if(yn)return yn;if(kt)for(;kt=kt.nextSibling;)if(kt===bt)return-1;return tt?1:-1}function Wc(tt){return function(bt){return"input"===bt.nodeName.toLowerCase()&&bt.type===tt}}function yu(tt){return function(bt){var kt=bt.nodeName.toLowerCase();return("input"===kt||"button"===kt)&&bt.type===tt}}function gh(tt){return function(bt){return"form"in bt?bt.parentNode&&!1===bt.disabled?"label"in bt?"label"in bt.parentNode?bt.parentNode.disabled===tt:bt.disabled===tt:bt.isDisabled===tt||bt.isDisabled!==!tt&&kr(bt)===tt:bt.disabled===tt:"label"in bt&&bt.disabled===tt}}function bc(tt){return Eo(function(bt){return bt=+bt,Eo(function(kt,yn){for(var Xt,mn=tt([],kt.length,bt),Kt=mn.length;Kt--;)kt[Xt=mn[Kt]]&&(kt[Xt]=!(yn[Xt]=kt[Xt]))})})}function Zn(tt){return tt&&typeof tt.getElementsByTagName<"u"&&tt}for(pe in Ee=Wr.support={},Ve=Wr.isXML=function(tt){var kt=(tt.ownerDocument||tt).documentElement;return!As.test(tt.namespaceURI||kt&&kt.nodeName||"HTML")},nn=Wr.setDocument=function(tt){var bt,kt,yn=tt?tt.ownerDocument||tt:Lr;return yn==wn||9!==yn.nodeType||!yn.documentElement||(wr=(wn=yn).documentElement,ei=!Ve(wn),Lr!=wn&&(kt=wn.defaultView)&&kt.top!==kt&&(kt.addEventListener?kt.addEventListener("unload",Gi,!1):kt.attachEvent&&kt.attachEvent("onunload",Gi)),Ee.scope=ua(function(Xt){return wr.appendChild(Xt).appendChild(wn.createElement("div")),typeof Xt.querySelectorAll<"u"&&!Xt.querySelectorAll(":scope fieldset div").length}),Ee.attributes=ua(function(Xt){return Xt.className="i",!Xt.getAttribute("className")}),Ee.getElementsByTagName=ua(function(Xt){return Xt.appendChild(wn.createComment("")),!Xt.getElementsByTagName("*").length}),Ee.getElementsByClassName=lo.test(wn.getElementsByClassName),Ee.getById=ua(function(Xt){return wr.appendChild(Xt).id=yi,!wn.getElementsByName||!wn.getElementsByName(yi).length}),Ee.getById?(Ce.filter.ID=function(Xt){var mn=Xt.replace(Ci,at);return function(Kt){return Kt.getAttribute("id")===mn}},Ce.find.ID=function(Xt,mn){if(typeof mn.getElementById<"u"&&ei){var Kt=mn.getElementById(Xt);return Kt?[Kt]:[]}}):(Ce.filter.ID=function(Xt){var mn=Xt.replace(Ci,at);return function(Kt){var qn=typeof Kt.getAttributeNode<"u"&&Kt.getAttributeNode("id");return qn&&qn.value===mn}},Ce.find.ID=function(Xt,mn){if(typeof mn.getElementById<"u"&&ei){var Kt,qn,zn,xr=mn.getElementById(Xt);if(xr){if((Kt=xr.getAttributeNode("id"))&&Kt.value===Xt)return[xr];for(zn=mn.getElementsByName(Xt),qn=0;xr=zn[qn++];)if((Kt=xr.getAttributeNode("id"))&&Kt.value===Xt)return[xr]}return[]}}),Ce.find.TAG=Ee.getElementsByTagName?function(Xt,mn){return typeof mn.getElementsByTagName<"u"?mn.getElementsByTagName(Xt):Ee.qsa?mn.querySelectorAll(Xt):void 0}:function(Xt,mn){var Kt,qn=[],zn=0,xr=mn.getElementsByTagName(Xt);if("*"===Xt){for(;Kt=xr[zn++];)1===Kt.nodeType&&qn.push(Kt);return qn}return xr},Ce.find.CLASS=Ee.getElementsByClassName&&function(Xt,mn){if(typeof mn.getElementsByClassName<"u"&&ei)return mn.getElementsByClassName(Xt)},vs=[],Tr=[],(Ee.qsa=lo.test(wn.querySelectorAll))&&(ua(function(Xt){var mn;wr.appendChild(Xt).innerHTML="<a id='"+yi+"'></a><select id='"+yi+"-\r\\' msallowcapture=''><option selected=''></option></select>",Xt.querySelectorAll("[msallowcapture^='']").length&&Tr.push("[*^$]="+Gr+"*(?:''|\"\")"),Xt.querySelectorAll("[selected]").length||Tr.push("\\["+Gr+"*(?:value|"+eo+")"),Xt.querySelectorAll("[id~="+yi+"-]").length||Tr.push("~="),(mn=wn.createElement("input")).setAttribute("name",""),Xt.appendChild(mn),Xt.querySelectorAll("[name='']").length||Tr.push("\\["+Gr+"*name"+Gr+"*="+Gr+"*(?:''|\"\")"),Xt.querySelectorAll(":checked").length||Tr.push(":checked"),Xt.querySelectorAll("a#"+yi+"+*").length||Tr.push(".#.+[+~]"),Xt.querySelectorAll("\\\f"),Tr.push("[\\r\\n\\f]")}),ua(function(Xt){Xt.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var mn=wn.createElement("input");mn.setAttribute("type","hidden"),Xt.appendChild(mn).setAttribute("name","D"),Xt.querySelectorAll("[name=d]").length&&Tr.push("name"+Gr+"*[*^$|!~]?="),2!==Xt.querySelectorAll(":enabled").length&&Tr.push(":enabled",":disabled"),wr.appendChild(Xt).disabled=!0,2!==Xt.querySelectorAll(":disabled").length&&Tr.push(":enabled",":disabled"),Xt.querySelectorAll("*,:x"),Tr.push(",.*:")})),(Ee.matchesSelector=lo.test(Qo=wr.matches||wr.webkitMatchesSelector||wr.mozMatchesSelector||wr.oMatchesSelector||wr.msMatchesSelector))&&ua(function(Xt){Ee.disconnectedMatch=Qo.call(Xt,"*"),Qo.call(Xt,"[s!='']:x"),vs.push("!=",ks)}),Tr=Tr.length&&new RegExp(Tr.join("|")),vs=vs.length&&new RegExp(vs.join("|")),bt=lo.test(wr.compareDocumentPosition),aa=bt||lo.test(wr.contains)?function(Xt,mn){var Kt=9===Xt.nodeType?Xt.documentElement:Xt,qn=mn&&mn.parentNode;return Xt===qn||!(!qn||1!==qn.nodeType||!(Kt.contains?Kt.contains(qn):Xt.compareDocumentPosition&&16&Xt.compareDocumentPosition(qn)))}:function(Xt,mn){if(mn)for(;mn=mn.parentNode;)if(mn===Xt)return!0;return!1},il=bt?function(Xt,mn){if(Xt===mn)return kn=!0,0;var Kt=!Xt.compareDocumentPosition-!mn.compareDocumentPosition;return Kt||(1&(Kt=(Xt.ownerDocument||Xt)==(mn.ownerDocument||mn)?Xt.compareDocumentPosition(mn):1)||!Ee.sortDetached&&mn.compareDocumentPosition(Xt)===Kt?Xt==wn||Xt.ownerDocument==Lr&&aa(Lr,Xt)?-1:mn==wn||mn.ownerDocument==Lr&&aa(Lr,mn)?1:dn?ss(dn,Xt)-ss(dn,mn):0:4&Kt?-1:1)}:function(Xt,mn){if(Xt===mn)return kn=!0,0;var Kt,qn=0,zn=Xt.parentNode,xr=mn.parentNode,Mr=[Xt],_r=[mn];if(!zn||!xr)return Xt==wn?-1:mn==wn?1:zn?-1:xr?1:dn?ss(dn,Xt)-ss(dn,mn):0;if(zn===xr)return yc(Xt,mn);for(Kt=Xt;Kt=Kt.parentNode;)Mr.unshift(Kt);for(Kt=mn;Kt=Kt.parentNode;)_r.unshift(Kt);for(;Mr[qn]===_r[qn];)qn++;return qn?yc(Mr[qn],_r[qn]):Mr[qn]==Lr?-1:_r[qn]==Lr?1:0}),wn},Wr.matches=function(tt,bt){return Wr(tt,null,null,bt)},Wr.matchesSelector=function(tt,bt){if(nn(tt),Ee.matchesSelector&&ei&&!la[bt+" "]&&(!vs||!vs.test(bt))&&(!Tr||!Tr.test(bt)))try{var kt=Qo.call(tt,bt);if(kt||Ee.disconnectedMatch||tt.document&&11!==tt.document.nodeType)return kt}catch{la(bt,!0)}return Wr(bt,wn,null,[tt]).length>0},Wr.contains=function(tt,bt){return(tt.ownerDocument||tt)!=wn&&nn(tt),aa(tt,bt)},Wr.attr=function(tt,bt){(tt.ownerDocument||tt)!=wn&&nn(tt);var kt=Ce.attrHandle[bt.toLowerCase()],yn=kt&&ca.call(Ce.attrHandle,bt.toLowerCase())?kt(tt,bt,!ei):void 0;return void 0!==yn?yn:Ee.attributes||!ei?tt.getAttribute(bt):(yn=tt.getAttributeNode(bt))&&yn.specified?yn.value:null},Wr.escape=function(tt){return(tt+"").replace(gu,Tp)},Wr.error=function(tt){throw new Error("Syntax error, unrecognized expression: "+tt)},Wr.uniqueSort=function(tt){var bt,kt=[],yn=0,Xt=0;if(kn=!Ee.detectDuplicates,dn=!Ee.sortStable&&tt.slice(0),tt.sort(il),kn){for(;bt=tt[Xt++];)bt===tt[Xt]&&(yn=kt.push(Xt));for(;yn--;)tt.splice(kt[yn],1)}return dn=null,tt},He=Wr.getText=function(tt){var bt,kt="",yn=0,Xt=tt.nodeType;if(Xt){if(1===Xt||9===Xt||11===Xt){if("string"==typeof tt.textContent)return tt.textContent;for(tt=tt.firstChild;tt;tt=tt.nextSibling)kt+=He(tt)}else if(3===Xt||4===Xt)return tt.nodeValue}else for(;bt=tt[yn++];)kt+=He(bt);return kt},(Ce=Wr.selectors={cacheLength:50,createPseudo:Eo,match:Ep,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(tt){return tt[1]=tt[1].replace(Ci,at),tt[3]=(tt[3]||tt[4]||tt[5]||"").replace(Ci,at),"~="===tt[2]&&(tt[3]=" "+tt[3]+" "),tt.slice(0,4)},CHILD:function(tt){return tt[1]=tt[1].toLowerCase(),"nth"===tt[1].slice(0,3)?(tt[3]||Wr.error(tt[0]),tt[4]=+(tt[4]?tt[5]+(tt[6]||1):2*("even"===tt[3]||"odd"===tt[3])),tt[5]=+(tt[7]+tt[8]||"odd"===tt[3])):tt[3]&&Wr.error(tt[0]),tt},PSEUDO:function(tt){var bt,kt=!tt[6]&&tt[2];return Ep.CHILD.test(tt[0])?null:(tt[3]?tt[2]=tt[4]||tt[5]||"":kt&&Sl.test(kt)&&(bt=et(kt,!0))&&(bt=kt.indexOf(")",kt.length-bt)-kt.length)&&(tt[0]=tt[0].slice(0,bt),tt[2]=kt.slice(0,bt)),tt.slice(0,3))}},filter:{TAG:function(tt){var bt=tt.replace(Ci,at).toLowerCase();return"*"===tt?function(){return!0}:function(kt){return kt.nodeName&&kt.nodeName.toLowerCase()===bt}},CLASS:function(tt){var bt=Xi[tt+" "];return bt||(bt=new RegExp("(^|"+Gr+")"+tt+"("+Gr+"|$)"))&&Xi(tt,function(kt){return bt.test("string"==typeof kt.className&&kt.className||typeof kt.getAttribute<"u"&&kt.getAttribute("class")||"")})},ATTR:function(tt,bt,kt){return function(yn){var Xt=Wr.attr(yn,tt);return null==Xt?"!="===bt:!bt||(Xt+="","="===bt?Xt===kt:"!="===bt?Xt!==kt:"^="===bt?kt&&0===Xt.indexOf(kt):"*="===bt?kt&&Xt.indexOf(kt)>-1:"$="===bt?kt&&Xt.slice(-kt.length)===kt:"~="===bt?(" "+Xt.replace(Vh," ")+" ").indexOf(kt)>-1:"|="===bt&&(Xt===kt||Xt.slice(0,kt.length+1)===kt+"-"))}},CHILD:function(tt,bt,kt,yn,Xt){var mn="nth"!==tt.slice(0,3),Kt="last"!==tt.slice(-4),qn="of-type"===bt;return 1===yn&&0===Xt?function(zn){return!!zn.parentNode}:function(zn,xr,Mr){var _r,qr,fi,Rr,Ko,_o,Xs=mn!==Kt?"nextSibling":"previousSibling",Io=zn.parentNode,Yl=qn&&zn.nodeName.toLowerCase(),Xo=!Mr&&!qn,Yi=!1;if(Io){if(mn){for(;Xs;){for(Rr=zn;Rr=Rr[Xs];)if(qn?Rr.nodeName.toLowerCase()===Yl:1===Rr.nodeType)return!1;_o=Xs="only"===tt&&!_o&&"nextSibling"}return!0}if(_o=[Kt?Io.firstChild:Io.lastChild],Kt&&Xo){for(Yi=(Ko=(_r=(qr=(fi=(Rr=Io)[yi]||(Rr[yi]={}))[Rr.uniqueID]||(fi[Rr.uniqueID]={}))[tt]||[])[0]===Da&&_r[1])&&_r[2],Rr=Ko&&Io.childNodes[Ko];Rr=++Ko&&Rr&&Rr[Xs]||(Yi=Ko=0)||_o.pop();)if(1===Rr.nodeType&&++Yi&&Rr===zn){qr[tt]=[Da,Ko,Yi];break}}else if(Xo&&(Yi=Ko=(_r=(qr=(fi=(Rr=zn)[yi]||(Rr[yi]={}))[Rr.uniqueID]||(fi[Rr.uniqueID]={}))[tt]||[])[0]===Da&&_r[1]),!1===Yi)for(;(Rr=++Ko&&Rr&&Rr[Xs]||(Yi=Ko=0)||_o.pop())&&((qn?Rr.nodeName.toLowerCase()!==Yl:1!==Rr.nodeType)||!++Yi||(Xo&&((qr=(fi=Rr[yi]||(Rr[yi]={}))[Rr.uniqueID]||(fi[Rr.uniqueID]={}))[tt]=[Da,Yi]),Rr!==zn)););return(Yi-=Xt)===yn||Yi%yn==0&&Yi/yn>=0}}},PSEUDO:function(tt,bt){var kt,yn=Ce.pseudos[tt]||Ce.setFilters[tt.toLowerCase()]||Wr.error("unsupported pseudo: "+tt);return yn[yi]?yn(bt):yn.length>1?(kt=[tt,tt,"",bt],Ce.setFilters.hasOwnProperty(tt.toLowerCase())?Eo(function(Xt,mn){for(var Kt,qn=yn(Xt,bt),zn=qn.length;zn--;)Xt[Kt=ss(Xt,qn[zn])]=!(mn[Kt]=qn[zn])}):function(Xt){return yn(Xt,0,kt)}):yn}},pseudos:{not:Eo(function(tt){var bt=[],kt=[],yn=Et(tt.replace(So,"$1"));return yn[yi]?Eo(function(Xt,mn,Kt,qn){for(var zn,xr=yn(Xt,null,qn,[]),Mr=Xt.length;Mr--;)(zn=xr[Mr])&&(Xt[Mr]=!(mn[Mr]=zn))}):function(Xt,mn,Kt){return bt[0]=Xt,yn(bt,null,Kt,kt),bt[0]=null,!kt.pop()}}),has:Eo(function(tt){return function(bt){return Wr(tt,bt).length>0}}),contains:Eo(function(tt){return tt=tt.replace(Ci,at),function(bt){return(bt.textContent||He(bt)).indexOf(tt)>-1}}),lang:Eo(function(tt){return Ms.test(tt||"")||Wr.error("unsupported lang: "+tt),tt=tt.replace(Ci,at).toLowerCase(),function(bt){var kt;do{if(kt=ei?bt.lang:bt.getAttribute("xml:lang")||bt.getAttribute("lang"))return(kt=kt.toLowerCase())===tt||0===kt.indexOf(tt+"-")}while((bt=bt.parentNode)&&1===bt.nodeType);return!1}}),target:function(tt){var bt=q.location&&q.location.hash;return bt&&bt.slice(1)===tt.id},root:function(tt){return tt===wr},focus:function(tt){return tt===wn.activeElement&&(!wn.hasFocus||wn.hasFocus())&&!!(tt.type||tt.href||~tt.tabIndex)},enabled:gh(!1),disabled:gh(!0),checked:function(tt){var bt=tt.nodeName.toLowerCase();return"input"===bt&&!!tt.checked||"option"===bt&&!!tt.selected},selected:function(tt){return!0===tt.selected},empty:function(tt){for(tt=tt.firstChild;tt;tt=tt.nextSibling)if(tt.nodeType<6)return!1;return!0},parent:function(tt){return!Ce.pseudos.empty(tt)},header:function(tt){return ji.test(tt.nodeName)},input:function(tt){return vc.test(tt.nodeName)},button:function(tt){var bt=tt.nodeName.toLowerCase();return"input"===bt&&"button"===tt.type||"button"===bt},text:function(tt){var bt;return"input"===tt.nodeName.toLowerCase()&&"text"===tt.type&&(null==(bt=tt.getAttribute("type"))||"text"===bt.toLowerCase())},first:bc(function(){return[0]}),last:bc(function(tt,bt){return[bt-1]}),eq:bc(function(tt,bt,kt){return[kt<0?kt+bt:kt]}),even:bc(function(tt,bt){for(var kt=0;kt<bt;kt+=2)tt.push(kt);return tt}),odd:bc(function(tt,bt){for(var kt=1;kt<bt;kt+=2)tt.push(kt);return tt}),lt:bc(function(tt,bt,kt){for(var yn=kt<0?kt+bt:kt>bt?bt:kt;--yn>=0;)tt.push(yn);return tt}),gt:bc(function(tt,bt,kt){for(var yn=kt<0?kt+bt:kt;++yn<bt;)tt.push(yn);return tt})}}).pseudos.nth=Ce.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Ce.pseudos[pe]=Wc(pe);for(pe in{submit:!0,reset:!0})Ce.pseudos[pe]=yu(pe);function El(){}function za(tt){for(var bt=0,kt=tt.length,yn="";bt<kt;bt++)yn+=tt[bt].value;return yn}function xa(tt,bt,kt){var yn=bt.dir,Xt=bt.next,mn=Xt||yn,Kt=kt&&"parentNode"===mn,qn=Vi++;return bt.first?function(zn,xr,Mr){for(;zn=zn[yn];)if(1===zn.nodeType||Kt)return tt(zn,xr,Mr);return!1}:function(zn,xr,Mr){var _r,qr,fi,Rr=[Da,qn];if(Mr){for(;zn=zn[yn];)if((1===zn.nodeType||Kt)&&tt(zn,xr,Mr))return!0}else for(;zn=zn[yn];)if(1===zn.nodeType||Kt)if(qr=(fi=zn[yi]||(zn[yi]={}))[zn.uniqueID]||(fi[zn.uniqueID]={}),Xt&&Xt===zn.nodeName.toLowerCase())zn=zn[yn]||zn;else{if((_r=qr[mn])&&_r[0]===Da&&_r[1]===qn)return Rr[2]=_r[2];if(qr[mn]=Rr,Rr[2]=tt(zn,xr,Mr))return!0}return!1}}function Xl(tt){return tt.length>1?function(bt,kt,yn){for(var Xt=tt.length;Xt--;)if(!tt[Xt](bt,kt,yn))return!1;return!0}:tt[0]}function wa(tt,bt,kt,yn,Xt){for(var mn,Kt=[],qn=0,zn=tt.length,xr=null!=bt;qn<zn;qn++)(mn=tt[qn])&&(!kt||kt(mn,yn,Xt))&&(Kt.push(mn),xr&&bt.push(qn));return Kt}function To(tt,bt,kt,yn,Xt,mn){return yn&&!yn[yi]&&(yn=To(yn)),Xt&&!Xt[yi]&&(Xt=To(Xt,mn)),Eo(function(Kt,qn,zn,xr){var Mr,_r,qr,fi=[],Rr=[],Ko=qn.length,_o=Kt||function bu(tt,bt,kt){for(var yn=0,Xt=bt.length;yn<Xt;yn++)Wr(tt,bt[yn],kt);return kt}(bt||"*",zn.nodeType?[zn]:zn,[]),Xs=!tt||!Kt&&bt?_o:wa(_o,fi,tt,zn,xr),Io=kt?Xt||(Kt?tt:Ko||yn)?[]:qn:Xs;if(kt&&kt(Xs,Io,zn,xr),yn)for(Mr=wa(Io,Rr),yn(Mr,[],zn,xr),_r=Mr.length;_r--;)(qr=Mr[_r])&&(Io[Rr[_r]]=!(Xs[Rr[_r]]=qr));if(Kt){if(Xt||tt){if(Xt){for(Mr=[],_r=Io.length;_r--;)(qr=Io[_r])&&Mr.push(Xs[_r]=qr);Xt(null,Io=[],Mr,xr)}for(_r=Io.length;_r--;)(qr=Io[_r])&&(Mr=Xt?ss(Kt,qr):fi[_r])>-1&&(Kt[Mr]=!(qn[Mr]=qr))}}else Io=wa(Io===qn?Io.splice(Ko,Io.length):Io),Xt?Xt(null,qn,Io,xr):Sn.apply(qn,Io)})}function Fs(tt){for(var bt,kt,yn,Xt=tt.length,mn=Ce.relative[tt[0].type],Kt=mn||Ce.relative[" "],qn=mn?1:0,zn=xa(function(_r){return _r===bt},Kt,!0),xr=xa(function(_r){return ss(bt,_r)>-1},Kt,!0),Mr=[function(_r,qr,fi){var Rr=!mn&&(fi||qr!==Yt)||((bt=qr).nodeType?zn(_r,qr,fi):xr(_r,qr,fi));return bt=null,Rr}];qn<Xt;qn++)if(kt=Ce.relative[tt[qn].type])Mr=[xa(Xl(Mr),kt)];else{if((kt=Ce.filter[tt[qn].type].apply(null,tt[qn].matches))[yi]){for(yn=++qn;yn<Xt&&!Ce.relative[tt[yn].type];yn++);return To(qn>1&&Xl(Mr),qn>1&&za(tt.slice(0,qn-1).concat({value:" "===tt[qn-2].type?"*":""})).replace(So,"$1"),kt,qn<yn&&Fs(tt.slice(qn,yn)),yn<Xt&&Fs(tt=tt.slice(yn)),yn<Xt&&za(tt))}Mr.push(kt)}return Xl(Mr)}return El.prototype=Ce.filters=Ce.pseudos,Ce.setFilters=new El,et=Wr.tokenize=function(tt,bt){var kt,yn,Xt,mn,Kt,qn,zn,xr=Hh[tt+" "];if(xr)return bt?0:xr.slice(0);for(Kt=tt,qn=[],zn=Ce.preFilter;Kt;){for(mn in(!kt||(yn=_u.exec(Kt)))&&(yn&&(Kt=Kt.slice(yn[0].length)||Kt),qn.push(Xt=[])),kt=!1,(yn=Un.exec(Kt))&&(kt=yn.shift(),Xt.push({value:kt,type:yn[0].replace(So," ")}),Kt=Kt.slice(kt.length)),Ce.filter)(yn=Ep[mn].exec(Kt))&&(!zn[mn]||(yn=zn[mn](yn)))&&(kt=yn.shift(),Xt.push({value:kt,type:mn,matches:yn}),Kt=Kt.slice(kt.length));if(!kt)break}return bt?Kt.length:Kt?Wr.error(tt):Hh(tt,qn).slice(0)},Et=Wr.compile=function(tt,bt){var kt,yn=[],Xt=[],mn=_c[tt+" "];if(!mn){for(bt||(bt=et(tt)),kt=bt.length;kt--;)(mn=Fs(bt[kt]))[yi]?yn.push(mn):Xt.push(mn);mn=_c(tt,function xc(tt,bt){var kt=bt.length>0,yn=tt.length>0,Xt=function(mn,Kt,qn,zn,xr){var Mr,_r,qr,fi=0,Rr="0",Ko=mn&&[],_o=[],Xs=Yt,Io=mn||yn&&Ce.find.TAG("*",xr),Yl=Da+=null==Xs?1:Math.random()||.1,Xo=Io.length;for(xr&&(Yt=Kt==wn||Kt||xr);Rr!==Xo&&null!=(Mr=Io[Rr]);Rr++){if(yn&&Mr){for(_r=0,!Kt&&Mr.ownerDocument!=wn&&(nn(Mr),qn=!ei);qr=tt[_r++];)if(qr(Mr,Kt||wn,qn)){zn.push(Mr);break}xr&&(Da=Yl)}kt&&((Mr=!qr&&Mr)&&fi--,mn&&Ko.push(Mr))}if(fi+=Rr,kt&&Rr!==fi){for(_r=0;qr=bt[_r++];)qr(Ko,_o,Kt,qn);if(mn){if(fi>0)for(;Rr--;)Ko[Rr]||_o[Rr]||(_o[Rr]=Os.call(zn));_o=wa(_o)}Sn.apply(zn,_o),xr&&!mn&&_o.length>0&&fi+bt.length>1&&Wr.uniqueSort(zn)}return xr&&(Da=Yl,Yt=Xs),Ko};return kt?Eo(Xt):Xt}(Xt,yn)),mn.selector=tt}return mn},At=Wr.select=function(tt,bt,kt,yn){var Xt,mn,Kt,qn,zn,xr="function"==typeof tt&&tt,Mr=!yn&&et(tt=xr.selector||tt);if(kt=kt||[],1===Mr.length){if((mn=Mr[0]=Mr[0].slice(0)).length>2&&"ID"===(Kt=mn[0]).type&&9===bt.nodeType&&ei&&Ce.relative[mn[1].type]){if(!(bt=(Ce.find.ID(Kt.matches[0].replace(Ci,at),bt)||[])[0]))return kt;xr&&(bt=bt.parentNode),tt=tt.slice(mn.shift().value.length)}for(Xt=Ep.needsContext.test(tt)?0:mn.length;Xt--&&!Ce.relative[qn=(Kt=mn[Xt]).type];)if((zn=Ce.find[qn])&&(yn=zn(Kt.matches[0].replace(Ci,at),Vc.test(mn[0].type)&&Zn(bt.parentNode)||bt))){if(mn.splice(Xt,1),!(tt=yn.length&&za(mn)))return Sn.apply(kt,yn),kt;break}}return(xr||Et(tt,Mr))(yn,bt,!ei,kt,!bt||Vc.test(tt)&&Zn(bt.parentNode)||bt),kt},Ee.sortStable=yi.split("").sort(il).join("")===yi,Ee.detectDuplicates=!!kn,nn(),Ee.sortDetached=ua(function(tt){return 1&tt.compareDocumentPosition(wn.createElement("fieldset"))}),ua(function(tt){return tt.innerHTML="<a href='#'></a>","#"===tt.firstChild.getAttribute("href")})||vu("type|href|height|width",function(tt,bt,kt){if(!kt)return tt.getAttribute(bt,"type"===bt.toLowerCase()?1:2)}),(!Ee.attributes||!ua(function(tt){return tt.innerHTML="<input/>",tt.firstChild.setAttribute("value",""),""===tt.firstChild.getAttribute("value")}))&&vu("value",function(tt,bt,kt){if(!kt&&"input"===tt.nodeName.toLowerCase())return tt.defaultValue}),ua(function(tt){return null==tt.getAttribute("disabled")})||vu(eo,function(tt,bt,kt){var yn;if(!kt)return!0===tt[bt]?bt.toLowerCase():(yn=tt.getAttributeNode(bt))&&yn.specified?yn.value:null}),Wr}(n);z.find=K,z.expr=K.selectors,z.expr[":"]=z.expr.pseudos,z.uniqueSort=z.unique=K.uniqueSort,z.text=K.getText,z.isXMLDoc=K.isXML,z.contains=K.contains,z.escapeSelector=K.escape;var be=function(q,pe,Ee){for(var Ce=[],He=void 0!==Ee;(q=q[pe])&&9!==q.nodeType;)if(1===q.nodeType){if(He&&z(q).is(Ee))break;Ce.push(q)}return Ce},Ne=function(q,pe){for(var Ee=[];q;q=q.nextSibling)1===q.nodeType&&q!==pe&&Ee.push(q);return Ee},je=z.expr.match.needsContext;function Te(q,pe){return q.nodeName&&q.nodeName.toLowerCase()===pe.toLowerCase()}var qe=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ke(q,pe,Ee){return ie(pe)?z.grep(q,function(Ce,He){return!!pe.call(Ce,He,Ce)!==Ee}):pe.nodeType?z.grep(q,function(Ce){return Ce===pe!==Ee}):"string"!=typeof pe?z.grep(q,function(Ce){return M.call(pe,Ce)>-1!==Ee}):z.filter(pe,q,Ee)}z.filter=function(q,pe,Ee){var Ce=pe[0];return Ee&&(q=":not("+q+")"),1===pe.length&&1===Ce.nodeType?z.find.matchesSelector(Ce,q)?[Ce]:[]:z.find.matches(q,z.grep(pe,function(He){return 1===He.nodeType}))},z.fn.extend({find:function(q){var pe,Ee,Ce=this.length,He=this;if("string"!=typeof q)return this.pushStack(z(q).filter(function(){for(pe=0;pe<Ce;pe++)if(z.contains(He[pe],this))return!0}));for(Ee=this.pushStack([]),pe=0;pe<Ce;pe++)z.find(q,He[pe],Ee);return Ce>1?z.uniqueSort(Ee):Ee},filter:function(q){return this.pushStack(Ke(this,q||[],!1))},not:function(q){return this.pushStack(Ke(this,q||[],!0))},is:function(q){return!!Ke(this,"string"==typeof q&&je.test(q)?z(q):q||[],!1).length}});var vt,ht=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Bt=z.fn.init=function(q,pe,Ee){var Ce,He;if(!q)return this;if(Ee=Ee||vt,"string"==typeof q){if(!(Ce="<"===q[0]&&">"===q[q.length-1]&&q.length>=3?[null,q,null]:ht.exec(q))||!Ce[1]&&pe)return!pe||pe.jquery?(pe||Ee).find(q):this.constructor(pe).find(q);if(Ce[1]){if(z.merge(this,z.parseHTML(Ce[1],(pe=pe instanceof z?pe[0]:pe)&&pe.nodeType?pe.ownerDocument||pe:Q,!0)),qe.test(Ce[1])&&z.isPlainObject(pe))for(Ce in pe)ie(this[Ce])?this[Ce](pe[Ce]):this.attr(Ce,pe[Ce]);return this}return(He=Q.getElementById(Ce[2]))&&(this[0]=He,this.length=1),this}return q.nodeType?(this[0]=q,this.length=1,this):ie(q)?void 0!==Ee.ready?Ee.ready(q):q(z):z.makeArray(q,this)};Bt.prototype=z.fn,vt=z(Q);var wt=/^(?:parents|prev(?:Until|All))/,Ft={children:!0,contents:!0,next:!0,prev:!0};function Ot(q,pe){for(;(q=q[pe])&&1!==q.nodeType;);return q}z.fn.extend({has:function(q){var pe=z(q,this),Ee=pe.length;return this.filter(function(){for(var Ce=0;Ce<Ee;Ce++)if(z.contains(this,pe[Ce]))return!0})},closest:function(q,pe){var Ee,Ce=0,He=this.length,Ve=[],et="string"!=typeof q&&z(q);if(!je.test(q))for(;Ce<He;Ce++)for(Ee=this[Ce];Ee&&Ee!==pe;Ee=Ee.parentNode)if(Ee.nodeType<11&&(et?et.index(Ee)>-1:1===Ee.nodeType&&z.find.matchesSelector(Ee,q))){Ve.push(Ee);break}return this.pushStack(Ve.length>1?z.uniqueSort(Ve):Ve)},index:function(q){return q?"string"==typeof q?M.call(z(q),this[0]):M.call(this,q.jquery?q[0]:q):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(q,pe){return this.pushStack(z.uniqueSort(z.merge(this.get(),z(q,pe))))},addBack:function(q){return this.add(null==q?this.prevObject:this.prevObject.filter(q))}}),z.each({parent:function(q){var pe=q.parentNode;return pe&&11!==pe.nodeType?pe:null},parents:function(q){return be(q,"parentNode")},parentsUntil:function(q,pe,Ee){return be(q,"parentNode",Ee)},next:function(q){return Ot(q,"nextSibling")},prev:function(q){return Ot(q,"previousSibling")},nextAll:function(q){return be(q,"nextSibling")},prevAll:function(q){return be(q,"previousSibling")},nextUntil:function(q,pe,Ee){return be(q,"nextSibling",Ee)},prevUntil:function(q,pe,Ee){return be(q,"previousSibling",Ee)},siblings:function(q){return Ne((q.parentNode||{}).firstChild,q)},children:function(q){return Ne(q.firstChild)},contents:function(q){return null!=q.contentDocument&&x(q.contentDocument)?q.contentDocument:(Te(q,"template")&&(q=q.content||q),z.merge([],q.childNodes))}},function(q,pe){z.fn[q]=function(Ee,Ce){var He=z.map(this,pe,Ee);return"Until"!==q.slice(-5)&&(Ce=Ee),Ce&&"string"==typeof Ce&&(He=z.filter(Ce,He)),this.length>1&&(Ft[q]||z.uniqueSort(He),wt.test(q)&&He.reverse()),this.pushStack(He)}});var on=/[^\x20\t\r\n\f]+/g;function An(q){return q}function Cn(q){throw q}function fn(q,pe,Ee,Ce){var He;try{q&&ie(He=q.promise)?He.call(q).done(pe).fail(Ee):q&&ie(He=q.then)?He.call(q,pe,Ee):pe.apply(void 0,[q].slice(Ce))}catch(Ve){Ee.apply(void 0,[Ve])}}z.Callbacks=function(q){q="string"==typeof q?function ft(q){var pe={};return z.each(q.match(on)||[],function(Ee,Ce){pe[Ce]=!0}),pe}(q):z.extend({},q);var pe,Ee,Ce,He,Ve=[],et=[],Et=-1,At=function(){for(He=He||q.once,Ce=pe=!0;et.length;Et=-1)for(Ee=et.shift();++Et<Ve.length;)!1===Ve[Et].apply(Ee[0],Ee[1])&&q.stopOnFalse&&(Et=Ve.length,Ee=!1);q.memory||(Ee=!1),pe=!1,He&&(Ve=Ee?[]:"")},Yt={add:function(){return Ve&&(Ee&&!pe&&(Et=Ve.length-1,et.push(Ee)),function dn(kn){z.each(kn,function(nn,wn){ie(wn)?(!q.unique||!Yt.has(wn))&&Ve.push(wn):wn&&wn.length&&"string"!==X(wn)&&dn(wn)})}(arguments),Ee&&!pe&&At()),this},remove:function(){return z.each(arguments,function(dn,kn){for(var nn;(nn=z.inArray(kn,Ve,nn))>-1;)Ve.splice(nn,1),nn<=Et&&Et--}),this},has:function(dn){return dn?z.inArray(dn,Ve)>-1:Ve.length>0},empty:function(){return Ve&&(Ve=[]),this},disable:function(){return He=et=[],Ve=Ee="",this},disabled:function(){return!Ve},lock:function(){return He=et=[],!Ee&&!pe&&(Ve=Ee=""),this},locked:function(){return!!He},fireWith:function(dn,kn){return He||(kn=[dn,(kn=kn||[]).slice?kn.slice():kn],et.push(kn),pe||At()),this},fire:function(){return Yt.fireWith(this,arguments),this},fired:function(){return!!Ce}};return Yt},z.extend({Deferred:function(q){var pe=[["notify","progress",z.Callbacks("memory"),z.Callbacks("memory"),2],["resolve","done",z.Callbacks("once memory"),z.Callbacks("once memory"),0,"resolved"],["reject","fail",z.Callbacks("once memory"),z.Callbacks("once memory"),1,"rejected"]],Ee="pending",Ce={state:function(){return Ee},always:function(){return He.done(arguments).fail(arguments),this},catch:function(Ve){return Ce.then(null,Ve)},pipe:function(){var Ve=arguments;return z.Deferred(function(et){z.each(pe,function(Et,At){var Yt=ie(Ve[At[4]])&&Ve[At[4]];He[At[1]](function(){var dn=Yt&&Yt.apply(this,arguments);dn&&ie(dn.promise)?dn.promise().progress(et.notify).done(et.resolve).fail(et.reject):et[At[0]+"With"](this,Yt?[dn]:arguments)})}),Ve=null}).promise()},then:function(Ve,et,Et){var At=0;function Yt(dn,kn,nn,wn){return function(){var wr=this,ei=arguments,Tr=function(){var Qo,aa;if(!(dn<At)){if((Qo=nn.apply(wr,ei))===kn.promise())throw new TypeError("Thenable self-resolution");ie(aa=Qo&&("object"==typeof Qo||"function"==typeof Qo)&&Qo.then)?wn?aa.call(Qo,Yt(At,kn,An,wn),Yt(At,kn,Cn,wn)):(At++,aa.call(Qo,Yt(At,kn,An,wn),Yt(At,kn,Cn,wn),Yt(At,kn,An,kn.notifyWith))):(nn!==An&&(wr=void 0,ei=[Qo]),(wn||kn.resolveWith)(wr,ei))}},vs=wn?Tr:function(){try{Tr()}catch(Qo){z.Deferred.exceptionHook&&z.Deferred.exceptionHook(Qo,vs.stackTrace),dn+1>=At&&(nn!==Cn&&(wr=void 0,ei=[Qo]),kn.rejectWith(wr,ei))}};dn?vs():(z.Deferred.getStackHook&&(vs.stackTrace=z.Deferred.getStackHook()),n.setTimeout(vs))}}return z.Deferred(function(dn){pe[0][3].add(Yt(0,dn,ie(Et)?Et:An,dn.notifyWith)),pe[1][3].add(Yt(0,dn,ie(Ve)?Ve:An)),pe[2][3].add(Yt(0,dn,ie(et)?et:Cn))}).promise()},promise:function(Ve){return null!=Ve?z.extend(Ve,Ce):Ce}},He={};return z.each(pe,function(Ve,et){var Et=et[2],At=et[5];Ce[et[1]]=Et.add,At&&Et.add(function(){Ee=At},pe[3-Ve][2].disable,pe[3-Ve][3].disable,pe[0][2].lock,pe[0][3].lock),Et.add(et[3].fire),He[et[0]]=function(){return He[et[0]+"With"](this===He?void 0:this,arguments),this},He[et[0]+"With"]=Et.fireWith}),Ce.promise(He),q&&q.call(He,He),He},when:function(q){var pe=arguments.length,Ee=pe,Ce=Array(Ee),He=B.call(arguments),Ve=z.Deferred(),et=function(Et){return function(At){Ce[Et]=this,He[Et]=arguments.length>1?B.call(arguments):At,--pe||Ve.resolveWith(Ce,He)}};if(pe<=1&&(fn(q,Ve.done(et(Ee)).resolve,Ve.reject,!pe),"pending"===Ve.state()||ie(He[Ee]&&He[Ee].then)))return Ve.then();for(;Ee--;)fn(He[Ee],et(Ee),Ve.reject);return Ve.promise()}});var On=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;z.Deferred.exceptionHook=function(q,pe){n.console&&n.console.warn&&q&&On.test(q.name)&&n.console.warn("jQuery.Deferred exception: "+q.message,q.stack,pe)},z.readyException=function(q){n.setTimeout(function(){throw q})};var $n=z.Deferred();function _n(){Q.removeEventListener("DOMContentLoaded",_n),n.removeEventListener("load",_n),z.ready()}z.fn.ready=function(q){return $n.then(q).catch(function(pe){z.readyException(pe)}),this},z.extend({isReady:!1,readyWait:1,ready:function(q){(!0===q?--z.readyWait:z.isReady)||(z.isReady=!0,!(!0!==q&&--z.readyWait>0)&&$n.resolveWith(Q,[z]))}}),z.ready.then=$n.then,"complete"===Q.readyState||"loading"!==Q.readyState&&!Q.documentElement.doScroll?n.setTimeout(z.ready):(Q.addEventListener("DOMContentLoaded",_n),n.addEventListener("load",_n));var ar=function(q,pe,Ee,Ce,He,Ve,et){var Et=0,At=q.length,Yt=null==Ee;if("object"===X(Ee))for(Et in He=!0,Ee)ar(q,pe,Et,Ee[Et],!0,Ve,et);else if(void 0!==Ce&&(He=!0,ie(Ce)||(et=!0),Yt&&(et?(pe.call(q,Ce),pe=null):(Yt=pe,pe=function(dn,kn,nn){return Yt.call(z(dn),nn)})),pe))for(;Et<At;Et++)pe(q[Et],Ee,et?Ce:Ce.call(q[Et],Et,pe(q[Et],Ee)));return He?q:Yt?pe.call(q):At?pe(q[0],Ee):Ve},nr=/^-ms-/,lr=/-([a-z])/g;function rr(q,pe){return pe.toUpperCase()}function ti(q){return q.replace(nr,"ms-").replace(lr,rr)}var Zr=function(q){return 1===q.nodeType||9===q.nodeType||!+q.nodeType};function pi(){this.expando=z.expando+pi.uid++}pi.uid=1,pi.prototype={cache:function(q){var pe=q[this.expando];return pe||(pe={},Zr(q)&&(q.nodeType?q[this.expando]=pe:Object.defineProperty(q,this.expando,{value:pe,configurable:!0}))),pe},set:function(q,pe,Ee){var Ce,He=this.cache(q);if("string"==typeof pe)He[ti(pe)]=Ee;else for(Ce in pe)He[ti(Ce)]=pe[Ce];return He},get:function(q,pe){return void 0===pe?this.cache(q):q[this.expando]&&q[this.expando][ti(pe)]},access:function(q,pe,Ee){return void 0===pe||pe&&"string"==typeof pe&&void 0===Ee?this.get(q,pe):(this.set(q,pe,Ee),void 0!==Ee?Ee:pe)},remove:function(q,pe){var Ee,Ce=q[this.expando];if(void 0!==Ce){if(void 0!==pe)for((Ee=(pe=Array.isArray(pe)?pe.map(ti):(pe=ti(pe))in Ce?[pe]:pe.match(on)||[]).length);Ee--;)delete Ce[pe[Ee]];(void 0===pe||z.isEmptyObject(Ce))&&(q.nodeType?q[this.expando]=void 0:delete q[this.expando])}},hasData:function(q){var pe=q[this.expando];return void 0!==pe&&!z.isEmptyObject(pe)}};var tr=new pi,mr=new pi,mi=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,xo=/[A-Z]/g;function Qr(q,pe,Ee){var Ce;if(void 0===Ee&&1===q.nodeType)if(Ce="data-"+pe.replace(xo,"-$&").toLowerCase(),"string"==typeof(Ee=q.getAttribute(Ce))){try{Ee=function Nr(q){return"true"===q||"false"!==q&&("null"===q?null:q===+q+""?+q:mi.test(q)?JSON.parse(q):q)}(Ee)}catch{}mr.set(q,pe,Ee)}else Ee=void 0;return Ee}z.extend({hasData:function(q){return mr.hasData(q)||tr.hasData(q)},data:function(q,pe,Ee){return mr.access(q,pe,Ee)},removeData:function(q,pe){mr.remove(q,pe)},_data:function(q,pe,Ee){return tr.access(q,pe,Ee)},_removeData:function(q,pe){tr.remove(q,pe)}}),z.fn.extend({data:function(q,pe){var Ee,Ce,He,Ve=this[0],et=Ve&&Ve.attributes;if(void 0===q){if(this.length&&(He=mr.get(Ve),1===Ve.nodeType&&!tr.get(Ve,"hasDataAttrs"))){for(Ee=et.length;Ee--;)et[Ee]&&0===(Ce=et[Ee].name).indexOf("data-")&&(Ce=ti(Ce.slice(5)),Qr(Ve,Ce,He[Ce]));tr.set(Ve,"hasDataAttrs",!0)}return He}return"object"==typeof q?this.each(function(){mr.set(this,q)}):ar(this,function(Et){var At;if(Ve&&void 0===Et)return void 0!==(At=mr.get(Ve,q))||void 0!==(At=Qr(Ve,q))?At:void 0;this.each(function(){mr.set(this,q,Et)})},null,pe,arguments.length>1,null,!0)},removeData:function(q){return this.each(function(){mr.remove(this,q)})}}),z.extend({queue:function(q,pe,Ee){var Ce;if(q)return Ce=tr.get(q,pe=(pe||"fx")+"queue"),Ee&&(!Ce||Array.isArray(Ee)?Ce=tr.access(q,pe,z.makeArray(Ee)):Ce.push(Ee)),Ce||[]},dequeue:function(q,pe){var Ee=z.queue(q,pe=pe||"fx"),Ce=Ee.length,He=Ee.shift(),Ve=z._queueHooks(q,pe);"inprogress"===He&&(He=Ee.shift(),Ce--),He&&("fx"===pe&&Ee.unshift("inprogress"),delete Ve.stop,He.call(q,function(){z.dequeue(q,pe)},Ve)),!Ce&&Ve&&Ve.empty.fire()},_queueHooks:function(q,pe){var Ee=pe+"queueHooks";return tr.get(q,Ee)||tr.access(q,Ee,{empty:z.Callbacks("once memory").add(function(){tr.remove(q,[pe+"queue",Ee])})})}}),z.fn.extend({queue:function(q,pe){var Ee=2;return"string"!=typeof q&&(pe=q,q="fx",Ee--),arguments.length<Ee?z.queue(this[0],q):void 0===pe?this:this.each(function(){var Ce=z.queue(this,q,pe);z._queueHooks(this,q),"fx"===q&&"inprogress"!==Ce[0]&&z.dequeue(this,q)})},dequeue:function(q){return this.each(function(){z.dequeue(this,q)})},clearQueue:function(q){return this.queue(q||"fx",[])},promise:function(q,pe){var Ee,Ce=1,He=z.Deferred(),Ve=this,et=this.length,Et=function(){--Ce||He.resolveWith(Ve,[Ve])};for("string"!=typeof q&&(pe=q,q=void 0),q=q||"fx";et--;)(Ee=tr.get(Ve[et],q+"queueHooks"))&&Ee.empty&&(Ce++,Ee.empty.add(Et));return Et(),He.promise(pe)}});var Vr=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,gi=new RegExp("^(?:([+-])=|)("+Vr+")([a-z%]*)$","i"),Ti=["Top","Right","Bottom","Left"],$o=Q.documentElement,Hs=function(q){return z.contains(q.ownerDocument,q)},ia={composed:!0};$o.getRootNode&&(Hs=function(q){return z.contains(q.ownerDocument,q)||q.getRootNode(ia)===q.ownerDocument});var Oi=function(q,pe){return"none"===(q=pe||q).style.display||""===q.style.display&&Hs(q)&&"none"===z.css(q,"display")};function Co(q,pe,Ee,Ce){var He,Ve,et=20,Et=Ce?function(){return Ce.cur()}:function(){return z.css(q,pe,"")},At=Et(),Yt=Ee&&Ee[3]||(z.cssNumber[pe]?"":"px"),dn=q.nodeType&&(z.cssNumber[pe]||"px"!==Yt&&+At)&&gi.exec(z.css(q,pe));if(dn&&dn[3]!==Yt){for(Yt=Yt||dn[3],dn=+(At/=2)||1;et--;)z.style(q,pe,dn+Yt),(1-Ve)*(1-(Ve=Et()/At||.5))<=0&&(et=0),dn/=Ve;z.style(q,pe,(dn*=2)+Yt),Ee=Ee||[]}return Ee&&(dn=+dn||+At||0,He=Ee[1]?dn+(Ee[1]+1)*Ee[2]:+Ee[2],Ce&&(Ce.unit=Yt,Ce.start=dn,Ce.end=He)),He}var wo={};function Yr(q){var pe,Ee=q.ownerDocument,Ce=q.nodeName,He=wo[Ce];return He||(pe=Ee.body.appendChild(Ee.createElement(Ce)),He=z.css(pe,"display"),pe.parentNode.removeChild(pe),"none"===He&&(He="block"),wo[Ce]=He,He)}function os(q,pe){for(var Ee,Ce,He=[],Ve=0,et=q.length;Ve<et;Ve++)(Ce=q[Ve]).style&&(Ee=Ce.style.display,pe?("none"===Ee&&(He[Ve]=tr.get(Ce,"display")||null,He[Ve]||(Ce.style.display="")),""===Ce.style.display&&Oi(Ce)&&(He[Ve]=Yr(Ce))):"none"!==Ee&&(He[Ve]="none",tr.set(Ce,"display",Ee)));for(Ve=0;Ve<et;Ve++)null!=He[Ve]&&(q[Ve].style.display=He[Ve]);return q}z.fn.extend({show:function(){return os(this,!0)},hide:function(){return os(this)},toggle:function(q){return"boolean"==typeof q?q?this.show():this.hide():this.each(function(){Oi(this)?z(this).show():z(this).hide()})}});var pe,Ee,Or=/^(?:checkbox|radio)$/i,Oa=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Iu=/^$|^module$|\/(?:java|ecma)script/i;pe=Q.createDocumentFragment().appendChild(Q.createElement("div")),(Ee=Q.createElement("input")).setAttribute("type","radio"),Ee.setAttribute("checked","checked"),Ee.setAttribute("name","t"),pe.appendChild(Ee),me.checkClone=pe.cloneNode(!0).cloneNode(!0).lastChild.checked,pe.innerHTML="<textarea>x</textarea>",me.noCloneChecked=!!pe.cloneNode(!0).lastChild.defaultValue,pe.innerHTML="<option></option>",me.option=!!pe.lastChild;var fs={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Vs(q,pe){var Ee;return Ee=typeof q.getElementsByTagName<"u"?q.getElementsByTagName(pe||"*"):typeof q.querySelectorAll<"u"?q.querySelectorAll(pe||"*"):[],void 0===pe||pe&&Te(q,pe)?z.merge([q],Ee):Ee}function ai(q,pe){for(var Ee=0,Ce=q.length;Ee<Ce;Ee++)tr.set(q[Ee],"globalEval",!pe||tr.get(pe[Ee],"globalEval"))}fs.tbody=fs.tfoot=fs.colgroup=fs.caption=fs.thead,fs.th=fs.td,me.option||(fs.optgroup=fs.option=[1,"<select multiple='multiple'>","</select>"]);var Fc=/<|&#?\w+;/;function Ph(q,pe,Ee,Ce,He){for(var Ve,et,Et,At,Yt,dn,kn=pe.createDocumentFragment(),nn=[],wn=0,wr=q.length;wn<wr;wn++)if((Ve=q[wn])||0===Ve)if("object"===X(Ve))z.merge(nn,Ve.nodeType?[Ve]:Ve);else if(Fc.test(Ve)){for(et=et||kn.appendChild(pe.createElement("div")),Et=(Oa.exec(Ve)||["",""])[1].toLowerCase(),et.innerHTML=(At=fs[Et]||fs._default)[1]+z.htmlPrefilter(Ve)+At[2],dn=At[0];dn--;)et=et.lastChild;z.merge(nn,et.childNodes),(et=kn.firstChild).textContent=""}else nn.push(pe.createTextNode(Ve));for(kn.textContent="",wn=0;Ve=nn[wn++];)if(Ce&&z.inArray(Ve,Ce)>-1)He&&He.push(Ve);else if(Yt=Hs(Ve),et=Vs(kn.appendChild(Ve),"script"),Yt&&ai(et),Ee)for(dn=0;Ve=et[dn++];)Iu.test(Ve.type||"")&&Ee.push(Ve);return kn}var Ka=/^key/,Gp=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,oa=/^([^.]*)(?:\.(.+)|)/;function zl(){return!0}function ka(){return!1}function Dc(q,pe){return q===function Hp(){try{return Q.activeElement}catch{}}()==("focus"===pe)}function Ws(q,pe,Ee,Ce,He,Ve){var et,Et;if("object"==typeof pe){for(Et in"string"!=typeof Ee&&(Ce=Ce||Ee,Ee=void 0),pe)Ws(q,Et,Ee,Ce,pe[Et],Ve);return q}if(null==Ce&&null==He?(He=Ee,Ce=Ee=void 0):null==He&&("string"==typeof Ee?(He=Ce,Ce=void 0):(He=Ce,Ce=Ee,Ee=void 0)),!1===He)He=ka;else if(!He)return q;return 1===Ve&&(et=He,He=function(At){return z().off(At),et.apply(this,arguments)},He.guid=et.guid||(et.guid=z.guid++)),q.each(function(){z.event.add(this,pe,He,Ce,Ee)})}function qo(q,pe,Ee){Ee?(tr.set(q,pe,!1),z.event.add(q,pe,{namespace:!1,handler:function(Ce){var He,Ve,et=tr.get(this,pe);if(1&Ce.isTrigger&&this[pe]){if(et.length)(z.event.special[pe]||{}).delegateType&&Ce.stopPropagation();else if(et=B.call(arguments),tr.set(this,pe,et),He=Ee(this,pe),this[pe](),et!==(Ve=tr.get(this,pe))||He?tr.set(this,pe,!1):Ve={},et!==Ve)return Ce.stopImmediatePropagation(),Ce.preventDefault(),Ve.value}else et.length&&(tr.set(this,pe,{value:z.event.trigger(z.extend(et[0],z.Event.prototype),et.slice(1),this)}),Ce.stopImmediatePropagation())}})):void 0===tr.get(q,pe)&&z.event.add(q,pe,zl)}z.event={global:{},add:function(q,pe,Ee,Ce,He){var Ve,et,Et,At,Yt,dn,kn,nn,wn,wr,ei,Tr=tr.get(q);if(Zr(q))for(Ee.handler&&(Ee=(Ve=Ee).handler,He=Ve.selector),He&&z.find.matchesSelector($o,He),Ee.guid||(Ee.guid=z.guid++),(At=Tr.events)||(At=Tr.events=Object.create(null)),(et=Tr.handle)||(et=Tr.handle=function(vs){return typeof z<"u"&&z.event.triggered!==vs.type?z.event.dispatch.apply(q,arguments):void 0}),Yt=(pe=(pe||"").match(on)||[""]).length;Yt--;)wn=ei=(Et=oa.exec(pe[Yt])||[])[1],wr=(Et[2]||"").split(".").sort(),wn&&(kn=z.event.special[wn]||{},kn=z.event.special[wn=(He?kn.delegateType:kn.bindType)||wn]||{},dn=z.extend({type:wn,origType:ei,data:Ce,handler:Ee,guid:Ee.guid,selector:He,needsContext:He&&z.expr.match.needsContext.test(He),namespace:wr.join(".")},Ve),(nn=At[wn])||((nn=At[wn]=[]).delegateCount=0,(!kn.setup||!1===kn.setup.call(q,Ce,wr,et))&&q.addEventListener&&q.addEventListener(wn,et)),kn.add&&(kn.add.call(q,dn),dn.handler.guid||(dn.handler.guid=Ee.guid)),He?nn.splice(nn.delegateCount++,0,dn):nn.push(dn),z.event.global[wn]=!0)},remove:function(q,pe,Ee,Ce,He){var Ve,et,Et,At,Yt,dn,kn,nn,wn,wr,ei,Tr=tr.hasData(q)&&tr.get(q);if(Tr&&(At=Tr.events)){for(Yt=(pe=(pe||"").match(on)||[""]).length;Yt--;)if(wn=ei=(Et=oa.exec(pe[Yt])||[])[1],wr=(Et[2]||"").split(".").sort(),wn){for(kn=z.event.special[wn]||{},nn=At[wn=(Ce?kn.delegateType:kn.bindType)||wn]||[],Et=Et[2]&&new RegExp("(^|\\.)"+wr.join("\\.(?:.*\\.|)")+"(\\.|$)"),et=Ve=nn.length;Ve--;)dn=nn[Ve],(He||ei===dn.origType)&&(!Ee||Ee.guid===dn.guid)&&(!Et||Et.test(dn.namespace))&&(!Ce||Ce===dn.selector||"**"===Ce&&dn.selector)&&(nn.splice(Ve,1),dn.selector&&nn.delegateCount--,kn.remove&&kn.remove.call(q,dn));et&&!nn.length&&((!kn.teardown||!1===kn.teardown.call(q,wr,Tr.handle))&&z.removeEvent(q,wn,Tr.handle),delete At[wn])}else for(wn in At)z.event.remove(q,wn+pe[Yt],Ee,Ce,!0);z.isEmptyObject(At)&&tr.remove(q,"handle events")}},dispatch:function(q){var pe,Ee,Ce,He,Ve,et,Et=new Array(arguments.length),At=z.event.fix(q),Yt=(tr.get(this,"events")||Object.create(null))[At.type]||[],dn=z.event.special[At.type]||{};for(Et[0]=At,pe=1;pe<arguments.length;pe++)Et[pe]=arguments[pe];if(At.delegateTarget=this,!dn.preDispatch||!1!==dn.preDispatch.call(this,At)){for(et=z.event.handlers.call(this,At,Yt),pe=0;(He=et[pe++])&&!At.isPropagationStopped();)for(At.currentTarget=He.elem,Ee=0;(Ve=He.handlers[Ee++])&&!At.isImmediatePropagationStopped();)(!At.rnamespace||!1===Ve.namespace||At.rnamespace.test(Ve.namespace))&&(At.handleObj=Ve,At.data=Ve.data,void 0!==(Ce=((z.event.special[Ve.origType]||{}).handle||Ve.handler).apply(He.elem,Et))&&!1===(At.result=Ce)&&(At.preventDefault(),At.stopPropagation()));return dn.postDispatch&&dn.postDispatch.call(this,At),At.result}},handlers:function(q,pe){var Ee,Ce,He,Ve,et,Et=[],At=pe.delegateCount,Yt=q.target;if(At&&Yt.nodeType&&!("click"===q.type&&q.button>=1))for(;Yt!==this;Yt=Yt.parentNode||this)if(1===Yt.nodeType&&("click"!==q.type||!0!==Yt.disabled)){for(Ve=[],et={},Ee=0;Ee<At;Ee++)void 0===et[He=(Ce=pe[Ee]).selector+" "]&&(et[He]=Ce.needsContext?z(He,this).index(Yt)>-1:z.find(He,this,null,[Yt]).length),et[He]&&Ve.push(Ce);Ve.length&&Et.push({elem:Yt,handlers:Ve})}return Yt=this,At<pe.length&&Et.push({elem:Yt,handlers:pe.slice(At)}),Et},addProp:function(q,pe){Object.defineProperty(z.Event.prototype,q,{enumerable:!0,configurable:!0,get:ie(pe)?function(){if(this.originalEvent)return pe(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[q]},set:function(Ee){Object.defineProperty(this,q,{enumerable:!0,configurable:!0,writable:!0,value:Ee})}})},fix:function(q){return q[z.expando]?q:new z.Event(q)},special:{load:{noBubble:!0},click:{setup:function(q){var pe=this||q;return Or.test(pe.type)&&pe.click&&Te(pe,"input")&&qo(pe,"click",zl),!1},trigger:function(q){var pe=this||q;return Or.test(pe.type)&&pe.click&&Te(pe,"input")&&qo(pe,"click"),!0},_default:function(q){var pe=q.target;return Or.test(pe.type)&&pe.click&&Te(pe,"input")&&tr.get(pe,"click")||Te(pe,"a")}},beforeunload:{postDispatch:function(q){void 0!==q.result&&q.originalEvent&&(q.originalEvent.returnValue=q.result)}}}},z.removeEvent=function(q,pe,Ee){q.removeEventListener&&q.removeEventListener(pe,Ee)},z.Event=function(q,pe){if(!(this instanceof z.Event))return new z.Event(q,pe);q&&q.type?(this.originalEvent=q,this.type=q.type,this.isDefaultPrevented=q.defaultPrevented||void 0===q.defaultPrevented&&!1===q.returnValue?zl:ka,this.target=q.target&&3===q.target.nodeType?q.target.parentNode:q.target,this.currentTarget=q.currentTarget,this.relatedTarget=q.relatedTarget):this.type=q,pe&&z.extend(this,pe),this.timeStamp=q&&q.timeStamp||Date.now(),this[z.expando]=!0},z.Event.prototype={constructor:z.Event,isDefaultPrevented:ka,isPropagationStopped:ka,isImmediatePropagationStopped:ka,isSimulated:!1,preventDefault:function(){var q=this.originalEvent;this.isDefaultPrevented=zl,q&&!this.isSimulated&&q.preventDefault()},stopPropagation:function(){var q=this.originalEvent;this.isPropagationStopped=zl,q&&!this.isSimulated&&q.stopPropagation()},stopImmediatePropagation:function(){var q=this.originalEvent;this.isImmediatePropagationStopped=zl,q&&!this.isSimulated&&q.stopImmediatePropagation(),this.stopPropagation()}},z.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(q){var pe=q.button;return null==q.which&&Ka.test(q.type)?null!=q.charCode?q.charCode:q.keyCode:!q.which&&void 0!==pe&&Gp.test(q.type)?1&pe?1:2&pe?3:4&pe?2:0:q.which}},z.event.addProp),z.each({focus:"focusin",blur:"focusout"},function(q,pe){z.event.special[q]={setup:function(){return qo(this,q,Dc),!1},trigger:function(){return qo(this,q),!0},delegateType:pe}}),z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(q,pe){z.event.special[q]={delegateType:pe,bindType:pe,handle:function(Ee){var Ce,Ve=Ee.relatedTarget,et=Ee.handleObj;return(!Ve||Ve!==this&&!z.contains(this,Ve))&&(Ee.type=et.origType,Ce=et.handler.apply(this,arguments),Ee.type=pe),Ce}}}),z.fn.extend({on:function(q,pe,Ee,Ce){return Ws(this,q,pe,Ee,Ce)},one:function(q,pe,Ee,Ce){return Ws(this,q,pe,Ee,Ce,1)},off:function(q,pe,Ee){var Ce,He;if(q&&q.preventDefault&&q.handleObj)return Ce=q.handleObj,z(q.delegateTarget).off(Ce.namespace?Ce.origType+"."+Ce.namespace:Ce.origType,Ce.selector,Ce.handler),this;if("object"==typeof q){for(He in q)this.off(He,pe,q[He]);return this}return(!1===pe||"function"==typeof pe)&&(Ee=pe,pe=void 0),!1===Ee&&(Ee=ka),this.each(function(){z.event.remove(this,q,Ee,pe)})}});var ms=/<script|<style|<link/i,Ou=/checked\s*(?:[^=]|=\s*.checked.)/i,uu=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function hu(q,pe){return Te(q,"table")&&Te(11!==pe.nodeType?pe:pe.firstChild,"tr")&&z(q).children("tbody")[0]||q}function Ts(q){return q.type=(null!==q.getAttribute("type"))+"/"+q.type,q}function pp(q){return"true/"===(q.type||"").slice(0,5)?q.type=q.type.slice(5):q.removeAttribute("type"),q}function Is(q,pe){var Ee,Ce,He,et,Et,At;if(1===pe.nodeType){if(tr.hasData(q)&&(At=tr.get(q).events))for(He in tr.remove(pe,"handle events"),At)for(Ee=0,Ce=At[He].length;Ee<Ce;Ee++)z.event.add(pe,He,At[He][Ee]);mr.hasData(q)&&(et=mr.access(q),Et=z.extend({},et),mr.set(pe,Et))}}function mo(q,pe){var Ee=pe.nodeName.toLowerCase();"input"===Ee&&Or.test(q.type)?pe.checked=q.checked:("input"===Ee||"textarea"===Ee)&&(pe.defaultValue=q.defaultValue)}function Uc(q,pe,Ee,Ce){pe=D(pe);var He,Ve,et,Et,At,Yt,dn=0,kn=q.length,nn=kn-1,wn=pe[0],wr=ie(wn);if(wr||kn>1&&"string"==typeof wn&&!me.checkClone&&Ou.test(wn))return q.each(function(ei){var Tr=q.eq(ei);wr&&(pe[0]=wn.call(this,ei,Tr.html())),Uc(Tr,pe,Ee,Ce)});if(kn&&(Ve=(He=Ph(pe,q[0].ownerDocument,!1,q,Ce)).firstChild,1===He.childNodes.length&&(He=Ve),Ve||Ce)){for(Et=(et=z.map(Vs(He,"script"),Ts)).length;dn<kn;dn++)At=He,dn!==nn&&(At=z.clone(At,!0,!0),Et&&z.merge(et,Vs(At,"script"))),Ee.call(q[dn],At,dn);if(Et)for(Yt=et[et.length-1].ownerDocument,z.map(et,pp),dn=0;dn<Et;dn++)Iu.test((At=et[dn]).type||"")&&!tr.access(At,"globalEval")&&z.contains(Yt,At)&&(At.src&&"module"!==(At.type||"").toLowerCase()?z._evalUrl&&!At.noModule&&z._evalUrl(At.src,{nonce:At.nonce||At.getAttribute("nonce")},Yt):R(At.textContent.replace(uu,""),At,Yt))}return q}function ku(q,pe,Ee){for(var Ce,He=pe?z.filter(pe,q):q,Ve=0;null!=(Ce=He[Ve]);Ve++)!Ee&&1===Ce.nodeType&&z.cleanData(Vs(Ce)),Ce.parentNode&&(Ee&&Hs(Ce)&&ai(Vs(Ce,"script")),Ce.parentNode.removeChild(Ce));return q}z.extend({htmlPrefilter:function(q){return q},clone:function(q,pe,Ee){var Ce,He,Ve,et,Et=q.cloneNode(!0),At=Hs(q);if(!(me.noCloneChecked||1!==q.nodeType&&11!==q.nodeType||z.isXMLDoc(q)))for(et=Vs(Et),Ce=0,He=(Ve=Vs(q)).length;Ce<He;Ce++)mo(Ve[Ce],et[Ce]);if(pe)if(Ee)for(Ve=Ve||Vs(q),et=et||Vs(Et),Ce=0,He=Ve.length;Ce<He;Ce++)Is(Ve[Ce],et[Ce]);else Is(q,Et);return(et=Vs(Et,"script")).length>0&&ai(et,!At&&Vs(q,"script")),Et},cleanData:function(q){for(var pe,Ee,Ce,He=z.event.special,Ve=0;void 0!==(Ee=q[Ve]);Ve++)if(Zr(Ee)){if(pe=Ee[tr.expando]){if(pe.events)for(Ce in pe.events)He[Ce]?z.event.remove(Ee,Ce):z.removeEvent(Ee,Ce,pe.handle);Ee[tr.expando]=void 0}Ee[mr.expando]&&(Ee[mr.expando]=void 0)}}}),z.fn.extend({detach:function(q){return ku(this,q,!0)},remove:function(q){return ku(this,q)},text:function(q){return ar(this,function(pe){return void 0===pe?z.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=pe)})},null,q,arguments.length)},append:function(){return Uc(this,arguments,function(q){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||hu(this,q).appendChild(q)})},prepend:function(){return Uc(this,arguments,function(q){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var pe=hu(this,q);pe.insertBefore(q,pe.firstChild)}})},before:function(){return Uc(this,arguments,function(q){this.parentNode&&this.parentNode.insertBefore(q,this)})},after:function(){return Uc(this,arguments,function(q){this.parentNode&&this.parentNode.insertBefore(q,this.nextSibling)})},empty:function(){for(var q,pe=0;null!=(q=this[pe]);pe++)1===q.nodeType&&(z.cleanData(Vs(q,!1)),q.textContent="");return this},clone:function(q,pe){return q=q??!1,pe=pe??q,this.map(function(){return z.clone(this,q,pe)})},html:function(q){return ar(this,function(pe){var Ee=this[0]||{},Ce=0,He=this.length;if(void 0===pe&&1===Ee.nodeType)return Ee.innerHTML;if("string"==typeof pe&&!ms.test(pe)&&!fs[(Oa.exec(pe)||["",""])[1].toLowerCase()]){pe=z.htmlPrefilter(pe);try{for(;Ce<He;Ce++)1===(Ee=this[Ce]||{}).nodeType&&(z.cleanData(Vs(Ee,!1)),Ee.innerHTML=pe);Ee=0}catch{}}Ee&&this.empty().append(pe)},null,q,arguments.length)},replaceWith:function(){var q=[];return Uc(this,arguments,function(pe){var Ee=this.parentNode;z.inArray(this,q)<0&&(z.cleanData(Vs(this)),Ee&&Ee.replaceChild(pe,this))},q)}}),z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(q,pe){z.fn[q]=function(Ee){for(var Ce,He=[],Ve=z(Ee),et=Ve.length-1,Et=0;Et<=et;Et++)Ce=Et===et?this:this.clone(!0),z(Ve[Et])[pe](Ce),G.apply(He,Ce.get());return this.pushStack(He)}});var ph=new RegExp("^("+Vr+")(?!px)[a-z%]+$","i"),Lo=function(q){var pe=q.ownerDocument.defaultView;return(!pe||!pe.opener)&&(pe=n),pe.getComputedStyle(q)},qs=function(q,pe,Ee){var Ce,He,Ve={};for(He in pe)Ve[He]=q.style[He],q.style[He]=pe[He];for(He in Ce=Ee.call(q),pe)q.style[He]=Ve[He];return Ce},Vp=new RegExp(Ti.join("|"),"i");function el(q,pe,Ee){var Ce,He,Ve,et,Et=q.style;return(Ee=Ee||Lo(q))&&(""===(et=Ee.getPropertyValue(pe)||Ee[pe])&&!Hs(q)&&(et=z.style(q,pe)),!me.pixelBoxStyles()&&ph.test(et)&&Vp.test(pe)&&(Ce=Et.width,He=Et.minWidth,Ve=Et.maxWidth,Et.minWidth=Et.maxWidth=Et.width=et,et=Ee.width,Et.width=Ce,Et.minWidth=He,Et.maxWidth=Ve)),void 0!==et?et+"":et}function pu(q,pe){return{get:function(){if(!q())return(this.get=pe).apply(this,arguments);delete this.get}}}!function(){function q(){if(Yt){At.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Yt.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",$o.appendChild(At).appendChild(Yt);var dn=n.getComputedStyle(Yt);Ee="1%"!==dn.top,Et=12===pe(dn.marginLeft),Yt.style.right="60%",Ve=36===pe(dn.right),Ce=36===pe(dn.width),Yt.style.position="absolute",He=12===pe(Yt.offsetWidth/3),$o.removeChild(At),Yt=null}}function pe(dn){return Math.round(parseFloat(dn))}var Ee,Ce,He,Ve,et,Et,At=Q.createElement("div"),Yt=Q.createElement("div");Yt.style&&(Yt.style.backgroundClip="content-box",Yt.cloneNode(!0).style.backgroundClip="",me.clearCloneStyle="content-box"===Yt.style.backgroundClip,z.extend(me,{boxSizingReliable:function(){return q(),Ce},pixelBoxStyles:function(){return q(),Ve},pixelPosition:function(){return q(),Ee},reliableMarginLeft:function(){return q(),Et},scrollboxSize:function(){return q(),He},reliableTrDimensions:function(){var dn,kn,nn,wn;return null==et&&(dn=Q.createElement("table"),kn=Q.createElement("tr"),nn=Q.createElement("div"),dn.style.cssText="position:absolute;left:-11111px",kn.style.height="1px",nn.style.height="9px",$o.appendChild(dn).appendChild(kn).appendChild(nn),wn=n.getComputedStyle(kn),et=parseInt(wn.height)>3,$o.removeChild(dn)),et}}))}();var dp=["Webkit","Moz","ms"],fp=Q.createElement("div").style,dh={};function cc(q){return z.cssProps[q]||dh[q]||(q in fp?q:dh[q]=function Ih(q){for(var pe=q[0].toUpperCase()+q.slice(1),Ee=dp.length;Ee--;)if((q=dp[Ee]+pe)in fp)return q}(q)||q)}var Oh=/^(none|table(?!-c[ea]).+)/,fh=/^--/,kh={position:"absolute",visibility:"hidden",display:"block"},yl={letterSpacing:"0",fontWeight:"400"};function xl(q,pe,Ee){var Ce=gi.exec(pe);return Ce?Math.max(0,Ce[2]-(Ee||0))+(Ce[3]||"px"):pe}function jl(q,pe,Ee,Ce,He,Ve){var et="width"===pe?1:0,Et=0,At=0;if(Ee===(Ce?"border":"content"))return 0;for(;et<4;et+=2)"margin"===Ee&&(At+=z.css(q,Ee+Ti[et],!0,He)),Ce?("content"===Ee&&(At-=z.css(q,"padding"+Ti[et],!0,He)),"margin"!==Ee&&(At-=z.css(q,"border"+Ti[et]+"Width",!0,He))):(At+=z.css(q,"padding"+Ti[et],!0,He),"padding"!==Ee?At+=z.css(q,"border"+Ti[et]+"Width",!0,He):Et+=z.css(q,"border"+Ti[et]+"Width",!0,He));return!Ce&&Ve>=0&&(At+=Math.max(0,Math.ceil(q["offset"+pe[0].toUpperCase()+pe.slice(1)]-Ve-At-Et-.5))||0),At}function Fu(q,pe,Ee){var Ce=Lo(q),Ve=(!me.boxSizingReliable()||Ee)&&"border-box"===z.css(q,"boxSizing",!1,Ce),et=Ve,Et=el(q,pe,Ce),At="offset"+pe[0].toUpperCase()+pe.slice(1);if(ph.test(Et)){if(!Ee)return Et;Et="auto"}return(!me.boxSizingReliable()&&Ve||!me.reliableTrDimensions()&&Te(q,"tr")||"auto"===Et||!parseFloat(Et)&&"inline"===z.css(q,"display",!1,Ce))&&q.getClientRects().length&&(Ve="border-box"===z.css(q,"boxSizing",!1,Ce),(et=At in q)&&(Et=q[At])),(Et=parseFloat(Et)||0)+jl(q,pe,Ee||(Ve?"border":"content"),et,Ce,Et)+"px"}function gs(q,pe,Ee,Ce,He){return new gs.prototype.init(q,pe,Ee,Ce,He)}z.extend({cssHooks:{opacity:{get:function(q,pe){if(pe){var Ee=el(q,"opacity");return""===Ee?"1":Ee}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(q,pe,Ee,Ce){if(q&&3!==q.nodeType&&8!==q.nodeType&&q.style){var He,Ve,et,Et=ti(pe),At=fh.test(pe),Yt=q.style;if(At||(pe=cc(Et)),et=z.cssHooks[pe]||z.cssHooks[Et],void 0===Ee)return et&&"get"in et&&void 0!==(He=et.get(q,!1,Ce))?He:Yt[pe];if("string"==(Ve=typeof Ee)&&(He=gi.exec(Ee))&&He[1]&&(Ee=Co(q,pe,He),Ve="number"),null==Ee||Ee!=Ee)return;"number"===Ve&&!At&&(Ee+=He&&He[3]||(z.cssNumber[Et]?"":"px")),!me.clearCloneStyle&&""===Ee&&0===pe.indexOf("background")&&(Yt[pe]="inherit"),(!et||!("set"in et)||void 0!==(Ee=et.set(q,Ee,Ce)))&&(At?Yt.setProperty(pe,Ee):Yt[pe]=Ee)}},css:function(q,pe,Ee,Ce){var He,Ve,et,Et=ti(pe);return fh.test(pe)||(pe=cc(Et)),(et=z.cssHooks[pe]||z.cssHooks[Et])&&"get"in et&&(He=et.get(q,!0,Ee)),void 0===He&&(He=el(q,pe,Ce)),"normal"===He&&pe in yl&&(He=yl[pe]),""===Ee||Ee?(Ve=parseFloat(He),!0===Ee||isFinite(Ve)?Ve||0:He):He}}),z.each(["height","width"],function(q,pe){z.cssHooks[pe]={get:function(Ee,Ce,He){if(Ce)return!Oh.test(z.css(Ee,"display"))||Ee.getClientRects().length&&Ee.getBoundingClientRect().width?Fu(Ee,pe,He):qs(Ee,kh,function(){return Fu(Ee,pe,He)})},set:function(Ee,Ce,He){var Ve,et=Lo(Ee),Et=!me.scrollboxSize()&&"absolute"===et.position,Yt=(Et||He)&&"border-box"===z.css(Ee,"boxSizing",!1,et),dn=He?jl(Ee,pe,He,Yt,et):0;return Yt&&Et&&(dn-=Math.ceil(Ee["offset"+pe[0].toUpperCase()+pe.slice(1)]-parseFloat(et[pe])-jl(Ee,pe,"border",!1,et)-.5)),dn&&(Ve=gi.exec(Ce))&&"px"!==(Ve[3]||"px")&&(Ee.style[pe]=Ce,Ce=z.css(Ee,pe)),xl(0,Ce,dn)}}}),z.cssHooks.marginLeft=pu(me.reliableMarginLeft,function(q,pe){if(pe)return(parseFloat(el(q,"marginLeft"))||q.getBoundingClientRect().left-qs(q,{marginLeft:0},function(){return q.getBoundingClientRect().left}))+"px"}),z.each({margin:"",padding:"",border:"Width"},function(q,pe){z.cssHooks[q+pe]={expand:function(Ee){for(var Ce=0,He={},Ve="string"==typeof Ee?Ee.split(" "):[Ee];Ce<4;Ce++)He[q+Ti[Ce]+pe]=Ve[Ce]||Ve[Ce-2]||Ve[0];return He}},"margin"!==q&&(z.cssHooks[q+pe].set=xl)}),z.fn.extend({css:function(q,pe){return ar(this,function(Ee,Ce,He){var Ve,et,Et={},At=0;if(Array.isArray(Ce)){for(Ve=Lo(Ee),et=Ce.length;At<et;At++)Et[Ce[At]]=z.css(Ee,Ce[At],!1,Ve);return Et}return void 0!==He?z.style(Ee,Ce,He):z.css(Ee,Ce)},q,pe,arguments.length>1)}}),z.Tween=gs,gs.prototype={constructor:gs,init:function(q,pe,Ee,Ce,He,Ve){this.elem=q,this.prop=Ee,this.easing=He||z.easing._default,this.options=pe,this.start=this.now=this.cur(),this.end=Ce,this.unit=Ve||(z.cssNumber[Ee]?"":"px")},cur:function(){var q=gs.propHooks[this.prop];return q&&q.get?q.get(this):gs.propHooks._default.get(this)},run:function(q){var pe,Ee=gs.propHooks[this.prop];return this.pos=pe=this.options.duration?z.easing[this.easing](q,this.options.duration*q,0,1,this.options.duration):q,this.now=(this.end-this.start)*pe+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),Ee&&Ee.set?Ee.set(this):gs.propHooks._default.set(this),this}},gs.prototype.init.prototype=gs.prototype,gs.propHooks={_default:{get:function(q){var pe;return 1!==q.elem.nodeType||null!=q.elem[q.prop]&&null==q.elem.style[q.prop]?q.elem[q.prop]:(pe=z.css(q.elem,q.prop,""))&&"auto"!==pe?pe:0},set:function(q){z.fx.step[q.prop]?z.fx.step[q.prop](q):1!==q.elem.nodeType||!z.cssHooks[q.prop]&&null==q.elem.style[cc(q.prop)]?q.elem[q.prop]=q.now:z.style(q.elem,q.prop,q.now+q.unit)}}},gs.propHooks.scrollTop=gs.propHooks.scrollLeft={set:function(q){q.elem.nodeType&&q.elem.parentNode&&(q.elem[q.prop]=q.now)}},z.easing={linear:function(q){return q},swing:function(q){return.5-Math.cos(q*Math.PI)/2},_default:"swing"},z.fx=gs.prototype.init,z.fx.step={};var Gl,Du,mp=/^(?:toggle|show|hide)$/,_p=/queueHooks$/;function zc(){Du&&(!1===Q.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(zc):n.setTimeout(zc,z.fx.interval),z.fx.tick())}function uc(){return n.setTimeout(function(){Gl=void 0}),Gl=Date.now()}function mh(q,pe){var Ee,Ce=0,He={height:q};for(pe=pe?1:0;Ce<4;Ce+=2-pe)He["margin"+(Ee=Ti[Ce])]=He["padding"+Ee]=q;return pe&&(He.opacity=He.width=q),He}function gp(q,pe,Ee){for(var Ce,He=(tl.tweeners[pe]||[]).concat(tl.tweeners["*"]),Ve=0,et=He.length;Ve<et;Ve++)if(Ce=He[Ve].call(Ee,pe,q))return Ce}function tl(q,pe,Ee){var Ce,He,Ve=0,et=tl.prefilters.length,Et=z.Deferred().always(function(){delete At.elem}),At=function(){if(He)return!1;for(var kn=Gl||uc(),nn=Math.max(0,Yt.startTime+Yt.duration-kn),wr=1-(nn/Yt.duration||0),ei=0,Tr=Yt.tweens.length;ei<Tr;ei++)Yt.tweens[ei].run(wr);return Et.notifyWith(q,[Yt,wr,nn]),wr<1&&Tr?nn:(Tr||Et.notifyWith(q,[Yt,1,0]),Et.resolveWith(q,[Yt]),!1)},Yt=Et.promise({elem:q,props:z.extend({},pe),opts:z.extend(!0,{specialEasing:{},easing:z.easing._default},Ee),originalProperties:pe,originalOptions:Ee,startTime:Gl||uc(),duration:Ee.duration,tweens:[],createTween:function(kn,nn){var wn=z.Tween(q,Yt.opts,kn,nn,Yt.opts.specialEasing[kn]||Yt.opts.easing);return Yt.tweens.push(wn),wn},stop:function(kn){var nn=0,wn=kn?Yt.tweens.length:0;if(He)return this;for(He=!0;nn<wn;nn++)Yt.tweens[nn].run(1);return kn?(Et.notifyWith(q,[Yt,1,0]),Et.resolveWith(q,[Yt,kn])):Et.rejectWith(q,[Yt,kn]),this}}),dn=Yt.props;for(function zu(q,pe){var Ee,Ce,He,Ve,et;for(Ee in q)if(He=pe[Ce=ti(Ee)],Ve=q[Ee],Array.isArray(Ve)&&(He=Ve[1],Ve=q[Ee]=Ve[0]),Ee!==Ce&&(q[Ce]=Ve,delete q[Ee]),(et=z.cssHooks[Ce])&&"expand"in et)for(Ee in Ve=et.expand(Ve),delete q[Ce],Ve)Ee in q||(q[Ee]=Ve[Ee],pe[Ee]=He);else pe[Ce]=He}(dn,Yt.opts.specialEasing);Ve<et;Ve++)if(Ce=tl.prefilters[Ve].call(Yt,q,dn,Yt.opts))return ie(Ce.stop)&&(z._queueHooks(Yt.elem,Yt.opts.queue).stop=Ce.stop.bind(Ce)),Ce;return z.map(dn,gp,Yt),ie(Yt.opts.start)&&Yt.opts.start.call(q,Yt),Yt.progress(Yt.opts.progress).done(Yt.opts.done,Yt.opts.complete).fail(Yt.opts.fail).always(Yt.opts.always),z.fx.timer(z.extend(At,{elem:q,anim:Yt,queue:Yt.opts.queue})),Yt}z.Animation=z.extend(tl,{tweeners:{"*":[function(q,pe){var Ee=this.createTween(q,pe);return Co(Ee.elem,q,gi.exec(pe),Ee),Ee}]},tweener:function(q,pe){ie(q)?(pe=q,q=["*"]):q=q.match(on);for(var Ee,Ce=0,He=q.length;Ce<He;Ce++)(tl.tweeners[Ee=q[Ce]]=tl.tweeners[Ee]||[]).unshift(pe)},prefilters:[function Uu(q,pe,Ee){var Ce,He,Ve,et,Et,At,Yt,dn,kn="width"in pe||"height"in pe,nn=this,wn={},wr=q.style,ei=q.nodeType&&Oi(q),Tr=tr.get(q,"fxshow");for(Ce in Ee.queue||(null==(et=z._queueHooks(q,"fx")).unqueued&&(et.unqueued=0,Et=et.empty.fire,et.empty.fire=function(){et.unqueued||Et()}),et.unqueued++,nn.always(function(){nn.always(function(){et.unqueued--,z.queue(q,"fx").length||et.empty.fire()})})),pe)if(mp.test(He=pe[Ce])){if(delete pe[Ce],Ve=Ve||"toggle"===He,He===(ei?"hide":"show")){if("show"!==He||!Tr||void 0===Tr[Ce])continue;ei=!0}wn[Ce]=Tr&&Tr[Ce]||z.style(q,Ce)}if((At=!z.isEmptyObject(pe))||!z.isEmptyObject(wn))for(Ce in kn&&1===q.nodeType&&(Ee.overflow=[wr.overflow,wr.overflowX,wr.overflowY],null==(Yt=Tr&&Tr.display)&&(Yt=tr.get(q,"display")),"none"===(dn=z.css(q,"display"))&&(Yt?dn=Yt:(os([q],!0),Yt=q.style.display||Yt,dn=z.css(q,"display"),os([q]))),("inline"===dn||"inline-block"===dn&&null!=Yt)&&"none"===z.css(q,"float")&&(At||(nn.done(function(){wr.display=Yt}),null==Yt&&(Yt="none"===(dn=wr.display)?"":dn)),wr.display="inline-block")),Ee.overflow&&(wr.overflow="hidden",nn.always(function(){wr.overflow=Ee.overflow[0],wr.overflowX=Ee.overflow[1],wr.overflowY=Ee.overflow[2]})),At=!1,wn)At||(Tr?"hidden"in Tr&&(ei=Tr.hidden):Tr=tr.access(q,"fxshow",{display:Yt}),Ve&&(Tr.hidden=!ei),ei&&os([q],!0),nn.done(function(){for(Ce in ei||os([q]),tr.remove(q,"fxshow"),wn)z.style(q,Ce,wn[Ce])})),At=gp(ei?Tr[Ce]:0,Ce,nn),Ce in Tr||(Tr[Ce]=At.start,ei&&(At.end=At.start,At.start=0))}],prefilter:function(q,pe){pe?tl.prefilters.unshift(q):tl.prefilters.push(q)}}),z.speed=function(q,pe,Ee){var Ce=q&&"object"==typeof q?z.extend({},q):{complete:Ee||!Ee&&pe||ie(q)&&q,duration:q,easing:Ee&&pe||pe&&!ie(pe)&&pe};return z.fx.off?Ce.duration=0:"number"!=typeof Ce.duration&&(Ce.duration=Ce.duration in z.fx.speeds?z.fx.speeds[Ce.duration]:z.fx.speeds._default),(null==Ce.queue||!0===Ce.queue)&&(Ce.queue="fx"),Ce.old=Ce.complete,Ce.complete=function(){ie(Ce.old)&&Ce.old.call(this),Ce.queue&&z.dequeue(this,Ce.queue)},Ce},z.fn.extend({fadeTo:function(q,pe,Ee,Ce){return this.filter(Oi).css("opacity",0).show().end().animate({opacity:pe},q,Ee,Ce)},animate:function(q,pe,Ee,Ce){var He=z.isEmptyObject(q),Ve=z.speed(pe,Ee,Ce),et=function(){var Et=tl(this,z.extend({},q),Ve);(He||tr.get(this,"finish"))&&Et.stop(!0)};return et.finish=et,He||!1===Ve.queue?this.each(et):this.queue(Ve.queue,et)},stop:function(q,pe,Ee){var Ce=function(He){var Ve=He.stop;delete He.stop,Ve(Ee)};return"string"!=typeof q&&(Ee=pe,pe=q,q=void 0),pe&&this.queue(q||"fx",[]),this.each(function(){var He=!0,Ve=null!=q&&q+"queueHooks",et=z.timers,Et=tr.get(this);if(Ve)Et[Ve]&&Et[Ve].stop&&Ce(Et[Ve]);else for(Ve in Et)Et[Ve]&&Et[Ve].stop&&_p.test(Ve)&&Ce(Et[Ve]);for(Ve=et.length;Ve--;)et[Ve].elem===this&&(null==q||et[Ve].queue===q)&&(et[Ve].anim.stop(Ee),He=!1,et.splice(Ve,1));(He||!Ee)&&z.dequeue(this,q)})},finish:function(q){return!1!==q&&(q=q||"fx"),this.each(function(){var pe,Ee=tr.get(this),Ce=Ee[q+"queue"],He=Ee[q+"queueHooks"],Ve=z.timers,et=Ce?Ce.length:0;for(Ee.finish=!0,z.queue(this,q,[]),He&&He.stop&&He.stop.call(this,!0),pe=Ve.length;pe--;)Ve[pe].elem===this&&Ve[pe].queue===q&&(Ve[pe].anim.stop(!0),Ve.splice(pe,1));for(pe=0;pe<et;pe++)Ce[pe]&&Ce[pe].finish&&Ce[pe].finish.call(this);delete Ee.finish})}}),z.each(["toggle","show","hide"],function(q,pe){var Ee=z.fn[pe];z.fn[pe]=function(Ce,He,Ve){return null==Ce||"boolean"==typeof Ce?Ee.apply(this,arguments):this.animate(mh(pe,!0),Ce,He,Ve)}}),z.each({slideDown:mh("show"),slideUp:mh("hide"),slideToggle:mh("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(q,pe){z.fn[q]=function(Ee,Ce,He){return this.animate(pe,Ee,Ce,He)}}),z.timers=[],z.fx.tick=function(){var q,pe=0,Ee=z.timers;for(Gl=Date.now();pe<Ee.length;pe++)!(q=Ee[pe])()&&Ee[pe]===q&&Ee.splice(pe--,1);Ee.length||z.fx.stop(),Gl=void 0},z.fx.timer=function(q){z.timers.push(q),z.fx.start()},z.fx.interval=13,z.fx.start=function(){Du||(Du=!0,zc())},z.fx.stop=function(){Du=null},z.fx.speeds={slow:600,fast:200,_default:400},z.fn.delay=function(q,pe){return q=z.fx&&z.fx.speeds[q]||q,this.queue(pe=pe||"fx",function(Ee,Ce){var He=n.setTimeout(Ee,q);Ce.stop=function(){n.clearTimeout(He)}})},function(){var q=Q.createElement("input"),Ee=Q.createElement("select").appendChild(Q.createElement("option"));q.type="checkbox",me.checkOn=""!==q.value,me.optSelected=Ee.selected,(q=Q.createElement("input")).value="t",q.type="radio",me.radioValue="t"===q.value}();var Fh,nl=z.expr.attrHandle;z.fn.extend({attr:function(q,pe){return ar(this,z.attr,q,pe,arguments.length>1)},removeAttr:function(q){return this.each(function(){z.removeAttr(this,q)})}}),z.extend({attr:function(q,pe,Ee){var Ce,He,Ve=q.nodeType;if(3!==Ve&&8!==Ve&&2!==Ve)return typeof q.getAttribute>"u"?z.prop(q,pe,Ee):((1!==Ve||!z.isXMLDoc(q))&&(He=z.attrHooks[pe.toLowerCase()]||(z.expr.match.bool.test(pe)?Fh:void 0)),void 0!==Ee?null===Ee?void z.removeAttr(q,pe):He&&"set"in He&&void 0!==(Ce=He.set(q,Ee,pe))?Ce:(q.setAttribute(pe,Ee+""),Ee):He&&"get"in He&&null!==(Ce=He.get(q,pe))?Ce:(Ce=z.find.attr(q,pe))??void 0)},attrHooks:{type:{set:function(q,pe){if(!me.radioValue&&"radio"===pe&&Te(q,"input")){var Ee=q.value;return q.setAttribute("type",pe),Ee&&(q.value=Ee),pe}}}},removeAttr:function(q,pe){var Ee,Ce=0,He=pe&&pe.match(on);if(He&&1===q.nodeType)for(;Ee=He[Ce++];)q.removeAttribute(Ee)}}),Fh={set:function(q,pe,Ee){return!1===pe?z.removeAttr(q,Ee):q.setAttribute(Ee,Ee),Ee}},z.each(z.expr.match.bool.source.match(/\w+/g),function(q,pe){var Ee=nl[pe]||z.find.attr;nl[pe]=function(Ce,He,Ve){var et,Et,At=He.toLowerCase();return Ve||(Et=nl[At],nl[At]=et,et=null!=Ee(Ce,He,Ve)?At:null,nl[At]=Et),et}});var Dh=/^(?:input|select|textarea|button)$/i,ju=/^(?:a|area)$/i;function hc(q){return(q.match(on)||[]).join(" ")}function pc(q){return q.getAttribute&&q.getAttribute("class")||""}function _h(q){return Array.isArray(q)?q:"string"==typeof q&&q.match(on)||[]}z.fn.extend({prop:function(q,pe){return ar(this,z.prop,q,pe,arguments.length>1)},removeProp:function(q){return this.each(function(){delete this[z.propFix[q]||q]})}}),z.extend({prop:function(q,pe,Ee){var Ce,He,Ve=q.nodeType;if(3!==Ve&&8!==Ve&&2!==Ve)return(1!==Ve||!z.isXMLDoc(q))&&(He=z.propHooks[pe=z.propFix[pe]||pe]),void 0!==Ee?He&&"set"in He&&void 0!==(Ce=He.set(q,Ee,pe))?Ce:q[pe]=Ee:He&&"get"in He&&null!==(Ce=He.get(q,pe))?Ce:q[pe]},propHooks:{tabIndex:{get:function(q){var pe=z.find.attr(q,"tabindex");return pe?parseInt(pe,10):Dh.test(q.nodeName)||ju.test(q.nodeName)&&q.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),me.optSelected||(z.propHooks.selected={get:function(q){return null},set:function(q){}}),z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){z.propFix[this.toLowerCase()]=this}),z.fn.extend({addClass:function(q){var pe,Ee,Ce,He,Ve,et,Et,At=0;if(ie(q))return this.each(function(Yt){z(this).addClass(q.call(this,Yt,pc(this)))});if((pe=_h(q)).length)for(;Ee=this[At++];)if(He=pc(Ee),Ce=1===Ee.nodeType&&" "+hc(He)+" "){for(et=0;Ve=pe[et++];)Ce.indexOf(" "+Ve+" ")<0&&(Ce+=Ve+" ");He!==(Et=hc(Ce))&&Ee.setAttribute("class",Et)}return this},removeClass:function(q){var pe,Ee,Ce,He,Ve,et,Et,At=0;if(ie(q))return this.each(function(Yt){z(this).removeClass(q.call(this,Yt,pc(this)))});if(!arguments.length)return this.attr("class","");if((pe=_h(q)).length)for(;Ee=this[At++];)if(He=pc(Ee),Ce=1===Ee.nodeType&&" "+hc(He)+" "){for(et=0;Ve=pe[et++];)for(;Ce.indexOf(" "+Ve+" ")>-1;)Ce=Ce.replace(" "+Ve+" "," ");He!==(Et=hc(Ce))&&Ee.setAttribute("class",Et)}return this},toggleClass:function(q,pe){var Ee=typeof q,Ce="string"===Ee||Array.isArray(q);return"boolean"==typeof pe&&Ce?pe?this.addClass(q):this.removeClass(q):ie(q)?this.each(function(He){z(this).toggleClass(q.call(this,He,pc(this),pe),pe)}):this.each(function(){var He,Ve,et,Et;if(Ce)for(Ve=0,et=z(this),Et=_h(q);He=Et[Ve++];)et.hasClass(He)?et.removeClass(He):et.addClass(He);else(void 0===q||"boolean"===Ee)&&((He=pc(this))&&tr.set(this,"__className__",He),this.setAttribute&&this.setAttribute("class",He||!1===q?"":tr.get(this,"__className__")||""))})},hasClass:function(q){var pe,Ee,Ce=0;for(pe=" "+q+" ";Ee=this[Ce++];)if(1===Ee.nodeType&&(" "+hc(pc(Ee))+" ").indexOf(pe)>-1)return!0;return!1}});var du=/\r/g;z.fn.extend({val:function(q){var pe,Ee,Ce,He=this[0];return arguments.length?(Ce=ie(q),this.each(function(Ve){var et;1===this.nodeType&&(null==(et=Ce?q.call(this,Ve,z(this).val()):q)?et="":"number"==typeof et?et+="":Array.isArray(et)&&(et=z.map(et,function(Et){return null==Et?"":Et+""})),(!(pe=z.valHooks[this.type]||z.valHooks[this.nodeName.toLowerCase()])||!("set"in pe)||void 0===pe.set(this,et,"value"))&&(this.value=et))})):He?(pe=z.valHooks[He.type]||z.valHooks[He.nodeName.toLowerCase()])&&"get"in pe&&void 0!==(Ee=pe.get(He,"value"))?Ee:"string"==typeof(Ee=He.value)?Ee.replace(du,""):Ee??"":void 0}}),z.extend({valHooks:{option:{get:function(q){return z.find.attr(q,"value")??hc(z.text(q))}},select:{get:function(q){var pe,Ee,Ce,He=q.options,Ve=q.selectedIndex,et="select-one"===q.type,Et=et?null:[],At=et?Ve+1:He.length;for(Ce=Ve<0?At:et?Ve:0;Ce<At;Ce++)if(((Ee=He[Ce]).selected||Ce===Ve)&&!Ee.disabled&&(!Ee.parentNode.disabled||!Te(Ee.parentNode,"optgroup"))){if(pe=z(Ee).val(),et)return pe;Et.push(pe)}return Et},set:function(q,pe){for(var Ee,Ce,He=q.options,Ve=z.makeArray(pe),et=He.length;et--;)((Ce=He[et]).selected=z.inArray(z.valHooks.option.get(Ce),Ve)>-1)&&(Ee=!0);return Ee||(q.selectedIndex=-1),Ve}}}}),z.each(["radio","checkbox"],function(){z.valHooks[this]={set:function(q,pe){if(Array.isArray(pe))return q.checked=z.inArray(z(q).val(),pe)>-1}},me.checkOn||(z.valHooks[this].get=function(q){return null===q.getAttribute("value")?"on":q.value})}),me.focusin="onfocusin"in n;var jc=/^(?:focusinfocus|focusoutblur)$/,vp=function(q){q.stopPropagation()};z.extend(z.event,{trigger:function(q,pe,Ee,Ce){var He,Ve,et,Et,At,Yt,dn,kn,nn=[Ee||Q],wn=ye.call(q,"type")?q.type:q,wr=ye.call(q,"namespace")?q.namespace.split("."):[];if(Ve=kn=et=Ee=Ee||Q,3!==Ee.nodeType&&8!==Ee.nodeType&&!jc.test(wn+z.event.triggered)&&(wn.indexOf(".")>-1&&(wr=wn.split("."),wn=wr.shift(),wr.sort()),At=wn.indexOf(":")<0&&"on"+wn,(q=q[z.expando]?q:new z.Event(wn,"object"==typeof q&&q)).isTrigger=Ce?2:3,q.namespace=wr.join("."),q.rnamespace=q.namespace?new RegExp("(^|\\.)"+wr.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,q.result=void 0,q.target||(q.target=Ee),pe=null==pe?[q]:z.makeArray(pe,[q]),dn=z.event.special[wn]||{},Ce||!dn.trigger||!1!==dn.trigger.apply(Ee,pe))){if(!Ce&&!dn.noBubble&&!W(Ee)){for(jc.test((Et=dn.delegateType||wn)+wn)||(Ve=Ve.parentNode);Ve;Ve=Ve.parentNode)nn.push(Ve),et=Ve;et===(Ee.ownerDocument||Q)&&nn.push(et.defaultView||et.parentWindow||n)}for(He=0;(Ve=nn[He++])&&!q.isPropagationStopped();)kn=Ve,q.type=He>1?Et:dn.bindType||wn,(Yt=(tr.get(Ve,"events")||Object.create(null))[q.type]&&tr.get(Ve,"handle"))&&Yt.apply(Ve,pe),(Yt=At&&Ve[At])&&Yt.apply&&Zr(Ve)&&(q.result=Yt.apply(Ve,pe),!1===q.result&&q.preventDefault());return q.type=wn,!Ce&&!q.isDefaultPrevented()&&(!dn._default||!1===dn._default.apply(nn.pop(),pe))&&Zr(Ee)&&At&&ie(Ee[wn])&&!W(Ee)&&((et=Ee[At])&&(Ee[At]=null),z.event.triggered=wn,q.isPropagationStopped()&&kn.addEventListener(wn,vp),Ee[wn](),q.isPropagationStopped()&&kn.removeEventListener(wn,vp),z.event.triggered=void 0,et&&(Ee[At]=et)),q.result}},simulate:function(q,pe,Ee){var Ce=z.extend(new z.Event,Ee,{type:q,isSimulated:!0});z.event.trigger(Ce,null,pe)}}),z.fn.extend({trigger:function(q,pe){return this.each(function(){z.event.trigger(q,pe,this)})},triggerHandler:function(q,pe){var Ee=this[0];if(Ee)return z.event.trigger(q,pe,Ee,!0)}}),me.focusin||z.each({focus:"focusin",blur:"focusout"},function(q,pe){var Ee=function(Ce){z.event.simulate(pe,Ce.target,z.event.fix(Ce))};z.event.special[pe]={setup:function(){var Ce=this.ownerDocument||this.document||this,He=tr.access(Ce,pe);He||Ce.addEventListener(q,Ee,!0),tr.access(Ce,pe,(He||0)+1)},teardown:function(){var Ce=this.ownerDocument||this.document||this,He=tr.access(Ce,pe)-1;He?tr.access(Ce,pe,He):(Ce.removeEventListener(q,Ee,!0),tr.remove(Ce,pe))}}});var Gc=n.location,Gu={guid:Date.now()},Hl=/\?/;z.parseXML=function(q){var pe;if(!q||"string"!=typeof q)return null;try{pe=(new n.DOMParser).parseFromString(q,"text/xml")}catch{pe=void 0}return(!pe||pe.getElementsByTagName("parsererror").length)&&z.error("Invalid XML: "+q),pe};var yp=/\[\]$/,Uh=/\r?\n/g,bp=/^(?:submit|button|image|reset|file)$/i,xp=/^(?:input|select|textarea|keygen)/i;function zh(q,pe,Ee,Ce){var He;if(Array.isArray(pe))z.each(pe,function(Ve,et){Ee||yp.test(q)?Ce(q,et):zh(q+"["+("object"==typeof et&&null!=et?Ve:"")+"]",et,Ee,Ce)});else if(Ee||"object"!==X(pe))Ce(q,pe);else for(He in pe)zh(q+"["+He+"]",pe[He],Ee,Ce)}z.param=function(q,pe){var Ee,Ce=[],He=function(Ve,et){var Et=ie(et)?et():et;Ce[Ce.length]=encodeURIComponent(Ve)+"="+encodeURIComponent(Et??"")};if(null==q)return"";if(Array.isArray(q)||q.jquery&&!z.isPlainObject(q))z.each(q,function(){He(this.name,this.value)});else for(Ee in q)zh(Ee,q[Ee],pe,He);return Ce.join("&")},z.fn.extend({serialize:function(){return z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var q=z.prop(this,"elements");return q?z.makeArray(q):this}).filter(function(){var q=this.type;return this.name&&!z(this).is(":disabled")&&xp.test(this.nodeName)&&!bp.test(q)&&(this.checked||!Or.test(q))}).map(function(q,pe){var Ee=z(this).val();return null==Ee?null:Array.isArray(Ee)?z.map(Ee,function(Ce){return{name:pe.name,value:Ce.replace(Uh,"\r\n")}}):{name:pe.name,value:Ee.replace(Uh,"\r\n")}}).get()}});var Wp=/%20/g,fu=/#.*$/,Fa=/([?&])_=[^&]*/,dc=/^(.*?):[ \t]*([^\r\n]*)$/gm,Wl=/^(?:GET|HEAD)$/,Hu=/^\/\//,ba={},sa={},wl="*/".concat("*"),Vu=Q.createElement("a");function Wu(q){return function(pe,Ee){"string"!=typeof pe&&(Ee=pe,pe="*");var Ce,He=0,Ve=pe.toLowerCase().match(on)||[];if(ie(Ee))for(;Ce=Ve[He++];)"+"===Ce[0]?(Ce=Ce.slice(1)||"*",(q[Ce]=q[Ce]||[]).unshift(Ee)):(q[Ce]=q[Ce]||[]).push(Ee)}}function jh(q,pe,Ee,Ce){var He={},Ve=q===sa;function et(Et){var At;return He[Et]=!0,z.each(q[Et]||[],function(Yt,dn){var kn=dn(pe,Ee,Ce);return"string"!=typeof kn||Ve||He[kn]?Ve?!(At=kn):void 0:(pe.dataTypes.unshift(kn),et(kn),!1)}),At}return et(pe.dataTypes[0])||!He["*"]&&et("*")}function wp(q,pe){var Ee,Ce,He=z.ajaxSettings.flatOptions||{};for(Ee in pe)void 0!==pe[Ee]&&((He[Ee]?q:Ce||(Ce={}))[Ee]=pe[Ee]);return Ce&&z.extend(!0,q,Ce),q}Vu.href=Gc.href,z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Gc.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Gc.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wl,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(q,pe){return pe?wp(wp(q,z.ajaxSettings),pe):wp(z.ajaxSettings,q)},ajaxPrefilter:Wu(ba),ajaxTransport:Wu(sa),ajax:function(q,pe){"object"==typeof q&&(pe=q,q=void 0);var Ee,Ce,He,Ve,et,Et,At,Yt,dn,kn,nn=z.ajaxSetup({},pe=pe||{}),wn=nn.context||nn,wr=nn.context&&(wn.nodeType||wn.jquery)?z(wn):z.event,ei=z.Deferred(),Tr=z.Callbacks("once memory"),vs=nn.statusCode||{},Qo={},aa={},yi="canceled",Lr={readyState:0,getResponseHeader:function(Vi){var Xi;if(At){if(!Ve)for(Ve={};Xi=dc.exec(He);)Ve[Xi[1].toLowerCase()+" "]=(Ve[Xi[1].toLowerCase()+" "]||[]).concat(Xi[2]);Xi=Ve[Vi.toLowerCase()+" "]}return null==Xi?null:Xi.join(", ")},getAllResponseHeaders:function(){return At?He:null},setRequestHeader:function(Vi,Xi){return null==At&&(Vi=aa[Vi.toLowerCase()]=aa[Vi.toLowerCase()]||Vi,Qo[Vi]=Xi),this},overrideMimeType:function(Vi){return null==At&&(nn.mimeType=Vi),this},statusCode:function(Vi){var Xi;if(Vi)if(At)Lr.always(Vi[Lr.status]);else for(Xi in Vi)vs[Xi]=[vs[Xi],Vi[Xi]];return this},abort:function(Vi){var Xi=Vi||yi;return Ee&&Ee.abort(Xi),Da(0,Xi),this}};if(ei.promise(Lr),nn.url=((q||nn.url||Gc.href)+"").replace(Hu,Gc.protocol+"//"),nn.type=pe.method||pe.type||nn.method||nn.type,nn.dataTypes=(nn.dataType||"*").toLowerCase().match(on)||[""],null==nn.crossDomain){Et=Q.createElement("a");try{Et.href=nn.url,Et.href=Et.href,nn.crossDomain=Vu.protocol+"//"+Vu.host!=Et.protocol+"//"+Et.host}catch{nn.crossDomain=!0}}if(nn.data&&nn.processData&&"string"!=typeof nn.data&&(nn.data=z.param(nn.data,nn.traditional)),jh(ba,nn,pe,Lr),At)return Lr;for(dn in(Yt=z.event&&nn.global)&&0==z.active++&&z.event.trigger("ajaxStart"),nn.type=nn.type.toUpperCase(),nn.hasContent=!Wl.test(nn.type),Ce=nn.url.replace(fu,""),nn.hasContent?nn.data&&nn.processData&&0===(nn.contentType||"").indexOf("application/x-www-form-urlencoded")&&(nn.data=nn.data.replace(Wp,"+")):(kn=nn.url.slice(Ce.length),nn.data&&(nn.processData||"string"==typeof nn.data)&&(Ce+=(Hl.test(Ce)?"&":"?")+nn.data,delete nn.data),!1===nn.cache&&(Ce=Ce.replace(Fa,"$1"),kn=(Hl.test(Ce)?"&":"?")+"_="+Gu.guid+++kn),nn.url=Ce+kn),nn.ifModified&&(z.lastModified[Ce]&&Lr.setRequestHeader("If-Modified-Since",z.lastModified[Ce]),z.etag[Ce]&&Lr.setRequestHeader("If-None-Match",z.etag[Ce])),(nn.data&&nn.hasContent&&!1!==nn.contentType||pe.contentType)&&Lr.setRequestHeader("Content-Type",nn.contentType),Lr.setRequestHeader("Accept",nn.dataTypes[0]&&nn.accepts[nn.dataTypes[0]]?nn.accepts[nn.dataTypes[0]]+("*"!==nn.dataTypes[0]?", "+wl+"; q=0.01":""):nn.accepts["*"]),nn.headers)Lr.setRequestHeader(dn,nn.headers[dn]);if(nn.beforeSend&&(!1===nn.beforeSend.call(wn,Lr,nn)||At))return Lr.abort();if(yi="abort",Tr.add(nn.complete),Lr.done(nn.success),Lr.fail(nn.error),Ee=jh(sa,nn,pe,Lr)){if(Lr.readyState=1,Yt&&wr.trigger("ajaxSend",[Lr,nn]),At)return Lr;nn.async&&nn.timeout>0&&(et=n.setTimeout(function(){Lr.abort("timeout")},nn.timeout));try{At=!1,Ee.send(Qo,Da)}catch(Vi){if(At)throw Vi;Da(-1,Vi)}}else Da(-1,"No Transport");function Da(Vi,Xi,Hh,_c){var la,il,ca,ki,Os,er=Xi;At||(At=!0,et&&n.clearTimeout(et),Ee=void 0,He=_c||"",Lr.readyState=Vi>0?4:0,la=Vi>=200&&Vi<300||304===Vi,Hh&&(ki=function Sp(q,pe,Ee){for(var Ce,He,Ve,et,Et=q.contents,At=q.dataTypes;"*"===At[0];)At.shift(),void 0===Ce&&(Ce=q.mimeType||pe.getResponseHeader("Content-Type"));if(Ce)for(He in Et)if(Et[He]&&Et[He].test(Ce)){At.unshift(He);break}if(At[0]in Ee)Ve=At[0];else{for(He in Ee){if(!At[0]||q.converters[He+" "+At[0]]){Ve=He;break}et||(et=He)}Ve=Ve||et}if(Ve)return Ve!==At[0]&&At.unshift(Ve),Ee[Ve]}(nn,Lr,Hh)),!la&&z.inArray("script",nn.dataTypes)>-1&&(nn.converters["text script"]=function(){}),ki=function Ki(q,pe,Ee,Ce){var He,Ve,et,Et,At,Yt={},dn=q.dataTypes.slice();if(dn[1])for(et in q.converters)Yt[et.toLowerCase()]=q.converters[et];for(Ve=dn.shift();Ve;)if(q.responseFields[Ve]&&(Ee[q.responseFields[Ve]]=pe),!At&&Ce&&q.dataFilter&&(pe=q.dataFilter(pe,q.dataType)),At=Ve,Ve=dn.shift())if("*"===Ve)Ve=At;else if("*"!==At&&At!==Ve){if(!(et=Yt[At+" "+Ve]||Yt["* "+Ve]))for(He in Yt)if((Et=He.split(" "))[1]===Ve&&(et=Yt[At+" "+Et[0]]||Yt["* "+Et[0]])){!0===et?et=Yt[He]:!0!==Yt[He]&&(Ve=Et[0],dn.unshift(Et[1]));break}if(!0!==et)if(et&&q.throws)pe=et(pe);else try{pe=et(pe)}catch(kn){return{state:"parsererror",error:et?kn:"No conversion from "+At+" to "+Ve}}}return{state:"success",data:pe}}(nn,ki,Lr,la),la?(nn.ifModified&&((Os=Lr.getResponseHeader("Last-Modified"))&&(z.lastModified[Ce]=Os),(Os=Lr.getResponseHeader("etag"))&&(z.etag[Ce]=Os)),204===Vi||"HEAD"===nn.type?er="nocontent":304===Vi?er="notmodified":(er=ki.state,il=ki.data,la=!(ca=ki.error))):(ca=er,(Vi||!er)&&(er="error",Vi<0&&(Vi=0))),Lr.status=Vi,Lr.statusText=(Xi||er)+"",la?ei.resolveWith(wn,[il,er,Lr]):ei.rejectWith(wn,[Lr,er,ca]),Lr.statusCode(vs),vs=void 0,Yt&&wr.trigger(la?"ajaxSuccess":"ajaxError",[Lr,nn,la?il:ca]),Tr.fireWith(wn,[Lr,er]),Yt&&(wr.trigger("ajaxComplete",[Lr,nn]),--z.active||z.event.trigger("ajaxStop")))}return Lr},getJSON:function(q,pe,Ee){return z.get(q,pe,Ee,"json")},getScript:function(q,pe){return z.get(q,void 0,pe,"script")}}),z.each(["get","post"],function(q,pe){z[pe]=function(Ee,Ce,He,Ve){return ie(Ce)&&(Ve=Ve||He,He=Ce,Ce=void 0),z.ajax(z.extend({url:Ee,type:pe,dataType:Ve,data:Ce,success:He},z.isPlainObject(Ee)&&Ee))}}),z.ajaxPrefilter(function(q){var pe;for(pe in q.headers)"content-type"===pe.toLowerCase()&&(q.contentType=q.headers[pe]||"")}),z._evalUrl=function(q,pe,Ee){return z.ajax({url:q,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(Ce){z.globalEval(Ce,pe,Ee)}})},z.fn.extend({wrapAll:function(q){var pe;return this[0]&&(ie(q)&&(q=q.call(this[0])),pe=z(q,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&pe.insertBefore(this[0]),pe.map(function(){for(var Ee=this;Ee.firstElementChild;)Ee=Ee.firstElementChild;return Ee}).append(this)),this},wrapInner:function(q){return ie(q)?this.each(function(pe){z(this).wrapInner(q.call(this,pe))}):this.each(function(){var pe=z(this),Ee=pe.contents();Ee.length?Ee.wrapAll(q):pe.append(q)})},wrap:function(q){var pe=ie(q);return this.each(function(Ee){z(this).wrapAll(pe?q.call(this,Ee):q)})},unwrap:function(q){return this.parent(q).not("body").each(function(){z(this).replaceWith(this.childNodes)}),this}}),z.expr.pseudos.hidden=function(q){return!z.expr.pseudos.visible(q)},z.expr.pseudos.visible=function(q){return!!(q.offsetWidth||q.offsetHeight||q.getClientRects().length)},z.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch{}};var rl={0:200,1223:204},ql=z.ajaxSettings.xhr();me.cors=!!ql&&"withCredentials"in ql,me.ajax=ql=!!ql,z.ajaxTransport(function(q){var pe,Ee;if(me.cors||ql&&!q.crossDomain)return{send:function(Ce,He){var Ve,et=q.xhr();if(et.open(q.type,q.url,q.async,q.username,q.password),q.xhrFields)for(Ve in q.xhrFields)et[Ve]=q.xhrFields[Ve];for(Ve in q.mimeType&&et.overrideMimeType&&et.overrideMimeType(q.mimeType),!q.crossDomain&&!Ce["X-Requested-With"]&&(Ce["X-Requested-With"]="XMLHttpRequest"),Ce)et.setRequestHeader(Ve,Ce[Ve]);pe=function(Et){return function(){pe&&(pe=Ee=et.onload=et.onerror=et.onabort=et.ontimeout=et.onreadystatechange=null,"abort"===Et?et.abort():"error"===Et?"number"!=typeof et.status?He(0,"error"):He(et.status,et.statusText):He(rl[et.status]||et.status,et.statusText,"text"!==(et.responseType||"text")||"string"!=typeof et.responseText?{binary:et.response}:{text:et.responseText},et.getAllResponseHeaders()))}},et.onload=pe(),Ee=et.onerror=et.ontimeout=pe("error"),void 0!==et.onabort?et.onabort=Ee:et.onreadystatechange=function(){4===et.readyState&&n.setTimeout(function(){pe&&Ee()})},pe=pe("abort");try{et.send(q.hasContent&&q.data||null)}catch(Et){if(pe)throw Et}},abort:function(){pe&&pe()}}}),z.ajaxPrefilter(function(q){q.crossDomain&&(q.contents.script=!1)}),z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(q){return z.globalEval(q),q}}}),z.ajaxPrefilter("script",function(q){void 0===q.cache&&(q.cache=!1),q.crossDomain&&(q.type="GET")}),z.ajaxTransport("script",function(q){var pe,Ee;if(q.crossDomain||q.scriptAttrs)return{send:function(Ce,He){pe=z("<script>").attr(q.scriptAttrs||{}).prop({charset:q.scriptCharset,src:q.url}).on("load error",Ee=function(Ve){pe.remove(),Ee=null,Ve&&He("error"===Ve.type?404:200,Ve.type)}),Q.head.appendChild(pe[0])},abort:function(){Ee&&Ee()}}});var q,Hc=[],Gh=/(=)\?(?=&|$)|\?\?/;z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var q=Hc.pop()||z.expando+"_"+Gu.guid++;return this[q]=!0,q}}),z.ajaxPrefilter("json jsonp",function(q,pe,Ee){var Ce,He,Ve,et=!1!==q.jsonp&&(Gh.test(q.url)?"url":"string"==typeof q.data&&0===(q.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gh.test(q.data)&&"data");if(et||"jsonp"===q.dataTypes[0])return Ce=q.jsonpCallback=ie(q.jsonpCallback)?q.jsonpCallback():q.jsonpCallback,et?q[et]=q[et].replace(Gh,"$1"+Ce):!1!==q.jsonp&&(q.url+=(Hl.test(q.url)?"&":"?")+q.jsonp+"="+Ce),q.converters["script json"]=function(){return Ve||z.error(Ce+" was not called"),Ve[0]},q.dataTypes[0]="json",He=n[Ce],n[Ce]=function(){Ve=arguments},Ee.always(function(){void 0===He?z(n).removeProp(Ce):n[Ce]=He,q[Ce]&&(q.jsonpCallback=pe.jsonpCallback,Hc.push(Ce)),Ve&&ie(He)&&He(Ve[0]),Ve=He=void 0}),"script"}),me.createHTMLDocument=((q=Q.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===q.childNodes.length),z.parseHTML=function(q,pe,Ee){return"string"!=typeof q?[]:("boolean"==typeof pe&&(Ee=pe,pe=!1),pe||(me.createHTMLDocument?((Ce=(pe=Q.implementation.createHTMLDocument("")).createElement("base")).href=Q.location.href,pe.head.appendChild(Ce)):pe=Q),Ve=!Ee&&[],(He=qe.exec(q))?[pe.createElement(He[1])]:(He=Ph([q],pe,Ve),Ve&&Ve.length&&z(Ve).remove(),z.merge([],He.childNodes)));var Ce,He,Ve},z.fn.load=function(q,pe,Ee){var Ce,He,Ve,et=this,Et=q.indexOf(" ");return Et>-1&&(Ce=hc(q.slice(Et)),q=q.slice(0,Et)),ie(pe)?(Ee=pe,pe=void 0):pe&&"object"==typeof pe&&(He="POST"),et.length>0&&z.ajax({url:q,type:He||"GET",dataType:"html",data:pe}).done(function(At){Ve=arguments,et.html(Ce?z("<div>").append(z.parseHTML(At)).find(Ce):At)}).always(Ee&&function(At,Yt){et.each(function(){Ee.apply(this,Ve||[At.responseText,Yt,At])})}),this},z.expr.pseudos.animated=function(q){return z.grep(z.timers,function(pe){return q===pe.elem}).length},z.offset={setOffset:function(q,pe,Ee){var Ce,He,Ve,et,Et,At,dn=z.css(q,"position"),kn=z(q),nn={};"static"===dn&&(q.style.position="relative"),Et=kn.offset(),Ve=z.css(q,"top"),At=z.css(q,"left"),("absolute"===dn||"fixed"===dn)&&(Ve+At).indexOf("auto")>-1?(et=(Ce=kn.position()).top,He=Ce.left):(et=parseFloat(Ve)||0,He=parseFloat(At)||0),ie(pe)&&(pe=pe.call(q,Ee,z.extend({},Et))),null!=pe.top&&(nn.top=pe.top-Et.top+et),null!=pe.left&&(nn.left=pe.left-Et.left+He),"using"in pe?pe.using.call(q,nn):("number"==typeof nn.top&&(nn.top+="px"),"number"==typeof nn.left&&(nn.left+="px"),kn.css(nn))}},z.fn.extend({offset:function(q){if(arguments.length)return void 0===q?this:this.each(function(He){z.offset.setOffset(this,q,He)});var pe,Ee,Ce=this[0];return Ce?Ce.getClientRects().length?{top:(pe=Ce.getBoundingClientRect()).top+(Ee=Ce.ownerDocument.defaultView).pageYOffset,left:pe.left+Ee.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var q,pe,Ee,Ce=this[0],He={top:0,left:0};if("fixed"===z.css(Ce,"position"))pe=Ce.getBoundingClientRect();else{for(pe=this.offset(),Ee=Ce.ownerDocument,q=Ce.offsetParent||Ee.documentElement;q&&(q===Ee.body||q===Ee.documentElement)&&"static"===z.css(q,"position");)q=q.parentNode;q&&q!==Ce&&1===q.nodeType&&((He=z(q).offset()).top+=z.css(q,"borderTopWidth",!0),He.left+=z.css(q,"borderLeftWidth",!0))}return{top:pe.top-He.top-z.css(Ce,"marginTop",!0),left:pe.left-He.left-z.css(Ce,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var q=this.offsetParent;q&&"static"===z.css(q,"position");)q=q.offsetParent;return q||$o})}}),z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(q,pe){var Ee="pageYOffset"===pe;z.fn[q]=function(Ce){return ar(this,function(He,Ve,et){var Et;if(W(He)?Et=He:9===He.nodeType&&(Et=He.defaultView),void 0===et)return Et?Et[pe]:He[Ve];Et?Et.scrollTo(Ee?Et.pageXOffset:et,Ee?et:Et.pageYOffset):He[Ve]=et},q,Ce,arguments.length)}}),z.each(["top","left"],function(q,pe){z.cssHooks[pe]=pu(me.pixelPosition,function(Ee,Ce){if(Ce)return Ce=el(Ee,pe),ph.test(Ce)?z(Ee).position()[pe]+"px":Ce})}),z.each({Height:"height",Width:"width"},function(q,pe){z.each({padding:"inner"+q,content:pe,"":"outer"+q},function(Ee,Ce){z.fn[Ce]=function(He,Ve){var et=arguments.length&&(Ee||"boolean"!=typeof He),Et=Ee||(!0===He||!0===Ve?"margin":"border");return ar(this,function(At,Yt,dn){var kn;return W(At)?0===Ce.indexOf("outer")?At["inner"+q]:At.document.documentElement["client"+q]:9===At.nodeType?(kn=At.documentElement,Math.max(At.body["scroll"+q],kn["scroll"+q],At.body["offset"+q],kn["offset"+q],kn["client"+q])):void 0===dn?z.css(At,Yt,Et):z.style(At,Yt,dn,Et)},pe,et?He:void 0,et)}})}),z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(q,pe){z.fn[pe]=function(Ee){return this.on(pe,Ee)}}),z.fn.extend({bind:function(q,pe,Ee){return this.on(q,null,pe,Ee)},unbind:function(q,pe){return this.off(q,null,pe)},delegate:function(q,pe,Ee,Ce){return this.on(pe,q,Ee,Ce)},undelegate:function(q,pe,Ee){return 1===arguments.length?this.off(q,"**"):this.off(pe,q||"**",Ee)},hover:function(q,pe){return this.mouseenter(q).mouseleave(pe||q)}}),z.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(q,pe){z.fn[pe]=function(Ee,Ce){return arguments.length>0?this.on(pe,null,Ee,Ce):this.trigger(pe)}});var mc=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;z.proxy=function(q,pe){var Ee,Ce,He;if("string"==typeof pe&&(Ee=q[pe],pe=q,q=Ee),ie(q))return Ce=B.call(arguments,2),He=function(){return q.apply(pe||this,Ce.concat(B.call(arguments)))},He.guid=q.guid=q.guid||z.guid++,He},z.holdReady=function(q){q?z.readyWait++:z.ready(!0)},z.isArray=Array.isArray,z.parseJSON=JSON.parse,z.nodeName=Te,z.isFunction=ie,z.isWindow=W,z.camelCase=ti,z.type=X,z.now=Date.now,z.isNumeric=function(q){var pe=z.type(q);return("number"===pe||"string"===pe)&&!isNaN(q-parseFloat(q))},z.trim=function(q){return null==q?"":(q+"").replace(mc,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return z});var qu=n.jQuery,mu=n.$;return z.noConflict=function(q){return n.$===z&&(n.$=mu),q&&n.jQuery===z&&(n.jQuery=qu),z},typeof o>"u"&&(n.jQuery=n.$=z),z}),function(n,o){"object"==typeof exports&&typeof module<"u"?o(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],o):o((n=typeof globalThis<"u"?globalThis:n||self).bootstrap={},n.jQuery)}(this,function(n,o){"use strict";function l(Ie){return Ie&&"object"==typeof Ie&&"default"in Ie?Ie:{default:Ie}}var x=l(o);function B(Ie,Ue){for(var Ge=0;Ge<Ue.length;Ge++){var xe=Ue[Ge];xe.enumerable=xe.enumerable||!1,xe.configurable=!0,"value"in xe&&(xe.writable=!0),Object.defineProperty(Ie,xe.key,xe)}}function D(Ie,Ue,Ge){return Ue&&B(Ie.prototype,Ue),Ge&&B(Ie,Ge),Ie}function G(){return G=Object.assign||function(Ie){for(var Ue=1;Ue<arguments.length;Ue++){var Ge=arguments[Ue];for(var xe in Ge)Object.prototype.hasOwnProperty.call(Ge,xe)&&(Ie[xe]=Ge[xe])}return Ie},G.apply(this,arguments)}var P="transitionend";function me(Ie){var Ue=this,Ge=!1;return x.default(this).one(W.TRANSITION_END,function(){Ge=!0}),setTimeout(function(){Ge||W.triggerTransitionEnd(Ue)},Ie),this}var W={TRANSITION_END:"bsTransitionEnd",getUID:function(Ue){do{Ue+=~~(1e6*Math.random())}while(document.getElementById(Ue));return Ue},getSelectorFromElement:function(Ue){var Ge=Ue.getAttribute("data-target");if(!Ge||"#"===Ge){var xe=Ue.getAttribute("href");Ge=xe&&"#"!==xe?xe.trim():""}try{return document.querySelector(Ge)?Ge:null}catch{return null}},getTransitionDurationFromElement:function(Ue){if(!Ue)return 0;var Ge=x.default(Ue).css("transition-duration"),xe=x.default(Ue).css("transition-delay"),ze=parseFloat(Ge),Xe=parseFloat(xe);return ze||Xe?(Ge=Ge.split(",")[0],xe=xe.split(",")[0],1e3*(parseFloat(Ge)+parseFloat(xe))):0},reflow:function(Ue){return Ue.offsetHeight},triggerTransitionEnd:function(Ue){x.default(Ue).trigger(P)},supportsTransitionEnd:function(){return!0},isElement:function(Ue){return(Ue[0]||Ue).nodeType},typeCheckConfig:function(Ue,Ge,xe){for(var ze in xe)if(Object.prototype.hasOwnProperty.call(xe,ze)){var Xe=xe[ze],yt=Ge[ze],Nt=yt&&W.isElement(yt)?"element":null===(Ie=yt)||typeof Ie>"u"?""+Ie:{}.toString.call(Ie).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(Xe).test(Nt))throw new Error(Ue.toUpperCase()+': Option "'+ze+'" provided type "'+Nt+'" but expected type "'+Xe+'".')}var Ie},findShadowRoot:function(Ue){if(!document.documentElement.attachShadow)return null;if("function"==typeof Ue.getRootNode){var Ge=Ue.getRootNode();return Ge instanceof ShadowRoot?Ge:null}return Ue instanceof ShadowRoot?Ue:Ue.parentNode?W.findShadowRoot(Ue.parentNode):null},jQueryDetection:function(){if(typeof x.default>"u")throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var Ue=x.default.fn.jquery.split(" ")[0].split(".");if(Ue[0]<2&&Ue[1]<9||1===Ue[0]&&9===Ue[1]&&Ue[2]<1||Ue[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};W.jQueryDetection(),function ie(){x.default.fn.emulateTransitionEnd=me,x.default.event.special[W.TRANSITION_END]=function ue(){return{bindType:P,delegateType:P,handle:function(Ue){if(x.default(Ue.target).is(this))return Ue.handleObj.handler.apply(this,arguments)}}}()}();var Q="alert",R="bs.alert",X="."+R,z=x.default.fn[Q],K="close"+X,be="closed"+X,Ne="click"+X+".data-api",Ke=function(){function Ie(Ge){this._element=Ge}var Ue=Ie.prototype;return Ue.close=function(xe){var ze=this._element;xe&&(ze=this._getRootElement(xe)),this._triggerCloseEvent(ze).isDefaultPrevented()||this._removeElement(ze)},Ue.dispose=function(){x.default.removeData(this._element,R),this._element=null},Ue._getRootElement=function(xe){var ze=W.getSelectorFromElement(xe),Xe=!1;return ze&&(Xe=document.querySelector(ze)),Xe||(Xe=x.default(xe).closest(".alert")[0]),Xe},Ue._triggerCloseEvent=function(xe){var ze=x.default.Event(K);return x.default(xe).trigger(ze),ze},Ue._removeElement=function(xe){var ze=this;if(x.default(xe).removeClass("show"),x.default(xe).hasClass("fade")){var Xe=W.getTransitionDurationFromElement(xe);x.default(xe).one(W.TRANSITION_END,function(yt){return ze._destroyElement(xe,yt)}).emulateTransitionEnd(Xe)}else this._destroyElement(xe)},Ue._destroyElement=function(xe){x.default(xe).detach().trigger(be).remove()},Ie._jQueryInterface=function(xe){return this.each(function(){var ze=x.default(this),Xe=ze.data(R);Xe||(Xe=new Ie(this),ze.data(R,Xe)),"close"===xe&&Xe[xe](this)})},Ie._handleDismiss=function(xe){return function(ze){ze&&ze.preventDefault(),xe.close(this)}},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),Ie}();x.default(document).on(Ne,'[data-dismiss="alert"]',Ke._handleDismiss(new Ke)),x.default.fn[Q]=Ke._jQueryInterface,x.default.fn[Q].Constructor=Ke,x.default.fn[Q].noConflict=function(){return x.default.fn[Q]=z,Ke._jQueryInterface};var vt="button",Bt="bs.button",wt="."+Bt,Ft=".data-api",Ot=x.default.fn[vt],on="active",Cn='[data-toggle^="button"]',_n='input:not([type="hidden"])',lr="click"+wt+Ft,rr="focus"+wt+Ft+" blur"+wt+Ft,ti="load"+wt+Ft,Zr=function(){function Ie(Ge){this._element=Ge,this.shouldAvoidTriggerChange=!1}var Ue=Ie.prototype;return Ue.toggle=function(){var xe=!0,ze=!0,Xe=x.default(this._element).closest('[data-toggle="buttons"]')[0];if(Xe){var yt=this._element.querySelector(_n);if(yt){if("radio"===yt.type)if(yt.checked&&this._element.classList.contains(on))xe=!1;else{var Nt=Xe.querySelector(".active");Nt&&x.default(Nt).removeClass(on)}xe&&(("checkbox"===yt.type||"radio"===yt.type)&&(yt.checked=!this._element.classList.contains(on)),this.shouldAvoidTriggerChange||x.default(yt).trigger("change")),yt.focus(),ze=!1}}this._element.hasAttribute("disabled")||this._element.classList.contains("disabled")||(ze&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(on)),xe&&x.default(this._element).toggleClass(on))},Ue.dispose=function(){x.default.removeData(this._element,Bt),this._element=null},Ie._jQueryInterface=function(xe,ze){return this.each(function(){var Xe=x.default(this),yt=Xe.data(Bt);yt||(yt=new Ie(this),Xe.data(Bt,yt)),yt.shouldAvoidTriggerChange=ze,"toggle"===xe&&yt[xe]()})},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),Ie}();x.default(document).on(lr,Cn,function(Ie){var Ue=Ie.target,Ge=Ue;if(x.default(Ue).hasClass("btn")||(Ue=x.default(Ue).closest(".btn")[0]),!Ue||Ue.hasAttribute("disabled")||Ue.classList.contains("disabled"))Ie.preventDefault();else{var xe=Ue.querySelector(_n);if(xe&&(xe.hasAttribute("disabled")||xe.classList.contains("disabled")))return void Ie.preventDefault();("INPUT"===Ge.tagName||"LABEL"!==Ue.tagName)&&Zr._jQueryInterface.call(x.default(Ue),"toggle","INPUT"===Ge.tagName)}}).on(rr,Cn,function(Ie){var Ue=x.default(Ie.target).closest(".btn")[0];x.default(Ue).toggleClass("focus",/^focus(in)?$/.test(Ie.type))}),x.default(window).on(ti,function(){for(var Ie=[].slice.call(document.querySelectorAll('[data-toggle="buttons"] .btn')),Ue=0,Ge=Ie.length;Ue<Ge;Ue++){var xe=Ie[Ue],ze=xe.querySelector(_n);ze.checked||ze.hasAttribute("checked")?xe.classList.add(on):xe.classList.remove(on)}for(var Xe=0,yt=(Ie=[].slice.call(document.querySelectorAll('[data-toggle="button"]'))).length;Xe<yt;Xe++){var Nt=Ie[Xe];"true"===Nt.getAttribute("aria-pressed")?Nt.classList.add(on):Nt.classList.remove(on)}}),x.default.fn[vt]=Zr._jQueryInterface,x.default.fn[vt].Constructor=Zr,x.default.fn[vt].noConflict=function(){return x.default.fn[vt]=Ot,Zr._jQueryInterface};var pi="carousel",mr="bs.carousel",mi="."+mr,xo=".data-api",Nr=x.default.fn[pi],$o={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},Hs={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},ia="next",Oi="prev",Yr="slide"+mi,os="slid"+mi,Or="keydown"+mi,Oa="mouseenter"+mi,Iu="mouseleave"+mi,fs="touchstart"+mi,Vs="touchmove"+mi,ai="touchend"+mi,Fc="pointerdown"+mi,Ph="pointerup"+mi,Ka="dragstart"+mi,Gp="load"+mi+xo,oa="click"+mi+xo,ka="active",hu=".active.carousel-item",ph={TOUCH:"touch",PEN:"pen"},Lo=function(){function Ie(Ge,xe){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(xe),this._element=Ge,this._indicatorsElement=this._element.querySelector(".carousel-indicators"),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=!(!window.PointerEvent&&!window.MSPointerEvent),this._addEventListeners()}var Ue=Ie.prototype;return Ue.next=function(){this._isSliding||this._slide(ia)},Ue.nextWhenVisible=function(){var xe=x.default(this._element);!document.hidden&&xe.is(":visible")&&"hidden"!==xe.css("visibility")&&this.next()},Ue.prev=function(){this._isSliding||this._slide(Oi)},Ue.pause=function(xe){xe||(this._isPaused=!0),this._element.querySelector(".carousel-item-next, .carousel-item-prev")&&(W.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},Ue.cycle=function(xe){xe||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},Ue.to=function(xe){var ze=this;this._activeElement=this._element.querySelector(hu);var Xe=this._getItemIndex(this._activeElement);if(!(xe>this._items.length-1||xe<0)){if(this._isSliding)return void x.default(this._element).one(os,function(){return ze.to(xe)});if(Xe===xe)return this.pause(),void this.cycle();this._slide(xe>Xe?ia:Oi,this._items[xe])}},Ue.dispose=function(){x.default(this._element).off(mi),x.default.removeData(this._element,mr),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},Ue._getConfig=function(xe){return xe=G({},$o,xe),W.typeCheckConfig(pi,xe,Hs),xe},Ue._handleSwipe=function(){var xe=Math.abs(this.touchDeltaX);if(!(xe<=40)){var ze=xe/this.touchDeltaX;this.touchDeltaX=0,ze>0&&this.prev(),ze<0&&this.next()}},Ue._addEventListeners=function(){var xe=this;this._config.keyboard&&x.default(this._element).on(Or,function(ze){return xe._keydown(ze)}),"hover"===this._config.pause&&x.default(this._element).on(Oa,function(ze){return xe.pause(ze)}).on(Iu,function(ze){return xe.cycle(ze)}),this._config.touch&&this._addTouchEventListeners()},Ue._addTouchEventListeners=function(){var xe=this;if(this._touchSupported){var ze=function(qt){xe._pointerEvent&&ph[qt.originalEvent.pointerType.toUpperCase()]?xe.touchStartX=qt.originalEvent.clientX:xe._pointerEvent||(xe.touchStartX=qt.originalEvent.touches[0].clientX)},yt=function(qt){xe._pointerEvent&&ph[qt.originalEvent.pointerType.toUpperCase()]&&(xe.touchDeltaX=qt.originalEvent.clientX-xe.touchStartX),xe._handleSwipe(),"hover"===xe._config.pause&&(xe.pause(),xe.touchTimeout&&clearTimeout(xe.touchTimeout),xe.touchTimeout=setTimeout(function(Pn){return xe.cycle(Pn)},500+xe._config.interval))};x.default(this._element.querySelectorAll(".carousel-item img")).on(Ka,function(Nt){return Nt.preventDefault()}),this._pointerEvent?(x.default(this._element).on(Fc,function(Nt){return ze(Nt)}),x.default(this._element).on(Ph,function(Nt){return yt(Nt)}),this._element.classList.add("pointer-event")):(x.default(this._element).on(fs,function(Nt){return ze(Nt)}),x.default(this._element).on(Vs,function(Nt){var qt;xe.touchDeltaX=(qt=Nt).originalEvent.touches&&qt.originalEvent.touches.length>1?0:qt.originalEvent.touches[0].clientX-xe.touchStartX}),x.default(this._element).on(ai,function(Nt){return yt(Nt)}))}},Ue._keydown=function(xe){if(!/input|textarea/i.test(xe.target.tagName))switch(xe.which){case 37:xe.preventDefault(),this.prev();break;case 39:xe.preventDefault(),this.next()}},Ue._getItemIndex=function(xe){return this._items=xe&&xe.parentNode?[].slice.call(xe.parentNode.querySelectorAll(".carousel-item")):[],this._items.indexOf(xe)},Ue._getItemByDirection=function(xe,ze){var Xe=xe===ia,yt=xe===Oi,Nt=this._getItemIndex(ze);if((yt&&0===Nt||Xe&&Nt===this._items.length-1)&&!this._config.wrap)return ze;var Gn=(Nt+(xe===Oi?-1:1))%this._items.length;return-1===Gn?this._items[this._items.length-1]:this._items[Gn]},Ue._triggerSlideEvent=function(xe,ze){var Xe=this._getItemIndex(xe),yt=this._getItemIndex(this._element.querySelector(hu)),Nt=x.default.Event(Yr,{relatedTarget:xe,direction:ze,from:yt,to:Xe});return x.default(this._element).trigger(Nt),Nt},Ue._setActiveIndicatorElement=function(xe){if(this._indicatorsElement){var ze=[].slice.call(this._indicatorsElement.querySelectorAll(".active"));x.default(ze).removeClass(ka);var Xe=this._indicatorsElement.children[this._getItemIndex(xe)];Xe&&x.default(Xe).addClass(ka)}},Ue._slide=function(xe,ze){var Gn,Ar,Ur,Xe=this,yt=this._element.querySelector(hu),Nt=this._getItemIndex(yt),qt=ze||yt&&this._getItemByDirection(xe,yt),Pn=this._getItemIndex(qt),En=!!this._interval;if(xe===ia?(Gn="carousel-item-left",Ar="carousel-item-next",Ur="left"):(Gn="carousel-item-right",Ar="carousel-item-prev",Ur="right"),qt&&x.default(qt).hasClass(ka))this._isSliding=!1;else if(!this._triggerSlideEvent(qt,Ur).isDefaultPrevented()&&yt&&qt){this._isSliding=!0,En&&this.pause(),this._setActiveIndicatorElement(qt);var Zt=x.default.Event(os,{relatedTarget:qt,direction:Ur,from:Nt,to:Pn});if(x.default(this._element).hasClass("slide")){x.default(qt).addClass(Ar),W.reflow(qt),x.default(yt).addClass(Gn),x.default(qt).addClass(Gn);var No=parseInt(qt.getAttribute("data-interval"),10);No?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=No):this._config.interval=this._config.defaultInterval||this._config.interval;var pl=W.getTransitionDurationFromElement(yt);x.default(yt).one(W.TRANSITION_END,function(){x.default(qt).removeClass(Gn+" "+Ar).addClass(ka),x.default(yt).removeClass(ka+" "+Ar+" "+Gn),Xe._isSliding=!1,setTimeout(function(){return x.default(Xe._element).trigger(Zt)},0)}).emulateTransitionEnd(pl)}else x.default(yt).removeClass(ka),x.default(qt).addClass(ka),this._isSliding=!1,x.default(this._element).trigger(Zt);En&&this.cycle()}},Ie._jQueryInterface=function(xe){return this.each(function(){var ze=x.default(this).data(mr),Xe=G({},$o,x.default(this).data());"object"==typeof xe&&(Xe=G({},Xe,xe));var yt="string"==typeof xe?xe:Xe.slide;if(ze||(ze=new Ie(this,Xe),x.default(this).data(mr,ze)),"number"==typeof xe)ze.to(xe);else if("string"==typeof yt){if(typeof ze[yt]>"u")throw new TypeError('No method named "'+yt+'"');ze[yt]()}else Xe.interval&&Xe.ride&&(ze.pause(),ze.cycle())})},Ie._dataApiClickHandler=function(xe){var ze=W.getSelectorFromElement(this);if(ze){var Xe=x.default(ze)[0];if(Xe&&x.default(Xe).hasClass("carousel")){var yt=G({},x.default(Xe).data(),x.default(this).data()),Nt=this.getAttribute("data-slide-to");Nt&&(yt.interval=!1),Ie._jQueryInterface.call(x.default(Xe),yt),Nt&&x.default(Xe).data(mr).to(Nt),xe.preventDefault()}}},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return $o}}]),Ie}();x.default(document).on(oa,"[data-slide], [data-slide-to]",Lo._dataApiClickHandler),x.default(window).on(Gp,function(){for(var Ie=[].slice.call(document.querySelectorAll('[data-ride="carousel"]')),Ue=0,Ge=Ie.length;Ue<Ge;Ue++){var xe=x.default(Ie[Ue]);Lo._jQueryInterface.call(xe,xe.data())}}),x.default.fn[pi]=Lo._jQueryInterface,x.default.fn[pi].Constructor=Lo,x.default.fn[pi].noConflict=function(){return x.default.fn[pi]=Nr,Lo._jQueryInterface};var qs="collapse",el="bs.collapse",pu="."+el,fp=x.default.fn[qs],dh={toggle:!0,parent:""},Ih={toggle:"boolean",parent:"(string|element)"},cc="show"+pu,Oh="shown"+pu,fh="hide"+pu,kh="hidden"+pu,yl="click"+pu+".data-api",xl="show",jl="collapse",Fu="collapsing",gs="collapsed",_p='[data-toggle="collapse"]',zc=function(){function Ie(Ge,xe){this._isTransitioning=!1,this._element=Ge,this._config=this._getConfig(xe),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+Ge.id+'"],[data-toggle="collapse"][data-target="#'+Ge.id+'"]'));for(var ze=[].slice.call(document.querySelectorAll(_p)),Xe=0,yt=ze.length;Xe<yt;Xe++){var Nt=ze[Xe],qt=W.getSelectorFromElement(Nt),Pn=[].slice.call(document.querySelectorAll(qt)).filter(function(En){return En===Ge});null!==qt&&Pn.length>0&&(this._selector=qt,this._triggerArray.push(Nt))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var Ue=Ie.prototype;return Ue.toggle=function(){x.default(this._element).hasClass(xl)?this.hide():this.show()},Ue.show=function(){var ze,Xe,xe=this;if(!(this._isTransitioning||x.default(this._element).hasClass(xl)||(this._parent&&0===(ze=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter(function(Ar){return"string"==typeof xe._config.parent?Ar.getAttribute("data-parent")===xe._config.parent:Ar.classList.contains(jl)})).length&&(ze=null),ze&&(Xe=x.default(ze).not(this._selector).data(el),Xe&&Xe._isTransitioning)))){var yt=x.default.Event(cc);if(x.default(this._element).trigger(yt),!yt.isDefaultPrevented()){ze&&(Ie._jQueryInterface.call(x.default(ze).not(this._selector),"hide"),Xe||x.default(ze).data(el,null));var Nt=this._getDimension();x.default(this._element).removeClass(jl).addClass(Fu),this._element.style[Nt]=0,this._triggerArray.length&&x.default(this._triggerArray).removeClass(gs).attr("aria-expanded",!0),this.setTransitioning(!0);var En="scroll"+(Nt[0].toUpperCase()+Nt.slice(1)),Gn=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,function(){x.default(xe._element).removeClass(Fu).addClass(jl+" "+xl),xe._element.style[Nt]="",xe.setTransitioning(!1),x.default(xe._element).trigger(Oh)}).emulateTransitionEnd(Gn),this._element.style[Nt]=this._element[En]+"px"}}},Ue.hide=function(){var xe=this;if(!this._isTransitioning&&x.default(this._element).hasClass(xl)){var ze=x.default.Event(fh);if(x.default(this._element).trigger(ze),!ze.isDefaultPrevented()){var Xe=this._getDimension();this._element.style[Xe]=this._element.getBoundingClientRect()[Xe]+"px",W.reflow(this._element),x.default(this._element).addClass(Fu).removeClass(jl+" "+xl);var yt=this._triggerArray.length;if(yt>0)for(var Nt=0;Nt<yt;Nt++){var qt=this._triggerArray[Nt],Pn=W.getSelectorFromElement(qt);null!==Pn&&(x.default([].slice.call(document.querySelectorAll(Pn))).hasClass(xl)||x.default(qt).addClass(gs).attr("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[Xe]="";var Ar=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,function(){xe.setTransitioning(!1),x.default(xe._element).removeClass(Fu).addClass(jl).trigger(kh)}).emulateTransitionEnd(Ar)}}},Ue.setTransitioning=function(xe){this._isTransitioning=xe},Ue.dispose=function(){x.default.removeData(this._element,el),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},Ue._getConfig=function(xe){return(xe=G({},dh,xe)).toggle=!!xe.toggle,W.typeCheckConfig(qs,xe,Ih),xe},Ue._getDimension=function(){return x.default(this._element).hasClass("width")?"width":"height"},Ue._getParent=function(){var ze,xe=this;W.isElement(this._config.parent)?(ze=this._config.parent,typeof this._config.parent.jquery<"u"&&(ze=this._config.parent[0])):ze=document.querySelector(this._config.parent);var yt=[].slice.call(ze.querySelectorAll('[data-toggle="collapse"][data-parent="'+this._config.parent+'"]'));return x.default(yt).each(function(Nt,qt){xe._addAriaAndCollapsedClass(Ie._getTargetFromElement(qt),[qt])}),ze},Ue._addAriaAndCollapsedClass=function(xe,ze){var Xe=x.default(xe).hasClass(xl);ze.length&&x.default(ze).toggleClass(gs,!Xe).attr("aria-expanded",Xe)},Ie._getTargetFromElement=function(xe){var ze=W.getSelectorFromElement(xe);return ze?document.querySelector(ze):null},Ie._jQueryInterface=function(xe){return this.each(function(){var ze=x.default(this),Xe=ze.data(el),yt=G({},dh,ze.data(),"object"==typeof xe&&xe?xe:{});if(!Xe&&yt.toggle&&"string"==typeof xe&&/show|hide/.test(xe)&&(yt.toggle=!1),Xe||(Xe=new Ie(this,yt),ze.data(el,Xe)),"string"==typeof xe){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe]()}})},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return dh}}]),Ie}();x.default(document).on(yl,_p,function(Ie){"A"===Ie.currentTarget.tagName&&Ie.preventDefault();var Ue=x.default(this),Ge=W.getSelectorFromElement(this),xe=[].slice.call(document.querySelectorAll(Ge));x.default(xe).each(function(){var ze=x.default(this),yt=ze.data(el)?"toggle":Ue.data();zc._jQueryInterface.call(ze,yt)})}),x.default.fn[qs]=zc._jQueryInterface,x.default.fn[qs].Constructor=zc,x.default.fn[qs].noConflict=function(){return x.default.fn[qs]=fp,zc._jQueryInterface};var uc=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",mh=function(){for(var Ie=["Edge","Trident","Firefox"],Ue=0;Ue<Ie.length;Ue+=1)if(uc&&navigator.userAgent.indexOf(Ie[Ue])>=0)return 1;return 0}(),tl=uc&&window.Promise?function gp(Ie){var Ue=!1;return function(){Ue||(Ue=!0,window.Promise.resolve().then(function(){Ue=!1,Ie()}))}}:function Uu(Ie){var Ue=!1;return function(){Ue||(Ue=!0,setTimeout(function(){Ue=!1,Ie()},mh))}};function Fh(Ie){return Ie&&"[object Function]"==={}.toString.call(Ie)}function nl(Ie,Ue){if(1!==Ie.nodeType)return[];var xe=Ie.ownerDocument.defaultView.getComputedStyle(Ie,null);return Ue?xe[Ue]:xe}function Dh(Ie){return"HTML"===Ie.nodeName?Ie:Ie.parentNode||Ie.host}function ju(Ie){if(!Ie)return document.body;switch(Ie.nodeName){case"HTML":case"BODY":return Ie.ownerDocument.body;case"#document":return Ie.body}var Ue=nl(Ie);return/(auto|scroll|overlay)/.test(Ue.overflow+Ue.overflowY+Ue.overflowX)?Ie:ju(Dh(Ie))}function hc(Ie){return Ie&&Ie.referenceNode?Ie.referenceNode:Ie}var pc=uc&&!(!window.MSInputMethodContext||!document.documentMode),_h=uc&&/MSIE 10/.test(navigator.userAgent);function du(Ie){return 11===Ie?pc:10===Ie?_h:pc||_h}function jc(Ie){if(!Ie)return document.documentElement;for(var Ue=du(10)?document.body:null,Ge=Ie.offsetParent||null;Ge===Ue&&Ie.nextElementSibling;)Ge=(Ie=Ie.nextElementSibling).offsetParent;var xe=Ge&&Ge.nodeName;return xe&&"BODY"!==xe&&"HTML"!==xe?-1!==["TH","TD","TABLE"].indexOf(Ge.nodeName)&&"static"===nl(Ge,"position")?jc(Ge):Ge:Ie?Ie.ownerDocument.documentElement:document.documentElement}function Gc(Ie){return null!==Ie.parentNode?Gc(Ie.parentNode):Ie}function Gu(Ie,Ue){if(!(Ie&&Ie.nodeType&&Ue&&Ue.nodeType))return document.documentElement;var Ge=Ie.compareDocumentPosition(Ue)&Node.DOCUMENT_POSITION_FOLLOWING,xe=Ge?Ie:Ue,ze=Ge?Ue:Ie,Xe=document.createRange();Xe.setStart(xe,0),Xe.setEnd(ze,0);var yt=Xe.commonAncestorContainer;if(Ie!==yt&&Ue!==yt||xe.contains(ze))return function vp(Ie){var Ue=Ie.nodeName;return"BODY"!==Ue&&("HTML"===Ue||jc(Ie.firstElementChild)===Ie)}(yt)?yt:jc(yt);var Nt=Gc(Ie);return Nt.host?Gu(Nt.host,Ue):Gu(Ie,Gc(Ue).host)}function Hl(Ie){var Ge="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",xe=Ie.nodeName;return"BODY"===xe||"HTML"===xe?(Ie.ownerDocument.scrollingElement||Ie.ownerDocument.documentElement)[Ge]:Ie[Ge]}function Uh(Ie,Ue){var Ge="x"===Ue?"Left":"Top",xe="Left"===Ge?"Right":"Bottom";return parseFloat(Ie["border"+Ge+"Width"])+parseFloat(Ie["border"+xe+"Width"])}function bp(Ie,Ue,Ge,xe){return Math.max(Ue["offset"+Ie],Ue["scroll"+Ie],Ge["client"+Ie],Ge["offset"+Ie],Ge["scroll"+Ie],du(10)?parseInt(Ge["offset"+Ie])+parseInt(xe["margin"+("Height"===Ie?"Top":"Left")])+parseInt(xe["margin"+("Height"===Ie?"Bottom":"Right")]):0)}function xp(Ie){var Ue=Ie.body,Ge=Ie.documentElement,xe=du(10)&&getComputedStyle(Ge);return{height:bp("Height",Ue,Ge,xe),width:bp("Width",Ue,Ge,xe)}}var Wp=function(){function Ie(Ue,Ge){for(var xe=0;xe<Ge.length;xe++){var ze=Ge[xe];ze.enumerable=ze.enumerable||!1,ze.configurable=!0,"value"in ze&&(ze.writable=!0),Object.defineProperty(Ue,ze.key,ze)}}return function(Ue,Ge,xe){return Ge&&Ie(Ue.prototype,Ge),xe&&Ie(Ue,xe),Ue}}(),fu=function(Ie,Ue,Ge){return Ue in Ie?Object.defineProperty(Ie,Ue,{value:Ge,enumerable:!0,configurable:!0,writable:!0}):Ie[Ue]=Ge,Ie},Fa=Object.assign||function(Ie){for(var Ue=1;Ue<arguments.length;Ue++){var Ge=arguments[Ue];for(var xe in Ge)Object.prototype.hasOwnProperty.call(Ge,xe)&&(Ie[xe]=Ge[xe])}return Ie};function dc(Ie){return Fa({},Ie,{right:Ie.left+Ie.width,bottom:Ie.top+Ie.height})}function Vl(Ie){var Ue={};try{if(du(10)){Ue=Ie.getBoundingClientRect();var Ge=Hl(Ie,"top"),xe=Hl(Ie,"left");Ue.top+=Ge,Ue.left+=xe,Ue.bottom+=Ge,Ue.right+=xe}else Ue=Ie.getBoundingClientRect()}catch{}var ze={left:Ue.left,top:Ue.top,width:Ue.right-Ue.left,height:Ue.bottom-Ue.top},Xe="HTML"===Ie.nodeName?xp(Ie.ownerDocument):{},qt=Ie.offsetWidth-(Xe.width||Ie.clientWidth||ze.width),Pn=Ie.offsetHeight-(Xe.height||Ie.clientHeight||ze.height);if(qt||Pn){var En=nl(Ie);qt-=Uh(En,"x"),Pn-=Uh(En,"y"),ze.width-=qt,ze.height-=Pn}return dc(ze)}function Wl(Ie,Ue){var Ge=arguments.length>2&&void 0!==arguments[2]&&arguments[2],xe=du(10),ze="HTML"===Ue.nodeName,Xe=Vl(Ie),yt=Vl(Ue),Nt=ju(Ie),qt=nl(Ue),Pn=parseFloat(qt.borderTopWidth),En=parseFloat(qt.borderLeftWidth);Ge&&ze&&(yt.top=Math.max(yt.top,0),yt.left=Math.max(yt.left,0));var Gn=dc({top:Xe.top-yt.top-Pn,left:Xe.left-yt.left-En,width:Xe.width,height:Xe.height});if(Gn.marginTop=0,Gn.marginLeft=0,!xe&&ze){var Ar=parseFloat(qt.marginTop),Ur=parseFloat(qt.marginLeft);Gn.top-=Pn-Ar,Gn.bottom-=Pn-Ar,Gn.left-=En-Ur,Gn.right-=En-Ur,Gn.marginTop=Ar,Gn.marginLeft=Ur}return(xe&&!Ge?Ue.contains(Nt):Ue===Nt&&"BODY"!==Nt.nodeName)&&(Gn=function yp(Ie,Ue){var Ge=arguments.length>2&&void 0!==arguments[2]&&arguments[2],xe=Hl(Ue,"top"),ze=Hl(Ue,"left"),Xe=Ge?-1:1;return Ie.top+=xe*Xe,Ie.bottom+=xe*Xe,Ie.left+=ze*Xe,Ie.right+=ze*Xe,Ie}(Gn,Ue)),Gn}function ba(Ie){var Ue=Ie.nodeName;if("BODY"===Ue||"HTML"===Ue)return!1;if("fixed"===nl(Ie,"position"))return!0;var Ge=Dh(Ie);return!!Ge&&ba(Ge)}function sa(Ie){if(!Ie||!Ie.parentElement||du())return document.documentElement;for(var Ue=Ie.parentElement;Ue&&"none"===nl(Ue,"transform");)Ue=Ue.parentElement;return Ue||document.documentElement}function wl(Ie,Ue,Ge,xe){var ze=arguments.length>4&&void 0!==arguments[4]&&arguments[4],Xe={top:0,left:0},yt=ze?sa(Ie):Gu(Ie,hc(Ue));if("viewport"===xe)Xe=function Hu(Ie){var Ue=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Ge=Ie.ownerDocument.documentElement,xe=Wl(Ie,Ge),ze=Math.max(Ge.clientWidth,window.innerWidth||0),Xe=Math.max(Ge.clientHeight,window.innerHeight||0),yt=Ue?0:Hl(Ge),Nt=Ue?0:Hl(Ge,"left");return dc({top:yt-xe.top+xe.marginTop,left:Nt-xe.left+xe.marginLeft,width:ze,height:Xe})}(yt,ze);else{var Nt=void 0;"scrollParent"===xe?"BODY"===(Nt=ju(Dh(Ue))).nodeName&&(Nt=Ie.ownerDocument.documentElement):Nt="window"===xe?Ie.ownerDocument.documentElement:xe;var qt=Wl(Nt,yt,ze);if("HTML"!==Nt.nodeName||ba(yt))Xe=qt;else{var Pn=xp(Ie.ownerDocument),En=Pn.height,Gn=Pn.width;Xe.top+=qt.top-qt.marginTop,Xe.bottom=En+qt.top,Xe.left+=qt.left-qt.marginLeft,Xe.right=Gn+qt.left}}var Ar="number"==typeof(Ge=Ge||0);return Xe.left+=Ar?Ge:Ge.left||0,Xe.top+=Ar?Ge:Ge.top||0,Xe.right-=Ar?Ge:Ge.right||0,Xe.bottom-=Ar?Ge:Ge.bottom||0,Xe}function Vu(Ie){return Ie.width*Ie.height}function Wu(Ie,Ue,Ge,xe,ze){var Xe=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===Ie.indexOf("auto"))return Ie;var yt=wl(Ge,xe,Xe,ze),Nt={top:{width:yt.width,height:Ue.top-yt.top},right:{width:yt.right-Ue.right,height:yt.height},bottom:{width:yt.width,height:yt.bottom-Ue.bottom},left:{width:Ue.left-yt.left,height:yt.height}},qt=Object.keys(Nt).map(function(Ar){return Fa({key:Ar},Nt[Ar],{area:Vu(Nt[Ar])})}).sort(function(Ar,Ur){return Ur.area-Ar.area}),Pn=qt.filter(function(Ar){return Ar.width>=Ge.clientWidth&&Ar.height>=Ge.clientHeight}),En=Pn.length>0?Pn[0].key:qt[0].key,Gn=Ie.split("-")[1];return En+(Gn?"-"+Gn:"")}function jh(Ie,Ue,Ge){var xe=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Wl(Ge,xe?sa(Ue):Gu(Ue,hc(Ge)),xe)}function wp(Ie){var Ge=Ie.ownerDocument.defaultView.getComputedStyle(Ie),xe=parseFloat(Ge.marginTop||0)+parseFloat(Ge.marginBottom||0),ze=parseFloat(Ge.marginLeft||0)+parseFloat(Ge.marginRight||0);return{width:Ie.offsetWidth+ze,height:Ie.offsetHeight+xe}}function Sp(Ie){var Ue={left:"right",right:"left",bottom:"top",top:"bottom"};return Ie.replace(/left|right|bottom|top/g,function(Ge){return Ue[Ge]})}function Ki(Ie,Ue,Ge){Ge=Ge.split("-")[0];var xe=wp(Ie),ze={width:xe.width,height:xe.height},Xe=-1!==["right","left"].indexOf(Ge),yt=Xe?"top":"left",Nt=Xe?"left":"top",qt=Xe?"height":"width",Pn=Xe?"width":"height";return ze[yt]=Ue[yt]+Ue[qt]/2-xe[qt]/2,ze[Nt]=Ge===Nt?Ue[Nt]-xe[Pn]:Ue[Sp(Nt)],ze}function rl(Ie,Ue){return Array.prototype.find?Ie.find(Ue):Ie.filter(Ue)[0]}function Hc(Ie,Ue,Ge){var xe=void 0===Ge?Ie:Ie.slice(0,function ql(Ie,Ue,Ge){if(Array.prototype.findIndex)return Ie.findIndex(function(ze){return ze[Ue]===Ge});var xe=rl(Ie,function(ze){return ze[Ue]===Ge});return Ie.indexOf(xe)}(Ie,"name",Ge));return xe.forEach(function(ze){ze.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var Xe=ze.function||ze.fn;ze.enabled&&Fh(Xe)&&(Ue.offsets.popper=dc(Ue.offsets.popper),Ue.offsets.reference=dc(Ue.offsets.reference),Ue=Xe(Ue,ze))}),Ue}function Gh(){if(!this.state.isDestroyed){var Ie={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};Ie.offsets.reference=jh(this.state,this.popper,this.reference,this.options.positionFixed),Ie.placement=Wu(this.options.placement,Ie.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),Ie.originalPlacement=Ie.placement,Ie.positionFixed=this.options.positionFixed,Ie.offsets.popper=Ki(this.popper,Ie.offsets.reference,Ie.placement),Ie.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",Ie=Hc(this.modifiers,Ie),this.state.isCreated?this.options.onUpdate(Ie):(this.state.isCreated=!0,this.options.onCreate(Ie))}}function mc(Ie,Ue){return Ie.some(function(Ge){return Ge.enabled&&Ge.name===Ue})}function qu(Ie){for(var Ue=[!1,"ms","Webkit","Moz","O"],Ge=Ie.charAt(0).toUpperCase()+Ie.slice(1),xe=0;xe<Ue.length;xe++){var ze=Ue[xe],Xe=ze?""+ze+Ge:Ie;if(typeof document.body.style[Xe]<"u")return Xe}return null}function mu(){return this.state.isDestroyed=!0,mc(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[qu("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function q(Ie){var Ue=Ie.ownerDocument;return Ue?Ue.defaultView:window}function pe(Ie,Ue,Ge,xe){var ze="BODY"===Ie.nodeName,Xe=ze?Ie.ownerDocument.defaultView:Ie;Xe.addEventListener(Ue,Ge,{passive:!0}),ze||pe(ju(Xe.parentNode),Ue,Ge,xe),xe.push(Xe)}function Ee(Ie,Ue,Ge,xe){Ge.updateBound=xe,q(Ie).addEventListener("resize",Ge.updateBound,{passive:!0});var ze=ju(Ie);return pe(ze,"scroll",Ge.updateBound,Ge.scrollParents),Ge.scrollElement=ze,Ge.eventsEnabled=!0,Ge}function Ce(){this.state.eventsEnabled||(this.state=Ee(this.reference,0,this.state,this.scheduleUpdate))}function Ve(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function He(Ie,Ue){return q(Ie).removeEventListener("resize",Ue.updateBound),Ue.scrollParents.forEach(function(Ge){Ge.removeEventListener("scroll",Ue.updateBound)}),Ue.updateBound=null,Ue.scrollParents=[],Ue.scrollElement=null,Ue.eventsEnabled=!1,Ue}(this.reference,this.state))}function et(Ie){return""!==Ie&&!isNaN(parseFloat(Ie))&&isFinite(Ie)}function Et(Ie,Ue){Object.keys(Ue).forEach(function(Ge){var xe="";-1!==["width","height","top","right","bottom","left"].indexOf(Ge)&&et(Ue[Ge])&&(xe="px"),Ie.style[Ge]=Ue[Ge]+xe})}var nn=uc&&/Firefox/i.test(navigator.userAgent);function wr(Ie,Ue,Ge){var xe=rl(Ie,function(Nt){return Nt.name===Ue}),ze=!!xe&&Ie.some(function(Nt){return Nt.name===Ge&&Nt.enabled&&Nt.order<xe.order});if(!ze){var Xe="`"+Ue+"`";console.warn("`"+Ge+"` modifier is required by "+Xe+" modifier in order to work, be sure to include it before "+Xe+"!")}return ze}var vs=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Qo=vs.slice(3);function aa(Ie){var Ue=arguments.length>1&&void 0!==arguments[1]&&arguments[1],Ge=Qo.indexOf(Ie),xe=Qo.slice(Ge+1).concat(Qo.slice(0,Ge));return Ue?xe.reverse():xe}var Os={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function la(Ie){var Ue=Ie.placement,Ge=Ue.split("-")[0],xe=Ue.split("-")[1];if(xe){var ze=Ie.offsets,Xe=ze.reference,yt=ze.popper,Nt=-1!==["bottom","top"].indexOf(Ge),qt=Nt?"left":"top",Pn=Nt?"width":"height",En={start:fu({},qt,Xe[qt]),end:fu({},qt,Xe[qt]+Xe[Pn]-yt[Pn])};Ie.offsets.popper=Fa({},yt,En[xe])}return Ie}},offset:{order:200,enabled:!0,fn:function Hh(Ie,Ue){var qt,Ge=Ue.offset,ze=Ie.offsets,Xe=ze.popper,yt=ze.reference,Nt=Ie.placement.split("-")[0];return qt=et(+Ge)?[+Ge,0]:function Xi(Ie,Ue,Ge,xe){var ze=[0,0],Xe=-1!==["right","left"].indexOf(xe),yt=Ie.split(/(\+|\-)/).map(function(En){return En.trim()}),Nt=yt.indexOf(rl(yt,function(En){return-1!==En.search(/,|\s/)}));yt[Nt]&&-1===yt[Nt].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var qt=/\s*,\s*|\s+/,Pn=-1!==Nt?[yt.slice(0,Nt).concat([yt[Nt].split(qt)[0]]),[yt[Nt].split(qt)[1]].concat(yt.slice(Nt+1))]:[yt];return Pn=Pn.map(function(En,Gn){var Ar=(1===Gn?!Xe:Xe)?"height":"width",Ur=!1;return En.reduce(function($r,Zt){return""===$r[$r.length-1]&&-1!==["+","-"].indexOf(Zt)?($r[$r.length-1]=Zt,Ur=!0,$r):Ur?($r[$r.length-1]+=Zt,Ur=!1,$r):$r.concat(Zt)},[]).map(function($r){return function Vi(Ie,Ue,Ge,xe){var ze=Ie.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),Xe=+ze[1],yt=ze[2];return Xe?0===yt.indexOf("%")?dc("%p"===yt?Ge:xe)[Ue]/100*Xe:"vh"===yt||"vw"===yt?("vh"===yt?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*Xe:Xe:Ie}($r,Ar,Ue,Ge)})}),Pn.forEach(function(En,Gn){En.forEach(function(Ar,Ur){et(Ar)&&(ze[Gn]+=Ar*("-"===En[Ur-1]?-1:1))})}),ze}(Ge,Xe,yt,Nt),"left"===Nt?(Xe.top+=qt[0],Xe.left-=qt[1]):"right"===Nt?(Xe.top+=qt[0],Xe.left+=qt[1]):"top"===Nt?(Xe.left+=qt[0],Xe.top-=qt[1]):"bottom"===Nt&&(Xe.left+=qt[0],Xe.top+=qt[1]),Ie.popper=Xe,Ie},offset:0},preventOverflow:{order:300,enabled:!0,fn:function _c(Ie,Ue){var Ge=Ue.boundariesElement||jc(Ie.instance.popper);Ie.instance.reference===Ge&&(Ge=jc(Ge));var xe=qu("transform"),ze=Ie.instance.popper.style,Xe=ze.top,yt=ze.left,Nt=ze[xe];ze.top="",ze.left="",ze[xe]="";var qt=wl(Ie.instance.popper,Ie.instance.reference,Ue.padding,Ge,Ie.positionFixed);ze.top=Xe,ze.left=yt,ze[xe]=Nt,Ue.boundaries=qt;var En=Ie.offsets.popper,Gn={primary:function(Ur){var $r=En[Ur];return En[Ur]<qt[Ur]&&!Ue.escapeWithReference&&($r=Math.max(En[Ur],qt[Ur])),fu({},Ur,$r)},secondary:function(Ur){var $r="right"===Ur?"left":"top",Zt=En[$r];return En[Ur]>qt[Ur]&&!Ue.escapeWithReference&&(Zt=Math.min(En[$r],qt[Ur]-("right"===Ur?En.width:En.height))),fu({},$r,Zt)}};return Ue.priority.forEach(function(Ar){var Ur=-1!==["left","top"].indexOf(Ar)?"primary":"secondary";En=Fa({},En,Gn[Ur](Ar))}),Ie.offsets.popper=En,Ie},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function Da(Ie){var Ue=Ie.offsets,Ge=Ue.popper,xe=Ue.reference,ze=Ie.placement.split("-")[0],Xe=Math.floor,yt=-1!==["top","bottom"].indexOf(ze),Nt=yt?"right":"bottom",qt=yt?"left":"top",Pn=yt?"width":"height";return Ge[Nt]<Xe(xe[qt])&&(Ie.offsets.popper[qt]=Xe(xe[qt])-Ge[Pn]),Ge[qt]>Xe(xe[Nt])&&(Ie.offsets.popper[qt]=Xe(xe[Nt])),Ie}},arrow:{order:500,enabled:!0,fn:function ei(Ie,Ue){var Ge;if(!wr(Ie.instance.modifiers,"arrow","keepTogether"))return Ie;var xe=Ue.element;if("string"==typeof xe){if(!(xe=Ie.instance.popper.querySelector(xe)))return Ie}else if(!Ie.instance.popper.contains(xe))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),Ie;var ze=Ie.placement.split("-")[0],Xe=Ie.offsets,yt=Xe.popper,Nt=Xe.reference,qt=-1!==["left","right"].indexOf(ze),Pn=qt?"height":"width",En=qt?"Top":"Left",Gn=En.toLowerCase(),Ar=qt?"left":"top",Ur=qt?"bottom":"right",$r=wp(xe)[Pn];Nt[Ur]-$r<yt[Gn]&&(Ie.offsets.popper[Gn]-=yt[Gn]-(Nt[Ur]-$r)),Nt[Gn]+$r>yt[Ur]&&(Ie.offsets.popper[Gn]+=Nt[Gn]+$r-yt[Ur]),Ie.offsets.popper=dc(Ie.offsets.popper);var Zt=Nt[Gn]+Nt[Pn]/2-$r/2,No=nl(Ie.instance.popper),pl=parseFloat(No["margin"+En]),da=parseFloat(No["border"+En+"Width"]),Kr=Zt-Ie.offsets.popper[Gn]-pl-da;return Kr=Math.max(Math.min(yt[Pn]-$r,Kr),0),Ie.arrowElement=xe,Ie.offsets.arrow=(fu(Ge={},Gn,Math.round(Kr)),fu(Ge,Ar,""),Ge),Ie},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function Lr(Ie,Ue){if(mc(Ie.instance.modifiers,"inner")||Ie.flipped&&Ie.placement===Ie.originalPlacement)return Ie;var Ge=wl(Ie.instance.popper,Ie.instance.reference,Ue.padding,Ue.boundariesElement,Ie.positionFixed),xe=Ie.placement.split("-")[0],ze=Sp(xe),Xe=Ie.placement.split("-")[1]||"",yt=[];switch(Ue.behavior){case"flip":yt=[xe,ze];break;case"clockwise":yt=aa(xe);break;case"counterclockwise":yt=aa(xe,!0);break;default:yt=Ue.behavior}return yt.forEach(function(Nt,qt){if(xe!==Nt||yt.length===qt+1)return Ie;xe=Ie.placement.split("-")[0],ze=Sp(xe);var Pn=Ie.offsets.popper,En=Ie.offsets.reference,Gn=Math.floor,Ar="left"===xe&&Gn(Pn.right)>Gn(En.left)||"right"===xe&&Gn(Pn.left)<Gn(En.right)||"top"===xe&&Gn(Pn.bottom)>Gn(En.top)||"bottom"===xe&&Gn(Pn.top)<Gn(En.bottom),Ur=Gn(Pn.left)<Gn(Ge.left),$r=Gn(Pn.right)>Gn(Ge.right),Zt=Gn(Pn.top)<Gn(Ge.top),No=Gn(Pn.bottom)>Gn(Ge.bottom),pl="left"===xe&&Ur||"right"===xe&&$r||"top"===xe&&Zt||"bottom"===xe&&No,da=-1!==["top","bottom"].indexOf(xe),sf=!!Ue.flipVariations&&(da&&"start"===Xe&&Ur||da&&"end"===Xe&&$r||!da&&"start"===Xe&&Zt||!da&&"end"===Xe&&No)||!!Ue.flipVariationsByContent&&(da&&"start"===Xe&&$r||da&&"end"===Xe&&Ur||!da&&"start"===Xe&&No||!da&&"end"===Xe&&Zt);(Ar||pl||sf)&&(Ie.flipped=!0,(Ar||pl)&&(xe=yt[qt+1]),sf&&(Xe=function Tr(Ie){return"end"===Ie?"start":"start"===Ie?"end":Ie}(Xe)),Ie.placement=xe+(Xe?"-"+Xe:""),Ie.offsets.popper=Fa({},Ie.offsets.popper,Ki(Ie.instance.popper,Ie.offsets.reference,Ie.placement)),Ie=Hc(Ie.instance.modifiers,Ie,"flip"))}),Ie},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function ca(Ie){var Ue=Ie.placement,Ge=Ue.split("-")[0],xe=Ie.offsets,ze=xe.popper,Xe=xe.reference,yt=-1!==["left","right"].indexOf(Ge),Nt=-1===["top","left"].indexOf(Ge);return ze[yt?"left":"top"]=Xe[Ge]-(Nt?ze[yt?"width":"height"]:0),Ie.placement=Sp(Ue),Ie.offsets.popper=dc(ze),Ie}},hide:{order:800,enabled:!0,fn:function il(Ie){if(!wr(Ie.instance.modifiers,"hide","preventOverflow"))return Ie;var Ue=Ie.offsets.reference,Ge=rl(Ie.instance.modifiers,function(xe){return"preventOverflow"===xe.name}).boundaries;if(Ue.bottom<Ge.top||Ue.left>Ge.right||Ue.top>Ge.bottom||Ue.right<Ge.left){if(!0===Ie.hide)return Ie;Ie.hide=!0,Ie.attributes["x-out-of-boundaries"]=""}else{if(!1===Ie.hide)return Ie;Ie.hide=!1,Ie.attributes["x-out-of-boundaries"]=!1}return Ie}},computeStyle:{order:850,enabled:!0,fn:function wn(Ie,Ue){var Ge=Ue.x,xe=Ue.y,ze=Ie.offsets.popper,Xe=rl(Ie.instance.modifiers,function(Kr){return"applyStyle"===Kr.name}).gpuAcceleration;void 0!==Xe&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var $r,Zt,yt=void 0!==Xe?Xe:Ue.gpuAcceleration,Nt=jc(Ie.instance.popper),qt=Vl(Nt),Pn={position:ze.position},En=function kn(Ie,Ue){var Ge=Ie.offsets,xe=Ge.popper,Xe=Math.round,yt=Math.floor,Nt=function(pl){return pl},qt=Xe(Ge.reference.width),Pn=Xe(xe.width),En=-1!==["left","right"].indexOf(Ie.placement),Gn=-1!==Ie.placement.indexOf("-"),$r=Ue?En||Gn||qt%2==Pn%2?Xe:yt:Nt,Zt=Ue?Xe:Nt;return{left:$r(qt%2==1&&Pn%2==1&&!Gn&&Ue?xe.left-1:xe.left),top:Zt(xe.top),bottom:Zt(xe.bottom),right:$r(xe.right)}}(Ie,window.devicePixelRatio<2||!nn),Gn="bottom"===Ge?"top":"bottom",Ar="right"===xe?"left":"right",Ur=qu("transform");if(Zt="bottom"===Gn?"HTML"===Nt.nodeName?-Nt.clientHeight+En.bottom:-qt.height+En.bottom:En.top,$r="right"===Ar?"HTML"===Nt.nodeName?-Nt.clientWidth+En.right:-qt.width+En.right:En.left,yt&&Ur)Pn[Ur]="translate3d("+$r+"px, "+Zt+"px, 0)",Pn[Gn]=0,Pn[Ar]=0,Pn.willChange="transform";else{var pl="right"===Ar?-1:1;Pn[Gn]=Zt*("bottom"===Gn?-1:1),Pn[Ar]=$r*pl,Pn.willChange=Gn+", "+Ar}return Ie.attributes=Fa({},{"x-placement":Ie.placement},Ie.attributes),Ie.styles=Fa({},Pn,Ie.styles),Ie.arrowStyles=Fa({},Ie.offsets.arrow,Ie.arrowStyles),Ie},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function Yt(Ie){return Et(Ie.instance.popper,Ie.styles),function At(Ie,Ue){Object.keys(Ue).forEach(function(Ge){!1!==Ue[Ge]?Ie.setAttribute(Ge,Ue[Ge]):Ie.removeAttribute(Ge)})}(Ie.instance.popper,Ie.attributes),Ie.arrowElement&&Object.keys(Ie.arrowStyles).length&&Et(Ie.arrowElement,Ie.arrowStyles),Ie},onLoad:function dn(Ie,Ue,Ge,xe,ze){var Xe=jh(ze,Ue,Ie,Ge.positionFixed),yt=Wu(Ge.placement,Xe,Ue,Ie,Ge.modifiers.flip.boundariesElement,Ge.modifiers.flip.padding);return Ue.setAttribute("x-placement",yt),Et(Ue,{position:Ge.positionFixed?"fixed":"absolute"}),Ge},gpuAcceleration:void 0}}},er=function(){function Ie(Ue,Ge){var xe=this,ze=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(function(Ie,Ue){if(!(Ie instanceof Ue))throw new TypeError("Cannot call a class as a function")})(this,Ie),this.scheduleUpdate=function(){return requestAnimationFrame(xe.update)},this.update=tl(this.update.bind(this)),this.options=Fa({},Ie.Defaults,ze),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=Ue&&Ue.jquery?Ue[0]:Ue,this.popper=Ge&&Ge.jquery?Ge[0]:Ge,this.options.modifiers={},Object.keys(Fa({},Ie.Defaults.modifiers,ze.modifiers)).forEach(function(yt){xe.options.modifiers[yt]=Fa({},Ie.Defaults.modifiers[yt]||{},ze.modifiers?ze.modifiers[yt]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(yt){return Fa({name:yt},xe.options.modifiers[yt])}).sort(function(yt,Nt){return yt.order-Nt.order}),this.modifiers.forEach(function(yt){yt.enabled&&Fh(yt.onLoad)&&yt.onLoad(xe.reference,xe.popper,xe.options,yt,xe.state)}),this.update();var Xe=this.options.eventsEnabled;Xe&&this.enableEventListeners(),this.state.eventsEnabled=Xe}return Wp(Ie,[{key:"update",value:function(){return Gh.call(this)}},{key:"destroy",value:function(){return mu.call(this)}},{key:"enableEventListeners",value:function(){return Ce.call(this)}},{key:"disableEventListeners",value:function(){return Ve.call(this)}}]),Ie}();er.Utils=(typeof window<"u"?window:global).PopperUtils,er.placements=vs,er.Defaults=Os;var Sn="dropdown",ss="bs.dropdown",eo="."+ss,Gr=".data-api",di=x.default.fn[Sn],ot=new RegExp("38|40|27"),Sl="hide"+eo,Ms="hidden"+eo,Ep="show"+eo,As="shown"+eo,vc="click"+eo,ji="click"+eo+Gr,lo="keydown"+eo+Gr,ni="keyup"+eo+Gr,Vc="disabled",Ci="show",Gi="dropdown-menu-right",Wr='[data-toggle="dropdown"]',Eo=".dropdown-menu",El={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},za={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},xa=function(){function Ie(Ge,xe){this._element=Ge,this._popper=null,this._config=this._getConfig(xe),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var Ue=Ie.prototype;return Ue.toggle=function(){if(!this._element.disabled&&!x.default(this._element).hasClass(Vc)){var xe=x.default(this._menu).hasClass(Ci);Ie._clearMenus(),!xe&&this.show(!0)}},Ue.show=function(xe){if(void 0===xe&&(xe=!1),!(this._element.disabled||x.default(this._element).hasClass(Vc)||x.default(this._menu).hasClass(Ci))){var ze={relatedTarget:this._element},Xe=x.default.Event(Ep,ze),yt=Ie._getParentFromElement(this._element);if(x.default(yt).trigger(Xe),!Xe.isDefaultPrevented()){if(!this._inNavbar&&xe){if(typeof er>"u")throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)");var Nt=this._element;"parent"===this._config.reference?Nt=yt:W.isElement(this._config.reference)&&(Nt=this._config.reference,typeof this._config.reference.jquery<"u"&&(Nt=this._config.reference[0])),"scrollParent"!==this._config.boundary&&x.default(yt).addClass("position-static"),this._popper=new er(Nt,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===x.default(yt).closest(".navbar-nav").length&&x.default(document.body).children().on("mouseover",null,x.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),x.default(this._menu).toggleClass(Ci),x.default(yt).toggleClass(Ci).trigger(x.default.Event(As,ze))}}},Ue.hide=function(){if(!this._element.disabled&&!x.default(this._element).hasClass(Vc)&&x.default(this._menu).hasClass(Ci)){var xe={relatedTarget:this._element},ze=x.default.Event(Sl,xe),Xe=Ie._getParentFromElement(this._element);x.default(Xe).trigger(ze),!ze.isDefaultPrevented()&&(this._popper&&this._popper.destroy(),x.default(this._menu).toggleClass(Ci),x.default(Xe).toggleClass(Ci).trigger(x.default.Event(Ms,xe)))}},Ue.dispose=function(){x.default.removeData(this._element,ss),x.default(this._element).off(eo),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},Ue.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},Ue._addEventListeners=function(){var xe=this;x.default(this._element).on(vc,function(ze){ze.preventDefault(),ze.stopPropagation(),xe.toggle()})},Ue._getConfig=function(xe){return xe=G({},this.constructor.Default,x.default(this._element).data(),xe),W.typeCheckConfig(Sn,xe,this.constructor.DefaultType),xe},Ue._getMenuElement=function(){if(!this._menu){var xe=Ie._getParentFromElement(this._element);xe&&(this._menu=xe.querySelector(Eo))}return this._menu},Ue._getPlacement=function(){var xe=x.default(this._element.parentNode),ze="bottom-start";return xe.hasClass("dropup")?ze=x.default(this._menu).hasClass(Gi)?"top-end":"top-start":xe.hasClass("dropright")?ze="right-start":xe.hasClass("dropleft")?ze="left-start":x.default(this._menu).hasClass(Gi)&&(ze="bottom-end"),ze},Ue._detectNavbar=function(){return x.default(this._element).closest(".navbar").length>0},Ue._getOffset=function(){var xe=this,ze={};return"function"==typeof this._config.offset?ze.fn=function(Xe){return Xe.offsets=G({},Xe.offsets,xe._config.offset(Xe.offsets,xe._element)||{}),Xe}:ze.offset=this._config.offset,ze},Ue._getPopperConfig=function(){var xe={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(xe.modifiers.applyStyle={enabled:!1}),G({},xe,this._config.popperConfig)},Ie._jQueryInterface=function(xe){return this.each(function(){var ze=x.default(this).data(ss);if(ze||(ze=new Ie(this,"object"==typeof xe?xe:null),x.default(this).data(ss,ze)),"string"==typeof xe){if(typeof ze[xe]>"u")throw new TypeError('No method named "'+xe+'"');ze[xe]()}})},Ie._clearMenus=function(xe){if(!xe||3!==xe.which&&("keyup"!==xe.type||9===xe.which))for(var ze=[].slice.call(document.querySelectorAll(Wr)),Xe=0,yt=ze.length;Xe<yt;Xe++){var Nt=Ie._getParentFromElement(ze[Xe]),qt=x.default(ze[Xe]).data(ss),Pn={relatedTarget:ze[Xe]};if(xe&&"click"===xe.type&&(Pn.clickEvent=xe),qt){var En=qt._menu;if(x.default(Nt).hasClass(Ci)&&!(xe&&("click"===xe.type&&/input|textarea/i.test(xe.target.tagName)||"keyup"===xe.type&&9===xe.which)&&x.default.contains(Nt,xe.target))){var Gn=x.default.Event(Sl,Pn);x.default(Nt).trigger(Gn),!Gn.isDefaultPrevented()&&("ontouchstart"in document.documentElement&&x.default(document.body).children().off("mouseover",null,x.default.noop),ze[Xe].setAttribute("aria-expanded","false"),qt._popper&&qt._popper.destroy(),x.default(En).removeClass(Ci),x.default(Nt).removeClass(Ci).trigger(x.default.Event(Ms,Pn)))}}}},Ie._getParentFromElement=function(xe){var ze,Xe=W.getSelectorFromElement(xe);return Xe&&(ze=document.querySelector(Xe)),ze||xe.parentNode},Ie._dataApiKeydownHandler=function(xe){if(!(/input|textarea/i.test(xe.target.tagName)?32===xe.which||27!==xe.which&&(40!==xe.which&&38!==xe.which||x.default(xe.target).closest(Eo).length):!ot.test(xe.which))&&!this.disabled&&!x.default(this).hasClass(Vc)){var ze=Ie._getParentFromElement(this),Xe=x.default(ze).hasClass(Ci);if(Xe||27!==xe.which){if(xe.preventDefault(),xe.stopPropagation(),!Xe||27===xe.which||32===xe.which)return 27===xe.which&&x.default(ze.querySelector(Wr)).trigger("focus"),void x.default(this).trigger("click");var yt=[].slice.call(ze.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter(function(qt){return x.default(qt).is(":visible")});if(0!==yt.length){var Nt=yt.indexOf(xe.target);38===xe.which&&Nt>0&&Nt--,40===xe.which&&Nt<yt.length-1&&Nt++,Nt<0&&(Nt=0),yt[Nt].focus()}}}},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return El}},{key:"DefaultType",get:function(){return za}}]),Ie}();x.default(document).on(lo,Wr,xa._dataApiKeydownHandler).on(lo,Eo,xa._dataApiKeydownHandler).on(ji+" "+ni,xa._clearMenus).on(ji,Wr,function(Ie){Ie.preventDefault(),Ie.stopPropagation(),xa._jQueryInterface.call(x.default(this),"toggle")}).on(ji,".dropdown form",function(Ie){Ie.stopPropagation()}),x.default.fn[Sn]=xa._jQueryInterface,x.default.fn[Sn].Constructor=xa,x.default.fn[Sn].noConflict=function(){return x.default.fn[Sn]=di,xa._jQueryInterface};var Xl="modal",wa="bs.modal",To="."+wa,xc=x.default.fn[Xl],bt={backdrop:!0,keyboard:!0,focus:!0,show:!0},kt={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},yn="hide"+To,Xt="hidePrevented"+To,mn="hidden"+To,Kt="show"+To,qn="shown"+To,zn="focusin"+To,xr="resize"+To,Mr="click.dismiss"+To,_r="keydown.dismiss"+To,qr="mouseup.dismiss"+To,fi="mousedown.dismiss"+To,Rr="click"+To+".data-api",Io="modal-open",Yl="fade",Xo="show",Yi="modal-static",vh=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",_d=".sticky-top",yh=function(){function Ie(Ge,xe){this._config=this._getConfig(xe),this._element=Ge,this._dialog=Ge.querySelector(".modal-dialog"),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var Ue=Ie.prototype;return Ue.toggle=function(xe){return this._isShown?this.hide():this.show(xe)},Ue.show=function(xe){var ze=this;if(!this._isShown&&!this._isTransitioning){x.default(this._element).hasClass(Yl)&&(this._isTransitioning=!0);var Xe=x.default.Event(Kt,{relatedTarget:xe});x.default(this._element).trigger(Xe),!this._isShown&&!Xe.isDefaultPrevented()&&(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),x.default(this._element).on(Mr,'[data-dismiss="modal"]',function(yt){return ze.hide(yt)}),x.default(this._dialog).on(fi,function(){x.default(ze._element).one(qr,function(yt){x.default(yt.target).is(ze._element)&&(ze._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return ze._showElement(xe)}))}},Ue.hide=function(xe){var ze=this;if(xe&&xe.preventDefault(),this._isShown&&!this._isTransitioning){var Xe=x.default.Event(yn);if(x.default(this._element).trigger(Xe),this._isShown&&!Xe.isDefaultPrevented()){this._isShown=!1;var yt=x.default(this._element).hasClass(Yl);if(yt&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),x.default(document).off(zn),x.default(this._element).removeClass(Xo),x.default(this._element).off(Mr),x.default(this._dialog).off(fi),yt){var Nt=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,function(qt){return ze._hideModal(qt)}).emulateTransitionEnd(Nt)}else this._hideModal()}}},Ue.dispose=function(){[window,this._element,this._dialog].forEach(function(xe){return x.default(xe).off(To)}),x.default(document).off(zn),x.default.removeData(this._element,wa),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},Ue.handleUpdate=function(){this._adjustDialog()},Ue._getConfig=function(xe){return xe=G({},bt,xe),W.typeCheckConfig(Xl,xe,kt),xe},Ue._triggerBackdropTransition=function(){var xe=this;if("static"===this._config.backdrop){var ze=x.default.Event(Xt);if(x.default(this._element).trigger(ze),ze.isDefaultPrevented())return;var Xe=this._element.scrollHeight>document.documentElement.clientHeight;Xe||(this._element.style.overflowY="hidden"),this._element.classList.add(Yi);var yt=W.getTransitionDurationFromElement(this._dialog);x.default(this._element).off(W.TRANSITION_END),x.default(this._element).one(W.TRANSITION_END,function(){xe._element.classList.remove(Yi),Xe||x.default(xe._element).one(W.TRANSITION_END,function(){xe._element.style.overflowY=""}).emulateTransitionEnd(xe._element,yt)}).emulateTransitionEnd(yt),this._element.focus()}else this.hide()},Ue._showElement=function(xe){var ze=this,Xe=x.default(this._element).hasClass(Yl),yt=this._dialog?this._dialog.querySelector(".modal-body"):null;(!this._element.parentNode||this._element.parentNode.nodeType!==Node.ELEMENT_NODE)&&document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),x.default(this._dialog).hasClass("modal-dialog-scrollable")&&yt?yt.scrollTop=0:this._element.scrollTop=0,Xe&&W.reflow(this._element),x.default(this._element).addClass(Xo),this._config.focus&&this._enforceFocus();var Nt=x.default.Event(qn,{relatedTarget:xe}),qt=function(){ze._config.focus&&ze._element.focus(),ze._isTransitioning=!1,x.default(ze._element).trigger(Nt)};if(Xe){var Pn=W.getTransitionDurationFromElement(this._dialog);x.default(this._dialog).one(W.TRANSITION_END,qt).emulateTransitionEnd(Pn)}else qt()},Ue._enforceFocus=function(){var xe=this;x.default(document).off(zn).on(zn,function(ze){document!==ze.target&&xe._element!==ze.target&&0===x.default(xe._element).has(ze.target).length&&xe._element.focus()})},Ue._setEscapeEvent=function(){var xe=this;this._isShown?x.default(this._element).on(_r,function(ze){xe._config.keyboard&&27===ze.which?(ze.preventDefault(),xe.hide()):!xe._config.keyboard&&27===ze.which&&xe._triggerBackdropTransition()}):this._isShown||x.default(this._element).off(_r)},Ue._setResizeEvent=function(){var xe=this;this._isShown?x.default(window).on(xr,function(ze){return xe.handleUpdate(ze)}):x.default(window).off(xr)},Ue._hideModal=function(){var xe=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop(function(){x.default(document.body).removeClass(Io),xe._resetAdjustments(),xe._resetScrollbar(),x.default(xe._element).trigger(mn)})},Ue._removeBackdrop=function(){this._backdrop&&(x.default(this._backdrop).remove(),this._backdrop=null)},Ue._showBackdrop=function(xe){var ze=this,Xe=x.default(this._element).hasClass(Yl)?Yl:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",Xe&&this._backdrop.classList.add(Xe),x.default(this._backdrop).appendTo(document.body),x.default(this._element).on(Mr,function(Pn){ze._ignoreBackdropClick?ze._ignoreBackdropClick=!1:Pn.target===Pn.currentTarget&&ze._triggerBackdropTransition()}),Xe&&W.reflow(this._backdrop),x.default(this._backdrop).addClass(Xo),!xe)return;if(!Xe)return void xe();var yt=W.getTransitionDurationFromElement(this._backdrop);x.default(this._backdrop).one(W.TRANSITION_END,xe).emulateTransitionEnd(yt)}else if(!this._isShown&&this._backdrop){x.default(this._backdrop).removeClass(Xo);var Nt=function(){ze._removeBackdrop(),xe&&xe()};if(x.default(this._element).hasClass(Yl)){var qt=W.getTransitionDurationFromElement(this._backdrop);x.default(this._backdrop).one(W.TRANSITION_END,Nt).emulateTransitionEnd(qt)}else Nt()}else xe&&xe()},Ue._adjustDialog=function(){var xe=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&xe&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!xe&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},Ue._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},Ue._checkScrollbar=function(){var xe=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(xe.left+xe.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},Ue._setScrollbar=function(){var xe=this;if(this._isBodyOverflowing){var ze=[].slice.call(document.querySelectorAll(vh)),Xe=[].slice.call(document.querySelectorAll(_d));x.default(ze).each(function(qt,Pn){var En=Pn.style.paddingRight,Gn=x.default(Pn).css("padding-right");x.default(Pn).data("padding-right",En).css("padding-right",parseFloat(Gn)+xe._scrollbarWidth+"px")}),x.default(Xe).each(function(qt,Pn){var En=Pn.style.marginRight,Gn=x.default(Pn).css("margin-right");x.default(Pn).data("margin-right",En).css("margin-right",parseFloat(Gn)-xe._scrollbarWidth+"px")});var yt=document.body.style.paddingRight,Nt=x.default(document.body).css("padding-right");x.default(document.body).data("padding-right",yt).css("padding-right",parseFloat(Nt)+this._scrollbarWidth+"px")}x.default(document.body).addClass(Io)},Ue._resetScrollbar=function(){var xe=[].slice.call(document.querySelectorAll(vh));x.default(xe).each(function(yt,Nt){var qt=x.default(Nt).data("padding-right");x.default(Nt).removeData("padding-right"),Nt.style.paddingRight=qt||""});var ze=[].slice.call(document.querySelectorAll(""+_d));x.default(ze).each(function(yt,Nt){var qt=x.default(Nt).data("margin-right");typeof qt<"u"&&x.default(Nt).css("margin-right",qt).removeData("margin-right")});var Xe=x.default(document.body).data("padding-right");x.default(document.body).removeData("padding-right"),document.body.style.paddingRight=Xe||""},Ue._getScrollbarWidth=function(){var xe=document.createElement("div");xe.className="modal-scrollbar-measure",document.body.appendChild(xe);var ze=xe.getBoundingClientRect().width-xe.clientWidth;return document.body.removeChild(xe),ze},Ie._jQueryInterface=function(xe,ze){return this.each(function(){var Xe=x.default(this).data(wa),yt=G({},bt,x.default(this).data(),"object"==typeof xe&&xe?xe:{});if(Xe||(Xe=new Ie(this,yt),x.default(this).data(wa,Xe)),"string"==typeof xe){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe](ze)}else yt.show&&Xe.show(ze)})},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return bt}}]),Ie}();x.default(document).on(Rr,'[data-toggle="modal"]',function(Ie){var Ge,Ue=this,xe=W.getSelectorFromElement(this);xe&&(Ge=document.querySelector(xe));var ze=x.default(Ge).data(wa)?"toggle":G({},x.default(Ge).data(),x.default(this).data());("A"===this.tagName||"AREA"===this.tagName)&&Ie.preventDefault();var Xe=x.default(Ge).one(Kt,function(yt){yt.isDefaultPrevented()||Xe.one(mn,function(){x.default(Ue).is(":visible")&&Ue.focus()})});yh._jQueryInterface.call(x.default(Ge),ze,this)}),x.default.fn[Xl]=yh._jQueryInterface,x.default.fn[Xl].Constructor=yh,x.default.fn[Xl].noConflict=function(){return x.default.fn[Xl]=xc,yh._jQueryInterface};var Fd=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],Sc=/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/gi,Ys=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function or(Ie,Ue,Ge){if(0===Ie.length)return Ie;if(Ge&&"function"==typeof Ge)return Ge(Ie);for(var ze=(new window.DOMParser).parseFromString(Ie,"text/html"),Xe=Object.keys(Ue),yt=[].slice.call(ze.body.querySelectorAll("*")),Nt=function(Ar,Ur){var $r=yt[Ar],Zt=$r.nodeName.toLowerCase();if(-1===Xe.indexOf($r.nodeName.toLowerCase()))return $r.parentNode.removeChild($r),"continue";var No=[].slice.call($r.attributes),pl=[].concat(Ue["*"]||[],Ue[Zt]||[]);No.forEach(function(da){(function Ap(Ie,Ue){var Ge=Ie.nodeName.toLowerCase();if(-1!==Ue.indexOf(Ge))return-1===Fd.indexOf(Ge)||!(!Ie.nodeValue.match(Sc)&&!Ie.nodeValue.match(Ys));for(var xe=Ue.filter(function(yt){return yt instanceof RegExp}),ze=0,Xe=xe.length;ze<Xe;ze++)if(Ge.match(xe[ze]))return!0;return!1})(da,pl)||$r.removeAttribute(da.nodeName)})},qt=0,Pn=yt.length;qt<Pn;qt++)Nt(qt);return ze.body.innerHTML}var Tl="tooltip",qh="bs.tooltip",ha="."+qh,vd=x.default.fn[Tl],zr="bs-tooltip",ro=new RegExp("(^|\\s)"+zr+"\\S+","g"),Oo=["sanitize","whiteList","sanitizeFn"],$s={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},Hr={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},ol={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},Ec="show",Xh={HIDE:"hide"+ha,HIDDEN:"hidden"+ha,SHOW:"show"+ha,SHOWN:"shown"+ha,INSERTED:"inserted"+ha,CLICK:"click"+ha,FOCUSIN:"focusin"+ha,FOCUSOUT:"focusout"+ha,MOUSEENTER:"mouseenter"+ha,MOUSELEAVE:"mouseleave"+ha},Ml="fade",Qn="show",Al="hover",Fi="focus",Sa=function(){function Ie(Ge,xe){if(typeof er>"u")throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=Ge,this.config=this._getConfig(xe),this.tip=null,this._setListeners()}var Ue=Ie.prototype;return Ue.enable=function(){this._isEnabled=!0},Ue.disable=function(){this._isEnabled=!1},Ue.toggleEnabled=function(){this._isEnabled=!this._isEnabled},Ue.toggle=function(xe){if(this._isEnabled)if(xe){var ze=this.constructor.DATA_KEY,Xe=x.default(xe.currentTarget).data(ze);Xe||(Xe=new this.constructor(xe.currentTarget,this._getDelegateConfig()),x.default(xe.currentTarget).data(ze,Xe)),Xe._activeTrigger.click=!Xe._activeTrigger.click,Xe._isWithActiveTrigger()?Xe._enter(null,Xe):Xe._leave(null,Xe)}else{if(x.default(this.getTipElement()).hasClass(Qn))return void this._leave(null,this);this._enter(null,this)}},Ue.dispose=function(){clearTimeout(this._timeout),x.default.removeData(this.element,this.constructor.DATA_KEY),x.default(this.element).off(this.constructor.EVENT_KEY),x.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&x.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},Ue.show=function(){var xe=this;if("none"===x.default(this.element).css("display"))throw new Error("Please use show on visible elements");var ze=x.default.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){x.default(this.element).trigger(ze);var Xe=W.findShadowRoot(this.element),yt=x.default.contains(null!==Xe?Xe:this.element.ownerDocument.documentElement,this.element);if(ze.isDefaultPrevented()||!yt)return;var Nt=this.getTipElement(),qt=W.getUID(this.constructor.NAME);Nt.setAttribute("id",qt),this.element.setAttribute("aria-describedby",qt),this.setContent(),this.config.animation&&x.default(Nt).addClass(Ml);var Pn="function"==typeof this.config.placement?this.config.placement.call(this,Nt,this.element):this.config.placement,En=this._getAttachment(Pn);this.addAttachmentClass(En);var Gn=this._getContainer();x.default(Nt).data(this.constructor.DATA_KEY,this),x.default.contains(this.element.ownerDocument.documentElement,this.tip)||x.default(Nt).appendTo(Gn),x.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new er(this.element,Nt,this._getPopperConfig(En)),x.default(Nt).addClass(Qn),"ontouchstart"in document.documentElement&&x.default(document.body).children().on("mouseover",null,x.default.noop);var Ar=function(){xe.config.animation&&xe._fixTransition();var Zt=xe._hoverState;xe._hoverState=null,x.default(xe.element).trigger(xe.constructor.Event.SHOWN),"out"===Zt&&xe._leave(null,xe)};if(x.default(this.tip).hasClass(Ml)){var Ur=W.getTransitionDurationFromElement(this.tip);x.default(this.tip).one(W.TRANSITION_END,Ar).emulateTransitionEnd(Ur)}else Ar()}},Ue.hide=function(xe){var ze=this,Xe=this.getTipElement(),yt=x.default.Event(this.constructor.Event.HIDE),Nt=function(){ze._hoverState!==Ec&&Xe.parentNode&&Xe.parentNode.removeChild(Xe),ze._cleanTipClass(),ze.element.removeAttribute("aria-describedby"),x.default(ze.element).trigger(ze.constructor.Event.HIDDEN),null!==ze._popper&&ze._popper.destroy(),xe&&xe()};if(x.default(this.element).trigger(yt),!yt.isDefaultPrevented()){if(x.default(Xe).removeClass(Qn),"ontouchstart"in document.documentElement&&x.default(document.body).children().off("mouseover",null,x.default.noop),this._activeTrigger.click=!1,this._activeTrigger[Fi]=!1,this._activeTrigger[Al]=!1,x.default(this.tip).hasClass(Ml)){var qt=W.getTransitionDurationFromElement(Xe);x.default(Xe).one(W.TRANSITION_END,Nt).emulateTransitionEnd(qt)}else Nt();this._hoverState=""}},Ue.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},Ue.isWithContent=function(){return!!this.getTitle()},Ue.addAttachmentClass=function(xe){x.default(this.getTipElement()).addClass(zr+"-"+xe)},Ue.getTipElement=function(){return this.tip=this.tip||x.default(this.config.template)[0],this.tip},Ue.setContent=function(){var xe=this.getTipElement();this.setElementContent(x.default(xe.querySelectorAll(".tooltip-inner")),this.getTitle()),x.default(xe).removeClass(Ml+" "+Qn)},Ue.setElementContent=function(xe,ze){"object"!=typeof ze||!ze.nodeType&&!ze.jquery?this.config.html?(this.config.sanitize&&(ze=or(ze,this.config.whiteList,this.config.sanitizeFn)),xe.html(ze)):xe.text(ze):this.config.html?x.default(ze).parent().is(xe)||xe.empty().append(ze):xe.text(x.default(ze).text())},Ue.getTitle=function(){var xe=this.element.getAttribute("data-original-title");return xe||(xe="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),xe},Ue._getPopperConfig=function(xe){var ze=this;return G({},{placement:xe,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(Nt){Nt.originalPlacement!==Nt.placement&&ze._handlePopperPlacementChange(Nt)},onUpdate:function(Nt){return ze._handlePopperPlacementChange(Nt)}},this.config.popperConfig)},Ue._getOffset=function(){var xe=this,ze={};return"function"==typeof this.config.offset?ze.fn=function(Xe){return Xe.offsets=G({},Xe.offsets,xe.config.offset(Xe.offsets,xe.element)||{}),Xe}:ze.offset=this.config.offset,ze},Ue._getContainer=function(){return!1===this.config.container?document.body:W.isElement(this.config.container)?x.default(this.config.container):x.default(document).find(this.config.container)},Ue._getAttachment=function(xe){return Hr[xe.toUpperCase()]},Ue._setListeners=function(){var xe=this;this.config.trigger.split(" ").forEach(function(Xe){if("click"===Xe)x.default(xe.element).on(xe.constructor.Event.CLICK,xe.config.selector,function(qt){return xe.toggle(qt)});else if("manual"!==Xe){var yt=Xe===Al?xe.constructor.Event.MOUSEENTER:xe.constructor.Event.FOCUSIN,Nt=Xe===Al?xe.constructor.Event.MOUSELEAVE:xe.constructor.Event.FOCUSOUT;x.default(xe.element).on(yt,xe.config.selector,function(qt){return xe._enter(qt)}).on(Nt,xe.config.selector,function(qt){return xe._leave(qt)})}}),this._hideModalHandler=function(){xe.element&&xe.hide()},x.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=G({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},Ue._fixTitle=function(){var xe=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==xe)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},Ue._enter=function(xe,ze){var Xe=this.constructor.DATA_KEY;(ze=ze||x.default(xe.currentTarget).data(Xe))||(ze=new this.constructor(xe.currentTarget,this._getDelegateConfig()),x.default(xe.currentTarget).data(Xe,ze)),xe&&(ze._activeTrigger["focusin"===xe.type?Fi:Al]=!0),x.default(ze.getTipElement()).hasClass(Qn)||ze._hoverState===Ec?ze._hoverState=Ec:(clearTimeout(ze._timeout),ze._hoverState=Ec,ze.config.delay&&ze.config.delay.show?ze._timeout=setTimeout(function(){ze._hoverState===Ec&&ze.show()},ze.config.delay.show):ze.show())},Ue._leave=function(xe,ze){var Xe=this.constructor.DATA_KEY;if((ze=ze||x.default(xe.currentTarget).data(Xe))||(ze=new this.constructor(xe.currentTarget,this._getDelegateConfig()),x.default(xe.currentTarget).data(Xe,ze)),xe&&(ze._activeTrigger["focusout"===xe.type?Fi:Al]=!1),!ze._isWithActiveTrigger()){if(clearTimeout(ze._timeout),ze._hoverState="out",!ze.config.delay||!ze.config.delay.hide)return void ze.hide();ze._timeout=setTimeout(function(){"out"===ze._hoverState&&ze.hide()},ze.config.delay.hide)}},Ue._isWithActiveTrigger=function(){for(var xe in this._activeTrigger)if(this._activeTrigger[xe])return!0;return!1},Ue._getConfig=function(xe){var ze=x.default(this.element).data();return Object.keys(ze).forEach(function(Xe){-1!==Oo.indexOf(Xe)&&delete ze[Xe]}),"number"==typeof(xe=G({},this.constructor.Default,ze,"object"==typeof xe&&xe?xe:{})).delay&&(xe.delay={show:xe.delay,hide:xe.delay}),"number"==typeof xe.title&&(xe.title=xe.title.toString()),"number"==typeof xe.content&&(xe.content=xe.content.toString()),W.typeCheckConfig(Tl,xe,this.constructor.DefaultType),xe.sanitize&&(xe.template=or(xe.template,xe.whiteList,xe.sanitizeFn)),xe},Ue._getDelegateConfig=function(){var xe={};if(this.config)for(var ze in this.config)this.constructor.Default[ze]!==this.config[ze]&&(xe[ze]=this.config[ze]);return xe},Ue._cleanTipClass=function(){var xe=x.default(this.getTipElement()),ze=xe.attr("class").match(ro);null!==ze&&ze.length&&xe.removeClass(ze.join(""))},Ue._handlePopperPlacementChange=function(xe){this.tip=xe.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(xe.placement))},Ue._fixTransition=function(){var xe=this.getTipElement(),ze=this.config.animation;null===xe.getAttribute("x-placement")&&(x.default(xe).removeClass(Ml),this.config.animation=!1,this.hide(),this.show(),this.config.animation=ze)},Ie._jQueryInterface=function(xe){return this.each(function(){var ze=x.default(this),Xe=ze.data(qh),yt="object"==typeof xe&&xe;if((Xe||!/dispose|hide/.test(xe))&&(Xe||(Xe=new Ie(this,yt),ze.data(qh,Xe)),"string"==typeof xe)){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe]()}})},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return ol}},{key:"NAME",get:function(){return Tl}},{key:"DATA_KEY",get:function(){return qh}},{key:"Event",get:function(){return Xh}},{key:"EVENT_KEY",get:function(){return ha}},{key:"DefaultType",get:function(){return $s}}]),Ie}();x.default.fn[Tl]=Sa._jQueryInterface,x.default.fn[Tl].Constructor=Sa,x.default.fn[Tl].noConflict=function(){return x.default.fn[Tl]=vd,Sa._jQueryInterface};var Ju="popover",Ea="bs.popover",li="."+Ea,Jr=x.default.fn[Ju],pn="bs-popover",qc=new RegExp("(^|\\s)"+pn+"\\S+","g"),ci=G({},Sa.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),pa=G({},Sa.DefaultType,{content:"(string|element|function)"}),bs={HIDE:"hide"+li,HIDDEN:"hidden"+li,SHOW:"show"+li,SHOWN:"shown"+li,INSERTED:"inserted"+li,CLICK:"click"+li,FOCUSIN:"focusin"+li,FOCUSOUT:"focusout"+li,MOUSEENTER:"mouseenter"+li,MOUSELEAVE:"mouseleave"+li},Cs=function(Ie){function Ue(){return Ie.apply(this,arguments)||this}!function M(Ie,Ue){Ie.prototype=Object.create(Ue.prototype),Ie.prototype.constructor=Ie,Ie.__proto__=Ue}(Ue,Ie);var Ge=Ue.prototype;return Ge.isWithContent=function(){return this.getTitle()||this._getContent()},Ge.addAttachmentClass=function(ze){x.default(this.getTipElement()).addClass(pn+"-"+ze)},Ge.getTipElement=function(){return this.tip=this.tip||x.default(this.config.template)[0],this.tip},Ge.setContent=function(){var ze=x.default(this.getTipElement());this.setElementContent(ze.find(".popover-header"),this.getTitle());var Xe=this._getContent();"function"==typeof Xe&&(Xe=Xe.call(this.element)),this.setElementContent(ze.find(".popover-body"),Xe),ze.removeClass("fade show")},Ge._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},Ge._cleanTipClass=function(){var ze=x.default(this.getTipElement()),Xe=ze.attr("class").match(qc);null!==Xe&&Xe.length>0&&ze.removeClass(Xe.join(""))},Ue._jQueryInterface=function(ze){return this.each(function(){var Xe=x.default(this).data(Ea),yt="object"==typeof ze?ze:null;if((Xe||!/dispose|hide/.test(ze))&&(Xe||(Xe=new Ue(this,yt),x.default(this).data(Ea,Xe)),"string"==typeof ze)){if(typeof Xe[ze]>"u")throw new TypeError('No method named "'+ze+'"');Xe[ze]()}})},D(Ue,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return ci}},{key:"NAME",get:function(){return Ju}},{key:"DATA_KEY",get:function(){return Ea}},{key:"Event",get:function(){return bs}},{key:"EVENT_KEY",get:function(){return li}},{key:"DefaultType",get:function(){return pa}}]),Ue}(Sa);x.default.fn[Ju]=Cs._jQueryInterface,x.default.fn[Ju].Constructor=Cs,x.default.fn[Ju].noConflict=function(){return x.default.fn[Ju]=Jr,Cs._jQueryInterface};var ri="scrollspy",gr="bs.scrollspy",ll="."+gr,Qu=x.default.fn[ri],Ga={offset:10,method:"auto",target:""},es={offset:"number",method:"string",target:"(string|element)"},Li="activate"+ll,Yh="scroll"+ll,xh="load"+ll+".data-api",ur="active",cl=".nav, .list-group",Fr=".nav-link",Ku=".list-group-item",Jl="position",go=function(){function Ie(Ge,xe){var ze=this;this._element=Ge,this._scrollElement="BODY"===Ge.tagName?window:Ge,this._config=this._getConfig(xe),this._selector=this._config.target+" "+Fr+","+this._config.target+" "+Ku+","+this._config.target+" .dropdown-item",this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,x.default(this._scrollElement).on(Yh,function(Xe){return ze._process(Xe)}),this.refresh(),this._process()}var Ue=Ie.prototype;return Ue.refresh=function(){var xe=this,Xe="auto"===this._config.method?this._scrollElement===this._scrollElement.window?"offset":Jl:this._config.method,yt=Xe===Jl?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(qt){var Pn,En=W.getSelectorFromElement(qt);if(En&&(Pn=document.querySelector(En)),Pn){var Gn=Pn.getBoundingClientRect();if(Gn.width||Gn.height)return[x.default(Pn)[Xe]().top+yt,En]}return null}).filter(function(qt){return qt}).sort(function(qt,Pn){return qt[0]-Pn[0]}).forEach(function(qt){xe._offsets.push(qt[0]),xe._targets.push(qt[1])})},Ue.dispose=function(){x.default.removeData(this._element,gr),x.default(this._scrollElement).off(ll),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},Ue._getConfig=function(xe){if("string"!=typeof(xe=G({},Ga,"object"==typeof xe&&xe?xe:{})).target&&W.isElement(xe.target)){var ze=x.default(xe.target).attr("id");ze||(ze=W.getUID(ri),x.default(xe.target).attr("id",ze)),xe.target="#"+ze}return W.typeCheckConfig(ri,xe,es),xe},Ue._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},Ue._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},Ue._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},Ue._process=function(){var xe=this._getScrollTop()+this._config.offset,ze=this._getScrollHeight(),Xe=this._config.offset+ze-this._getOffsetHeight();if(this._scrollHeight!==ze&&this.refresh(),xe>=Xe){var yt=this._targets[this._targets.length-1];this._activeTarget!==yt&&this._activate(yt)}else{if(this._activeTarget&&xe<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var Nt=this._offsets.length;Nt--;)this._activeTarget!==this._targets[Nt]&&xe>=this._offsets[Nt]&&(typeof this._offsets[Nt+1]>"u"||xe<this._offsets[Nt+1])&&this._activate(this._targets[Nt])}},Ue._activate=function(xe){this._activeTarget=xe,this._clear();var ze=this._selector.split(",").map(function(yt){return yt+'[data-target="'+xe+'"],'+yt+'[href="'+xe+'"]'}),Xe=x.default([].slice.call(document.querySelectorAll(ze.join(","))));Xe.hasClass("dropdown-item")?(Xe.closest(".dropdown").find(".dropdown-toggle").addClass(ur),Xe.addClass(ur)):(Xe.addClass(ur),Xe.parents(cl).prev(Fr+", "+Ku).addClass(ur),Xe.parents(cl).prev(".nav-item").children(Fr).addClass(ur)),x.default(this._scrollElement).trigger(Li,{relatedTarget:xe})},Ue._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(xe){return xe.classList.contains(ur)}).forEach(function(xe){return xe.classList.remove(ur)})},Ie._jQueryInterface=function(xe){return this.each(function(){var ze=x.default(this).data(gr);if(ze||(ze=new Ie(this,"object"==typeof xe&&xe),x.default(this).data(gr,ze)),"string"==typeof xe){if(typeof ze[xe]>"u")throw new TypeError('No method named "'+xe+'"');ze[xe]()}})},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return Ga}}]),Ie}();x.default(window).on(xh,function(){for(var Ie=[].slice.call(document.querySelectorAll('[data-spy="scroll"]')),Ge=Ie.length;Ge--;){var xe=x.default(Ie[Ge]);go._jQueryInterface.call(xe,xe.data())}}),x.default.fn[ri]=go._jQueryInterface,x.default.fn[ri].Constructor=go,x.default.fn[ri].noConflict=function(){return x.default.fn[ri]=Qu,go._jQueryInterface};var Ai="tab",Rs="bs.tab",$l="."+Rs,Cl=x.default.fn[Ai],ul="hide"+$l,Zl="hidden"+$l,Mc="show"+$l,Yc="shown"+$l,cr="click"+$l+".data-api",Ta="active",xu=".active",ui="> li > .active",Bo=function(){function Ie(Ge){this._element=Ge}var Ue=Ie.prototype;return Ue.show=function(){var xe=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&x.default(this._element).hasClass(Ta)||x.default(this._element).hasClass("disabled"))){var ze,Xe,yt=x.default(this._element).closest(".nav, .list-group")[0],Nt=W.getSelectorFromElement(this._element);if(yt){var qt="UL"===yt.nodeName||"OL"===yt.nodeName?ui:xu;Xe=(Xe=x.default.makeArray(x.default(yt).find(qt)))[Xe.length-1]}var Pn=x.default.Event(ul,{relatedTarget:this._element}),En=x.default.Event(Mc,{relatedTarget:Xe});if(Xe&&x.default(Xe).trigger(Pn),x.default(this._element).trigger(En),!En.isDefaultPrevented()&&!Pn.isDefaultPrevented()){Nt&&(ze=document.querySelector(Nt)),this._activate(this._element,yt);var Gn=function(){var Ur=x.default.Event(Zl,{relatedTarget:xe._element}),$r=x.default.Event(Yc,{relatedTarget:Xe});x.default(Xe).trigger(Ur),x.default(xe._element).trigger($r)};ze?this._activate(ze,ze.parentNode,Gn):Gn()}}},Ue.dispose=function(){x.default.removeData(this._element,Rs),this._element=null},Ue._activate=function(xe,ze,Xe){var yt=this,qt=(!ze||"UL"!==ze.nodeName&&"OL"!==ze.nodeName?x.default(ze).children(xu):x.default(ze).find(ui))[0],Pn=Xe&&qt&&x.default(qt).hasClass("fade"),En=function(){return yt._transitionComplete(xe,qt,Xe)};if(qt&&Pn){var Gn=W.getTransitionDurationFromElement(qt);x.default(qt).removeClass("show").one(W.TRANSITION_END,En).emulateTransitionEnd(Gn)}else En()},Ue._transitionComplete=function(xe,ze,Xe){if(ze){x.default(ze).removeClass(Ta);var yt=x.default(ze.parentNode).find("> .dropdown-menu .active")[0];yt&&x.default(yt).removeClass(Ta),"tab"===ze.getAttribute("role")&&ze.setAttribute("aria-selected",!1)}if(x.default(xe).addClass(Ta),"tab"===xe.getAttribute("role")&&xe.setAttribute("aria-selected",!0),W.reflow(xe),xe.classList.contains("fade")&&xe.classList.add("show"),xe.parentNode&&x.default(xe.parentNode).hasClass("dropdown-menu")){var Nt=x.default(xe).closest(".dropdown")[0];if(Nt){var qt=[].slice.call(Nt.querySelectorAll(".dropdown-toggle"));x.default(qt).addClass(Ta)}xe.setAttribute("aria-expanded",!0)}Xe&&Xe()},Ie._jQueryInterface=function(xe){return this.each(function(){var ze=x.default(this),Xe=ze.data(Rs);if(Xe||(Xe=new Ie(this),ze.data(Rs,Xe)),"string"==typeof xe){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe]()}})},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),Ie}();x.default(document).on(cr,'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',function(Ie){Ie.preventDefault(),Bo._jQueryInterface.call(x.default(this),"show")}),x.default.fn[Ai]=Bo._jQueryInterface,x.default.fn[Ai].Constructor=Bo,x.default.fn[Ai].noConflict=function(){return x.default.fn[Ai]=Cl,Bo._jQueryInterface};var Wn="toast",wu="bs.toast",hl="."+wu,Ql=x.default.fn[Wn],Su="click.dismiss"+hl,as="hide"+hl,Va="hidden"+hl,Eu="show"+hl,Ma="shown"+hl,Qh="show",Qc="showing",eh={animation:"boolean",autohide:"boolean",delay:"number"},Aa={animation:!0,autohide:!0,delay:500},ts=function(){function Ie(Ge,xe){this._element=Ge,this._config=this._getConfig(xe),this._timeout=null,this._setListeners()}var Ue=Ie.prototype;return Ue.show=function(){var xe=this,ze=x.default.Event(Eu);if(x.default(this._element).trigger(ze),!ze.isDefaultPrevented()){this._clearTimeout(),this._config.animation&&this._element.classList.add("fade");var Xe=function(){xe._element.classList.remove(Qc),xe._element.classList.add(Qh),x.default(xe._element).trigger(Ma),xe._config.autohide&&(xe._timeout=setTimeout(function(){xe.hide()},xe._config.delay))};if(this._element.classList.remove("hide"),W.reflow(this._element),this._element.classList.add(Qc),this._config.animation){var yt=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,Xe).emulateTransitionEnd(yt)}else Xe()}},Ue.hide=function(){if(this._element.classList.contains(Qh)){var xe=x.default.Event(as);x.default(this._element).trigger(xe),!xe.isDefaultPrevented()&&this._close()}},Ue.dispose=function(){this._clearTimeout(),this._element.classList.contains(Qh)&&this._element.classList.remove(Qh),x.default(this._element).off(Su),x.default.removeData(this._element,wu),this._element=null,this._config=null},Ue._getConfig=function(xe){return xe=G({},Aa,x.default(this._element).data(),"object"==typeof xe&&xe?xe:{}),W.typeCheckConfig(Wn,xe,this.constructor.DefaultType),xe},Ue._setListeners=function(){var xe=this;x.default(this._element).on(Su,'[data-dismiss="toast"]',function(){return xe.hide()})},Ue._close=function(){var xe=this,ze=function(){xe._element.classList.add("hide"),x.default(xe._element).trigger(Va)};if(this._element.classList.remove(Qh),this._config.animation){var Xe=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,ze).emulateTransitionEnd(Xe)}else ze()},Ue._clearTimeout=function(){clearTimeout(this._timeout),this._timeout=null},Ie._jQueryInterface=function(xe){return this.each(function(){var ze=x.default(this),Xe=ze.data(wu);if(Xe||(Xe=new Ie(this,"object"==typeof xe&&xe),ze.data(wu,Xe)),"string"==typeof xe){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe](this)}})},D(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"DefaultType",get:function(){return eh}},{key:"Default",get:function(){return Aa}}]),Ie}();x.default.fn[Wn]=ts._jQueryInterface,x.default.fn[Wn].Constructor=ts,x.default.fn[Wn].noConflict=function(){return x.default.fn[Wn]=Ql,ts._jQueryInterface},n.Alert=Ke,n.Button=Zr,n.Carousel=Lo,n.Collapse=zc,n.Dropdown=xa,n.Modal=yh,n.Popover=Cs,n.Scrollspy=go,n.Tab=Bo,n.Toast=ts,n.Tooltip=Sa,n.Util=W,Object.defineProperty(n,"__esModule",{value:!0})});